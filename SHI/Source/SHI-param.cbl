      *{TOTEM}PRG-COMMENT
      * SHI-param.Cbl
      * SHI-param.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      * The Seleton Path is F:\SKELETON61SPANDREA\
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          SHI-param.
       AUTHOR.              ANDREA EVENTI.
       DATE-WRITTEN.        venerdì 23 febbraio 2018 09:01:23.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:SHI-param, INIT:SHI-param, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "tcaumag.sl".
           COPY "tmagaz.sl".
           COPY "paramSHI.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "tcaumag.fd".
           COPY "tmagaz.fd".
           COPY "paramSHI.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "crtvars.def".
               COPY "opensave.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "F:\lubex\geslux\Copylib\standard.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
          88 Screen-Time-Out VALUE 99.
      * Properties & User defined Working Stoarge
       78 titolo VALUE IS "Geslux - Tabella Parametri di configurazione"
           . 
           COPY  "LINK-PASSWD.DEF".
       77 Form1-Tb-1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 CountChar        PIC  9(3).
       77 como-id          PIC  9(5).
       77 data-oggi        PIC  9(8).
       01 FlagErroreDes    PIC  9
                  VALUE IS 0.
           88 errore-des VALUE IS 1    WHEN SET TO FALSE  0. 
       77 toolbar-bmp      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 E-ESCI           PIC  9
                  VALUE IS 1.
       77 E-NUOVO          PIC  9
                  VALUE IS 0.
       77 E-CANCELLA       PIC  9
                  VALUE IS 0.
       77 E-SALVA          PIC  9
                  VALUE IS 1.
       77 E-MODIFICA       PIC  9
                  VALUE IS 1.
       77 E-STAMPA         PIC  9
                  VALUE IS 0.
       77 E-CERCA          PIC  9
                  VALUE IS 0.
       77 E-SELEZIONA      PIC  9
                  VALUE IS 0.
       77 E-ANTEPRIMA      PIC  9
                  VALUE IS 0.
       77 Small-Font
                  USAGE IS HANDLE OF FONT SMALL-FONT.
       77 Default-Font
                  USAGE IS HANDLE OF FONT DEFAULT-FONT.
       77 form1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 mod-fis          PIC  9
                  VALUE IS 1.
       77 AUTO-ID          PIC  9(6)
                  VALUE IS 0.
       77 Screen4-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 accept-bmp       PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 Form1-St-1-Handle
                  USAGE IS HANDLE OF STATUS-BAR.
       77 Screen1-Pg-1-Visible         PIC  9
                  VALUE IS 0.
       77 STATUS-paramshi  PIC  X(2).
           88 Valid-STATUS-paramshi VALUE IS "00" THRU "09". 
       77 pae-path-file-invio          PIC  x(256).
       77 Screen1-Pg-2-Visible         PIC  9
                  VALUE IS 0.
       77 STATUS-tmagaz    PIC  X(2).
           88 Valid-STATUS-tmagaz VALUE IS "00" THRU "09". 
       77 Screen1-Pg-3-Visible         PIC  9
                  VALUE IS 0.
       77 Screen1-Pg-4-Visible         PIC  9
                  VALUE IS 0.
       77 STATUS-tcaumag   PIC  X(2).
           88 Valid-STATUS-tcaumag VALUE IS "00" THRU "09". 
       77 help-sostituzione            PIC  x(100).
       77 STATUS-tmagaz1   PIC  X(2).
           88 VALID-STATUS-tmagaz1 VALUE IS "00" THRU "09". 
       77 lbl-mag-1-buf    PIC  x(100).
       77 lbl-mag-2-buf    PIC  X(100).
       77 lab-mag-1-buf    PIC  X(30).

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 Screen1-Ta-1-TAB-VALUE  PIC  99  VALUE 1.
       78 KEY-KT-VALUE   VALUE 32001.
       78 KEY-KB-VALUE   VALUE 32002.
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
      * DATA CONTROL BUFFER
       01 Form1-BUF.
      * Page
              05 Screen1-Pg-4-BUF.
      * Data.Entry-Field
              10 ef-cod-commitente-BUF PIC x(15).
      * Data.Entry-Field
              10 ef-mag-1-BUF PIC x(3).
      * Data.Entry-Field
              10 ef-mag-2-BUF PIC x(3).
      * Data.Entry-Field
              10 ef-path-log-server-BUF PIC x(256).
      * Data.Entry-Field
              10 ef-path-log-client-BUF PIC x(256).
      * Data.Entry-Field
              10 ef-sem-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-mail-mod-bozze-BUF PIC x(200).
      * Data.Entry-Field
              10 ef-mail-cc-mod-bozze-BUF PIC x(200).
      * Data.Entry-Field
              10 ef-ogg-canc-bozze-BUF PIC x(200).
      * Data.Entry-Field
              10 ef-corpo-canc-bozze-BUF PIC x(200).
      * Data.Entry-Field
              10 ef-ogg-mod-bozze-BUF PIC x(200).
      * Data.Entry-Field
              10 ef-corpo-mod-bozze-BUF PIC x(200).
      * Page
              05 Screen1-Pg-1-BUF.
      * Data.Entry-Field
              10 ef-path-exp-BUF PIC x(256).
      * Data.Entry-Field
              10 ef-path-backup-BUF PIC x(256).
      * Data.Entry-Field
              10 ef-articoli-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-ean-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-prodener-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-vettori-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-fornitori-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-classi-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-tordini-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-rordini-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-note-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-sito-exp-BUF PIC x(100).
      * Data.Entry-Field
              10 ef-user-exp-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-pwd-exp-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-path-rem-exp-BUF PIC x(100).
      * Page
              05 Screen1-Pg-2-BUF.
      * Data.Entry-Field
              10 ef-path-imp-BUF PIC x(256).
      * Data.Entry-Field
              10 ef-path-backup-imp-BUF PIC x(256).
      * Data.Entry-Field
              10 ef-articoli-imp-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-tordini-imp-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-rordini-imp-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-sito-imp-BUF PIC x(100).
      * Data.Entry-Field
              10 ef-user-imp-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-pwd-imp-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-path-rem-imp-BUF PIC x(100).
      * Page
              05 Screen1-Pg-3-BUF.
      * Data.Entry-Field
              10 ef-path-impcar-BUF PIC x(256).
      * Data.Entry-Field
              10 ef-path-backup-impcar-BUF PIC x(256).
      * Data.Entry-Field
              10 ef-carichi-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-cau-BUF PIC x(4).
      * Data.Entry-Field
              10 ef-mail-BUF PIC x(100).
      * Data.Entry-Field
              10 ef-mail-cc-BUF PIC x(100).
      * Data.Entry-Field
              10 ef-sito-impcar-BUF PIC x(100).
      * Data.Entry-Field
              10 ef-user-impcar-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-pwd-impcar-BUF PIC x(50).
      * Data.Entry-Field
              10 ef-path-rem-impcar-BUF PIC x(100).
      * Data.Label
              10 lbl-cau-BUF PIC X(40).

       77 TMP-Form1-KEY1-ORDER  PIC X VALUE "A".
       77 TMP-Form1-paramSHI-RESTOREBUF  PIC X(9574).
       77 TMP-Form1-KEYIS  PIC 9(3) VALUE 1.
       77 Form1-MULKEY-TMPBUF   PIC X(9574).
       77 TMP-DataSet1-tcaumag-BUF     PIC X(254).
       77 TMP-DataSet1-tmagaz-BUF     PIC X(212).
       77 TMP-DataSet1-paramSHI-BUF     PIC X(9574).

      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-tcaumag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcaumag-LOCK  VALUE "Y".
       77 DataSet1-tcaumag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcaumag-KEY-Asc  VALUE "A".
          88 DataSet1-tcaumag-KEY-Desc VALUE "D".
       77 DataSet1-tmagaz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmagaz-LOCK  VALUE "Y".
       77 DataSet1-tmagaz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmagaz-KEY-Asc  VALUE "A".
          88 DataSet1-tmagaz-KEY-Desc VALUE "D".
       77 DataSet1-paramSHI-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-paramSHI-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-paramSHI-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-paramSHI-KEY1-Asc  VALUE "A".
          88 DataSet1-paramSHI-KEY1-Desc VALUE "D".

       77 tcaumag-k-mag-SPLITBUF  PIC X(5).

       01                       pic 9.
           88 controllo-finale  value 1 false zero.

       77  OPENSAVE-STATUS      PIC S99.
           88  OPENSAVE-OK      VALUE 1.

       01 old-shi-rec.
           05 old-shi-chiave.
               10 old-shi-codice       PIC  X(2).
           05 old-shi-dati.
               10 old-shi-cod-SHI      PIC  x(15).
               10 old-shi-mag-SHI-1    PIC  x(3).
               10 old-shi-nome-semaforo            PIC  x(50).
               10 old-shi-path-report-server       PIC  x(256).
               10 old-shi-path-report-client       PIC  x(256).
               10 old-shi-dati-exp.
                   15 old-shi-path-exp     PIC  x(256).
                   15 old-shi-path-backup-exp          PIC  x(256).
                   15 old-shi-file-articoli            PIC  x(50).
                   15 old-shi-file-ean     PIC  x(50).
                   15 old-shi-file-prodener            PIC  x(50).
                   15 old-shi-file-vettori PIC  x(50).
                   15 old-shi-file-fornitori           PIC  x(50).
                   15 old-shi-file-tordini PIC  x(50).
                   15 old-shi-file-rordini PIC  x(50).
                   15 old-shi-file-note-ordini         PIC  x(50).
                   15 old-shi-file-classi  PIC  x(50).
                   15 old-shi-file-vuoto-exp-1         PIC  x(50).
                   15 old-shi-file-vuoto-exp-2         PIC  x(50).
                   15 old-shi-file-vuoto-exp-3         PIC  x(50).
                   15 old-shi-file-vuoto-exp-4         PIC  x(50).
                   15 old-shi-file-vuoto-exp-5         PIC  x(50).
                   15 old-shi-ftp-exp.
                       20 old-shi-sito-exp     PIC  x(100).
                       20 old-shi-user-exp     PIC  x(50).
                       20 old-shi-pwd-exp      PIC  x(50).
                       20 old-shi-path-remota-exp          PIC  x(100).
               10 old-shi-dati-import.
                   15 old-shi-path-imp     PIC  x(256).
                   15 old-shi-path-backup-imp          PIC  x(256).
                   15 old-shi-file-articoli-imp        PIC  x(50).
                   15 old-shi-file-tordini-imp         PIC  x(50).
                   15 old-shi-file-rordini-imp         PIC  x(50).
                   15 old-shi-file-vuoto-imp-1         PIC  x(50).
                   15 old-shi-file-vuoto-imp-2         PIC  x(50).
                   15 old-shi-file-vuoto-imp-3         PIC  x(50).
                   15 old-shi-file-vuoto-imp-4         PIC  x(50).
                   15 old-shi-file-vuoto-imp-5         PIC  x(50).
                   15 old-shi-ftp-imp.
                       20 old-shi-sito-imp     PIC  x(100).
                       20 old-shi-user-imp     PIC  x(50).
                       20 old-shi-pwd-imp      PIC  x(50).
                       20 old-shi-path-remota-imp          PIC  x(100).
               10 old-shi-dati-impor-tcarico.
                   15 old-shi-path-impcar  PIC  x(256).
                   15 old-shi-path-backup-impcar       PIC  x(256).
                   15 old-shi-file-articoli-impcar     PIC  x(50).
                   15 old-shi-file-carichi-impcar      PIC  x(50).
                   15 old-shi-file-vuoto-impcar-1      PIC  x(46).
                   15 old-shi-causale-impcar           PIC  x(4).
                   15 old-shi-mail-impcar  PIC  x(100).
                   15 old-shi-mail-cc-impcar           PIC  x(100).
                   15 old-shi-ftp-impcar.
                       20 old-shi-sito-impcar  PIC  x(100).
                       20 old-shi-user-impcar  PIC  x(50).
                       20 old-shi-pwd-impcar   PIC  x(50).
                       20 old-shi-path-remota-impcar       PIC  x(100).
               10 old-shi-dati-comuni.
                   15 old-shi-data-creazione           PIC  9(8).
                   15 old-shi-ora-creazione            PIC  9(8).
                   15 old-shi-utente-creazione         PIC  X(10).
                   15 old-shi-data-ultima-modifica     PIC  9(8).
                   15 old-shi-ora-ultima-modifica      PIC  9(8).
                   15 old-shi-utente-ultima-modifica   PIC  X(10).
               10 old-shi-vuoti.
                   15 old-shi-num-vuoto-1   PIC  9(18).
                   15 old-shi-num-vuoto-2   PIC  9(18).
                   15 old-shi-num-vuoto-3   PIC  9(18).
                   15 old-shi-dati-mail-mod-bozze.
                       20 old-shi-mail-mod-bozze           PIC  x(200).
                       20 old-shi-mail-cc-mod-bozze        PIC  x(200).
                       20 old-shi-oggetto-canc-bozze       PIC  x(200).
                       20 old-shi-corpo-canc-bozze         PIC  x(200).
                       20 old-shi-oggetto-mod-bozze        PIC  x(200).
                       20 old-shi-corpo-mod-bozze          PIC  x(200).
               10 old-shi-mag-SHI-2    PIC  x(3).
      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-ef-cod-commitente VALUE 5001.
       78  78-ID-ef-mag-1 VALUE 5002.
       78  78-ID-ef-mag-2 VALUE 5003.
       78  78-ID-ef-path-log-server VALUE 5004.
       78  78-ID-ef-path-log-client VALUE 5005.
       78  78-ID-ef-sem VALUE 5006.
       78  78-ID-ef-ogg-canc-bozze VALUE 5007.
       78  78-ID-ef-corpo-canc-bozze VALUE 5008.
       78  78-ID-ef-ogg-mod-bozze VALUE 5009.
       78  78-ID-ef-corpo-mod-bozze VALUE 5010.
       78  78-ID-ef-path-exp VALUE 5011.
       78  78-ID-ef-path-backup VALUE 5012.
       78  78-ID-ef-articoli VALUE 5013.
       78  78-ID-ef-ean VALUE 5014.
       78  78-ID-ef-prodener VALUE 5015.
       78  78-ID-ef-vettori VALUE 5016.
       78  78-ID-ef-fornitori VALUE 5017.
       78  78-ID-ef-classi VALUE 5018.
       78  78-ID-ef-tordini VALUE 5019.
       78  78-ID-ef-rordini VALUE 5020.
       78  78-ID-ef-note VALUE 5021.
       78  78-ID-ef-sito-exp VALUE 5022.
       78  78-ID-ef-user-exp VALUE 5023.
       78  78-ID-ef-pwd-exp VALUE 5024.
       78  78-ID-ef-path-rem-exp VALUE 5025.
       78  78-ID-ef-path-imp VALUE 5026.
       78  78-ID-ef-path-backup-imp VALUE 5027.
       78  78-ID-ef-articoli-imp VALUE 5028.
       78  78-ID-ef-tordini-imp VALUE 5029.
       78  78-ID-ef-rordini-imp VALUE 5030.
       78  78-ID-ef-sito-imp VALUE 5031.
       78  78-ID-ef-user-imp VALUE 5032.
       78  78-ID-ef-pwd-imp VALUE 5033.
       78  78-ID-ef-path-rem-imp VALUE 5034.
       78  78-ID-ef-path-impcar VALUE 5035.
       78  78-ID-ef-path-backup-impcar VALUE 5036.
       78  78-ID-ef-carichi VALUE 5037.
       78  78-ID-ef-cau VALUE 5038.
       78  78-ID-ef-mail VALUE 5039.
       78  78-ID-ef-mail-cc VALUE 5040.
       78  78-ID-ef-sito-impcar VALUE 5041.
       78  78-ID-ef-user-impcar VALUE 5042.
       78  78-ID-ef-pwd-impcar VALUE 5043.
       78  78-ID-ef-path-rem-impcar VALUE 5044.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "COMMON-LINKAGE.DEF".

      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           AFTER PROCEDURE Form1-AfterProcedure,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           .

      * TAB
       05
           Screen1-Ta-1, 
           Tab-Control, 
           COL 2,29, 
           LINE 2,85,
           LINES 44,54 ,
           SIZE 102,00 ,
           FONT IS Small-Font,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           .

      * PAGE
       05
           Screen1-Pg-4, 
           VISIBLE Screen1-Pg-4-Visible,
           COL 3, 
           LINE 5,
           .

      * ENTRY FIELD
       10
           ef-cod-commitente, 
           Entry-Field, 
           COL 20,86, 
           LINE 5,54,
           LINES 1,31 ,
           SIZE 23,86 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cod-commitente,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-cod-commitente-BUF,
           .

      * ENTRY FIELD
       10
           ef-mag-1, 
           Entry-Field, 
           COL 20,86, 
           LINE 7,54,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-mag-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-mag-1-BUF,
           .

      * ENTRY FIELD
       10
           ef-mag-2, 
           Entry-Field, 
           COL 20,86, 
           LINE 9,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-mag-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-mag-2-BUF,
           .

      * ENTRY FIELD
       10
           ef-path-log-server, 
           Entry-Field, 
           COL 20,86, 
           LINE 14,23,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-log-server,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-path-log-server-BUF,
           .

      * PUSH BUTTON
       10
           pb-report-server, 
           Push-Button, 
           COL 99,86, 
           LINE 14,23,
           LINES 1,31 ,
           SIZE 2,57 ,
           ENABLED mod,
           EXCEPTION-VALUE 1000,
           FONT IS Small-Font,
           ID IS 143,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-path-log-client, 
           Entry-Field, 
           COL 20,86, 
           LINE 16,23,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-log-client,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-path-log-client-BUF,
           .

      * PUSH BUTTON
       10
           pb-report-client, 
           Push-Button, 
           COL 99,86, 
           LINE 16,23,
           LINES 1,31 ,
           SIZE 2,57 ,
           ENABLED mod,
           EXCEPTION-VALUE 1004,
           FONT IS Small-Font,
           ID IS 144,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-sem, 
           Entry-Field, 
           COL 20,86, 
           LINE 20,23,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sem,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-sem-BUF,
           .

      * ENTRY FIELD
       10
           ef-mail-mod-bozze, 
           Entry-Field, 
           COL 20,86, 
           LINE 24,23,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 193,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 200,
           VALUE ef-mail-mod-bozze-BUF,
           .

      * ENTRY FIELD
       10
           ef-mail-cc-mod-bozze, 
           Entry-Field, 
           COL 20,86, 
           LINE 26,23,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 194,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 200,
           VALUE ef-mail-cc-mod-bozze-BUF,
           .

      * ENTRY FIELD
       10
           ef-ogg-canc-bozze, 
           Entry-Field, 
           COL 20,86, 
           LINE 31,23,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ogg-canc-bozze,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 200,
           VALUE ef-ogg-canc-bozze-BUF,
           .

      * ENTRY FIELD
       10
           ef-corpo-canc-bozze, 
           Entry-Field, 
           COL 20,86, 
           LINE 33,23,
           LINES 3,00 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-corpo-canc-bozze,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 200,
           VSCROLL-BAR,
           USE-RETURN,
           VALUE ef-corpo-canc-bozze-BUF,
           .

      * ENTRY FIELD
       10
           ef-ogg-mod-bozze, 
           Entry-Field, 
           COL 20,86, 
           LINE 40,23,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ogg-mod-bozze,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 200,
           VALUE ef-ogg-mod-bozze-BUF,
           .

      * ENTRY FIELD
       10
           ef-corpo-mod-bozze, 
           Entry-Field, 
           COL 20,86, 
           LINE 42,23,
           LINES 3,00 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-corpo-mod-bozze,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 200,
           VSCROLL-BAR,
           USE-RETURN,
           VALUE ef-corpo-mod-bozze-BUF,
           .

      * LABEL
       10
           Screen1-La-4c, 
           Label, 
           COL 4,86, 
           LINE 14,23,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cartella report Server",
           .

      * LABEL
       10
           Screen1-La-3, 
           Label, 
           COL 4,86, 
           LINE 7,54,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Magazzino SHI 1",
           .

      * LABEL
       10
           Screen1-La-2, 
           Label, 
           COL 4,86, 
           LINE 5,54,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 7,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. Committente",
           .

      * LABEL
       10
           Form1-La-5aaacaad, 
           Label, 
           COL 3,86, 
           LINE 12,23,
           LINES 1,50 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 139,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Percorsi",
           .

      * BAR
       10
           Form1-Br-2aaad, 
           Bar,
           COL 24,00, 
           LINE 13,08,
           SIZE 79,00 ,
           ID IS 140,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-4ca, 
           Label, 
           COL 4,86, 
           LINE 16,23,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 141,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cartella report Client",
           .

      * LABEL
       10
           Screen1-La-6ba, 
           Label, 
           COL 4,86, 
           LINE 20,23,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 178,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Semaforo",
           .

      * LABEL
       10
           Form1-La-5aaacaaaca, 
           Label, 
           COL 3,86, 
           LINE 18,23,
           LINES 1,54 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 184,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Nomi Files",
           .

      * BAR
       10
           Form1-Br-2aaaaca, 
           Bar,
           COL 24,00, 
           LINE 19,08,
           SIZE 79,00 ,
           ID IS 185,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-5aaacaaacaa, 
           Label, 
           COL 3,86, 
           LINE 22,23,
           LINES 1,54 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 186,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Ind. Mail mod. bozze",
           .

      * BAR
       10
           Form1-Br-2aaaacaa, 
           Bar,
           COL 24,00, 
           LINE 23,08,
           SIZE 79,00 ,
           ID IS 187,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-6aaba, 
           Label, 
           COL 4,86, 
           LINE 24,23,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 8,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Mail",
           .

      * LABEL
       10
           Screen1-La-6aaca, 
           Label, 
           COL 4,86, 
           LINE 26,23,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Mail CC",
           .

      * LABEL
       10
           Screen1-La-6aacaa, 
           Label, 
           COL 4,86, 
           LINE 31,23,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 18,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Oggetto",
           .

      * LABEL
       10
           Form1-La-5aaacaaacaaa, 
           Label, 
           COL 3,86, 
           LINE 28,23,
           LINES 1,54 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 20,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Dati Mail Canc. Bozze",
           .

      * BAR
       10
           Form1-Br-2aaaacaaa, 
           Bar,
           COL 24,00, 
           LINE 29,08,
           SIZE 79,00 ,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-6aacaaa, 
           Label, 
           COL 4,86, 
           LINE 33,23,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Corpo",
           .

      * LABEL
       10
           Screen1-La-6aacaab, 
           Label, 
           COL 20,86, 
           LINE 29,77,
           LINES 1,31 ,
           SIZE 79,00 ,
           FONT IS Small-Font,
           ID IS 24,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE help-sostituzione,
           .

      * LABEL
       10
           Screen1-La-6aacaac, 
           Label, 
           COL 4,86, 
           LINE 40,23,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Oggetto",
           .

      * LABEL
       10
           Form1-La-5aaacaaacaaaa, 
           Label, 
           COL 3,86, 
           LINE 37,23,
           LINES 1,54 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Dati Mail Canc. Bozze",
           .

      * BAR
       10
           Form1-Br-2aaaacaaaa, 
           Bar,
           COL 24,00, 
           LINE 38,08,
           SIZE 79,00 ,
           ID IS 28,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-6aacaaaa, 
           Label, 
           COL 4,86, 
           LINE 42,23,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 31,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Corpo",
           .

      * LABEL
       10
           Screen1-La-6aacaaba, 
           Label, 
           COL 20,86, 
           LINE 38,77,
           LINES 1,31 ,
           SIZE 79,00 ,
           FONT IS Small-Font,
           ID IS 32,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE help-sostituzione,
           .

      * LABEL
       10
           Screen1-La-3a, 
           Label, 
           COL 4,86, 
           LINE 9,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 33,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Magazzino SHI 2",
           .

      * LABEL
       10
           lbl-mag-1, 
           Label, 
           COL 27,15, 
           LINE 7,54,
           LINES 1,31 ,
           SIZE 70,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 5,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lbl-mag-1-buf,
           .

      * LABEL
       10
           lbl-mag-2, 
           Label, 
           COL 27,15, 
           LINE 9,46,
           LINES 1,31 ,
           SIZE 70,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 6,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lbl-mag-2-buf,
           .

      * PAGE
       05
           Screen1-Pg-1, 
           VISIBLE Screen1-Pg-1-Visible,
           COL 3, 
           LINE 5,
           .

      * ENTRY FIELD
       10
           ef-path-exp, 
           Entry-Field, 
           COL 20,86, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-exp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-path-exp-BUF,
           .

      * PUSH BUTTON
       10
           pb-path-exp, 
           Push-Button, 
           COL 99,86, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 2,57 ,
           ENABLED mod,
           EXCEPTION-VALUE 1002,
           FONT IS Small-Font,
           ID IS 149,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-path-backup, 
           Entry-Field, 
           COL 20,86, 
           LINE 10,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-backup,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-path-backup-BUF,
           .

      * PUSH BUTTON
       10
           pb-path-backup-exp, 
           Push-Button, 
           COL 99,86, 
           LINE 10,54,
           LINES 1,31 ,
           SIZE 2,57 ,
           ENABLED mod,
           EXCEPTION-VALUE 1005,
           FONT IS Small-Font,
           ID IS 148,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-articoli, 
           Entry-Field, 
           COL 20,86, 
           LINE 14,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-articoli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-articoli-BUF,
           .

      * ENTRY FIELD
       10
           ef-ean, 
           Entry-Field, 
           COL 20,86, 
           LINE 16,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-ean-BUF,
           .

      * ENTRY FIELD
       10
           ef-prodener, 
           Entry-Field, 
           COL 20,86, 
           LINE 18,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prodener,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-prodener-BUF,
           .

      * ENTRY FIELD
       10
           ef-vettori, 
           Entry-Field, 
           COL 20,86, 
           LINE 20,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vettori,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-vettori-BUF,
           .

      * ENTRY FIELD
       10
           ef-fornitori, 
           Entry-Field, 
           COL 20,86, 
           LINE 22,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-fornitori,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-fornitori-BUF,
           .

      * ENTRY FIELD
       10
           ef-classi, 
           Entry-Field, 
           COL 20,86, 
           LINE 24,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-classi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-classi-BUF,
           .

      * ENTRY FIELD
       10
           ef-tordini, 
           Entry-Field, 
           COL 20,86, 
           LINE 26,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-tordini,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-tordini-BUF,
           .

      * ENTRY FIELD
       10
           ef-rordini, 
           Entry-Field, 
           COL 20,86, 
           LINE 28,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-rordini,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-rordini-BUF,
           .

      * ENTRY FIELD
       10
           ef-note, 
           Entry-Field, 
           COL 20,86, 
           LINE 30,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-note-BUF,
           .

      * ENTRY FIELD
       10
           ef-sito-exp, 
           Entry-Field, 
           COL 20,86, 
           LINE 34,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sito-exp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 100,
           VALUE ef-sito-exp-BUF,
           .

      * ENTRY FIELD
       10
           ef-user-exp, 
           Entry-Field, 
           COL 20,86, 
           LINE 36,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-user-exp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-user-exp-BUF,
           .

      * ENTRY FIELD
       10
           ef-pwd-exp, 
           Entry-Field, 
           COL 20,86, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pwd-exp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           SECURE,
           VALUE ef-pwd-exp-BUF,
           .

      * ENTRY FIELD
       10
           ef-path-rem-exp, 
           Entry-Field, 
           COL 20,86, 
           LINE 40,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-rem-exp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-path-rem-exp-BUF,
           .

      * LABEL
       10
           Screen1-La-4, 
           Label, 
           COL 4,86, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 40,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cartella destinazione",
           .

      * LABEL
       10
           Screen1-La-5, 
           Label, 
           COL 4,86, 
           LINE 10,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cartella Backup",
           .

      * LABEL
       10
           Screen1-La-6, 
           Label, 
           COL 4,86, 
           LINE 14,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 16,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Articoli",
           .

      * LABEL
       10
           Screen1-La-7, 
           Label, 
           COL 4,86, 
           LINE 16,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Ean Articoli",
           .

      * LABEL
       10
           Screen1-La-8, 
           Label, 
           COL 4,86, 
           LINE 18,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 41,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prodotti energetici",
           .

      * LABEL
       10
           Screen1-La-9, 
           Label, 
           COL 4,86, 
           LINE 20,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 42,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettori",
           .

      * LABEL
       10
           Screen1-La-10, 
           Label, 
           COL 4,86, 
           LINE 22,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 43,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Fornitori",
           .

      * LABEL
       10
           Screen1-La-11, 
           Label, 
           COL 4,86, 
           LINE 26,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 44,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Testata Ordini",
           .

      * LABEL
       10
           Screen1-La-12, 
           Label, 
           COL 4,86, 
           LINE 28,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Righe Ordini",
           .

      * LABEL
       10
           Screen1-La-13, 
           Label, 
           COL 4,86, 
           LINE 30,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note Ordini",
           .

      * LABEL
       10
           Screen1-La-15, 
           Label, 
           COL 4,86, 
           LINE 34,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 47,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sito",
           .

      * LABEL
       10
           Form1-La-5aaacaa, 
           Label, 
           COL 3,86, 
           LINE 5,85,
           LINES 1,50 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 48,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Percorsi",
           .

      * BAR
       10
           Form1-Br-2aaa, 
           Bar,
           COL 24,00, 
           LINE 6,69,
           SIZE 79,00 ,
           ID IS 49,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-5aaacaaa, 
           Label, 
           COL 3,86, 
           LINE 12,54,
           LINES 1,50 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 50,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Nomi Files",
           .

      * BAR
       10
           Form1-Br-2aaaa, 
           Bar,
           COL 24,00, 
           LINE 13,39,
           SIZE 79,00 ,
           ID IS 51,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-5aaacaaaa, 
           Label, 
           COL 3,86, 
           LINE 32,08,
           LINES 1,50 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 52,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Parametri FTP",
           .

      * BAR
       10
           Form1-Br-2aaaaa, 
           Bar,
           COL 24,00, 
           LINE 32,92,
           SIZE 79,00 ,
           ID IS 53,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-13a, 
           Label, 
           COL 4,86, 
           LINE 24,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 146,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Classi articoli",
           .

      * LABEL
       10
           Screen1-La-15b, 
           Label, 
           COL 4,86, 
           LINE 36,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 157,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Utente",
           .

      * LABEL
       10
           Screen1-La-15c, 
           Label, 
           COL 4,86, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 158,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Password",
           .

      * LABEL
       10
           Screen1-La-15d, 
           Label, 
           COL 4,86, 
           LINE 40,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 159,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Path remota",
           .

      * PAGE
       05
           Screen1-Pg-2, 
           VISIBLE Screen1-Pg-2-Visible,
           COL 3, 
           LINE 5,
           .

      * ENTRY FIELD
       10
           ef-path-imp, 
           Entry-Field, 
           COL 20,86, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-path-imp-BUF,
           .

      * PUSH BUTTON
       10
           pb-path-imp, 
           Push-Button, 
           COL 99,86, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 2,57 ,
           ENABLED mod,
           EXCEPTION-VALUE 1006,
           FONT IS Small-Font,
           ID IS 170,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-path-backup-imp, 
           Entry-Field, 
           COL 20,86, 
           LINE 10,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-backup-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-path-backup-imp-BUF,
           .

      * PUSH BUTTON
       10
           pb-path-imp-backup, 
           Push-Button, 
           COL 99,86, 
           LINE 10,54,
           LINES 1,31 ,
           SIZE 2,57 ,
           ENABLED mod,
           EXCEPTION-VALUE 1007,
           FONT IS Small-Font,
           ID IS 169,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-articoli-imp, 
           Entry-Field, 
           COL 20,86, 
           LINE 14,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-articoli-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-articoli-imp-BUF,
           .

      * ENTRY FIELD
       10
           ef-tordini-imp, 
           Entry-Field, 
           COL 20,86, 
           LINE 16,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-tordini-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-tordini-imp-BUF,
           .

      * ENTRY FIELD
       10
           ef-rordini-imp, 
           Entry-Field, 
           COL 20,86, 
           LINE 18,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-rordini-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-rordini-imp-BUF,
           .

      * ENTRY FIELD
       10
           ef-sito-imp, 
           Entry-Field, 
           COL 20,86, 
           LINE 34,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sito-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 100,
           VALUE ef-sito-imp-BUF,
           .

      * ENTRY FIELD
       10
           ef-user-imp, 
           Entry-Field, 
           COL 20,86, 
           LINE 36,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-user-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-user-imp-BUF,
           .

      * ENTRY FIELD
       10
           ef-pwd-imp, 
           Entry-Field, 
           COL 20,86, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pwd-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           SECURE,
           VALUE ef-pwd-imp-BUF,
           .

      * ENTRY FIELD
       10
           ef-path-rem-imp, 
           Entry-Field, 
           COL 20,86, 
           LINE 40,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-rem-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-path-rem-imp-BUF,
           .

      * PUSH BUTTON
       10
           Screen1-Pb-1, 
           Push-Button, 
           COL 20,86, 
           LINE 42,54,
           LINES 1,31 ,
           SIZE 25,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1001,
           FONT IS Small-Font,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Copia parametri FTP da Export",
           multiline
           .

      * LABEL
       10
           Screen1-La-4a, 
           Label, 
           COL 4,86, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cartella destinazione",
           .

      * LABEL
       10
           Screen1-La-5a, 
           Label, 
           COL 4,86, 
           LINE 10,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 4,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cartella Backup",
           .

      * LABEL
       10
           Screen1-La-6a, 
           Label, 
           COL 4,86, 
           LINE 14,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 54,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Articoli",
           .

      * LABEL
       10
           Screen1-La-7a, 
           Label, 
           COL 4,86, 
           LINE 16,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 55,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Testata Ordini",
           .

      * LABEL
       10
           Screen1-La-8a, 
           Label, 
           COL 4,86, 
           LINE 18,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 56,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Righe Ordini",
           .

      * LABEL
       10
           Form1-La-5aaacaab, 
           Label, 
           COL 3,86, 
           LINE 5,85,
           LINES 1,50 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 163,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Percorsi",
           .

      * BAR
       10
           Form1-Br-2aaab, 
           Bar,
           COL 24,00, 
           LINE 6,69,
           SIZE 79,00 ,
           ID IS 164,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-5aaacaaab, 
           Label, 
           COL 3,86, 
           LINE 12,54,
           LINES 1,50 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 165,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Nomi Files",
           .

      * BAR
       10
           Form1-Br-2aaaab, 
           Bar,
           COL 24,00, 
           LINE 13,39,
           SIZE 79,00 ,
           ID IS 166,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-15a, 
           Label, 
           COL 4,86, 
           LINE 34,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 168,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sito",
           .

      * LABEL
       10
           Form1-La-5aaacaaaaa, 
           Label, 
           COL 3,86, 
           LINE 32,08,
           LINES 1,54 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 175,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Parametri FTP",
           .

      * BAR
       10
           Form1-Br-2aaaaaa, 
           Bar,
           COL 24,00, 
           LINE 32,92,
           SIZE 79,00 ,
           ID IS 176,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-15ba, 
           Label, 
           COL 4,86, 
           LINE 36,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 179,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Utente",
           .

      * LABEL
       10
           Screen1-La-15ca, 
           Label, 
           COL 4,86, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 181,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Password",
           .

      * LABEL
       10
           Screen1-La-15da, 
           Label, 
           COL 4,86, 
           LINE 40,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 183,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Path remota",
           .

      * PAGE
       05
           Screen1-Pg-3, 
           VISIBLE Screen1-Pg-3-Visible,
           COL 3, 
           LINE 5,
           .

      * ENTRY FIELD
       10
           ef-path-impcar, 
           Entry-Field, 
           COL 20,86, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-impcar,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-path-impcar-BUF,
           .

      * PUSH BUTTON
       10
           pb-path-impcar, 
           Push-Button, 
           COL 99,86, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 2,57 ,
           ENABLED mod,
           EXCEPTION-VALUE 1003,
           FONT IS Small-Font,
           ID IS 189,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-path-backup-impcar, 
           Entry-Field, 
           COL 20,86, 
           LINE 10,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-backup-impcar,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-path-backup-impcar-BUF,
           .

      * PUSH BUTTON
       10
           pb-path-imp-backupcar, 
           Push-Button, 
           COL 99,86, 
           LINE 10,54,
           LINES 1,31 ,
           SIZE 2,57 ,
           ENABLED mod,
           EXCEPTION-VALUE 1008,
           FONT IS Small-Font,
           ID IS 192,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-carichi, 
           Entry-Field, 
           COL 20,86, 
           LINE 14,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-carichi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-carichi-BUF,
           .

      * ENTRY FIELD
       10
           ef-cau, 
           Entry-Field, 
           COL 20,86, 
           LINE 18,54,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cau,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 4,
           VALUE ef-cau-BUF,
           .

      * ENTRY FIELD
       10
           ef-mail, 
           Entry-Field, 
           COL 20,86, 
           LINE 23,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-mail,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 100,
           VALUE ef-mail-BUF,
           .

      * ENTRY FIELD
       10
           ef-mail-cc, 
           Entry-Field, 
           COL 20,86, 
           LINE 25,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-mail-cc,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 100,
           VALUE ef-mail-cc-BUF,
           .

      * ENTRY FIELD
       10
           ef-sito-impcar, 
           Entry-Field, 
           COL 20,86, 
           LINE 34,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sito-impcar,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 100,
           VALUE ef-sito-impcar-BUF,
           .

      * ENTRY FIELD
       10
           ef-user-impcar, 
           Entry-Field, 
           COL 20,86, 
           LINE 36,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-user-impcar,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-user-impcar-BUF,
           .

      * ENTRY FIELD
       10
           ef-pwd-impcar, 
           Entry-Field, 
           COL 20,86, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pwd-impcar,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           SECURE,
           VALUE ef-pwd-impcar-BUF,
           .

      * ENTRY FIELD
       10
           ef-path-rem-impcar, 
           Entry-Field, 
           COL 20,86, 
           LINE 40,54,
           LINES 1,31 ,
           SIZE 79,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-rem-impcar,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 100,
           VALUE ef-path-rem-impcar-BUF,
           .

      * PUSH BUTTON
       10
           Screen1-Pb-1a, 
           Push-Button, 
           COL 20,86, 
           LINE 42,54,
           LINES 1,31 ,
           SIZE 25,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1010,
           FONT IS Small-Font,
           ID IS 203,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Copia parametri FTP da Export",
           multiline
           .

      * LABEL
       10
           Screen1-La-4aa, 
           Label, 
           COL 4,86, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 204,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cartella destinazione",
           .

      * LABEL
       10
           Screen1-La-5aa, 
           Label, 
           COL 4,86, 
           LINE 10,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 205,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cartella Backup",
           .

      * LABEL
       10
           Screen1-La-6aa, 
           Label, 
           COL 4,86, 
           LINE 14,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 206,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Carichi",
           .

      * LABEL
       10
           Form1-La-5aaacaaba, 
           Label, 
           COL 3,86, 
           LINE 5,85,
           LINES 1,50 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 207,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Percorsi",
           .

      * BAR
       10
           Form1-Br-2aaaba, 
           Bar,
           COL 24,00, 
           LINE 6,69,
           SIZE 79,00 ,
           ID IS 208,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-5aaacaaaba, 
           Label, 
           COL 3,86, 
           LINE 12,54,
           LINES 1,54 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 209,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Nomi Files",
           .

      * BAR
       10
           Form1-Br-2aaaaba, 
           Bar,
           COL 24,00, 
           LINE 13,39,
           SIZE 79,00 ,
           ID IS 210,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-15aa, 
           Label, 
           COL 4,86, 
           LINE 34,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 211,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sito",
           .

      * LABEL
       10
           Form1-La-5aaacaaaaaa, 
           Label, 
           COL 3,86, 
           LINE 32,08,
           LINES 1,54 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 212,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Parametri FTP",
           .

      * BAR
       10
           Form1-Br-2aaaaaaa, 
           Bar,
           COL 24,00, 
           LINE 32,92,
           SIZE 79,00 ,
           ID IS 213,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-15baa, 
           Label, 
           COL 4,86, 
           LINE 36,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 214,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Utente",
           .

      * LABEL
       10
           Screen1-La-15caa, 
           Label, 
           COL 4,86, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 215,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Password",
           .

      * LABEL
       10
           Screen1-La-15daa, 
           Label, 
           COL 4,86, 
           LINE 40,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 216,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Path remota",
           .

      * LABEL
       10
           Screen1-La-6aaa, 
           Label, 
           COL 4,86, 
           LINE 18,54,
           LINES 2,00 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 217,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Per evasioni senza ordini",
           .

      * LABEL
       10
           Form1-La-5aaacaaabaa, 
           Label, 
           COL 3,86, 
           LINE 16,54,
           LINES 1,54 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 218,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Causali di magazzino",
           .

      * BAR
       10
           Form1-Br-2aaaabaa, 
           Bar,
           COL 24,00, 
           LINE 17,24,
           SIZE 79,00 ,
           ID IS 219,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * DB_LABEL
       10
           lbl-cau, 
           Label, 
           COL 28,86, 
           LINE 18,54,
           LINES 1,31 ,
           SIZE 47,43 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 220,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lbl-cau-BUF,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-5aaacaaabaaa, 
           Label, 
           COL 3,86, 
           LINE 21,54,
           LINES 1,54 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 221,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Indirizzi Mail",
           .

      * BAR
       10
           Form1-Br-2aaaabaaa, 
           Bar,
           COL 24,00, 
           LINE 22,24,
           SIZE 79,00 ,
           ID IS 222,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-6aab, 
           Label, 
           COL 4,86, 
           LINE 23,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 223,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Mail",
           .

      * LABEL
       10
           Screen1-La-6aac, 
           Label, 
           COL 4,86, 
           LINE 25,54,
           LINES 1,31 ,
           SIZE 14,57 ,
           FONT IS Small-Font,
           ID IS 224,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Mail CC",
           .

      * LABEL
       05
           Screen1-Custom1-1, 
           Label, 
           COL 71,57, 
           LINE 1,38,
           LINES 0,69 ,
           SIZE 7,14 ,
           FONT IS Default-Font,
           ID IS 225,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Screen1-blockpgm-2, 
           Label, 
           COL 90,29, 
           LINE 1,08,
           LINES 1,00 ,
           SIZE 8,14 ,
           ID IS 226,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 72,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 6,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 23,
           FRAMED,
           SQUARE,
           ENABLED 0,
           EXCEPTION-VALUE 2,
           FLAT,
           ID IS 73,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 16,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 16,
           FRAMED,
           SQUARE,
           ENABLED 0,
           EXCEPTION-VALUE 4,
           FLAT,
           ID IS 74,
           SELF-ACT,
           TITLE "Cancella (F4)",
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 11,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 75,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 26,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 17,
           FRAMED,
           SQUARE,
           ENABLED E-ANTEPRIMA,
           EXCEPTION-VALUE 6,
           FLAT,
           ID IS 76,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 21,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 5,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 77,
           SELF-ACT,
           TITLE "Modifica (F5)",
           VALUE MOD,
           BITMAP-NUMBER BitmapNumEdit
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 31,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 18,
           FRAMED,
           SQUARE,
           ENABLED E-STAMPA,
           EXCEPTION-VALUE 7,
           FLAT,
           ID IS 110,
           SELF-ACT,
           TITLE "Stampa (F7)",
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 36,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 111,
           SELF-ACT,
           TITLE "Cerca (F8)",
           VISIBLE 1,
           BITMAP-NUMBER BitmapNumZoom
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, USER-CODI, LIVELLO-ABIL.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:SHI-param, INIT:SHI-param, BeforeDeclarative>
       paramshi-ERR SECTION.
           use after error procedure on paramshi.
           set RecLocked to false.
           evaluate status-paramshi
           when "35"
                display message "File [paramshi] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [paramshi] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[paramshi] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "99"
           when "93"
                set RecLocked to true
                set errori    to true
                move 1 to mod-k
                move 0 to mod
                modify tool-modifica, value = mod
                display form1
                set StatusVisua to true
                move "00" to status-paramshi
                if ReadSecca
                   read paramshi       no lock 
                        invalid      continue
                        not invalid  perform FORM1-IUD-DISPLAY
                   end-read
                end-if
                display message box MSG-Record-gia-in-uso
                        title = tit-err
                        icon is mb-error-icon
           when "23"
                move 1 to mod-k
                move 0 to mod
                modify tool-modifica, value = mod
                set StatusVisua to true
                if nuovo              
                   initialize shi-dati replacing numeric data by zeroes
                                            alphanumeric data by spaces
                   perform FORM1-FLD-TO-BUF
                   display form1-tb-1
                   set vecchio to true
                end-if    
                perform ABILITAZIONI
                display form1
                |RISETTO IL VALORE A "23" PERCHE DENTRO AL PAR. CLEAR-SCREEN
                |CON L'OPERAZIONE UNLOCK VIENE RISETTATO A ZERO COSICCHÈ 
                |QUANDO TORNA DENTRO AI PAR. DI SCORRIMENTO DI TOTEM SI 
                |TROVA IN UNA SITUAZIONE CORRETTA E PROSEGUE CON LA READ
                |USCENDO CON UN MESSAGGIO DI ERRORE DI TIPO "46"
                move "23" to status-paramshi
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM ginqui-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:SHI-param, INIT:SHI-param, BeforeDestroyResource>
      * <TOTEM:END>
           CALL "w$bitmap" USING WBITMAP-DESTROY, TOOLBAR-BMP
      *    After-Program
           PERFORM ginqui-Ev-After-Program
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
           .

       INIT-BMP.
      * TOOL-ESCI
           COPY RESOURCE "TOOLBAR.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "TOOLBAR.BMP", 
                   GIVING TOOLBAR-BMP.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-tcaumag
           PERFORM OPEN-tmagaz
           PERFORM OPEN-paramSHI
      *    After Open
           .

       OPEN-tcaumag.
      * <TOTEM:EPT. INIT:SHI-param, FD:tcaumag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcaumag
           IF NOT Valid-STATUS-tcaumag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:SHI-param, FD:tcaumag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmagaz.
      * <TOTEM:EPT. INIT:SHI-param, FD:tmagaz, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmagaz
           IF NOT Valid-STATUS-tmagaz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:SHI-param, FD:tmagaz, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-paramSHI.
      * <TOTEM:EPT. INIT:SHI-param, FD:paramSHI, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O paramSHI
           IF STATUS-paramshi = "35"
              OPEN OUTPUT paramSHI
                IF Valid-STATUS-paramshi
                   CLOSE paramSHI
                   OPEN I-O paramSHI
                END-IF
           END-IF
           IF NOT Valid-STATUS-paramshi
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:SHI-param, FD:paramSHI, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-tcaumag
           PERFORM CLOSE-tmagaz
           PERFORM CLOSE-paramSHI
      *    After Close
           .

       CLOSE-tcaumag.
      * <TOTEM:EPT. INIT:SHI-param, FD:tcaumag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcaumag
           .

       CLOSE-tmagaz.
      * <TOTEM:EPT. INIT:SHI-param, FD:tmagaz, BeforeClose>
      * <TOTEM:END>
           CLOSE tmagaz
           .

       CLOSE-paramSHI.
      * <TOTEM:EPT. INIT:SHI-param, FD:paramSHI, BeforeClose>
      * <TOTEM:END>
           CLOSE paramSHI
           .

       tcaumag-k-mag-MERGE-SPLITBUF.
           INITIALIZE tcaumag-k-mag-SPLITBUF
           MOVE tca-cod-magaz(1:3) TO tcaumag-k-mag-SPLITBUF(1:3)
           MOVE tca-ord-forn(1:1) TO tcaumag-k-mag-SPLITBUF(4:1)
           .

       DataSet1-tcaumag-INITSTART.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE Low-Value TO tca-chiave
           ELSE
              MOVE High-Value TO tca-chiave
           END-IF
           .

       DataSet1-tcaumag-INITEND.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE High-Value TO tca-chiave
           ELSE
              MOVE Low-Value TO tca-chiave
           END-IF
           .

      * tcaumag
       DataSet1-tcaumag-START.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY >= tca-chiave
           ELSE
              START tcaumag KEY <= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-NOTGREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY <= tca-chiave
           ELSE
              START tcaumag KEY >= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-GREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY > tca-chiave
           ELSE
              START tcaumag KEY < tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-LESS.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY < tca-chiave
           ELSE
              START tcaumag KEY > tca-chiave
           END-IF
           .

       DataSet1-tcaumag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcaumag-LOCK
              READ tcaumag WITH LOCK 
              KEY tca-chiave
           ELSE
              READ tcaumag WITH NO LOCK 
              KEY tca-chiave
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT 
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-INITSTART.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE Low-Value TO mag-chiave
           ELSE
              MOVE High-Value TO mag-chiave
           END-IF
           .

       DataSet1-tmagaz-INITEND.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE High-Value TO mag-chiave
           ELSE
              MOVE Low-Value TO mag-chiave
           END-IF
           .

      * tmagaz
       DataSet1-tmagaz-START.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY >= mag-chiave
           ELSE
              START tmagaz KEY <= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-NOTGREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY <= mag-chiave
           ELSE
              START tmagaz KEY >= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-GREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY > mag-chiave
           ELSE
              START tmagaz KEY < mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-LESS.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY < mag-chiave
           ELSE
              START tmagaz KEY > mag-chiave
           END-IF
           .

       DataSet1-tmagaz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmagaz-LOCK
              READ tmagaz WITH LOCK 
              KEY mag-chiave
           ELSE
              READ tmagaz WITH NO LOCK 
              KEY mag-chiave
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT 
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-paramSHI-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-paramSHI-KEY1-Asc
                 MOVE Low-Value TO shi-chiave OF paramSHI
              ELSE
                 MOVE High-Value TO shi-chiave OF paramSHI
              END-IF
           END-EVALUATE
           .

       DataSet1-paramSHI-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-paramSHI-KEY1-Asc
                 MOVE High-Value TO shi-chiave OF paramSHI
              ELSE
                 MOVE Low-Value TO shi-chiave OF paramSHI
              END-IF
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-paramSHI-KEY1-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-paramSHI-KEY1-ORDER
           END-EVALUATE
           .

      * paramSHI
       DataSet1-paramSHI-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-paramSHI-KEY1-Asc
                 START paramSHI KEY >= shi-chiave OF paramSHI
              ELSE
                 START paramSHI KEY <= shi-chiave OF paramSHI
              END-IF
           END-EVALUATE
           .

       DataSet1-paramSHI-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-paramSHI-KEY1-Asc
                 START paramSHI KEY <= shi-chiave OF paramSHI
              ELSE
                 START paramSHI KEY >= shi-chiave OF paramSHI
              END-IF
           END-EVALUATE
           .

       DataSet1-paramSHI-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-paramSHI-KEY1-Asc
                 START paramSHI KEY > shi-chiave OF paramSHI
              ELSE
                 START paramSHI KEY < shi-chiave OF paramSHI
              END-IF
           END-EVALUATE
           .

       DataSet1-paramSHI-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-paramSHI-KEY1-Asc
                 START paramSHI KEY < shi-chiave OF paramSHI
              ELSE
                 START paramSHI KEY > shi-chiave OF paramSHI
              END-IF
           END-EVALUATE
           .

       DataSet1-paramSHI-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-paramSHI-LOCK
                 READ paramSHI WITH LOCK 
                 KEY shi-chiave OF paramSHI
              ELSE
                 READ paramSHI WITH NO LOCK 
                 KEY shi-chiave OF paramSHI
              END-IF
           END-EVALUATE
           MOVE STATUS-paramshi TO TOTEM-ERR-STAT 
           MOVE "paramSHI" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-paramSHI-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-paramSHI-KEY1-Asc
                 IF DataSet1-paramSHI-LOCK
                    READ paramSHI NEXT WITH LOCK
                 ELSE
                    READ paramSHI NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-paramSHI-LOCK
                    READ paramSHI PREVIOUS WITH LOCK
                 ELSE
                    READ paramSHI PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           MOVE STATUS-paramshi TO TOTEM-ERR-STAT
           MOVE "paramSHI" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-paramSHI-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-paramSHI-KEY1-Asc
                 IF DataSet1-paramSHI-LOCK
                    READ paramSHI PREVIOUS WITH LOCK
                 ELSE
                    READ paramSHI PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-paramSHI-LOCK
                    READ paramSHI NEXT WITH LOCK
                 ELSE
                    READ paramSHI NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           MOVE STATUS-paramshi TO TOTEM-ERR-STAT
           MOVE "paramSHI" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-paramSHI-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, BeforeWrite>
      * <TOTEM:END>
           WRITE shi-rec OF paramSHI.
           MOVE STATUS-paramshi TO TOTEM-ERR-STAT
           MOVE "paramSHI" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-paramSHI-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, BeforeRewrite>
      * <TOTEM:END>
           REWRITE shi-rec OF paramSHI.
           MOVE STATUS-paramshi TO TOTEM-ERR-STAT
           MOVE "paramSHI" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-paramSHI-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, BeforeDelete>
      * <TOTEM:END>
           DELETE paramSHI.
           MOVE STATUS-paramshi TO TOTEM-ERR-STAT
           MOVE "paramSHI" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:paramSHI, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE tca-rec OF tcaumag
           INITIALIZE mag-rec OF tmagaz
           INITIALIZE shi-rec OF paramSHI
           .


       DataSet1-paramSHI-REF-tcaumag-KEY.
           MOVE shi-causale-impcar TO tca-codice
           .

       DataSet1-paramSHI-REF-tcaumag.
           PERFORM DataSet1-tcaumag-INITREC
           PERFORM DataSet1-paramSHI-REF-tcaumag-KEY
           PERFORM DataSet1-Relation2-EXPRESSION
           PERFORM DataSet1-tcaumag-READ
           IF NOT Valid-STATUS-tcaumag
              PERFORM DataSet1-tcaumag-INITREC
           END-IF
           .

      * RI TYPE : Restricted
       DataSet1-paramSHI-REF-tcaumag-INS.
           .

      * RI TYPE : Restricted
       DataSet1-paramSHI-REF-tcaumag-UPD.
           .

      * RI TYPE : Restricted
       DataSet1-paramSHI-REF-tcaumag-DEL.
           .

      * FD's Initialize Paragraph
       DataSet1-tcaumag-INITREC.
           INITIALIZE tca-rec OF tcaumag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmagaz-INITREC.
           INITIALIZE mag-rec OF tmagaz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-paramSHI-INITREC.
           INITIALIZE shi-rec OF paramSHI
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           PERFORM DataSet1-tcaumag-INITREC
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           EVALUATE TOTEM-Form-Index ALSO TOTEM-Frame-Index
              WHEN 1 ALSO 0
                  PERFORM Form1-Buf-To-Fld
           END-EVALUATE
           .

       DataSet1-Relation2-EXPRESSION.
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
           SET ENVIRONMENT "KEYSTROKE" TO "EXCEPTION=32001 KT".
           SET ENVIRONMENT "KEYSTROKE" TO "EXCEPTION=32002 KB".
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              LINES 47,92,
              SIZE 105,00,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              LABEL-OFFSET 23,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Screen1-Event-Proc,
              HANDLE IS form1-Handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              FONT IS Small-Font,
              GRIP,
              PANEL-WIDTHS (65, 20, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON form1-Handle
      * DISPLAY-COLUMNS settings
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           perform INIT.
           perform ABILITA-TOOLBAR.

      * SPECIFICO DEL PGM "paramedi"
           modify TOOL-NUOVO,    enabled ZERO.
           modify TOOL-CANCELLA, enabled ZERO.
      * FINE

           perform ABILITAZIONI.
           perform PRIMO.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY form1-Handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
           evaluate key-status
           when 5 |MODIFICA
                inquire tool-modifica, enabled in e-modifica
                if e-modifica = 1
                   if mod = zero 
                      move 1    to mod
                   else          
                      move zero to mod
                   end-if
                   modify tool-modifica, value = mod
                   perform MODIFICA
                end-if
           end-evaluate.

           .
      * <TOTEM:END>
           IF Key-Status = KEY-KT-VALUE
               INQUIRE Screen1-Ta-1, VALUE IN Screen1-Ta-1-TAB-VALUE
               IF Screen1-Ta-1-TAB-VALUE NOT = 1 | First Page
                 SUBTRACT 1 FROM Screen1-Ta-1-TAB-VALUE
                 MODIFY Screen1-Ta-1, VALUE IS Screen1-Ta-1-TAB-VALUE
                 PERFORM Screen1-Ta-1-TABCHANGE
               END-IF
            END-IF
           IF Key-Status =KEY-KB-VALUE
               INQUIRE Screen1-Ta-1, VALUE IN Screen1-Ta-1-TAB-VALUE
               IF Screen1-Ta-1-TAB-VALUE NOT = 4 | LAST Page
                 ADD 1 TO Screen1-Ta-1-TAB-VALUE
                 MODIFY Screen1-Ta-1, VALUE IS Screen1-Ta-1-TAB-VALUE
                 PERFORM Screen1-Ta-1-TABCHANGE
               END-IF
           END-IF
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
                 IF Event-Type = Cmd-Tabchanged AND 
                                 Event-Control-Id = 2
                    MOVE EVENT-DATA-1 TO Screen1-Ta-1-TAB-VALUE
                    PERFORM Screen1-Ta-1-TABCHANGE
                 END-IF

              WHEN Key-Status = 1000
                 PERFORM pb-report-server-LinkTo
              WHEN Key-Status = 1004
                 PERFORM pb-report-client-LinkTo
              WHEN Key-Status = 1002
                 PERFORM pb-path-exp-LinkTo
              WHEN Key-Status = 1005
                 PERFORM pb-path-backup-exp-LinkTo
              WHEN Key-Status = 1006
                 PERFORM pb-path-imp-LinkTo
              WHEN Key-Status = 1007
                 PERFORM pb-path-imp-backup-LinkTo
              WHEN Key-Status = 1001
                 PERFORM Screen1-Pb-1-LinkTo
              WHEN Key-Status = 1003
                 PERFORM pb-path-impcar-LinkTo
              WHEN Key-Status = 1008
                 PERFORM pb-path-imp-backupcar-LinkTo
              WHEN Key-Status = 1010
                 PERFORM Screen1-Pb-1a-LinkTo
              WHEN Key-Status = 2
                 PERFORM NUOVO-LinkTo
              WHEN Key-Status = 4
                 PERFORM CANCELLA-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON form1-Handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
           perform SALV-MOD.

           if errori
              move 26 to KEY-STATUS
              exit paragraph
           end-if.

           .
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * TAB
              MODIFY Screen1-Ta-1, RESET-TABS = 1
              MODIFY Screen1-Ta-1, 
           TAB-TO-ADD = (
                 "Parametri Generali",
                 "Export",
                 "Import",
                 "Import Carichi",
                        )
           MOVE 0 TO 
                   Screen1-Pg-4-Visible,
                   Screen1-Pg-1-Visible,
                   Screen1-Pg-2-Visible,
                   Screen1-Pg-3-Visible,
           MOVE 1 TO Screen1-Pg-4-Visible
           PERFORM Screen1-Ta-1-TABCHANGE
           .

       Form1-DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-paramSHI-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-paramSHI-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Update-Key.
           MOVE shi-rec OF paramSHI TO
                     Form1-MULKEY-TMPBUF
           PERFORM Form1-CLEAR
           PERFORM Form1-INIT-DATA
           MOVE Form1-MULKEY-TMPBUF TO
                     shi-rec OF paramSHI
           PERFORM DataSet1-paramSHI-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
           .

       Form1-DUPLICATE-MOVEKEY.
           .

       Form1-First.
           PERFORM Form1-DUMMY-FIRST
           PERFORM DataSet1-paramSHI-INITSTART
           PERFORM DataSet1-paramSHI-START
           IF NOT Valid-STATUS-paramshi
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFirst>
      * <TOTEM:END>
           PERFORM DataSet1-paramSHI-Read-Next
           IF NOT Valid-STATUS-paramshi
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFirst>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Previous.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-paramSHI-START-LESS
           IF NOT Valid-STATUS-paramshi
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforePrevious>
      * <TOTEM:END>
           PERFORM DataSet1-paramSHI-Read-Prev
           IF NOT Valid-STATUS-paramshi
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterPrevious>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-PREVIOUS
           PERFORM Form1-IUD-Display
           .

       Form1-Next.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-paramSHI-START-GREATER
           IF NOT Valid-STATUS-paramshi
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeNext>
      * <TOTEM:END>
           PERFORM DataSet1-paramSHI-Read-Next
           IF NOT Valid-STATUS-paramshi
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterNext>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-NEXT
           PERFORM Form1-IUD-Display
           .
      
       Form1-Last.
           PERFORM Form1-DUMMY-LAST
           PERFORM DataSet1-paramSHI-INITEND
           PERFORM DataSet1-paramSHI-START-NOTGREATER
           IF NOT Valid-STATUS-paramshi
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeLast>
      * <TOTEM:END>
           PERFORM DataSet1-paramSHI-Read-Prev
           IF NOT Valid-STATUS-paramshi
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterLast>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Curr.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeCurrent>
      * <TOTEM:END>
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-paramSHI-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCurrent>
      * <TOTEM:END>
           .

       Form1-IUD-Display.
           IF Valid-STATUS-paramshi
              PERFORM Form1-ALLGRID-RESET
              PERFORM DataSet1-paramSHI-REF-tcaumag
              PERFORM Form1-Fld-To-Buf
              PERFORM Form1-NAVI-FOR-MASTERGRID
              PERFORM Form1-DISPLAY
           ELSE
              IF Form1-FLAG-REFRESH
                 CONTINUE
              ELSE
                 PERFORM Form1-Extended-File-Status
              END-IF
           END-IF
           .

       Form1-Add.
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-ADD
           PERFORM DataSet1-paramSHI-INITREC
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAdd>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-paramSHI-Rec-Write
           IF Valid-STATUS-paramshi
              PERFORM Form1-RESUMMARY-INS
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "301" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAdd>
      * <TOTEM:END>
           .
     
       Form1-Update.
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-paramSHI-START              
           IF NOT Valid-STATUS-paramshi
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
           PERFORM DataSet1-paramSHI-Read
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-UPDATE
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeUpdate>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-paramSHI-Rec-Rewrite
           IF Valid-STATUS-paramshi
              PERFORM Form1-RESUMMARY-DEL
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "302" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterUpdate>
      * <TOTEM:END>
           .

       Form1-Delete.
           MOVE "203" TO TOTEM-MSG-ID
           PERFORM MESSAGE-BOX-DISPLAY
           IF TOTEM-MSG-RETURN-VALUE NOT = 1
              INITIALIZE TOTEM-MSG-TEXT
              EXIT PARAGRAPH 
           END-IF
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDelete>
      * <TOTEM:END>
           PERFORM Form1-DUMMY-DELETE
      * delete
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-paramSHI-Rec-Delete
           IF Valid-STATUS-paramshi
              PERFORM Form1-CLEAR
              PERFORM Form1-DUMMY-DELETE-INIT
              MOVE "303" TO TOTEM-MSG-ID
              MOVE "00" to STATUS-paramshi
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDelete>
      * <TOTEM:END>
           PERFORM Form1-ERR-CHECKING
           .

       Form1-NAVI-FOR-MASTERGRID.
           .

       Form1-ERR-CHECKING.
           IF Valid-STATUS-paramshi
              PERFORM Form1-SHOW-MSG-ROUTINE
           ELSE
              PERFORM Form1-Extended-File-Status
           END-IF
           .

       Form1-RESUMMARY-INS.
           .

       Form1-RESUMMARY-DEL.
           .


       Form1-DUMMY-FIRST.
           .

       Form1-DUMMY-PREVIOUS.
           .

       Form1-DUMMY-NEXT.
           .

       Form1-DUMMY-LAST.
           .

       Form1-DUMMY-CURR.
           .

       Form1-DUMMY-ADD.
           .

       Form1-DUMMY-UPDATE.
           .

       Form1-DUMMY-UPDATE-INIT.
           .

       Form1-DUMMY-DELETE.
           .

       Form1-DUMMY-DELETE-INIT.
           .

       Form1-Init-Value.
           MOVE titolo TO TOTEM-MSG-TITLE
           INITIALIZE Form1-BUF
      * FORM : Form1
           PERFORM DataSet1-INIT-RECORD
      * DB_LABEL
              MOVE "tca-descrizione" TO tca-descrizione
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
      * ef-cod-commitente's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cod-commitente-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5001 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mag-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mag-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5002 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mag-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mag-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5003 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-log-server's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-log-server-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5004 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-log-client's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-log-client-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5005 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sem's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sem-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5006 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mail-mod-bozze's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mail-mod-bozze-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 193 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mail-cc-mod-bozze's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mail-cc-mod-bozze-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 194 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ogg-canc-bozze's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ogg-canc-bozze-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5007 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-corpo-canc-bozze's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-corpo-canc-bozze-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5008 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ogg-mod-bozze's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ogg-mod-bozze-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5009 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-corpo-mod-bozze's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-corpo-mod-bozze-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5010 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-exp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-exp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5011 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-backup's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-backup-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5012 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-articoli's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-articoli-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5013 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5014 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prodener's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prodener-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5015 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vettori's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vettori-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5016 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-fornitori's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-fornitori-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5017 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-classi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-classi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5018 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-tordini's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-tordini-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5019 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-rordini's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-rordini-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5020 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5021 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sito-exp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sito-exp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5022 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-user-exp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-user-exp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5023 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pwd-exp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pwd-exp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5024 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-rem-exp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-rem-exp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5025 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5026 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-backup-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-backup-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5027 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-articoli-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-articoli-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5028 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-tordini-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-tordini-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5029 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-rordini-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-rordini-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5030 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sito-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sito-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5031 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-user-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-user-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5032 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pwd-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pwd-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5033 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-rem-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-rem-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5034 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-impcar's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-impcar-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5035 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-backup-impcar's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-backup-impcar-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5036 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-carichi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-carichi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5037 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cau's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cau-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5038 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mail's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mail-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5039 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mail-cc's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mail-cc-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5040 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sito-impcar's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sito-impcar-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5041 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-user-impcar's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-user-impcar-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5042 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pwd-impcar's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pwd-impcar-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5043 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-path-rem-impcar's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-path-rem-impcar-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5044 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
           .

       ef-cod-commitente-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-commitente, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cod-commitente-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-commitente, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cod-commitente's Validation
       ef-cod-commitente-VALIDATION.
           PERFORM ef-cod-commitente-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cod-commitente-AFTER-VALIDATION
           .

       ef-mag-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mag-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mag-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mag-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mag-1's Validation
       ef-mag-1-VALIDATION.
           PERFORM ef-mag-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mag-1-AFTER-VALIDATION
           .

       ef-mag-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mag-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mag-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mag-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mag-2's Validation
       ef-mag-2-VALIDATION.
           PERFORM ef-mag-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mag-2-AFTER-VALIDATION
           .

       ef-path-log-server-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-log-server, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-log-server-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-log-server, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-log-server's Validation
       ef-path-log-server-VALIDATION.
           PERFORM ef-path-log-server-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-log-server-AFTER-VALIDATION
           .

       ef-path-log-client-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-log-client, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-log-client-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-log-client, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-log-client's Validation
       ef-path-log-client-VALIDATION.
           PERFORM ef-path-log-client-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-log-client-AFTER-VALIDATION
           .

       ef-sem-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sem, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sem-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sem, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sem's Validation
       ef-sem-VALIDATION.
           PERFORM ef-sem-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sem-AFTER-VALIDATION
           .

       ef-mail-mod-bozze-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail-mod-bozze, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mail-mod-bozze-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail-mod-bozze, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mail-mod-bozze's Validation
       ef-mail-mod-bozze-VALIDATION.
           PERFORM ef-mail-mod-bozze-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mail-mod-bozze-AFTER-VALIDATION
           .

       ef-mail-cc-mod-bozze-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail-cc-mod-bozze, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mail-cc-mod-bozze-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail-cc-mod-bozze, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mail-cc-mod-bozze's Validation
       ef-mail-cc-mod-bozze-VALIDATION.
           PERFORM ef-mail-cc-mod-bozze-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mail-cc-mod-bozze-AFTER-VALIDATION
           .

       ef-ogg-canc-bozze-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ogg-canc-bozze, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ogg-canc-bozze-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ogg-canc-bozze, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ogg-canc-bozze's Validation
       ef-ogg-canc-bozze-VALIDATION.
           PERFORM ef-ogg-canc-bozze-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ogg-canc-bozze-AFTER-VALIDATION
           .

       ef-corpo-canc-bozze-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-corpo-canc-bozze, BeforeValidation>
      * <TOTEM:END>
           .

       ef-corpo-canc-bozze-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-corpo-canc-bozze, AfterValidation>
      * <TOTEM:END>
           .

      * ef-corpo-canc-bozze's Validation
       ef-corpo-canc-bozze-VALIDATION.
           PERFORM ef-corpo-canc-bozze-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-corpo-canc-bozze-AFTER-VALIDATION
           .

       ef-ogg-mod-bozze-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ogg-mod-bozze, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ogg-mod-bozze-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ogg-mod-bozze, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ogg-mod-bozze's Validation
       ef-ogg-mod-bozze-VALIDATION.
           PERFORM ef-ogg-mod-bozze-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ogg-mod-bozze-AFTER-VALIDATION
           .

       ef-corpo-mod-bozze-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-corpo-mod-bozze, BeforeValidation>
      * <TOTEM:END>
           .

       ef-corpo-mod-bozze-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-corpo-mod-bozze, AfterValidation>
      * <TOTEM:END>
           .

      * ef-corpo-mod-bozze's Validation
       ef-corpo-mod-bozze-VALIDATION.
           PERFORM ef-corpo-mod-bozze-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-corpo-mod-bozze-AFTER-VALIDATION
           .

       ef-path-exp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-exp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-exp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-exp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-exp's Validation
       ef-path-exp-VALIDATION.
           PERFORM ef-path-exp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-exp-AFTER-VALIDATION
           .

       ef-path-backup-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-backup, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-backup-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-backup, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-backup's Validation
       ef-path-backup-VALIDATION.
           PERFORM ef-path-backup-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-backup-AFTER-VALIDATION
           .

       ef-articoli-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-articoli, BeforeValidation>
      * <TOTEM:END>
           .

       ef-articoli-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-articoli, AfterValidation>
      * <TOTEM:END>
           .

      * ef-articoli's Validation
       ef-articoli-VALIDATION.
           PERFORM ef-articoli-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-articoli-AFTER-VALIDATION
           .

       ef-ean-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean's Validation
       ef-ean-VALIDATION.
           PERFORM ef-ean-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-AFTER-VALIDATION
           .

       ef-prodener-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prodener, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prodener-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prodener, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prodener's Validation
       ef-prodener-VALIDATION.
           PERFORM ef-prodener-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prodener-AFTER-VALIDATION
           .

       ef-vettori-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vettori, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vettori-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vettori, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vettori's Validation
       ef-vettori-VALIDATION.
           PERFORM ef-vettori-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vettori-AFTER-VALIDATION
           .

       ef-fornitori-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fornitori, BeforeValidation>
      * <TOTEM:END>
           .

       ef-fornitori-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fornitori, AfterValidation>
      * <TOTEM:END>
           .

      * ef-fornitori's Validation
       ef-fornitori-VALIDATION.
           PERFORM ef-fornitori-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-fornitori-AFTER-VALIDATION
           .

       ef-classi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-classi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-classi's Validation
       ef-classi-VALIDATION.
           PERFORM ef-classi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-classi-AFTER-VALIDATION
           .

       ef-tordini-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tordini, BeforeValidation>
      * <TOTEM:END>
           .

       ef-tordini-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tordini, AfterValidation>
      * <TOTEM:END>
           .

      * ef-tordini's Validation
       ef-tordini-VALIDATION.
           PERFORM ef-tordini-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-tordini-AFTER-VALIDATION
           .

       ef-rordini-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-rordini, BeforeValidation>
      * <TOTEM:END>
           .

       ef-rordini-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-rordini, AfterValidation>
      * <TOTEM:END>
           .

      * ef-rordini's Validation
       ef-rordini-VALIDATION.
           PERFORM ef-rordini-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-rordini-AFTER-VALIDATION
           .

       ef-note-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note's Validation
       ef-note-VALIDATION.
           PERFORM ef-note-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-AFTER-VALIDATION
           .

       ef-sito-exp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sito-exp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sito-exp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sito-exp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sito-exp's Validation
       ef-sito-exp-VALIDATION.
           PERFORM ef-sito-exp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sito-exp-AFTER-VALIDATION
           .

       ef-user-exp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-user-exp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-user-exp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-user-exp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-user-exp's Validation
       ef-user-exp-VALIDATION.
           PERFORM ef-user-exp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-user-exp-AFTER-VALIDATION
           .

       ef-pwd-exp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pwd-exp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pwd-exp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pwd-exp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pwd-exp's Validation
       ef-pwd-exp-VALIDATION.
           PERFORM ef-pwd-exp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pwd-exp-AFTER-VALIDATION
           .

       ef-path-rem-exp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-rem-exp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-rem-exp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-rem-exp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-rem-exp's Validation
       ef-path-rem-exp-VALIDATION.
           PERFORM ef-path-rem-exp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-rem-exp-AFTER-VALIDATION
           .

       ef-path-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-imp's Validation
       ef-path-imp-VALIDATION.
           PERFORM ef-path-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-imp-AFTER-VALIDATION
           .

       ef-path-backup-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-backup-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-backup-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-backup-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-backup-imp's Validation
       ef-path-backup-imp-VALIDATION.
           PERFORM ef-path-backup-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-backup-imp-AFTER-VALIDATION
           .

       ef-articoli-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-articoli-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-articoli-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-articoli-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-articoli-imp's Validation
       ef-articoli-imp-VALIDATION.
           PERFORM ef-articoli-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-articoli-imp-AFTER-VALIDATION
           .

       ef-tordini-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tordini-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-tordini-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tordini-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-tordini-imp's Validation
       ef-tordini-imp-VALIDATION.
           PERFORM ef-tordini-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-tordini-imp-AFTER-VALIDATION
           .

       ef-rordini-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-rordini-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-rordini-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-rordini-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-rordini-imp's Validation
       ef-rordini-imp-VALIDATION.
           PERFORM ef-rordini-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-rordini-imp-AFTER-VALIDATION
           .

       ef-sito-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sito-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sito-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sito-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sito-imp's Validation
       ef-sito-imp-VALIDATION.
           PERFORM ef-sito-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sito-imp-AFTER-VALIDATION
           .

       ef-user-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-user-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-user-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-user-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-user-imp's Validation
       ef-user-imp-VALIDATION.
           PERFORM ef-user-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-user-imp-AFTER-VALIDATION
           .

       ef-pwd-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pwd-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pwd-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pwd-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pwd-imp's Validation
       ef-pwd-imp-VALIDATION.
           PERFORM ef-pwd-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pwd-imp-AFTER-VALIDATION
           .

       ef-path-rem-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-rem-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-rem-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-rem-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-rem-imp's Validation
       ef-path-rem-imp-VALIDATION.
           PERFORM ef-path-rem-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-rem-imp-AFTER-VALIDATION
           .

       ef-path-impcar-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-impcar, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-impcar-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-impcar, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-impcar's Validation
       ef-path-impcar-VALIDATION.
           PERFORM ef-path-impcar-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-impcar-AFTER-VALIDATION
           .

       ef-path-backup-impcar-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-backup-impcar, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-backup-impcar-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-backup-impcar, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-backup-impcar's Validation
       ef-path-backup-impcar-VALIDATION.
           PERFORM ef-path-backup-impcar-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-backup-impcar-AFTER-VALIDATION
           .

       ef-carichi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-carichi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-carichi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-carichi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-carichi's Validation
       ef-carichi-VALIDATION.
           PERFORM ef-carichi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-carichi-AFTER-VALIDATION
           .

       ef-cau-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cau-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cau's Validation
       ef-cau-VALIDATION.
           PERFORM ef-cau-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cau-AFTER-VALIDATION
           .

       ef-mail-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mail-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mail's Validation
       ef-mail-VALIDATION.
           PERFORM ef-mail-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mail-AFTER-VALIDATION
           .

       ef-mail-cc-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail-cc, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mail-cc-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail-cc, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mail-cc's Validation
       ef-mail-cc-VALIDATION.
           PERFORM ef-mail-cc-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mail-cc-AFTER-VALIDATION
           .

       ef-sito-impcar-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sito-impcar, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sito-impcar-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sito-impcar, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sito-impcar's Validation
       ef-sito-impcar-VALIDATION.
           PERFORM ef-sito-impcar-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sito-impcar-AFTER-VALIDATION
           .

       ef-user-impcar-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-user-impcar, BeforeValidation>
      * <TOTEM:END>
           .

       ef-user-impcar-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-user-impcar, AfterValidation>
      * <TOTEM:END>
           .

      * ef-user-impcar's Validation
       ef-user-impcar-VALIDATION.
           PERFORM ef-user-impcar-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-user-impcar-AFTER-VALIDATION
           .

       ef-pwd-impcar-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pwd-impcar, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pwd-impcar-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pwd-impcar, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pwd-impcar's Validation
       ef-pwd-impcar-VALIDATION.
           PERFORM ef-pwd-impcar-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pwd-impcar-AFTER-VALIDATION
           .

       ef-path-rem-impcar-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-rem-impcar, BeforeValidation>
      * <TOTEM:END>
           .

       ef-path-rem-impcar-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-path-rem-impcar, AfterValidation>
      * <TOTEM:END>
           .

      * ef-path-rem-impcar's Validation
       ef-path-rem-impcar-VALIDATION.
           PERFORM ef-path-rem-impcar-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-path-rem-impcar-AFTER-VALIDATION
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * DB_Entry-Field : ef-cod-commitente
           MOVE ef-cod-commitente-BUF TO shi-cod-SHI
      * DB_Entry-Field : ef-mag-1
           MOVE ef-mag-1-BUF TO shi-mag-SHI-1
      * DB_Entry-Field : ef-mag-2
           MOVE ef-mag-2-BUF TO shi-mag-SHI-2
      * DB_Entry-Field : ef-path-log-server
           MOVE ef-path-log-server-BUF TO shi-path-report-server
      * DB_Entry-Field : ef-path-log-client
           MOVE ef-path-log-client-BUF TO shi-path-report-client
      * DB_Entry-Field : ef-sem
           MOVE ef-sem-BUF TO shi-nome-semaforo
      * DB_Entry-Field : ef-mail-mod-bozze
           MOVE ef-mail-mod-bozze-BUF TO shi-mail-mod-bozze
      * DB_Entry-Field : ef-mail-cc-mod-bozze
           MOVE ef-mail-cc-mod-bozze-BUF TO shi-mail-cc-mod-bozze
      * DB_Entry-Field : ef-ogg-canc-bozze
           MOVE ef-ogg-canc-bozze-BUF TO shi-oggetto-canc-bozze
      * DB_Entry-Field : ef-corpo-canc-bozze
           MOVE ef-corpo-canc-bozze-BUF TO shi-corpo-canc-bozze
      * DB_Entry-Field : ef-ogg-mod-bozze
           MOVE ef-ogg-mod-bozze-BUF TO shi-oggetto-mod-bozze
      * DB_Entry-Field : ef-corpo-mod-bozze
           MOVE ef-corpo-mod-bozze-BUF TO shi-corpo-mod-bozze
      * DB_Entry-Field : ef-path-exp
           MOVE ef-path-exp-BUF TO shi-path-exp
      * DB_Entry-Field : ef-path-backup
           MOVE ef-path-backup-BUF TO shi-path-backup-exp
      * DB_Entry-Field : ef-articoli
           MOVE ef-articoli-BUF TO shi-file-articoli
      * DB_Entry-Field : ef-ean
           MOVE ef-ean-BUF TO shi-file-ean
      * DB_Entry-Field : ef-prodener
           MOVE ef-prodener-BUF TO shi-file-prodener
      * DB_Entry-Field : ef-vettori
           MOVE ef-vettori-BUF TO shi-file-vettori
      * DB_Entry-Field : ef-fornitori
           MOVE ef-fornitori-BUF TO shi-file-fornitori
      * DB_Entry-Field : ef-classi
           MOVE ef-classi-BUF TO shi-file-classi
      * DB_Entry-Field : ef-tordini
           MOVE ef-tordini-BUF TO shi-file-tordini
      * DB_Entry-Field : ef-rordini
           MOVE ef-rordini-BUF TO shi-file-rordini
      * DB_Entry-Field : ef-note
           MOVE ef-note-BUF TO shi-file-note-ordini
      * DB_Entry-Field : ef-sito-exp
           MOVE ef-sito-exp-BUF TO shi-sito-exp
      * DB_Entry-Field : ef-user-exp
           MOVE ef-user-exp-BUF TO shi-user-exp
      * DB_Entry-Field : ef-pwd-exp
           MOVE ef-pwd-exp-BUF TO shi-pwd-exp
      * DB_Entry-Field : ef-path-rem-exp
           MOVE ef-path-rem-exp-BUF TO shi-path-remota-exp
      * DB_Entry-Field : ef-path-imp
           MOVE ef-path-imp-BUF TO shi-path-imp
      * DB_Entry-Field : ef-path-backup-imp
           MOVE ef-path-backup-imp-BUF TO shi-path-backup-imp
      * DB_Entry-Field : ef-articoli-imp
           MOVE ef-articoli-imp-BUF TO shi-file-articoli-imp
      * DB_Entry-Field : ef-tordini-imp
           MOVE ef-tordini-imp-BUF TO shi-file-tordini-imp
      * DB_Entry-Field : ef-rordini-imp
           MOVE ef-rordini-imp-BUF TO shi-file-rordini-imp
      * DB_Entry-Field : ef-sito-imp
           MOVE ef-sito-imp-BUF TO shi-sito-imp
      * DB_Entry-Field : ef-user-imp
           MOVE ef-user-imp-BUF TO shi-user-imp
      * DB_Entry-Field : ef-pwd-imp
           MOVE ef-pwd-imp-BUF TO shi-pwd-imp
      * DB_Entry-Field : ef-path-rem-imp
           MOVE ef-path-rem-imp-BUF TO shi-path-remota-imp
      * DB_Entry-Field : ef-path-impcar
           MOVE ef-path-impcar-BUF TO shi-path-impcar
      * DB_Entry-Field : ef-path-backup-impcar
           MOVE ef-path-backup-impcar-BUF TO shi-path-backup-impcar
      * DB_Entry-Field : ef-carichi
           MOVE ef-carichi-BUF TO shi-file-carichi-impcar
      * DB_Entry-Field : ef-cau
           MOVE ef-cau-BUF TO shi-causale-impcar
      * DB_Entry-Field : ef-mail
           MOVE ef-mail-BUF TO shi-mail-impcar
      * DB_Entry-Field : ef-mail-cc
           MOVE ef-mail-cc-BUF TO shi-mail-cc-impcar
      * DB_Entry-Field : ef-sito-impcar
           MOVE ef-sito-impcar-BUF TO shi-sito-impcar
      * DB_Entry-Field : ef-user-impcar
           MOVE ef-user-impcar-BUF TO shi-user-impcar
      * DB_Entry-Field : ef-pwd-impcar
           MOVE ef-pwd-impcar-BUF TO shi-pwd-impcar
      * DB_Entry-Field : ef-path-rem-impcar
           MOVE ef-path-rem-impcar-BUF TO shi-path-remota-impcar
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
      * IL FILE E' MONO RECORD ED E' FISSO A SPACES.
           move spaces to shi-codice.

      *     move ef-dt-invio-buf  to como-data.
      *     perform DATE-TO-FILE.
      *     move como-data    to pae-data-invio.

           .
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * <TOTEM:END>
      * DB_Entry-Field : ef-cod-commitente
           MOVE shi-cod-SHI TO ef-cod-commitente-BUF
      * DB_Entry-Field : ef-mag-1
           MOVE shi-mag-SHI-1 TO ef-mag-1-BUF
      * DB_Entry-Field : ef-mag-2
           MOVE shi-mag-SHI-2 TO ef-mag-2-BUF
      * DB_Entry-Field : ef-path-log-server
           MOVE shi-path-report-server TO ef-path-log-server-BUF
      * DB_Entry-Field : ef-path-log-client
           MOVE shi-path-report-client TO ef-path-log-client-BUF
      * DB_Entry-Field : ef-sem
           MOVE shi-nome-semaforo TO ef-sem-BUF
      * DB_Entry-Field : ef-mail-mod-bozze
           MOVE shi-mail-mod-bozze TO ef-mail-mod-bozze-BUF
      * DB_Entry-Field : ef-mail-cc-mod-bozze
           MOVE shi-mail-cc-mod-bozze TO ef-mail-cc-mod-bozze-BUF
      * DB_Entry-Field : ef-ogg-canc-bozze
           MOVE shi-oggetto-canc-bozze TO ef-ogg-canc-bozze-BUF
      * DB_Entry-Field : ef-corpo-canc-bozze
           MOVE shi-corpo-canc-bozze TO ef-corpo-canc-bozze-BUF
      * DB_Entry-Field : ef-ogg-mod-bozze
           MOVE shi-oggetto-mod-bozze TO ef-ogg-mod-bozze-BUF
      * DB_Entry-Field : ef-corpo-mod-bozze
           MOVE shi-corpo-mod-bozze TO ef-corpo-mod-bozze-BUF
      * DB_Entry-Field : ef-path-exp
           MOVE shi-path-exp TO ef-path-exp-BUF
      * DB_Entry-Field : ef-path-backup
           MOVE shi-path-backup-exp TO ef-path-backup-BUF
      * DB_Entry-Field : ef-articoli
           MOVE shi-file-articoli TO ef-articoli-BUF
      * DB_Entry-Field : ef-ean
           MOVE shi-file-ean TO ef-ean-BUF
      * DB_Entry-Field : ef-prodener
           MOVE shi-file-prodener TO ef-prodener-BUF
      * DB_Entry-Field : ef-vettori
           MOVE shi-file-vettori TO ef-vettori-BUF
      * DB_Entry-Field : ef-fornitori
           MOVE shi-file-fornitori TO ef-fornitori-BUF
      * DB_Entry-Field : ef-classi
           MOVE shi-file-classi TO ef-classi-BUF
      * DB_Entry-Field : ef-tordini
           MOVE shi-file-tordini TO ef-tordini-BUF
      * DB_Entry-Field : ef-rordini
           MOVE shi-file-rordini TO ef-rordini-BUF
      * DB_Entry-Field : ef-note
           MOVE shi-file-note-ordini TO ef-note-BUF
      * DB_Entry-Field : ef-sito-exp
           MOVE shi-sito-exp TO ef-sito-exp-BUF
      * DB_Entry-Field : ef-user-exp
           MOVE shi-user-exp TO ef-user-exp-BUF
      * DB_Entry-Field : ef-pwd-exp
           MOVE shi-pwd-exp TO ef-pwd-exp-BUF
      * DB_Entry-Field : ef-path-rem-exp
           MOVE shi-path-remota-exp TO ef-path-rem-exp-BUF
      * DB_Entry-Field : ef-path-imp
           MOVE shi-path-imp TO ef-path-imp-BUF
      * DB_Entry-Field : ef-path-backup-imp
           MOVE shi-path-backup-imp TO ef-path-backup-imp-BUF
      * DB_Entry-Field : ef-articoli-imp
           MOVE shi-file-articoli-imp TO ef-articoli-imp-BUF
      * DB_Entry-Field : ef-tordini-imp
           MOVE shi-file-tordini-imp TO ef-tordini-imp-BUF
      * DB_Entry-Field : ef-rordini-imp
           MOVE shi-file-rordini-imp TO ef-rordini-imp-BUF
      * DB_Entry-Field : ef-sito-imp
           MOVE shi-sito-imp TO ef-sito-imp-BUF
      * DB_Entry-Field : ef-user-imp
           MOVE shi-user-imp TO ef-user-imp-BUF
      * DB_Entry-Field : ef-pwd-imp
           MOVE shi-pwd-imp TO ef-pwd-imp-BUF
      * DB_Entry-Field : ef-path-rem-imp
           MOVE shi-path-remota-imp TO ef-path-rem-imp-BUF
      * DB_Entry-Field : ef-path-impcar
           MOVE shi-path-impcar TO ef-path-impcar-BUF
      * DB_Entry-Field : ef-path-backup-impcar
           MOVE shi-path-backup-impcar TO ef-path-backup-impcar-BUF
      * DB_Entry-Field : ef-carichi
           MOVE shi-file-carichi-impcar TO ef-carichi-BUF
      * DB_Entry-Field : ef-cau
           MOVE shi-causale-impcar TO ef-cau-BUF
      * DB_Entry-Field : ef-mail
           MOVE shi-mail-impcar TO ef-mail-BUF
      * DB_Entry-Field : ef-mail-cc
           MOVE shi-mail-cc-impcar TO ef-mail-cc-BUF
      * DB_Entry-Field : ef-sito-impcar
           MOVE shi-sito-impcar TO ef-sito-impcar-BUF
      * DB_Entry-Field : ef-user-impcar
           MOVE shi-user-impcar TO ef-user-impcar-BUF
      * DB_Entry-Field : ef-pwd-impcar
           MOVE shi-pwd-impcar TO ef-pwd-impcar-BUF
      * DB_Entry-Field : ef-path-rem-impcar
           MOVE shi-path-remota-impcar TO ef-path-rem-impcar-BUF
      * DB_LABEL : lbl-cau
              MOVE tca-descrizione  TO lbl-cau-BUF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
           perform ABILITAZIONI.
           Perform VALORIZZA-OLD.      

      *     move pae-data-invio to como-data.
      *     perform DATE-TO-SCREEN.
      *     move como-data               to ef-dt-invio-buf.
      *

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           if shi-cod-SHI not = old-shi-cod-SHI
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cod-commitente è l'ID del campo ef-cod-commitente
              move 78-ID-ef-cod-commitente to store-id 
           end-if

           if shi-mag-SHI-1 not = old-shi-mag-SHI-1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-mag-1 è l'ID del campo ef-mag-1
              move 78-ID-ef-mag-1 to store-id 
           end-if

           if shi-mag-SHI-2 not = old-shi-mag-SHI-2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-mag-2 è l'ID del campo ef-mag-2
              move 78-ID-ef-mag-2 to store-id 
           end-if

           if shi-path-report-server not = old-shi-path-report-server
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-log-server è l'ID del campo ef-path-log-server
              move 78-ID-ef-path-log-server to store-id 
           end-if

           if shi-path-report-client not = old-shi-path-report-client
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-log-client è l'ID del campo ef-path-log-client
              move 78-ID-ef-path-log-client to store-id 
           end-if

           if shi-nome-semaforo not = old-shi-nome-semaforo
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-sem è l'ID del campo ef-sem
              move 78-ID-ef-sem to store-id 
           end-if

           if shi-mail-mod-bozze not = old-shi-mail-mod-bozze
              and SiSalvato
              set NoSalvato to true
              |193 è l'ID del campo ef-mail-mod-bozze
              move 193 to store-id
           end-if

           if shi-mail-cc-mod-bozze not = old-shi-mail-cc-mod-bozze
              and SiSalvato
              set NoSalvato to true
              |194 è l'ID del campo ef-mail-cc-mod-bozze
              move 194 to store-id
           end-if

           if shi-oggetto-canc-bozze not = old-shi-oggetto-canc-bozze
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ogg-canc-bozze è l'ID del campo ef-ogg-canc-bozze
              move 78-ID-ef-ogg-canc-bozze to store-id 
           end-if

           if shi-corpo-canc-bozze not = old-shi-corpo-canc-bozze
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-corpo-canc-bozze è l'ID del campo ef-corpo-canc-bozze
              move 78-ID-ef-corpo-canc-bozze to store-id 
           end-if

           if shi-oggetto-mod-bozze not = old-shi-oggetto-mod-bozze
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ogg-mod-bozze è l'ID del campo ef-ogg-mod-bozze
              move 78-ID-ef-ogg-mod-bozze to store-id 
           end-if

           if shi-corpo-mod-bozze not = old-shi-corpo-mod-bozze
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-corpo-mod-bozze è l'ID del campo ef-corpo-mod-bozze
              move 78-ID-ef-corpo-mod-bozze to store-id 
           end-if

           if shi-path-exp not = old-shi-path-exp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-exp è l'ID del campo ef-path-exp
              move 78-ID-ef-path-exp to store-id 
           end-if

           if shi-path-backup-exp not = old-shi-path-backup-exp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-backup è l'ID del campo ef-path-backup
              move 78-ID-ef-path-backup to store-id 
           end-if

           if shi-file-articoli not = old-shi-file-articoli
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-articoli è l'ID del campo ef-articoli
              move 78-ID-ef-articoli to store-id 
           end-if

           if shi-file-ean not = old-shi-file-ean
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ean è l'ID del campo ef-ean
              move 78-ID-ef-ean to store-id 
           end-if

           if shi-file-prodener not = old-shi-file-prodener
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-prodener è l'ID del campo ef-prodener
              move 78-ID-ef-prodener to store-id 
           end-if

           if shi-file-vettori not = old-shi-file-vettori
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-vettori è l'ID del campo ef-vettori
              move 78-ID-ef-vettori to store-id 
           end-if

           if shi-file-fornitori not = old-shi-file-fornitori
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-fornitori è l'ID del campo ef-fornitori
              move 78-ID-ef-fornitori to store-id 
           end-if

           if shi-file-classi not = old-shi-file-classi
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-classi è l'ID del campo ef-classi
              move 78-ID-ef-classi to store-id 
           end-if

           if shi-file-tordini not = old-shi-file-tordini
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-tordini è l'ID del campo ef-tordini
              move 78-ID-ef-tordini to store-id 
           end-if

           if shi-file-rordini not = old-shi-file-rordini
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-rordini è l'ID del campo ef-rordini
              move 78-ID-ef-rordini to store-id 
           end-if

           if shi-file-note-ordini not = old-shi-file-note-ordini
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note è l'ID del campo ef-note
              move 78-ID-ef-note to store-id 
           end-if

           if shi-sito-exp not = old-shi-sito-exp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-sito-exp è l'ID del campo ef-sito-exp
              move 78-ID-ef-sito-exp to store-id 
           end-if

           if shi-user-exp not = old-shi-user-exp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-user-exp è l'ID del campo ef-user-exp
              move 78-ID-ef-user-exp to store-id 
           end-if

           if shi-pwd-exp not = old-shi-pwd-exp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-pwd-exp è l'ID del campo ef-pwd-exp
              move 78-ID-ef-pwd-exp to store-id 
           end-if

           if shi-path-remota-exp not = old-shi-path-remota-exp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-rem-exp è l'ID del campo ef-path-rem-exp
              move 78-ID-ef-path-rem-exp to store-id 
           end-if

           if shi-path-imp not = old-shi-path-imp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-imp è l'ID del campo ef-path-imp
              move 78-ID-ef-path-imp to store-id 
           end-if

           if shi-path-backup-imp not = old-shi-path-backup-imp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-backup-imp è l'ID del campo ef-path-backup-imp
              move 78-ID-ef-path-backup-imp to store-id 
           end-if

           if shi-file-articoli-imp not = old-shi-file-articoli-imp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-articoli-imp è l'ID del campo ef-articoli-imp
              move 78-ID-ef-articoli-imp to store-id 
           end-if

           if shi-file-tordini-imp not = old-shi-file-tordini-imp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-tordini-imp è l'ID del campo ef-tordini-imp
              move 78-ID-ef-tordini-imp to store-id 
           end-if

           if shi-file-rordini-imp not = old-shi-file-rordini-imp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-rordini-imp è l'ID del campo ef-rordini-imp
              move 78-ID-ef-rordini-imp to store-id 
           end-if

           if shi-sito-imp not = old-shi-sito-imp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-sito-imp è l'ID del campo ef-sito-imp
              move 78-ID-ef-sito-imp to store-id 
           end-if

           if shi-user-imp not = old-shi-user-imp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-user-imp è l'ID del campo ef-user-imp
              move 78-ID-ef-user-imp to store-id 
           end-if

           if shi-pwd-imp not = old-shi-pwd-imp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-pwd-imp è l'ID del campo ef-pwd-imp
              move 78-ID-ef-pwd-imp to store-id 
           end-if

           if shi-path-remota-imp not = old-shi-path-remota-imp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-rem-imp è l'ID del campo ef-path-rem-imp
              move 78-ID-ef-path-rem-imp to store-id 
           end-if

           if shi-path-impcar not = old-shi-path-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-impcar è l'ID del campo ef-path-impcar
              move 78-ID-ef-path-impcar to store-id 
           end-if

           if shi-path-backup-impcar not = old-shi-path-backup-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-backup-impcar è l'ID del campo ef-path-backup-impcar
              move 78-ID-ef-path-backup-impcar to store-id 
           end-if

           if shi-file-carichi-impcar not = old-shi-file-carichi-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-carichi è l'ID del campo ef-carichi
              move 78-ID-ef-carichi to store-id 
           end-if

           if shi-causale-impcar not = old-shi-causale-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cau è l'ID del campo ef-cau
              move 78-ID-ef-cau to store-id 
           end-if

           if shi-mail-impcar not = old-shi-mail-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-mail è l'ID del campo ef-mail
              move 78-ID-ef-mail to store-id 
           end-if

           if shi-mail-cc-impcar not = old-shi-mail-cc-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-mail-cc è l'ID del campo ef-mail-cc
              move 78-ID-ef-mail-cc to store-id 
           end-if

           if shi-sito-impcar not = old-shi-sito-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-sito-impcar è l'ID del campo ef-sito-impcar
              move 78-ID-ef-sito-impcar to store-id 
           end-if

           if shi-user-impcar not = old-shi-user-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-user-impcar è l'ID del campo ef-user-impcar
              move 78-ID-ef-user-impcar to store-id 
           end-if

           if shi-pwd-impcar not = old-shi-pwd-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-pwd-impcar è l'ID del campo ef-pwd-impcar
              move 78-ID-ef-pwd-impcar to store-id 
           end-if

           if shi-path-remota-impcar not = old-shi-path-remota-impcar
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-path-rem-impcar è l'ID del campo ef-path-rem-impcar
              move 78-ID-ef-path-rem-impcar to store-id 
           end-if

           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           MOVE DataSet1-paramSHI-KEY1-ORDER TO TMP-Form1-KEY1-ORDER
           MOVE DataSet1-KEYIS TO TMP-Form1-KEYIS
           MOVE shi-rec OF paramSHI TO 
              TMP-Form1-paramSHI-RESTOREBUF
           .             

       Form1-Restore-Status.
           MOVE TMP-Form1-KEY1-ORDER TO DataSet1-paramSHI-KEY1-ORDER
           MOVE TMP-Form1-KEYIS TO DataSet1-KEYIS
           MOVE TMP-Form1-paramSHI-RESTOREBUF TO
              shi-rec OF paramSHI
           PERFORM DataSet1-paramSHI-START
           IF Valid-STATUS-paramshi
              PERFORM DataSet1-paramSHI-Read-Next
           ELSE
              PERFORM DataSet1-paramSHI-INITREC
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-paramshi OR
              (Valid-STATUS-paramshi AND
                 shi-rec OF paramSHI = 
                   TMP-Form1-paramSHI-RESTOREBUF)
              PERFORM DataSet1-paramSHI-Read-Next
           END-PERFORM
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-mag-1 è l'ID del campo ef-mag-1
           when 78-ID-ef-mag-1
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-mag-2 è l'ID del campo ef-mag-2
           when 78-ID-ef-mag-2
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-mag-1 è l'ID del campo ef-mag-1
           when 78-ID-ef-mag-1
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-mag-2 è l'ID del campo ef-mag-2
           when 78-ID-ef-mag-2
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |78-ID-ef-cod-commitente è l'ID del campo ef-cod-commitente
           when 78-ID-ef-cod-commitente
                perform CONTROLLO
           |78-ID-ef-mag-1 è l'ID del campo ef-mag-1
           when 78-ID-ef-mag-1
                perform CONTROLLO
           |78-ID-ef-mag-2 è l'ID del campo ef-mag-2
           when 78-ID-ef-mag-2
                perform CONTROLLO
           |78-ID-ef-path-log-server è l'ID del campo ef-path-log-server
           when 78-ID-ef-path-log-server
                perform CONTROLLO
           |78-ID-ef-path-log-client è l'ID del campo ef-path-log-client
           when 78-ID-ef-path-log-client
                perform CONTROLLO
           |78-ID-ef-sem è l'ID del campo ef-sem
           when 78-ID-ef-sem
                perform CONTROLLO
           |193 è l'ID del campo ef-mail-mod-bozze
           when 193
                perform CONTROLLO
           |194 è l'ID del campo ef-mail-cc-mod-bozze
           when 194
                perform CONTROLLO
           |78-ID-ef-ogg-canc-bozze è l'ID del campo ef-ogg-canc-bozze
           when 78-ID-ef-ogg-canc-bozze
                perform CONTROLLO
           |78-ID-ef-corpo-canc-bozze è l'ID del campo ef-corpo-canc-bozze
           when 78-ID-ef-corpo-canc-bozze
                perform CONTROLLO
           |78-ID-ef-ogg-mod-bozze è l'ID del campo ef-ogg-mod-bozze
           when 78-ID-ef-ogg-mod-bozze
                perform CONTROLLO
           |78-ID-ef-corpo-mod-bozze è l'ID del campo ef-corpo-mod-bozze
           when 78-ID-ef-corpo-mod-bozze
                perform CONTROLLO
           |78-ID-ef-path-exp è l'ID del campo ef-path-exp
           when 78-ID-ef-path-exp
                perform CONTROLLO
           |78-ID-ef-path-backup è l'ID del campo ef-path-backup
           when 78-ID-ef-path-backup
                perform CONTROLLO
           |78-ID-ef-articoli è l'ID del campo ef-articoli
           when 78-ID-ef-articoli
                perform CONTROLLO
           |78-ID-ef-ean è l'ID del campo ef-ean
           when 78-ID-ef-ean
                perform CONTROLLO
           |78-ID-ef-prodener è l'ID del campo ef-prodener
           when 78-ID-ef-prodener
                perform CONTROLLO
           |78-ID-ef-vettori è l'ID del campo ef-vettori
           when 78-ID-ef-vettori
                perform CONTROLLO
           |78-ID-ef-fornitori è l'ID del campo ef-fornitori
           when 78-ID-ef-fornitori
                perform CONTROLLO
           |78-ID-ef-classi è l'ID del campo ef-classi
           when 78-ID-ef-classi
                perform CONTROLLO
           |78-ID-ef-tordini è l'ID del campo ef-tordini
           when 78-ID-ef-tordini
                perform CONTROLLO
           |78-ID-ef-rordini è l'ID del campo ef-rordini
           when 78-ID-ef-rordini
                perform CONTROLLO
           |78-ID-ef-note è l'ID del campo ef-note
           when 78-ID-ef-note
                perform CONTROLLO
           |78-ID-ef-sito-exp è l'ID del campo ef-sito-exp
           when 78-ID-ef-sito-exp
                perform CONTROLLO
           |78-ID-ef-user-exp è l'ID del campo ef-user-exp
           when 78-ID-ef-user-exp
                perform CONTROLLO
           |78-ID-ef-pwd-exp è l'ID del campo ef-pwd-exp
           when 78-ID-ef-pwd-exp
                perform CONTROLLO
           |78-ID-ef-path-rem-exp è l'ID del campo ef-path-rem-exp
           when 78-ID-ef-path-rem-exp
                perform CONTROLLO
           |78-ID-ef-path-imp è l'ID del campo ef-path-imp
           when 78-ID-ef-path-imp
                perform CONTROLLO
           |78-ID-ef-path-backup-imp è l'ID del campo ef-path-backup-imp
           when 78-ID-ef-path-backup-imp
                perform CONTROLLO
           |78-ID-ef-articoli-imp è l'ID del campo ef-articoli-imp
           when 78-ID-ef-articoli-imp
                perform CONTROLLO
           |78-ID-ef-tordini-imp è l'ID del campo ef-tordini-imp
           when 78-ID-ef-tordini-imp
                perform CONTROLLO
           |78-ID-ef-rordini-imp è l'ID del campo ef-rordini-imp
           when 78-ID-ef-rordini-imp
                perform CONTROLLO
           |78-ID-ef-sito-imp è l'ID del campo ef-sito-imp
           when 78-ID-ef-sito-imp
                perform CONTROLLO
           |78-ID-ef-user-imp è l'ID del campo ef-user-imp
           when 78-ID-ef-user-imp
                perform CONTROLLO
           |78-ID-ef-pwd-imp è l'ID del campo ef-pwd-imp
           when 78-ID-ef-pwd-imp
                perform CONTROLLO
           |78-ID-ef-path-rem-imp è l'ID del campo ef-path-rem-imp
           when 78-ID-ef-path-rem-imp
                perform CONTROLLO
           |78-ID-ef-path-impcar è l'ID del campo ef-path-impcar
           when 78-ID-ef-path-impcar
                perform CONTROLLO
           |78-ID-ef-path-backup-impcar è l'ID del campo ef-path-backup-impcar
           when 78-ID-ef-path-backup-impcar
                perform CONTROLLO
           |78-ID-ef-carichi è l'ID del campo ef-carichi
           when 78-ID-ef-carichi
                perform CONTROLLO
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                perform CONTROLLO
           |78-ID-ef-mail è l'ID del campo ef-mail
           when 78-ID-ef-mail
                perform CONTROLLO
           |78-ID-ef-mail-cc è l'ID del campo ef-mail-cc
           when 78-ID-ef-mail-cc
                perform CONTROLLO
           |78-ID-ef-sito-impcar è l'ID del campo ef-sito-impcar
           when 78-ID-ef-sito-impcar
                perform CONTROLLO
           |78-ID-ef-user-impcar è l'ID del campo ef-user-impcar
           when 78-ID-ef-user-impcar
                perform CONTROLLO
           |78-ID-ef-pwd-impcar è l'ID del campo ef-pwd-impcar
           when 78-ID-ef-pwd-impcar
                perform CONTROLLO
           |78-ID-ef-path-rem-impcar è l'ID del campo ef-path-rem-impcar
           when 78-ID-ef-path-rem-impcar
                perform CONTROLLO
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.



       Screen1-Ta-1-TABCHANGE.
           MOVE 0 TO 
                   Screen1-Pg-4-Visible,
                   Screen1-Pg-1-Visible,
                   Screen1-Pg-2-Visible,
                   Screen1-Pg-3-Visible,
           EVALUATE Screen1-Ta-1-TAB-VALUE
           WHEN 1
                  MOVE 1 TO Screen1-Pg-4-Visible
                  MODIFY Screen1-Ta-1, VALUE = 1
           WHEN 2
                  MOVE 1 TO Screen1-Pg-1-Visible
                  MODIFY Screen1-Ta-1, VALUE = 2
           WHEN 3
                  MOVE 1 TO Screen1-Pg-2-Visible
                  MODIFY Screen1-Ta-1, VALUE = 3
           WHEN 4
                  MOVE 1 TO Screen1-Pg-3-Visible
                  MODIFY Screen1-Ta-1, VALUE = 4
           END-EVALUATE
           MOVE 2 TO CONTROL-ID
           DISPLAY Form1
           .

       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "Digitare il codice committente per SHI" to 
           TOTEM-HINT-TEXT
           WHEN 5002 MOVE "Digitare il Codice del magazzino SHI" to 
           TOTEM-HINT-TEXT
           WHEN 5003 MOVE "Digitare il Codice del magazzino SHI" to 
           TOTEM-HINT-TEXT
           WHEN 5004 MOVE "Percorso nel quale creare il rapporto di fine
      -    " elaborazione  (D:\...)  SENZA \ O / FINALE" to 
           TOTEM-HINT-TEXT
           WHEN 5005 MOVE "Percorso nel quale creare il rapporto di fine
      -    " elaborazione  (//Server...) SENZA \ O / FINALE" to 
           TOTEM-HINT-TEXT
           WHEN 5006 MOVE "Nome del file semaforo" to TOTEM-HINT-TEXT
           WHEN 193 MOVE "Indirizzo Mail a cui verrà il riepilogo delle 
      -    "modifiche delle bozze cliente" to TOTEM-HINT-TEXT
           WHEN 194 MOVE "Indirizzo Mail a cui verrà il riepilogo delle 
      -    "modifiche delle bozze cliente" to TOTEM-HINT-TEXT
           WHEN 5007 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5008 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5009 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5010 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5011 MOVE "SENZA \ o / FINALE" to TOTEM-HINT-TEXT
           WHEN 5012 MOVE "SENZA \ o / FINALE" to TOTEM-HINT-TEXT
           WHEN 5013 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5014 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5015 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5016 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5017 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5018 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5019 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5020 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5021 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5022 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5023 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5024 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5025 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5026 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5027 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5028 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5029 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5030 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5031 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5032 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5033 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5034 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5035 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5036 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5037 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5038 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5039 MOVE "Indirizzo Mail a cui verrà spedita la stampa 
      -    "riepilogativa" to TOTEM-HINT-TEXT
           WHEN 5040 MOVE "Indirizzo Mail a cui verrà spedita la stampa 
      -    "riepilogativa" to TOTEM-HINT-TEXT
           WHEN 5041 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5042 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5043 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5044 MOVE "." to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-cod-commitente-BeforeProcedure
           When 5002 PERFORM ef-mag-BeforeProcedure
           When 5003 PERFORM ef-mag-BeforeProcedure
           When 5004 PERFORM ef-path-log-server-BeforeProcedure
           When 5005 PERFORM ef-path-log-client-BeforeProcedure
           When 5006 PERFORM ef-sem-BeforeProcedure
           When 193 PERFORM ef-mail-BeforeProcedure
           When 194 PERFORM ef-mail-cc-BeforeProcedure
           When 5007 PERFORM ef-mail-cc-BeforeProcedure
           When 5008 PERFORM ef-mail-cc-BeforeProcedure
           When 5009 PERFORM ef-mail-cc-BeforeProcedure
           When 5010 PERFORM ef-mail-cc-BeforeProcedure
           When 5011 PERFORM ef-path-exp-BeforeProcedure
           When 5012 PERFORM ef-path-backup-BeforeProcedure
           When 5013 PERFORM ef-articoli-BeforeProcedure
           When 5014 PERFORM ef-ean-BeforeProcedure
           When 5015 PERFORM ef-prodener-BeforeProcedure
           When 5016 PERFORM ef-vettori-BeforeProcedure
           When 5017 PERFORM ef-fornitori-BeforeProcedure
           When 5018 PERFORM ef-classi-BeforeProcedure
           When 5019 PERFORM ef-tordini-BeforeProcedure
           When 5020 PERFORM ef-rordini-BeforeProcedure
           When 5021 PERFORM ef-note-BeforeProcedure
           When 5022 PERFORM ef-sito-exp-BeforeProcedure
           When 5023 PERFORM ef-user-exp-BeforeProcedure
           When 5024 PERFORM ef-pwd-exp-BeforeProcedure
           When 5025 PERFORM ef-path-rem-exp-BeforeProcedure
           When 5026 PERFORM ef-path-imp-BeforeProcedure
           When 5027 PERFORM ef-path-backup-imp-BeforeProcedure
           When 5028 PERFORM ef-articoli-imp-BeforeProcedure
           When 5029 PERFORM ef-tordini-imp-BeforeProcedure
           When 5030 PERFORM ef-rordini-imp-BeforeProcedure
           When 5031 PERFORM ef-sito-imp-BeforeProcedure
           When 5032 PERFORM ef-user-imp-BeforeProcedure
           When 5033 PERFORM ef-pwd-imp-BeforeProcedure
           When 5034 PERFORM ef-path-rem-imp-BeforeProcedure
           When 5035 PERFORM ef-path-impcar-BeforeProcedure
           When 5036 PERFORM ef-path-backup-impcar-BeforeProcedure
           When 5037 PERFORM ef-carichi-BeforeProcedure
           When 5038 PERFORM ef-cau-BeforeProcedure
           When 5039 PERFORM ef-mail-BeforeProcedure
           When 5040 PERFORM ef-mail-cc-BeforeProcedure
           When 5041 PERFORM ef-sito-impcar-BeforeProcedure
           When 5042 PERFORM ef-user-impcar-BeforeProcedure
           When 5043 PERFORM ef-pwd-impcar-BeforeProcedure
           When 5044 PERFORM ef-path-rem-impcar-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Form1-AfterProcedure.
           EVALUATE Control-Id
           When 5001 PERFORM ef-cod-commitente-AfterProcedure
           When 5002 PERFORM ef-mag-AfterProcedure
           When 5003 PERFORM ef-mag-AfterProcedure
           When 5004 PERFORM ef-path-log-server-AfterProcedure
           When 5005 PERFORM ef-path-log-client-AfterProcedure
           When 5006 PERFORM ef-sem-AfterProcedure
           When 193 PERFORM ef-mail-AfterProcedure
           When 194 PERFORM ef-mail-cc-AfterProcedure
           When 5007 PERFORM ef-mail-cc-AfterProcedure
           When 5008 PERFORM ef-mail-cc-AfterProcedure
           When 5009 PERFORM ef-mail-cc-AfterProcedure
           When 5010 PERFORM ef-mail-cc-AfterProcedure
           When 5011 PERFORM ef-path-exp-AfterProcedure
           When 5012 PERFORM ef-path-backup-AfterProcedure
           When 5013 PERFORM ef-articoli-AfterProcedure
           When 5014 PERFORM ef-ean-AfterProcedure
           When 5015 PERFORM ef-prodener-AfterProcedure
           When 5016 PERFORM ef-vettori-AfterProcedure
           When 5017 PERFORM ef-fornitori-AfterProcedure
           When 5018 PERFORM ef-classi-AfterProcedure
           When 5019 PERFORM ef-tordini-AfterProcedure
           When 5020 PERFORM ef-rordini-AfterProcedure
           When 5021 PERFORM ef-note-AfterProcedure
           When 5022 PERFORM ef-sito-exp-AfterProcedure
           When 5023 PERFORM ef-user-exp-AfterProcedure
           When 5024 PERFORM ef-pwd-exp-AfterProcedure
           When 5025 PERFORM ef-path-rem-exp-AfterProcedure
           When 5026 PERFORM ef-path-imp-AfterProcedure
           When 5027 PERFORM ef-path-backup-imp-AfterProcedure
           When 5028 PERFORM ef-articoli-imp-AfterProcedure
           When 5029 PERFORM ef-tordini-imp-AfterProcedure
           When 5030 PERFORM ef-rordini-imp-AfterProcedure
           When 5031 PERFORM ef-sito-imp-AfterProcedure
           When 5032 PERFORM ef-user-imp-AfterProcedure
           When 5033 PERFORM ef-pwd-imp-AfterProcedure
           When 5034 PERFORM ef-path-rem-imp-AfterProcedure
           When 5035 PERFORM ef-path-impcar-AfterProcedure
           When 5036 PERFORM ef-path-backup-impcar-AfterProcedure
           When 5037 PERFORM ef-carichi-AfterProcedure
           When 5038 PERFORM ef-cau-AfterProcedure
           When 5039 PERFORM ef-mail-AfterProcedure
           When 5040 PERFORM ef-mail-cc-AfterProcedure
           When 5041 PERFORM ef-sito-impcar-AfterProcedure
           When 5042 PERFORM ef-user-impcar-AfterProcedure
           When 5043 PERFORM ef-pwd-impcar-AfterProcedure
           When 5044 PERFORM ef-path-rem-impcar-AfterProcedure
           END-EVALUATE
           perform Form1-AFTER-SCREEN
           .

       Screen1-Event-Proc.
           .

      * USER DEFINE PARAGRAPH
       ABILITAZIONI.
      * <TOTEM:PARA. ABILITAZIONI>
           if mod = 1              
              move BitmapDeleteEnabled to BitmapNumDelete
              move BitmapSaveEnabled   to BitmapNumSave
              move 1 to e-salva |e-cancella
           else           
              move BitmapDeleteDisabled to BitmapNumDelete
              move BitmapSaveDisabled   to BitmapNumSave
              move 0 to e-salva |e-cancella
           end-if.    
  
           move 0 to e-cancella.

           modify tool-cancella, enabled = e-cancella.
           modify tool-salva,    enabled = e-salva, 
                                 bitmap-number = BitmapNumSave 
           .
      * <TOTEM:END>

       ANTEPRIMA.
      * <TOTEM:PARA. ANTEPRIMA>
           continue 
           .
      * <TOTEM:END>

       CANCELLA.
      * <TOTEM:PARA. CANCELLA>
           if mod = ZERO
              exit paragraph 
           end-if.
      *
           display message box MSg-Cancellare-il-record-corrente
                   title   titolo
                   type    MB-YES-NO 
                   default MB-NO
                   giving  scelta

           if scelta = mb-yes
              perform RIEMPI-CHIAVE
              delete paramshi record 
                 invalid 
                    continue 
              end-delete     
              move zero to mod
              move 1    to mod-k
              perform FORM1-CLEAR
              set vecchio to true
              perform CANCELLA-COLORE
              perform INIT-OLD-REC

              display message box 
           MSG-Cancellazione-avvenuta-con-successo
                      title titolo                         

              unlock paramshi all records

              perform PRIMO 
              move 78-ID-ef-cod-commitente  to  CONTROL-ID     
              move 4                        to  ACCEPT-CONTROL 

              set Statusvisua to true
              modify TOOL-MODIFICA value = mod
           end-if 
           .
      * <TOTEM:END>

       CERCA.
      * <TOTEM:PARA. CERCA>
           evaluate CONTROL-ID
           when 78-ID-ef-mag-1
                move "tmagaz"  to como-file
                inquire ef-mag-1, value in mag-codice
                call "zoom-gt"  using  como-file, mag-rec
                                giving stato-zoom
                cancel "zoom-gt"
      
                if stato-zoom = 0
                   move mag-codice      to ef-mag-1-buf
                   move mag-descrizione to lbl-mag-1-buf
                end-if
                display ef-mag-2 lbl-mag-1
           when 78-ID-ef-mag-2
                move "tmagaz"  to como-file
                inquire ef-mag-2, value in mag-codice
                call "zoom-gt"  using  como-file, mag-rec
                                giving stato-zoom
                cancel "zoom-gt"
      
                if stato-zoom = 0
                   move mag-codice      to ef-mag-2-buf
                   move mag-descrizione to lbl-mag-2-buf
                end-if
                display ef-mag-2 lbl-mag-2
           when 78-ID-ef-cau
                move "tcaumag"  to como-file
                inquire ef-cau, value in tca-codice
                call "zoom-gt"  using  como-file, tca-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tca-codice      to ef-cau-buf
                   move tca-descrizione to lbl-cau-buf
                end-if
                display ef-cau lbl-cau
           end-evaluate  
           .
      * <TOTEM:END>

       CLEAR-SCREEN.
      * <TOTEM:PARA. CLEAR-SCREEN>
           move shi-chiave to old-shi-chiave.

           initialize shi-dati replacing numeric data by zeroes
                                   alphanumeric data by spaces.
                         
           perform FORM1-FLD-TO-BUF. 

           perform INIT-OLD-REC.
                                          
           display form1. 
  
           unlock paramshi all records 
           .
      * <TOTEM:END>

       CHECK-INSERIMENTO.
      * <TOTEM:PARA. CHECK-INSERIMENTO>
      * MODIFICA LA STATUS-BAR
      * CONTROLLO SE DA INSERIMENTO SCORRO. ALLORA DEVO SEGNALARE CHE
      * SONO TORNATO IN MODIFICA.
           inquire tool-modifica, value in mod.

           inquire tool-modifica, value in mod.

           evaluate mod
           when 1
                set StatusModifica to true
           when 0
                set StatusVisua to true   
           end-evaluate.
      
           perform STATUS-BAR-MSG 
           .
      * <TOTEM:END>

       CONTROLLO.
      * <TOTEM:PARA. CONTROLLO>
           set tutto-ok to true.


           evaluate CONTROL-ID
           when 78-ID-ef-cod-commitente
                inquire ef-cod-commitente, value ef-cod-commitente-buf
                if ef-cod-commitente-buf = space
                   set errori to true
                   display message "Codice committente NON valido!"
                      title tit-err
                      icon  MB-WARNING-ICON
                   move 78-ID-ef-cod-commitente to CONTROL-ID
                end-if                               
           when 78-ID-ef-mag-1
                inquire ef-mag-1, value in mag-codice
                initialize lbl-mag-1-buf
                if mag-codice not = space
                   read tmagaz
                      invalid 
                         set errori to true
                         display message "Codice magazzino NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                         move 78-ID-ef-mag-1 to CONTROL-ID
                      not invalid
                         move mag-descrizione  to lbl-mag-1-buf
                   end-read
                end-if
                modify lbl-mag-1, TITLE lbl-mag-1-buf

           when 78-ID-ef-mag-2
                inquire ef-mag-2, value in mag-codice
                initialize lbl-mag-2-buf
                if mag-codice not = space
                   read tmagaz
                      invalid 
                         set errori to true
                         display message "Codice magazzino NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                         move 78-ID-ef-mag-2 to CONTROL-ID
                      not invalid
                         move mag-descrizione  to lbl-mag-2-buf
                   end-read
                end-if
                modify lbl-mag-2, TITLE lbl-mag-2-buf

           when 78-ID-ef-path-log-server
                if controllo-finale
                   inquire ef-path-log-server, value 
           ef-path-log-server-buf
                   if ef-path-log-server-buf = space
                      set errori to true
                      display message "Percorco log NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-log-server to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-path-log-client
                if controllo-finale
                   inquire ef-path-log-client, 
                                      value ef-path-log-client-buf
                   if ef-path-log-client-buf = space
                      set errori to true
                      display message "Percorco log NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-log-client to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-sem
                if controllo-finale
                   inquire ef-sem, value in ef-sem-buf
                   if ef-sem-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-sem to CONTROL-ID
                   end-if
                 end-if


           when 78-ID-ef-ogg-canc-bozze
                if controllo-finale
                   inquire ef-ogg-canc-bozze, 
                                      value in ef-ogg-canc-bozze-buf
                   if ef-ogg-canc-bozze-buf = space
                      set errori to true
                      display message "Oggetto Mail Obbligatorio!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-ogg-canc-bozze to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-corpo-canc-bozze
                if controllo-finale
                   inquire ef-corpo-canc-bozze, 
                                      value in ef-corpo-canc-bozze-buf
                   if ef-corpo-canc-bozze-buf = space
                      set errori to true
                      display message "Corpo Mail Obbligatorio!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-corpo-canc-bozze to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-ogg-mod-bozze
                if controllo-finale
                   inquire ef-ogg-mod-bozze, 
                                      value in ef-ogg-mod-bozze-buf
                   if ef-ogg-canc-bozze-buf = space
                      set errori to true
                      display message "Oggetto Mail Obbligatorio!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-ogg-mod-bozze to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-corpo-mod-bozze
                if controllo-finale
                   inquire ef-corpo-mod-bozze, 
                                      value in ef-corpo-mod-bozze-buf
                   if ef-corpo-canc-bozze-buf = space
                      set errori to true
                      display message "Oggetto Mail Obbligatorio!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-corpo-mod-bozze to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-path-exp
                if controllo-finale
                   inquire ef-path-exp, value in ef-path-exp-buf
                   if ef-path-exp-buf = space
                      set errori to true
                      display message "Percorco generazione NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-exp to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-path-backup
                if controllo-finale
                   inquire ef-path-backup, value in ef-path-backup-buf
                   if ef-path-backup-buf = space
                      set errori to true
                      display message "Percorco backup NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-backup to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-articoli
                if controllo-finale
                   inquire ef-articoli, value in ef-articoli-buf
                   if ef-articoli-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-articoli to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-ean
                if controllo-finale
                   inquire ef-ean, value in ef-ean-buf
                   if ef-ean-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-ean to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-prodener
                if controllo-finale
                   inquire ef-prodener, value in ef-prodener-buf
                   if ef-prodener-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-prodener to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-vettori
                if controllo-finale
                   inquire ef-vettori, value in ef-vettori-buf
                   if ef-vettori-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-vettori to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-fornitori
                if controllo-finale
                   inquire ef-fornitori, value in ef-fornitori-buf
                   if ef-fornitori-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-fornitori to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-tordini
                if controllo-finale
                   inquire ef-tordini, value in ef-tordini-buf
                   if ef-tordini-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-tordini to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-rordini
                if controllo-finale
                   inquire ef-rordini, value in ef-rordini-buf
                   if ef-rordini-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-rordini to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-note
                if controllo-finale
                   inquire ef-note, value in ef-note-buf
                   if ef-note-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-note to CONTROL-ID
                   end-if
                 end-if
           when 78-ID-ef-classi
                if controllo-finale
                   inquire ef-classi, value in ef-classi-buf
                   if ef-classi-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-classi to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-sito-exp
                if controllo-finale
                   inquire ef-sito-exp, value in ef-sito-exp-buf
                   if ef-sito-exp-buf = space
                      set errori to true
                      display message "Sito FTP file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-sito-exp to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-user-exp
                if controllo-finale
                   inquire ef-user-exp, value in ef-user-exp-buf
                   if ef-user-exp-buf = space
                      set errori to true
                      display message "Utente FTP file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-user-exp to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-path-rem-exp
                if controllo-finale
                   inquire ef-path-rem-exp, value in ef-path-rem-exp-buf
                   if ef-path-rem-exp-buf = space
                      set errori to true
                      display message "Cartella FTP file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-rem-exp to CONTROL-ID
                   end-if
                 end-if


           when 78-ID-ef-path-imp
                if controllo-finale
                   inquire ef-path-imp, value ef-path-imp-buf
                   if ef-path-imp-buf = space
                      set errori to true
                      display message "Percorco backup NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-imp to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-path-backup-imp
                if controllo-finale
                   inquire ef-path-backup-imp, value 
           ef-path-backup-imp-buf
                   if ef-path-backup-imp-buf = space
                      set errori to true
                      display message "Percorco backup NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-backup-imp to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-articoli-imp
                if controllo-finale
                   inquire ef-articoli-imp, value in ef-articoli-imp-buf
                   if ef-articoli-imp-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-articoli-imp to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-tordini-imp
                if controllo-finale
                   inquire ef-tordini-imp, value in ef-tordini-imp-buf
                   if ef-tordini-imp-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-tordini-imp to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-rordini-imp
                if controllo-finale
                   inquire ef-rordini-imp, value in ef-rordini-imp-buf
                   if ef-rordini-imp-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-rordini-imp to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-sito-imp
                if controllo-finale
                   inquire ef-sito-imp, value in ef-sito-imp-buf
                   if ef-sito-imp-buf = space
                      set errori to true
                      display message "Sito FTP file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-sito-imp to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-user-imp
                if controllo-finale
                   inquire ef-user-imp, value in ef-user-imp-buf
                   if ef-user-imp-buf = space
                      set errori to true
                      display message "Utente FTP file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-user-imp to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-path-rem-imp
                if controllo-finale
                   inquire ef-path-rem-imp, value in ef-path-rem-imp-buf
                   if ef-path-rem-imp-buf = space
                      set errori to true
                      display message "Cartella FTP file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-rem-imp to CONTROL-ID
                   end-if
                 end-if



           when 78-ID-ef-path-impcar
                if controllo-finale
                   inquire ef-path-impcar, value ef-path-impcar-buf
                   if ef-path-impcar-buf = space
                      set errori to true
                      display message "Percorco NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-impcar to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-path-backup-impcar
                if controllo-finale
                   inquire ef-path-backup-impcar, value 
           ef-path-backup-impcar-buf
                   if ef-path-backup-impcar-buf = space
                      set errori to true
                      display message "Percorco backup NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-backup-impcar to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-carichi
                if controllo-finale
                   inquire ef-carichi, value in ef-carichi-buf
                   if ef-carichi-buf = space
                      set errori to true
                      display message "Nome file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-carichi to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-sito-impcar
                if controllo-finale
                   inquire ef-sito-impcar, value in ef-sito-impcar-buf
                   if ef-sito-impcar-buf = space
                      set errori to true
                      display message "Sito FTP file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-sito-impcar to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-user-impcar
                if controllo-finale
                   inquire ef-user-impcar, value in ef-user-impcar-buf
                   if ef-user-impcar-buf = space
                      set errori to true
                      display message "Utente FTP file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-user-impcar to CONTROL-ID
                   end-if
                 end-if

           when 78-ID-ef-path-rem-impcar
                if controllo-finale
                   inquire ef-path-rem-impcar, value in 
           ef-path-rem-impcar-buf
                   if ef-path-rem-impcar-buf = space
                      set errori to true
                      display message "Cartella FTP file NON valido!"
                         title tit-err
                         icon  MB-WARNING-ICON
                      move 78-ID-ef-path-rem-impcar to CONTROL-ID
                   end-if
                 end-if

           when 78-id-ef-cau
                inquire ef-cau, value ef-cau-buf
                move ef-cau-buf to tca-codice

                if tca-codice = spaces
                   set errori to true
                   display message "Codice Causale Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lbl-cau-buf
                else
                   read tcaumag no lock
                      invalid 
                         set errori to true
                         display message "Codice Causale "
                                         "NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lbl-cau-buf
                    not invalid
                        move tca-descrizione to lbl-cau-buf
                        if tca-cliente
                           set errori to true
                           display message "Codice Causale per Clienti, 
      -    ""
                                         "NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        end-if
                        if tutto-ok
                           if not tca-si-ord-forn
                              set errori to true
                              display message "Codice Causale non di "
                                         "tipo Ordini Fornitori!"
                                title tit-err
                                icon mb-warning-icon
                           end-if
                        end-if
                   end-read
                end-if

                display lbl-cau


           end-evaluate.


      
           if errori
              perform CANCELLA-COLORE
              move control-id to store-id
              move 4          to ACCEPT-CONTROL
           end-if 
           .
      * <TOTEM:END>

       CURRENT-RECORD.
      * <TOTEM:PARA. CURRENT-RECORD>
           perform RIEMPI-CHIAVE.
           set tutto-ok  to true.
           set ReadSecca to true.
           if mod = 1
              read paramshi    lock invalid 
                 set errori to true 
              end-read
           else
              read paramshi no lock invalid 
                 set errori to true 
              end-read
           end-if.                    
           set ReadSecca to false.

           if RecLocked
              set RecLocked to false
           else
              if tutto-ok    
                 if nuovo
                    move 0                        to mod
                    move 1                        to mod-k
                    move 78-ID-ef-cod-commitente  to CONTROL-ID
                    move 4                        to ACCEPT-CONTROL
                 end-if   
                 perform FORM1-IUD-DISPLAY
                 set vecchio to true
                 if mod = 1
                    set StatusModifica to true
                    modify Form1-St-1-Handle, panel-index 3
                       panel-text "MODIFICA"
                 else                         
                    set StatusVisua    to true
                    modify Form1-St-1-Handle, panel-index 3
                       panel-text "MODIFICA"
                 end-if
                 perform VALORIZZA-OLD
              else
                 move ZERO to mod
                 move 1    to mod-k
                 if vecchio
                    perform CLEAR-SCREEN
                    if YesMessage
                       move 78-ID-ef-cod-commitente  to CONTROL-ID
                       move 4             to ACCEPT-CONTROL
                       display message box MSG-Record-inesistente
                               title = tit-err
                               icon mb-warning-icon
                    end-if
                 end-if
              end-if
           end-if 
           .
      * <TOTEM:END>

       INIT.
      * <TOTEM:PARA. INIT>
           move 0 to StatusHelp.
           move 1 to mod-k.
           set StatusVisua to true.     
           set errore-des  to false.
           set controllo-finale to false 
           .
      * <TOTEM:END>

       INIT-OLD-REC.
      * <TOTEM:PARA. INIT-OLD-REC>
           initialize old-shi-rec replacing numeric data by zeroes
                                       alphanumeric data by spaces 
           .
      * <TOTEM:END>

       MODIFICA.
      * <TOTEM:PARA. MODIFICA>
           move 5 to key-status.
           inquire tool-modifica, value in mod.
           set tutto-ok to true.

           if nuovo
              move 1 to mod                  
              modify tool-modifica, value mod
           else
      *  SE L'UTENTE E' ABILITATO PUO' MODIFICARE UN RECORD
              if mod = 1
                 set YesMessage to true
                 perform CURRENT-RECORD
                 if tutto-ok
                    if CONTROL-ID < 78-ID-ef-cod-commitente
                       move 78-ID-ef-cod-commitente to CONTROL-ID
                    end-if
                    move ZERO to mod-k
                    move 1    to mod
                    set StatusModifica to true
                    modify Form1-St-1-Handle, panel-index 3
                           panel-text "MODIFICA"
                 end-if
              else
                 move 1    to mod
                 perform SALV-MOD            
                 move ZERO to mod
                 move 1    to mod-k
                 if errori
                    move 1    to mod
                    move ZERO to mod-k
                 else
                    move 78-ID-ef-cod-commitente to CONTROL-ID
                    set NoMessage to true
                    perform CURRENT-RECORD
                    set StatusVisua to true
                    modify Form1-St-1-Handle, panel-index 3
                       panel-text "VISUALIZZAZIONE"
                    unlock paramshi all records
                 end-if
              end-if
                        
              display form1
              modify tool-modifica,  value mod
              perform CANCELLA-COLORE 

              move 4 to ACCEPT-CONTROL
           end-if 
           .
      * <TOTEM:END>

       NUOVO.
      * <TOTEM:PARA. NUOVO>
           perform SALV-MOD.
      
           if tutto-ok  
              move 78-ID-ef-cod-commitente  to CONTROL-ID       
              move 4                        to ACCEPT-CONTROL   
              move 1                        to mod mod-k
              modify tool-modifica,  value = mod
              perform CANCELLA-COLORE                  
              perform VALORIZZA-NUOVO
              perform INIT-OLD-REC       
              set StatusIns to true
              perform STATUS-BAR-MSG 

              set nuovo to true       
              unlock paramshi all records
           end-if       
           .
      * <TOTEM:END>

       ORDINAMENTO.
      * <TOTEM:PARA. ORDINAMENTO>
      *     inquire tool-ord, value in OrderBy.
      *
      *     if OrderBy = zero
      *        perform DataSet1-CHANGETO-KEY1
      *     else
      *        perform DataSet1-CHANGETO-KEY2
      *     end-if.
      *
      *     perform Form1-Curr 
           .
      * <TOTEM:END>

       RIEMPI-CHIAVE.
      * <TOTEM:PARA. RIEMPI-CHIAVE>
           Move SPACES to shi-codice 
           .
      * <TOTEM:END>

       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "abilita-toolbar.cpy".
           copy "color-custom.cpy".
           copy "utydata.cpy" 
           .
      * <TOTEM:END>

       PRIMO.
      * <TOTEM:PARA. PRIMO>
           perform SALV-MOD.           
           if tutto-ok    
      
              perform CHECK-INSERIMENTO
              unlock paramshi all records
      
              if mod = 1
                 move 0    to mod-k
                 set dataset1-paramshi-lock to true
              else              
                 move 1    to mod-k     
                 initialize dataset1-paramshi-lock-flag
              end-if
                                  
              perform CANCELLA-COLORE
              perform FORM1-FIRST                  
              move shi-mag-SHI-1 to mag-codice
              read tmagaz no lock
                   invalid move spaces to mag-descrizione
              end-read
              move mag-descrizione to lbl-mag-1-buf
              move shi-mag-SHI-2 to mag-codice
              read tmagaz no lock
                   invalid move spaces to mag-descrizione
              end-read
              move mag-descrizione to lbl-mag-2-buf

      * SPECIFICO DEL PGM "paramedi"
              if Status-paramshi not = ZERO
                 perform NUOVO
              end-if
      
              if RecLocked
                 set RecLocked to false             
                 initialize dataset1-paramshi-lock-flag
                 move 1 to mod-k
                 perform FORM1-FIRST 
                 move shi-mag-SHI-1 to mag-codice
                 read tmagaz no lock
                      invalid move spaces to mag-descrizione
                 end-read
                 move mag-descrizione to lbl-mag-1-buf
                 move shi-mag-SHI-2 to mag-codice
                 read tmagaz no lock
                      invalid move spaces to mag-descrizione
                 end-read
                 move mag-descrizione to lbl-mag-2-buf
              end-if
           end-if.
           display form1 
           .
      * <TOTEM:END>

       SALVA.
      * <TOTEM:PARA. SALVA>
           if mod = 0 exit paragraph end-if.

           set tutto-ok to true.

           set controllo-finale to true
           perform varying CONTROL-ID from 78-ID-ef-cod-commitente by 1
                     until CONTROL-ID > 78-ID-ef-path-rem-impcar
              perform CONTROLLO
              if errori 
                 exit perform 
              end-if
           end-perform.
           set controllo-finale to false
           if errori
              perform ABILITAZIONI
              move store-id to CONTROL-ID       
              move 4        to ACCEPT-CONTROL   
           else                       
              perform FORM1-BUF-TO-FLD
              perform VALORIZZA-DATI-COMUNI
              perform CANCELLA-COLORE 

              write shi-rec 
                 invalid 
                    rewrite shi-rec 
              end-write

              set vecchio to true
              perform TORNA-IN-VISUA
           end-if.   
                 
           display form1 
           .
      * <TOTEM:END>

       SALV-MOD.
      * <TOTEM:PARA. SALV-MOD>
           set tutto-ok to true.
           perform Form1-CONTROLLO-OLD.

           if NoSalvato
              display message box MSG-Salvare-le-modifiche
                            title titolo
                            type MB-YES-NO-CANCEL 
                            giving scelta       
       
              evaluate scelta
              when mb-yes 
                   perform SALVA
              when mb-no  
                   continue
              when other                
                   perform CANCELLA-COLORE
                   set errori    to true
                   move store-id to CONTROL-ID       
                   move 4        to ACCEPT-CONTROL   
              end-evaluate
           end-if 
           .
      * <TOTEM:END>

       STAMPA.
      * <TOTEM:PARA. STAMPA>
           continue 
           .
      * <TOTEM:END>

       STATUS-BAR-MSG.
      * <TOTEM:PARA. STATUS-BAR-MSG>
           evaluate true
           when StatusModifica
                modify form1-st-1-handle, 
                       panel-index  3,
                       panel-text  "MODIFICA"
           when StatusVisua
                modify form1-st-1-handle, 
                       panel-index  3,
                       panel-text  "VISUALIZZAZIONE"
                move 0 to StatusHelp
                perform STATUS-HELP
           when StatusIns
                modify form1-st-1-handle, 
                       panel-index  3,
                       panel-text  "INSERIMENTO"
           when other
                modify form1-st-1-handle, 
                       panel-index  2,
                       panel-text   spaces
           end-evaluate 
           .
      * <TOTEM:END>

       STATUS-HELP.
      * <TOTEM:PARA. STATUS-HELP>
           if StatusHelp = 1
              modify Form1-St-1-Handle, 
                     panel-index = 2, 
                     panel-text "F8 HELP record presenti"
              move BitmapZoomEnabled to BitmapNumZoom
           else
              modify Form1-St-1-Handle, 
                     panel-index = 2, 
                     panel-text spaces
              move BitmapZoomDisabled to BitmapNumZoom
           end-if.
           move StatusHelp to e-cerca.
           modify tool-cerca, enabled = e-cerca.
           modify tool-cerca, bitmap-number = BitmapNumZoom 
           .
      * <TOTEM:END>

       TORNA-IN-VISUA.
      * <TOTEM:PARA. TORNA-IN-VISUA>
           move 0 to mod.
           move 1 to mod-k.
           move 78-ID-ef-cod-commitente to CONTROL-ID.
           set NoMessage to true.
           perform ABILITAZIONI.
           set StatusVisua to true.
           perform STATUS-BAR-MSG.
           unlock paramshi all records.
                        
           modify tool-modifica,  value mod.
           perform CANCELLA-COLORE.
           move 4 to ACCEPT-CONTROL 
           .
      * <TOTEM:END>

       VALORIZZA-OLD.
      * <TOTEM:PARA. VALORIZZA-OLD>
           move shi-rec to old-shi-rec.
           set vecchio to true 
           .
      * <TOTEM:END>

       VALORIZZA-NUOVO.
      * <TOTEM:PARA. VALORIZZA-NUOVO>
      * ISTRUZIONE SPECIFICA DEL PGM tgeDPAG
           perform Form1-Clear
      * FINE                                                                                         

           initialize shi-dati replacing numeric data by zeroes
                                    alphanumeric data by spaces.
           perform FORM1-IUD-DISPLAY 
           .
      * <TOTEM:END>

       VALORIZZA-DATI-COMUNI.
      * <TOTEM:PARA. VALORIZZA-DATI-COMUNI>
      * SE NON HO VALORIZZATO I CAMPI DI CREAZIONE LI VALORIZZO
           if shi-data-creazione   = zero
              accept shi-data-creazione from century-date
           end-if.
           if shi-ora-creazione    = zero
              accept shi-ora-creazione  from time
           end-if.
           if shi-utente-creazione = space
              move user-codi to shi-utente-creazione
           end-if.

           accept shi-data-ultima-modifica from century-date.
           accept shi-ora-ultima-modifica  from time.
           move user-codi    to shi-utente-ultima-modifica 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       CANCELLA-LinkTo.
      * <TOTEM:PARA. CANCELLA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD.
                              
           INQUIRE TOOL-CANCELLA, ENABLED IN E-CANCELLA
           IF E-CANCELLA = 1
              PERFORM CANCELLA
           END-IF                                                
           .
      * <TOTEM:END>
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD           

           INQUIRE TOOL-SALVA, ENABLED IN E-SALVA
           IF E-SALVA = 1
              PERFORM SALVA
           END-IF           
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
           INQUIRE TOOL-ANTEPRIMA, ENABLED IN E-ANTEPRIMA.
           IF E-ANTEPRIMA = 1
                PERFORM ANTEPRIMA
           END-IF 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
           INQUIRE TOOL-MODIFICA, ENABLED IN E-MODIFICA.

           IF E-MODIFICA = 1
              PERFORM MODIFICA
           END-IF 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
           INQUIRE TOOL-STAMPA, ENABLED IN E-STAMPA
           IF E-STAMPA = 1
                PERFORM STAMPA
           END-IF 
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca
           if e-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       ginqui-Ev-Before-Program.
      * <TOTEM:PARA. ginqui-Ev-Before-Program>
           move LK-BL-PROG-ID    TO COMO-PROG-ID.
           string "Nell'oggetto e nel corpo al "     delimited by size
                  "posto del numero scrivere "       delimited by size
                  x"22"                              delimited by size
                  "$1"                               delimited by size
                  x"22"                              delimited by size
                  " e al posto dell'anno scrivere "  delimited by size
                  x"22"                              delimited by size
                  "$2"                               delimited by size
                  x"22"                              delimited by size
                  into help-sostituzione 
           .
      * <TOTEM:END>
       ginqui-Ev-After-Program.
      * <TOTEM:PARA. ginqui-Ev-After-Program>
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM 
           .
      * <TOTEM:END>
       NUOVO-LinkTo.
      * <TOTEM:PARA. NUOVO-LinkTo>
           .
      * <TOTEM:END>
       pb-path-exp-LinkTo.
      * <TOTEM:PARA. pb-path-exp-LinkTo>
           initialize opensave-data.
           inquire ef-path-exp value OPNSAV-DEFAULT-DIR

           move 1 to opnsav-default-filter.
           move "Parametri SHI" to opnsav-title.
           call "C$OPENSAVEBOX" using OPENSAVE-BROWSE-FOLDER, 
                                      opensave-data
                               giving opensave-status.

           if opensave-status = 1
              move opnsav-filename to ef-path-exp-buf
              modify ef-path-exp, value = ef-path-exp-buf
           end-if 
           .
      * <TOTEM:END>
       pb-report-server-LinkTo.
      * <TOTEM:PARA. pb-report-server-LinkTo>
           initialize opensave-data.
           inquire ef-path-log-server value OPNSAV-DEFAULT-DIR

           move 1 to opnsav-default-filter.
           move "Parametri SHI" to opnsav-title.
           call "C$OPENSAVEBOX" using OPENSAVE-BROWSE-FOLDER, 
                                      opensave-data
                               giving opensave-status.

           if opensave-status = 1
              move opnsav-filename to ef-path-log-server-buf
              modify ef-path-log-server, value = ef-path-log-server-buf
           end-if 
           .
      * <TOTEM:END>
       pb-report-client-LinkTo.
      * <TOTEM:PARA. pb-report-client-LinkTo>
           initialize opensave-data.
           inquire ef-path-log-client value OPNSAV-DEFAULT-DIR

           move 1 to opnsav-default-filter.
           move "Parametri SHI" to opnsav-title.
           call "C$OPENSAVEBOX" using OPENSAVE-BROWSE-FOLDER, 
                                      opensave-data
                               giving opensave-status.

           if opensave-status = 1
              move opnsav-filename to ef-path-log-client-buf
              modify ef-path-log-client, value = ef-path-log-client-buf
           end-if 
           .
      * <TOTEM:END>
       pb-path-backup-exp-LinkTo.
      * <TOTEM:PARA. pb-path-backup-exp-LinkTo>
           initialize opensave-data.
           inquire ef-path-backup value OPNSAV-DEFAULT-DIR

           move 1 to opnsav-default-filter.
           move "Parametri SHI" to opnsav-title.
           call "C$OPENSAVEBOX" using OPENSAVE-BROWSE-FOLDER, 
                                      opensave-data
                               giving opensave-status.

           if opensave-status = 1
              move opnsav-filename to ef-path-backup-buf
              modify ef-path-backup, value = ef-path-backup-buf
           end-if 
           .
      * <TOTEM:END>
       pb-path-imp-LinkTo.
      * <TOTEM:PARA. pb-path-imp-LinkTo>
           initialize opensave-data.
           inquire ef-path-imp value OPNSAV-DEFAULT-DIR

           move 1 to opnsav-default-filter.
           move "Parametri SHI" to opnsav-title.
           call "C$OPENSAVEBOX" using OPENSAVE-BROWSE-FOLDER, 
                                      opensave-data
                               giving opensave-status.

           if opensave-status = 1
              move opnsav-filename to ef-path-imp-buf
              modify ef-path-imp, value = ef-path-imp-buf
           end-if 
           .
      * <TOTEM:END>
       pb-path-imp-backup-LinkTo.
      * <TOTEM:PARA. pb-path-imp-backup-LinkTo>
           initialize opensave-data.
           inquire ef-path-backup-imp value OPNSAV-DEFAULT-DIR

           move 1 to opnsav-default-filter.
           move "Parametri SHI" to opnsav-title.
           call "C$OPENSAVEBOX" using OPENSAVE-BROWSE-FOLDER, 
                                      opensave-data
                               giving opensave-status.

           if opensave-status = 1
              move opnsav-filename to ef-path-backup-imp-buf
              modify ef-path-backup-imp, value = ef-path-backup-imp-buf
           end-if 
           .
      * <TOTEM:END>
       Screen1-Pb-1-LinkTo.
      * <TOTEM:PARA. Screen1-Pb-1-LinkTo>
           inquire ef-sito-exp, VALUE ef-sito-exp-buf
           move ef-sito-exp-buf to ef-sito-imp-buf
           modify ef-sito-imp, VALUE ef-sito-imp-buf

           inquire ef-user-exp, VALUE ef-user-exp-buf
           move ef-user-exp-buf to ef-user-imp-buf
           modify ef-user-imp, VALUE ef-user-imp-buf

           inquire ef-pwd-exp, VALUE ef-pwd-exp-buf
           move ef-pwd-exp-buf to ef-pwd-imp-buf
           modify ef-pwd-imp, VALUE ef-pwd-imp-buf

           inquire ef-path-rem-exp, VALUE ef-path-rem-exp-buf
           move ef-path-rem-exp-buf to ef-path-rem-imp-buf
           modify ef-path-rem-imp, VALUE ef-path-rem-imp-buf
           .
      * <TOTEM:END>
       pb-path-impcar-LinkTo.
      * <TOTEM:PARA. pb-path-impcar-LinkTo>
           initialize opensave-data.
           inquire ef-path-impcar value OPNSAV-DEFAULT-DIR

           move 1 to opnsav-default-filter.
           move "Parametri SHI" to opnsav-title.
           call "C$OPENSAVEBOX" using OPENSAVE-BROWSE-FOLDER, 
                                      opensave-data
                               giving opensave-status.

           if opensave-status = 1
              move opnsav-filename to ef-path-impcar-buf
              modify ef-path-impcar, value = ef-path-impcar-buf
           end-if 
           .
      * <TOTEM:END>
       pb-path-imp-backupcar-LinkTo.
      * <TOTEM:PARA. pb-path-imp-backupcar-LinkTo>
           initialize opensave-data.
           inquire ef-path-backup-impcar value OPNSAV-DEFAULT-DIR

           move 1 to opnsav-default-filter.
           move "Parametri SHI" to opnsav-title.
           call "C$OPENSAVEBOX" using OPENSAVE-BROWSE-FOLDER, 
                                      opensave-data
                               giving opensave-status.

           if opensave-status = 1
              move opnsav-filename to ef-path-backup-impcar-buf
              modify ef-path-backup-impcar, 
                          value = ef-path-backup-impcar-buf
           end-if 
           .
      * <TOTEM:END>
       Screen1-Pb-1a-LinkTo.
      * <TOTEM:PARA. Screen1-Pb-1a-LinkTo>
           inquire ef-sito-exp, VALUE ef-sito-exp-buf
           move ef-sito-exp-buf to ef-sito-impcar-buf
           modify ef-sito-impcar, VALUE ef-sito-impcar-buf

           inquire ef-user-exp, VALUE ef-user-exp-buf
           move ef-user-exp-buf to ef-user-impcar-buf
           modify ef-user-impcar, VALUE ef-user-impcar-buf

           inquire ef-pwd-exp, VALUE ef-pwd-exp-buf
           move ef-pwd-exp-buf to ef-pwd-impcar-buf
           modify ef-pwd-impcar, VALUE ef-pwd-impcar-buf

           inquire ef-path-rem-exp, VALUE ef-path-rem-exp-buf
           move ef-path-rem-exp-buf to ef-path-rem-impcar-buf
           modify ef-path-rem-impcar, VALUE ef-path-rem-impcar-buf
           .
      * <TOTEM:END>
       ef-cod-commitente-BeforeProcedure.
      * <TOTEM:PARA. ef-cod-commitente-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-mag-BeforeProcedure.
      * <TOTEM:PARA. ef-mag-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-log-server-BeforeProcedure.
      * <TOTEM:PARA. ef-path-log-server-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-log-client-BeforeProcedure.
      * <TOTEM:PARA. ef-path-log-client-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-sem-BeforeProcedure.
      * <TOTEM:PARA. ef-sem-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-exp-BeforeProcedure.
      * <TOTEM:PARA. ef-path-exp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-backup-BeforeProcedure.
      * <TOTEM:PARA. ef-path-backup-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-articoli-BeforeProcedure.
      * <TOTEM:PARA. ef-articoli-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-prodener-BeforeProcedure.
      * <TOTEM:PARA. ef-prodener-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-vettori-BeforeProcedure.
      * <TOTEM:PARA. ef-vettori-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-fornitori-BeforeProcedure.
      * <TOTEM:PARA. ef-fornitori-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-classi-BeforeProcedure.
      * <TOTEM:PARA. ef-classi-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-tordini-BeforeProcedure.
      * <TOTEM:PARA. ef-tordini-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-rordini-BeforeProcedure.
      * <TOTEM:PARA. ef-rordini-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-BeforeProcedure.
      * <TOTEM:PARA. ef-note-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-sito-exp-BeforeProcedure.
      * <TOTEM:PARA. ef-sito-exp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-user-exp-BeforeProcedure.
      * <TOTEM:PARA. ef-user-exp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-pwd-exp-BeforeProcedure.
      * <TOTEM:PARA. ef-pwd-exp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-rem-exp-BeforeProcedure.
      * <TOTEM:PARA. ef-path-rem-exp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-path-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-backup-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-path-backup-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-articoli-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-articoli-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-tordini-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-tordini-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-rordini-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-rordini-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-sito-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-sito-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-user-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-user-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-pwd-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-pwd-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-rem-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-path-rem-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-impcar-BeforeProcedure.
      * <TOTEM:PARA. ef-path-impcar-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-backup-impcar-BeforeProcedure.
      * <TOTEM:PARA. ef-path-backup-impcar-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-carichi-BeforeProcedure.
      * <TOTEM:PARA. ef-carichi-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cau-BeforeProcedure.
      * <TOTEM:PARA. ef-cau-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-mail-BeforeProcedure.
      * <TOTEM:PARA. ef-mail-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-mail-cc-BeforeProcedure.
      * <TOTEM:PARA. ef-mail-cc-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-sito-impcar-BeforeProcedure.
      * <TOTEM:PARA. ef-sito-impcar-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-user-impcar-BeforeProcedure.
      * <TOTEM:PARA. ef-user-impcar-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-pwd-impcar-BeforeProcedure.
      * <TOTEM:PARA. ef-pwd-impcar-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-rem-impcar-BeforeProcedure.
      * <TOTEM:PARA. ef-path-rem-impcar-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cod-commitente-AfterProcedure.
      * <TOTEM:PARA. ef-cod-commitente-AfterProcedure>
              INQUIRE ef-cod-commitente, VALUE IN shi-cod-SHI
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cod-commitente-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-mag-AfterProcedure.
      * <TOTEM:PARA. ef-mag-AfterProcedure>
              INQUIRE ef-mag-1, VALUE IN shi-mag-SHI-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mag-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-mag-2, VALUE IN shi-mag-SHI-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mag-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-log-server-AfterProcedure.
      * <TOTEM:PARA. ef-path-log-server-AfterProcedure>
              INQUIRE ef-path-log-server, VALUE IN 
           shi-path-report-server
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-log-server-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-log-client-AfterProcedure.
      * <TOTEM:PARA. ef-path-log-client-AfterProcedure>
              INQUIRE ef-path-log-client, VALUE IN 
           shi-path-report-client
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-log-client-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sem-AfterProcedure.
      * <TOTEM:PARA. ef-sem-AfterProcedure>
              INQUIRE ef-sem, VALUE IN shi-nome-semaforo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sem-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-exp-AfterProcedure.
      * <TOTEM:PARA. ef-path-exp-AfterProcedure>
              INQUIRE ef-path-exp, VALUE IN shi-path-exp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-exp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-backup-AfterProcedure.
      * <TOTEM:PARA. ef-path-backup-AfterProcedure>
              INQUIRE ef-path-backup, VALUE IN shi-path-backup-exp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-backup-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-articoli-AfterProcedure.
      * <TOTEM:PARA. ef-articoli-AfterProcedure>
              INQUIRE ef-articoli, VALUE IN shi-file-articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-articoli-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-AfterProcedure.
      * <TOTEM:PARA. ef-ean-AfterProcedure>
              INQUIRE ef-ean, VALUE IN shi-file-ean
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-prodener-AfterProcedure.
      * <TOTEM:PARA. ef-prodener-AfterProcedure>
              INQUIRE ef-prodener, VALUE IN shi-file-prodener
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prodener-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-vettori-AfterProcedure.
      * <TOTEM:PARA. ef-vettori-AfterProcedure>
              INQUIRE ef-vettori, VALUE IN shi-file-vettori
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vettori-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-fornitori-AfterProcedure.
      * <TOTEM:PARA. ef-fornitori-AfterProcedure>
              INQUIRE ef-fornitori, VALUE IN shi-file-fornitori
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-fornitori-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-classi-AfterProcedure.
      * <TOTEM:PARA. ef-classi-AfterProcedure>
              INQUIRE ef-classi, VALUE IN shi-file-classi
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-classi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-tordini-AfterProcedure.
      * <TOTEM:PARA. ef-tordini-AfterProcedure>
              INQUIRE ef-tordini, VALUE IN shi-file-tordini
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-tordini-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-rordini-AfterProcedure.
      * <TOTEM:PARA. ef-rordini-AfterProcedure>
              INQUIRE ef-rordini, VALUE IN shi-file-rordini
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-rordini-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-AfterProcedure.
      * <TOTEM:PARA. ef-note-AfterProcedure>
              INQUIRE ef-note, VALUE IN shi-file-note-ordini
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sito-exp-AfterProcedure.
      * <TOTEM:PARA. ef-sito-exp-AfterProcedure>
              INQUIRE ef-sito-exp, VALUE IN shi-sito-exp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sito-exp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-user-exp-AfterProcedure.
      * <TOTEM:PARA. ef-user-exp-AfterProcedure>
              INQUIRE ef-user-exp, VALUE IN shi-user-exp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-user-exp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-pwd-exp-AfterProcedure.
      * <TOTEM:PARA. ef-pwd-exp-AfterProcedure>
              INQUIRE ef-pwd-exp, VALUE IN shi-pwd-exp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pwd-exp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-rem-exp-AfterProcedure.
      * <TOTEM:PARA. ef-path-rem-exp-AfterProcedure>
              INQUIRE ef-path-rem-exp, VALUE IN shi-path-remota-exp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-rem-exp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-imp-AfterProcedure.
      * <TOTEM:PARA. ef-path-imp-AfterProcedure>
              INQUIRE ef-path-imp, VALUE IN shi-path-imp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-backup-imp-AfterProcedure.
      * <TOTEM:PARA. ef-path-backup-imp-AfterProcedure>
              INQUIRE ef-path-backup-imp, VALUE IN shi-path-backup-imp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-backup-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-articoli-imp-AfterProcedure.
      * <TOTEM:PARA. ef-articoli-imp-AfterProcedure>
              INQUIRE ef-articoli-imp, VALUE IN shi-file-articoli-imp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-articoli-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-tordini-imp-AfterProcedure.
      * <TOTEM:PARA. ef-tordini-imp-AfterProcedure>
              INQUIRE ef-tordini-imp, VALUE IN shi-file-tordini-imp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-tordini-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-rordini-imp-AfterProcedure.
      * <TOTEM:PARA. ef-rordini-imp-AfterProcedure>
              INQUIRE ef-rordini-imp, VALUE IN shi-file-rordini-imp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-rordini-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sito-imp-AfterProcedure.
      * <TOTEM:PARA. ef-sito-imp-AfterProcedure>
              INQUIRE ef-sito-imp, VALUE IN shi-sito-imp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sito-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-user-imp-AfterProcedure.
      * <TOTEM:PARA. ef-user-imp-AfterProcedure>
              INQUIRE ef-user-imp, VALUE IN shi-user-imp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-user-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-pwd-imp-AfterProcedure.
      * <TOTEM:PARA. ef-pwd-imp-AfterProcedure>
              INQUIRE ef-pwd-imp, VALUE IN shi-pwd-imp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pwd-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-rem-imp-AfterProcedure.
      * <TOTEM:PARA. ef-path-rem-imp-AfterProcedure>
              INQUIRE ef-path-rem-imp, VALUE IN shi-path-remota-imp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-rem-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-impcar-AfterProcedure.
      * <TOTEM:PARA. ef-path-impcar-AfterProcedure>
              INQUIRE ef-path-impcar, VALUE IN shi-path-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-impcar-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-backup-impcar-AfterProcedure.
      * <TOTEM:PARA. ef-path-backup-impcar-AfterProcedure>
              INQUIRE ef-path-backup-impcar, VALUE IN 
           shi-path-backup-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-backup-impcar-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-carichi-AfterProcedure.
      * <TOTEM:PARA. ef-carichi-AfterProcedure>
              INQUIRE ef-carichi, VALUE IN shi-file-carichi-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-carichi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cau-AfterProcedure.
      * <TOTEM:PARA. ef-cau-AfterProcedure>
              INQUIRE ef-cau, VALUE IN shi-causale-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cau-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-mail-AfterProcedure.
      * <TOTEM:PARA. ef-mail-AfterProcedure>
              INQUIRE ef-mail-mod-bozze, VALUE IN shi-mail-mod-bozze
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mail-mod-bozze-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-mail, VALUE IN shi-mail-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mail-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-mail-cc-AfterProcedure.
      * <TOTEM:PARA. ef-mail-cc-AfterProcedure>
              INQUIRE ef-mail-cc-mod-bozze, VALUE IN 
           shi-mail-cc-mod-bozze
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mail-cc-mod-bozze-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-ogg-canc-bozze, VALUE IN shi-oggetto-canc-bozze
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ogg-canc-bozze-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-corpo-canc-bozze, VALUE IN shi-corpo-canc-bozze
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-corpo-canc-bozze-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-ogg-mod-bozze, VALUE IN shi-oggetto-mod-bozze
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ogg-mod-bozze-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-corpo-mod-bozze, VALUE IN shi-corpo-mod-bozze
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-corpo-mod-bozze-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-mail-cc, VALUE IN shi-mail-cc-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mail-cc-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sito-impcar-AfterProcedure.
      * <TOTEM:PARA. ef-sito-impcar-AfterProcedure>
              INQUIRE ef-sito-impcar, VALUE IN shi-sito-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sito-impcar-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-user-impcar-AfterProcedure.
      * <TOTEM:PARA. ef-user-impcar-AfterProcedure>
              INQUIRE ef-user-impcar, VALUE IN shi-user-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-user-impcar-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-pwd-impcar-AfterProcedure.
      * <TOTEM:PARA. ef-pwd-impcar-AfterProcedure>
              INQUIRE ef-pwd-impcar, VALUE IN shi-pwd-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pwd-impcar-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-path-rem-impcar-AfterProcedure.
      * <TOTEM:PARA. ef-path-rem-impcar-AfterProcedure>
              INQUIRE ef-path-rem-impcar, VALUE IN 
           shi-path-remota-impcar
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-path-rem-impcar-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>


      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

