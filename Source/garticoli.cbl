      *{TOTEM}PRG-COMMENT
      * garticoli.Cbl
      * garticoli.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          garticoli.
       AUTHOR.              andre.
       DATE-WRITTEN.        lunedì 22 aprile 2024 11:42:02.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:garticoli, INIT:garticoli, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "tivaese.sl".
           COPY "tmarche.sl".
           COPY "timballi.sl".
           COPY "progmag.sl".
           COPY "tnomen.sl".
           COPY "tcla1art.sl".
           COPY "tsetmerc.sl".
           COPY "tudm.sl".
           COPY "tparamge.sl".
           COPY "clienti.sl".
           COPY "distinteb.sl".
           COPY "rmovmag.sl".
           COPY "rordini.sl".
           COPY "rnotacr.sl".
           COPY "brnotacr.sl".
           COPY "tscorte.sl".
           COPY "rlistini.sl".
           COPY "destinif.sl".
           COPY "articoli.sl"
                REPLACING ==articoli== BY ==articoli1==,
                          ==STATUS-articoli== BY ==STATUS-articoli1==
                .
           COPY "mrordini.sl".
           COPY "reva.sl".
           COPY "rordforn.sl".
           COPY "sort-art-list.sl".
           COPY "timposte.sl".
           COPY "tpiombo.sl".
           COPY "tlistini.sl".
           COPY "prodener.sl".
           COPY "blister.sl".
           COPY "catart.sl".
           COPY "param.sl".
           COPY "impforn.sl".
           COPY "tmagaz.sl".
           COPY "articoli.sl".
           COPY "timbalqta.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "tivaese.fd".
           COPY "tmarche.fd".
           COPY "timballi.fd".
           COPY "progmag.fd".
           COPY "tnomen.fd".
           COPY "tcla1art.fd".
           COPY "tsetmerc.fd".
           COPY "tudm.fd".
           COPY "tparamge.fd".
           COPY "clienti.fd".
           COPY "distinteb.fd".
           COPY "rmovmag.fd".
           COPY "rordini.fd".
           COPY "rnotacr.fd".
           COPY "brnotacr.fd".
           COPY "tscorte.fd".
           COPY "rlistini.fd".
           COPY "destinif.fd".
           COPY "articoli.fd"
                REPLACING ==articoli== BY ==articoli1==,
                          ==STATUS-articoli== BY ==STATUS-articoli1==
                .
           COPY "mrordini.fd".
           COPY "reva.fd".
           COPY "rordforn.fd".
           COPY "sort-art-list.fd".
           COPY "timposte.fd".
           COPY "tpiombo.fd".
           COPY "tlistini.fd".
           COPY "prodener.fd".
           COPY "blister.fd".
           COPY "catart.fd".
           COPY "param.fd".
           COPY "impforn.fd".
           COPY "tmagaz.fd".
           COPY "articoli.fd".
           COPY "timbalqta.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "fonts.def".
               COPY "crtvars.def".
               COPY "opensave.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "standard.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
      * Properties & User defined Working Stoarge
           COPY  "GARTICOLI-WS.DEF".
       77 copia-bmp        PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 como-des         PIC  x(50).
       77 como-des2        PIC  x(50).
       77 v-copiada        PIC  9
                  VALUE IS 0.

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 Screen1-Ta-1-TAB-VALUE  PIC  99  VALUE 1.
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
      * DATA CONTROL BUFFER
       01 Form1-BUF.
      * Data.Entry-Field
              05 ef-codice-BUF PIC x(6).
      * Page
              05 PAGE-1-BUF.
      * Data.Label
              10 lab-dest-BUF PIC X(40).
      * Data.Entry-Field
              10 ef-des1-BUF PIC x(30).
      * Data.Entry-Field
              10 ef-des2-BUF PIC x(20).
      * Data.Entry-Field
              10 ef-des-altern-BUF PIC X(50).
      * Data.Entry-Field
              10 ef-coll-BUF PIC z(6).
              10 ef-coll-VALUEBUF PIC 9(6).
      * Data.Entry-Field
              10 ef-setmerc-BUF PIC zzz9.
      * Data.Entry-Field
              10 ef-iva-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-marca-BUF PIC zzz9.
      * Data.Entry-Field
              10 ef-mag-BUF PIC x(3).
      * Data.Entry-Field
              10 ef-classe-1-BUF PIC zzz9.
      * Data.Entry-Field
              10 ef-classe-2-BUF PIC zz9.
      * Data.Entry-Field
              10 ef-classe-3-BUF PIC zz9.
      * Data.Entry-Field
              10 ef-classe-4-BUF PIC zz9.
      * Data.Entry-Field
              10 ef-udm-BUF PIC X(2).
      * Data.Entry-Field
              10 ef-imballo-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-udm-imballo-BUF PIC X(5).
      * Data.Entry-Field
              10 ef-dogana-BUF PIC 9(8).
      * Data.Entry-Field
              10 ef-peso-utf-BUF PIC zz.zz9,999.
      * Data.Entry-Field
              10 ef-peso-non-utf-BUF PIC zz.zz9,999.
      * Data.Entry-Field
              10 ef-prodener-BUF PIC x(10).
      * Data.Check-Box
              10 chk-novita-BUF PIC 9 VALUE ZERO.
      * Data.Radio-Button
              10 Form1-RADIO-1-BUF PIC 99 VALUE ZERO.
      * Data.Check-Box
              10 chk-imposte-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-perce-imposte-BUF PIC zz9,999.
      * Data.Entry-Field
              10 ef-perce-cou-BUF PIC zz9,9(3).
      * Data.Entry-Field
              10 ef-scorta-BUF PIC --------9.
      * Data.Entry-Field
              10 ef-moq-BUF PIC 9(8).
      * Data.Check-Box
              10 chk-cobat-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-amperaggio-BUF PIC zz9.
      * Data.Entry-Field
              10 ef-reale-BUF PIC zz.zz9,999.
      * Data.Entry-Field
              10 ef-prezzo-acq-BUF PIC zzz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-sconto-acquisto-BUF PIC z9,99.
      * Data.Entry-Field
              10 ef-prz-vend-BUF PIC zzz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-litri-BUF PIC z.zz9,999.
      * Data.Entry-Field
              10 ef-prezzo-banco-BUF PIC zzz.zz9,99.
      * Data.Entry-Field
              10 ef-sconto-agente-BUF PIC z9,99.
      * Data.Entry-Field
              10 ef-min-vend-BUF PIC zz.zz9,99.
      * Data.Entry-Field
              10 ef-ean-1-BUF PIC 9(13)b.
              10 ef-ean-1-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-ean-2-BUF PIC 9(13)b.
              10 ef-ean-2-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-ean-3-BUF PIC 9(13)b.
              10 ef-ean-3-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-ean-4-BUF PIC 9(13)b.
              10 ef-ean-4-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-ean-5-BUF PIC 9(13)b.
              10 ef-ean-5-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-art-for-BUF PIC X(15).
              10 ef-art-for-VALUEBUF PIC X(15).
      * Data.Entry-Field
              10 ef-forn-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-destino-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-note2-BUF PIC X(300).
      * Data.Check-Box
              10 chk-ala-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-agenti-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-eg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-cepsa-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-gda-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-specialist-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-gds-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-gruppi-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-estero-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-web-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-SPI-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-AT-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-ATa-BUF PIC 9 VALUE ZERO.
      * Data.Label
              10 lab-setmerc-BUF PIC X(30).
      * Data.Label
              10 lab-marca-BUF PIC X(30).
      * Data.Label
              10 lab-classe-BUF PIC X(30).
      * Data.Label
              10 lab-udm-BUF PIC X(30).
      * Data.Label
              10 lab-dogana-BUF PIC X(50).
      * Data.Label
              10 lab-forn-BUF PIC X(40).
      * Data.Label
              10 lab-mag-BUF PIC X(50).
      * Data.Label
              10 lab-des-coll-BUF PIC X(50).
      * Data.Label
              10 lab-prodener-BUF PIC X(50).
      * Data.Label
              10 lab-classe-2-BUF PIC X(30).
      * Data.Label
              10 lab-classe-4-BUF PIC X(30).
      * Data.Label
              10 lab-classe-3-BUF PIC X(30).
      * Page
              05 Form1-Pg-2-BUF.
      * Data.Entry-Field
              10 ef-note-agg-BUF PIC X(512).
      * Data.Entry-Field
              10 ef-foto-BUF PIC X(512).
      * Data.Entry-Field
              10 ef-brand-BUF PIC X(512).
      * Data.Entry-Field
              10 ef-scheda-BUF PIC X(512).
      * Data.Entry-Field
              10 ef-toss-BUF PIC X(512).
      * Data.Entry-Field
              10 ef-des-ing-BUF PIC X(60).
      * Data.Entry-Field
              10 ef-des-spa-BUF PIC X(60).
      * Data.Entry-Field
              10 ef-altezza-pz-BUF PIC zzz.zz9,99.
      * Data.Entry-Field
              10 ef-larghezza-pz-BUF PIC zzz.zz9,99.
      * Data.Entry-Field
              10 ef-profondita-pz-BUF PIC zzz.zz9,99.
      * Data.Entry-Field
              10 ef-qta-cartone-BUF PIC zzz.zz9.
      * Data.Entry-Field
              10 ef-qta-stda-BUF PIC zzz.zz9.
      * Data.Entry-Field
              10 ef-adr-BUF PIC x(15).
      * Data.Entry-Field
              10 ef-peso-SHI-BUF PIC zzz.zz9,999.
      * Data.Entry-Field
              10 ef-peso-GET-BUF PIC zzz.zz9,999.
      * Data.Entry-Field
              10 ef-altezza-BUF PIC zzz.zz9,99.
      * Data.Entry-Field
              10 ef-larghezza-BUF PIC zzz.zz9,99.
      * Data.Entry-Field
              10 ef-profondita-BUF PIC zzz.zz9,99.
      * Data.Entry-Field
              10 ef-qta-epal-BUF PIC zz.zzz.zz9.
      * Data.Entry-Field
              10 ef-qta-std-BUF PIC zz.zzz.zz9.
      * Data.Check-Box
              10 chk-T1-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-T2-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-T3-BUF PIC 9 VALUE ZERO.
      * Page
              05 PAGE-2-BUF.
      * Data.Entry-Field
              10 ef-peso-utf-prg-BUF PIC zz.zz9,999.
      * Data.Entry-Field
              10 ef-peso-non-utf-prg-BUF PIC zz.zz9,999.
      * Data.Entry-Field
              10 EF-COSTO-ULTIMO-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 EF-COSTO-MEDIO-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 EF-COSTO-MP-BUF PIC ----.---.---.--9,99.
      * Data.Entry-Field
              10 EF-GIACENZA-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-ORD-CLI-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 ef-giac-buona-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-ORD-FORN-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-ORD-FORNa-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-ORD-FORNb-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-ORD-FORNc-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-ORD-FORNca-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-ORD-FORNcb-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-INI-UDM-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-INI-KG-BUF PIC ----.---.--9,999.
      * Data.Entry-Field
              10 EF-INI-VALORE-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 EF-ACQ-UDM-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-ACQ-KG-BUF PIC ----.---.--9,999.
      * Data.Entry-Field
              10 EF-ACQ-VALORE-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 EF-VEN-UDM-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-VEN-KG-BUF PIC ----.---.--9,999.
      * Data.Entry-Field
              10 EF-VEN-VALORE-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 EF-VAR-UDM-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-VAR-KG-BUF PIC ----.---.--9,999.
      * Data.Entry-Field
              10 EF-VAR-VALORE-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 EF-FORN-UDM-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-FORN-KG-BUF PIC ----.---.--9,999.
      * Data.Entry-Field
              10 EF-FORN-VALORE-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 EF-CLI-UDM-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-CLI-KG-BUF PIC ----.---.--9,999.
      * Data.Entry-Field
              10 EF-CLI-VALORE-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 EF-FORN-UDMa-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-FORN-KGa-BUF PIC ----.---.--9,999.
      * Data.Entry-Field
              10 EF-FORN-VALOREa-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 EF-CLI-UDMa-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 EF-CLI-KGa-BUF PIC ----.---.--9,999.
      * Data.Entry-Field
              10 EF-CLI-VALOREa-BUF PIC ----.---.--9,9(2).
      * Data.Entry-Field
              10 ef-gia-udm-BUF PIC ---.---.--9.
      * Data.Entry-Field
              10 ef-gia-kg-BUF PIC ----.---.--9,999.
      * Page
              05 Form1-Pg-1-BUF.
      * Data.Entry-Field
              10 ef-dt-val-da-BUF PIC 99/99/9999.
      * Data.Entry-Field
              10 ef-dt-val-a-BUF PIC 99/99/9999.

       77 TMP-Form1-KEY1-ORDER  PIC X VALUE "A".
       77 TMP-Form1-KEY2-ORDER  PIC X VALUE "A".
       77 TMP-Form1-articoli-RESTOREBUF  PIC X(3669).
       77 TMP-Form1-KEYIS  PIC 9(3) VALUE 1.
       77 Form1-MULKEY-TMPBUF   PIC X(3669).
       77 Form1-KEYISTMP2   PIC X(50).
      * Form1 : PKEY & AKEY'S TEMP BUFFER
       77 Form1-PKEYTMP   PIC X(6).
       77 STATUS-form-ean-FLAG-REFRESH PIC  9.
          88 form-ean-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 STATUS-form3-FLAG-REFRESH PIC  9.
          88 form3-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 STATUS-form-frn-FLAG-REFRESH PIC  9.
          88 form-frn-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 TMP-DataSet1-tivaese-BUF     PIC X(1380).
       77 TMP-DataSet1-tmarche-BUF     PIC X(217).
       77 TMP-DataSet1-timballi-BUF     PIC X(210).
       77 TMP-DataSet1-progmag-BUF     PIC X(1090).
       77 TMP-DataSet1-tnomen-BUF     PIC X(228).
       77 TMP-DataSet1-tcla1art-BUF     PIC X(591).
       77 TMP-DataSet1-tsetmerc-BUF     PIC X(191).
       77 TMP-DataSet1-tudm-BUF     PIC X(189).
       77 TMP-DataSet1-tparamge-BUF     PIC X(815).
       77 TMP-DataSet1-clienti-BUF     PIC X(3610).
       77 TMP-DataSet1-distinteb-BUF     PIC X(672).
       77 TMP-DataSet1-rmovmag-BUF     PIC X(446).
       77 TMP-DataSet1-rordini-BUF     PIC X(667).
       77 TMP-DataSet1-rnotacr-BUF     PIC X(545).
       77 TMP-DataSet1-brnotacr-BUF     PIC X(424).
       77 TMP-DataSet1-tscorte-BUF     PIC X(205).
       77 TMP-DataSet1-rlistini-BUF     PIC X(448).
       77 TMP-DataSet1-destinif-BUF     PIC X(1322).
       77 TMP-DataSet1-articoli1-BUF     PIC X(3669).
       77 TMP-DataSet1-mrordini-BUF     PIC X(891).
       77 TMP-DataSet1-reva-BUF     PIC X(260).
       77 TMP-DataSet1-rordforn-BUF     PIC X(544).
       77 TMP-DataSet1-sort-art-list-BUF     PIC X(161).
       77 TMP-DataSet1-timposte-BUF     PIC X(717).
       77 TMP-DataSet1-tpiombo-BUF     PIC X(739).
       77 TMP-DataSet1-tlistini-BUF     PIC X(257).
       77 TMP-DataSet1-prodener-BUF     PIC X(686).
       77 TMP-DataSet1-blister-BUF     PIC X(2967).
       77 TMP-DataSet1-catart-BUF     PIC X(6622).
       77 TMP-DataSet1-param-BUF     PIC X(980).
       77 TMP-DataSet1-impforn-BUF     PIC X(220).
       77 TMP-DataSet1-tmagaz-BUF     PIC X(212).
       77 TMP-DataSet1-articoli-BUF     PIC X(3669).
       77 TMP-DataSet1-timbalqta-BUF     PIC X(167).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-tivaese-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tivaese-LOCK  VALUE "Y".
       77 DataSet1-tivaese-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tivaese-KEY-Asc  VALUE "A".
          88 DataSet1-tivaese-KEY-Desc VALUE "D".
       77 DataSet1-tmarche-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmarche-LOCK  VALUE "Y".
       77 DataSet1-tmarche-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmarche-KEY-Asc  VALUE "A".
          88 DataSet1-tmarche-KEY-Desc VALUE "D".
       77 DataSet1-timballi-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timballi-LOCK  VALUE "Y".
       77 DataSet1-timballi-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timballi-KEY-Asc  VALUE "A".
          88 DataSet1-timballi-KEY-Desc VALUE "D".
       77 DataSet1-progmag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-progmag-LOCK  VALUE "Y".
       77 DataSet1-progmag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-progmag-KEY-Asc  VALUE "A".
          88 DataSet1-progmag-KEY-Desc VALUE "D".
       77 DataSet1-tnomen-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tnomen-LOCK  VALUE "Y".
       77 DataSet1-tnomen-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tnomen-KEY-Asc  VALUE "A".
          88 DataSet1-tnomen-KEY-Desc VALUE "D".
       77 DataSet1-tcla1art-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcla1art-LOCK  VALUE "Y".
       77 DataSet1-tcla1art-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcla1art-KEY-Asc  VALUE "A".
          88 DataSet1-tcla1art-KEY-Desc VALUE "D".
       77 DataSet1-tsetmerc-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tsetmerc-LOCK  VALUE "Y".
       77 DataSet1-tsetmerc-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tsetmerc-KEY-Asc  VALUE "A".
          88 DataSet1-tsetmerc-KEY-Desc VALUE "D".
       77 DataSet1-tudm-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tudm-LOCK  VALUE "Y".
       77 DataSet1-tudm-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tudm-KEY-Asc  VALUE "A".
          88 DataSet1-tudm-KEY-Desc VALUE "D".
       77 DataSet1-tparamge-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tparamge-LOCK  VALUE "Y".
       77 DataSet1-tparamge-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tparamge-KEY-Asc  VALUE "A".
          88 DataSet1-tparamge-KEY-Desc VALUE "D".
       77 DataSet1-clienti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-clienti-LOCK  VALUE "Y".
       77 DataSet1-clienti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti-KEY-Asc  VALUE "A".
          88 DataSet1-clienti-KEY-Desc VALUE "D".
       77 DataSet1-distinteb-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-distinteb-LOCK  VALUE "Y".
       77 DataSet1-distinteb-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-distinteb-KEY-Asc  VALUE "A".
          88 DataSet1-distinteb-KEY-Desc VALUE "D".
       77 DataSet1-rmovmag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rmovmag-LOCK  VALUE "Y".
       77 DataSet1-rmovmag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rmovmag-KEY-Asc  VALUE "A".
          88 DataSet1-rmovmag-KEY-Desc VALUE "D".
       77 DataSet1-rordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rordini-LOCK  VALUE "Y".
       77 DataSet1-rordini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rordini-KEY-Asc  VALUE "A".
          88 DataSet1-rordini-KEY-Desc VALUE "D".
       77 DataSet1-rnotacr-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rnotacr-LOCK  VALUE "Y".
       77 DataSet1-rnotacr-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rnotacr-KEY-Asc  VALUE "A".
          88 DataSet1-rnotacr-KEY-Desc VALUE "D".
       77 DataSet1-brnotacr-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-brnotacr-LOCK  VALUE "Y".
       77 DataSet1-brnotacr-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-brnotacr-KEY-Asc  VALUE "A".
          88 DataSet1-brnotacr-KEY-Desc VALUE "D".
       77 DataSet1-tscorte-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tscorte-LOCK  VALUE "Y".
       77 DataSet1-tscorte-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tscorte-KEY-Asc  VALUE "A".
          88 DataSet1-tscorte-KEY-Desc VALUE "D".
       77 DataSet1-rlistini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rlistini-LOCK  VALUE "Y".
       77 DataSet1-rlistini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rlistini-KEY-Asc  VALUE "A".
          88 DataSet1-rlistini-KEY-Desc VALUE "D".
       77 DataSet1-destinif-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-destinif-LOCK  VALUE "Y".
       77 DataSet1-destinif-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-destinif-KEY-Asc  VALUE "A".
          88 DataSet1-destinif-KEY-Desc VALUE "D".
       77 DataSet1-articoli1-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-articoli1-LOCK  VALUE "Y".
       77 DataSet1-articoli1-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-articoli1-KEY-Asc  VALUE "A".
          88 DataSet1-articoli1-KEY-Desc VALUE "D".
       77 DataSet1-mrordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-mrordini-LOCK  VALUE "Y".
       77 DataSet1-mrordini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-mrordini-KEY-Asc  VALUE "A".
          88 DataSet1-mrordini-KEY-Desc VALUE "D".
       77 DataSet1-reva-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-reva-LOCK  VALUE "Y".
       77 DataSet1-reva-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-reva-KEY-Asc  VALUE "A".
          88 DataSet1-reva-KEY-Desc VALUE "D".
       77 DataSet1-rordforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rordforn-LOCK  VALUE "Y".
       77 DataSet1-rordforn-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rordforn-KEY-Asc  VALUE "A".
          88 DataSet1-rordforn-KEY-Desc VALUE "D".
       77 DataSet1-sort-art-list-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-sort-art-list-LOCK  VALUE "Y".
       77 DataSet1-sort-art-list-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-sort-art-list-KEY-Asc  VALUE "A".
          88 DataSet1-sort-art-list-KEY-Desc VALUE "D".
       77 DataSet1-timposte-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timposte-LOCK  VALUE "Y".
       77 DataSet1-timposte-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timposte-KEY-Asc  VALUE "A".
          88 DataSet1-timposte-KEY-Desc VALUE "D".
       77 DataSet1-tpiombo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tpiombo-LOCK  VALUE "Y".
       77 DataSet1-tpiombo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tpiombo-KEY-Asc  VALUE "A".
          88 DataSet1-tpiombo-KEY-Desc VALUE "D".
       77 DataSet1-tlistini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tlistini-LOCK  VALUE "Y".
       77 DataSet1-tlistini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tlistini-KEY-Asc  VALUE "A".
          88 DataSet1-tlistini-KEY-Desc VALUE "D".
       77 DataSet1-prodener-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-prodener-LOCK  VALUE "Y".
       77 DataSet1-prodener-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-prodener-KEY-Asc  VALUE "A".
          88 DataSet1-prodener-KEY-Desc VALUE "D".
       77 DataSet1-blister-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-blister-LOCK  VALUE "Y".
       77 DataSet1-blister-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-blister-KEY-Asc  VALUE "A".
          88 DataSet1-blister-KEY-Desc VALUE "D".
       77 DataSet1-catart-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-catart-LOCK  VALUE "Y".
       77 DataSet1-catart-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-catart-KEY-Asc  VALUE "A".
          88 DataSet1-catart-KEY-Desc VALUE "D".
       77 DataSet1-param-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-param-LOCK  VALUE "Y".
       77 DataSet1-param-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-param-KEY-Asc  VALUE "A".
          88 DataSet1-param-KEY-Desc VALUE "D".
       77 DataSet1-impforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-impforn-LOCK  VALUE "Y".
       77 DataSet1-impforn-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-impforn-KEY-Asc  VALUE "A".
          88 DataSet1-impforn-KEY-Desc VALUE "D".
       77 DataSet1-tmagaz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmagaz-LOCK  VALUE "Y".
       77 DataSet1-tmagaz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmagaz-KEY-Asc  VALUE "A".
          88 DataSet1-tmagaz-KEY-Desc VALUE "D".
       77 DataSet1-articoli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-articoli-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-articoli-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-articoli-KEY1-Asc  VALUE "A".
          88 DataSet1-articoli-KEY1-Desc VALUE "D".
       77 DataSet1-articoli-KEY2-ORDER  PIC X VALUE "A".
          88 DataSet1-articoli-KEY2-Asc  VALUE "A".
          88 DataSet1-articoli-KEY2-Desc VALUE "D".
       77 DataSet1-timbalqta-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timbalqta-LOCK  VALUE "Y".
       77 DataSet1-timbalqta-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timbalqta-KEY-Asc  VALUE "A".
          88 DataSet1-timbalqta-KEY-Desc VALUE "D".

       77 tivaese-key01-SPLITBUF  PIC X(53).
       77 progmag-key01-SPLITBUF  PIC X(21).
       77 clienti-cli-K1-SPLITBUF  PIC X(47).
       77 clienti-cli-K3-SPLITBUF  PIC X(12).
       77 clienti-cli-K4-SPLITBUF  PIC X(8).
       77 distinteb-k-articolo-SPLITBUF  PIC X(12).
       77 distinteb-k-progmag-SPLITBUF  PIC X(21).
       77 rmovmag-k-articolo-SPLITBUF  PIC X(19).
       77 rmovmag-rmo-chiave-ricerca-SPLITBUF  PIC X(25).
       77 rmovmag-k-progmag-SPLITBUF  PIC X(21).
       77 rmovmag-k-art-data-SPLITBUF  PIC X(15).
       77 rordini-ror-k-promo-SPLITBUF  PIC X(16).
       77 rordini-ror-k-articolo-SPLITBUF  PIC X(24).
       77 rordini-ror-k-master-SPLITBUF  PIC X(35).
       77 rordini-ror-k-stbolle-SPLITBUF  PIC X(30).
       77 rordini-ror-k-ord-art-SPLITBUF  PIC X(19).
       77 rnotacr-rno-k-articolo-SPLITBUF  PIC X(24).
       77 brnotacr-brno-k-articolo-SPLITBUF  PIC X(25).
       77 rlistini-rlis-k-art-SPLITBUF  PIC X(33).
       77 rlistini-rlis-k-descr-SPLITBUF  PIC X(66).
       77 destinif-K1-SPLITBUF  PIC X(51).
       77 destinif-desf-k2-SPLITBUF  PIC X(51).
       77 articoli1-art-k1-SPLITBUF  PIC X(51).
       77 articoli1-art-k-frn-SPLITBUF  PIC X(16).
       77 mrordini-mro-k-promo-SPLITBUF  PIC X(33).
       77 mrordini-mro-k-articolo-SPLITBUF  PIC X(24).
       77 mrordini-mro-k-progr-SPLITBUF  PIC X(18).
       77 mrordini-mro-k-tprev-SPLITBUF  PIC X(39).
       77 mrordini-mro-k-ord-art-SPLITBUF  PIC X(19).
       77 reva-reva-k-articolo-SPLITBUF  PIC X(26).
       77 rordforn-rof-k-articolo-SPLITBUF  PIC X(24).
       77 rordforn-rof-k-art-mag-SPLITBUF  PIC X(27).
       77 prodener-pen-k-nc-SPLITBUF  PIC X(19).
       77 blister-k-magaz-SPLITBUF  PIC X(10).
       77 blister-k-des-SPLITBUF  PIC X(51).
       77 catart-cat-art-princ-SPLITBUF  PIC X(13).
       77 articoli-art-k1-SPLITBUF  PIC X(51).
       77 articoli-art-k-frn-SPLITBUF  PIC X(16).
      * FOR SPLIT KEY BUFFER
       77 DataSet1-articoli-SPLIT-BUF2   PIC X(51).


      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-ef-codice VALUE 5001.
       78  78-ID-ef-des1 VALUE 5002.
       78  78-ID-ef-des2 VALUE 5003.
       78  78-ID-ef-des-altern VALUE 5004.
       78  78-ID-ef-coll VALUE 5005.
       78  78-ID-ef-setmerc VALUE 5006.
       78  78-ID-ef-iva VALUE 5007.
       78  78-ID-ef-marca VALUE 5008.
       78  78-ID-ef-mag VALUE 5009.
       78  78-ID-ef-classe-1 VALUE 5010.
       78  78-ID-ef-classe-2 VALUE 5011.
       78  78-ID-ef-classe-3 VALUE 5012.
       78  78-ID-ef-classe-4 VALUE 5013.
       78  78-ID-ef-udm VALUE 5014.
       78  78-ID-ef-imballo VALUE 5015.
       78  78-ID-ef-udm-imballo VALUE 5016.
       78  78-ID-ef-dogana VALUE 5017.
       78  78-ID-cbo-utf VALUE 5018.
       78  78-ID-ef-peso-utf VALUE 5019.
       78  78-ID-ef-peso-non-utf VALUE 5020.
       78  78-ID-ef-prodener VALUE 5021.
       78  78-ID-chk-novita VALUE 5022.
       78  78-ID-Form1-DaRb-1 VALUE 5023.
       78  78-ID-Form1-DaRb-2 VALUE 5024.
       78  78-ID-chk-imposte VALUE 5025.
       78  78-ID-ef-perce-imposte VALUE 5026.
       78  78-ID-ef-perce-cou VALUE 5027.
       78  78-ID-ef-scorta VALUE 5028.
       78  78-ID-ef-moq VALUE 5029.
       78  78-ID-chk-cobat VALUE 5030.
       78  78-ID-ef-amperaggio VALUE 5031.
       78  78-ID-cbo-cobat VALUE 5032.
       78  78-ID-ef-reale VALUE 5033.
       78  78-ID-ef-prezzo-acq VALUE 5034.
       78  78-ID-ef-sconto-acquisto VALUE 5035.
       78  78-ID-ef-prz-vend VALUE 5036.
       78  78-ID-ef-litri VALUE 5037.
       78  78-ID-ef-prezzo-banco VALUE 5038.
       78  78-ID-ef-sconto-agente VALUE 5039.
       78  78-ID-ef-min-vend VALUE 5040.
       78  78-ID-ef-ean-1 VALUE 5041.
       78  78-ID-ef-ean-2 VALUE 5042.
       78  78-ID-ef-ean-3 VALUE 5043.
       78  78-ID-ef-ean-4 VALUE 5044.
       78  78-ID-ef-ean-5 VALUE 5045.
       78  78-ID-ef-art-for VALUE 5046.
       78  78-ID-ef-forn VALUE 5047.
       78  78-ID-ef-destino VALUE 5048.
       78  78-ID-ef-note2 VALUE 5049.
       78  78-ID-cbo-stato VALUE 5050.
       78  78-ID-chk-ala VALUE 5051.
       78  78-ID-chk-agenti VALUE 5052.
       78  78-ID-chk-eg VALUE 5053.
       78  78-ID-chk-cepsa VALUE 5054.
       78  78-ID-chk-gda VALUE 5055.
       78  78-ID-chk-specialist VALUE 5056.
       78  78-ID-chk-gds VALUE 5057.
       78  78-ID-chk-gruppi VALUE 5058.
       78  78-ID-chk-estero VALUE 5059.
       78  78-ID-chk-web VALUE 5060.
       78  78-ID-chk-SPI VALUE 5061.
       78  78-ID-chk-AT VALUE 5062.
       78  78-ID-chk-ATa VALUE 5063.
       78  78-ID-ef-note-agg VALUE 5064.
       78  78-ID-ef-foto VALUE 5065.
       78  78-ID-ef-brand VALUE 5066.
       78  78-ID-ef-scheda VALUE 5067.
       78  78-ID-ef-toss VALUE 5068.
       78  78-ID-ef-des-ing VALUE 5069.
       78  78-ID-ef-des-spa VALUE 5070.
       78  78-ID-ef-altezza-pz VALUE 5071.
       78  78-ID-ef-larghezza-pz VALUE 5072.
       78  78-ID-ef-profondita-pz VALUE 5073.
       78  78-ID-ef-qta-cartone VALUE 5074.
       78  78-ID-ef-qta-stda VALUE 5075.
       78  78-ID-ef-adr VALUE 5076.
       78  78-ID-ef-peso-GET VALUE 5077.
       78  78-ID-ef-altezza VALUE 5078.
       78  78-ID-ef-larghezza VALUE 5079.
       78  78-ID-ef-profondita VALUE 5080.
       78  78-ID-ef-qta-epal VALUE 5081.
       78  78-ID-ef-qta-std VALUE 5082.
       78  78-ID-chk-T1 VALUE 5083.
       78  78-ID-chk-T2 VALUE 5084.
       78  78-ID-chk-T3 VALUE 5085.
       78  78-ID-EF-ORD-FORNa VALUE 5086.
       78  78-ID-EF-ORD-FORNb VALUE 5087.
       78  78-ID-EF-ORD-FORNc VALUE 5088.
       78  78-ID-ef-dt-val-da VALUE 5089.
       78  78-ID-ef-dt-val-a VALUE 5090.
       78  78-ID-ef-ean VALUE 5001.
       78  78-ID-ef-frn VALUE 5001.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "COMMON-LINKAGE.DEF".

      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           AFTER PROCEDURE Form1-AfterProcedure,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           .

      * ENTRY FIELD
       05
           ef-codice, 
           Entry-Field, 
           COL 16,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-k,
           ID IS 78-ID-ef-codice,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 6,
           VALUE ef-codice-BUF,
           .

      * TAB
       05
           Screen1-Ta-1, 
           Tab-Control, 
           COL 2,00, 
           LINE 5,77,
           LINES 48,77 ,
           SIZE 166,00 ,
           ID IS 5000,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           EVENT PROCEDURE Screen1-Ta-1-Event-Proc,
           .

      * PAGE
       05
           PAGE-1, 
           VISIBLE Form1-Pg-1-Visible,
           COL 3, 
           LINE 8,
           .

      * DB_LABEL
       10
           lab-dest, 
           Label, 
           COL 30,67, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 136,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-dest-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * FRAME
       10
           Form1-Fr-1, 
           Frame, 
           COL 96,84, 
           LINE 37,23,
           LINES 9,31 ,
           SIZE 68,00 ,
           ID IS 171,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           .

      * ENTRY FIELD
       10
           ef-des1, 
           Entry-Field, 
           COL 21,67, 
           LINE 8,46,
           LINES 1,31 ,
           SIZE 45,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-des1-BUF,
           .

      * ENTRY FIELD
       10
           ef-des2, 
           Entry-Field, 
           COL 67,67, 
           LINE 8,46,
           LINES 1,31 ,
           SIZE 32,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 31,
           VALUE ef-des2-BUF,
           .

      * ENTRY FIELD
       10
           ef-des-altern, 
           Entry-Field, 
           COL 118,67, 
           LINE 8,46,
           LINES 1,31 ,
           SIZE 47,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des-altern,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-des-altern-BUF,
           .

      * ENTRY FIELD
       10
           ef-coll, 
           Entry-Field, 
           COL 21,67, 
           LINE 10,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-coll,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-coll-BUF,
           .

      * ENTRY FIELD
       10
           ef-setmerc, 
           Entry-Field, 
           COL 21,67, 
           LINE 12,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-setmerc,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           VALUE ef-setmerc-BUF,
           .

      * ENTRY FIELD
       10
           ef-iva, 
           Entry-Field, 
           COL 91,67, 
           LINE 12,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-iva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-iva-BUF,
           .

      * ENTRY FIELD
       10
           ef-marca, 
           Entry-Field, 
           COL 21,67, 
           LINE 14,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-marca,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           VALUE ef-marca-BUF,
           .

      * ENTRY FIELD
       10
           ef-mag, 
           Entry-Field, 
           COL 91,67, 
           LINE 14,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-mag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-mag-BUF,
           .

      * ENTRY FIELD
       10
           ef-classe-1, 
           Entry-Field, 
           COL 21,67, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-classe-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           VALUE ef-classe-1-BUF,
           .

      * ENTRY FIELD
       10
           ef-classe-2, 
           Entry-Field, 
           COL 91,67, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-classe-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-classe-2-BUF,
           .

      * ENTRY FIELD
       10
           ef-classe-3, 
           Entry-Field, 
           COL 21,67, 
           LINE 18,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-classe-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-classe-3-BUF,
           .

      * ENTRY FIELD
       10
           ef-classe-4, 
           Entry-Field, 
           COL 91,67, 
           LINE 18,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-classe-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-classe-4-BUF,
           .

      * ENTRY FIELD
       10
           ef-udm, 
           Entry-Field, 
           COL 21,67, 
           LINE 20,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-udm,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 2,
           VALUE ef-udm-BUF,
           .

      * ENTRY FIELD
       10
           ef-imballo, 
           Entry-Field, 
           COL 91,67, 
           LINE 20,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-imballo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-imballo-BUF,
           .

      * ENTRY FIELD
       10
           ef-udm-imballo, 
           Entry-Field, 
           COL 157,00, 
           LINE 20,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-udm-imballo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           VALUE ef-udm-imballo-BUF,
           .

      * ENTRY FIELD
       10
           ef-dogana, 
           Entry-Field, 
           COL 21,67, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-dogana,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-dogana-BUF,
           .

      * COMBO-BOX
       10
           cbo-utf, 
           Combo-Box, 
           COL 91,67, 
           LINE 22,46,
           LINES 5,00 ,
           SIZE 16,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-utf-buf,
           AFTER PROCEDURE cbo-utf-AfterProcedure, 
           EVENT PROCEDURE cbo-utf-Event-Proc,
           .

      * ENTRY FIELD
       10
           ef-peso-utf, 
           Entry-Field, 
           COL 127,67, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-peso-utf,
           FONT IS Small-Font,
           ID IS 78-ID-ef-peso-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-peso-utf-BUF,
           .

      * ENTRY FIELD
       10
           ef-peso-non-utf, 
           Entry-Field, 
           COL 155,17, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-peso-non-utf,
           FONT IS Small-Font,
           ID IS 78-ID-ef-peso-non-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-peso-non-utf-BUF,
           .

      * ENTRY FIELD
       10
           ef-prodener, 
           Entry-Field, 
           COL 21,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prodener,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 10,
           VALUE ef-prodener-BUF,
           .

      * CHECK BOX
       10
           chk-novita, 
           Check-Box, 
           COL 91,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-novita,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-novita-BUF,
           BEFORE PROCEDURE Form1-DaCb-1-BeforeProcedure, 
            .
      * RADIO BUTTON
       10
           Form1-DaRb-1, 
           Radio-Button, 
           COL 127,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           GROUP 1,
           GROUP-VALUE 1,
           ID IS 78-ID-Form1-DaRb-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Confezionato",
           VALUE Form1-RADIO-1-BUF,
            .

      * RADIO BUTTON
       10
           Form1-DaRb-2, 
           Radio-Button, 
           COL 145,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           GROUP 1,
           GROUP-VALUE 2,
           ID IS 78-ID-Form1-DaRb-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Sfuso",
           VALUE Form1-RADIO-1-BUF,
            .

      * CHECK BOX
       10
           chk-imposte, 
           Check-Box, 
           COL 21,67, 
           LINE 26,46,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-imposte,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-imposte-BUF,
            .

      * ENTRY FIELD
       10
           ef-perce-imposte, 
           Entry-Field, 
           COL 56,67, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-imposte,
           FONT IS Small-Font,
           ID IS 78-ID-ef-perce-imposte,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           VALUE ef-perce-imposte-BUF,
           .

      * ENTRY FIELD
       10
           ef-perce-cou, 
           Entry-Field, 
           COL 91,67, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-imposte,
           FONT IS Small-Font,
           ID IS 78-ID-ef-perce-cou,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           VALUE ef-perce-cou-BUF,
           .

      * ENTRY FIELD
       10
           ef-scorta, 
           Entry-Field, 
           COL 127,67, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-scorta,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           VALUE ef-scorta-BUF,
           .

      * ENTRY FIELD
       10
           ef-moq, 
           Entry-Field, 
           COL 155,17, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-moq,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-moq-BUF,
           VISIBLE v-moq,
           .

      * CHECK BOX
       10
           chk-cobat, 
           Check-Box, 
           COL 21,67, 
           LINE 28,46,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 78-ID-chk-cobat,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-cobat",
           VALUE chk-cobat-BUF,
            .

      * ENTRY FIELD
       10
           ef-amperaggio, 
           Entry-Field, 
           COL 91,67, 
           LINE 28,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-cobat,
           FONT IS Small-Font,
           ID IS 78-ID-ef-amperaggio,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-amperaggio-BUF,
           .

      * COMBO-BOX
       10
           cbo-cobat, 
           Combo-Box, 
           COL 127,67, 
           LINE 28,46,
           LINES 4,00 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-cobat,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-cobat,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-cobat-buf,
           AFTER PROCEDURE Form1-Cm-1-AfterProcedure, 
           .

      * ENTRY FIELD
       10
           ef-reale, 
           Entry-Field, 
           COL 155,17, 
           LINE 28,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-reale,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-reale-BUF,
           VISIBLE v-reale,
           .

      * ENTRY FIELD
       10
           ef-prezzo-acq, 
           Entry-Field, 
           COL 21,67, 
           LINE 30,46,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prezzo-acq,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           VALUE ef-prezzo-acq-BUF,
           .

      * ENTRY FIELD
       10
           ef-sconto-acquisto, 
           Entry-Field, 
           COL 91,67, 
           LINE 30,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto-acquisto,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-sconto-acquisto-BUF,
           .

      * ENTRY FIELD
       10
           ef-prz-vend, 
           Entry-Field, 
           COL 127,67, 
           LINE 30,46,
           LINES 1,31 ,
           SIZE 14,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prz-vend,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           VALUE ef-prz-vend-BUF,
           .

      * ENTRY FIELD
       10
           ef-litri, 
           Entry-Field, 
           COL 155,17, 
           LINE 30,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-litri,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-litri-BUF,
           BEFORE PROCEDURE ef-sconto-agente-BeforeProcedure, 
           .

      * ENTRY FIELD
       10
           ef-prezzo-banco, 
           Entry-Field, 
           COL 21,67, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prezzo-banco,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           VALUE ef-prezzo-banco-BUF,
           .

      * ENTRY FIELD
       10
           ef-sconto-agente, 
           Entry-Field, 
           COL 56,67, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto-agente,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-sconto-agente-BUF,
           .

      * ENTRY FIELD
       10
           ef-min-vend, 
           Entry-Field, 
           COL 91,67, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vend,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-min-vend-BUF,
           .

      * ENTRY FIELD
       10
           ef-ean-1, 
           Entry-Field, 
           COL 21,67, 
           LINE 34,69,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-1-BUF,
           .

      * ENTRY FIELD
       10
           ef-ean-2, 
           Entry-Field, 
           COL 56,67, 
           LINE 34,69,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-2-BUF,
           .

      * ENTRY FIELD
       10
           ef-ean-3, 
           Entry-Field, 
           COL 91,67, 
           LINE 34,69,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-3-BUF,
           .

      * ENTRY FIELD
       10
           ef-ean-4, 
           Entry-Field, 
           COL 127,67, 
           LINE 34,69,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-4-BUF,
           .

      * ENTRY FIELD
       10
           ef-ean-5, 
           Entry-Field, 
           COL 21,67, 
           LINE 36,69,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-5,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-5-BUF,
           .

      * ENTRY FIELD
       10
           ef-art-for, 
           Entry-Field, 
           COL 21,67, 
           LINE 38,69,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-art-for,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-art-for-BUF,
           .

      * ENTRY FIELD
       10
           ef-forn, 
           Entry-Field, 
           COL 21,67, 
           LINE 40,69,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-forn,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-forn-BUF,
           .

      * ENTRY FIELD
       10
           ef-destino, 
           Entry-Field, 
           COL 21,67, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-destino,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-destino-BUF,
           .

      * ENTRY FIELD
       10
           ef-note2, 
           Entry-Field, 
           COL 21,67, 
           LINE 47,00,
           LINES 5,38 ,
           SIZE 120,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Courier-New10-Occidentale,
           ID IS 78-ID-ef-note2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 300,
           VSCROLL-BAR,
           USE-RETURN,
           USE-TAB,
           VALUE ef-note2-BUF,
           BEFORE PROCEDURE Form1-DaEf-1-BeforeProcedure, 
           .

      * COMBO-BOX
       10
           cbo-stato, 
           Combo-Box, 
           COL 150,00, 
           LINE 47,08,
           LINES 5,00 ,
           SIZE 15,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-stato,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-stato-buf,
           AFTER PROCEDURE cbo-stato-AfterProcedure, 
           EVENT PROCEDURE cbo-stato-Event-Proc,
           .

      * CHECK BOX
       10
           chk-ala, 
           Check-Box, 
           COL 110,67, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-ala,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-ala-BUF,
            .

      * CHECK BOX
       10
           chk-agenti, 
           Check-Box, 
           COL 130,67, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 78-ID-chk-agenti,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-cobat",
           VALUE chk-agenti-BUF,
           VISIBLE 0,
            .

      * CHECK BOX
       10
           chk-eg, 
           Check-Box, 
           COL 145,34, 
           LINE 38,61,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 78-ID-chk-eg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-cobat",
           VALUE chk-eg-BUF,
            .

      * CHECK BOX
       10
           chk-cepsa, 
           Check-Box, 
           COL 160,34, 
           LINE 38,61,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-cepsa,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-cepsa-BUF,
           VISIBLE 0,
            .

      * CHECK BOX
       10
           chk-gda, 
           Check-Box, 
           COL 110,67, 
           LINE 40,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 78-ID-chk-gda,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-cobat",
           VALUE chk-gda-BUF,
            .

      * CHECK BOX
       10
           chk-specialist, 
           Check-Box, 
           COL 130,67, 
           LINE 40,54,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-specialist,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-specialist-BUF,
            .

      * CHECK BOX
       10
           chk-gds, 
           Check-Box, 
           COL 145,34, 
           LINE 40,61,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 78-ID-chk-gds,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-cobat",
           VALUE chk-gds-BUF,
           VISIBLE 0,
            .

      * CHECK BOX
       10
           chk-gruppi, 
           Check-Box, 
           COL 110,67, 
           LINE 42,54,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-gruppi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-gruppi-BUF,
           VISIBLE 0,
            .

      * CHECK BOX
       10
           chk-estero, 
           Check-Box, 
           COL 130,67, 
           LINE 42,54,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-estero,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-estero-BUF,
           VISIBLE 0,
            .

      * CHECK BOX
       10
           chk-web, 
           Check-Box, 
           COL 145,34, 
           LINE 42,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 78-ID-chk-web,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-cobat",
           VALUE chk-web-BUF,
           VISIBLE 0,
            .

      * CHECK BOX
       10
           chk-SPI, 
           Check-Box, 
           COL 110,67, 
           LINE 44,54,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-SPI,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-SPI-BUF,
           VISIBLE 0,
            .

      * CHECK BOX
       10
           chk-AT, 
           Check-Box, 
           COL 130,67, 
           LINE 44,54,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-AT,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-AT-BUF,
            .

      * CHECK BOX
       10
           chk-ATa, 
           Check-Box, 
           COL 145,34, 
           LINE 44,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-ATa,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-ATa-BUF,
            .

      * LABEL
       10
           Form1-La-1, 
           Label, 
           COL 4,67, 
           LINE 8,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Descrizione",
           .

      * LABEL
       10
           Form1-La-2, 
           Label, 
           COL 4,67, 
           LINE 12,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sett. merceologico",
           .

      * LABEL
       10
           Form1-La-3, 
           Label, 
           COL 4,67, 
           LINE 14,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Marca",
           .

      * LABEL
       10
           Form1-La-4, 
           Label, 
           COL 4,67, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Classe 1",
           .

      * LABEL
       10
           Form1-La-6, 
           Label, 
           COL 76,67, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Classe 2",
           .

      * LABEL
       10
           Form1-La-7, 
           Label, 
           COL 4,67, 
           LINE 18,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Classe 3",
           .

      * LABEL
       10
           Form1-La-8, 
           Label, 
           COL 76,67, 
           LINE 18,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Classe 4",
           .

      * LABEL
       10
           Form1-La-9, 
           Label, 
           COL 4,67, 
           LINE 20,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 28,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Unità di misura",
           .

      * LABEL
       10
           Form1-La-10, 
           Label, 
           COL 4,34, 
           LINE 40,69,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 69,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. Fornitore",
           .

      * LABEL
       10
           Form1-La-12, 
           Label, 
           COL 113,67, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 70,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Peso UTF",
           .

      * LABEL
       10
           Form1-La-13, 
           Label, 
           COL 140,67, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 71,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Peso non UTF",
           .

      * LABEL
       10
           Form1-La-14, 
           Label, 
           COL 76,67, 
           LINE 20,46,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 72,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imballo standard",
           .

      * LABEL
       10
           Form1-La-16, 
           Label, 
           COL 4,67, 
           LINE 30,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 77,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prezzo acquisto",
           .

      * LABEL
       10
           Form1-La-17, 
           Label, 
           COL 41,67, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 78,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "% Sc. agente",
           .

      * LABEL
       10
           Form1-La-18, 
           Label, 
           COL 113,67, 
           LINE 30,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 79,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prezzo vendita",
           .

      * LABEL
       10
           Form1-La-19, 
           Label, 
           COL 76,67, 
           LINE 30,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 80,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "% Sc. acquisto",
           .

      * LABEL
       10
           Form1-La-21, 
           Label, 
           COL 4,67, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 81,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. doganale",
           .

      * LABEL
       10
           Form1-La-22, 
           Label, 
           COL 41,67, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 82,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "% Imposte",
           .

      * LABEL
       10
           Form1-La-11, 
           Label, 
           COL 76,67, 
           LINE 28,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 83,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Amperaggio",
           .

      * LABEL
       10
           Form1-La-24, 
           Label, 
           COL 4,34, 
           LINE 34,69,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 84,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN 1",
           .

      * LABEL
       10
           Form1-La-25, 
           Label, 
           COL 41,67, 
           LINE 34,69,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 85,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN 2",
           .

      * LABEL
       10
           Form1-La-26, 
           Label, 
           COL 76,67, 
           LINE 34,69,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 86,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN 3",
           .

      * LABEL
       10
           Form1-La-27, 
           Label, 
           COL 113,67, 
           LINE 34,69,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 87,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. EAN 4",
           .

      * LABEL
       10
           Form1-La-28, 
           Label, 
           COL 4,34, 
           LINE 36,69,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 88,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN 5",
           .

      * DB_LABEL
       10
           lab-setmerc, 
           Label, 
           COL 30,67, 
           LINE 12,46,
           LINES 1,31 ,
           SIZE 41,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 91,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-setmerc-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-marca, 
           Label, 
           COL 30,67, 
           LINE 14,46,
           LINES 1,31 ,
           SIZE 41,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 92,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-marca-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-31, 
           Label, 
           COL 82,67, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 4,00 ,
           FONT IS Small-Font,
           ID IS 93,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "UTF",
           .

      * LABEL
       10
           Form1-La-32, 
           Label, 
           COL 4,67, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 94,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sogg. imposte",
           .

      * LABEL
       10
           Form1-La-33, 
           Label, 
           COL 4,67, 
           LINE 28,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 98,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sogg. COBAT",
           .

      * LABEL
       10
           Form1-La-34, 
           Label, 
           COL 113,67, 
           LINE 28,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 99,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tipo COBAT",
           .

      * DB_LABEL
       10
           lab-classe, 
           Label, 
           COL 30,67, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 41,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 100,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-classe-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-udm, 
           Label, 
           COL 30,67, 
           LINE 20,46,
           LINES 1,31 ,
           SIZE 41,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 101,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-udm-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-35, 
           Label, 
           COL 144,67, 
           LINE 47,08,
           LINES 1,31 ,
           SIZE 5,00 ,
           FONT IS Small-Font,
           ID IS 102,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Stato",
           .

      * DB_LABEL
       10
           lab-dogana, 
           Label, 
           COL 40,67, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 104,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-dogana-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-8a, 
           Label, 
           COL 140,67, 
           LINE 20,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 105,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "U.d.m. per imballo",
           .

      * LABEL
       10
           Form1-La-22a, 
           Label, 
           COL 76,67, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 106,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "% C.O.U.",
           .

      * LABEL
       10
           lab-iva, 
           Label, 
           COL 100,34, 
           LINE 12,46,
           LINES 1,31 ,
           SIZE 67,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 107,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-iva-buf,
           .

      * LABEL
       10
           lab-imballo, 
           Label, 
           COL 100,67, 
           LINE 20,46,
           LINES 1,31 ,
           SIZE 39,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 108,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-imballo-buf,
           .

      * DB_LABEL
       10
           lab-forn, 
           Label, 
           COL 30,67, 
           LINE 40,69,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 109,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-forn-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-2a, 
           Label, 
           COL 76,67, 
           LINE 12,46,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 110,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice IVA",
           .

      * LABEL
       10
           Form1-La-22aa, 
           Label, 
           COL 113,67, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 111,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Scorta",
           .

      * LABEL
       10
           Form1-La-1a, 
           Label, 
           COL 106,67, 
           LINE 8,08,
           LINES 2,15 ,
           SIZE 10,33 ,
           FONT IS Small-Font,
           ID IS 118,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Descrizione alternativa",
           .

      * LABEL
       10
           Form1-La-32a, 
           Label, 
           COL 98,00, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 119,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "ALA",
           .

      * LABEL
       10
           Form1-La-33a, 
           Label, 
           COL 98,00, 
           LINE 40,54,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 120,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GDA",
           .

      * LABEL
       10
           Form1-La-32aa, 
           Label, 
           COL 98,00, 
           LINE 42,54,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 121,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "MV+ (gruppi)",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-33aa, 
           Label, 
           COL 115,50, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 122,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Agenti",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-18a, 
           Label, 
           COL 4,67, 
           LINE 32,08,
           LINES 2,00 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 123,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prezzo al banco (IVA compresa)",
           .

      * LABEL
       10
           Form1-La-28b, 
           Label, 
           COL 4,34, 
           LINE 38,69,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 124,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. art fornitore",
           .

      * LABEL
       10
           Form1-La-18aa, 
           Label, 
           COL 76,67, 
           LINE 32,46,
           LINES 2,00 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 126,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prz. min. vend. (IVA compresa)",
           .

      * LABEL
       10
           Form1-La-32aaa, 
           Label, 
           COL 115,50, 
           LINE 42,54,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 128,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Estero",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-33ab, 
           Label, 
           COL 136,00, 
           LINE 40,61,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 129,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GDS",
           VISIBLE 0,
           .

      * LABEL
       10
           lab-moq, 
           Label, 
           COL 140,67, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 130,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "MOQ",
           VISIBLE v-moq,
           .

      * LABEL
       10
           Form1-La-33aba, 
           Label, 
           COL 136,00, 
           LINE 38,61,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 131,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GDS/DO",
           .

      * LABEL
       10
           lab-reale, 
           Label, 
           COL 140,67, 
           LINE 28,46,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 132,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Peso Reale (Kg)",
           VISIBLE v-reale,
           .

      * LABEL
       10
           Form1-La-2aa, 
           Label, 
           COL 76,67, 
           LINE 14,46,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 133,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Magazzino STD",
           .

      * DB_LABEL
       10
           lab-mag, 
           Label, 
           COL 100,67, 
           LINE 14,46,
           LINES 1,31 ,
           SIZE 41,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 134,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-mag-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-2ab, 
           Label, 
           COL 4,67, 
           LINE 10,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 135,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice collegato",
           .

      * LABEL
       10
           Form1-La-10a, 
           Label, 
           COL 4,34, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 137,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Destino",
           .

      * DB_LABEL
       10
           lab-des-coll, 
           Label, 
           COL 30,67, 
           LINE 10,46,
           LINES 1,31 ,
           SIZE 112,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 667,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-des-coll-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-prodener, 
           Label, 
           COL 40,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 167,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-prodener-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-21a, 
           Label, 
           COL 4,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 168,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prod. Energetico",
           .

      * LABEL
       10
           Form1-La-12a, 
           Label, 
           COL 113,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 670,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tipo Stoccaggio",
           .

      * LABEL
       10
           Form1-La-12aa, 
           Label, 
           COL 132,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 671,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Confezionato",
           .

      * LABEL
       10
           Form1-La-12aaa, 
           Label, 
           COL 148,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 672,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sfuso",
           .

      * LABEL
       10
           Form1-La-33abb, 
           Label, 
           COL 136,00, 
           LINE 42,54,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 673,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "WEB",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-32aab, 
           Label, 
           COL 98,00, 
           LINE 44,54,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 674,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "SPI",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-32aaba, 
           Label, 
           COL 115,50, 
           LINE 44,54,
           LINES 1,31 ,
           SIZE 9,50 ,
           FONT IS Small-Font,
           ID IS 675,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Trade",
           .

      * LABEL
       10
           Form1-La-32aabaa, 
           Label, 
           COL 136,00, 
           LINE 44,54,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 676,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "TEXACO",
           .

      * LABEL
       10
           Form1-La-32aabaaa, 
           Label, 
           COL 151,84, 
           LINE 38,61,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 677,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "CEPSA",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-10aa, 
           Label, 
           COL 4,34, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 678,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note",
           .

      * LABEL
       10
           lab-realea, 
           Label, 
           COL 147,34, 
           LINE 30,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           FONT IS Small-Font,
           ID IS 679,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Litri",
           .

      * LABEL
       10
           Form1-La-18aaa, 
           Label, 
           COL 115,50, 
           LINE 40,23,
           LINES 2,00 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 680,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Esclusiva in concorrenza",
           .

      * DB_LABEL
       10
           lab-classe-2, 
           Label, 
           COL 100,67, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 41,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 681,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-classe-2-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-classe-4, 
           Label, 
           COL 100,67, 
           LINE 18,46,
           LINES 1,31 ,
           SIZE 41,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 682,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-classe-4-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-classe-3, 
           Label, 
           COL 30,67, 
           LINE 18,46,
           LINES 1,31 ,
           SIZE 41,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 683,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-classe-3-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-20, 
           Label, 
           COL 82,67, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           ID IS 172,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Novità",
           .

      * PAGE
       05
           Form1-Pg-2, 
           VISIBLE Form1-Pg-4-Visible,
           COL 3, 
           LINE 8,
           .

      * ENTRY FIELD
       10
           ef-note-agg, 
           Entry-Field, 
           COL 21,67, 
           LINE 10,46,
           LINES 1,31 ,
           SIZE 140,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-agg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 512,
           VALUE ef-note-agg-BUF,
           .

      * PUSH BUTTON
       10
           pb-note, 
           Push-Button, 
           COL 161,67, 
           LINE 10,46,
           LINES 1,31 ,
           SIZE 3,00 ,
           EXCEPTION-VALUE 1009,
           FONT IS Small-Font,
           ID IS 96,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-foto, 
           Entry-Field, 
           COL 21,67, 
           LINE 12,46,
           LINES 1,31 ,
           SIZE 140,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-foto,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 512,
           VALUE ef-foto-BUF,
           .

      * PUSH BUTTON
       10
           pb-foto, 
           Push-Button, 
           COL 161,67, 
           LINE 12,46,
           LINES 1,31 ,
           SIZE 3,00 ,
           EXCEPTION-VALUE 1003,
           FONT IS Small-Font,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-brand, 
           Entry-Field, 
           COL 21,67, 
           LINE 14,46,
           LINES 1,31 ,
           SIZE 140,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-brand,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 512,
           VALUE ef-brand-BUF,
           .

      * PUSH BUTTON
       10
           pb-brand, 
           Push-Button, 
           COL 161,67, 
           LINE 14,46,
           LINES 1,31 ,
           SIZE 3,00 ,
           EXCEPTION-VALUE 1013,
           FONT IS Small-Font,
           ID IS 11,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-scheda, 
           Entry-Field, 
           COL 21,67, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 140,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-scheda,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 512,
           VALUE ef-scheda-BUF,
           .

      * PUSH BUTTON
       10
           pb-scheda, 
           Push-Button, 
           COL 161,67, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 3,00 ,
           EXCEPTION-VALUE 1004,
           FONT IS Small-Font,
           ID IS 73,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-toss, 
           Entry-Field, 
           COL 21,67, 
           LINE 18,46,
           LINES 1,31 ,
           SIZE 140,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-toss,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 512,
           VALUE ef-toss-BUF,
           .

      * ENTRY FIELD
       10
           ef-des-ing, 
           Entry-Field, 
           COL 21,67, 
           LINE 20,77,
           LINES 1,31 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des-ing,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 60,
           VALUE ef-des-ing-BUF,
           BEFORE PROCEDURE ef-scheda-BeforeProcedure, 
           .

      * ENTRY FIELD
       10
           ef-des-spa, 
           Entry-Field, 
           COL 101,67, 
           LINE 20,77,
           LINES 1,31 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des-spa,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 60,
           VALUE ef-des-spa-BUF,
           BEFORE PROCEDURE ef-scheda-BeforeProcedure, 
           .

      * ENTRY FIELD
       10
           ef-altezza-pz, 
           Entry-Field, 
           COL 21,67, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-altezza-pz,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           VALUE ef-altezza-pz-BUF,
           .

      * ENTRY FIELD
       10
           ef-larghezza-pz, 
           Entry-Field, 
           COL 58,34, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-larghezza-pz,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           VALUE ef-larghezza-pz-BUF,
           .

      * ENTRY FIELD
       10
           ef-profondita-pz, 
           Entry-Field, 
           COL 88,67, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-profondita-pz,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           VALUE ef-profondita-pz-BUF,
           .

      * ENTRY FIELD
       10
           ef-qta-cartone, 
           Entry-Field, 
           COL 122,34, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-qta-cartone,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-qta-cartone-BUF,
           .

      * ENTRY FIELD
       10
           ef-qta-stda, 
           Entry-Field, 
           COL 151,67, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-qta-stda,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-qta-stda-BUF,
           .

      * ENTRY FIELD
       10
           ef-adr, 
           Entry-Field, 
           COL 21,67, 
           LINE 27,23,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-adr,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-adr-BUF,
           .

      * ENTRY FIELD
       10
           ef-peso-SHI, 
           Entry-Field, 
           COL 58,34, 
           LINE 27,23,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 62,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 10,
           VALUE ef-peso-SHI-BUF,
           .

      * ENTRY FIELD
       10
           ef-peso-GET, 
           Entry-Field, 
           COL 88,67, 
           LINE 27,23,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-peso-GET,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 10,
           VALUE ef-peso-GET-BUF,
           .

      * ENTRY FIELD
       10
           ef-altezza, 
           Entry-Field, 
           COL 21,67, 
           LINE 31,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-altezza,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           VALUE ef-altezza-BUF,
           .

      * ENTRY FIELD
       10
           ef-larghezza, 
           Entry-Field, 
           COL 54,67, 
           LINE 31,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-larghezza,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           VALUE ef-larghezza-BUF,
           .

      * ENTRY FIELD
       10
           ef-profondita, 
           Entry-Field, 
           COL 88,67, 
           LINE 31,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-profondita,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           VALUE ef-profondita-BUF,
           .

      * ENTRY FIELD
       10
           ef-qta-epal, 
           Entry-Field, 
           COL 21,67, 
           LINE 33,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-qta-epal,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-qta-epal-BUF,
           .

      * ENTRY FIELD
       10
           ef-qta-std, 
           Entry-Field, 
           COL 54,67, 
           LINE 33,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-qta-std,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-qta-std-BUF,
           .

      * CHECK BOX
       10
           chk-T1, 
           Check-Box, 
           COL 9,00, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-T1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-T1-BUF,
            .

      * CHECK BOX
       10
           chk-T2, 
           Check-Box, 
           COL 19,17, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-T2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-cobat",
           VALUE chk-T2-BUF,
            .

      * CHECK BOX
       10
           chk-T3, 
           Check-Box, 
           COL 30,17, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-T3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-T3-BUF,
            .

      * PUSH BUTTON
       10
           pb-toss, 
           Push-Button, 
           COL 161,67, 
           LINE 18,46,
           LINES 1,31 ,
           SIZE 3,00 ,
           EXCEPTION-VALUE 1012,
           FONT IS Small-Font,
           ID IS 140,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * LABEL
       10
           Form1-La-23aa, 
           Label, 
           COL 4,34, 
           LINE 10,46,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 141,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note aggiuntive",
           .

      * LABEL
       10
           Form1-La-29b, 
           Label, 
           COL 4,34, 
           LINE 12,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 142,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Foto",
           .

      * LABEL
       10
           Form1-La-30b, 
           Label, 
           COL 4,34, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 143,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Scheda tecnica",
           .

      * LABEL
       10
           Form1-La-30aa, 
           Label, 
           COL 4,34, 
           LINE 18,15,
           LINES 2,00 ,
           SIZE 16,00 ,
           FONT IS Small-Font,
           ID IS 144,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Scheda tossicologica",
           .

      * LABEL
       10
           Form1-La-29aa, 
           Label, 
           COL 4,34, 
           LINE 14,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 145,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Logo Brand",
           .

      * LABEL
       10
           Form1-La-28ada, 
           Label, 
           COL 4,34, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 146,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Altezza pezzo (cm)",
           .

      * LABEL
       10
           Form1-La-28aaaa, 
           Label, 
           COL 39,34, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 16,00 ,
           FONT IS Small-Font,
           ID IS 147,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Largh. pezzo (cm)",
           .

      * LABEL
       10
           Form1-La-28abaa, 
           Label, 
           COL 72,84, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 148,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prof. pezzo (cm)",
           .

      * LABEL
       10
           Form1-La-28acba, 
           Label, 
           COL 105,67, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 149,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Conf. per Cartone",
           .

      * LABEL
       10
           Form1-La-28acaaa, 
           Label, 
           COL 137,34, 
           LINE 25,23,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 150,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cartoni per UDC",
           .

      * LABEL
       10
           Form1-La-28abb, 
           Label, 
           COL 72,84, 
           LINE 31,69,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 151,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prof. bancale (cm)",
           .

      * LABEL
       10
           Form1-La-28aab, 
           Label, 
           COL 37,67, 
           LINE 31,69,
           LINES 1,31 ,
           SIZE 16,00 ,
           FONT IS Small-Font,
           ID IS 152,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Largh. bancale (cm)",
           .

      * LABEL
       10
           Form1-La-28ae, 
           Label, 
           COL 4,34, 
           LINE 31,69,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 153,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Altezza bancale (cm)",
           .

      * LABEL
       10
           Form1-La-28acc, 
           Label, 
           COL 4,34, 
           LINE 33,69,
           LINES 1,31 ,
           SIZE 16,00 ,
           FONT IS Small-Font,
           ID IS 154,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Q.ta bancale EPAL",
           .

      * LABEL
       10
           Form1-La-28acab, 
           Label, 
           COL 37,67, 
           LINE 33,69,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 155,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Q.ta bancale STD",
           .

      * LABEL
       10
           Form1-La-28baa, 
           Label, 
           COL 4,34, 
           LINE 27,23,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 685,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Pericolosità ADR",
           .

      * LABEL
       10
           Form1-La-5aaacba, 
           Label, 
           COL 3,84, 
           LINE 8,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 686,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Dati Aggiuntivi",
           .

      * BAR
       10
           Form1-Br-2aba, 
           Bar,
           COL 21,34, 
           LINE 9,16,
           SIZE 146,00 ,
           ID IS 687,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           Form1-La-5aaacbaa, 
           Label, 
           COL 3,84, 
           LINE 23,23,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 156,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Dimensioni varie",
           .

      * BAR
       10
           Form1-Br-2abaa, 
           Bar,
           COL 21,34, 
           LINE 23,92,
           SIZE 146,00 ,
           ID IS 157,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           Form1-La-5aaacbaaa, 
           Label, 
           COL 3,84, 
           LINE 29,69,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 158,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Dimensioni",
           .

      * BAR
       10
           Form1-Br-2abaaa, 
           Bar,
           COL 21,34, 
           LINE 30,38,
           SIZE 146,00 ,
           ID IS 159,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           Form1-La-28aaaaa, 
           Label, 
           COL 43,34, 
           LINE 27,23,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 160,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Peso SHI  (Kg)",
           .

      * LABEL
       10
           Form1-La-32ac, 
           Label, 
           COL 5,00, 
           LINE 37,00,
           LINES 1,31 ,
           SIZE 3,00 ,
           FONT IS Small-Font,
           ID IS 161,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "T1",
           .

      * LABEL
       10
           Form1-La-33ac, 
           Label, 
           COL 15,17, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           FONT IS Small-Font,
           ID IS 162,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "T2",
           .

      * LABEL
       10
           Form1-La-32aac, 
           Label, 
           COL 26,17, 
           LINE 38,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           FONT IS Small-Font,
           ID IS 163,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "T3",
           .

      * LABEL
       10
           Form1-La-5aaacbaaaa, 
           Label, 
           COL 3,84, 
           LINE 36,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 164,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Flag",
           .

      * BAR
       10
           Form1-Br-2abaaaa, 
           Bar,
           COL 21,34, 
           LINE 37,15,
           SIZE 146,00 ,
           ID IS 165,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           Form1-La-28aaaaaa, 
           Label, 
           COL 72,84, 
           LINE 27,23,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 169,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Peso GET  (Kg)",
           .

      * LABEL
       10
           Form1-La-30aaa, 
           Label, 
           COL 4,34, 
           LINE 20,77,
           LINES 1,31 ,
           SIZE 16,00 ,
           FONT IS Small-Font,
           ID IS 173,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Descrizione inglese",
           .

      * LABEL
       10
           Form1-La-30aaaa, 
           Label, 
           COL 83,50, 
           LINE 20,77,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 174,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Descrizione spagnolo",
           .

      * PAGE
       05
           PAGE-2, 
           VISIBLE Form1-Pg-2-Visible,
           COL 3, 
           LINE 8,
           .

      * ENTRY FIELD
       10
           ef-peso-utf-prg, 
           Entry-Field, 
           COL 19,67, 
           LINE 10,84,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           NUMERIC,
           READ-ONLY,
           VALUE ef-peso-utf-prg-BUF,
           .
      * ENTRY FIELD
       10
           ef-peso-non-utf-prg, 
           Entry-Field, 
           COL 60,34, 
           LINE 10,84,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           NUMERIC,
           READ-ONLY,
           VALUE ef-peso-non-utf-prg-BUF,
           .
      * ENTRY FIELD
       10
           EF-COSTO-ULTIMO, 
           Entry-Field, 
           COL 19,67, 
           LINE 15,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           NUMERIC,
           READ-ONLY,
           VALUE EF-COSTO-ULTIMO-BUF,
           .
      * ENTRY FIELD
       10
           EF-COSTO-MEDIO, 
           Entry-Field, 
           COL 60,34, 
           LINE 15,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           NUMERIC,
           READ-ONLY,
           VALUE EF-COSTO-MEDIO-BUF,
           .
      * ENTRY FIELD
       10
           EF-COSTO-MP, 
           Entry-Field, 
           COL 100,67, 
           LINE 15,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 16,
           NUMERIC,
           READ-ONLY,
           VALUE EF-COSTO-MP-BUF,
           .
      * ENTRY FIELD
       10
           EF-GIACENZA, 
           Entry-Field, 
           COL 19,67, 
           LINE 17,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-GIACENZA-BUF,
           .
      * ENTRY FIELD
       10
           EF-ORD-CLI, 
           Entry-Field, 
           COL 60,34, 
           LINE 17,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-ORD-CLI-BUF,
           .
      * ENTRY FIELD
       10
           ef-giac-buona, 
           Entry-Field, 
           COL 100,67, 
           LINE 17,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE ef-giac-buona-BUF,
           .
      * ENTRY FIELD
       10
           EF-ORD-FORN, 
           Entry-Field, 
           COL 19,67, 
           LINE 20,96,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-ORD-FORN-BUF,
           .
      * ENTRY FIELD
       10
           EF-ORD-FORNa, 
           Entry-Field, 
           COL 40,00, 
           LINE 21,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-EF-ORD-FORNa,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-ORD-FORNa-BUF,
           .
      * ENTRY FIELD
       10
           EF-ORD-FORNb, 
           Entry-Field, 
           COL 60,34, 
           LINE 21,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-EF-ORD-FORNb,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-ORD-FORNb-BUF,
           .
      * ENTRY FIELD
       10
           EF-ORD-FORNc, 
           Entry-Field, 
           COL 80,67, 
           LINE 21,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-EF-ORD-FORNc,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-ORD-FORNc-BUF,
           .
      * ENTRY FIELD
       10
           EF-ORD-FORNca, 
           Entry-Field, 
           COL 100,67, 
           LINE 21,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-ORD-FORNca-BUF,
           .
      * ENTRY FIELD
       10
           EF-ORD-FORNcb, 
           Entry-Field, 
           COL 120,67, 
           LINE 21,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-ORD-FORNcb-BUF,
           .
      * ENTRY FIELD
       10
           EF-INI-UDM, 
           Entry-Field, 
           COL 19,67, 
           LINE 27,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-INI-UDM-BUF,
           .
      * ENTRY FIELD
       10
           EF-INI-KG, 
           Entry-Field, 
           COL 60,34, 
           LINE 27,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           READ-ONLY,
           VALUE EF-INI-KG-BUF,
           .
      * ENTRY FIELD
       10
           EF-INI-VALORE, 
           Entry-Field, 
           COL 100,67, 
           LINE 27,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           READ-ONLY,
           VALUE EF-INI-VALORE-BUF,
           .
      * ENTRY FIELD
       10
           EF-ACQ-UDM, 
           Entry-Field, 
           COL 19,67, 
           LINE 29,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-ACQ-UDM-BUF,
           .
      * ENTRY FIELD
       10
           EF-ACQ-KG, 
           Entry-Field, 
           COL 60,34, 
           LINE 29,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           READ-ONLY,
           VALUE EF-ACQ-KG-BUF,
           .
      * ENTRY FIELD
       10
           EF-ACQ-VALORE, 
           Entry-Field, 
           COL 100,67, 
           LINE 29,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           READ-ONLY,
           VALUE EF-ACQ-VALORE-BUF,
           .
      * ENTRY FIELD
       10
           EF-VEN-UDM, 
           Entry-Field, 
           COL 19,67, 
           LINE 31,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-VEN-UDM-BUF,
           .
      * ENTRY FIELD
       10
           EF-VEN-KG, 
           Entry-Field, 
           COL 60,34, 
           LINE 31,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           READ-ONLY,
           VALUE EF-VEN-KG-BUF,
           .
      * ENTRY FIELD
       10
           EF-VEN-VALORE, 
           Entry-Field, 
           COL 100,67, 
           LINE 31,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           READ-ONLY,
           VALUE EF-VEN-VALORE-BUF,
           .
      * ENTRY FIELD
       10
           EF-VAR-UDM, 
           Entry-Field, 
           COL 19,67, 
           LINE 33,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-VAR-UDM-BUF,
           .
      * ENTRY FIELD
       10
           EF-VAR-KG, 
           Entry-Field, 
           COL 60,34, 
           LINE 33,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           READ-ONLY,
           VALUE EF-VAR-KG-BUF,
           .
      * ENTRY FIELD
       10
           EF-VAR-VALORE, 
           Entry-Field, 
           COL 100,67, 
           LINE 33,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           READ-ONLY,
           VALUE EF-VAR-VALORE-BUF,
           .
      * ENTRY FIELD
       10
           EF-FORN-UDM, 
           Entry-Field, 
           COL 19,67, 
           LINE 35,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-FORN-UDM-BUF,
           .
      * ENTRY FIELD
       10
           EF-FORN-KG, 
           Entry-Field, 
           COL 60,34, 
           LINE 35,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           READ-ONLY,
           VALUE EF-FORN-KG-BUF,
           .
      * ENTRY FIELD
       10
           EF-FORN-VALORE, 
           Entry-Field, 
           COL 100,67, 
           LINE 35,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           READ-ONLY,
           VALUE EF-FORN-VALORE-BUF,
           .
      * ENTRY FIELD
       10
           EF-CLI-UDM, 
           Entry-Field, 
           COL 19,67, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-CLI-UDM-BUF,
           .
      * ENTRY FIELD
       10
           EF-CLI-KG, 
           Entry-Field, 
           COL 60,34, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           READ-ONLY,
           VALUE EF-CLI-KG-BUF,
           .
      * ENTRY FIELD
       10
           EF-CLI-VALORE, 
           Entry-Field, 
           COL 100,67, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           READ-ONLY,
           VALUE EF-CLI-VALORE-BUF,
           .
      * ENTRY FIELD
       10
           EF-FORN-UDMa, 
           Entry-Field, 
           COL 19,67, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-FORN-UDMa-BUF,
           .
      * ENTRY FIELD
       10
           EF-FORN-KGa, 
           Entry-Field, 
           COL 60,34, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           READ-ONLY,
           VALUE EF-FORN-KGa-BUF,
           .
      * ENTRY FIELD
       10
           EF-FORN-VALOREa, 
           Entry-Field, 
           COL 100,67, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           READ-ONLY,
           VALUE EF-FORN-VALOREa-BUF,
           .
      * ENTRY FIELD
       10
           EF-CLI-UDMa, 
           Entry-Field, 
           COL 19,67, 
           LINE 41,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE EF-CLI-UDMa-BUF,
           .
      * ENTRY FIELD
       10
           EF-CLI-KGa, 
           Entry-Field, 
           COL 60,34, 
           LINE 41,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           READ-ONLY,
           VALUE EF-CLI-KGa-BUF,
           .
      * ENTRY FIELD
       10
           EF-CLI-VALOREa, 
           Entry-Field, 
           COL 100,67, 
           LINE 41,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           READ-ONLY,
           VALUE EF-CLI-VALOREa-BUF,
           .
      * BAR
       10
           Form1-Br-2a, 
           Bar,
           COL 21,34, 
           LINE 13,54,
           SIZE 146,00 ,
           ID IS 175,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           Form1-La-5aaaa, 
           Label, 
           COL 4,17, 
           LINE 15,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           COLOR IS 2,
           ID IS 176,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Costo Ultimo",
           .

      * ENTRY FIELD
       10
           ef-gia-udm, 
           Entry-Field, 
           COL 19,67, 
           LINE 43,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 9,
           NUMERIC,
           READ-ONLY,
           VALUE ef-gia-udm-BUF,
           .
      * ENTRY FIELD
       10
           ef-gia-kg, 
           Entry-Field, 
           COL 60,34, 
           LINE 43,31,
           LINES 1,31 ,
           SIZE 17,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           READ-ONLY,
           VALUE ef-gia-kg-BUF,
           .
      * LABEL
       10
           Form1-La-5aaab, 
           Label, 
           COL 40,00, 
           LINE 15,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 177,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Costo Inizio Anno",
           .

      * LABEL
       10
           Form1-La-5aaabaa, 
           Label, 
           COL 4,17, 
           LINE 17,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           COLOR IS 2,
           ID IS 178,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Giacenza",
           .

      * LABEL
       10
           Form1-La-5aaabab, 
           Label, 
           COL 40,00, 
           LINE 17,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 179,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Impegnato",
           .

      * LABEL
       10
           Form1-La-5aaabaaaa, 
           Label, 
           COL 4,17, 
           LINE 20,96,
           LINES 1,31 ,
           SIZE 7,00 ,
           COLOR IS 2,
           ID IS 180,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Ordinato",
           .

      * LABEL
       10
           Form1-La-5aaabaaab, 
           Label, 
           COL 4,17, 
           LINE 27,31,
           LINES 1,31 ,
           SIZE 13,00 ,
           COLOR IS 2,
           ID IS 181,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Giacenze iniziali",
           .

      * LABEL
       10
           Form1-La-5aaac, 
           Label, 
           COL 3,84, 
           LINE 13,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 182,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Valori Dinamici",
           .

      * LABEL
       10
           Form1-La-5aaaca, 
           Label, 
           COL 3,84, 
           LINE 23,61,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 688,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Valori Consolidati",
           .

      * BAR
       10
           Form1-Br-2aa, 
           Bar,
           COL 21,34, 
           LINE 24,15,
           SIZE 146,00 ,
           ID IS 689,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           Form1-La-5aaabaaabb, 
           Label, 
           COL 4,17, 
           LINE 29,31,
           LINES 1,31 ,
           SIZE 12,00 ,
           COLOR IS 2,
           ID IS 690,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Acquisti",
           .

      * LABEL
       10
           Form1-La-5aaabaaabba, 
           Label, 
           COL 4,17, 
           LINE 31,31,
           LINES 1,31 ,
           SIZE 12,00 ,
           COLOR IS 2,
           ID IS 691,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Vendite",
           .

      * LABEL
       10
           Form1-La-5aaabaaabbaa, 
           Label, 
           COL 4,17, 
           LINE 33,31,
           LINES 1,31 ,
           SIZE 13,00 ,
           COLOR IS 2,
           ID IS 692,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Var. Inventariali",
           .

      * LABEL
       10
           Form1-La-5aaabaaabbab, 
           Label, 
           COL 4,17, 
           LINE 35,31,
           LINES 1,31 ,
           SIZE 14,00 ,
           COLOR IS 2,
           ID IS 693,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Resi a Fornitori",
           .

      * LABEL
       10
           Form1-La-5aaabaaabbaba, 
           Label, 
           COL 4,17, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 14,00 ,
           COLOR IS 2,
           ID IS 694,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Resi da Clienti",
           .

      * LABEL
       10
           Form1-La-5aaabaaaba, 
           Label, 
           COL 19,67, 
           LINE 25,31,
           LINES 1,00 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 695,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "U.M.",
           .

      * LABEL
       10
           Form1-La-5aaabaaabaa, 
           Label, 
           COL 60,34, 
           LINE 25,31,
           LINES 1,00 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 696,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "KG.",
           .

      * LABEL
       10
           Form1-La-5aaabaaabab, 
           Label, 
           COL 100,67, 
           LINE 25,31,
           LINES 1,00 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 697,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Valore",
           .

      * LABEL
       10
           Form1-La-5aaabaaabbabb, 
           Label, 
           COL 4,17, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 14,00 ,
           COLOR IS 2,
           ID IS 698,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Entrate Passaggi",
           .

      * LABEL
       10
           Form1-La-5aaabaaabbabaa, 
           Label, 
           COL 4,17, 
           LINE 41,31,
           LINES 1,31 ,
           SIZE 14,00 ,
           COLOR IS 2,
           ID IS 699,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Uscite Passaggi",
           .

      * LABEL
       10
           Form1-La-5aaabaaabbac, 
           Label, 
           COL 4,17, 
           LINE 43,31,
           LINES 1,31 ,
           SIZE 14,00 ,
           COLOR IS 2,
           ID IS 700,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Giacenza Periodo",
           .

      * LABEL
       10
           Form1-La-5aaabb, 
           Label, 
           COL 40,00, 
           LINE 10,84,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 701,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Peso non UTF",
           .

      * LABEL
       10
           Form1-La-5aaaaa, 
           Label, 
           COL 4,17, 
           LINE 10,84,
           LINES 1,31 ,
           SIZE 12,00 ,
           COLOR IS 2,
           ID IS 702,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Peso UTF",
           .

      * LABEL
       10
           Form1-La-5aaacb, 
           Label, 
           COL 3,84, 
           LINE 8,38,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 703,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Peso",
           .

      * BAR
       10
           Form1-Br-2ab, 
           Bar,
           COL 21,34, 
           LINE 8,92,
           SIZE 146,00 ,
           ID IS 704,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           Form1-La-5aaaba, 
           Label, 
           COL 80,67, 
           LINE 15,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 5,
           ID IS 705,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Costo MP (padre)",
           .

      * LABEL
       10
           Form1-La-15, 
           Label, 
           COL 136,00, 
           LINE 45,38,
           LINES 1,15 ,
           SIZE 30,67 ,
           COLOR IS 2,
           FONT IS Verdana12-Occidentale,
           ID IS 706,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "PROGRESSIVO PADRE",
           .

      * LABEL
       10
           Form1-La-5aaabaaaaa, 
           Label, 
           COL 19,67, 
           LINE 19,54,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 183,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Mese 1",
           .

      * LABEL
       10
           Form1-La-5aaabaaaaaa, 
           Label, 
           COL 40,00, 
           LINE 19,54,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 184,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Mese 2",
           .

      * LABEL
       10
           Form1-La-5aaabaaaaab, 
           Label, 
           COL 60,34, 
           LINE 19,54,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 185,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Mese 3",
           .

      * LABEL
       10
           Form1-La-5aaabaaaaac, 
           Label, 
           COL 80,67, 
           LINE 19,54,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 186,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Mese 4",
           .

      * LABEL
       10
           Form1-La-5aaabaaaaaca, 
           Label, 
           COL 100,67, 
           LINE 19,54,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 187,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Mese 5",
           .

      * LABEL
       10
           Form1-La-5aaabaaaaacb, 
           Label, 
           COL 120,67, 
           LINE 19,54,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 188,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Mese 6",
           .

      * LABEL
       10
           Form1-La-5aaababa, 
           Label, 
           COL 80,67, 
           LINE 17,38,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 2,
           ID IS 189,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Giacenza buona",
           .

      * PAGE
       05
           Form1-Pg-1, 
           VISIBLE Form1-Pg-3-Visible,
           COL 3, 
           LINE 8,
           .

      * ENTRY FIELD
       10
           ef-dt-val-da, 
           Entry-Field, 
           COL 14,67, 
           LINE 9,46,
           LINES 1,31 ,
           SIZE 14,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ID IS 78-ID-ef-dt-val-da,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 30,
           NUMERIC,
           VALUE ef-dt-val-da-BUF,
           .

      * ENTRY FIELD
       10
           ef-dt-val-a, 
           Entry-Field, 
           COL 33,67, 
           LINE 9,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ID IS 78-ID-ef-dt-val-a,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 30,
           NUMERIC,
           VALUE ef-dt-val-a-BUF,
           .

      * GRID
       10
           gd-list, 
           Grid, 
           COL 4,67, 
           LINE 11,46,
           LINES 35,00 ,
           SIZE 160,00 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           COLOR IS 176,
           DATA-COLUMNS (1, 2, 7, 107, 117, 127, 147, 159),
           ALIGNMENT ("C", "R", "L", "C", "C", "L", "R", "R"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("X", "9(5)", "x(30)", "9(8)", "9(8)", "x(20)", "9
      -    "(6)v9999", "9(6)v9(4)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           HSCROLL,
           ID IS 190,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ROW-HEADINGS,
           TILED-HEADINGS,
           USE-TAB,
           VIRTUAL-WIDTH 156,
           VPADDING 50,
           VSCROLL,
           EVENT PROCEDURE gd-righe-Event-Proc,
           .

      * LABEL
       10
           Form1-La-5aaabba, 
           Label, 
           COL 29,67, 
           LINE 9,46,
           LINES 1,31 ,
           SIZE 3,00 ,
           COLOR IS 2,
           ID IS 191,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "al",
           .

      * LABEL
       10
           Form1-La-5aaaaaa, 
           Label, 
           COL 4,67, 
           LINE 9,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           COLOR IS 2,
           ID IS 193,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Validità: dal",
           .

      * BAR
       05
           Form1-Br-2, 
           Bar,
           COL 1,00, 
           LINE 4,08,
           SIZE 168,33 ,
           ID IS 194,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8),
           SHADING (-1),
           WIDTH 1,
           .

      * LABEL
       05
           CST-BLOCKPGM, 
           Label, 
           COL 4,67, 
           LINE 4,31,
           LINES 1,00 ,
           SIZE 3,00 ,
           ID IS 999,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Form1-La-5, 
           Label, 
           COL 2,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 9,67 ,
           ID IS 5003,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Codice",
           .

      * LABEL
       05
           Form1-Custom1-1, 
           Label, 
           COL 67,67, 
           LINE 4,77,
           LINES 0,62 ,
           SIZE 12,33 ,
           FONT IS Default-Font,
           ID IS 666,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * PUSH BUTTON
       05
           pb-frn, 
           Push-Button, 
           COL 76,83, 
           LINE 4,54,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE frn-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1015,
           FLAT,
           ID IS 1761,
           SELF-ACT,
           AFTER PROCEDURE pb-frn-AfterProcedure, 
           BEFORE PROCEDURE pb-frn-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-distinta, 
           Push-Button, 
           COL 89,67, 
           LINE 4,54,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE DISTINTA-BMP,
           UNFRAMED,
           SQUARE,
           ENABLED e-distinta,
           EXCEPTION-VALUE 1008,
           FLAT,
           ID IS 1762,
           BITMAP-NUMBER = BitmapNumDistinta
           AFTER PROCEDURE pb-distinta-AfterProcedure, 
           BEFORE PROCEDURE pb-distinta-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-codici, 
           Push-Button, 
           COL 102,67, 
           LINE 4,54,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE ALTERNATIVI-BMP,
           UNFRAMED,
           SQUARE,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1005,
           FLAT,
           ID IS 1763,
           SELF-ACT,
           BITMAP-NUMBER=NumBitmapCodici
           AFTER PROCEDURE pb-codici-AfterProcedure, 
           BEFORE PROCEDURE pb-codici-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-lista, 
           Push-Button, 
           COL 115,83, 
           LINE 4,54,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE LISTA-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1014,
           FLAT,
           ID IS 1764,
           AFTER PROCEDURE pb-lista-AfterProcedure, 
           BEFORE PROCEDURE pb-lista-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-dettagli, 
           Push-Button, 
           COL 129,00, 
           LINE 4,54,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE DETTAGLI-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1007,
           FLAT,
           ID IS 1765,
           AFTER PROCEDURE pb-dettagli-AfterProcedure, 
           BEFORE PROCEDURE pb-dettagli-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-stampa, 
           Push-Button, 
           COL 142,00, 
           LINE 4,54,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-STAMPA-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1010,
           FLAT,
           ID IS 760,
           SELF-ACT,
           AFTER PROCEDURE pb-stampa-AfterProcedure, 
           BEFORE PROCEDURE pb-stampa-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-ean, 
           Push-Button, 
           COL 155,00, 
           LINE 4,54,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE EAN-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1011,
           FLAT,
           ID IS 761,
           SELF-ACT,
           AFTER PROCEDURE pb-ean-AfterProcedure, 
           BEFORE PROCEDURE pb-ean-BeforeProcedure, 
           .

      * LABEL
       05
           lab-des, 
           Label, 
           COL 25,33, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 113,83 ,
           COLOR IS 5,
           ID IS 762,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-des-buf,
           .

      * PUSH BUTTON
       05
           pb-copiada, 
           Push-Button, 
           COL 151,33, 
           LINE 1,15,
           LINES 30,00 ,
           SIZE 99,00 ,
           BITMAP-HANDLE COPIA-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1357,
           FLAT,
           ID IS 763,
           SELF-ACT,
           VISIBLE v-copiada,
           AFTER PROCEDURE pb-copiada-AfterProcedure, 
           BEFORE PROCEDURE pb-copiada-BeforeProcedure, 
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 5005,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 6,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 2,
           FRAMED,
           SQUARE,
           ENABLED E-NUOVO,
           EXCEPTION-VALUE 2,
           FLAT,
           ID IS 5006,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 16,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-CANCELLA,
           EXCEPTION-VALUE 4,
           FLAT,
           ID IS 5007,
           SELF-ACT,
           TITLE "Cancella (F4)",
           BITMAP-NUMBER BitmapNumDelete
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 11,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 5008,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 26,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-ANTEPRIMA,
           EXCEPTION-VALUE 6,
           FLAT,
           ID IS 5009,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           BITMAP-NUMBER BitmapNumPreview
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 21,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 5,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 5010,
           SELF-ACT,
           TITLE "Modifica (F5)",
           VALUE MOD,
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 31,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-STAMPA,
           EXCEPTION-VALUE 7,
           FLAT,
           ID IS 5011,
           SELF-ACT,
           TITLE "Stampa (F7)",
           BITMAP-NUMBER BitmapNumPrint
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 36,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 5012,
           SELF-ACT,
           TITLE "Cerca (F8)",
           BITMAP-NUMBER BitmapNumZoom
           .

      * PUSH BUTTON
       05
           TOOL-SELEZIONA, 
           Push-Button, 
           COL 41,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 9,
           FRAMED,
           SQUARE,
           ENABLED E-SELEZIONA,
           EXCEPTION-VALUE 9,
           FLAT,
           ID IS 5013,
           SELF-ACT,
           TITLE "Seleziona (F9)",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1a, 
           Push-Button, 
           COL 46,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 10,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1002,
           FLAT,
           ID IS 5014,
           SELF-ACT,
           TITLE "&Primo",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1b, 
           Push-Button, 
           COL 51,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 11,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 67,
           FLAT,
           ID IS 5015,
           SELF-ACT,
           TITLE "Precedente (PgDn)",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1c, 
           Push-Button, 
           COL 56,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 12,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 68,
           FLAT,
           ID IS 5016,
           SELF-ACT,
           TITLE "Successivo (PgUp)",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1d, 
           Push-Button, 
           COL 61,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 13,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1006,
           FLAT,
           ID IS 5017,
           SELF-ACT,
           TITLE "&Ultimo",
           .

      * CHECK BOX
       05
           TOOL-ORD, 
           Check-Box, 
           COL 66,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 14,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 10
           FLAT,
           ID IS 5018,
           SELF-ACT,
           TITLE "Ordinamento Alfabetico (F10)",
           VALUE OrderBy,
           AFTER PROCEDURE TOOL-ORD-AfterProcedure,
           BEFORE PROCEDURE TOOL-ORD-BeforeProcedure, 
           .
      * FORM
       01 
           form-ean, 
           BEFORE PROCEDURE form-ean-BeforeProcedure,
           AFTER PROCEDURE  form-ean-AFTER-SCREEN
           .

      * FRAME
       05
           frame-limiti, 
           Frame, 
           COL 1,60, 
           LINE 1,00,
           LINES 5,00 ,
           SIZE 28,60 ,
           ID IS 9,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE-POSITION 2,
           .

      * ENTRY FIELD
       05
           ef-ean, 
           Entry-Field, 
           COL 13,60, 
           LINE 3,00,
           LINES 1,33 ,
           SIZE 15,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ID IS 78-ID-ef-ean,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-buf,
           AFTER PROCEDURE ef-gdo-AfterProcedure, 
           .

      * LABEL
       05
           Screen3-La-1aa, 
           Label, 
           COL 2,60, 
           LINE 3,00,
           LINES 1,17 ,
           SIZE 10,00 ,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN",
           .

      * LABEL
       05
           Screen1-Custom1-1, 
           Label, 
           COL 6,40, 
           LINE 4,44,
           LINES 1,00 ,
           SIZE 1,00 ,
           FONT IS Default-Font,
           ID IS 1,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * FRAME
       05
           Screen4-Fr-1, 
           Frame, 
           COL 1,00, 
           LINE 6,00,
           LINES 2,83 ,
           SIZE 29,80 ,
           ID IS 29,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           .

      * PUSH BUTTON
       05
           pb-ok, 
           Push-Button, 
           COL 14,80, 
           LINE 6,69,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-OK-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 13,
           FLAT,
           ID IS 200,
           AFTER PROCEDURE pb-ok-AfterProcedure, 
           BEFORE PROCEDURE pb-ok-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-annulla, 
           Push-Button, 
           COL 22,60, 
           LINE 6,69,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-CANCEL-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 201,
           SELF-ACT,
           ESCAPE-BUTTON,
           AFTER PROCEDURE pb-annulla-AfterProcedure, 
           BEFORE PROCEDURE pb-annulla-BeforeProcedure, 
           .

      * FORM
       01 
           form3, 
           AFTER PROCEDURE  form3-AFTER-SCREEN
           BEFORE PROCEDURE  form3-BEFORE-SCREEN
           .

      * LABEL
       05
           form3-La-1, 
           Label, 
           COL 1,00, 
           LINE 2,00,
           LINES 2,00 ,
           SIZE 60,00 ,
           FONT IS Verdana12BI-Occidentale,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Aggiornamento catene articoli in corso...",
           .

      * FORM
       01 
           form-frn, 
           BEFORE PROCEDURE form-frn-BeforeProcedure,
           AFTER PROCEDURE  form-frn-AFTER-SCREEN
           .

      * FRAME
       05
           frame-limitia, 
           Frame, 
           COL 1,60, 
           LINE 1,00,
           LINES 5,00 ,
           SIZE 33,60 ,
           ID IS 9,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE-POSITION 2,
           .

      * ENTRY FIELD
       05
           ef-frn, 
           Entry-Field, 
           COL 16,40, 
           LINE 3,00,
           LINES 1,33 ,
           SIZE 17,70 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-ef-frn,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-frn-buf,
           AFTER PROCEDURE ef-gdo-AfterProcedure, 
           .

      * LABEL
       05
           Screen3-La-1aaa, 
           Label, 
           COL 2,60, 
           LINE 3,00,
           LINES 1,17 ,
           SIZE 12,00 ,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. Fornitore",
           .

      * LABEL
       05
           Screen1-Custom1-1a, 
           Label, 
           COL 6,40, 
           LINE 4,44,
           LINES 1,00 ,
           SIZE 1,00 ,
           FONT IS Default-Font,
           ID IS 1,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * FRAME
       05
           Screen4-Fr-1a, 
           Frame, 
           COL 1,00, 
           LINE 6,00,
           LINES 2,83 ,
           SIZE 34,90 ,
           ID IS 29,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           .

      * PUSH BUTTON
       05
           pb-oka, 
           Push-Button, 
           COL 19,80, 
           LINE 6,69,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-OK-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1000,
           FLAT,
           ID IS 200,
           AFTER PROCEDURE pb-oka-AfterProcedure, 
           BEFORE PROCEDURE pb-oka-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-annullaa, 
           Push-Button, 
           COL 27,60, 
           LINE 6,69,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-CANCEL-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 201,
           SELF-ACT,
           ESCAPE-BUTTON,
           AFTER PROCEDURE pb-annullaa-AfterProcedure, 
           BEFORE PROCEDURE pb-annullaa-BeforeProcedure, 
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, USER-CODI, LIVELLO-ABIL.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:garticoli, INIT:garticoli, BeforeDeclarative>
       ARTICOLI-ERR SECTION.
           use after error procedure on articoli.
           set RecLocked to false.
           evaluate status-articoli
           when "35"
                display message "File [ARTICOLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [ARTICOLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[ARTICOLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "99" 
           when "93" 
                set RecLocked to true
                set errori    to true
                move 0 to mod        
                move 1 to mod-k
                modify tool-modifica, value = mod
                display form1
                set StatusVisua to true
                perform STATUS-BAR-MSG
                move "00" to status-articoli
                if ReadSecca
                   read articoli no lock 
                        invalid  continue
                    not invalid  perform FORM1-IUD-DISPLAY
                   end-read
                end-if
                display message MSG-Record-gia-in-uso
                          title tit-err
                           icon mb-error-icon
           when "23"
                move 1 to mod-k
                move 0 to mod
                modify tool-modifica, value = mod
                set StatusVisua to true
                perform STATUS-BAR-MSG 
                if nuovo              
                   initialize art-dati of articoli
                                      replacing numeric data by zeroes
                                            alphanumeric data by spaces
                   perform FORM1-FLD-TO-BUF
                   display form1-tb-1
                   set vecchio to true
                end-if
                perform ABILITAZIONI
                display form1
                |risetto il valore a "23" perche dentro al par. CLEAR-SCREEN
                |con l'operazione unlock viene risettato a zero cosicchè 
                |quando torna dentro ai par. di scorrimento di Totem si 
                |trova in una situazione corretta e prosegue con la read
                |uscendo con un messaggio di errore di tipo "46"
                move "23" to status-articoli
           end-evaluate.
 
      ***---
       TIVAESE-ERR SECTION.
           use after error procedure on tivaese.
           set tutto-ok  to true.
           evaluate status-tivaese
           when "35"
                display message "File [TIVAESE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIVAESE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIVAESE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMARCHE-ERR SECTION.
           use after error procedure on tmarche.
           set tutto-ok  to true.
           evaluate status-tmarche
           when "35"
                display message "File [TMARCHE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMARCHE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMARCHE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALLI-ERR SECTION.
           use after error procedure on timballi.
           set tutto-ok  to true.
           evaluate status-timballi
           when "35"
                display message "File [TIMBALLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       PROGMAG-ERR SECTION.
           use after error procedure on progmag.
           set tutto-ok  to true.
           evaluate status-progmag
           when "35"
                display message "File [PROGMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [PROGMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[PROGMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "99" 
                set RecLocked  to true
                move "progmag" to geslock-nome-file
                initialize geslock-messaggio
                string   "Il progressivo di magazzino: "           
           delimited size
                  x"0d0a" prg-chiave                               
           delimited size
                  x"0d0a"" risulta in uso su altro terminale."     
           delimited size
                  x"0d0a""Questo comporta l'impossibilità ad"      
           delimited size
                  x"0d0a""aggiornarlo coi nuovi pesi UTF inseriti" 
           delimited size
                      into geslock-messaggio
                end-string
                move 0     to geslock-v-termina
                move 1     to geslock-v-riprova
                move 1     to geslock-v-ignora
                call   "geslock" using geslock-linkage
                cancel "geslock"

                evaluate true
                when riprova set RecLocked to false
                             read progmag lock invalid continue end-read
                when other   read progmag no lock
                             set RecLocked to true
                end-evaluate

           when "93"
                set RecLocked  to true
                move "progmag" to geslock-nome-file
                initialize geslock-messaggio
                string   "Il file dei progressivi di magazzino" 
                  x"0d0a""risulta in uso su altro terminale."
                  x"0d0a""Questo comporta l'impossibilità ad"
                  x"0d0a""aggiornare i progressivi di magazzino" 
                  X"0d0a""con i nuovi pesi UTF inseriti" delimited size
                      into geslock-messaggio
                end-string
                move 1     to geslock-v-termina
                move 1     to geslock-v-riprova
                move 0     to geslock-v-ignora
                call   "geslock" using geslock-linkage
                cancel "geslock"

                evaluate true
                when riprova set tutto-ok to true
                             open i-o progmag
                when other   display message "Salvataggio NON effettuato
      -    ""
                                       title tit-err
                                        icon 2
                             set errori to true
                end-evaluate

           end-evaluate.
 
      ***---
       TNOMEN-ERR SECTION.
           use after error procedure on tnomen.
           set tutto-ok  to true.
           evaluate status-tnomen
           when "35"
                display message "File [TNOMEN] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TNOMEN] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TNOMEN] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TCLA1ART-ERR SECTION.
           use after error procedure on tcla1art.
           set tutto-ok  to true.
           evaluate status-tcla1art
           when "35"
                display message "File [TCLA1ART] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCLA1ART] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCLA1ART] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TSETMERC-ERR SECTION.
           use after error procedure on tsetmerc.
           set tutto-ok  to true.
           evaluate status-tsetmerc
           when "35"
                display message "File [TSETMERC] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TSETMERC] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TSETMERC] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.           
 
      ***---
       TUDM-ERR SECTION.
           use after error procedure on tudm.
           set tutto-ok  to true.
           evaluate status-tudm
           when "35"
                display message "File [TUDM] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TUDM] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TUDM] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TPARAMGE-ERR SECTION.
           use after error procedure on tparamge.
           set tutto-ok  to true.
           evaluate status-tparamge
           when "35"
                display message "File [TPARAMGE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TPARAMGE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TPARAMGE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALQTA-ERR SECTION.
           use after error procedure on timbalqta.
           set tutto-ok  to true.
           evaluate status-timbalqta
           when "35"
                display message "File [TIMBALQTA] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALQTA] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALQTA] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       CLIENTI-ERR SECTION.
           use after error procedure on clienti.
           set tutto-ok  to true.
           evaluate status-clienti
           when "35"
                display message "File [CLIENTI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [CLIENTI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[CLIENTI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       DESTINIF-ERR SECTION.
           use after error procedure on destinif.
           set tutto-ok  to true.
           evaluate status-destinif
           when "35"
                display message "File [DESTINIF] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [DESTINIF] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[DESTINIF] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       DISTINTEB-ERR SECTION.
           use after error procedure on distinteb.
           set tutto-ok  to true.
           evaluate status-distinteb
           when "35"
                display message "File [DISTINTEB] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [DISTINTEB] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[DISTINTEB] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.

      ***---
       PRODENER-ERR SECTION.
           use after error procedure on prodener.
           set tutto-ok  to true.
           evaluate status-prodener
           when "35"
                display message "File [PRODENER] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [PRODENER] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[PRODENER] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM anagr01-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:garticoli, INIT:garticoli, BeforeDestroyResource>
      * <TOTEM:END>
           DESTROY Courier-New10-Occidentale
           DESTROY Verdana12-Occidentale
           DESTROY Verdana12BI-Occidentale
           CALL "w$bitmap" USING WBITMAP-DESTROY, frn-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, DISTINTA-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, ALTERNATIVI-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, LISTA-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, DETTAGLI-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-STAMPA-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, EAN-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, COPIA-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, toolbar-bmp
           CALL "w$bitmap" USING WBITMAP-DESTROY, TOOLBAR-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-OK-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-CANCEL-BMP
      *    After-Program
           PERFORM anagr01-Ev-After-Program
           set environment "KEYSTROKE" to "DATA=46   46".
           set environment "KEYSTROKE" to "DATA=44   44".
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
      * Courier-New10-Occidentale
           INITIALIZE WFONT-DATA Courier-New10-Occidentale
           MOVE 10 TO WFONT-SIZE
           MOVE "Courier New" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO FALSE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Courier-New10-Occidentale, WFONT-DATA
      * Verdana12-Occidentale
           INITIALIZE WFONT-DATA Verdana12-Occidentale
           MOVE 12 TO WFONT-SIZE
           MOVE "Verdana" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO FALSE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Verdana12-Occidentale, WFONT-DATA
      * Verdana12BI-Occidentale
           INITIALIZE WFONT-DATA Verdana12BI-Occidentale
           MOVE 12 TO WFONT-SIZE
           MOVE "Verdana" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO TRUE
           SET WFONT-ITALIC TO TRUE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Verdana12BI-Occidentale, WFONT-DATA
           .

       INIT-BMP.
      * pb-frn
           COPY RESOURCE "frn.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "frn.BMP", 
                   GIVING frn-BMP.
      * pb-distinta
           COPY RESOURCE "DISTINTA.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "DISTINTA.BMP", 
                   GIVING DISTINTA-BMP.
      * pb-codici
           COPY RESOURCE "ALTERNATIVI.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "ALTERNATIVI.BMP", 
                   GIVING ALTERNATIVI-BMP.
      * pb-lista
           COPY RESOURCE "LISTA.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "LISTA.BMP", 
                   GIVING LISTA-BMP.
      * pb-dettagli
           COPY RESOURCE "DETTAGLI.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "DETTAGLI.BMP", 
                   GIVING DETTAGLI-BMP.
      * pb-stampa
           COPY RESOURCE "BOTTONE-STAMPA.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-STAMPA.BMP", 
                   GIVING BOTTONE-STAMPA-BMP.
      * pb-ean
           COPY RESOURCE "EAN.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "EAN.BMP", 
                   GIVING EAN-BMP.
      * pb-copiada
           COPY RESOURCE "COPIA.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "COPIA.BMP", 
                   GIVING COPIA-BMP.
      * TOOL-ESCI
           COPY RESOURCE "toolbar.bmp".
           CALL "w$bitmap" USING WBITMAP-LOAD "toolbar.bmp", 
                   GIVING toolbar-bmp.
      * TOOL-NUOVO
           COPY RESOURCE "TOOLBAR.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "TOOLBAR.BMP", 
                   GIVING TOOLBAR-BMP.
      * pb-ok
           COPY RESOURCE "BOTTONE-OK.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-OK.BMP", 
                   GIVING BOTTONE-OK-BMP.
      * pb-annulla
           COPY RESOURCE "BOTTONE-CANCEL.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-CANCEL.BMP", 
                   GIVING BOTTONE-CANCEL-BMP.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-tivaese
           PERFORM OPEN-tmarche
           PERFORM OPEN-timballi
           PERFORM OPEN-progmag
           PERFORM OPEN-tnomen
           PERFORM OPEN-tcla1art
           PERFORM OPEN-tsetmerc
           PERFORM OPEN-tudm
           PERFORM OPEN-tparamge
           PERFORM OPEN-clienti
           PERFORM OPEN-distinteb
           PERFORM OPEN-rmovmag
           PERFORM OPEN-rordini
           PERFORM OPEN-rnotacr
           PERFORM OPEN-brnotacr
           PERFORM OPEN-tscorte
           PERFORM OPEN-rlistini
           PERFORM OPEN-destinif
           PERFORM OPEN-articoli1
           PERFORM OPEN-mrordini
           PERFORM OPEN-reva
           PERFORM OPEN-rordforn
           PERFORM OPEN-sort-art-list
           PERFORM OPEN-timposte
           PERFORM OPEN-tpiombo
           PERFORM OPEN-tlistini
           PERFORM OPEN-prodener
           PERFORM OPEN-blister
      *    catart OPEN MODE IS FALSE
      *    PERFORM OPEN-catart
           PERFORM OPEN-param
           PERFORM OPEN-impforn
           PERFORM OPEN-tmagaz
           PERFORM OPEN-articoli
           PERFORM OPEN-timbalqta
      *    After Open
           .

       OPEN-tivaese.
      * <TOTEM:EPT. INIT:garticoli, FD:tivaese, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tivaese
           IF NOT Valid-STATUS-tivaese
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tivaese, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmarche.
      * <TOTEM:EPT. INIT:garticoli, FD:tmarche, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmarche
           IF NOT Valid-STATUS-tmarche
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tmarche, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timballi.
      * <TOTEM:EPT. INIT:garticoli, FD:timballi, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timballi
           IF NOT Valid-STATUS-timballi
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:timballi, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-progmag.
      * <TOTEM:EPT. INIT:garticoli, FD:progmag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT progmag
           IF NOT Valid-STATUS-progmag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:progmag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tnomen.
      * <TOTEM:EPT. INIT:garticoli, FD:tnomen, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tnomen
           IF NOT Valid-STATUS-tnomen
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tnomen, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcla1art.
      * <TOTEM:EPT. INIT:garticoli, FD:tcla1art, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcla1art
           IF NOT Valid-STATUS-tcla1art
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tcla1art, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tsetmerc.
      * <TOTEM:EPT. INIT:garticoli, FD:tsetmerc, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tsetmerc
           IF NOT Valid-STATUS-tsetmerc
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tsetmerc, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tudm.
      * <TOTEM:EPT. INIT:garticoli, FD:tudm, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tudm
           IF NOT Valid-STATUS-tudm
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tudm, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tparamge.
      * <TOTEM:EPT. INIT:garticoli, FD:tparamge, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tparamge
           IF NOT Valid-STATUS-tparamge
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tparamge, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-clienti.
      * <TOTEM:EPT. INIT:garticoli, FD:clienti, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT clienti
           IF NOT Valid-STATUS-clienti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:clienti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-distinteb.
      * <TOTEM:EPT. INIT:garticoli, FD:distinteb, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT distinteb
           IF NOT Valid-STATUS-distinteb
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:distinteb, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rmovmag.
      * <TOTEM:EPT. INIT:garticoli, FD:rmovmag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rmovmag
           IF NOT Valid-STATUS-rmovmag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:rmovmag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rordini.
      * <TOTEM:EPT. INIT:garticoli, FD:rordini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rordini
           IF NOT Valid-STATUS-rordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:rordini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rnotacr.
      * <TOTEM:EPT. INIT:garticoli, FD:rnotacr, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rnotacr
           IF NOT Valid-STATUS-rnotacr
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:rnotacr, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-brnotacr.
      * <TOTEM:EPT. INIT:garticoli, FD:brnotacr, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT brnotacr
           IF NOT Valid-STATUS-brnotacr
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:brnotacr, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tscorte.
      * <TOTEM:EPT. INIT:garticoli, FD:tscorte, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tscorte
           IF NOT Valid-STATUS-tscorte
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tscorte, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rlistini.
      * <TOTEM:EPT. INIT:garticoli, FD:rlistini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rlistini
           IF NOT Valid-STATUS-rlistini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:rlistini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-destinif.
      * <TOTEM:EPT. INIT:garticoli, FD:destinif, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT destinif
           IF NOT Valid-STATUS-destinif
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:destinif, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-articoli1.
      * <TOTEM:EPT. INIT:garticoli, FD:articoli1, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT articoli1
           IF NOT VALID-STATUS-articoli1
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:articoli1, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-mrordini.
      * <TOTEM:EPT. INIT:garticoli, FD:mrordini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT mrordini
           IF NOT Valid-STATUS-mrordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:mrordini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-reva.
      * <TOTEM:EPT. INIT:garticoli, FD:reva, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT reva
           IF NOT Valid-STATUS-reva
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:reva, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rordforn.
      * <TOTEM:EPT. INIT:garticoli, FD:rordforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rordforn
           IF NOT Valid-STATUS-rordforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:rordforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-sort-art-list.
      * <TOTEM:EPT. INIT:garticoli, FD:sort-art-list, BeforeOpen>
      * <TOTEM:END>
      * <TOTEM:EPT. INIT:garticoli, FD:sort-art-list, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timposte.
      * <TOTEM:EPT. INIT:garticoli, FD:timposte, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timposte
           IF NOT Valid-STATUS-timposte
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:timposte, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tpiombo.
      * <TOTEM:EPT. INIT:garticoli, FD:tpiombo, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tpiombo
           IF NOT Valid-STATUS-tpiombo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tpiombo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tlistini.
      * <TOTEM:EPT. INIT:garticoli, FD:tlistini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tlistini
           IF NOT Valid-STATUS-tlistini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tlistini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-prodener.
      * <TOTEM:EPT. INIT:garticoli, FD:prodener, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT prodener
           IF NOT Valid-STATUS-prodener
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:prodener, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-blister.
      * <TOTEM:EPT. INIT:garticoli, FD:blister, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT blister
           IF NOT Valid-STATUS-blister
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:blister, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-catart.
      * <TOTEM:EPT. INIT:garticoli, FD:catart, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT catart
           IF NOT Valid-status-catart
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:catart, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-param.
      * <TOTEM:EPT. INIT:garticoli, FD:param, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT param
           IF NOT Valid-STATUS-param
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:param, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-impforn.
      * <TOTEM:EPT. INIT:garticoli, FD:impforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT impforn
           IF NOT Valid-STATUS-impforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:impforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmagaz.
      * <TOTEM:EPT. INIT:garticoli, FD:tmagaz, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmagaz
           IF NOT Valid-STATUS-tmagaz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:tmagaz, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-articoli.
      * <TOTEM:EPT. INIT:garticoli, FD:articoli, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O articoli
           IF STATUS-articoli = "35"
              OPEN OUTPUT articoli
                IF Valid-STATUS-articoli
                   CLOSE articoli
                   OPEN I-O articoli
                END-IF
           END-IF
           IF NOT Valid-STATUS-articoli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:articoli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timbalqta.
      * <TOTEM:EPT. INIT:garticoli, FD:timbalqta, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timbalqta
           IF NOT Valid-STATUS-timbalqta
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:garticoli, FD:timbalqta, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-tivaese
           PERFORM CLOSE-tmarche
           PERFORM CLOSE-timballi
           PERFORM CLOSE-progmag
           PERFORM CLOSE-tnomen
           PERFORM CLOSE-tcla1art
           PERFORM CLOSE-tsetmerc
           PERFORM CLOSE-tudm
           PERFORM CLOSE-tparamge
           PERFORM CLOSE-clienti
           PERFORM CLOSE-distinteb
           PERFORM CLOSE-rmovmag
           PERFORM CLOSE-rordini
           PERFORM CLOSE-rnotacr
           PERFORM CLOSE-brnotacr
           PERFORM CLOSE-tscorte
           PERFORM CLOSE-rlistini
           PERFORM CLOSE-destinif
           PERFORM CLOSE-articoli1
           PERFORM CLOSE-mrordini
           PERFORM CLOSE-reva
           PERFORM CLOSE-rordforn
           PERFORM CLOSE-sort-art-list
           PERFORM CLOSE-timposte
           PERFORM CLOSE-tpiombo
           PERFORM CLOSE-tlistini
           PERFORM CLOSE-prodener
           PERFORM CLOSE-blister
      *    catart CLOSE MODE IS FALSE
      *    PERFORM CLOSE-catart
           PERFORM CLOSE-param
           PERFORM CLOSE-impforn
           PERFORM CLOSE-tmagaz
           PERFORM CLOSE-articoli
           PERFORM CLOSE-timbalqta
      *    After Close
           .

       CLOSE-tivaese.
      * <TOTEM:EPT. INIT:garticoli, FD:tivaese, BeforeClose>
      * <TOTEM:END>
           CLOSE tivaese
           .

       CLOSE-tmarche.
      * <TOTEM:EPT. INIT:garticoli, FD:tmarche, BeforeClose>
      * <TOTEM:END>
           CLOSE tmarche
           .

       CLOSE-timballi.
      * <TOTEM:EPT. INIT:garticoli, FD:timballi, BeforeClose>
      * <TOTEM:END>
           CLOSE timballi
           .

       CLOSE-progmag.
      * <TOTEM:EPT. INIT:garticoli, FD:progmag, BeforeClose>
      * <TOTEM:END>
           CLOSE progmag
           .

       CLOSE-tnomen.
      * <TOTEM:EPT. INIT:garticoli, FD:tnomen, BeforeClose>
      * <TOTEM:END>
           CLOSE tnomen
           .

       CLOSE-tcla1art.
      * <TOTEM:EPT. INIT:garticoli, FD:tcla1art, BeforeClose>
      * <TOTEM:END>
           CLOSE tcla1art
           .

       CLOSE-tsetmerc.
      * <TOTEM:EPT. INIT:garticoli, FD:tsetmerc, BeforeClose>
      * <TOTEM:END>
           CLOSE tsetmerc
           .

       CLOSE-tudm.
      * <TOTEM:EPT. INIT:garticoli, FD:tudm, BeforeClose>
      * <TOTEM:END>
           CLOSE tudm
           .

       CLOSE-tparamge.
      * <TOTEM:EPT. INIT:garticoli, FD:tparamge, BeforeClose>
      * <TOTEM:END>
           CLOSE tparamge
           .

       CLOSE-clienti.
      * <TOTEM:EPT. INIT:garticoli, FD:clienti, BeforeClose>
      * <TOTEM:END>
           CLOSE clienti
           .

       CLOSE-distinteb.
      * <TOTEM:EPT. INIT:garticoli, FD:distinteb, BeforeClose>
      * <TOTEM:END>
           CLOSE distinteb
           .

       CLOSE-rmovmag.
      * <TOTEM:EPT. INIT:garticoli, FD:rmovmag, BeforeClose>
      * <TOTEM:END>
           CLOSE rmovmag
           .

       CLOSE-rordini.
      * <TOTEM:EPT. INIT:garticoli, FD:rordini, BeforeClose>
      * <TOTEM:END>
           CLOSE rordini
           .

       CLOSE-rnotacr.
      * <TOTEM:EPT. INIT:garticoli, FD:rnotacr, BeforeClose>
      * <TOTEM:END>
           CLOSE rnotacr
           .

       CLOSE-brnotacr.
      * <TOTEM:EPT. INIT:garticoli, FD:brnotacr, BeforeClose>
      * <TOTEM:END>
           CLOSE brnotacr
           .

       CLOSE-tscorte.
      * <TOTEM:EPT. INIT:garticoli, FD:tscorte, BeforeClose>
      * <TOTEM:END>
           CLOSE tscorte
           .

       CLOSE-rlistini.
      * <TOTEM:EPT. INIT:garticoli, FD:rlistini, BeforeClose>
      * <TOTEM:END>
           CLOSE rlistini
           .

       CLOSE-destinif.
      * <TOTEM:EPT. INIT:garticoli, FD:destinif, BeforeClose>
      * <TOTEM:END>
           CLOSE destinif
           .

       CLOSE-articoli1.
      * <TOTEM:EPT. INIT:garticoli, FD:articoli1, BeforeClose>
      * <TOTEM:END>
           CLOSE articoli1
           .

       CLOSE-mrordini.
      * <TOTEM:EPT. INIT:garticoli, FD:mrordini, BeforeClose>
      * <TOTEM:END>
           CLOSE mrordini
           .

       CLOSE-reva.
      * <TOTEM:EPT. INIT:garticoli, FD:reva, BeforeClose>
      * <TOTEM:END>
           CLOSE reva
           .

       CLOSE-rordforn.
      * <TOTEM:EPT. INIT:garticoli, FD:rordforn, BeforeClose>
      * <TOTEM:END>
           CLOSE rordforn
           .

       CLOSE-sort-art-list.
      * <TOTEM:EPT. INIT:garticoli, FD:sort-art-list, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-timposte.
      * <TOTEM:EPT. INIT:garticoli, FD:timposte, BeforeClose>
      * <TOTEM:END>
           CLOSE timposte
           .

       CLOSE-tpiombo.
      * <TOTEM:EPT. INIT:garticoli, FD:tpiombo, BeforeClose>
      * <TOTEM:END>
           CLOSE tpiombo
           .

       CLOSE-tlistini.
      * <TOTEM:EPT. INIT:garticoli, FD:tlistini, BeforeClose>
      * <TOTEM:END>
           CLOSE tlistini
           .

       CLOSE-prodener.
      * <TOTEM:EPT. INIT:garticoli, FD:prodener, BeforeClose>
      * <TOTEM:END>
           CLOSE prodener
           .

       CLOSE-blister.
      * <TOTEM:EPT. INIT:garticoli, FD:blister, BeforeClose>
      * <TOTEM:END>
           CLOSE blister
           .

       CLOSE-catart.
      * <TOTEM:EPT. INIT:garticoli, FD:catart, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-param.
      * <TOTEM:EPT. INIT:garticoli, FD:param, BeforeClose>
      * <TOTEM:END>
           CLOSE param
           .

       CLOSE-impforn.
      * <TOTEM:EPT. INIT:garticoli, FD:impforn, BeforeClose>
      * <TOTEM:END>
           CLOSE impforn
           .

       CLOSE-tmagaz.
      * <TOTEM:EPT. INIT:garticoli, FD:tmagaz, BeforeClose>
      * <TOTEM:END>
           CLOSE tmagaz
           .

       CLOSE-articoli.
      * <TOTEM:EPT. INIT:garticoli, FD:articoli, BeforeClose>
      * <TOTEM:END>
           CLOSE articoli
           .

       CLOSE-timbalqta.
      * <TOTEM:EPT. INIT:garticoli, FD:timbalqta, BeforeClose>
      * <TOTEM:END>
           CLOSE timbalqta
           .

       tivaese-key01-MERGE-SPLITBUF.
           INITIALIZE tivaese-key01-SPLITBUF
           MOVE TBLIV-CODICE1(1:2) TO tivaese-key01-SPLITBUF(1:2)
           MOVE TBLIV-DESCRIZIONE1(1:30) TO tivaese-key01-SPLITBUF(3:30)
           MOVE TBLIV-CODICE2(1:20) TO tivaese-key01-SPLITBUF(33:20)
           .

       DataSet1-tivaese-INITSTART.
           IF DataSet1-tivaese-KEY-Asc
              MOVE Low-Value TO TBLIV-CODICE
           ELSE
              MOVE High-Value TO TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-INITEND.
           IF DataSet1-tivaese-KEY-Asc
              MOVE High-Value TO TBLIV-CODICE
           ELSE
              MOVE Low-Value TO TBLIV-CODICE
           END-IF
           .

      * tivaese
       DataSet1-tivaese-START.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY >= TBLIV-CODICE
           ELSE
              START tivaese KEY <= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-NOTGREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY <= TBLIV-CODICE
           ELSE
              START tivaese KEY >= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-GREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY > TBLIV-CODICE
           ELSE
              START tivaese KEY < TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-LESS.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY < TBLIV-CODICE
           ELSE
              START tivaese KEY > TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tivaese-LOCK
              READ tivaese WITH LOCK 
              KEY TBLIV-CODICE
           ELSE
              READ tivaese WITH NO LOCK 
              KEY TBLIV-CODICE
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT 
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmarche-INITSTART.
           IF DataSet1-tmarche-KEY-Asc
              MOVE Low-Value TO mar-chiave
           ELSE
              MOVE High-Value TO mar-chiave
           END-IF
           .

       DataSet1-tmarche-INITEND.
           IF DataSet1-tmarche-KEY-Asc
              MOVE High-Value TO mar-chiave
           ELSE
              MOVE Low-Value TO mar-chiave
           END-IF
           .

      * tmarche
       DataSet1-tmarche-START.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY >= mar-chiave
           ELSE
              START tmarche KEY <= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-NOTGREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY <= mar-chiave
           ELSE
              START tmarche KEY >= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-GREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY > mar-chiave
           ELSE
              START tmarche KEY < mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-LESS.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY < mar-chiave
           ELSE
              START tmarche KEY > mar-chiave
           END-IF
           .

       DataSet1-tmarche-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmarche-LOCK
              READ tmarche WITH LOCK 
              KEY mar-chiave
           ELSE
              READ tmarche WITH NO LOCK 
              KEY mar-chiave
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT 
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timballi-INITSTART.
           IF DataSet1-timballi-KEY-Asc
              MOVE Low-Value TO imb-chiave
           ELSE
              MOVE High-Value TO imb-chiave
           END-IF
           .

       DataSet1-timballi-INITEND.
           IF DataSet1-timballi-KEY-Asc
              MOVE High-Value TO imb-chiave
           ELSE
              MOVE Low-Value TO imb-chiave
           END-IF
           .

      * timballi
       DataSet1-timballi-START.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY >= imb-chiave
           ELSE
              START timballi KEY <= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-NOTGREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY <= imb-chiave
           ELSE
              START timballi KEY >= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-GREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY > imb-chiave
           ELSE
              START timballi KEY < imb-chiave
           END-IF
           .

       DataSet1-timballi-START-LESS.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY < imb-chiave
           ELSE
              START timballi KEY > imb-chiave
           END-IF
           .

       DataSet1-timballi-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timballi-LOCK
              READ timballi WITH LOCK 
              KEY imb-chiave
           ELSE
              READ timballi WITH NO LOCK 
              KEY imb-chiave
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT 
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterDelete>
      * <TOTEM:END>
           .

       progmag-key01-MERGE-SPLITBUF.
           INITIALIZE progmag-key01-SPLITBUF
           MOVE prg-cod-magazzino OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(1:3)
           MOVE prg-cod-articolo OF progmag(1:6) TO 
           progmag-key01-SPLITBUF(4:6)
           MOVE prg-tipo-imballo OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(10:3)
           MOVE prg-peso OF progmag(1:8) TO progmag-key01-SPLITBUF(13:8)
           .

       DataSet1-progmag-INITSTART.
           IF DataSet1-progmag-KEY-Asc
              MOVE Low-Value TO prg-chiave OF progmag
           ELSE
              MOVE High-Value TO prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-INITEND.
           IF DataSet1-progmag-KEY-Asc
              MOVE High-Value TO prg-chiave OF progmag
           ELSE
              MOVE Low-Value TO prg-chiave OF progmag
           END-IF
           .

      * progmag
       DataSet1-progmag-START.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY >= prg-chiave OF progmag
           ELSE
              START progmag KEY <= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-NOTGREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY <= prg-chiave OF progmag
           ELSE
              START progmag KEY >= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-GREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY > prg-chiave OF progmag
           ELSE
              START progmag KEY < prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-LESS.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY < prg-chiave OF progmag
           ELSE
              START progmag KEY > prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-progmag-LOCK
              READ progmag WITH LOCK 
              KEY prg-chiave OF progmag
           ELSE
              READ progmag WITH NO LOCK 
              KEY prg-chiave OF progmag
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT 
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tnomen-INITSTART.
           IF DataSet1-tnomen-KEY-Asc
              MOVE Low-Value TO nom-chiave
           ELSE
              MOVE High-Value TO nom-chiave
           END-IF
           .

       DataSet1-tnomen-INITEND.
           IF DataSet1-tnomen-KEY-Asc
              MOVE High-Value TO nom-chiave
           ELSE
              MOVE Low-Value TO nom-chiave
           END-IF
           .

      * tnomen
       DataSet1-tnomen-START.
           IF DataSet1-tnomen-KEY-Asc
              START tnomen KEY >= nom-chiave
           ELSE
              START tnomen KEY <= nom-chiave
           END-IF
           .

       DataSet1-tnomen-START-NOTGREATER.
           IF DataSet1-tnomen-KEY-Asc
              START tnomen KEY <= nom-chiave
           ELSE
              START tnomen KEY >= nom-chiave
           END-IF
           .

       DataSet1-tnomen-START-GREATER.
           IF DataSet1-tnomen-KEY-Asc
              START tnomen KEY > nom-chiave
           ELSE
              START tnomen KEY < nom-chiave
           END-IF
           .

       DataSet1-tnomen-START-LESS.
           IF DataSet1-tnomen-KEY-Asc
              START tnomen KEY < nom-chiave
           ELSE
              START tnomen KEY > nom-chiave
           END-IF
           .

       DataSet1-tnomen-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tnomen-LOCK
              READ tnomen WITH LOCK 
              KEY nom-chiave
           ELSE
              READ tnomen WITH NO LOCK 
              KEY nom-chiave
           END-IF
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT 
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tnomen-KEY-Asc
              IF DataSet1-tnomen-LOCK
                 READ tnomen NEXT WITH LOCK
              ELSE
                 READ tnomen NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnomen-LOCK
                 READ tnomen PREVIOUS WITH LOCK
              ELSE
                 READ tnomen PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tnomen-KEY-Asc
              IF DataSet1-tnomen-LOCK
                 READ tnomen PREVIOUS WITH LOCK
              ELSE
                 READ tnomen PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnomen-LOCK
                 READ tnomen NEXT WITH LOCK
              ELSE
                 READ tnomen NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-INITSTART.
           IF DataSet1-tcla1art-KEY-Asc
              MOVE Low-Value TO cl1-chiave
           ELSE
              MOVE High-Value TO cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-INITEND.
           IF DataSet1-tcla1art-KEY-Asc
              MOVE High-Value TO cl1-chiave
           ELSE
              MOVE Low-Value TO cl1-chiave
           END-IF
           .

      * tcla1art
       DataSet1-tcla1art-START.
           IF DataSet1-tcla1art-KEY-Asc
              START tcla1art KEY >= cl1-chiave
           ELSE
              START tcla1art KEY <= cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-START-NOTGREATER.
           IF DataSet1-tcla1art-KEY-Asc
              START tcla1art KEY <= cl1-chiave
           ELSE
              START tcla1art KEY >= cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-START-GREATER.
           IF DataSet1-tcla1art-KEY-Asc
              START tcla1art KEY > cl1-chiave
           ELSE
              START tcla1art KEY < cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-START-LESS.
           IF DataSet1-tcla1art-KEY-Asc
              START tcla1art KEY < cl1-chiave
           ELSE
              START tcla1art KEY > cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcla1art-LOCK
              READ tcla1art WITH LOCK 
              KEY cl1-chiave
           ELSE
              READ tcla1art WITH NO LOCK 
              KEY cl1-chiave
           END-IF
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT 
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcla1art-KEY-Asc
              IF DataSet1-tcla1art-LOCK
                 READ tcla1art NEXT WITH LOCK
              ELSE
                 READ tcla1art NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcla1art-LOCK
                 READ tcla1art PREVIOUS WITH LOCK
              ELSE
                 READ tcla1art PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcla1art-KEY-Asc
              IF DataSet1-tcla1art-LOCK
                 READ tcla1art PREVIOUS WITH LOCK
              ELSE
                 READ tcla1art PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcla1art-LOCK
                 READ tcla1art NEXT WITH LOCK
              ELSE
                 READ tcla1art NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-INITSTART.
           IF DataSet1-tsetmerc-KEY-Asc
              MOVE Low-Value TO sme-chiave
           ELSE
              MOVE High-Value TO sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-INITEND.
           IF DataSet1-tsetmerc-KEY-Asc
              MOVE High-Value TO sme-chiave
           ELSE
              MOVE Low-Value TO sme-chiave
           END-IF
           .

      * tsetmerc
       DataSet1-tsetmerc-START.
           IF DataSet1-tsetmerc-KEY-Asc
              START tsetmerc KEY >= sme-chiave
           ELSE
              START tsetmerc KEY <= sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-START-NOTGREATER.
           IF DataSet1-tsetmerc-KEY-Asc
              START tsetmerc KEY <= sme-chiave
           ELSE
              START tsetmerc KEY >= sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-START-GREATER.
           IF DataSet1-tsetmerc-KEY-Asc
              START tsetmerc KEY > sme-chiave
           ELSE
              START tsetmerc KEY < sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-START-LESS.
           IF DataSet1-tsetmerc-KEY-Asc
              START tsetmerc KEY < sme-chiave
           ELSE
              START tsetmerc KEY > sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tsetmerc-LOCK
              READ tsetmerc WITH LOCK 
              KEY sme-chiave
           ELSE
              READ tsetmerc WITH NO LOCK 
              KEY sme-chiave
           END-IF
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT 
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tsetmerc-KEY-Asc
              IF DataSet1-tsetmerc-LOCK
                 READ tsetmerc NEXT WITH LOCK
              ELSE
                 READ tsetmerc NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tsetmerc-LOCK
                 READ tsetmerc PREVIOUS WITH LOCK
              ELSE
                 READ tsetmerc PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tsetmerc-KEY-Asc
              IF DataSet1-tsetmerc-LOCK
                 READ tsetmerc PREVIOUS WITH LOCK
              ELSE
                 READ tsetmerc PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tsetmerc-LOCK
                 READ tsetmerc NEXT WITH LOCK
              ELSE
                 READ tsetmerc NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tudm-INITSTART.
           IF DataSet1-tudm-KEY-Asc
              MOVE Low-Value TO udm-chiave
           ELSE
              MOVE High-Value TO udm-chiave
           END-IF
           .

       DataSet1-tudm-INITEND.
           IF DataSet1-tudm-KEY-Asc
              MOVE High-Value TO udm-chiave
           ELSE
              MOVE Low-Value TO udm-chiave
           END-IF
           .

      * tudm
       DataSet1-tudm-START.
           IF DataSet1-tudm-KEY-Asc
              START tudm KEY >= udm-chiave
           ELSE
              START tudm KEY <= udm-chiave
           END-IF
           .

       DataSet1-tudm-START-NOTGREATER.
           IF DataSet1-tudm-KEY-Asc
              START tudm KEY <= udm-chiave
           ELSE
              START tudm KEY >= udm-chiave
           END-IF
           .

       DataSet1-tudm-START-GREATER.
           IF DataSet1-tudm-KEY-Asc
              START tudm KEY > udm-chiave
           ELSE
              START tudm KEY < udm-chiave
           END-IF
           .

       DataSet1-tudm-START-LESS.
           IF DataSet1-tudm-KEY-Asc
              START tudm KEY < udm-chiave
           ELSE
              START tudm KEY > udm-chiave
           END-IF
           .

       DataSet1-tudm-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tudm-LOCK
              READ tudm WITH LOCK 
              KEY udm-chiave
           ELSE
              READ tudm WITH NO LOCK 
              KEY udm-chiave
           END-IF
           MOVE STATUS-tudm TO TOTEM-ERR-STAT 
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tudm-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tudm-KEY-Asc
              IF DataSet1-tudm-LOCK
                 READ tudm NEXT WITH LOCK
              ELSE
                 READ tudm NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tudm-LOCK
                 READ tudm PREVIOUS WITH LOCK
              ELSE
                 READ tudm PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tudm-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tudm-KEY-Asc
              IF DataSet1-tudm-LOCK
                 READ tudm PREVIOUS WITH LOCK
              ELSE
                 READ tudm PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tudm-LOCK
                 READ tudm NEXT WITH LOCK
              ELSE
                 READ tudm NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tudm-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tudm-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tudm-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tparamge-INITSTART.
           IF DataSet1-tparamge-KEY-Asc
              MOVE Low-Value TO tge-chiave
           ELSE
              MOVE High-Value TO tge-chiave
           END-IF
           .

       DataSet1-tparamge-INITEND.
           IF DataSet1-tparamge-KEY-Asc
              MOVE High-Value TO tge-chiave
           ELSE
              MOVE Low-Value TO tge-chiave
           END-IF
           .

      * tparamge
       DataSet1-tparamge-START.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY >= tge-chiave
           ELSE
              START tparamge KEY <= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-NOTGREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY <= tge-chiave
           ELSE
              START tparamge KEY >= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-GREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY > tge-chiave
           ELSE
              START tparamge KEY < tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-LESS.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY < tge-chiave
           ELSE
              START tparamge KEY > tge-chiave
           END-IF
           .

       DataSet1-tparamge-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tparamge-LOCK
              READ tparamge WITH LOCK 
              KEY tge-chiave
           ELSE
              READ tparamge WITH NO LOCK 
              KEY tge-chiave
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT 
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterDelete>
      * <TOTEM:END>
           .

       clienti-cli-K1-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K1-SPLITBUF
           MOVE cli-tipo-CF OF clienti(1:1) TO 
           clienti-cli-K1-SPLITBUF(1:1)
           MOVE cli-ragsoc-1 OF clienti(1:40) TO 
           clienti-cli-K1-SPLITBUF(2:40)
           MOVE cli-codice OF clienti(1:5) TO 
           clienti-cli-K1-SPLITBUF(42:5)
           .

       clienti-cli-K3-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K3-SPLITBUF
           MOVE cli-gdo OF clienti(1:5) TO clienti-cli-K3-SPLITBUF(1:5)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K3-SPLITBUF(6:6)
           .

       clienti-cli-K4-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K4-SPLITBUF
           MOVE cli-utf OF clienti(1:1) TO clienti-cli-K4-SPLITBUF(1:1)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K4-SPLITBUF(2:6)
           .

       DataSet1-clienti-INITSTART.
           IF DataSet1-clienti-KEY-Asc
              MOVE Low-Value TO cli-chiave OF clienti
           ELSE
              MOVE High-Value TO cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-INITEND.
           IF DataSet1-clienti-KEY-Asc
              MOVE High-Value TO cli-chiave OF clienti
           ELSE
              MOVE Low-Value TO cli-chiave OF clienti
           END-IF
           .

      * clienti
       DataSet1-clienti-START.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY >= cli-chiave OF clienti
           ELSE
              START clienti KEY <= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-NOTGREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY <= cli-chiave OF clienti
           ELSE
              START clienti KEY >= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-GREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY > cli-chiave OF clienti
           ELSE
              START clienti KEY < cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-LESS.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY < cli-chiave OF clienti
           ELSE
              START clienti KEY > cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-clienti-LOCK
              READ clienti WITH LOCK 
              KEY cli-chiave OF clienti
           ELSE
              READ clienti WITH NO LOCK 
              KEY cli-chiave OF clienti
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT 
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterDelete>
      * <TOTEM:END>
           .

       distinteb-k-articolo-MERGE-SPLITBUF.
           INITIALIZE distinteb-k-articolo-SPLITBUF
           MOVE dis-articolo-finale(1:6) TO 
           distinteb-k-articolo-SPLITBUF(1:6)
           MOVE dis-chiave(1:5) TO distinteb-k-articolo-SPLITBUF(7:5)
           .

       distinteb-k-progmag-MERGE-SPLITBUF.
           INITIALIZE distinteb-k-progmag-SPLITBUF
           MOVE dis-chiave-progmag(1:20) TO 
           distinteb-k-progmag-SPLITBUF(1:20)
           .

       DataSet1-distinteb-INITSTART.
           IF DataSet1-distinteb-KEY-Asc
              MOVE Low-Value TO dis-chiave
           ELSE
              MOVE High-Value TO dis-chiave
           END-IF
           .

       DataSet1-distinteb-INITEND.
           IF DataSet1-distinteb-KEY-Asc
              MOVE High-Value TO dis-chiave
           ELSE
              MOVE Low-Value TO dis-chiave
           END-IF
           .

      * distinteb
       DataSet1-distinteb-START.
           IF DataSet1-distinteb-KEY-Asc
              START distinteb KEY >= dis-chiave
           ELSE
              START distinteb KEY <= dis-chiave
           END-IF
           .

       DataSet1-distinteb-START-NOTGREATER.
           IF DataSet1-distinteb-KEY-Asc
              START distinteb KEY <= dis-chiave
           ELSE
              START distinteb KEY >= dis-chiave
           END-IF
           .

       DataSet1-distinteb-START-GREATER.
           IF DataSet1-distinteb-KEY-Asc
              START distinteb KEY > dis-chiave
           ELSE
              START distinteb KEY < dis-chiave
           END-IF
           .

       DataSet1-distinteb-START-LESS.
           IF DataSet1-distinteb-KEY-Asc
              START distinteb KEY < dis-chiave
           ELSE
              START distinteb KEY > dis-chiave
           END-IF
           .

       DataSet1-distinteb-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-distinteb-LOCK
              READ distinteb WITH LOCK 
              KEY dis-chiave
           ELSE
              READ distinteb WITH NO LOCK 
              KEY dis-chiave
           END-IF
           PERFORM distinteb-k-articolo-MERGE-SPLITBUF
           PERFORM distinteb-k-progmag-MERGE-SPLITBUF
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT 
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-distinteb-KEY-Asc
              IF DataSet1-distinteb-LOCK
                 READ distinteb NEXT WITH LOCK
              ELSE
                 READ distinteb NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-distinteb-LOCK
                 READ distinteb PREVIOUS WITH LOCK
              ELSE
                 READ distinteb PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM distinteb-k-articolo-MERGE-SPLITBUF
           PERFORM distinteb-k-progmag-MERGE-SPLITBUF
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-distinteb-KEY-Asc
              IF DataSet1-distinteb-LOCK
                 READ distinteb PREVIOUS WITH LOCK
              ELSE
                 READ distinteb PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-distinteb-LOCK
                 READ distinteb NEXT WITH LOCK
              ELSE
                 READ distinteb NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM distinteb-k-articolo-MERGE-SPLITBUF
           PERFORM distinteb-k-progmag-MERGE-SPLITBUF
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterDelete>
      * <TOTEM:END>
           .

       rmovmag-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rmovmag-k-articolo-SPLITBUF
           MOVE rmo-anno OF rmovmag(1:4) TO 
           rmovmag-k-articolo-SPLITBUF(1:4)
           MOVE rmo-movim OF rmovmag(1:8) TO 
           rmovmag-k-articolo-SPLITBUF(5:8)
           MOVE rmo-articolo OF rmovmag(1:6) TO 
           rmovmag-k-articolo-SPLITBUF(13:6)
           .

       rmovmag-rmo-chiave-ricerca-MERGE-SPLITBUF.
           INITIALIZE rmovmag-rmo-chiave-ricerca-SPLITBUF
           MOVE rmo-tipo OF rmovmag(1:1) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(1:1)
           MOVE rmo-cod-clifor OF rmovmag(1:5) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(2:5)
           MOVE rmo-causale OF rmovmag(1:4) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(7:4)
           MOVE rmo-articolo OF rmovmag(1:6) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(11:6)
           MOVE rmo-data-movim OF rmovmag(1:8) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(17:8)
           .

       rmovmag-k-progmag-MERGE-SPLITBUF.
           INITIALIZE rmovmag-k-progmag-SPLITBUF
           MOVE rmo-chiave-progmag OF rmovmag(1:20) TO 
           rmovmag-k-progmag-SPLITBUF(1:20)
           .

       rmovmag-k-art-data-MERGE-SPLITBUF.
           INITIALIZE rmovmag-k-art-data-SPLITBUF
           MOVE rmo-articolo OF rmovmag(1:6) TO 
           rmovmag-k-art-data-SPLITBUF(1:6)
           MOVE rmo-data-movim OF rmovmag(1:8) TO 
           rmovmag-k-art-data-SPLITBUF(7:8)
           .

       DataSet1-rmovmag-INITSTART.
           IF DataSet1-rmovmag-KEY-Asc
              MOVE Low-Value TO rmo-chiave OF rmovmag
           ELSE
              MOVE High-Value TO rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-INITEND.
           IF DataSet1-rmovmag-KEY-Asc
              MOVE High-Value TO rmo-chiave OF rmovmag
           ELSE
              MOVE Low-Value TO rmo-chiave OF rmovmag
           END-IF
           .

      * rmovmag
       DataSet1-rmovmag-START.
           IF DataSet1-rmovmag-KEY-Asc
              START rmovmag KEY >= rmo-chiave OF rmovmag
           ELSE
              START rmovmag KEY <= rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-START-NOTGREATER.
           IF DataSet1-rmovmag-KEY-Asc
              START rmovmag KEY <= rmo-chiave OF rmovmag
           ELSE
              START rmovmag KEY >= rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-START-GREATER.
           IF DataSet1-rmovmag-KEY-Asc
              START rmovmag KEY > rmo-chiave OF rmovmag
           ELSE
              START rmovmag KEY < rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-START-LESS.
           IF DataSet1-rmovmag-KEY-Asc
              START rmovmag KEY < rmo-chiave OF rmovmag
           ELSE
              START rmovmag KEY > rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rmovmag-LOCK
              READ rmovmag WITH LOCK 
              KEY rmo-chiave OF rmovmag
           ELSE
              READ rmovmag WITH NO LOCK 
              KEY rmo-chiave OF rmovmag
           END-IF
           PERFORM rmovmag-k-articolo-MERGE-SPLITBUF
           PERFORM rmovmag-rmo-chiave-ricerca-MERGE-SPLITBUF
           PERFORM rmovmag-k-progmag-MERGE-SPLITBUF
           PERFORM rmovmag-k-art-data-MERGE-SPLITBUF
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT 
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rmovmag-KEY-Asc
              IF DataSet1-rmovmag-LOCK
                 READ rmovmag NEXT WITH LOCK
              ELSE
                 READ rmovmag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rmovmag-LOCK
                 READ rmovmag PREVIOUS WITH LOCK
              ELSE
                 READ rmovmag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rmovmag-k-articolo-MERGE-SPLITBUF
           PERFORM rmovmag-rmo-chiave-ricerca-MERGE-SPLITBUF
           PERFORM rmovmag-k-progmag-MERGE-SPLITBUF
           PERFORM rmovmag-k-art-data-MERGE-SPLITBUF
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rmovmag-KEY-Asc
              IF DataSet1-rmovmag-LOCK
                 READ rmovmag PREVIOUS WITH LOCK
              ELSE
                 READ rmovmag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rmovmag-LOCK
                 READ rmovmag NEXT WITH LOCK
              ELSE
                 READ rmovmag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rmovmag-k-articolo-MERGE-SPLITBUF
           PERFORM rmovmag-rmo-chiave-ricerca-MERGE-SPLITBUF
           PERFORM rmovmag-k-progmag-MERGE-SPLITBUF
           PERFORM rmovmag-k-art-data-MERGE-SPLITBUF
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterDelete>
      * <TOTEM:END>
           .

       rordini-ror-k-promo-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-promo-SPLITBUF
           MOVE ror-promo OF rordini(1:15) TO 
           rordini-ror-k-promo-SPLITBUF(1:15)
           .

       rordini-ror-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-articolo-SPLITBUF
           MOVE ror-cod-articolo OF rordini(1:6) TO 
           rordini-ror-k-articolo-SPLITBUF(1:6)
           MOVE ror-chiave OF rordini(1:17) TO 
           rordini-ror-k-articolo-SPLITBUF(7:17)
           .

       rordini-ror-k-master-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-master-SPLITBUF
           MOVE ror-chiave-ordine OF rordini(1:17) TO 
           rordini-ror-k-master-SPLITBUF(1:17)
           MOVE ror-chiave OF rordini(1:17) TO 
           rordini-ror-k-master-SPLITBUF(18:17)
           .

       rordini-ror-k-stbolle-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-stbolle-SPLITBUF
           MOVE ror-anno OF rordini(1:4) TO 
           rordini-ror-k-stbolle-SPLITBUF(1:4)
           MOVE ror-num-ordine OF rordini(1:8) TO 
           rordini-ror-k-stbolle-SPLITBUF(5:8)
           MOVE ror-chiave-ordine OF rordini(1:17) TO 
           rordini-ror-k-stbolle-SPLITBUF(13:17)
           .

       rordini-ror-k-ord-art-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-ord-art-SPLITBUF
           MOVE ror-anno OF rordini(1:4) TO 
           rordini-ror-k-ord-art-SPLITBUF(1:4)
           MOVE ror-num-ordine OF rordini(1:8) TO 
           rordini-ror-k-ord-art-SPLITBUF(5:8)
           MOVE ror-cod-articolo OF rordini(1:6) TO 
           rordini-ror-k-ord-art-SPLITBUF(13:6)
           .

       DataSet1-rordini-INITSTART.
           IF DataSet1-rordini-KEY-Asc
              MOVE Low-Value TO ror-chiave of rordini
           ELSE
              MOVE High-Value TO ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-INITEND.
           IF DataSet1-rordini-KEY-Asc
              MOVE High-Value TO ror-chiave of rordini
           ELSE
              MOVE Low-Value TO ror-chiave of rordini
           END-IF
           .

      * rordini
       DataSet1-rordini-START.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY >= ror-chiave of rordini
           ELSE
              START rordini KEY <= ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-START-NOTGREATER.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY <= ror-chiave of rordini
           ELSE
              START rordini KEY >= ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-START-GREATER.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY > ror-chiave of rordini
           ELSE
              START rordini KEY < ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-START-LESS.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY < ror-chiave of rordini
           ELSE
              START rordini KEY > ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rordini-LOCK
              READ rordini WITH LOCK 
              KEY ror-chiave of rordini
           ELSE
              READ rordini WITH NO LOCK 
              KEY ror-chiave of rordini
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           PERFORM rordini-ror-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT 
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rordini-KEY-Asc
              IF DataSet1-rordini-LOCK
                 READ rordini NEXT WITH LOCK
              ELSE
                 READ rordini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordini-LOCK
                 READ rordini PREVIOUS WITH LOCK
              ELSE
                 READ rordini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           PERFORM rordini-ror-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rordini-KEY-Asc
              IF DataSet1-rordini-LOCK
                 READ rordini PREVIOUS WITH LOCK
              ELSE
                 READ rordini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordini-LOCK
                 READ rordini NEXT WITH LOCK
              ELSE
                 READ rordini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           PERFORM rordini-ror-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterDelete>
      * <TOTEM:END>
           .

       rnotacr-rno-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rnotacr-rno-k-articolo-SPLITBUF
           MOVE rno-cod-articolo(1:6) TO 
           rnotacr-rno-k-articolo-SPLITBUF(1:6)
           MOVE rno-chiave(1:17) TO 
           rnotacr-rno-k-articolo-SPLITBUF(7:17)
           .

       DataSet1-rnotacr-INITSTART.
           IF DataSet1-rnotacr-KEY-Asc
              MOVE Low-Value TO rno-chiave
           ELSE
              MOVE High-Value TO rno-chiave
           END-IF
           .

       DataSet1-rnotacr-INITEND.
           IF DataSet1-rnotacr-KEY-Asc
              MOVE High-Value TO rno-chiave
           ELSE
              MOVE Low-Value TO rno-chiave
           END-IF
           .

      * rnotacr
       DataSet1-rnotacr-START.
           IF DataSet1-rnotacr-KEY-Asc
              START rnotacr KEY >= rno-chiave
           ELSE
              START rnotacr KEY <= rno-chiave
           END-IF
           .

       DataSet1-rnotacr-START-NOTGREATER.
           IF DataSet1-rnotacr-KEY-Asc
              START rnotacr KEY <= rno-chiave
           ELSE
              START rnotacr KEY >= rno-chiave
           END-IF
           .

       DataSet1-rnotacr-START-GREATER.
           IF DataSet1-rnotacr-KEY-Asc
              START rnotacr KEY > rno-chiave
           ELSE
              START rnotacr KEY < rno-chiave
           END-IF
           .

       DataSet1-rnotacr-START-LESS.
           IF DataSet1-rnotacr-KEY-Asc
              START rnotacr KEY < rno-chiave
           ELSE
              START rnotacr KEY > rno-chiave
           END-IF
           .

       DataSet1-rnotacr-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rnotacr-LOCK
              READ rnotacr WITH LOCK 
              KEY rno-chiave
           ELSE
              READ rnotacr WITH NO LOCK 
              KEY rno-chiave
           END-IF
           PERFORM rnotacr-rno-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-rnotacr TO TOTEM-ERR-STAT 
           MOVE "rnotacr" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rnotacr-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rnotacr-KEY-Asc
              IF DataSet1-rnotacr-LOCK
                 READ rnotacr NEXT WITH LOCK
              ELSE
                 READ rnotacr NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rnotacr-LOCK
                 READ rnotacr PREVIOUS WITH LOCK
              ELSE
                 READ rnotacr PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rnotacr-rno-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-rnotacr TO TOTEM-ERR-STAT
           MOVE "rnotacr" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rnotacr-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rnotacr-KEY-Asc
              IF DataSet1-rnotacr-LOCK
                 READ rnotacr PREVIOUS WITH LOCK
              ELSE
                 READ rnotacr PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rnotacr-LOCK
                 READ rnotacr NEXT WITH LOCK
              ELSE
                 READ rnotacr NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rnotacr-rno-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-rnotacr TO TOTEM-ERR-STAT
           MOVE "rnotacr" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rnotacr-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rnotacr TO TOTEM-ERR-STAT
           MOVE "rnotacr" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rnotacr-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rnotacr TO TOTEM-ERR-STAT
           MOVE "rnotacr" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rnotacr-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rnotacr TO TOTEM-ERR-STAT
           MOVE "rnotacr" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rnotacr, AfterDelete>
      * <TOTEM:END>
           .

       brnotacr-brno-k-articolo-MERGE-SPLITBUF.
           INITIALIZE brnotacr-brno-k-articolo-SPLITBUF
           MOVE brno-cod-articolo(1:6) TO 
           brnotacr-brno-k-articolo-SPLITBUF(1:6)
           MOVE brno-chiave(1:18) TO 
           brnotacr-brno-k-articolo-SPLITBUF(7:18)
           .

       DataSet1-brnotacr-INITSTART.
           IF DataSet1-brnotacr-KEY-Asc
              MOVE Low-Value TO brno-chiave
           ELSE
              MOVE High-Value TO brno-chiave
           END-IF
           .

       DataSet1-brnotacr-INITEND.
           IF DataSet1-brnotacr-KEY-Asc
              MOVE High-Value TO brno-chiave
           ELSE
              MOVE Low-Value TO brno-chiave
           END-IF
           .

      * brnotacr
       DataSet1-brnotacr-START.
           IF DataSet1-brnotacr-KEY-Asc
              START brnotacr KEY >= brno-chiave
           ELSE
              START brnotacr KEY <= brno-chiave
           END-IF
           .

       DataSet1-brnotacr-START-NOTGREATER.
           IF DataSet1-brnotacr-KEY-Asc
              START brnotacr KEY <= brno-chiave
           ELSE
              START brnotacr KEY >= brno-chiave
           END-IF
           .

       DataSet1-brnotacr-START-GREATER.
           IF DataSet1-brnotacr-KEY-Asc
              START brnotacr KEY > brno-chiave
           ELSE
              START brnotacr KEY < brno-chiave
           END-IF
           .

       DataSet1-brnotacr-START-LESS.
           IF DataSet1-brnotacr-KEY-Asc
              START brnotacr KEY < brno-chiave
           ELSE
              START brnotacr KEY > brno-chiave
           END-IF
           .

       DataSet1-brnotacr-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-brnotacr-LOCK
              READ brnotacr WITH LOCK 
              KEY brno-chiave
           ELSE
              READ brnotacr WITH NO LOCK 
              KEY brno-chiave
           END-IF
           PERFORM brnotacr-brno-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT 
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-brnotacr-KEY-Asc
              IF DataSet1-brnotacr-LOCK
                 READ brnotacr NEXT WITH LOCK
              ELSE
                 READ brnotacr NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-brnotacr-LOCK
                 READ brnotacr PREVIOUS WITH LOCK
              ELSE
                 READ brnotacr PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM brnotacr-brno-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-brnotacr-KEY-Asc
              IF DataSet1-brnotacr-LOCK
                 READ brnotacr PREVIOUS WITH LOCK
              ELSE
                 READ brnotacr PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-brnotacr-LOCK
                 READ brnotacr NEXT WITH LOCK
              ELSE
                 READ brnotacr NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM brnotacr-brno-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tscorte-INITSTART.
           IF DataSet1-tscorte-KEY-Asc
              MOVE Low-Value TO sco-chiave
           ELSE
              MOVE High-Value TO sco-chiave
           END-IF
           .

       DataSet1-tscorte-INITEND.
           IF DataSet1-tscorte-KEY-Asc
              MOVE High-Value TO sco-chiave
           ELSE
              MOVE Low-Value TO sco-chiave
           END-IF
           .

      * tscorte
       DataSet1-tscorte-START.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY >= sco-chiave
           ELSE
              START tscorte KEY <= sco-chiave
           END-IF
           .

       DataSet1-tscorte-START-NOTGREATER.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY <= sco-chiave
           ELSE
              START tscorte KEY >= sco-chiave
           END-IF
           .

       DataSet1-tscorte-START-GREATER.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY > sco-chiave
           ELSE
              START tscorte KEY < sco-chiave
           END-IF
           .

       DataSet1-tscorte-START-LESS.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY < sco-chiave
           ELSE
              START tscorte KEY > sco-chiave
           END-IF
           .

       DataSet1-tscorte-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tscorte-LOCK
              READ tscorte WITH LOCK 
              KEY sco-chiave
           ELSE
              READ tscorte WITH NO LOCK 
              KEY sco-chiave
           END-IF
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT 
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tscorte-KEY-Asc
              IF DataSet1-tscorte-LOCK
                 READ tscorte NEXT WITH LOCK
              ELSE
                 READ tscorte NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tscorte-LOCK
                 READ tscorte PREVIOUS WITH LOCK
              ELSE
                 READ tscorte PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tscorte-KEY-Asc
              IF DataSet1-tscorte-LOCK
                 READ tscorte PREVIOUS WITH LOCK
              ELSE
                 READ tscorte PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tscorte-LOCK
                 READ tscorte NEXT WITH LOCK
              ELSE
                 READ tscorte NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterDelete>
      * <TOTEM:END>
           .

       rlistini-rlis-k-art-MERGE-SPLITBUF.
           INITIALIZE rlistini-rlis-k-art-SPLITBUF
           MOVE rlis-articolo OF rlistini(1:6) TO 
           rlistini-rlis-k-art-SPLITBUF(1:6)
           MOVE rlis-chiave-ricerca OF rlistini(1:26) TO 
           rlistini-rlis-k-art-SPLITBUF(7:26)
           .

       rlistini-rlis-k-descr-MERGE-SPLITBUF.
           INITIALIZE rlistini-rlis-k-descr-SPLITBUF
           MOVE rlis-codice OF rlistini(1:15) TO 
           rlistini-rlis-k-descr-SPLITBUF(1:15)
           MOVE rlis-des-libera OF rlistini(1:50) TO 
           rlistini-rlis-k-descr-SPLITBUF(16:50)
           .

       DataSet1-rlistini-INITSTART.
           IF DataSet1-rlistini-KEY-Asc
              MOVE Low-Value TO rlis-chiave OF rlistini
           ELSE
              MOVE High-Value TO rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-INITEND.
           IF DataSet1-rlistini-KEY-Asc
              MOVE High-Value TO rlis-chiave OF rlistini
           ELSE
              MOVE Low-Value TO rlis-chiave OF rlistini
           END-IF
           .

      * rlistini
       DataSet1-rlistini-START.
           IF DataSet1-rlistini-KEY-Asc
              START rlistini KEY >= rlis-chiave OF rlistini
           ELSE
              START rlistini KEY <= rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-START-NOTGREATER.
           IF DataSet1-rlistini-KEY-Asc
              START rlistini KEY <= rlis-chiave OF rlistini
           ELSE
              START rlistini KEY >= rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-START-GREATER.
           IF DataSet1-rlistini-KEY-Asc
              START rlistini KEY > rlis-chiave OF rlistini
           ELSE
              START rlistini KEY < rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-START-LESS.
           IF DataSet1-rlistini-KEY-Asc
              START rlistini KEY < rlis-chiave OF rlistini
           ELSE
              START rlistini KEY > rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rlistini-LOCK
              READ rlistini WITH LOCK 
              KEY rlis-chiave OF rlistini
           ELSE
              READ rlistini WITH NO LOCK 
              KEY rlis-chiave OF rlistini
           END-IF
           PERFORM rlistini-rlis-k-art-MERGE-SPLITBUF
           PERFORM rlistini-rlis-k-descr-MERGE-SPLITBUF
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT 
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rlistini-KEY-Asc
              IF DataSet1-rlistini-LOCK
                 READ rlistini NEXT WITH LOCK
              ELSE
                 READ rlistini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rlistini-LOCK
                 READ rlistini PREVIOUS WITH LOCK
              ELSE
                 READ rlistini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rlistini-rlis-k-art-MERGE-SPLITBUF
           PERFORM rlistini-rlis-k-descr-MERGE-SPLITBUF
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rlistini-KEY-Asc
              IF DataSet1-rlistini-LOCK
                 READ rlistini PREVIOUS WITH LOCK
              ELSE
                 READ rlistini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rlistini-LOCK
                 READ rlistini NEXT WITH LOCK
              ELSE
                 READ rlistini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rlistini-rlis-k-art-MERGE-SPLITBUF
           PERFORM rlistini-rlis-k-descr-MERGE-SPLITBUF
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterDelete>
      * <TOTEM:END>
           .

       destinif-K1-MERGE-SPLITBUF.
           INITIALIZE destinif-K1-SPLITBUF
           MOVE desf-ragsoc-1(1:40) TO destinif-K1-SPLITBUF(1:40)
           MOVE desf-codice(1:5) TO destinif-K1-SPLITBUF(41:5)
           MOVE desf-prog(1:5) TO destinif-K1-SPLITBUF(46:5)
           .

       destinif-desf-k2-MERGE-SPLITBUF.
           INITIALIZE destinif-desf-k2-SPLITBUF
           MOVE desf-codice(1:5) TO destinif-desf-k2-SPLITBUF(1:5)
           MOVE desf-ragsoc-1(1:40) TO destinif-desf-k2-SPLITBUF(6:40)
           MOVE desf-prog(1:5) TO destinif-desf-k2-SPLITBUF(46:5)
           .

       DataSet1-destinif-INITSTART.
           IF DataSet1-destinif-KEY-Asc
              MOVE Low-Value TO desf-chiave
           ELSE
              MOVE High-Value TO desf-chiave
           END-IF
           .

       DataSet1-destinif-INITEND.
           IF DataSet1-destinif-KEY-Asc
              MOVE High-Value TO desf-chiave
           ELSE
              MOVE Low-Value TO desf-chiave
           END-IF
           .

      * destinif
       DataSet1-destinif-START.
           IF DataSet1-destinif-KEY-Asc
              START destinif KEY >= desf-chiave
           ELSE
              START destinif KEY <= desf-chiave
           END-IF
           .

       DataSet1-destinif-START-NOTGREATER.
           IF DataSet1-destinif-KEY-Asc
              START destinif KEY <= desf-chiave
           ELSE
              START destinif KEY >= desf-chiave
           END-IF
           .

       DataSet1-destinif-START-GREATER.
           IF DataSet1-destinif-KEY-Asc
              START destinif KEY > desf-chiave
           ELSE
              START destinif KEY < desf-chiave
           END-IF
           .

       DataSet1-destinif-START-LESS.
           IF DataSet1-destinif-KEY-Asc
              START destinif KEY < desf-chiave
           ELSE
              START destinif KEY > desf-chiave
           END-IF
           .

       DataSet1-destinif-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-destinif-LOCK
              READ destinif WITH LOCK 
              KEY desf-chiave
           ELSE
              READ destinif WITH NO LOCK 
              KEY desf-chiave
           END-IF
           PERFORM destinif-K1-MERGE-SPLITBUF
           PERFORM destinif-desf-k2-MERGE-SPLITBUF
           MOVE STATUS-destinif TO TOTEM-ERR-STAT 
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-destinif-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-destinif-KEY-Asc
              IF DataSet1-destinif-LOCK
                 READ destinif NEXT WITH LOCK
              ELSE
                 READ destinif NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destinif-LOCK
                 READ destinif PREVIOUS WITH LOCK
              ELSE
                 READ destinif PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM destinif-K1-MERGE-SPLITBUF
           PERFORM destinif-desf-k2-MERGE-SPLITBUF
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-destinif-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-destinif-KEY-Asc
              IF DataSet1-destinif-LOCK
                 READ destinif PREVIOUS WITH LOCK
              ELSE
                 READ destinif PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destinif-LOCK
                 READ destinif NEXT WITH LOCK
              ELSE
                 READ destinif NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM destinif-K1-MERGE-SPLITBUF
           PERFORM destinif-desf-k2-MERGE-SPLITBUF
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-destinif-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-destinif-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-destinif-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterDelete>
      * <TOTEM:END>
           .

       articoli1-art-k1-MERGE-SPLITBUF.
           INITIALIZE articoli1-art-k1-SPLITBUF
           MOVE art-descrizione OF articoli(1:50) TO 
           articoli1-art-k1-SPLITBUF(1:50)
           .

       articoli1-art-k-frn-MERGE-SPLITBUF.
           INITIALIZE articoli1-art-k-frn-SPLITBUF
           MOVE art-cod-art-frn OF articoli(1:15) TO 
           articoli1-art-k-frn-SPLITBUF(1:15)
           .

       DataSet1-articoli1-INITSTART.
           IF DataSet1-articoli1-KEY-Asc
              MOVE Low-Value TO art-chiave OF articoli1
           ELSE
              MOVE High-Value TO art-chiave OF articoli1
           END-IF
           .

       DataSet1-articoli1-INITEND.
           IF DataSet1-articoli1-KEY-Asc
              MOVE High-Value TO art-chiave OF articoli1
           ELSE
              MOVE Low-Value TO art-chiave OF articoli1
           END-IF
           .

      * articoli1
       DataSet1-articoli1-START.
           IF DataSet1-articoli1-KEY-Asc
              START articoli1 KEY >= art-chiave OF articoli1
           ELSE
              START articoli1 KEY <= art-chiave OF articoli1
           END-IF
           .

       DataSet1-articoli1-START-NOTGREATER.
           IF DataSet1-articoli1-KEY-Asc
              START articoli1 KEY <= art-chiave OF articoli1
           ELSE
              START articoli1 KEY >= art-chiave OF articoli1
           END-IF
           .

       DataSet1-articoli1-START-GREATER.
           IF DataSet1-articoli1-KEY-Asc
              START articoli1 KEY > art-chiave OF articoli1
           ELSE
              START articoli1 KEY < art-chiave OF articoli1
           END-IF
           .

       DataSet1-articoli1-START-LESS.
           IF DataSet1-articoli1-KEY-Asc
              START articoli1 KEY < art-chiave OF articoli1
           ELSE
              START articoli1 KEY > art-chiave OF articoli1
           END-IF
           .

       DataSet1-articoli1-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-articoli1-LOCK
              READ articoli1 WITH LOCK 
              KEY art-chiave OF articoli1
           ELSE
              READ articoli1 WITH NO LOCK 
              KEY art-chiave OF articoli1
           END-IF
           PERFORM articoli1-art-k1-MERGE-SPLITBUF
           PERFORM articoli1-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli1 TO TOTEM-ERR-STAT 
           MOVE "articoli1" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-articoli1-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-articoli1-KEY-Asc
              IF DataSet1-articoli1-LOCK
                 READ articoli1 NEXT WITH LOCK
              ELSE
                 READ articoli1 NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli1-LOCK
                 READ articoli1 PREVIOUS WITH LOCK
              ELSE
                 READ articoli1 PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli1-art-k1-MERGE-SPLITBUF
           PERFORM articoli1-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli1 TO TOTEM-ERR-STAT
           MOVE "articoli1" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-articoli1-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-articoli1-KEY-Asc
              IF DataSet1-articoli1-LOCK
                 READ articoli1 PREVIOUS WITH LOCK
              ELSE
                 READ articoli1 PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli1-LOCK
                 READ articoli1 NEXT WITH LOCK
              ELSE
                 READ articoli1 NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli1-art-k1-MERGE-SPLITBUF
           PERFORM articoli1-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli1 TO TOTEM-ERR-STAT
           MOVE "articoli1" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-articoli1-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-articoli1 TO TOTEM-ERR-STAT
           MOVE "articoli1" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-articoli1-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-articoli1 TO TOTEM-ERR-STAT
           MOVE "articoli1" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-articoli1-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-articoli1 TO TOTEM-ERR-STAT
           MOVE "articoli1" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli1, AfterDelete>
      * <TOTEM:END>
           .

       mrordini-mro-k-promo-MERGE-SPLITBUF.
           INITIALIZE mrordini-mro-k-promo-SPLITBUF
           MOVE mro-promo(1:15) TO mrordini-mro-k-promo-SPLITBUF(1:15)
           MOVE mro-chiave(1:17) TO mrordini-mro-k-promo-SPLITBUF(16:17)
           .

       mrordini-mro-k-articolo-MERGE-SPLITBUF.
           INITIALIZE mrordini-mro-k-articolo-SPLITBUF
           MOVE mro-cod-articolo(1:6) TO 
           mrordini-mro-k-articolo-SPLITBUF(1:6)
           MOVE mro-chiave(1:17) TO 
           mrordini-mro-k-articolo-SPLITBUF(7:17)
           .

       mrordini-mro-k-progr-MERGE-SPLITBUF.
           INITIALIZE mrordini-mro-k-progr-SPLITBUF
           MOVE mro-chiave-testa(1:12) TO 
           mrordini-mro-k-progr-SPLITBUF(1:12)
           MOVE mro-progr(1:5) TO mrordini-mro-k-progr-SPLITBUF(13:5)
           .

       mrordini-mro-k-tprev-MERGE-SPLITBUF.
           INITIALIZE mrordini-mro-k-tprev-SPLITBUF
           MOVE mro-promo(1:15) TO mrordini-mro-k-tprev-SPLITBUF(1:15)
           MOVE mro-prg-cod-articolo(1:6) TO 
           mrordini-mro-k-tprev-SPLITBUF(16:6)
           MOVE mro-chiave(1:17) TO mrordini-mro-k-tprev-SPLITBUF(22:17)
           .

       mrordini-mro-k-ord-art-MERGE-SPLITBUF.
           INITIALIZE mrordini-mro-k-ord-art-SPLITBUF
           MOVE mro-chiave-testa(1:12) TO 
           mrordini-mro-k-ord-art-SPLITBUF(1:12)
           MOVE mro-cod-articolo(1:6) TO 
           mrordini-mro-k-ord-art-SPLITBUF(13:6)
           .

       DataSet1-mrordini-INITSTART.
           IF DataSet1-mrordini-KEY-Asc
              MOVE Low-Value TO mro-chiave
           ELSE
              MOVE High-Value TO mro-chiave
           END-IF
           .

       DataSet1-mrordini-INITEND.
           IF DataSet1-mrordini-KEY-Asc
              MOVE High-Value TO mro-chiave
           ELSE
              MOVE Low-Value TO mro-chiave
           END-IF
           .

      * mrordini
       DataSet1-mrordini-START.
           IF DataSet1-mrordini-KEY-Asc
              START mrordini KEY >= mro-chiave
           ELSE
              START mrordini KEY <= mro-chiave
           END-IF
           .

       DataSet1-mrordini-START-NOTGREATER.
           IF DataSet1-mrordini-KEY-Asc
              START mrordini KEY <= mro-chiave
           ELSE
              START mrordini KEY >= mro-chiave
           END-IF
           .

       DataSet1-mrordini-START-GREATER.
           IF DataSet1-mrordini-KEY-Asc
              START mrordini KEY > mro-chiave
           ELSE
              START mrordini KEY < mro-chiave
           END-IF
           .

       DataSet1-mrordini-START-LESS.
           IF DataSet1-mrordini-KEY-Asc
              START mrordini KEY < mro-chiave
           ELSE
              START mrordini KEY > mro-chiave
           END-IF
           .

       DataSet1-mrordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-mrordini-LOCK
              READ mrordini WITH LOCK 
              KEY mro-chiave
           ELSE
              READ mrordini WITH NO LOCK 
              KEY mro-chiave
           END-IF
           PERFORM mrordini-mro-k-promo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-articolo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-progr-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-tprev-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT 
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-mrordini-KEY-Asc
              IF DataSet1-mrordini-LOCK
                 READ mrordini NEXT WITH LOCK
              ELSE
                 READ mrordini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-mrordini-LOCK
                 READ mrordini PREVIOUS WITH LOCK
              ELSE
                 READ mrordini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM mrordini-mro-k-promo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-articolo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-progr-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-tprev-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-mrordini-KEY-Asc
              IF DataSet1-mrordini-LOCK
                 READ mrordini PREVIOUS WITH LOCK
              ELSE
                 READ mrordini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-mrordini-LOCK
                 READ mrordini NEXT WITH LOCK
              ELSE
                 READ mrordini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM mrordini-mro-k-promo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-articolo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-progr-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-tprev-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterDelete>
      * <TOTEM:END>
           .

       reva-reva-k-articolo-MERGE-SPLITBUF.
           INITIALIZE reva-reva-k-articolo-SPLITBUF
           MOVE reva-qta OF reva(1:8) TO 
           reva-reva-k-articolo-SPLITBUF(1:8)
           MOVE reva-chiave OF reva(1:17) TO 
           reva-reva-k-articolo-SPLITBUF(9:17)
           .

       DataSet1-reva-INITSTART.
           IF DataSet1-reva-KEY-Asc
              MOVE Low-Value TO reva-chiave
           ELSE
              MOVE High-Value TO reva-chiave
           END-IF
           .

       DataSet1-reva-INITEND.
           IF DataSet1-reva-KEY-Asc
              MOVE High-Value TO reva-chiave
           ELSE
              MOVE Low-Value TO reva-chiave
           END-IF
           .

      * reva
       DataSet1-reva-START.
           IF DataSet1-reva-KEY-Asc
              START reva KEY >= reva-chiave
           ELSE
              START reva KEY <= reva-chiave
           END-IF
           .

       DataSet1-reva-START-NOTGREATER.
           IF DataSet1-reva-KEY-Asc
              START reva KEY <= reva-chiave
           ELSE
              START reva KEY >= reva-chiave
           END-IF
           .

       DataSet1-reva-START-GREATER.
           IF DataSet1-reva-KEY-Asc
              START reva KEY > reva-chiave
           ELSE
              START reva KEY < reva-chiave
           END-IF
           .

       DataSet1-reva-START-LESS.
           IF DataSet1-reva-KEY-Asc
              START reva KEY < reva-chiave
           ELSE
              START reva KEY > reva-chiave
           END-IF
           .

       DataSet1-reva-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:reva, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:reva, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-reva-LOCK
              READ reva WITH LOCK 
              KEY reva-chiave
           ELSE
              READ reva WITH NO LOCK 
              KEY reva-chiave
           END-IF
           PERFORM reva-reva-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-reva TO TOTEM-ERR-STAT 
           MOVE "reva" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:reva, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:reva, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-reva-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:reva, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:reva, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-reva-KEY-Asc
              IF DataSet1-reva-LOCK
                 READ reva NEXT WITH LOCK
              ELSE
                 READ reva NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-reva-LOCK
                 READ reva PREVIOUS WITH LOCK
              ELSE
                 READ reva PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM reva-reva-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-reva TO TOTEM-ERR-STAT
           MOVE "reva" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:reva, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:reva, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-reva-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:reva, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:reva, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-reva-KEY-Asc
              IF DataSet1-reva-LOCK
                 READ reva PREVIOUS WITH LOCK
              ELSE
                 READ reva PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-reva-LOCK
                 READ reva NEXT WITH LOCK
              ELSE
                 READ reva NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM reva-reva-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-reva TO TOTEM-ERR-STAT
           MOVE "reva" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:reva, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:reva, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-reva-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:reva, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-reva TO TOTEM-ERR-STAT
           MOVE "reva" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:reva, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-reva-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:reva, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-reva TO TOTEM-ERR-STAT
           MOVE "reva" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:reva, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-reva-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:reva, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-reva TO TOTEM-ERR-STAT
           MOVE "reva" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:reva, AfterDelete>
      * <TOTEM:END>
           .

       rordforn-rof-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rordforn-rof-k-articolo-SPLITBUF
           MOVE rof-cod-articolo OF rordforn(1:6) TO 
           rordforn-rof-k-articolo-SPLITBUF(1:6)
           MOVE rof-chiave OF rordforn(1:17) TO 
           rordforn-rof-k-articolo-SPLITBUF(7:17)
           .

       rordforn-rof-k-art-mag-MERGE-SPLITBUF.
           INITIALIZE rordforn-rof-k-art-mag-SPLITBUF
           MOVE rof-cod-articolo OF rordforn(1:6) TO 
           rordforn-rof-k-art-mag-SPLITBUF(1:6)
           MOVE rof-cod-magazzino OF rordforn(1:3) TO 
           rordforn-rof-k-art-mag-SPLITBUF(7:3)
           MOVE rof-chiave OF rordforn(1:17) TO 
           rordforn-rof-k-art-mag-SPLITBUF(10:17)
           .

       DataSet1-rordforn-INITSTART.
           IF DataSet1-rordforn-KEY-Asc
              MOVE Low-Value TO rof-chiave OF rordforn
           ELSE
              MOVE High-Value TO rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-INITEND.
           IF DataSet1-rordforn-KEY-Asc
              MOVE High-Value TO rof-chiave OF rordforn
           ELSE
              MOVE Low-Value TO rof-chiave OF rordforn
           END-IF
           .

      * rordforn
       DataSet1-rordforn-START.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY >= rof-chiave OF rordforn
           ELSE
              START rordforn KEY <= rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-START-NOTGREATER.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY <= rof-chiave OF rordforn
           ELSE
              START rordforn KEY >= rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-START-GREATER.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY > rof-chiave OF rordforn
           ELSE
              START rordforn KEY < rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-START-LESS.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY < rof-chiave OF rordforn
           ELSE
              START rordforn KEY > rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rordforn-LOCK
              READ rordforn WITH LOCK 
              KEY rof-chiave OF rordforn
           ELSE
              READ rordforn WITH NO LOCK 
              KEY rof-chiave OF rordforn
           END-IF
           PERFORM rordforn-rof-k-articolo-MERGE-SPLITBUF
           PERFORM rordforn-rof-k-art-mag-MERGE-SPLITBUF
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT 
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rordforn-KEY-Asc
              IF DataSet1-rordforn-LOCK
                 READ rordforn NEXT WITH LOCK
              ELSE
                 READ rordforn NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordforn-LOCK
                 READ rordforn PREVIOUS WITH LOCK
              ELSE
                 READ rordforn PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordforn-rof-k-articolo-MERGE-SPLITBUF
           PERFORM rordforn-rof-k-art-mag-MERGE-SPLITBUF
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rordforn-KEY-Asc
              IF DataSet1-rordforn-LOCK
                 READ rordforn PREVIOUS WITH LOCK
              ELSE
                 READ rordforn PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordforn-LOCK
                 READ rordforn NEXT WITH LOCK
              ELSE
                 READ rordforn NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordforn-rof-k-articolo-MERGE-SPLITBUF
           PERFORM rordforn-rof-k-art-mag-MERGE-SPLITBUF
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-sort-art-list-INITSTART.
           .

       DataSet1-sort-art-list-INITEND.
           .

       DataSet1-sort-art-list-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-sort-art-list-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-sort-art-list-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-sort-art-list-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-sort-art-list TO TOTEM-ERR-STAT
           MOVE "sort-art-list" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-sort-art-list-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-sort-art-list TO TOTEM-ERR-STAT
           MOVE "sort-art-list" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-sort-art-list-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-sort-art-list TO TOTEM-ERR-STAT
           MOVE "sort-art-list" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:sort-art-list, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timposte-INITSTART.
           IF DataSet1-timposte-KEY-Asc
              MOVE Low-Value TO imp-chiave
           ELSE
              MOVE High-Value TO imp-chiave
           END-IF
           .

       DataSet1-timposte-INITEND.
           IF DataSet1-timposte-KEY-Asc
              MOVE High-Value TO imp-chiave
           ELSE
              MOVE Low-Value TO imp-chiave
           END-IF
           .

      * timposte
       DataSet1-timposte-START.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY >= imp-chiave
           ELSE
              START timposte KEY <= imp-chiave
           END-IF
           .

       DataSet1-timposte-START-NOTGREATER.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY <= imp-chiave
           ELSE
              START timposte KEY >= imp-chiave
           END-IF
           .

       DataSet1-timposte-START-GREATER.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY > imp-chiave
           ELSE
              START timposte KEY < imp-chiave
           END-IF
           .

       DataSet1-timposte-START-LESS.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY < imp-chiave
           ELSE
              START timposte KEY > imp-chiave
           END-IF
           .

       DataSet1-timposte-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timposte-LOCK
              READ timposte WITH LOCK 
              KEY imp-chiave
           ELSE
              READ timposte WITH NO LOCK 
              KEY imp-chiave
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT 
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timposte-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timposte-KEY-Asc
              IF DataSet1-timposte-LOCK
                 READ timposte NEXT WITH LOCK
              ELSE
                 READ timposte NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timposte-LOCK
                 READ timposte PREVIOUS WITH LOCK
              ELSE
                 READ timposte PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timposte-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timposte-KEY-Asc
              IF DataSet1-timposte-LOCK
                 READ timposte PREVIOUS WITH LOCK
              ELSE
                 READ timposte PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timposte-LOCK
                 READ timposte NEXT WITH LOCK
              ELSE
                 READ timposte NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-INITSTART.
           IF DataSet1-tpiombo-KEY-Asc
              MOVE Low-Value TO tpb-chiave
           ELSE
              MOVE High-Value TO tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-INITEND.
           IF DataSet1-tpiombo-KEY-Asc
              MOVE High-Value TO tpb-chiave
           ELSE
              MOVE Low-Value TO tpb-chiave
           END-IF
           .

      * tpiombo
       DataSet1-tpiombo-START.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY >= tpb-chiave
           ELSE
              START tpiombo KEY <= tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-NOTGREATER.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY <= tpb-chiave
           ELSE
              START tpiombo KEY >= tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-GREATER.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY > tpb-chiave
           ELSE
              START tpiombo KEY < tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-LESS.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY < tpb-chiave
           ELSE
              START tpiombo KEY > tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tpiombo-LOCK
              READ tpiombo WITH LOCK 
              KEY tpb-chiave
           ELSE
              READ tpiombo WITH NO LOCK 
              KEY tpb-chiave
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT 
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tpiombo-KEY-Asc
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo NEXT WITH LOCK
              ELSE
                 READ tpiombo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo PREVIOUS WITH LOCK
              ELSE
                 READ tpiombo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tpiombo-KEY-Asc
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo PREVIOUS WITH LOCK
              ELSE
                 READ tpiombo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo NEXT WITH LOCK
              ELSE
                 READ tpiombo NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tlistini-INITSTART.
           IF DataSet1-tlistini-KEY-Asc
              MOVE Low-Value TO tlis-chiave OF tlistini
           ELSE
              MOVE High-Value TO tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-INITEND.
           IF DataSet1-tlistini-KEY-Asc
              MOVE High-Value TO tlis-chiave OF tlistini
           ELSE
              MOVE Low-Value TO tlis-chiave OF tlistini
           END-IF
           .

      * tlistini
       DataSet1-tlistini-START.
           IF DataSet1-tlistini-KEY-Asc
              START tlistini KEY >= tlis-chiave OF tlistini
           ELSE
              START tlistini KEY <= tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-START-NOTGREATER.
           IF DataSet1-tlistini-KEY-Asc
              START tlistini KEY <= tlis-chiave OF tlistini
           ELSE
              START tlistini KEY >= tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-START-GREATER.
           IF DataSet1-tlistini-KEY-Asc
              START tlistini KEY > tlis-chiave OF tlistini
           ELSE
              START tlistini KEY < tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-START-LESS.
           IF DataSet1-tlistini-KEY-Asc
              START tlistini KEY < tlis-chiave OF tlistini
           ELSE
              START tlistini KEY > tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tlistini-LOCK
              READ tlistini WITH LOCK 
              KEY tlis-chiave OF tlistini
           ELSE
              READ tlistini WITH NO LOCK 
              KEY tlis-chiave OF tlistini
           END-IF
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT 
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tlistini-KEY-Asc
              IF DataSet1-tlistini-LOCK
                 READ tlistini NEXT WITH LOCK
              ELSE
                 READ tlistini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tlistini-LOCK
                 READ tlistini PREVIOUS WITH LOCK
              ELSE
                 READ tlistini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tlistini-KEY-Asc
              IF DataSet1-tlistini-LOCK
                 READ tlistini PREVIOUS WITH LOCK
              ELSE
                 READ tlistini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tlistini-LOCK
                 READ tlistini NEXT WITH LOCK
              ELSE
                 READ tlistini NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterDelete>
      * <TOTEM:END>
           .

       prodener-pen-k-nc-MERGE-SPLITBUF.
           INITIALIZE prodener-pen-k-nc-SPLITBUF
           MOVE pen-nc OF prodener(1:8) TO 
           prodener-pen-k-nc-SPLITBUF(1:8)
           MOVE pen-cpa OF prodener(1:4) TO 
           prodener-pen-k-nc-SPLITBUF(9:4)
           MOVE pen-taric OF prodener(1:2) TO 
           prodener-pen-k-nc-SPLITBUF(13:2)
           MOVE pen-dac OF prodener(1:4) TO 
           prodener-pen-k-nc-SPLITBUF(15:4)
           .

       DataSet1-prodener-INITSTART.
           IF DataSet1-prodener-KEY-Asc
              MOVE Low-Value TO pen-chiave OF prodener
           ELSE
              MOVE High-Value TO pen-chiave OF prodener
           END-IF
           .

       DataSet1-prodener-INITEND.
           IF DataSet1-prodener-KEY-Asc
              MOVE High-Value TO pen-chiave OF prodener
           ELSE
              MOVE Low-Value TO pen-chiave OF prodener
           END-IF
           .

      * prodener
       DataSet1-prodener-START.
           IF DataSet1-prodener-KEY-Asc
              START prodener KEY >= pen-chiave OF prodener
           ELSE
              START prodener KEY <= pen-chiave OF prodener
           END-IF
           .

       DataSet1-prodener-START-NOTGREATER.
           IF DataSet1-prodener-KEY-Asc
              START prodener KEY <= pen-chiave OF prodener
           ELSE
              START prodener KEY >= pen-chiave OF prodener
           END-IF
           .

       DataSet1-prodener-START-GREATER.
           IF DataSet1-prodener-KEY-Asc
              START prodener KEY > pen-chiave OF prodener
           ELSE
              START prodener KEY < pen-chiave OF prodener
           END-IF
           .

       DataSet1-prodener-START-LESS.
           IF DataSet1-prodener-KEY-Asc
              START prodener KEY < pen-chiave OF prodener
           ELSE
              START prodener KEY > pen-chiave OF prodener
           END-IF
           .

       DataSet1-prodener-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-prodener-LOCK
              READ prodener WITH LOCK 
              KEY pen-chiave OF prodener
           ELSE
              READ prodener WITH NO LOCK 
              KEY pen-chiave OF prodener
           END-IF
           PERFORM prodener-pen-k-nc-MERGE-SPLITBUF
           MOVE STATUS-prodener TO TOTEM-ERR-STAT 
           MOVE "prodener" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-prodener-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-prodener-KEY-Asc
              IF DataSet1-prodener-LOCK
                 READ prodener NEXT WITH LOCK
              ELSE
                 READ prodener NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-prodener-LOCK
                 READ prodener PREVIOUS WITH LOCK
              ELSE
                 READ prodener PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM prodener-pen-k-nc-MERGE-SPLITBUF
           MOVE STATUS-prodener TO TOTEM-ERR-STAT
           MOVE "prodener" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-prodener-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-prodener-KEY-Asc
              IF DataSet1-prodener-LOCK
                 READ prodener PREVIOUS WITH LOCK
              ELSE
                 READ prodener PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-prodener-LOCK
                 READ prodener NEXT WITH LOCK
              ELSE
                 READ prodener NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM prodener-pen-k-nc-MERGE-SPLITBUF
           MOVE STATUS-prodener TO TOTEM-ERR-STAT
           MOVE "prodener" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-prodener-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-prodener TO TOTEM-ERR-STAT
           MOVE "prodener" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-prodener-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-prodener TO TOTEM-ERR-STAT
           MOVE "prodener" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-prodener-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-prodener TO TOTEM-ERR-STAT
           MOVE "prodener" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:prodener, AfterDelete>
      * <TOTEM:END>
           .

       blister-k-magaz-MERGE-SPLITBUF.
           INITIALIZE blister-k-magaz-SPLITBUF
           MOVE bli-magazzino(1:3) TO blister-k-magaz-SPLITBUF(1:3)
           MOVE bli-codice(1:6) TO blister-k-magaz-SPLITBUF(4:6)
           .

       blister-k-des-MERGE-SPLITBUF.
           INITIALIZE blister-k-des-SPLITBUF
           MOVE bli-descrizione(1:50) TO blister-k-des-SPLITBUF(1:50)
           .

       DataSet1-blister-INITSTART.
           IF DataSet1-blister-KEY-Asc
              MOVE Low-Value TO bli-chiave
           ELSE
              MOVE High-Value TO bli-chiave
           END-IF
           .

       DataSet1-blister-INITEND.
           IF DataSet1-blister-KEY-Asc
              MOVE High-Value TO bli-chiave
           ELSE
              MOVE Low-Value TO bli-chiave
           END-IF
           .

      * blister
       DataSet1-blister-START.
           IF DataSet1-blister-KEY-Asc
              START blister KEY >= bli-chiave
           ELSE
              START blister KEY <= bli-chiave
           END-IF
           .

       DataSet1-blister-START-NOTGREATER.
           IF DataSet1-blister-KEY-Asc
              START blister KEY <= bli-chiave
           ELSE
              START blister KEY >= bli-chiave
           END-IF
           .

       DataSet1-blister-START-GREATER.
           IF DataSet1-blister-KEY-Asc
              START blister KEY > bli-chiave
           ELSE
              START blister KEY < bli-chiave
           END-IF
           .

       DataSet1-blister-START-LESS.
           IF DataSet1-blister-KEY-Asc
              START blister KEY < bli-chiave
           ELSE
              START blister KEY > bli-chiave
           END-IF
           .

       DataSet1-blister-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-blister-LOCK
              READ blister WITH LOCK 
              KEY bli-chiave
           ELSE
              READ blister WITH NO LOCK 
              KEY bli-chiave
           END-IF
           PERFORM blister-k-magaz-MERGE-SPLITBUF
           PERFORM blister-k-des-MERGE-SPLITBUF
           MOVE STATUS-blister TO TOTEM-ERR-STAT 
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-blister-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-blister-KEY-Asc
              IF DataSet1-blister-LOCK
                 READ blister NEXT WITH LOCK
              ELSE
                 READ blister NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-blister-LOCK
                 READ blister PREVIOUS WITH LOCK
              ELSE
                 READ blister PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM blister-k-magaz-MERGE-SPLITBUF
           PERFORM blister-k-des-MERGE-SPLITBUF
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-blister-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-blister-KEY-Asc
              IF DataSet1-blister-LOCK
                 READ blister PREVIOUS WITH LOCK
              ELSE
                 READ blister PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-blister-LOCK
                 READ blister NEXT WITH LOCK
              ELSE
                 READ blister NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM blister-k-magaz-MERGE-SPLITBUF
           PERFORM blister-k-des-MERGE-SPLITBUF
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-blister-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-blister-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-blister-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterDelete>
      * <TOTEM:END>
           .

       catart-cat-art-princ-MERGE-SPLITBUF.
           INITIALIZE catart-cat-art-princ-SPLITBUF
           MOVE cat-princ OF catart(1:6) TO 
           catart-cat-art-princ-SPLITBUF(1:6)
           MOVE cat-codice OF catart(1:6) TO 
           catart-cat-art-princ-SPLITBUF(7:6)
           .

       DataSet1-catart-INITSTART.
           IF DataSet1-catart-KEY-Asc
              MOVE Low-Value TO cat-chiave OF catart
           ELSE
              MOVE High-Value TO cat-chiave OF catart
           END-IF
           .

       DataSet1-catart-INITEND.
           IF DataSet1-catart-KEY-Asc
              MOVE High-Value TO cat-chiave OF catart
           ELSE
              MOVE Low-Value TO cat-chiave OF catart
           END-IF
           .

      * catart
       DataSet1-catart-START.
           IF DataSet1-catart-KEY-Asc
              START catart KEY >= cat-chiave OF catart
           ELSE
              START catart KEY <= cat-chiave OF catart
           END-IF
           .

       DataSet1-catart-START-NOTGREATER.
           IF DataSet1-catart-KEY-Asc
              START catart KEY <= cat-chiave OF catart
           ELSE
              START catart KEY >= cat-chiave OF catart
           END-IF
           .

       DataSet1-catart-START-GREATER.
           IF DataSet1-catart-KEY-Asc
              START catart KEY > cat-chiave OF catart
           ELSE
              START catart KEY < cat-chiave OF catart
           END-IF
           .

       DataSet1-catart-START-LESS.
           IF DataSet1-catart-KEY-Asc
              START catart KEY < cat-chiave OF catart
           ELSE
              START catart KEY > cat-chiave OF catart
           END-IF
           .

       DataSet1-catart-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:catart, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:catart, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-catart-LOCK
              READ catart WITH LOCK 
              KEY cat-chiave OF catart
           ELSE
              READ catart WITH NO LOCK 
              KEY cat-chiave OF catart
           END-IF
           PERFORM catart-cat-art-princ-MERGE-SPLITBUF
           MOVE status-catart TO TOTEM-ERR-STAT 
           MOVE "catart" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:catart, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:catart, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-catart-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:catart, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:catart, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-catart-KEY-Asc
              IF DataSet1-catart-LOCK
                 READ catart NEXT WITH LOCK
              ELSE
                 READ catart NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-catart-LOCK
                 READ catart PREVIOUS WITH LOCK
              ELSE
                 READ catart PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM catart-cat-art-princ-MERGE-SPLITBUF
           MOVE status-catart TO TOTEM-ERR-STAT
           MOVE "catart" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:catart, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:catart, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-catart-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:catart, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:catart, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-catart-KEY-Asc
              IF DataSet1-catart-LOCK
                 READ catart PREVIOUS WITH LOCK
              ELSE
                 READ catart PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-catart-LOCK
                 READ catart NEXT WITH LOCK
              ELSE
                 READ catart NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM catart-cat-art-princ-MERGE-SPLITBUF
           MOVE status-catart TO TOTEM-ERR-STAT
           MOVE "catart" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:catart, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:catart, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-catart-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:catart, BeforeWrite>
      * <TOTEM:END>
           MOVE status-catart TO TOTEM-ERR-STAT
           MOVE "catart" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:catart, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-catart-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:catart, BeforeRewrite>
      * <TOTEM:END>
           MOVE status-catart TO TOTEM-ERR-STAT
           MOVE "catart" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:catart, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-catart-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:catart, BeforeDelete>
      * <TOTEM:END>
           MOVE status-catart TO TOTEM-ERR-STAT
           MOVE "catart" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:catart, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-param-INITSTART.
           IF DataSet1-param-KEY-Asc
              MOVE Low-Value TO prm-chiave OF param
           ELSE
              MOVE High-Value TO prm-chiave OF param
           END-IF
           .

       DataSet1-param-INITEND.
           IF DataSet1-param-KEY-Asc
              MOVE High-Value TO prm-chiave OF param
           ELSE
              MOVE Low-Value TO prm-chiave OF param
           END-IF
           .

      * param
       DataSet1-param-START.
           IF DataSet1-param-KEY-Asc
              START param KEY >= prm-chiave OF param
           ELSE
              START param KEY <= prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-NOTGREATER.
           IF DataSet1-param-KEY-Asc
              START param KEY <= prm-chiave OF param
           ELSE
              START param KEY >= prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-GREATER.
           IF DataSet1-param-KEY-Asc
              START param KEY > prm-chiave OF param
           ELSE
              START param KEY < prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-LESS.
           IF DataSet1-param-KEY-Asc
              START param KEY < prm-chiave OF param
           ELSE
              START param KEY > prm-chiave OF param
           END-IF
           .

       DataSet1-param-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-param-LOCK
              READ param WITH LOCK 
              KEY prm-chiave OF param
           ELSE
              READ param WITH NO LOCK 
              KEY prm-chiave OF param
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT 
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-param-KEY-Asc
              IF DataSet1-param-LOCK
                 READ param NEXT WITH LOCK
              ELSE
                 READ param NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param-LOCK
                 READ param PREVIOUS WITH LOCK
              ELSE
                 READ param PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-param-KEY-Asc
              IF DataSet1-param-LOCK
                 READ param PREVIOUS WITH LOCK
              ELSE
                 READ param PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param-LOCK
                 READ param NEXT WITH LOCK
              ELSE
                 READ param NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-impforn-INITSTART.
           IF DataSet1-impforn-KEY-Asc
              MOVE Low-Value TO imf-chiave OF impforn
           ELSE
              MOVE High-Value TO imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-INITEND.
           IF DataSet1-impforn-KEY-Asc
              MOVE High-Value TO imf-chiave OF impforn
           ELSE
              MOVE Low-Value TO imf-chiave OF impforn
           END-IF
           .

      * impforn
       DataSet1-impforn-START.
           IF DataSet1-impforn-KEY-Asc
              START impforn KEY >= imf-chiave OF impforn
           ELSE
              START impforn KEY <= imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-START-NOTGREATER.
           IF DataSet1-impforn-KEY-Asc
              START impforn KEY <= imf-chiave OF impforn
           ELSE
              START impforn KEY >= imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-START-GREATER.
           IF DataSet1-impforn-KEY-Asc
              START impforn KEY > imf-chiave OF impforn
           ELSE
              START impforn KEY < imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-START-LESS.
           IF DataSet1-impforn-KEY-Asc
              START impforn KEY < imf-chiave OF impforn
           ELSE
              START impforn KEY > imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-impforn-LOCK
              READ impforn WITH LOCK 
              KEY imf-chiave OF impforn
           ELSE
              READ impforn WITH NO LOCK 
              KEY imf-chiave OF impforn
           END-IF
           MOVE STATUS-impforn TO TOTEM-ERR-STAT 
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-impforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-impforn-KEY-Asc
              IF DataSet1-impforn-LOCK
                 READ impforn NEXT WITH LOCK
              ELSE
                 READ impforn NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-impforn-LOCK
                 READ impforn PREVIOUS WITH LOCK
              ELSE
                 READ impforn PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-impforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-impforn-KEY-Asc
              IF DataSet1-impforn-LOCK
                 READ impforn PREVIOUS WITH LOCK
              ELSE
                 READ impforn PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-impforn-LOCK
                 READ impforn NEXT WITH LOCK
              ELSE
                 READ impforn NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-impforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-impforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-impforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-INITSTART.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE Low-Value TO mag-chiave
           ELSE
              MOVE High-Value TO mag-chiave
           END-IF
           .

       DataSet1-tmagaz-INITEND.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE High-Value TO mag-chiave
           ELSE
              MOVE Low-Value TO mag-chiave
           END-IF
           .

      * tmagaz
       DataSet1-tmagaz-START.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY >= mag-chiave
           ELSE
              START tmagaz KEY <= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-NOTGREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY <= mag-chiave
           ELSE
              START tmagaz KEY >= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-GREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY > mag-chiave
           ELSE
              START tmagaz KEY < mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-LESS.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY < mag-chiave
           ELSE
              START tmagaz KEY > mag-chiave
           END-IF
           .

       DataSet1-tmagaz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmagaz-LOCK
              READ tmagaz WITH LOCK 
              KEY mag-chiave
           ELSE
              READ tmagaz WITH NO LOCK 
              KEY mag-chiave
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT 
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterDelete>
      * <TOTEM:END>
           .

       articoli-art-k1-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k1-SPLITBUF
           MOVE art-descrizione OF articoli(1:50) TO 
           articoli-art-k1-SPLITBUF(1:50)
           .

       articoli-art-k-frn-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k-frn-SPLITBUF
           MOVE art-cod-art-frn OF articoli(1:15) TO 
           articoli-art-k-frn-SPLITBUF(1:15)
           .

       DataSet1-articoli-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 MOVE Low-Value TO art-chiave OF articoli
              ELSE
                 MOVE High-Value TO art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 MOVE Low-Value TO art-descrizione OF articoli
              ELSE
                 MOVE High-Value TO art-descrizione OF articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 MOVE High-Value TO art-chiave OF articoli
              ELSE
                 MOVE Low-Value TO art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 MOVE High-Value to art-descrizione OF articoli
              ELSE          
                 MOVE Low-Value to art-descrizione OF articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-TMPBUF-TO-FLD.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              MOVE DataSet1-articoli-SPLIT-BUF2(1:50) TO
                   art-descrizione OF articoli(1:50)
           END-EVALUATE
           .

       DataSet1-articoli-FLD-TO-TMPBUF.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              MOVE art-descrizione OF articoli(1:50) TO
                   DataSet1-articoli-SPLIT-BUF2(1:50)
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-CHANGETO-KEY2.
           MOVE 2 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-articoli-KEY1-ORDER
           WHEN 2
              MOVE "A" TO DataSet1-articoli-KEY2-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-articoli-KEY1-ORDER
           WHEN 2
              MOVE "D" TO DataSet1-articoli-KEY2-ORDER
           END-EVALUATE
           .

      * articoli
       DataSet1-articoli-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 START articoli KEY >= art-chiave OF articoli
              ELSE
                 START articoli KEY <= art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 START articoli KEY >= art-k1 of articoli
              ELSE
                 START articoli KEY <= art-k1 of articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 START articoli KEY <= art-chiave OF articoli
              ELSE
                 START articoli KEY >= art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 START articoli KEY <= art-k1 of articoli
              ELSE
                 START articoli KEY >= art-k1 of articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 START articoli KEY > art-chiave OF articoli
              ELSE
                 START articoli KEY < art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 START articoli KEY > art-k1 of articoli
              ELSE
                 START articoli KEY < art-k1 of articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 START articoli KEY < art-chiave OF articoli
              ELSE
                 START articoli KEY > art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 START articoli KEY < art-k1 of articoli
              ELSE
                 START articoli KEY > art-k1 of articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-START-EQUAL.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              START articoli KEY = art-k1 of articoli
           END-EVALUATE
           .

       DataSet1-articoli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-LOCK
                 READ articoli WITH LOCK 
                 KEY art-chiave OF articoli
              ELSE
                 READ articoli WITH NO LOCK 
                 KEY art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-LOCK
                 READ articoli WITH LOCK 
                 KEY art-k1 of articoli
              ELSE
                 READ articoli WITH NO LOCK 
                 KEY art-k1 of articoli
              END-IF
           END-EVALUATE
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT 
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 IF DataSet1-articoli-LOCK
                    READ articoli NEXT WITH LOCK
                 ELSE
                    READ articoli NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-articoli-LOCK
                    READ articoli PREVIOUS WITH LOCK
                 ELSE
                    READ articoli PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 IF DataSet1-articoli-LOCK
                    READ articoli NEXT WITH LOCK
                 ELSE
                    READ articoli NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-articoli-LOCK
                    READ articoli PREVIOUS WITH LOCK
                 ELSE
                    READ articoli PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 IF DataSet1-articoli-LOCK
                    READ articoli PREVIOUS WITH LOCK
                 ELSE
                    READ articoli PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-articoli-LOCK
                    READ articoli NEXT WITH LOCK
                 ELSE
                    READ articoli NEXT WITH NO LOCK
                 END-IF
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 IF DataSet1-articoli-LOCK
                    READ articoli PREVIOUS WITH LOCK
                 ELSE
                    READ articoli PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-articoli-LOCK
                    READ articoli NEXT WITH LOCK
                 ELSE
                    READ articoli NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeWrite>
      * <TOTEM:END>
           WRITE art-rec OF articoli.
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRewrite>
      * <TOTEM:END>
           REWRITE art-rec OF articoli.
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeDelete>
      * <TOTEM:END>
           DELETE articoli.
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-INITSTART.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE Low-Value TO imq-chiave
           ELSE
              MOVE High-Value TO imq-chiave
           END-IF
           .

       DataSet1-timbalqta-INITEND.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE High-Value TO imq-chiave
           ELSE
              MOVE Low-Value TO imq-chiave
           END-IF
           .

      * timbalqta
       DataSet1-timbalqta-START.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY >= imq-chiave
           ELSE
              START timbalqta KEY <= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-NOTGREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY <= imq-chiave
           ELSE
              START timbalqta KEY >= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-GREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY > imq-chiave
           ELSE
              START timbalqta KEY < imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-LESS.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY < imq-chiave
           ELSE
              START timbalqta KEY > imq-chiave
           END-IF
           .

       DataSet1-timbalqta-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timbalqta-LOCK
              READ timbalqta WITH LOCK 
              KEY imq-chiave
           ELSE
              READ timbalqta WITH NO LOCK 
              KEY imq-chiave
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT 
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE record-tbliv OF tivaese
           INITIALIZE mar-rec OF tmarche
           INITIALIZE imb-rec OF timballi
           INITIALIZE prg-rec OF progmag
           INITIALIZE nom-rec OF tnomen
           INITIALIZE cl1-rec OF tcla1art
           INITIALIZE sme-rec OF tsetmerc
           INITIALIZE udm-rec OF tudm
           INITIALIZE tge-rec OF tparamge
           INITIALIZE cli-rec OF clienti
           INITIALIZE dis-rec OF distinteb
           INITIALIZE rmo-rec OF rmovmag
           INITIALIZE ror-rec OF rordini
           INITIALIZE rno-rec OF rnotacr
           INITIALIZE brno-rec OF brnotacr
           INITIALIZE sco-rec OF tscorte
           INITIALIZE rlis-rec OF rlistini
           INITIALIZE desf-rec OF destinif
           INITIALIZE art-rec OF articoli1
           INITIALIZE mro-rec OF mrordini
           INITIALIZE reva-rec OF reva
           INITIALIZE rof-rec OF rordforn
           INITIALIZE sart-rec OF sort-art-list
           INITIALIZE imp-rec OF timposte
           INITIALIZE tpb-rec OF tpiombo
           INITIALIZE tlis-rec OF tlistini
           INITIALIZE pen-rec OF prodener
           INITIALIZE bli-rec OF blister
           INITIALIZE cat-rec OF catart
           INITIALIZE prm-rec OF param
           INITIALIZE imf-rec OF impforn
           INITIALIZE mag-rec OF tmagaz
           INITIALIZE art-rec OF articoli
           INITIALIZE imq-rec OF timbalqta
           .


      * COMBO-BOX
       cbo-utf-Content.
           .

      * COMBO-BOX
       cbo-cobat-Content.
           .

      * COMBO-BOX
       cbo-stato-Content.
           .

      * GRID
       gd-list-Content.
      * CELLS' SETTING
              MODIFY gd-list, X = 2, Y = 1,
                CELL-DATA = "Forn.",
      * CELLS' SETTING
              MODIFY gd-list, X = 3, Y = 1,
                CELL-DATA = "Destino",
      * CELLS' SETTING
              MODIFY gd-list, X = 4, Y = 1,
                CELL-DATA = "Validità dal",
      * CELLS' SETTING
              MODIFY gd-list, X = 5, Y = 1,
                CELL-DATA = "Validità al",
      * CELLS' SETTING
              MODIFY gd-list, X = 6, Y = 1,
                CELL-DATA = "Cod Fornitore",
      * CELLS' SETTING
              MODIFY gd-list, X = 7, Y = 1,
                CELL-DATA = "Prezzo Finito",
      * CELLS' SETTING
              MODIFY gd-list, X = 8, Y = 1,
                CELL-DATA = "Prezzo Confronto",
           .

      * FD's Initialize Paragraph
       DataSet1-tivaese-INITREC.
           INITIALIZE record-tbliv OF tivaese
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmarche-INITREC.
           INITIALIZE mar-rec OF tmarche
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timballi-INITREC.
           INITIALIZE imb-rec OF timballi
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-progmag-INITREC.
           INITIALIZE prg-rec OF progmag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tnomen-INITREC.
           INITIALIZE nom-rec OF tnomen
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcla1art-INITREC.
           INITIALIZE cl1-rec OF tcla1art
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tsetmerc-INITREC.
           INITIALIZE sme-rec OF tsetmerc
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tudm-INITREC.
           INITIALIZE udm-rec OF tudm
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tparamge-INITREC.
           INITIALIZE tge-rec OF tparamge
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-clienti-INITREC.
           INITIALIZE cli-rec OF clienti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-distinteb-INITREC.
           INITIALIZE dis-rec OF distinteb
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rmovmag-INITREC.
           INITIALIZE rmo-rec OF rmovmag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rordini-INITREC.
           INITIALIZE ror-rec OF rordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rnotacr-INITREC.
           INITIALIZE rno-rec OF rnotacr
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-brnotacr-INITREC.
           INITIALIZE brno-rec OF brnotacr
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tscorte-INITREC.
           INITIALIZE sco-rec OF tscorte
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rlistini-INITREC.
           INITIALIZE rlis-rec OF rlistini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-destinif-INITREC.
           INITIALIZE desf-rec OF destinif
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-articoli1-INITREC.
           INITIALIZE art-rec OF articoli1
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-mrordini-INITREC.
           INITIALIZE mro-rec OF mrordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-reva-INITREC.
           INITIALIZE reva-rec OF reva
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rordforn-INITREC.
           INITIALIZE rof-rec OF rordforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-sort-art-list-INITREC.
           INITIALIZE sart-rec OF sort-art-list
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timposte-INITREC.
           INITIALIZE imp-rec OF timposte
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tpiombo-INITREC.
           INITIALIZE tpb-rec OF tpiombo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tlistini-INITREC.
           INITIALIZE tlis-rec OF tlistini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-prodener-INITREC.
           INITIALIZE pen-rec OF prodener
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-blister-INITREC.
           INITIALIZE bli-rec OF blister
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-catart-INITREC.
           INITIALIZE cat-rec OF catart
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-param-INITREC.
           INITIALIZE prm-rec OF param
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-impforn-INITREC.
           INITIALIZE imf-rec OF impforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmagaz-INITREC.
           INITIALIZE mag-rec OF tmagaz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-articoli-INITREC.
           INITIALIZE art-rec OF articoli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timbalqta-INITREC.
           INITIALIZE imq-rec OF timbalqta
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           EVALUATE TOTEM-Form-Index ALSO TOTEM-Frame-Index
              WHEN 1 ALSO 0
                  PERFORM Form1-Buf-To-Fld
           END-EVALUATE
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              SCREEN LINE 1,
              SCREEN COLUMN 0,
              LINES 56,08,
              SIZE 168,33,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Small-Font,
              LABEL-OFFSET 23,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE TITOLO,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              HANDLE IS Form1-Handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              GRIP,
              PANEL-WIDTHS (90, 35, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON Form1-Handle
      * DISPLAY-COLUMNS settings
              MODIFY gd-list, DISPLAY-COLUMNS (1, 4, 12, 75, 89, 103, 
           125, 141)
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           perform GARTICOLI-BEFORE-ACCEPT.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY Form1-Handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
           perform GARTICOLI-AFTER-ACCEPT.

           .
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
                 IF Event-Type = Cmd-Tabchanged AND 
                                 Event-Control-Id = 5000
                    MOVE EVENT-DATA-1 TO Screen1-Ta-1-TAB-VALUE
                    PERFORM Screen1-Ta-1-TABCHANGE
                 END-IF

              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1001
                 PERFORM chk-cobat-LinkTo
              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1001
                 PERFORM chk-cobat-LinkTo
              WHEN Key-Status = 1001
                 PERFORM chk-cobat-LinkTo
              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1001
                 PERFORM chk-cobat-LinkTo
              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1001
                 PERFORM chk-cobat-LinkTo
              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1001
                 PERFORM chk-cobat-LinkTo
              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1009
                 PERFORM pb-note-LinkTo
              WHEN Key-Status = 1003
                 PERFORM pb-foto-LinkTo
              WHEN Key-Status = 1013
                 PERFORM pb-brand-LinkTo
              WHEN Key-Status = 1004
                 PERFORM pb-scheda-LinkTo
              WHEN Key-Status = 1012
                 PERFORM pb-toss-LinkTo
              WHEN Key-Status = 1015
                 PERFORM pb-frn-LinkTo
              WHEN Key-Status = 1008
                 PERFORM pb-distinta-LinkTo
              WHEN Key-Status = 1005
                 PERFORM pb-codici-LinkTo
              WHEN Key-Status = 1014
                 PERFORM pb-lista-LinkTo
              WHEN Key-Status = 1007
                 PERFORM pb-dettagli-LinkTo
              WHEN Key-Status = 1010
                 PERFORM pb-stampa-LinkTo
              WHEN Key-Status = 1011
                 PERFORM pb-ean-LinkTo
              WHEN Key-Status = 1357
                 PERFORM pb-copiada-LinkTo
              WHEN Key-Status = 2
                 PERFORM NUOVO-LinkTo
              WHEN Key-Status = 4
                 PERFORM CANCELLA-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
              WHEN Key-Status = 9
                 PERFORM TOOL-SELEZIONA-LinkTo
              WHEN Key-Status = 1002
                 PERFORM TOOL-PRIMO
              WHEN Key-Status = 67
                 PERFORM TOOL-PRECEDENTE
              WHEN Key-Status = 68
                 PERFORM TOOL-SUCCESSIVO
              WHEN Key-Status = 1006
                 PERFORM TOOL-ULTIMO
              WHEN Key-Status = 10
                 PERFORM TOOL-ORD-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON Form1-Handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
           perform SALV-MOD.

           if errori
              move 26 to key-status
              exit paragraph
           end-if.

           .
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * TAB
              MODIFY Screen1-Ta-1, RESET-TABS = 1
              MODIFY Screen1-Ta-1, 
           TAB-TO-ADD = (
                 "&Anagrafica",
                 "Dati Aggiuntivi e Dimensioni",
                 "&Progressivi e Saldi Generali",
                 "Listini",
                        )
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
                   Form1-Pg-4-Visible,
                   Form1-Pg-2-Visible,
                   Form1-Pg-3-Visible,
           MOVE 1 TO Form1-Pg-1-Visible
           PERFORM Screen1-Ta-1-TABCHANGE
      * COMBO-BOX
           PERFORM cbo-utf-Content
      * COMBO-BOX
           PERFORM cbo-cobat-Content
      * COMBO-BOX
           PERFORM cbo-stato-Content
      * GRID
           PERFORM gd-list-Content
           .

       Form1-DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-CHANGETO-KEY2.
           MOVE 2 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-articoli-KEY1-ORDER
           WHEN 2
              MOVE "A" TO DataSet1-articoli-KEY2-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-articoli-KEY1-ORDER
           WHEN 2
              MOVE "D" TO DataSet1-articoli-KEY2-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Update-Key.
           MOVE art-rec OF articoli TO
                     Form1-MULKEY-TMPBUF
           PERFORM Form1-CLEAR
           PERFORM Form1-INIT-DATA
           MOVE Form1-MULKEY-TMPBUF TO
                     art-rec OF articoli
           PERFORM DataSet1-articoli-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
           .

       Form1-DUPLICATE-PREV.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              PERFORM articoli-art-k1-MERGE-SPLITBUF
              IF articoli-art-k1-SPLITBUF = Form1-KEYISTMP2
                 MOVE DataSet1-articoli-KEY2-ORDER TO 
           TMP-Form1-KEY2-ORDER
                 MOVE "A" TO DataSet1-articoli-KEY2-ORDER
                 PERFORM DataSet1-articoli-START-EQUAL
                 IF Valid-STATUS-articoli
                    PERFORM DataSet1-articoli-Read-Next
                    PERFORM UNTIL NOT Valid-STATUS-articoli OR 
                         art-chiave OF articoli = Form1-PKEYTMP OR
                         articoli-art-k1-SPLITBUF NOT = Form1-KEYISTMP2
                       PERFORM DataSet1-articoli-Read-Next
                    END-PERFORM
                 END-IF
                 MOVE TMP-Form1-KEY2-ORDER TO 
           DataSet1-articoli-KEY2-ORDER
              ELSE
                 PERFORM DataSet1-articoli-START-LESS
              END-IF
           WHEN OTHER
              PERFORM DataSet1-articoli-START-LESS
           END-EVALUATE
           .

       Form1-DUPLICATE-NEXT.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              PERFORM articoli-art-k1-MERGE-SPLITBUF
              IF articoli-art-k1-SPLITBUF = Form1-KEYISTMP2
                 MOVE DataSet1-articoli-KEY2-ORDER TO 
           TMP-Form1-KEY2-ORDER
                 MOVE "A" TO DataSet1-articoli-KEY2-ORDER
                 PERFORM DataSet1-articoli-START
                 IF Valid-STATUS-articoli
                    PERFORM DataSet1-articoli-Read-Next
                    PERFORM UNTIL NOT Valid-STATUS-articoli OR 
                         art-chiave OF articoli = Form1-PKEYTMP OR
                         articoli-art-k1-SPLITBUF NOT = Form1-KEYISTMP2
                       PERFORM DataSet1-articoli-Read-Next
                    END-PERFORM
                 END-IF
                 MOVE TMP-Form1-KEY2-ORDER TO 
           DataSet1-articoli-KEY2-ORDER
              ELSE
                 PERFORM DataSet1-articoli-START-GREATER
              END-IF
           WHEN OTHER
              PERFORM DataSet1-articoli-START-GREATER
           END-EVALUATE
           .

       Form1-DUPLICATE-MOVEKEY.
           MOVE art-chiave OF articoli TO Form1-PKEYTMP
           EVALUATE DataSet1-KEYIS
           WHEN 2
              MOVE articoli-art-k1-SPLITBUF TO
                   Form1-KEYISTMP2
           END-EVALUATE
           .

       Form1-First.
           PERFORM Form1-DUMMY-FIRST
           PERFORM DataSet1-articoli-INITSTART
           PERFORM DataSet1-articoli-START
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFirst>
      * <TOTEM:END>
           PERFORM DataSet1-articoli-Read-Next
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFirst>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Previous.
              PERFORM Form1-Buf-To-Fld
              PERFORM Form1-DUPLICATE-PREV
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforePrevious>
      * <TOTEM:END>
           PERFORM DataSet1-articoli-Read-Prev
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterPrevious>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-PREVIOUS
           PERFORM Form1-IUD-Display
           .

       Form1-Next.
              PERFORM Form1-Buf-To-Fld
              PERFORM Form1-DUPLICATE-NEXT
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeNext>
      * <TOTEM:END>
           PERFORM DataSet1-articoli-Read-Next
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterNext>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-NEXT
           PERFORM Form1-IUD-Display
           .
      
       Form1-Last.
           PERFORM Form1-DUMMY-LAST
           PERFORM DataSet1-articoli-INITEND
           PERFORM DataSet1-articoli-START-NOTGREATER
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeLast>
      * <TOTEM:END>
           PERFORM DataSet1-articoli-Read-Prev
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterLast>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Curr.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeCurrent>
      * <TOTEM:END>
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-articoli-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCurrent>
      * <TOTEM:END>
           .

       Form1-IUD-Display.
           IF Valid-STATUS-articoli
              PERFORM Form1-ALLGRID-RESET
              PERFORM Form1-Fld-To-Buf
              PERFORM Form1-NAVI-FOR-MASTERGRID
              PERFORM Form1-DISPLAY
           ELSE
              IF Form1-FLAG-REFRESH
                 CONTINUE
              ELSE
                 PERFORM Form1-Extended-File-Status
              END-IF
           END-IF
           .

       Form1-Add.
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-ADD
           PERFORM DataSet1-articoli-INITREC
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAdd>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-articoli-Rec-Write
           IF Valid-STATUS-articoli
              PERFORM Form1-RESUMMARY-INS
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "301" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAdd>
      * <TOTEM:END>
           .
     
       Form1-Update.
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-articoli-START              
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
           PERFORM DataSet1-articoli-Read
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-UPDATE
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeUpdate>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-articoli-Rec-Rewrite
           IF Valid-STATUS-articoli
              PERFORM Form1-RESUMMARY-DEL
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "302" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterUpdate>
      * <TOTEM:END>
           .

       Form1-Delete.
           MOVE "203" TO TOTEM-MSG-ID
           PERFORM MESSAGE-BOX-DISPLAY
           IF TOTEM-MSG-RETURN-VALUE NOT = 1
              INITIALIZE TOTEM-MSG-TEXT
              EXIT PARAGRAPH 
           END-IF
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDelete>
      * <TOTEM:END>
           PERFORM Form1-DUMMY-DELETE
      * delete
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-articoli-Rec-Delete
           IF Valid-STATUS-articoli
              PERFORM Form1-CLEAR
              PERFORM Form1-DUMMY-DELETE-INIT
              MOVE "303" TO TOTEM-MSG-ID
              MOVE "00" to STATUS-articoli
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDelete>
      * <TOTEM:END>
           PERFORM Form1-ERR-CHECKING
           .

       Form1-NAVI-FOR-MASTERGRID.
           .

       Form1-ERR-CHECKING.
           IF Valid-STATUS-articoli
              PERFORM Form1-SHOW-MSG-ROUTINE
           ELSE
              PERFORM Form1-Extended-File-Status
           END-IF
           .

       Form1-RESUMMARY-INS.
           .

       Form1-RESUMMARY-DEL.
           .


       Form1-DUMMY-FIRST.
           .

       Form1-DUMMY-PREVIOUS.
           .

       Form1-DUMMY-NEXT.
           .

       Form1-DUMMY-LAST.
           .

       Form1-DUMMY-CURR.
           .

       Form1-DUMMY-ADD.
           .

       Form1-DUMMY-UPDATE.
           .

       Form1-DUMMY-UPDATE-INIT.
           .

       Form1-DUMMY-DELETE.
           .

       Form1-DUMMY-DELETE-INIT.
           .

       Form1-Init-Value.
           MOVE TITOLO TO TOTEM-MSG-TITLE
           INITIALIZE Form1-BUF
      * FORM : Form1
           PERFORM DataSet1-INIT-RECORD
      * DB_CHECK BOX
              MOVE 0 TO art-novita OF articoli
      * DB_CHECK BOX
              MOVE "N" TO art-soggetto-imposte of articoli
      * DB_CHECK BOX
              MOVE "N" TO art-soggetto-cobat of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-ala of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-agenti of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-do of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-SHARK OF articoli
      * DB_CHECK BOX
              MOVE 0 TO art-gda of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-specialist of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-gds of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-gruppi of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-estero of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-web of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-SPI of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-AT of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-TEXACO OF articoli
      * DB_CHECK BOX
              MOVE 0 TO art-T1 of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-T2 of articoli
      * DB_CHECK BOX
              MOVE 0 TO art-T3 of articoli
           MOVE ALL X'9' TO Form1-KEYISTMP2
           MOVE ALL X'9' TO Form1-PKEYTMP
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
      * ef-codice's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codice-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5001 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5002 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5003 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des-altern's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des-altern-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5004 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-coll's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-coll-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5005 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-setmerc's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-setmerc-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5006 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-iva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-iva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5007 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-marca's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-marca-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5008 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5009 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-classe-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-classe-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5010 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-classe-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-classe-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5011 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-classe-3's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-classe-3-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5012 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-classe-4's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-classe-4-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5013 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-udm's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-udm-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5014 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-imballo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-imballo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5015 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-udm-imballo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-udm-imballo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5016 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-dogana's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-dogana-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5017 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-peso-utf's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-peso-utf-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5019 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-peso-non-utf's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-peso-non-utf-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5020 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prodener's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prodener-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5021 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-perce-imposte's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-perce-imposte-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5026 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-perce-cou's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-perce-cou-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5027 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-scorta's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-scorta-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5028 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-moq's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-moq-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5029 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-amperaggio's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-amperaggio-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5031 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-reale's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-reale-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5033 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prezzo-acq's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prezzo-acq-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5034 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto-acquisto's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-acquisto-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5035 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prz-vend's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prz-vend-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5036 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-litri's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-litri-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5037 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prezzo-banco's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prezzo-banco-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5038 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto-agente's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-agente-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5039 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-min-vend's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-min-vend-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5040 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5041 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5042 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-3's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-3-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5043 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-4's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-4-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5044 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-5's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-5-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5045 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-art-for's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-art-for-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5046 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-forn's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-forn-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5047 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-destino's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-destino-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5048 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5049 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-agg's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-agg-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5064 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-foto's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-foto-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5065 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-brand's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-brand-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5066 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-scheda's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-scheda-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5067 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-toss's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-toss-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5068 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des-ing's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des-ing-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5069 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des-spa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des-spa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5070 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-altezza-pz's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-altezza-pz-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5071 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-larghezza-pz's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-larghezza-pz-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5072 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-profondita-pz's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-profondita-pz-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5073 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-qta-cartone's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-qta-cartone-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5074 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-qta-stda's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-qta-stda-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5075 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-adr's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-adr-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5076 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-peso-SHI's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-peso-SHI-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 62 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-peso-GET's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-peso-GET-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5077 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-altezza's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-altezza-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5078 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-larghezza's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-larghezza-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5079 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-profondita's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-profondita-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5080 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-qta-epal's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-qta-epal-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5081 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-qta-std's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-qta-std-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5082 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-peso-utf-prg's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-peso-utf-prg-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 93 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-peso-non-utf-prg's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-peso-non-utf-prg-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 94 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-COSTO-ULTIMO's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-COSTO-ULTIMO-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 95 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-COSTO-MEDIO's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-COSTO-MEDIO-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 96 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-COSTO-MP's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-COSTO-MP-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 97 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-GIACENZA's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-GIACENZA-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 98 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ORD-CLI's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ORD-CLI-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 99 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-giac-buona's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-giac-buona-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 100 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ORD-FORN's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ORD-FORN-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 101 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ORD-FORNa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ORD-FORNa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5086 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ORD-FORNb's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ORD-FORNb-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5087 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ORD-FORNc's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ORD-FORNc-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5088 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ORD-FORNca's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ORD-FORNca-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 105 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ORD-FORNcb's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ORD-FORNcb-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 106 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-INI-UDM's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-INI-UDM-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 107 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-INI-KG's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-INI-KG-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 108 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-INI-VALORE's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-INI-VALORE-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 109 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ACQ-UDM's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ACQ-UDM-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 110 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ACQ-KG's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ACQ-KG-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 111 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ACQ-VALORE's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ACQ-VALORE-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 112 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-VEN-UDM's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-VEN-UDM-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 113 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-VEN-KG's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-VEN-KG-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 114 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-VEN-VALORE's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-VEN-VALORE-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 115 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-VAR-UDM's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-VAR-UDM-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 116 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-VAR-KG's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-VAR-KG-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 117 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-VAR-VALORE's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-VAR-VALORE-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 118 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-FORN-UDM's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-FORN-UDM-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 119 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-FORN-KG's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-FORN-KG-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 120 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-FORN-VALORE's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-FORN-VALORE-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 121 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-CLI-UDM's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-CLI-UDM-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 122 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-CLI-KG's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-CLI-KG-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 123 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-CLI-VALORE's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-CLI-VALORE-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 124 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-FORN-UDMa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-FORN-UDMa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 125 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-FORN-KGa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-FORN-KGa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 126 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-FORN-VALOREa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-FORN-VALOREa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 127 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-CLI-UDMa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-CLI-UDMa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 128 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-CLI-KGa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-CLI-KGa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 129 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-CLI-VALOREa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-CLI-VALOREa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 130 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gia-udm's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gia-udm-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 131 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gia-kg's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gia-kg-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 132 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-dt-val-da's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-dt-val-da-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5089 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-dt-val-a's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-dt-val-a-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5090 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
           .

       ef-codice-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codice, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codice-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codice, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codice's Validation
       ef-codice-VALIDATION.
           PERFORM ef-codice-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codice-AFTER-VALIDATION
           .

       ef-des1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des1's Validation
       ef-des1-VALIDATION.
           PERFORM ef-des1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des1-AFTER-VALIDATION
           .

       ef-des2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des2's Validation
       ef-des2-VALIDATION.
           PERFORM ef-des2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des2-AFTER-VALIDATION
           .

       ef-des-altern-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-altern, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des-altern-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-altern, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des-altern's Validation
       ef-des-altern-VALIDATION.
           PERFORM ef-des-altern-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des-altern-AFTER-VALIDATION
           .

       ef-coll-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-coll, BeforeValidation>
      * <TOTEM:END>
           .

       ef-coll-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-coll, AfterValidation>
      * <TOTEM:END>
           .

      * ef-coll's Validation
       ef-coll-VALIDATION.
           PERFORM ef-coll-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-coll-AFTER-VALIDATION
           .

       ef-setmerc-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-setmerc, BeforeValidation>
      * <TOTEM:END>
           .

       ef-setmerc-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-setmerc, AfterValidation>
      * <TOTEM:END>
           .

      * ef-setmerc's Validation
       ef-setmerc-VALIDATION.
           PERFORM ef-setmerc-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-setmerc-AFTER-VALIDATION
           .

       ef-iva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-iva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-iva's Validation
       ef-iva-VALIDATION.
           PERFORM ef-iva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-iva-AFTER-VALIDATION
           .

       ef-marca-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-marca, BeforeValidation>
      * <TOTEM:END>
           .

       ef-marca-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-marca, AfterValidation>
      * <TOTEM:END>
           .

      * ef-marca's Validation
       ef-marca-VALIDATION.
           PERFORM ef-marca-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-marca-AFTER-VALIDATION
           .

       ef-mag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mag's Validation
       ef-mag-VALIDATION.
           PERFORM ef-mag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mag-AFTER-VALIDATION
           .

       ef-classe-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-classe-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-classe-1's Validation
       ef-classe-1-VALIDATION.
           PERFORM ef-classe-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-classe-1-AFTER-VALIDATION
           .

       ef-classe-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-classe-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-classe-2's Validation
       ef-classe-2-VALIDATION.
           PERFORM ef-classe-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-classe-2-AFTER-VALIDATION
           .

       ef-classe-3-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-3, BeforeValidation>
      * <TOTEM:END>
           .

       ef-classe-3-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-3, AfterValidation>
      * <TOTEM:END>
           .

      * ef-classe-3's Validation
       ef-classe-3-VALIDATION.
           PERFORM ef-classe-3-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-classe-3-AFTER-VALIDATION
           .

       ef-classe-4-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-4, BeforeValidation>
      * <TOTEM:END>
           .

       ef-classe-4-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-4, AfterValidation>
      * <TOTEM:END>
           .

      * ef-classe-4's Validation
       ef-classe-4-VALIDATION.
           PERFORM ef-classe-4-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-classe-4-AFTER-VALIDATION
           .

       ef-udm-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-udm, BeforeValidation>
      * <TOTEM:END>
           .

       ef-udm-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-udm, AfterValidation>
      * <TOTEM:END>
           .

      * ef-udm's Validation
       ef-udm-VALIDATION.
           PERFORM ef-udm-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-udm-AFTER-VALIDATION
           .

       ef-imballo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imballo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-imballo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imballo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-imballo's Validation
       ef-imballo-VALIDATION.
           PERFORM ef-imballo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-imballo-AFTER-VALIDATION
           .

       ef-udm-imballo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-udm-imballo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-udm-imballo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-udm-imballo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-udm-imballo's Validation
       ef-udm-imballo-VALIDATION.
           PERFORM ef-udm-imballo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-udm-imballo-AFTER-VALIDATION
           .

       ef-dogana-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dogana, BeforeValidation>
      * <TOTEM:END>
           .

       ef-dogana-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dogana, AfterValidation>
      * <TOTEM:END>
           .

      * ef-dogana's Validation
       ef-dogana-VALIDATION.
           PERFORM ef-dogana-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-dogana-AFTER-VALIDATION
           .

       ef-peso-utf-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-utf, BeforeValidation>
      * <TOTEM:END>
           .

       ef-peso-utf-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-utf, AfterValidation>
      * <TOTEM:END>
           .

      * ef-peso-utf's Validation
       ef-peso-utf-VALIDATION.
           PERFORM ef-peso-utf-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-peso-utf-AFTER-VALIDATION
           .

       ef-peso-non-utf-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-non-utf, BeforeValidation>
      * <TOTEM:END>
           .

       ef-peso-non-utf-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-non-utf, AfterValidation>
      * <TOTEM:END>
           .

      * ef-peso-non-utf's Validation
       ef-peso-non-utf-VALIDATION.
           PERFORM ef-peso-non-utf-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-peso-non-utf-AFTER-VALIDATION
           .

       ef-prodener-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prodener, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prodener-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prodener, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prodener's Validation
       ef-prodener-VALIDATION.
           PERFORM ef-prodener-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prodener-AFTER-VALIDATION
           .

       ef-perce-imposte-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-imposte, BeforeValidation>
      * <TOTEM:END>
           .

       ef-perce-imposte-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-imposte, AfterValidation>
      * <TOTEM:END>
           .

      * ef-perce-imposte's Validation
       ef-perce-imposte-VALIDATION.
           PERFORM ef-perce-imposte-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-perce-imposte-AFTER-VALIDATION
           .

       ef-perce-cou-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-cou, BeforeValidation>
      * <TOTEM:END>
           .

       ef-perce-cou-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-cou, AfterValidation>
      * <TOTEM:END>
           .

      * ef-perce-cou's Validation
       ef-perce-cou-VALIDATION.
           PERFORM ef-perce-cou-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-perce-cou-AFTER-VALIDATION
           .

       ef-scorta-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-scorta, BeforeValidation>
      * <TOTEM:END>
           .

       ef-scorta-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-scorta, AfterValidation>
      * <TOTEM:END>
           .

      * ef-scorta's Validation
       ef-scorta-VALIDATION.
           PERFORM ef-scorta-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-scorta-AFTER-VALIDATION
           .

       ef-moq-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-moq, BeforeValidation>
      * <TOTEM:END>
           .

       ef-moq-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-moq, AfterValidation>
      * <TOTEM:END>
           .

      * ef-moq's Validation
       ef-moq-VALIDATION.
           PERFORM ef-moq-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-moq-AFTER-VALIDATION
           .

       ef-amperaggio-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-amperaggio, BeforeValidation>
      * <TOTEM:END>
           .

       ef-amperaggio-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-amperaggio, AfterValidation>
      * <TOTEM:END>
           .

      * ef-amperaggio's Validation
       ef-amperaggio-VALIDATION.
           PERFORM ef-amperaggio-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-amperaggio-AFTER-VALIDATION
           .

       ef-reale-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-reale, BeforeValidation>
      * <TOTEM:END>
           .

       ef-reale-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-reale, AfterValidation>
      * <TOTEM:END>
           .

      * ef-reale's Validation
       ef-reale-VALIDATION.
           PERFORM ef-reale-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-reale-AFTER-VALIDATION
           .

       ef-prezzo-acq-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prezzo-acq, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prezzo-acq-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prezzo-acq, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prezzo-acq's Validation
       ef-prezzo-acq-VALIDATION.
           PERFORM ef-prezzo-acq-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prezzo-acq-AFTER-VALIDATION
           .

       ef-sconto-acquisto-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-acquisto, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-acquisto-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-acquisto, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto-acquisto's Validation
       ef-sconto-acquisto-VALIDATION.
           PERFORM ef-sconto-acquisto-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-acquisto-AFTER-VALIDATION
           .

       ef-prz-vend-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prz-vend, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prz-vend-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prz-vend, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prz-vend's Validation
       ef-prz-vend-VALIDATION.
           PERFORM ef-prz-vend-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prz-vend-AFTER-VALIDATION
           .

       ef-litri-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-litri, BeforeValidation>
      * <TOTEM:END>
           .

       ef-litri-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-litri, AfterValidation>
      * <TOTEM:END>
           .

      * ef-litri's Validation
       ef-litri-VALIDATION.
           PERFORM ef-litri-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-litri-AFTER-VALIDATION
           .

       ef-prezzo-banco-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prezzo-banco, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prezzo-banco-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prezzo-banco, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prezzo-banco's Validation
       ef-prezzo-banco-VALIDATION.
           PERFORM ef-prezzo-banco-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prezzo-banco-AFTER-VALIDATION
           .

       ef-sconto-agente-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-agente, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-agente-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-agente, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto-agente's Validation
       ef-sconto-agente-VALIDATION.
           PERFORM ef-sconto-agente-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-agente-AFTER-VALIDATION
           .

       ef-min-vend-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-min-vend, BeforeValidation>
      * <TOTEM:END>
           .

       ef-min-vend-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-min-vend, AfterValidation>
      * <TOTEM:END>
           .

      * ef-min-vend's Validation
       ef-min-vend-VALIDATION.
           PERFORM ef-min-vend-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-min-vend-AFTER-VALIDATION
           .

       ef-ean-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-1's Validation
       ef-ean-1-VALIDATION.
           PERFORM ef-ean-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-1-AFTER-VALIDATION
           .

       ef-ean-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-2's Validation
       ef-ean-2-VALIDATION.
           PERFORM ef-ean-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-2-AFTER-VALIDATION
           .

       ef-ean-3-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-3, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-3-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-3, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-3's Validation
       ef-ean-3-VALIDATION.
           PERFORM ef-ean-3-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-3-AFTER-VALIDATION
           .

       ef-ean-4-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-4, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-4-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-4, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-4's Validation
       ef-ean-4-VALIDATION.
           PERFORM ef-ean-4-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-4-AFTER-VALIDATION
           .

       ef-ean-5-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-5, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-5-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-5, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-5's Validation
       ef-ean-5-VALIDATION.
           PERFORM ef-ean-5-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-5-AFTER-VALIDATION
           .

       ef-art-for-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-art-for, BeforeValidation>
      * <TOTEM:END>
           .

       ef-art-for-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-art-for, AfterValidation>
      * <TOTEM:END>
           .

      * ef-art-for's Validation
       ef-art-for-VALIDATION.
           PERFORM ef-art-for-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-art-for-AFTER-VALIDATION
           .

       ef-forn-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-forn, BeforeValidation>
      * <TOTEM:END>
           .

       ef-forn-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-forn, AfterValidation>
      * <TOTEM:END>
           .

      * ef-forn's Validation
       ef-forn-VALIDATION.
           PERFORM ef-forn-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-forn-AFTER-VALIDATION
           .

       ef-destino-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-destino, BeforeValidation>
      * <TOTEM:END>
           .

       ef-destino-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-destino, AfterValidation>
      * <TOTEM:END>
           .

      * ef-destino's Validation
       ef-destino-VALIDATION.
           PERFORM ef-destino-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-destino-AFTER-VALIDATION
           .

       ef-note2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note2's Validation
       ef-note2-VALIDATION.
           PERFORM ef-note2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note2-AFTER-VALIDATION
           .

       ef-note-agg-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-agg, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-agg-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-agg, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-agg's Validation
       ef-note-agg-VALIDATION.
           PERFORM ef-note-agg-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-agg-AFTER-VALIDATION
           .

       ef-foto-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-foto, BeforeValidation>
      * <TOTEM:END>
           .

       ef-foto-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-foto, AfterValidation>
      * <TOTEM:END>
           .

      * ef-foto's Validation
       ef-foto-VALIDATION.
           PERFORM ef-foto-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-foto-AFTER-VALIDATION
           .

       ef-brand-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-brand, BeforeValidation>
      * <TOTEM:END>
           .

       ef-brand-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-brand, AfterValidation>
      * <TOTEM:END>
           .

      * ef-brand's Validation
       ef-brand-VALIDATION.
           PERFORM ef-brand-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-brand-AFTER-VALIDATION
           .

       ef-scheda-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-scheda, BeforeValidation>
      * <TOTEM:END>
           .

       ef-scheda-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-scheda, AfterValidation>
      * <TOTEM:END>
           .

      * ef-scheda's Validation
       ef-scheda-VALIDATION.
           PERFORM ef-scheda-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-scheda-AFTER-VALIDATION
           .

       ef-toss-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-toss, BeforeValidation>
      * <TOTEM:END>
           .

       ef-toss-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-toss, AfterValidation>
      * <TOTEM:END>
           .

      * ef-toss's Validation
       ef-toss-VALIDATION.
           PERFORM ef-toss-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-toss-AFTER-VALIDATION
           .

       ef-des-ing-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-ing, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des-ing-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-ing, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des-ing's Validation
       ef-des-ing-VALIDATION.
           PERFORM ef-des-ing-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des-ing-AFTER-VALIDATION
           .

       ef-des-spa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-spa, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des-spa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-spa, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des-spa's Validation
       ef-des-spa-VALIDATION.
           PERFORM ef-des-spa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des-spa-AFTER-VALIDATION
           .

       ef-altezza-pz-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-altezza-pz, BeforeValidation>
      * <TOTEM:END>
           .

       ef-altezza-pz-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-altezza-pz, AfterValidation>
      * <TOTEM:END>
           .

      * ef-altezza-pz's Validation
       ef-altezza-pz-VALIDATION.
           PERFORM ef-altezza-pz-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-altezza-pz-AFTER-VALIDATION
           .

       ef-larghezza-pz-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-larghezza-pz, BeforeValidation>
      * <TOTEM:END>
           .

       ef-larghezza-pz-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-larghezza-pz, AfterValidation>
      * <TOTEM:END>
           .

      * ef-larghezza-pz's Validation
       ef-larghezza-pz-VALIDATION.
           PERFORM ef-larghezza-pz-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-larghezza-pz-AFTER-VALIDATION
           .

       ef-profondita-pz-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-profondita-pz, BeforeValidation>
      * <TOTEM:END>
           .

       ef-profondita-pz-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-profondita-pz, AfterValidation>
      * <TOTEM:END>
           .

      * ef-profondita-pz's Validation
       ef-profondita-pz-VALIDATION.
           PERFORM ef-profondita-pz-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-profondita-pz-AFTER-VALIDATION
           .

       ef-qta-cartone-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-cartone, BeforeValidation>
      * <TOTEM:END>
           .

       ef-qta-cartone-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-cartone, AfterValidation>
      * <TOTEM:END>
           .

      * ef-qta-cartone's Validation
       ef-qta-cartone-VALIDATION.
           PERFORM ef-qta-cartone-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-qta-cartone-AFTER-VALIDATION
           .

       ef-qta-stda-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-stda, BeforeValidation>
      * <TOTEM:END>
           .

       ef-qta-stda-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-stda, AfterValidation>
      * <TOTEM:END>
           .

      * ef-qta-stda's Validation
       ef-qta-stda-VALIDATION.
           PERFORM ef-qta-stda-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-qta-stda-AFTER-VALIDATION
           .

       ef-adr-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-adr, BeforeValidation>
      * <TOTEM:END>
           .

       ef-adr-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-adr, AfterValidation>
      * <TOTEM:END>
           .

      * ef-adr's Validation
       ef-adr-VALIDATION.
           PERFORM ef-adr-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-adr-AFTER-VALIDATION
           .

       ef-peso-SHI-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-SHI, BeforeValidation>
      * <TOTEM:END>
           .

       ef-peso-SHI-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-SHI, AfterValidation>
      * <TOTEM:END>
           .

      * ef-peso-SHI's Validation
       ef-peso-SHI-VALIDATION.
           PERFORM ef-peso-SHI-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-peso-SHI-AFTER-VALIDATION
           .

       ef-peso-GET-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-GET, BeforeValidation>
      * <TOTEM:END>
           .

       ef-peso-GET-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-GET, AfterValidation>
      * <TOTEM:END>
           .

      * ef-peso-GET's Validation
       ef-peso-GET-VALIDATION.
           PERFORM ef-peso-GET-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-peso-GET-AFTER-VALIDATION
           .

       ef-altezza-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-altezza, BeforeValidation>
      * <TOTEM:END>
           .

       ef-altezza-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-altezza, AfterValidation>
      * <TOTEM:END>
           .

      * ef-altezza's Validation
       ef-altezza-VALIDATION.
           PERFORM ef-altezza-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-altezza-AFTER-VALIDATION
           .

       ef-larghezza-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-larghezza, BeforeValidation>
      * <TOTEM:END>
           .

       ef-larghezza-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-larghezza, AfterValidation>
      * <TOTEM:END>
           .

      * ef-larghezza's Validation
       ef-larghezza-VALIDATION.
           PERFORM ef-larghezza-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-larghezza-AFTER-VALIDATION
           .

       ef-profondita-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-profondita, BeforeValidation>
      * <TOTEM:END>
           .

       ef-profondita-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-profondita, AfterValidation>
      * <TOTEM:END>
           .

      * ef-profondita's Validation
       ef-profondita-VALIDATION.
           PERFORM ef-profondita-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-profondita-AFTER-VALIDATION
           .

       ef-qta-epal-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-epal, BeforeValidation>
      * <TOTEM:END>
           .

       ef-qta-epal-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-epal, AfterValidation>
      * <TOTEM:END>
           .

      * ef-qta-epal's Validation
       ef-qta-epal-VALIDATION.
           PERFORM ef-qta-epal-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-qta-epal-AFTER-VALIDATION
           .

       ef-qta-std-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-std, BeforeValidation>
      * <TOTEM:END>
           .

       ef-qta-std-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-std, AfterValidation>
      * <TOTEM:END>
           .

      * ef-qta-std's Validation
       ef-qta-std-VALIDATION.
           PERFORM ef-qta-std-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-qta-std-AFTER-VALIDATION
           .

       ef-peso-utf-prg-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-utf-prg, BeforeValidation>
      * <TOTEM:END>
           .

       ef-peso-utf-prg-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-utf-prg, AfterValidation>
      * <TOTEM:END>
           .

      * ef-peso-utf-prg's Validation
       ef-peso-utf-prg-VALIDATION.
           PERFORM ef-peso-utf-prg-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-peso-utf-prg-AFTER-VALIDATION
           .

       ef-peso-non-utf-prg-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-non-utf-prg, BeforeValidation>
      * <TOTEM:END>
           .

       ef-peso-non-utf-prg-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-non-utf-prg, AfterValidation>
      * <TOTEM:END>
           .

      * ef-peso-non-utf-prg's Validation
       ef-peso-non-utf-prg-VALIDATION.
           PERFORM ef-peso-non-utf-prg-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-peso-non-utf-prg-AFTER-VALIDATION
           .

       EF-COSTO-ULTIMO-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-COSTO-ULTIMO, BeforeValidation>
      * <TOTEM:END>
           .

       EF-COSTO-ULTIMO-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-COSTO-ULTIMO, AfterValidation>
      * <TOTEM:END>
           .

      * EF-COSTO-ULTIMO's Validation
       EF-COSTO-ULTIMO-VALIDATION.
           PERFORM EF-COSTO-ULTIMO-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-COSTO-ULTIMO-AFTER-VALIDATION
           .

       EF-COSTO-MEDIO-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-COSTO-MEDIO, BeforeValidation>
      * <TOTEM:END>
           .

       EF-COSTO-MEDIO-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-COSTO-MEDIO, AfterValidation>
      * <TOTEM:END>
           .

      * EF-COSTO-MEDIO's Validation
       EF-COSTO-MEDIO-VALIDATION.
           PERFORM EF-COSTO-MEDIO-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-COSTO-MEDIO-AFTER-VALIDATION
           .

       EF-COSTO-MP-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-COSTO-MP, BeforeValidation>
      * <TOTEM:END>
           .

       EF-COSTO-MP-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-COSTO-MP, AfterValidation>
      * <TOTEM:END>
           .

      * EF-COSTO-MP's Validation
       EF-COSTO-MP-VALIDATION.
           PERFORM EF-COSTO-MP-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-COSTO-MP-AFTER-VALIDATION
           .

       EF-GIACENZA-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-GIACENZA, BeforeValidation>
      * <TOTEM:END>
           .

       EF-GIACENZA-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-GIACENZA, AfterValidation>
      * <TOTEM:END>
           .

      * EF-GIACENZA's Validation
       EF-GIACENZA-VALIDATION.
           PERFORM EF-GIACENZA-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-GIACENZA-AFTER-VALIDATION
           .

       EF-ORD-CLI-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-CLI, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ORD-CLI-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-CLI, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ORD-CLI's Validation
       EF-ORD-CLI-VALIDATION.
           PERFORM EF-ORD-CLI-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ORD-CLI-AFTER-VALIDATION
           .

       ef-giac-buona-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-giac-buona, BeforeValidation>
      * <TOTEM:END>
           .

       ef-giac-buona-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-giac-buona, AfterValidation>
      * <TOTEM:END>
           .

      * ef-giac-buona's Validation
       ef-giac-buona-VALIDATION.
           PERFORM ef-giac-buona-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-giac-buona-AFTER-VALIDATION
           .

       EF-ORD-FORN-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORN, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ORD-FORN-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORN, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ORD-FORN's Validation
       EF-ORD-FORN-VALIDATION.
           PERFORM EF-ORD-FORN-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ORD-FORN-AFTER-VALIDATION
           .

       EF-ORD-FORNa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNa, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ORD-FORNa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNa, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ORD-FORNa's Validation
       EF-ORD-FORNa-VALIDATION.
           PERFORM EF-ORD-FORNa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ORD-FORNa-AFTER-VALIDATION
           .

       EF-ORD-FORNb-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNb, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ORD-FORNb-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNb, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ORD-FORNb's Validation
       EF-ORD-FORNb-VALIDATION.
           PERFORM EF-ORD-FORNb-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ORD-FORNb-AFTER-VALIDATION
           .

       EF-ORD-FORNc-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNc, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ORD-FORNc-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNc, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ORD-FORNc's Validation
       EF-ORD-FORNc-VALIDATION.
           PERFORM EF-ORD-FORNc-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ORD-FORNc-AFTER-VALIDATION
           .

       EF-ORD-FORNca-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNca, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ORD-FORNca-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNca, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ORD-FORNca's Validation
       EF-ORD-FORNca-VALIDATION.
           PERFORM EF-ORD-FORNca-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ORD-FORNca-AFTER-VALIDATION
           .

       EF-ORD-FORNcb-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNcb, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ORD-FORNcb-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ORD-FORNcb, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ORD-FORNcb's Validation
       EF-ORD-FORNcb-VALIDATION.
           PERFORM EF-ORD-FORNcb-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ORD-FORNcb-AFTER-VALIDATION
           .

       EF-INI-UDM-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-INI-UDM, BeforeValidation>
      * <TOTEM:END>
           .

       EF-INI-UDM-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-INI-UDM, AfterValidation>
      * <TOTEM:END>
           .

      * EF-INI-UDM's Validation
       EF-INI-UDM-VALIDATION.
           PERFORM EF-INI-UDM-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-INI-UDM-AFTER-VALIDATION
           .

       EF-INI-KG-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-INI-KG, BeforeValidation>
      * <TOTEM:END>
           .

       EF-INI-KG-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-INI-KG, AfterValidation>
      * <TOTEM:END>
           .

      * EF-INI-KG's Validation
       EF-INI-KG-VALIDATION.
           PERFORM EF-INI-KG-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-INI-KG-AFTER-VALIDATION
           .

       EF-INI-VALORE-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-INI-VALORE, BeforeValidation>
      * <TOTEM:END>
           .

       EF-INI-VALORE-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-INI-VALORE, AfterValidation>
      * <TOTEM:END>
           .

      * EF-INI-VALORE's Validation
       EF-INI-VALORE-VALIDATION.
           PERFORM EF-INI-VALORE-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-INI-VALORE-AFTER-VALIDATION
           .

       EF-ACQ-UDM-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ACQ-UDM, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ACQ-UDM-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ACQ-UDM, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ACQ-UDM's Validation
       EF-ACQ-UDM-VALIDATION.
           PERFORM EF-ACQ-UDM-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ACQ-UDM-AFTER-VALIDATION
           .

       EF-ACQ-KG-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ACQ-KG, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ACQ-KG-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ACQ-KG, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ACQ-KG's Validation
       EF-ACQ-KG-VALIDATION.
           PERFORM EF-ACQ-KG-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ACQ-KG-AFTER-VALIDATION
           .

       EF-ACQ-VALORE-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ACQ-VALORE, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ACQ-VALORE-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ACQ-VALORE, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ACQ-VALORE's Validation
       EF-ACQ-VALORE-VALIDATION.
           PERFORM EF-ACQ-VALORE-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ACQ-VALORE-AFTER-VALIDATION
           .

       EF-VEN-UDM-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VEN-UDM, BeforeValidation>
      * <TOTEM:END>
           .

       EF-VEN-UDM-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VEN-UDM, AfterValidation>
      * <TOTEM:END>
           .

      * EF-VEN-UDM's Validation
       EF-VEN-UDM-VALIDATION.
           PERFORM EF-VEN-UDM-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-VEN-UDM-AFTER-VALIDATION
           .

       EF-VEN-KG-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VEN-KG, BeforeValidation>
      * <TOTEM:END>
           .

       EF-VEN-KG-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VEN-KG, AfterValidation>
      * <TOTEM:END>
           .

      * EF-VEN-KG's Validation
       EF-VEN-KG-VALIDATION.
           PERFORM EF-VEN-KG-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-VEN-KG-AFTER-VALIDATION
           .

       EF-VEN-VALORE-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VEN-VALORE, BeforeValidation>
      * <TOTEM:END>
           .

       EF-VEN-VALORE-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VEN-VALORE, AfterValidation>
      * <TOTEM:END>
           .

      * EF-VEN-VALORE's Validation
       EF-VEN-VALORE-VALIDATION.
           PERFORM EF-VEN-VALORE-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-VEN-VALORE-AFTER-VALIDATION
           .

       EF-VAR-UDM-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VAR-UDM, BeforeValidation>
      * <TOTEM:END>
           .

       EF-VAR-UDM-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VAR-UDM, AfterValidation>
      * <TOTEM:END>
           .

      * EF-VAR-UDM's Validation
       EF-VAR-UDM-VALIDATION.
           PERFORM EF-VAR-UDM-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-VAR-UDM-AFTER-VALIDATION
           .

       EF-VAR-KG-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VAR-KG, BeforeValidation>
      * <TOTEM:END>
           .

       EF-VAR-KG-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VAR-KG, AfterValidation>
      * <TOTEM:END>
           .

      * EF-VAR-KG's Validation
       EF-VAR-KG-VALIDATION.
           PERFORM EF-VAR-KG-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-VAR-KG-AFTER-VALIDATION
           .

       EF-VAR-VALORE-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VAR-VALORE, BeforeValidation>
      * <TOTEM:END>
           .

       EF-VAR-VALORE-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-VAR-VALORE, AfterValidation>
      * <TOTEM:END>
           .

      * EF-VAR-VALORE's Validation
       EF-VAR-VALORE-VALIDATION.
           PERFORM EF-VAR-VALORE-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-VAR-VALORE-AFTER-VALIDATION
           .

       EF-FORN-UDM-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-UDM, BeforeValidation>
      * <TOTEM:END>
           .

       EF-FORN-UDM-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-UDM, AfterValidation>
      * <TOTEM:END>
           .

      * EF-FORN-UDM's Validation
       EF-FORN-UDM-VALIDATION.
           PERFORM EF-FORN-UDM-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-FORN-UDM-AFTER-VALIDATION
           .

       EF-FORN-KG-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-KG, BeforeValidation>
      * <TOTEM:END>
           .

       EF-FORN-KG-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-KG, AfterValidation>
      * <TOTEM:END>
           .

      * EF-FORN-KG's Validation
       EF-FORN-KG-VALIDATION.
           PERFORM EF-FORN-KG-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-FORN-KG-AFTER-VALIDATION
           .

       EF-FORN-VALORE-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-VALORE, BeforeValidation>
      * <TOTEM:END>
           .

       EF-FORN-VALORE-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-VALORE, AfterValidation>
      * <TOTEM:END>
           .

      * EF-FORN-VALORE's Validation
       EF-FORN-VALORE-VALIDATION.
           PERFORM EF-FORN-VALORE-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-FORN-VALORE-AFTER-VALIDATION
           .

       EF-CLI-UDM-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-UDM, BeforeValidation>
      * <TOTEM:END>
           .

       EF-CLI-UDM-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-UDM, AfterValidation>
      * <TOTEM:END>
           .

      * EF-CLI-UDM's Validation
       EF-CLI-UDM-VALIDATION.
           PERFORM EF-CLI-UDM-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-CLI-UDM-AFTER-VALIDATION
           .

       EF-CLI-KG-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-KG, BeforeValidation>
      * <TOTEM:END>
           .

       EF-CLI-KG-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-KG, AfterValidation>
      * <TOTEM:END>
           .

      * EF-CLI-KG's Validation
       EF-CLI-KG-VALIDATION.
           PERFORM EF-CLI-KG-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-CLI-KG-AFTER-VALIDATION
           .

       EF-CLI-VALORE-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-VALORE, BeforeValidation>
      * <TOTEM:END>
           .

       EF-CLI-VALORE-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-VALORE, AfterValidation>
      * <TOTEM:END>
           .

      * EF-CLI-VALORE's Validation
       EF-CLI-VALORE-VALIDATION.
           PERFORM EF-CLI-VALORE-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-CLI-VALORE-AFTER-VALIDATION
           .

       EF-FORN-UDMa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-UDMa, BeforeValidation>
      * <TOTEM:END>
           .

       EF-FORN-UDMa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-UDMa, AfterValidation>
      * <TOTEM:END>
           .

      * EF-FORN-UDMa's Validation
       EF-FORN-UDMa-VALIDATION.
           PERFORM EF-FORN-UDMa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-FORN-UDMa-AFTER-VALIDATION
           .

       EF-FORN-KGa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-KGa, BeforeValidation>
      * <TOTEM:END>
           .

       EF-FORN-KGa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-KGa, AfterValidation>
      * <TOTEM:END>
           .

      * EF-FORN-KGa's Validation
       EF-FORN-KGa-VALIDATION.
           PERFORM EF-FORN-KGa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-FORN-KGa-AFTER-VALIDATION
           .

       EF-FORN-VALOREa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-VALOREa, BeforeValidation>
      * <TOTEM:END>
           .

       EF-FORN-VALOREa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-FORN-VALOREa, AfterValidation>
      * <TOTEM:END>
           .

      * EF-FORN-VALOREa's Validation
       EF-FORN-VALOREa-VALIDATION.
           PERFORM EF-FORN-VALOREa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-FORN-VALOREa-AFTER-VALIDATION
           .

       EF-CLI-UDMa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-UDMa, BeforeValidation>
      * <TOTEM:END>
           .

       EF-CLI-UDMa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-UDMa, AfterValidation>
      * <TOTEM:END>
           .

      * EF-CLI-UDMa's Validation
       EF-CLI-UDMa-VALIDATION.
           PERFORM EF-CLI-UDMa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-CLI-UDMa-AFTER-VALIDATION
           .

       EF-CLI-KGa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-KGa, BeforeValidation>
      * <TOTEM:END>
           .

       EF-CLI-KGa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-KGa, AfterValidation>
      * <TOTEM:END>
           .

      * EF-CLI-KGa's Validation
       EF-CLI-KGa-VALIDATION.
           PERFORM EF-CLI-KGa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-CLI-KGa-AFTER-VALIDATION
           .

       EF-CLI-VALOREa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-VALOREa, BeforeValidation>
      * <TOTEM:END>
           .

       EF-CLI-VALOREa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-CLI-VALOREa, AfterValidation>
      * <TOTEM:END>
           .

      * EF-CLI-VALOREa's Validation
       EF-CLI-VALOREa-VALIDATION.
           PERFORM EF-CLI-VALOREa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-CLI-VALOREa-AFTER-VALIDATION
           .

       ef-gia-udm-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gia-udm, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gia-udm-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gia-udm, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gia-udm's Validation
       ef-gia-udm-VALIDATION.
           PERFORM ef-gia-udm-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gia-udm-AFTER-VALIDATION
           .

       ef-gia-kg-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gia-kg, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gia-kg-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gia-kg, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gia-kg's Validation
       ef-gia-kg-VALIDATION.
           PERFORM ef-gia-kg-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gia-kg-AFTER-VALIDATION
           .

       ef-dt-val-da-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dt-val-da, BeforeValidation>
      * <TOTEM:END>
           .

       ef-dt-val-da-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dt-val-da, AfterValidation>
      * <TOTEM:END>
           .

      * ef-dt-val-da's Validation
       ef-dt-val-da-VALIDATION.
           PERFORM ef-dt-val-da-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-dt-val-da-AFTER-VALIDATION
           .

       ef-dt-val-a-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dt-val-a, BeforeValidation>
      * <TOTEM:END>
           .

       ef-dt-val-a-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dt-val-a, AfterValidation>
      * <TOTEM:END>
           .

      * ef-dt-val-a's Validation
       ef-dt-val-a-VALIDATION.
           PERFORM ef-dt-val-a-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-dt-val-a-AFTER-VALIDATION
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * DB_Entry-Field : ef-codice
           MOVE ef-codice-BUF TO art-codice of articoli
      * DB_Entry-Field : ef-des1
           MOVE ef-des1-BUF TO art-descrizione1 OF articoli
      * DB_Entry-Field : ef-des2
           MOVE ef-des2-BUF TO art-descrizione2 OF articoli
      * DB_Entry-Field : ef-des-altern
           MOVE ef-des-altern-BUF TO art-descrizione-2 of articoli
      * DB_Entry-Field : ef-coll
           MOVE ef-coll-BUF TO art-collegato of articoli
      * DB_Entry-Field : ef-setmerc
           MOVE ef-setmerc-BUF TO art-settore-merceologico of articoli
      * DB_Entry-Field : ef-iva
           MOVE ef-iva-BUF TO art-codice-iva of articoli
      * DB_Entry-Field : ef-marca
           MOVE ef-marca-BUF TO art-marca-prodotto of articoli
      * DB_Entry-Field : ef-mag
           MOVE ef-mag-BUF TO art-mag-std of articoli
      * DB_Entry-Field : ef-classe-1
           MOVE ef-classe-1-BUF TO art-classe-1 of articoli
      * DB_Entry-Field : ef-classe-2
           MOVE ef-classe-2-BUF TO art-classe-2 of articoli
      * DB_Entry-Field : ef-classe-3
           MOVE ef-classe-3-BUF TO art-classe-3 of articoli
      * DB_Entry-Field : ef-classe-4
           MOVE ef-classe-4-BUF TO art-classe-4 of articoli
      * DB_Entry-Field : ef-udm
           MOVE ef-udm-BUF TO art-unita-di-misura of articoli
      * DB_Entry-Field : ef-imballo
           MOVE ef-imballo-BUF TO art-imballo-standard of articoli
      * DB_Entry-Field : ef-udm-imballo
           MOVE ef-udm-imballo-BUF TO art-udm-imballo of articoli
      * DB_Entry-Field : ef-dogana
           MOVE ef-dogana-BUF TO art-cod-doganale of articoli
      * DB_Entry-Field : ef-peso-utf
           MOVE ef-peso-utf-BUF TO art-peso-utf of articoli
      * DB_Entry-Field : ef-peso-non-utf
           MOVE ef-peso-non-utf-BUF TO art-peso-non-utf of articoli
      * DB_Entry-Field : ef-prodener
           MOVE ef-prodener-BUF TO art-cod-prodener OF articoli
      * DB_CHECK BOX : chk-novita
              IF chk-novita-BUF = 1
                 MOVE 1 TO art-novita OF articoli
              ELSE
                 MOVE 0 TO art-novita OF articoli
              END-IF
      * DB_RADIOBOX : Form1-DaRb-1, Form1-DaRb-2, 
           EVALUATE Form1-RADIO-1-BUF
           WHEN 1
              MOVE "C" TO art-tipo-stoc OF articoli
           WHEN 2
              MOVE "S" TO art-tipo-stoc OF articoli
           WHEN OTHER
              MOVE SPACE TO art-tipo-stoc OF articoli
           END-EVALUATE
      * DB_CHECK BOX : chk-imposte
              IF chk-imposte-BUF = 1
                 MOVE "S" TO art-soggetto-imposte of articoli
              ELSE
                 MOVE "N" TO art-soggetto-imposte of articoli
              END-IF
      * DB_Entry-Field : ef-perce-imposte
           MOVE ef-perce-imposte-BUF TO art-perce-imposte of articoli
      * DB_Entry-Field : ef-perce-cou
           MOVE ef-perce-cou-BUF TO art-perce-cou of articoli
      * DB_Entry-Field : ef-scorta
           MOVE ef-scorta-BUF TO art-scorta of articoli
      * DB_Entry-Field : ef-moq
           MOVE ef-moq-BUF TO art-moq of articoli
      * DB_CHECK BOX : chk-cobat
              IF chk-cobat-BUF = 1
                 MOVE "S" TO art-soggetto-cobat of articoli
              ELSE
                 MOVE "N" TO art-soggetto-cobat of articoli
              END-IF
      * DB_Entry-Field : ef-amperaggio
           MOVE ef-amperaggio-BUF TO art-amperaggio of articoli
      * DB_Entry-Field : ef-reale
           MOVE ef-reale-BUF TO art-peso-reale of articoli
      * DB_Entry-Field : ef-prezzo-acq
           MOVE ef-prezzo-acq-BUF TO art-prezzo-acquisto of articoli
      * DB_Entry-Field : ef-sconto-acquisto
           MOVE ef-sconto-acquisto-BUF TO art-perce-sconto-acquisto of 
           articoli
      * DB_Entry-Field : ef-prz-vend
           MOVE ef-prz-vend-BUF TO art-prezzo-vendita of articoli
      * DB_Entry-Field : ef-litri
           MOVE ef-litri-BUF TO art-litri of articoli
      * DB_Entry-Field : ef-prezzo-banco
           MOVE ef-prezzo-banco-BUF TO art-prezzo-banco of articoli
      * DB_Entry-Field : ef-sconto-agente
           MOVE ef-sconto-agente-BUF TO art-perce-sconto-agente of 
           articoli
      * DB_Entry-Field : ef-min-vend
           MOVE ef-min-vend-BUF TO art-prz-min-vend of articoli
      * DB_Entry-Field : ef-ean-1
           MOVE ef-ean-1-BUF TO art-codice-ean-1 of articoli
      * DB_Entry-Field : ef-ean-2
           MOVE ef-ean-2-BUF TO art-codice-ean-2 of articoli
      * DB_Entry-Field : ef-ean-3
           MOVE ef-ean-3-BUF TO art-codice-ean-3 of articoli
      * DB_Entry-Field : ef-ean-4
           MOVE ef-ean-4-BUF TO art-codice-ean-4 of articoli
      * DB_Entry-Field : ef-ean-5
           MOVE ef-ean-5-BUF TO art-codice-ean-5 of articoli
      * DB_Entry-Field : ef-art-for
           MOVE ef-art-for-BUF TO art-cod-art-frn of articoli
      * DB_Entry-Field : ef-forn
           MOVE ef-forn-BUF TO art-cod-fornitore of articoli
      * DB_Entry-Field : ef-destino
           MOVE ef-destino-BUF TO art-cod-desf-forn OF articoli
      * DB_Entry-Field : ef-note2
           MOVE ef-note2-BUF TO art-note2 OF articoli
      * DB_CHECK BOX : chk-ala
              IF chk-ala-BUF = 1
                 MOVE 1 TO art-ala of articoli
              ELSE
                 MOVE 0 TO art-ala of articoli
              END-IF
      * DB_CHECK BOX : chk-agenti
              IF chk-agenti-BUF = 1
                 MOVE 1 TO art-agenti of articoli
              ELSE
                 MOVE 0 TO art-agenti of articoli
              END-IF
      * DB_CHECK BOX : chk-eg
              IF chk-eg-BUF = 1
                 MOVE 1 TO art-do of articoli
              ELSE
                 MOVE 0 TO art-do of articoli
              END-IF
      * DB_CHECK BOX : chk-cepsa
              IF chk-cepsa-BUF = 1
                 MOVE 1 TO art-SHARK OF articoli
              ELSE
                 MOVE 0 TO art-SHARK OF articoli
              END-IF
      * DB_CHECK BOX : chk-gda
              IF chk-gda-BUF = 1
                 MOVE 1 TO art-gda of articoli
              ELSE
                 MOVE 0 TO art-gda of articoli
              END-IF
      * DB_CHECK BOX : chk-specialist
              IF chk-specialist-BUF = 1
                 MOVE 1 TO art-specialist of articoli
              ELSE
                 MOVE 0 TO art-specialist of articoli
              END-IF
      * DB_CHECK BOX : chk-gds
              IF chk-gds-BUF = 1
                 MOVE 1 TO art-gds of articoli
              ELSE
                 MOVE 0 TO art-gds of articoli
              END-IF
      * DB_CHECK BOX : chk-gruppi
              IF chk-gruppi-BUF = 1
                 MOVE 1 TO art-gruppi of articoli
              ELSE
                 MOVE 0 TO art-gruppi of articoli
              END-IF
      * DB_CHECK BOX : chk-estero
              IF chk-estero-BUF = 1
                 MOVE 1 TO art-estero of articoli
              ELSE
                 MOVE 0 TO art-estero of articoli
              END-IF
      * DB_CHECK BOX : chk-web
              IF chk-web-BUF = 1
                 MOVE 1 TO art-web of articoli
              ELSE
                 MOVE 0 TO art-web of articoli
              END-IF
      * DB_CHECK BOX : chk-SPI
              IF chk-SPI-BUF = 1
                 MOVE 1 TO art-SPI of articoli
              ELSE
                 MOVE 0 TO art-SPI of articoli
              END-IF
      * DB_CHECK BOX : chk-AT
              IF chk-AT-BUF = 1
                 MOVE 1 TO art-AT of articoli
              ELSE
                 MOVE 0 TO art-AT of articoli
              END-IF
      * DB_CHECK BOX : chk-ATa
              IF chk-ATa-BUF = 1
                 MOVE 1 TO art-TEXACO OF articoli
              ELSE
                 MOVE 0 TO art-TEXACO OF articoli
              END-IF
      * DB_Entry-Field : ef-note-agg
           MOVE ef-note-agg-BUF TO art-note-agg of articoli
      * DB_Entry-Field : ef-foto
           MOVE ef-foto-BUF TO art-foto of articoli
      * DB_Entry-Field : ef-brand
           MOVE ef-brand-BUF TO art-logo-brand OF articoli
      * DB_Entry-Field : ef-scheda
           MOVE ef-scheda-BUF TO art-scheda-tecnica of articoli
      * DB_Entry-Field : ef-toss
           MOVE ef-toss-BUF TO art-tossicologica of articoli
      * DB_Entry-Field : ef-des-ing
           MOVE ef-des-ing-BUF TO art-des-ing of articoli
      * DB_Entry-Field : ef-des-spa
           MOVE ef-des-spa-BUF TO art-des-spa of articoli
      * DB_Entry-Field : ef-altezza-pz
           MOVE ef-altezza-pz-BUF TO art-altezza-pz OF articoli
      * DB_Entry-Field : ef-larghezza-pz
           MOVE ef-larghezza-pz-BUF TO art-larghezza-pz OF articoli
      * DB_Entry-Field : ef-profondita-pz
           MOVE ef-profondita-pz-BUF TO art-profondita-pz of articoli
      * DB_Entry-Field : ef-qta-cartone
           MOVE ef-qta-cartone-BUF TO art-conf-cartone OF articoli
      * DB_Entry-Field : ef-qta-stda
           MOVE ef-qta-stda-BUF TO art-cartone-UDC OF articoli
      * DB_Entry-Field : ef-adr
           MOVE ef-adr-BUF TO art-adr OF articoli
      * DB_Entry-Field : ef-peso-SHI
           MOVE ef-peso-SHI-BUF TO art-peso-SHI of articoli
      * DB_Entry-Field : ef-peso-GET
           MOVE ef-peso-GET-BUF TO art-peso-GET of articoli
      * DB_Entry-Field : ef-altezza
           MOVE ef-altezza-BUF TO art-altezza of articoli
      * DB_Entry-Field : ef-larghezza
           MOVE ef-larghezza-BUF TO art-larghezza of articoli
      * DB_Entry-Field : ef-profondita
           MOVE ef-profondita-BUF TO art-profondita of articoli
      * DB_Entry-Field : ef-qta-epal
           MOVE ef-qta-epal-BUF TO art-qta-epal of articoli
      * DB_Entry-Field : ef-qta-std
           MOVE ef-qta-std-BUF TO art-qta-std of articoli
      * DB_CHECK BOX : chk-T1
              IF chk-T1-BUF = 1
                 MOVE 1 TO art-T1 of articoli
              ELSE
                 MOVE 0 TO art-T1 of articoli
              END-IF
      * DB_CHECK BOX : chk-T2
              IF chk-T2-BUF = 1
                 MOVE 1 TO art-T2 of articoli
              ELSE
                 MOVE 0 TO art-T2 of articoli
              END-IF
      * DB_CHECK BOX : chk-T3
              IF chk-T3-BUF = 1
                 MOVE 1 TO art-T3 of articoli
              ELSE
                 MOVE 0 TO art-T3 of articoli
              END-IF
      * DB_Entry-Field : ef-peso-utf-prg
           MOVE ef-peso-utf-prg-BUF TO prg-peso-utf
      * DB_Entry-Field : ef-peso-non-utf-prg
           MOVE ef-peso-non-utf-prg-BUF TO prg-peso-non-utf
      * DB_Entry-Field : EF-COSTO-ULTIMO
           MOVE EF-COSTO-ULTIMO-BUF TO prg-costo-ultimo
      * DB_Entry-Field : EF-COSTO-MEDIO
           MOVE EF-COSTO-MEDIO-BUF TO prg-costo-medio
      * DB_Entry-Field : EF-COSTO-MP
           MOVE EF-COSTO-MP-BUF TO costo-mp-2dec
      * DB_Entry-Field : EF-GIACENZA
           MOVE EF-GIACENZA-BUF TO prg-giacenza
      * DB_Entry-Field : EF-ORD-CLI
           MOVE EF-ORD-CLI-BUF TO prg-impegnato
      * DB_Entry-Field : ef-giac-buona
           MOVE ef-giac-buona-BUF TO giac-buona
      * DB_Entry-Field : EF-ORD-FORN
           MOVE EF-ORD-FORN-BUF TO prg-ordinato-1
      * DB_Entry-Field : EF-ORD-FORNa
           MOVE EF-ORD-FORNa-BUF TO prg-ordinato-2
      * DB_Entry-Field : EF-ORD-FORNb
           MOVE EF-ORD-FORNb-BUF TO prg-ordinato-3
      * DB_Entry-Field : EF-ORD-FORNc
           MOVE EF-ORD-FORNc-BUF TO prg-ordinato-4
      * DB_Entry-Field : EF-ORD-FORNca
           MOVE EF-ORD-FORNca-BUF TO prg-ordinato-5
      * DB_Entry-Field : EF-ORD-FORNcb
           MOVE EF-ORD-FORNcb-BUF TO prg-ordinato-6
      * DB_Entry-Field : EF-INI-UDM
           MOVE EF-INI-UDM-BUF TO prg-ini-udm
      * DB_Entry-Field : EF-INI-KG
           MOVE EF-INI-KG-BUF TO prg-ini-kg
      * DB_Entry-Field : EF-INI-VALORE
           MOVE EF-INI-VALORE-BUF TO prg-ini-valore
      * DB_Entry-Field : EF-ACQ-UDM
           MOVE EF-ACQ-UDM-BUF TO prg-acq-udm
      * DB_Entry-Field : EF-ACQ-KG
           MOVE EF-ACQ-KG-BUF TO prg-acq-kg
      * DB_Entry-Field : EF-ACQ-VALORE
           MOVE EF-ACQ-VALORE-BUF TO prg-acq-valore
      * DB_Entry-Field : EF-VEN-UDM
           MOVE EF-VEN-UDM-BUF TO prg-ven-udm
      * DB_Entry-Field : EF-VEN-KG
           MOVE EF-VEN-KG-BUF TO prg-ven-kg
      * DB_Entry-Field : EF-VEN-VALORE
           MOVE EF-VEN-VALORE-BUF TO prg-ven-valore
      * DB_Entry-Field : EF-VAR-UDM
           MOVE EF-VAR-UDM-BUF TO prg-var-inv-udm
      * DB_Entry-Field : EF-VAR-KG
           MOVE EF-VAR-KG-BUF TO prg-var-inv-kg
      * DB_Entry-Field : EF-VAR-VALORE
           MOVE EF-VAR-VALORE-BUF TO prg-var-inv-valore
      * DB_Entry-Field : EF-FORN-UDM
           MOVE EF-FORN-UDM-BUF TO prg-resi-fornitori-udm
      * DB_Entry-Field : EF-FORN-KG
           MOVE EF-FORN-KG-BUF TO prg-resi-fornitori-kg
      * DB_Entry-Field : EF-FORN-VALORE
           MOVE EF-FORN-VALORE-BUF TO prg-resi-fornitori-valore
      * DB_Entry-Field : EF-CLI-UDM
           MOVE EF-CLI-UDM-BUF TO prg-resi-da-cli-udm
      * DB_Entry-Field : EF-CLI-KG
           MOVE EF-CLI-KG-BUF TO prg-resi-da-cli-kg
      * DB_Entry-Field : EF-CLI-VALORE
           MOVE EF-CLI-VALORE-BUF TO prg-resi-da-cli-valore
      * DB_Entry-Field : EF-FORN-UDMa
           MOVE EF-FORN-UDMa-BUF TO prg-udm-el
      * DB_Entry-Field : EF-FORN-KGa
           MOVE EF-FORN-KGa-BUF TO prg-kg-el
      * DB_Entry-Field : EF-FORN-VALOREa
           MOVE EF-FORN-VALOREa-BUF TO prg-valore-el
      * DB_Entry-Field : EF-CLI-UDMa
           MOVE EF-CLI-UDMa-BUF TO prg-udm-ul
      * DB_Entry-Field : EF-CLI-KGa
           MOVE EF-CLI-KGa-BUF TO prg-kg-ul
      * DB_Entry-Field : EF-CLI-VALOREa
           MOVE EF-CLI-VALOREa-BUF TO prg-valore-ul
      * DB_Entry-Field : ef-gia-udm
           MOVE ef-gia-udm-BUF TO prg-giacenza-udm
      * DB_Entry-Field : ef-gia-kg
           MOVE ef-gia-kg-BUF TO prg-giacenza-kg
      * DB_Entry-Field : ef-dt-val-da
           MOVE ef-dt-val-da-BUF TO data-val-da
      * DB_Entry-Field : ef-dt-val-a
           MOVE ef-dt-val-a-BUF TO data-val-a
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
           perform GARTICOLI-AFTER-BUF-TO-FLD.

           .
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
           perform GARTICOLI-BEFORE-FLD-TO-BUF.

           .
      * <TOTEM:END>
      * DB_Entry-Field : ef-codice
           MOVE art-codice of articoli TO ef-codice-BUF
      * DB_LABEL : lab-dest
              MOVE desf-ragsoc-1  TO lab-dest-BUF
      * DB_Entry-Field : ef-des1
           MOVE art-descrizione1 OF articoli TO ef-des1-BUF
      * DB_Entry-Field : ef-des2
           MOVE art-descrizione2 OF articoli TO ef-des2-BUF
      * DB_Entry-Field : ef-des-altern
           MOVE art-descrizione-2 of articoli TO ef-des-altern-BUF
      * DB_Entry-Field : ef-coll
           MOVE art-collegato of articoli TO ef-coll-BUF
      * DB_Entry-Field : ef-setmerc
           MOVE art-settore-merceologico of articoli TO ef-setmerc-BUF
      * DB_Entry-Field : ef-iva
           MOVE art-codice-iva of articoli TO ef-iva-BUF
      * DB_Entry-Field : ef-marca
           MOVE art-marca-prodotto of articoli TO ef-marca-BUF
      * DB_Entry-Field : ef-mag
           MOVE art-mag-std of articoli TO ef-mag-BUF
      * DB_Entry-Field : ef-classe-1
           MOVE art-classe-1 of articoli TO ef-classe-1-BUF
      * DB_Entry-Field : ef-classe-2
           MOVE art-classe-2 of articoli TO ef-classe-2-BUF
      * DB_Entry-Field : ef-classe-3
           MOVE art-classe-3 of articoli TO ef-classe-3-BUF
      * DB_Entry-Field : ef-classe-4
           MOVE art-classe-4 of articoli TO ef-classe-4-BUF
      * DB_Entry-Field : ef-udm
           MOVE art-unita-di-misura of articoli TO ef-udm-BUF
      * DB_Entry-Field : ef-imballo
           MOVE art-imballo-standard of articoli TO ef-imballo-BUF
      * DB_Entry-Field : ef-udm-imballo
           MOVE art-udm-imballo of articoli TO ef-udm-imballo-BUF
      * DB_Entry-Field : ef-dogana
           MOVE art-cod-doganale of articoli TO ef-dogana-BUF
      * DB_Entry-Field : ef-peso-utf
           MOVE art-peso-utf of articoli TO ef-peso-utf-BUF
      * DB_Entry-Field : ef-peso-non-utf
           MOVE art-peso-non-utf of articoli TO ef-peso-non-utf-BUF
      * DB_Entry-Field : ef-prodener
           MOVE art-cod-prodener OF articoli TO ef-prodener-BUF
      * DB_CHECK BOX : chk-novita
              IF art-novita OF articoli = 1
                 MOVE 1 TO chk-novita-BUF
              ELSE
                 MOVE 0 TO chk-novita-BUF
              END-IF
      * DB_RADIOBOX : Form1-DaRb-1, Form1-DaRb-2, 
           EVALUATE art-tipo-stoc OF articoli
           WHEN "C"
              MOVE 1 TO Form1-RADIO-1-BUF
           WHEN "S"
              MOVE 2 TO Form1-RADIO-1-BUF
           WHEN OTHER
              MOVE ZERO TO Form1-RADIO-1-BUF
           END-EVALUATE
      * DB_CHECK BOX : chk-imposte
              IF art-soggetto-imposte of articoli = "S"
                 MOVE 1 TO chk-imposte-BUF
              ELSE
                 MOVE 0 TO chk-imposte-BUF
              END-IF
      * DB_Entry-Field : ef-perce-imposte
           MOVE art-perce-imposte of articoli TO ef-perce-imposte-BUF
      * DB_Entry-Field : ef-perce-cou
           MOVE art-perce-cou of articoli TO ef-perce-cou-BUF
      * DB_Entry-Field : ef-scorta
           MOVE art-scorta of articoli TO ef-scorta-BUF
      * DB_Entry-Field : ef-moq
           MOVE art-moq of articoli TO ef-moq-BUF
      * DB_CHECK BOX : chk-cobat
              IF art-soggetto-cobat of articoli = "S"
                 MOVE 1 TO chk-cobat-BUF
              ELSE
                 MOVE 0 TO chk-cobat-BUF
              END-IF
      * DB_Entry-Field : ef-amperaggio
           MOVE art-amperaggio of articoli TO ef-amperaggio-BUF
      * DB_Entry-Field : ef-reale
           MOVE art-peso-reale of articoli TO ef-reale-BUF
      * DB_Entry-Field : ef-prezzo-acq
           MOVE art-prezzo-acquisto of articoli TO ef-prezzo-acq-BUF
      * DB_Entry-Field : ef-sconto-acquisto
           MOVE art-perce-sconto-acquisto of articoli TO 
           ef-sconto-acquisto-BUF
      * DB_Entry-Field : ef-prz-vend
           MOVE art-prezzo-vendita of articoli TO ef-prz-vend-BUF
      * DB_Entry-Field : ef-litri
           MOVE art-litri of articoli TO ef-litri-BUF
      * DB_Entry-Field : ef-prezzo-banco
           MOVE art-prezzo-banco of articoli TO ef-prezzo-banco-BUF
      * DB_Entry-Field : ef-sconto-agente
           MOVE art-perce-sconto-agente of articoli TO 
           ef-sconto-agente-BUF
      * DB_Entry-Field : ef-min-vend
           MOVE art-prz-min-vend of articoli TO ef-min-vend-BUF
      * DB_Entry-Field : ef-ean-1
           MOVE art-codice-ean-1 of articoli TO ef-ean-1-BUF
      * DB_Entry-Field : ef-ean-2
           MOVE art-codice-ean-2 of articoli TO ef-ean-2-BUF
      * DB_Entry-Field : ef-ean-3
           MOVE art-codice-ean-3 of articoli TO ef-ean-3-BUF
      * DB_Entry-Field : ef-ean-4
           MOVE art-codice-ean-4 of articoli TO ef-ean-4-BUF
      * DB_Entry-Field : ef-ean-5
           MOVE art-codice-ean-5 of articoli TO ef-ean-5-BUF
      * DB_Entry-Field : ef-art-for
           MOVE art-cod-art-frn of articoli TO ef-art-for-BUF
      * DB_Entry-Field : ef-forn
           MOVE art-cod-fornitore of articoli TO ef-forn-BUF
      * DB_Entry-Field : ef-destino
           MOVE art-cod-desf-forn OF articoli TO ef-destino-BUF
      * DB_Entry-Field : ef-note2
           MOVE art-note2 OF articoli TO ef-note2-BUF
      * DB_CHECK BOX : chk-ala
              IF art-ala of articoli = 1
                 MOVE 1 TO chk-ala-BUF
              ELSE
                 MOVE 0 TO chk-ala-BUF
              END-IF
      * DB_CHECK BOX : chk-agenti
              IF art-agenti of articoli = 1
                 MOVE 1 TO chk-agenti-BUF
              ELSE
                 MOVE 0 TO chk-agenti-BUF
              END-IF
      * DB_CHECK BOX : chk-eg
              IF art-do of articoli = 1
                 MOVE 1 TO chk-eg-BUF
              ELSE
                 MOVE 0 TO chk-eg-BUF
              END-IF
      * DB_CHECK BOX : chk-cepsa
              IF art-SHARK OF articoli = 1
                 MOVE 1 TO chk-cepsa-BUF
              ELSE
                 MOVE 0 TO chk-cepsa-BUF
              END-IF
      * DB_CHECK BOX : chk-gda
              IF art-gda of articoli = 1
                 MOVE 1 TO chk-gda-BUF
              ELSE
                 MOVE 0 TO chk-gda-BUF
              END-IF
      * DB_CHECK BOX : chk-specialist
              IF art-specialist of articoli = 1
                 MOVE 1 TO chk-specialist-BUF
              ELSE
                 MOVE 0 TO chk-specialist-BUF
              END-IF
      * DB_CHECK BOX : chk-gds
              IF art-gds of articoli = 1
                 MOVE 1 TO chk-gds-BUF
              ELSE
                 MOVE 0 TO chk-gds-BUF
              END-IF
      * DB_CHECK BOX : chk-gruppi
              IF art-gruppi of articoli = 1
                 MOVE 1 TO chk-gruppi-BUF
              ELSE
                 MOVE 0 TO chk-gruppi-BUF
              END-IF
      * DB_CHECK BOX : chk-estero
              IF art-estero of articoli = 1
                 MOVE 1 TO chk-estero-BUF
              ELSE
                 MOVE 0 TO chk-estero-BUF
              END-IF
      * DB_CHECK BOX : chk-web
              IF art-web of articoli = 1
                 MOVE 1 TO chk-web-BUF
              ELSE
                 MOVE 0 TO chk-web-BUF
              END-IF
      * DB_CHECK BOX : chk-SPI
              IF art-SPI of articoli = 1
                 MOVE 1 TO chk-SPI-BUF
              ELSE
                 MOVE 0 TO chk-SPI-BUF
              END-IF
      * DB_CHECK BOX : chk-AT
              IF art-AT of articoli = 1
                 MOVE 1 TO chk-AT-BUF
              ELSE
                 MOVE 0 TO chk-AT-BUF
              END-IF
      * DB_CHECK BOX : chk-ATa
              IF art-TEXACO OF articoli = 1
                 MOVE 1 TO chk-ATa-BUF
              ELSE
                 MOVE 0 TO chk-ATa-BUF
              END-IF
      * DB_LABEL : lab-setmerc
              MOVE sme-descrizione  TO lab-setmerc-BUF
      * DB_LABEL : lab-marca
              MOVE mar-descrizione  TO lab-marca-BUF
      * DB_LABEL : lab-classe
              MOVE cl1-descrizione  TO lab-classe-BUF
      * DB_LABEL : lab-udm
              MOVE udm-descrizione  TO lab-udm-BUF
      * DB_LABEL : lab-dogana
              MOVE nom-descrizione  TO lab-dogana-BUF
      * DB_LABEL : lab-forn
              MOVE cli-ragsoc-1  TO lab-forn-BUF
      * DB_LABEL : lab-mag
              MOVE mag-descrizione  TO lab-mag-BUF
      * DB_LABEL : lab-des-coll
              MOVE art-descrizione of articoli1  TO lab-des-coll-BUF
      * DB_LABEL : lab-prodener
              MOVE pen-descrizione  TO lab-prodener-BUF
      * DB_LABEL : lab-classe-2
              MOVE cl1-descrizione-2  TO lab-classe-2-BUF
      * DB_LABEL : lab-classe-4
              MOVE cl1-descrizione-4  TO lab-classe-4-BUF
      * DB_LABEL : lab-classe-3
              MOVE cl1-descrizione-3  TO lab-classe-3-BUF
      * DB_Entry-Field : ef-note-agg
           MOVE art-note-agg of articoli TO ef-note-agg-BUF
      * DB_Entry-Field : ef-foto
           MOVE art-foto of articoli TO ef-foto-BUF
      * DB_Entry-Field : ef-brand
           MOVE art-logo-brand OF articoli TO ef-brand-BUF
      * DB_Entry-Field : ef-scheda
           MOVE art-scheda-tecnica of articoli TO ef-scheda-BUF
      * DB_Entry-Field : ef-toss
           MOVE art-tossicologica of articoli TO ef-toss-BUF
      * DB_Entry-Field : ef-des-ing
           MOVE art-des-ing of articoli TO ef-des-ing-BUF
      * DB_Entry-Field : ef-des-spa
           MOVE art-des-spa of articoli TO ef-des-spa-BUF
      * DB_Entry-Field : ef-altezza-pz
           MOVE art-altezza-pz OF articoli TO ef-altezza-pz-BUF
      * DB_Entry-Field : ef-larghezza-pz
           MOVE art-larghezza-pz OF articoli TO ef-larghezza-pz-BUF
      * DB_Entry-Field : ef-profondita-pz
           MOVE art-profondita-pz of articoli TO ef-profondita-pz-BUF
      * DB_Entry-Field : ef-qta-cartone
           MOVE art-conf-cartone OF articoli TO ef-qta-cartone-BUF
      * DB_Entry-Field : ef-qta-stda
           MOVE art-cartone-UDC OF articoli TO ef-qta-stda-BUF
      * DB_Entry-Field : ef-adr
           MOVE art-adr OF articoli TO ef-adr-BUF
      * DB_Entry-Field : ef-peso-SHI
           MOVE art-peso-SHI of articoli TO ef-peso-SHI-BUF
      * DB_Entry-Field : ef-peso-GET
           MOVE art-peso-GET of articoli TO ef-peso-GET-BUF
      * DB_Entry-Field : ef-altezza
           MOVE art-altezza of articoli TO ef-altezza-BUF
      * DB_Entry-Field : ef-larghezza
           MOVE art-larghezza of articoli TO ef-larghezza-BUF
      * DB_Entry-Field : ef-profondita
           MOVE art-profondita of articoli TO ef-profondita-BUF
      * DB_Entry-Field : ef-qta-epal
           MOVE art-qta-epal of articoli TO ef-qta-epal-BUF
      * DB_Entry-Field : ef-qta-std
           MOVE art-qta-std of articoli TO ef-qta-std-BUF
      * DB_CHECK BOX : chk-T1
              IF art-T1 of articoli = 1
                 MOVE 1 TO chk-T1-BUF
              ELSE
                 MOVE 0 TO chk-T1-BUF
              END-IF
      * DB_CHECK BOX : chk-T2
              IF art-T2 of articoli = 1
                 MOVE 1 TO chk-T2-BUF
              ELSE
                 MOVE 0 TO chk-T2-BUF
              END-IF
      * DB_CHECK BOX : chk-T3
              IF art-T3 of articoli = 1
                 MOVE 1 TO chk-T3-BUF
              ELSE
                 MOVE 0 TO chk-T3-BUF
              END-IF
      * DB_Entry-Field : ef-peso-utf-prg
           MOVE prg-peso-utf TO ef-peso-utf-prg-BUF
      * DB_Entry-Field : ef-peso-non-utf-prg
           MOVE prg-peso-non-utf TO ef-peso-non-utf-prg-BUF
      * DB_Entry-Field : EF-COSTO-ULTIMO
           MOVE prg-costo-ultimo TO EF-COSTO-ULTIMO-BUF
      * DB_Entry-Field : EF-COSTO-MEDIO
           MOVE prg-costo-medio TO EF-COSTO-MEDIO-BUF
      * DB_Entry-Field : EF-COSTO-MP
           MOVE costo-mp-2dec TO EF-COSTO-MP-BUF
      * DB_Entry-Field : EF-GIACENZA
           MOVE prg-giacenza TO EF-GIACENZA-BUF
      * DB_Entry-Field : EF-ORD-CLI
           MOVE prg-impegnato TO EF-ORD-CLI-BUF
      * DB_Entry-Field : ef-giac-buona
           MOVE giac-buona TO ef-giac-buona-BUF
      * DB_Entry-Field : EF-ORD-FORN
           MOVE prg-ordinato-1 TO EF-ORD-FORN-BUF
      * DB_Entry-Field : EF-ORD-FORNa
           MOVE prg-ordinato-2 TO EF-ORD-FORNa-BUF
      * DB_Entry-Field : EF-ORD-FORNb
           MOVE prg-ordinato-3 TO EF-ORD-FORNb-BUF
      * DB_Entry-Field : EF-ORD-FORNc
           MOVE prg-ordinato-4 TO EF-ORD-FORNc-BUF
      * DB_Entry-Field : EF-ORD-FORNca
           MOVE prg-ordinato-5 TO EF-ORD-FORNca-BUF
      * DB_Entry-Field : EF-ORD-FORNcb
           MOVE prg-ordinato-6 TO EF-ORD-FORNcb-BUF
      * DB_Entry-Field : EF-INI-UDM
           MOVE prg-ini-udm TO EF-INI-UDM-BUF
      * DB_Entry-Field : EF-INI-KG
           MOVE prg-ini-kg TO EF-INI-KG-BUF
      * DB_Entry-Field : EF-INI-VALORE
           MOVE prg-ini-valore TO EF-INI-VALORE-BUF
      * DB_Entry-Field : EF-ACQ-UDM
           MOVE prg-acq-udm TO EF-ACQ-UDM-BUF
      * DB_Entry-Field : EF-ACQ-KG
           MOVE prg-acq-kg TO EF-ACQ-KG-BUF
      * DB_Entry-Field : EF-ACQ-VALORE
           MOVE prg-acq-valore TO EF-ACQ-VALORE-BUF
      * DB_Entry-Field : EF-VEN-UDM
           MOVE prg-ven-udm TO EF-VEN-UDM-BUF
      * DB_Entry-Field : EF-VEN-KG
           MOVE prg-ven-kg TO EF-VEN-KG-BUF
      * DB_Entry-Field : EF-VEN-VALORE
           MOVE prg-ven-valore TO EF-VEN-VALORE-BUF
      * DB_Entry-Field : EF-VAR-UDM
           MOVE prg-var-inv-udm TO EF-VAR-UDM-BUF
      * DB_Entry-Field : EF-VAR-KG
           MOVE prg-var-inv-kg TO EF-VAR-KG-BUF
      * DB_Entry-Field : EF-VAR-VALORE
           MOVE prg-var-inv-valore TO EF-VAR-VALORE-BUF
      * DB_Entry-Field : EF-FORN-UDM
           MOVE prg-resi-fornitori-udm TO EF-FORN-UDM-BUF
      * DB_Entry-Field : EF-FORN-KG
           MOVE prg-resi-fornitori-kg TO EF-FORN-KG-BUF
      * DB_Entry-Field : EF-FORN-VALORE
           MOVE prg-resi-fornitori-valore TO EF-FORN-VALORE-BUF
      * DB_Entry-Field : EF-CLI-UDM
           MOVE prg-resi-da-cli-udm TO EF-CLI-UDM-BUF
      * DB_Entry-Field : EF-CLI-KG
           MOVE prg-resi-da-cli-kg TO EF-CLI-KG-BUF
      * DB_Entry-Field : EF-CLI-VALORE
           MOVE prg-resi-da-cli-valore TO EF-CLI-VALORE-BUF
      * DB_Entry-Field : EF-FORN-UDMa
           MOVE prg-udm-el TO EF-FORN-UDMa-BUF
      * DB_Entry-Field : EF-FORN-KGa
           MOVE prg-kg-el TO EF-FORN-KGa-BUF
      * DB_Entry-Field : EF-FORN-VALOREa
           MOVE prg-valore-el TO EF-FORN-VALOREa-BUF
      * DB_Entry-Field : EF-CLI-UDMa
           MOVE prg-udm-ul TO EF-CLI-UDMa-BUF
      * DB_Entry-Field : EF-CLI-KGa
           MOVE prg-kg-ul TO EF-CLI-KGa-BUF
      * DB_Entry-Field : EF-CLI-VALOREa
           MOVE prg-valore-ul TO EF-CLI-VALOREa-BUF
      * DB_Entry-Field : ef-gia-udm
           MOVE prg-giacenza-udm TO ef-gia-udm-BUF
      * DB_Entry-Field : ef-gia-kg
           MOVE prg-giacenza-kg TO ef-gia-kg-BUF
      * DB_Entry-Field : ef-dt-val-da
           MOVE data-val-da TO ef-dt-val-da-BUF
      * DB_Entry-Field : ef-dt-val-a
           MOVE data-val-a TO ef-dt-val-a-BUF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
           perform GARTICOLI-AFTER-FLD-TO-BUF.

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.

           if art-descrizione1 OF articoli not = old-art-descrizione1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-des1 è l'ID del campo ef-des1
              move 78-ID-ef-des1 to store-id 
           end-if


           if art-descrizione2 OF articoli not = old-art-descrizione2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-des2 è l'ID del campo ef-des2
              move 78-ID-ef-des2 to store-id 
           end-if


           if art-descrizione-2 of articoli not = old-art-descrizione-2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-des-altern è l'ID del campo ef-des-altern
              move 78-ID-ef-des-altern to store-id 
           end-if


           if art-collegato of articoli not = old-art-collegato
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-coll è l'ID del campo ef-coll
              move 78-ID-ef-coll to store-id 
           end-if


           if art-settore-merceologico of articoli not = 
           old-art-settore-merceologico
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-setmerc è l'ID del campo ef-setmerc
              move 78-ID-ef-setmerc to store-id 
           end-if


           if art-codice-iva of articoli not = old-art-codice-iva
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-iva è l'ID del campo ef-iva
              move 78-ID-ef-iva to store-id 
           end-if


           if art-marca-prodotto of articoli not = 
           old-art-marca-prodotto
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-marca è l'ID del campo ef-marca
              move 78-ID-ef-marca to store-id 
           end-if


           if art-mag-std of articoli not = old-art-mag-std
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-mag è l'ID del campo ef-mag
              move 78-ID-ef-mag to store-id 
           end-if


           if art-classe-1 of articoli not = old-art-classe-1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-classe-1 è l'ID del campo ef-classe-1
              move 78-ID-ef-classe-1 to store-id 
           end-if


           if art-classe-2 of articoli not = old-art-classe-2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-classe-2 è l'ID del campo ef-classe-2
              move 78-ID-ef-classe-2 to store-id 
           end-if


           if art-classe-3 of articoli not = old-art-classe-3
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-classe-3 è l'ID del campo ef-classe-3
              move 78-ID-ef-classe-3 to store-id 
           end-if


           if art-classe-4 of articoli not = old-art-classe-4
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-classe-4 è l'ID del campo ef-classe-4
              move 78-ID-ef-classe-4 to store-id 
           end-if


           if art-unita-di-misura of articoli not = 
           old-art-unita-di-misura
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-udm è l'ID del campo ef-udm
              move 78-ID-ef-udm to store-id 
           end-if


           if art-imballo-standard of articoli not = 
           old-art-imballo-standard
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-imballo è l'ID del campo ef-imballo
              move 78-ID-ef-imballo to store-id 
           end-if


           if art-udm-imballo of articoli not = old-art-udm-imballo
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-udm-imballo è l'ID del campo ef-udm-imballo
              move 78-ID-ef-udm-imballo to store-id 
           end-if


           if art-cod-doganale of articoli not = old-art-cod-doganale
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-dogana è l'ID del campo ef-dogana
              move 78-ID-ef-dogana to store-id 
           end-if


           if art-gestione-utf of articoli not = old-art-gestione-utf
              and SiSalvato
              set NoSalvato to true
              |78-ID-cbo-utf è l'ID del campo cbo-utf
              move 78-ID-cbo-utf to store-id 
           end-if


           if art-peso-utf of articoli not = old-art-peso-utf
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-peso-utf è l'ID del campo ef-peso-utf
              move 78-ID-ef-peso-utf to store-id 
           end-if


           if art-peso-non-utf of articoli not = old-art-peso-non-utf
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-peso-non-utf è l'ID del campo ef-peso-non-utf
              move 78-ID-ef-peso-non-utf to store-id 
           end-if


           if art-cod-prodener OF articoli not = old-art-cod-prodener
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-prodener è l'ID del campo ef-prodener
              move 78-ID-ef-prodener to store-id 
           end-if


           if art-tipo-stoc OF articoli not = old-art-tipo-stoc
              and SiSalvato
              set NoSalvato to true
              |78-ID-Form1-DaRb-1 è l'ID del campo Form1-DaRb-1
              move 78-ID-Form1-DaRb-1 to store-id 
           end-if


           if art-tipo-stoc OF articoli not = old-art-tipo-stoc
              and SiSalvato
              set NoSalvato to true
              |78-ID-Form1-DaRb-2 è l'ID del campo Form1-DaRb-2
              move 78-ID-Form1-DaRb-2 to store-id 
           end-if


           if art-soggetto-imposte of articoli not = 
           old-art-soggetto-imposte
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-imposte è l'ID del campo chk-imposte
              move 78-ID-chk-imposte to store-id 
           end-if


           if art-perce-imposte of articoli not = old-art-perce-imposte
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-perce-imposte è l'ID del campo ef-perce-imposte
              move 78-ID-ef-perce-imposte to store-id 
           end-if


           if art-perce-cou of articoli not = old-art-perce-cou
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-perce-cou è l'ID del campo ef-perce-cou
              move 78-ID-ef-perce-cou to store-id 
           end-if


           if art-scorta of articoli not = old-art-scorta
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-scorta è l'ID del campo ef-scorta
              move 78-ID-ef-scorta to store-id 
           end-if


           if art-moq of articoli not = old-art-moq
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-moq è l'ID del campo ef-moq
              move 78-ID-ef-moq to store-id 
           end-if


           if art-soggetto-cobat of articoli not = 
           old-art-soggetto-cobat
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-cobat è l'ID del campo chk-cobat
              move 78-ID-chk-cobat to store-id 
           end-if


           if art-amperaggio of articoli not = old-art-amperaggio
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-amperaggio è l'ID del campo ef-amperaggio
              move 78-ID-ef-amperaggio to store-id 
           end-if


           if art-auto-moto-per-cobat of articoli not = 
           old-art-auto-moto-per-cobat
              and SiSalvato
              set NoSalvato to true
              |78-ID-cbo-cobat è l'ID del campo cbo-cobat
              move 78-ID-cbo-cobat to store-id 
           end-if


           if art-peso-reale of articoli not = old-art-peso-reale
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-reale è l'ID del campo ef-reale
              move 78-ID-ef-reale to store-id 
           end-if


           if art-prezzo-acquisto of articoli not = 
           old-art-prezzo-acquisto
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-prezzo-acq è l'ID del campo ef-prezzo-acq
              move 78-ID-ef-prezzo-acq to store-id 
           end-if


           if art-perce-sconto-acquisto of articoli not = 
           old-art-perce-sconto-acquisto
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-sconto-acquisto è l'ID del campo ef-sconto-acquisto
              move 78-ID-ef-sconto-acquisto to store-id 
           end-if


           if art-prezzo-vendita of articoli not = 
           old-art-prezzo-vendita
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-prz-vend è l'ID del campo ef-prz-vend
              move 78-ID-ef-prz-vend to store-id 
           end-if


           if art-litri of articoli not = old-art-litri
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-litri è l'ID del campo ef-litri
              move 78-ID-ef-litri to store-id 
           end-if


           if art-prezzo-banco of articoli not = old-art-prezzo-banco
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-prezzo-banco è l'ID del campo ef-prezzo-banco
              move 78-ID-ef-prezzo-banco to store-id 
           end-if


           if art-perce-sconto-agente of articoli not = 
           old-art-perce-sconto-agente
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-sconto-agente è l'ID del campo ef-sconto-agente
              move 78-ID-ef-sconto-agente to store-id 
           end-if


           if art-prz-min-vend of articoli not = old-art-prz-min-vend
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-min-vend è l'ID del campo ef-min-vend
              move 78-ID-ef-min-vend to store-id 
           end-if


           if art-codice-ean-1 of articoli not = old-art-codice-ean-1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ean-1 è l'ID del campo ef-ean-1
              move 78-ID-ef-ean-1 to store-id 
           end-if


           if art-codice-ean-2 of articoli not = old-art-codice-ean-2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ean-2 è l'ID del campo ef-ean-2
              move 78-ID-ef-ean-2 to store-id 
           end-if


           if art-codice-ean-3 of articoli not = old-art-codice-ean-3
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ean-3 è l'ID del campo ef-ean-3
              move 78-ID-ef-ean-3 to store-id 
           end-if


           if art-codice-ean-4 of articoli not = old-art-codice-ean-4
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ean-4 è l'ID del campo ef-ean-4
              move 78-ID-ef-ean-4 to store-id 
           end-if


           if art-codice-ean-5 of articoli not = old-art-codice-ean-5
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ean-5 è l'ID del campo ef-ean-5
              move 78-ID-ef-ean-5 to store-id 
           end-if


           if art-cod-art-frn of articoli not = old-art-cod-art-frn
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-art-for è l'ID del campo ef-art-for
              move 78-ID-ef-art-for to store-id 
           end-if


           if art-cod-fornitore of articoli not = old-art-cod-fornitore
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-forn è l'ID del campo ef-forn
              move 78-ID-ef-forn to store-id 
           end-if


           if art-cod-desf-forn OF articoli not = old-art-cod-desf-forn
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-destino è l'ID del campo ef-destino
              move 78-ID-ef-destino to store-id 
           end-if


           if art-note2 OF articoli not = old-art-note2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note2 è l'ID del campo ef-note2
              move 78-ID-ef-note2 to store-id 
           end-if


           if art-stato of articoli not = old-art-stato
              and SiSalvato
              set NoSalvato to true
              |78-ID-cbo-stato è l'ID del campo cbo-stato
              move 78-ID-cbo-stato to store-id 
           end-if


           if art-ala of articoli not = old-art-ala
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ala è l'ID del campo chk-ala
              move 78-ID-chk-ala to store-id 
           end-if


           if art-agenti of articoli not = old-art-agenti
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-agenti è l'ID del campo chk-agenti
              move 78-ID-chk-agenti to store-id 
           end-if


           if art-do of articoli not = old-art-do
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-eg è l'ID del campo chk-eg
              move 78-ID-chk-eg to store-id 
           end-if


           if art-SHARK OF articoli not = old-art-SHARK
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-cepsa è l'ID del campo chk-cepsa
              move 78-ID-chk-cepsa to store-id 
           end-if


           if art-gda of articoli not = old-art-gda
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-gda è l'ID del campo chk-gda
              move 78-ID-chk-gda to store-id 
           end-if


           if art-specialist of articoli not = old-art-specialist
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-specialist è l'ID del campo chk-specialist
              move 78-ID-chk-specialist to store-id 
           end-if


           if art-gds of articoli not = old-art-gds
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-gds è l'ID del campo chk-gds
              move 78-ID-chk-gds to store-id 
           end-if


           if art-gruppi of articoli not = old-art-gruppi
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-gruppi è l'ID del campo chk-gruppi
              move 78-ID-chk-gruppi to store-id 
           end-if


           if art-estero of articoli not = old-art-estero
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-estero è l'ID del campo chk-estero
              move 78-ID-chk-estero to store-id 
           end-if


           if art-web of articoli not = old-art-web
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-web è l'ID del campo chk-web
              move 78-ID-chk-web to store-id 
           end-if


           if art-SPI of articoli not = old-art-SPI
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-SPI è l'ID del campo chk-SPI
              move 78-ID-chk-SPI to store-id 
           end-if


           if art-AT of articoli not = old-art-AT
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-AT è l'ID del campo chk-AT
              move 78-ID-chk-AT to store-id 
           end-if


           if art-TEXACO OF articoli not = old-art-TEXACO
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ATa è l'ID del campo chk-ATa
              move 78-ID-chk-ATa to store-id 
           end-if


           if art-note-agg of articoli not = old-art-note-agg
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-agg è l'ID del campo ef-note-agg
              move 78-ID-ef-note-agg to store-id 
           end-if


           if art-foto of articoli not = old-art-foto
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-foto è l'ID del campo ef-foto
              move 78-ID-ef-foto to store-id 
           end-if


           if art-logo-brand OF articoli not = old-art-logo-brand
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-brand è l'ID del campo ef-brand
              move 78-ID-ef-brand to store-id 
           end-if


           if art-scheda-tecnica of articoli not = 
           old-art-scheda-tecnica
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-scheda è l'ID del campo ef-scheda
              move 78-ID-ef-scheda to store-id 
           end-if


           if art-tossicologica of articoli not = old-art-tossicologica
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-toss è l'ID del campo ef-toss
              move 78-ID-ef-toss to store-id 
           end-if


           if art-des-ing of articoli not = old-art-des-ing
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-des-ing è l'ID del campo ef-des-ing
              move 78-ID-ef-des-ing to store-id 
           end-if


           if art-des-spa of articoli not = old-art-des-spa
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-des-spa è l'ID del campo ef-des-spa
              move 78-ID-ef-des-spa to store-id 
           end-if


           if art-altezza-pz OF articoli not = old-art-altezza-pz
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-altezza-pz è l'ID del campo ef-altezza-pz
              move 78-ID-ef-altezza-pz to store-id 
           end-if


           if art-larghezza-pz OF articoli not = old-art-larghezza-pz
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-larghezza-pz è l'ID del campo ef-larghezza-pz
              move 78-ID-ef-larghezza-pz to store-id 
           end-if


           if art-profondita-pz of articoli not = old-art-profondita-pz
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-profondita-pz è l'ID del campo ef-profondita-pz
              move 78-ID-ef-profondita-pz to store-id 
           end-if


           if art-conf-cartone OF articoli not = old-art-conf-cartone
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-qta-cartone è l'ID del campo ef-qta-cartone
              move 78-ID-ef-qta-cartone to store-id 
           end-if


           if art-cartone-UDC OF articoli not = old-art-cartone-UDC
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-qta-stda è l'ID del campo ef-qta-stda
              move 78-ID-ef-qta-stda to store-id 
           end-if


           if art-adr OF articoli not = old-art-adr
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-adr è l'ID del campo ef-adr
              move 78-ID-ef-adr to store-id 
           end-if


           if art-peso-SHI of articoli not = old-art-peso-SHI
              and SiSalvato
              set NoSalvato to true
              |62 è l'ID del campo ef-peso-SHI
              move 62 to store-id
           end-if


           if art-peso-GET of articoli not = old-art-peso-GET
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-peso-GET è l'ID del campo ef-peso-GET
              move 78-ID-ef-peso-GET to store-id 
           end-if


           if art-altezza of articoli not = old-art-altezza
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-altezza è l'ID del campo ef-altezza
              move 78-ID-ef-altezza to store-id 
           end-if


           if art-larghezza of articoli not = old-art-larghezza
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-larghezza è l'ID del campo ef-larghezza
              move 78-ID-ef-larghezza to store-id 
           end-if


           if art-profondita of articoli not = old-art-profondita
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-profondita è l'ID del campo ef-profondita
              move 78-ID-ef-profondita to store-id 
           end-if


           if art-qta-epal of articoli not = old-art-qta-epal
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-qta-epal è l'ID del campo ef-qta-epal
              move 78-ID-ef-qta-epal to store-id 
           end-if


           if art-qta-std of articoli not = old-art-qta-std
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-qta-std è l'ID del campo ef-qta-std
              move 78-ID-ef-qta-std to store-id 
           end-if


           if art-T1 of articoli not = old-art-T1
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-T1 è l'ID del campo chk-T1
              move 78-ID-chk-T1 to store-id 
           end-if


           if art-T2 of articoli not = old-art-T2
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-T2 è l'ID del campo chk-T2
              move 78-ID-chk-T2 to store-id 
           end-if


           if art-T3 of articoli not = old-art-T3
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-T3 è l'ID del campo chk-T3
              move 78-ID-chk-T3 to store-id 
           end-if

           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           MOVE DataSet1-articoli-KEY1-ORDER TO TMP-Form1-KEY1-ORDER
           MOVE DataSet1-articoli-KEY2-ORDER TO TMP-Form1-KEY2-ORDER
           MOVE DataSet1-KEYIS TO TMP-Form1-KEYIS
           MOVE art-rec OF articoli TO 
              TMP-Form1-articoli-RESTOREBUF
           .             

       Form1-Restore-Status.
           MOVE TMP-Form1-KEY1-ORDER TO DataSet1-articoli-KEY1-ORDER
           MOVE TMP-Form1-KEY2-ORDER TO DataSet1-articoli-KEY2-ORDER
           MOVE TMP-Form1-KEYIS TO DataSet1-KEYIS
           MOVE TMP-Form1-articoli-RESTOREBUF TO
              art-rec OF articoli
           PERFORM DataSet1-articoli-START
           IF Valid-STATUS-articoli
              PERFORM DataSet1-articoli-Read-Next
           ELSE
              PERFORM DataSet1-articoli-INITREC
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-articoli OR
              (Valid-STATUS-articoli AND
                 art-rec OF articoli = 
                   TMP-Form1-articoli-RESTOREBUF)
              PERFORM DataSet1-articoli-Read-Next
           END-PERFORM
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-coll è l'ID del campo ef-coll
           when 78-ID-ef-coll
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-setmerc è l'ID del campo ef-setmerc
           when 78-ID-ef-setmerc
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-marca è l'ID del campo ef-marca
           when 78-ID-ef-marca
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-mag è l'ID del campo ef-mag
           when 78-ID-ef-mag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-classe-1 è l'ID del campo ef-classe-1
           when 78-ID-ef-classe-1
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-classe-2 è l'ID del campo ef-classe-2
           when 78-ID-ef-classe-2
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-classe-3 è l'ID del campo ef-classe-3
           when 78-ID-ef-classe-3
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-classe-4 è l'ID del campo ef-classe-4
           when 78-ID-ef-classe-4
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-udm è l'ID del campo ef-udm
           when 78-ID-ef-udm
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-imballo è l'ID del campo ef-imballo
           when 78-ID-ef-imballo
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-prodener è l'ID del campo ef-prodener
           when 78-ID-ef-prodener
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-scorta è l'ID del campo ef-scorta
           when 78-ID-ef-scorta
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-destino è l'ID del campo ef-destino
           when 78-ID-ef-destino
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |78-ID-ef-peso-utf è l'ID del campo ef-peso-utf
           when 78-ID-ef-peso-utf
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-peso-non-utf è l'ID del campo ef-peso-non-utf
           when 78-ID-ef-peso-non-utf
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-perce-imposte è l'ID del campo ef-perce-imposte
           when 78-ID-ef-perce-imposte
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-perce-cou è l'ID del campo ef-perce-cou
           when 78-ID-ef-perce-cou
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-reale è l'ID del campo ef-reale
           when 78-ID-ef-reale
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-prezzo-acq è l'ID del campo ef-prezzo-acq
           when 78-ID-ef-prezzo-acq
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto-acquisto è l'ID del campo ef-sconto-acquisto
           when 78-ID-ef-sconto-acquisto
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-prz-vend è l'ID del campo ef-prz-vend
           when 78-ID-ef-prz-vend
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-litri è l'ID del campo ef-litri
           when 78-ID-ef-litri
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-prezzo-banco è l'ID del campo ef-prezzo-banco
           when 78-ID-ef-prezzo-banco
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto-agente è l'ID del campo ef-sconto-agente
           when 78-ID-ef-sconto-agente
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-min-vend è l'ID del campo ef-min-vend
           when 78-ID-ef-min-vend
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-altezza-pz è l'ID del campo ef-altezza-pz
           when 78-ID-ef-altezza-pz
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-larghezza-pz è l'ID del campo ef-larghezza-pz
           when 78-ID-ef-larghezza-pz
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-profondita-pz è l'ID del campo ef-profondita-pz
           when 78-ID-ef-profondita-pz
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |62 è l'ID del campo ef-peso-SHI
           when 62
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-peso-GET è l'ID del campo ef-peso-GET
           when 78-ID-ef-peso-GET
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-altezza è l'ID del campo ef-altezza
           when 78-ID-ef-altezza
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-larghezza è l'ID del campo ef-larghezza
           when 78-ID-ef-larghezza
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-profondita è l'ID del campo ef-profondita
           when 78-ID-ef-profondita
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-coll è l'ID del campo ef-coll
           when 78-ID-ef-coll
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-setmerc è l'ID del campo ef-setmerc
           when 78-ID-ef-setmerc
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-marca è l'ID del campo ef-marca
           when 78-ID-ef-marca
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-mag è l'ID del campo ef-mag
           when 78-ID-ef-mag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-classe-1 è l'ID del campo ef-classe-1
           when 78-ID-ef-classe-1
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-classe-2 è l'ID del campo ef-classe-2
           when 78-ID-ef-classe-2
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-classe-3 è l'ID del campo ef-classe-3
           when 78-ID-ef-classe-3
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-classe-4 è l'ID del campo ef-classe-4
           when 78-ID-ef-classe-4
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-udm è l'ID del campo ef-udm
           when 78-ID-ef-udm
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-imballo è l'ID del campo ef-imballo
           when 78-ID-ef-imballo
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-prodener è l'ID del campo ef-prodener
           when 78-ID-ef-prodener
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-scorta è l'ID del campo ef-scorta
           when 78-ID-ef-scorta
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-destino è l'ID del campo ef-destino
           when 78-ID-ef-destino
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |78-ID-ef-peso-utf è l'ID del campo ef-peso-utf
           when 78-ID-ef-peso-utf
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-peso-non-utf è l'ID del campo ef-peso-non-utf
           when 78-ID-ef-peso-non-utf
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-perce-imposte è l'ID del campo ef-perce-imposte
           when 78-ID-ef-perce-imposte
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-perce-cou è l'ID del campo ef-perce-cou
           when 78-ID-ef-perce-cou
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-reale è l'ID del campo ef-reale
           when 78-ID-ef-reale
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-prezzo-acq è l'ID del campo ef-prezzo-acq
           when 78-ID-ef-prezzo-acq
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto-acquisto è l'ID del campo ef-sconto-acquisto
           when 78-ID-ef-sconto-acquisto
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-prz-vend è l'ID del campo ef-prz-vend
           when 78-ID-ef-prz-vend
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-litri è l'ID del campo ef-litri
           when 78-ID-ef-litri
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-prezzo-banco è l'ID del campo ef-prezzo-banco
           when 78-ID-ef-prezzo-banco
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto-agente è l'ID del campo ef-sconto-agente
           when 78-ID-ef-sconto-agente
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-min-vend è l'ID del campo ef-min-vend
           when 78-ID-ef-min-vend
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-altezza-pz è l'ID del campo ef-altezza-pz
           when 78-ID-ef-altezza-pz
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-larghezza-pz è l'ID del campo ef-larghezza-pz
           when 78-ID-ef-larghezza-pz
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-profondita-pz è l'ID del campo ef-profondita-pz
           when 78-ID-ef-profondita-pz
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |62 è l'ID del campo ef-peso-SHI
           when 62
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-peso-GET è l'ID del campo ef-peso-GET
           when 78-ID-ef-peso-GET
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-altezza è l'ID del campo ef-altezza
           when 78-ID-ef-altezza
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-larghezza è l'ID del campo ef-larghezza
           when 78-ID-ef-larghezza
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-profondita è l'ID del campo ef-profondita
           when 78-ID-ef-profondita
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |78-ID-ef-codice è l'ID del campo ef-codice
           when 78-ID-ef-codice
                perform CONTROLLO
           |78-ID-ef-des1 è l'ID del campo ef-des1
           when 78-ID-ef-des1
                perform CONTROLLO
           |78-ID-ef-des2 è l'ID del campo ef-des2
           when 78-ID-ef-des2
                perform CONTROLLO
           |78-ID-ef-coll è l'ID del campo ef-coll
           when 78-ID-ef-coll
                perform CONTROLLO
           |78-ID-ef-setmerc è l'ID del campo ef-setmerc
           when 78-ID-ef-setmerc
                perform CONTROLLO
           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                perform CONTROLLO
           |78-ID-ef-marca è l'ID del campo ef-marca
           when 78-ID-ef-marca
                perform CONTROLLO
           |78-ID-ef-mag è l'ID del campo ef-mag
           when 78-ID-ef-mag
                perform CONTROLLO
           |78-ID-ef-classe-1 è l'ID del campo ef-classe-1
           when 78-ID-ef-classe-1
                perform CONTROLLO
           |78-ID-ef-classe-2 è l'ID del campo ef-classe-2
           when 78-ID-ef-classe-2
                perform CONTROLLO
           |78-ID-ef-classe-3 è l'ID del campo ef-classe-3
           when 78-ID-ef-classe-3
                perform CONTROLLO
           |78-ID-ef-classe-4 è l'ID del campo ef-classe-4
           when 78-ID-ef-classe-4
                perform CONTROLLO
           |78-ID-ef-udm è l'ID del campo ef-udm
           when 78-ID-ef-udm
                perform CONTROLLO
           |78-ID-ef-imballo è l'ID del campo ef-imballo
           when 78-ID-ef-imballo
                perform CONTROLLO
           |78-ID-ef-udm-imballo è l'ID del campo ef-udm-imballo
           when 78-ID-ef-udm-imballo
                perform CONTROLLO
           |78-ID-ef-dogana è l'ID del campo ef-dogana
           when 78-ID-ef-dogana
                perform CONTROLLO
           |78-ID-ef-peso-utf è l'ID del campo ef-peso-utf
           when 78-ID-ef-peso-utf
                perform CONTROLLO
           |78-ID-ef-peso-non-utf è l'ID del campo ef-peso-non-utf
           when 78-ID-ef-peso-non-utf
                perform CONTROLLO
           |78-ID-ef-prodener è l'ID del campo ef-prodener
           when 78-ID-ef-prodener
                perform CONTROLLO
           |78-ID-ef-perce-imposte è l'ID del campo ef-perce-imposte
           when 78-ID-ef-perce-imposte
                perform CONTROLLO
           |78-ID-ef-perce-cou è l'ID del campo ef-perce-cou
           when 78-ID-ef-perce-cou
                perform CONTROLLO
           |78-ID-ef-scorta è l'ID del campo ef-scorta
           when 78-ID-ef-scorta
                perform CONTROLLO
           |78-ID-ef-moq è l'ID del campo ef-moq
           when 78-ID-ef-moq
                perform CONTROLLO
           |78-ID-ef-amperaggio è l'ID del campo ef-amperaggio
           when 78-ID-ef-amperaggio
                perform CONTROLLO
           |78-ID-cbo-cobat è l'ID del campo cbo-cobat
           when 78-ID-cbo-cobat
                perform CONTROLLO
           |78-ID-ef-reale è l'ID del campo ef-reale
           when 78-ID-ef-reale
                perform CONTROLLO
           |78-ID-ef-litri è l'ID del campo ef-litri
           when 78-ID-ef-litri
                perform CONTROLLO
           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                perform CONTROLLO
           |78-ID-ef-destino è l'ID del campo ef-destino
           when 78-ID-ef-destino
                perform CONTROLLO
           |78-ID-ef-altezza-pz è l'ID del campo ef-altezza-pz
           when 78-ID-ef-altezza-pz
                perform CONTROLLO
           |78-ID-ef-larghezza-pz è l'ID del campo ef-larghezza-pz
           when 78-ID-ef-larghezza-pz
                perform CONTROLLO
           |78-ID-ef-profondita-pz è l'ID del campo ef-profondita-pz
           when 78-ID-ef-profondita-pz
                perform CONTROLLO
           |78-ID-ef-qta-cartone è l'ID del campo ef-qta-cartone
           when 78-ID-ef-qta-cartone
                perform CONTROLLO
           |78-ID-ef-qta-stda è l'ID del campo ef-qta-stda
           when 78-ID-ef-qta-stda
                perform CONTROLLO
           |62 è l'ID del campo ef-peso-SHI
           when 62
                perform CONTROLLO
           |78-ID-ef-peso-GET è l'ID del campo ef-peso-GET
           when 78-ID-ef-peso-GET
                perform CONTROLLO
           |78-ID-ef-altezza è l'ID del campo ef-altezza
           when 78-ID-ef-altezza
                perform CONTROLLO
           |78-ID-ef-larghezza è l'ID del campo ef-larghezza
           when 78-ID-ef-larghezza
                perform CONTROLLO
           |78-ID-ef-profondita è l'ID del campo ef-profondita
           when 78-ID-ef-profondita
                perform CONTROLLO
           |78-ID-ef-qta-epal è l'ID del campo ef-qta-epal
           when 78-ID-ef-qta-epal
                perform CONTROLLO
           |78-ID-ef-qta-std è l'ID del campo ef-qta-std
           when 78-ID-ef-qta-std
                perform CONTROLLO
           |78-ID-ef-dt-val-da è l'ID del campo ef-dt-val-da
           when 78-ID-ef-dt-val-da
                perform CONTROLLO
           |78-ID-ef-dt-val-a è l'ID del campo ef-dt-val-a
           when 78-ID-ef-dt-val-a
                perform CONTROLLO
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.

       form-ean-Open-Routine.
           PERFORM form-ean-Scrn
           PERFORM form-ean-Proc
           .

       form-ean-Scrn.
           PERFORM form-ean-Create-Win
           PERFORM form-ean-Init-Value
           PERFORM form-ean-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM form-ean-DISPLAY
           .

       form-ean-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 7,83,
              SIZE 29,80,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Verdana12-Occidentale,
              LINK TO THREAD,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Screen1-Event-Proc,
              HANDLE IS Screen1-Handle,
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY form-ean UPON Screen1-Handle
      * DISPLAY-COLUMNS settings
           .

       form-ean-PROC.
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, BeforeAccept>
           move 0 to ef-ean-buf.
           display ef-ean.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT form-ean
                 ON EXCEPTION
                    PERFORM form-ean-Evaluate-Func
                 MOVE 2 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY Screen1-Handle
           INITIALIZE Key-Status
           .

       form-ean-Evaluate-Func.
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM form-ean-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM form-ean-Exit
                 END-IF
              WHEN Key-Status = 13
                 PERFORM pb-ok-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       form-ean-CLEAR.
           PERFORM form-ean-INIT-VALUE
           PERFORM form-ean-DISPLAY
           .

       form-ean-DISPLAY.
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY form-ean UPON Screen1-Handle
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       form-ean-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       form-ean-Init-Data.
           MOVE 2 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       form-ean-Init-Value.
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, SetDefault>
      * <TOTEM:END>
           PERFORM form-ean-FLD-TO-BUF
           .


       form-ean-ALLGRID-RESET.
           .

      * for Form's Validation
       form-ean-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       form-ean-Buf-To-Fld.
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, AfterBufToFld>
      * <TOTEM:END>
           .

       form-ean-Fld-To-Buf.
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:form-ean, FORM:form-ean, AfterFldToBuf>
      * <TOTEM:END>
           .

       form-ean-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform form-ean-BUF-TO-FLD.
           move 0 to scelta.
           .
       form-ean-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM form-ean-SHOW-MSG-ROUTINE
           .

       form-ean-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM form-ean-DISPLAY-MESSAGE
           .

       form-ean-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       form-ean-Save-Status.
           .             

       form-ean-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen form-ean
      ***---
       form-ean-BEFORE-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen form-ean
      ***---
       form-ean-AFTER-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.

       form3-Open-Routine.
           PERFORM form3-Scrn
           PERFORM form3-Proc
           .

       form3-Scrn.
           PERFORM form3-Create-Win
           PERFORM form3-Init-Value
           PERFORM form3-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM form3-DISPLAY
           .

       form3-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 3,00,
              SIZE 60,00,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE form3-Event-Proc,
              HANDLE IS form3-Handle,
      * <TOTEM:EPT. FORM:form3, FORM:form3, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY form3 UPON form3-Handle
      * DISPLAY-COLUMNS settings
           .

       form3-PROC.
      * <TOTEM:EPT. FORM:form3, FORM:form3, BeforeAccept>
           call "W$MOUSE" using set-mouse-shape, wait-pointer.

      *    per prima cosa controllo qual'era l'ultimo elemento della cartena
           perform LAST-EL-CATENA.
           move ultimo-elemento to old-ultimo-elemento
           move last-codice     to old-last-codice


      *    ricalcolo la catena
           move user-codi to link-cat-user
           call   "car-catart" using car-catart-linkage.
           cancel "car-catart".

      *    controllo se ci sono stati cambiamenti signigicativi nella 
      *    catena, in tal caso spedisco la mail
           perform LAST-EL-CATENA.
           if ultimo-elemento > old-ultimo-elemento
              if last-codice not = old-last-codice
                 call "mail-catart" using art-codice of articoli
                 cancel "mail-catart"
              end-if
           end-if.

           call "W$MOUSE" using set-mouse-shape, arrow-pointer.

           perform Form3-Exit

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT OMITTED LINE 1 COL 1
                 ON EXCEPTION
                    PERFORM form3-Evaluate-Func
                 MOVE 3 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:form3, FORM:form3, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:form3, FORM:form3, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY form3-Handle
           INITIALIZE Key-Status
           .

       form3-Evaluate-Func.
      * <TOTEM:EPT. FORM:form3, FORM:form3, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM form3-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM form3-Exit
                 END-IF
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       form3-CLEAR.
           PERFORM form3-INIT-VALUE
           PERFORM form3-DISPLAY
           .

       form3-DISPLAY.
      * <TOTEM:EPT. FORM:form3, FORM:form3, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY form3 UPON form3-Handle
      * <TOTEM:EPT. FORM:form3, FORM:form3, AfterDisplay>
      *<<** Customized_Default, SP-G, CST-BLOCKPGM, Disable **>>

           .
      * <TOTEM:END>
           .

       form3-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:form3, FORM:form3, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       form3-Init-Data.
           MOVE 3 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       form3-Init-Value.
      * <TOTEM:EPT. FORM:form3, FORM:form3, SetDefault>
      * <TOTEM:END>
           PERFORM form3-FLD-TO-BUF
           .


       form3-ALLGRID-RESET.
           .

      * for Form's Validation
       form3-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       form3-Buf-To-Fld.
      * <TOTEM:EPT. FORM:form3, FORM:form3, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:form3, FORM:form3, AfterBufToFld>
      * <TOTEM:END>
           .

       form3-Fld-To-Buf.
      * <TOTEM:EPT. FORM:form3, FORM:form3, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:form3, FORM:form3, AfterFldToBuf>
      * <TOTEM:END>
           .

       form3-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform form3-BUF-TO-FLD.
           move 0 to scelta.
           .
       form3-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM form3-SHOW-MSG-ROUTINE
           .

       form3-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM form3-DISPLAY-MESSAGE
           .

       form3-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       form3-Save-Status.
           .             

       form3-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen form3
      ***---
       form3-BEFORE-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen form3
      ***---
       form3-AFTER-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.

       form-frn-Open-Routine.
           PERFORM form-frn-Scrn
           PERFORM form-frn-Proc
           .

       form-frn-Scrn.
           PERFORM form-frn-Create-Win
           PERFORM form-frn-Init-Value
           PERFORM form-frn-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM form-frn-DISPLAY
           .

       form-frn-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 7,83,
              SIZE 34,90,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Verdana12-Occidentale,
              LINK TO THREAD,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Screen1-Event-Proc,
              HANDLE IS Screen1-Handle,
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY form-frn UPON Screen1-Handle
      * DISPLAY-COLUMNS settings
           .

       form-frn-PROC.
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, BeforeAccept>
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT form-frn
                 ON EXCEPTION
                    PERFORM form-frn-Evaluate-Func
                 MOVE 4 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY Screen1-Handle
           INITIALIZE Key-Status
           .

       form-frn-Evaluate-Func.
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM form-frn-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM form-frn-Exit
                 END-IF
              WHEN Key-Status = 1000
                 PERFORM pb-oka-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       form-frn-CLEAR.
           PERFORM form-frn-INIT-VALUE
           PERFORM form-frn-DISPLAY
           .

       form-frn-DISPLAY.
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY form-frn UPON Screen1-Handle
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       form-frn-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       form-frn-Init-Data.
           MOVE 4 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       form-frn-Init-Value.
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, SetDefault>
      * <TOTEM:END>
           PERFORM form-frn-FLD-TO-BUF
           .


       form-frn-ALLGRID-RESET.
           .

      * for Form's Validation
       form-frn-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       form-frn-Buf-To-Fld.
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, AfterBufToFld>
      * <TOTEM:END>
           .

       form-frn-Fld-To-Buf.
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:form-frn, FORM:form-frn, AfterFldToBuf>
      * <TOTEM:END>
           .

       form-frn-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform form-frn-BUF-TO-FLD.
           move 0 to scelta.
           .
       form-frn-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM form-frn-SHOW-MSG-ROUTINE
           .

       form-frn-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM form-frn-DISPLAY-MESSAGE
           .

       form-frn-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       form-frn-Save-Status.
           .             

       form-frn-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen form-frn
      ***---
       form-frn-BEFORE-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen form-frn
      ***---
       form-frn-AFTER-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.



       Screen1-Ta-1-TABCHANGE.
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
                   Form1-Pg-4-Visible,
                   Form1-Pg-2-Visible,
                   Form1-Pg-3-Visible,
           EVALUATE Screen1-Ta-1-TAB-VALUE
           WHEN 1
                  MOVE 1 TO Form1-Pg-1-Visible
                  MODIFY Screen1-Ta-1, VALUE = 1
           WHEN 2
                  MOVE 1 TO Form1-Pg-4-Visible
                  MODIFY Screen1-Ta-1, VALUE = 2
           WHEN 3
                  MOVE 1 TO Form1-Pg-2-Visible
                  MODIFY Screen1-Ta-1, VALUE = 3
           WHEN 4
                  MOVE 1 TO Form1-Pg-3-Visible
                  MODIFY Screen1-Ta-1, VALUE = 4
           END-EVALUATE
           MOVE 5000 TO CONTROL-ID
           DISPLAY Form1
           .

       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "Immettere codice dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5002 MOVE "Digitare la descrizione dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5003 MOVE "Digitare la descrizione dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5004 MOVE "Digitare la descrizione dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5005 MOVE "Digitare l'articolo collegato" to 
           TOTEM-HINT-TEXT
           WHEN 5006 MOVE "Digitare il settore merceologico d'appartenen
      -    "za" to TOTEM-HINT-TEXT
           WHEN 5007 MOVE "Digitare il codice IVA" to TOTEM-HINT-TEXT
           WHEN 5008 MOVE "Digitare la marca" to TOTEM-HINT-TEXT
           WHEN 5009 MOVE "Digitare il magazzino standard dove viene sol
      -    "itamente caricato l'articolo" to TOTEM-HINT-TEXT
           WHEN 5010 MOVE "Digitare la prima classe d'appartenenza" to 
           TOTEM-HINT-TEXT
           WHEN 5011 MOVE "Digitare la seconda classe d'appartenenza" 
           to TOTEM-HINT-TEXT
           WHEN 5012 MOVE "Digitare la terza classe d'appartenenza" to 
           TOTEM-HINT-TEXT
           WHEN 5013 MOVE "Digitare la quarta classe d'appartenenza" to 
           TOTEM-HINT-TEXT
           WHEN 5014 MOVE "Digitare l'unità di misura" to 
           TOTEM-HINT-TEXT
           WHEN 5015 MOVE "Digitare il codice d'imballo standard" to 
           TOTEM-HINT-TEXT
           WHEN 5016 MOVE "Digitare la quarta classe d'appartenenza" to 
           TOTEM-HINT-TEXT
           WHEN 5017 MOVE "Digitare il codice doganale" to 
           TOTEM-HINT-TEXT
           WHEN 5018 MOVE "Selezionare il tipo d'assoggettamento UTF" 
           to TOTEM-HINT-TEXT
           WHEN 5019 MOVE "Digitare il peso UTF" to TOTEM-HINT-TEXT
           WHEN 5020 MOVE "Digitare il peso non UTF" to TOTEM-HINT-TEXT
           WHEN 5021 MOVE "Digitare il protodotto energetico" to 
           TOTEM-HINT-TEXT
           WHEN 5023 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5024 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5025 MOVE "Soggetto/Non soggetto all'imposte" to 
           TOTEM-HINT-TEXT
           WHEN 5026 MOVE "Digitare la percentuale delle imposte" to 
           TOTEM-HINT-TEXT
           WHEN 5027 MOVE "Digitare la percentuale delle imposte" to 
           TOTEM-HINT-TEXT
           WHEN 5028 MOVE "Digitare il numero dei pezzi di scorta" to 
           TOTEM-HINT-TEXT
           WHEN 5029 MOVE "Digitare il valore MOQ" to TOTEM-HINT-TEXT
           WHEN 5030 MOVE "Soggetto/Non soggetto COBAT" to 
           TOTEM-HINT-TEXT
           WHEN 5031 MOVE "Digitare l'amperaggio" to TOTEM-HINT-TEXT
           WHEN 5032 MOVE "Selezionare il tipo di COBAT" to 
           TOTEM-HINT-TEXT
           WHEN 5033 MOVE "Digitare il peso reale espresso in Kg" to 
           TOTEM-HINT-TEXT
           WHEN 5034 MOVE "Digitare il prezzo di vendita" to 
           TOTEM-HINT-TEXT
           WHEN 5035 MOVE "Digitare la percentuale di sconto sull'acquis
      -    "to" to TOTEM-HINT-TEXT
           WHEN 5036 MOVE "Digitare il prezzo di vendita da listino" to 
           TOTEM-HINT-TEXT
           WHEN 5038 MOVE "Digitare il prezzo di vendita al banco (IVA c
      -    "ompresa)" to TOTEM-HINT-TEXT
           WHEN 5039 MOVE "Digitare la percentuale di sconto per l'agent
      -    "e" to TOTEM-HINT-TEXT
           WHEN 5040 MOVE "Digitare il prezzo di minima vendita (IVA com
      -    "presa)" to TOTEM-HINT-TEXT
           WHEN 5041 MOVE "Digitare il codice EAN 1" to TOTEM-HINT-TEXT
           WHEN 5042 MOVE "Digitare il codice EAN 2" to TOTEM-HINT-TEXT
           WHEN 5043 MOVE "Digitare il codice EAN 3" to TOTEM-HINT-TEXT
           WHEN 5044 MOVE "Digitare il codice EAN 4" to TOTEM-HINT-TEXT
           WHEN 5045 MOVE "Digitare il codice EAN 5" to TOTEM-HINT-TEXT
           WHEN 5046 MOVE "Digitare il codice articolo per fornitore" 
           to TOTEM-HINT-TEXT
           WHEN 5047 MOVE "Digitare il codice del fornitore" to 
           TOTEM-HINT-TEXT
           WHEN 5048 MOVE "Digitare il codice del destino del fornitore"
            to TOTEM-HINT-TEXT
           WHEN 5050 MOVE "Selezionare lo stato dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5051 MOVE "Imposta il flag ALA" to TOTEM-HINT-TEXT
           WHEN 5052 MOVE "Imposta il flag Agenti" to TOTEM-HINT-TEXT
           WHEN 5053 MOVE "Imposta il flag D.O." to TOTEM-HINT-TEXT
           WHEN 5054 MOVE "Imposta il flag CEPSA" to TOTEM-HINT-TEXT
           WHEN 5055 MOVE "Imposta il flag GDA" to TOTEM-HINT-TEXT
           WHEN 5056 MOVE "Imposta il flag Specialist" to 
           TOTEM-HINT-TEXT
           WHEN 5057 MOVE "Imposta il flag GDS" to TOTEM-HINT-TEXT
           WHEN 5058 MOVE "Imposta il flag Gruppi" to TOTEM-HINT-TEXT
           WHEN 5059 MOVE "Imposta il flag Estero" to TOTEM-HINT-TEXT
           WHEN 5060 MOVE "Imposta il flag WEB" to TOTEM-HINT-TEXT
           WHEN 5061 MOVE "Imposta il flag SPI" to TOTEM-HINT-TEXT
           WHEN 5062 MOVE "Imposta il flag Auto Trade" to 
           TOTEM-HINT-TEXT
           WHEN 5063 MOVE "Imposta il flag TEXACO" to TOTEM-HINT-TEXT
           WHEN 5064 MOVE "Digitare le note" to TOTEM-HINT-TEXT
           WHEN 5065 MOVE "Digitare il percorso della foto" to 
           TOTEM-HINT-TEXT
           WHEN 5066 MOVE "Digitare il percorso della foto" to 
           TOTEM-HINT-TEXT
           WHEN 5067 MOVE "Digitare il percorso della scheda tecnica" 
           to TOTEM-HINT-TEXT
           WHEN 5068 MOVE "Digitare il percorso della scheda tossicologi
      -    "ca" to TOTEM-HINT-TEXT
           WHEN 5071 MOVE "Digitare l'altezza in cm dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5072 MOVE "Digitare la larghezza in cm dell'articolo" 
           to TOTEM-HINT-TEXT
           WHEN 5073 MOVE "Digitare la profondità in cm dell'articolo" 
           to TOTEM-HINT-TEXT
           WHEN 5074 MOVE "Digitare la quantità per cartone" to 
           TOTEM-HINT-TEXT
           WHEN 5075 MOVE "Digitare il numero di Cartoni per UDC" to 
           TOTEM-HINT-TEXT
           WHEN 5076 MOVE "Digitare il valore di pericolosità ADR" to 
           TOTEM-HINT-TEXT
           WHEN 62 MOVE "Digitare il peso dell'articolo per SHI" to 
           TOTEM-HINT-TEXT
           WHEN 5077 MOVE "Digitare il peso dell'articolo per GET" to 
           TOTEM-HINT-TEXT
           WHEN 5078 MOVE "Digitare l'altezza in cm dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5079 MOVE "Digitare la larghezza in cm dell'articolo" 
           to TOTEM-HINT-TEXT
           WHEN 5080 MOVE "Digitare la profondità in cm dell'articolo" 
           to TOTEM-HINT-TEXT
           WHEN 5081 MOVE "Digitare la quantità per le pedane EPAL" to 
           TOTEM-HINT-TEXT
           WHEN 5082 MOVE "Digitare la quantità per le pedane STANDARD" 
           to TOTEM-HINT-TEXT
           WHEN 5083 MOVE "Imposta il flag diretti" to TOTEM-HINT-TEXT
           WHEN 5084 MOVE "Imposta il flag GDA" to TOTEM-HINT-TEXT
           WHEN 5085 MOVE "Imposta il flag Gruppi" to TOTEM-HINT-TEXT
           WHEN 93 MOVE "Valore del costo ultimo" to TOTEM-HINT-TEXT
           WHEN 94 MOVE "Valore del costo medio" to TOTEM-HINT-TEXT
           WHEN 95 MOVE "Valore del costo ultimo" to TOTEM-HINT-TEXT
           WHEN 96 MOVE "Valore del costo medio" to TOTEM-HINT-TEXT
           WHEN 97 MOVE "Valore del costo medio" to TOTEM-HINT-TEXT
           WHEN 98 MOVE "Valore della giacenza" to TOTEM-HINT-TEXT
           WHEN 99 MOVE "Valore impegnato" to TOTEM-HINT-TEXT
           WHEN 100 MOVE "Valore giacenza 'buona' (magazzini con Pren Pr
      -    "omo = S)" to TOTEM-HINT-TEXT
           WHEN 101 MOVE "Valore ordinato" to TOTEM-HINT-TEXT
           WHEN 5086 MOVE "Valore ordinato" to TOTEM-HINT-TEXT
           WHEN 5087 MOVE "Valore ordinato" to TOTEM-HINT-TEXT
           WHEN 5088 MOVE "Valore ordinato" to TOTEM-HINT-TEXT
           WHEN 105 MOVE "Valore ordinato" to TOTEM-HINT-TEXT
           WHEN 106 MOVE "Valore ordinato" to TOTEM-HINT-TEXT
           WHEN 107 MOVE "Quantità iniziale espressa in unità di misura"
            to TOTEM-HINT-TEXT
           WHEN 108 MOVE "Peso iniziale espresso in Kg." to 
           TOTEM-HINT-TEXT
           WHEN 109 MOVE "Valore in euro iniziale" to TOTEM-HINT-TEXT
           WHEN 110 MOVE "Quantità degli acquisti espressa in unità di m
      -    "isura" to TOTEM-HINT-TEXT
           WHEN 111 MOVE "Peso degli acquisti espresso in Kg." to 
           TOTEM-HINT-TEXT
           WHEN 112 MOVE "Valore in euro degli acquisti" to 
           TOTEM-HINT-TEXT
           WHEN 113 MOVE "Quantità delle vendite espressa in unità di mi
      -    "sura" to TOTEM-HINT-TEXT
           WHEN 114 MOVE "Peso delle vendite espresso in Kg." to 
           TOTEM-HINT-TEXT
           WHEN 115 MOVE "Valore in euro delle vendite" to 
           TOTEM-HINT-TEXT
           WHEN 116 MOVE "Quantità delle variazioni inventariali espress
      -    "a in unità di misura" to TOTEM-HINT-TEXT
           WHEN 117 MOVE "Peso delle variazioni inventariali espresso in
      -    " Kg." to TOTEM-HINT-TEXT
           WHEN 118 MOVE "Valore in euro delle variazioni inventariali" 
           to TOTEM-HINT-TEXT
           WHEN 119 MOVE "Quantità dei resi ai fornitori espressa in uni
      -    "tà di misura" to TOTEM-HINT-TEXT
           WHEN 120 MOVE "Peso dei resi ai fornitori espresso in Kg." 
           to TOTEM-HINT-TEXT
           WHEN 121 MOVE "Valore in euro dei resi ai fornitori" to 
           TOTEM-HINT-TEXT
           WHEN 122 MOVE "Quantità dei resi dai clienti espressa in unit
      -    "à di misura" to TOTEM-HINT-TEXT
           WHEN 123 MOVE "Peso dei resi dai clienti espresso in Kg." to 
           TOTEM-HINT-TEXT
           WHEN 124 MOVE "Valore in euro dei resi dai clienti" to 
           TOTEM-HINT-TEXT
           WHEN 125 MOVE "Quantità delle entrate di lavorazione espressa
      -    " in unità di misura" to TOTEM-HINT-TEXT
           WHEN 126 MOVE "Peso delle entrate di lavorazione espressa in 
      -    "Kg" to TOTEM-HINT-TEXT
           WHEN 127 MOVE "Valore delle entrate di lavorazione espresso i
      -    "n Euro" to TOTEM-HINT-TEXT
           WHEN 128 MOVE "Quantità delle uscite di lavorazione espressa 
      -    "in unità di misura" to TOTEM-HINT-TEXT
           WHEN 129 MOVE "Peso delle uscite di lavorazione espressa in K
      -    "g" to TOTEM-HINT-TEXT
           WHEN 130 MOVE "Valore delle uscite di lavorazione espresso in
      -    " Euro" to TOTEM-HINT-TEXT
           WHEN 131 MOVE "Quantità delle vendite espressa in unità di mi
      -    "sura" to TOTEM-HINT-TEXT
           WHEN 132 MOVE "Peso delle vendite espresso in Kg." to 
           TOTEM-HINT-TEXT
           WHEN 5089 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5090 MOVE "." to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-codice-BeforeProcedure
           When 5002 PERFORM ef-des-BeforeProcedure
           When 5003 PERFORM ef-des-BeforeProcedure
           When 5004 PERFORM ef-des-BeforeProcedure
           When 5005 PERFORM ef-setmerc-BeforeProcedure
           When 5006 PERFORM ef-setmerc-BeforeProcedure
           When 5007 PERFORM ef-setmerc-BeforeProcedure
           When 5008 PERFORM ef-marca-BeforeProcedure
           When 5009 PERFORM ef-setmerc-BeforeProcedure
           When 5010 PERFORM ef-classe-1-BeforeProcedure
           When 5011 PERFORM ef-classe-2-BeforeProcedure
           When 5012 PERFORM ef-classe-3-BeforeProcedure
           When 5013 PERFORM ef-clase-4-BeforeProcedure
           When 5014 PERFORM ef-udm-BeforeProcedure
           When 5015 PERFORM ef-imballo-BeforeProcedure
           When 5016 PERFORM ef-clase-4-BeforeProcedure
           When 5017 PERFORM ef-dogana-BeforeProcedure
           When 5018 PERFORM cbo-utf-BeforeProcedure
           When 5019 PERFORM ef-peso-utf-BeforeProcedure
           When 5020 PERFORM ef-peso-non-utf-BeforeProcedure
           When 5021 PERFORM ef-dogana-BeforeProcedure
           When 5023 PERFORM Form1-DaRb-1-BeforeProcedure
           When 5024 PERFORM Form1-DaRb-2-BeforeProcedure
           When 5025 PERFORM chk-utf-BeforeProcedure
           When 5026 PERFORM ef-perce-imposte-BeforeProcedure
           When 5027 PERFORM ef-perce-imposte-BeforeProcedure
           When 5028 PERFORM ef-scorta-BeforeProcedure
           When 5029 PERFORM ef-perce-imposte-BeforeProcedure
           When 5030 PERFORM chk-cobat-BeforeProcedure
           When 5031 PERFORM ef-amperaggio-BeforeProcedure
           When 5032 PERFORM Form1-Cm-1-BeforeProcedure
           When 5033 PERFORM ef-sconto-agente-BeforeProcedure
           When 5034 PERFORM ef-prezzo-vendita-BeforeProcedure
           When 5035 PERFORM ef-sconto-acquisto-BeforeProcedure
           When 5036 PERFORM ef-prezzo-acquisto-BeforeProcedure
           When 5038 PERFORM ef-prezzo-acquisto-BeforeProcedure
           When 5039 PERFORM ef-sconto-agente-BeforeProcedure
           When 5040 PERFORM ef-prezzo-acquisto-BeforeProcedure
           When 5041 PERFORM ef-ean-1-BeforeProcedure
           When 5042 PERFORM ef-ean-2-BeforeProcedure
           When 5043 PERFORM ef-ean-3-BeforeProcedure
           When 5044 PERFORM ef-ean-4-BeforeProcedure
           When 5045 PERFORM ef-ean-5-BeforeProcedure
           When 5046 PERFORM ef-ean-5-BeforeProcedure
           When 5047 PERFORM ef-forn-BeforeProcedure
           When 5048 PERFORM ef-forn-BeforeProcedure
           When 5050 PERFORM cbo-stato-BeforeProcedure
           When 5051 PERFORM chk-utf-BeforeProcedure
           When 5052 PERFORM chk-cobat-BeforeProcedure
           When 5053 PERFORM chk-cobat-BeforeProcedure
           When 5054 PERFORM chk-utf-BeforeProcedure
           When 5055 PERFORM chk-cobat-BeforeProcedure
           When 5056 PERFORM chk-utf-BeforeProcedure
           When 5057 PERFORM chk-cobat-BeforeProcedure
           When 5058 PERFORM chk-utf-BeforeProcedure
           When 5059 PERFORM chk-utf-BeforeProcedure
           When 5060 PERFORM chk-cobat-BeforeProcedure
           When 5061 PERFORM chk-utf-BeforeProcedure
           When 5062 PERFORM chk-utf-BeforeProcedure
           When 5063 PERFORM chk-utf-BeforeProcedure
           When 5064 PERFORM ef-note-BeforeProcedure
           When 5065 PERFORM ef-foto-BeforeProcedure
           When 5066 PERFORM ef-foto-BeforeProcedure
           When 5067 PERFORM ef-scheda-BeforeProcedure
           When 5068 PERFORM ef-scheda-BeforeProcedure
           When 5071 PERFORM ef-ean-5-BeforeProcedure
           When 5072 PERFORM ef-ean-5-BeforeProcedure
           When 5073 PERFORM ef-ean-5-BeforeProcedure
           When 5074 PERFORM ef-ean-5-BeforeProcedure
           When 5075 PERFORM ef-ean-5-BeforeProcedure
           When 5076 PERFORM ef-ean-5-BeforeProcedure
           When 62 PERFORM ef-ean-5-BeforeProcedure
           When 5077 PERFORM ef-ean-5-BeforeProcedure
           When 5078 PERFORM ef-ean-5-BeforeProcedure
           When 5079 PERFORM ef-ean-5-BeforeProcedure
           When 5080 PERFORM ef-ean-5-BeforeProcedure
           When 5081 PERFORM ef-ean-5-BeforeProcedure
           When 5082 PERFORM ef-ean-5-BeforeProcedure
           When 5083 PERFORM chk-utf-BeforeProcedure
           When 5084 PERFORM chk-cobat-BeforeProcedure
           When 5085 PERFORM chk-utf-BeforeProcedure
           When 93 PERFORM ef-voce-BeforeProcedure
           When 94 PERFORM ef-voce-BeforeProcedure
           When 95 PERFORM ef-voce-BeforeProcedure
           When 96 PERFORM ef-voce-BeforeProcedure
           When 97 PERFORM ef-voce-BeforeProcedure
           When 98 PERFORM ef-voce-BeforeProcedure
           When 99 PERFORM ef-voce-BeforeProcedure
           When 100 PERFORM ef-voce-BeforeProcedure
           When 101 PERFORM ef-voce-BeforeProcedure
           When 5086 PERFORM ef-voce-BeforeProcedure
           When 5087 PERFORM ef-voce-BeforeProcedure
           When 5088 PERFORM ef-voce-BeforeProcedure
           When 105 PERFORM ef-voce-BeforeProcedure
           When 106 PERFORM ef-voce-BeforeProcedure
           When 107 PERFORM ef-voce-BeforeProcedure
           When 108 PERFORM ef-voce-BeforeProcedure
           When 109 PERFORM ef-voce-BeforeProcedure
           When 110 PERFORM ef-voce-BeforeProcedure
           When 111 PERFORM ef-voce-BeforeProcedure
           When 112 PERFORM ef-voce-BeforeProcedure
           When 113 PERFORM ef-voce-BeforeProcedure
           When 114 PERFORM ef-voce-BeforeProcedure
           When 115 PERFORM ef-voce-BeforeProcedure
           When 116 PERFORM ef-voce-BeforeProcedure
           When 117 PERFORM ef-voce-BeforeProcedure
           When 118 PERFORM ef-voce-BeforeProcedure
           When 119 PERFORM ef-voce-BeforeProcedure
           When 120 PERFORM ef-voce-BeforeProcedure
           When 121 PERFORM ef-voce-BeforeProcedure
           When 122 PERFORM ef-voce-BeforeProcedure
           When 123 PERFORM ef-voce-BeforeProcedure
           When 124 PERFORM ef-voce-BeforeProcedure
           When 125 PERFORM ef-voce-BeforeProcedure
           When 126 PERFORM ef-voce-BeforeProcedure
           When 127 PERFORM ef-voce-BeforeProcedure
           When 128 PERFORM ef-voce-BeforeProcedure
           When 129 PERFORM ef-voce-BeforeProcedure
           When 130 PERFORM ef-voce-BeforeProcedure
           When 131 PERFORM ef-voce-BeforeProcedure
           When 132 PERFORM ef-voce-BeforeProcedure
           When 5089 PERFORM ef-voce-BeforeProcedure
           When 5090 PERFORM ef-voce-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Form1-AfterProcedure.
           EVALUATE Control-Id
           When 5001 PERFORM ef-codice-AfterProcedure
           When 5002 PERFORM ef-des-AfterProcedure
           When 5003 PERFORM ef-des-AfterProcedure
           When 5004 PERFORM ef-des-AfterProcedure
           When 5005 PERFORM ef-setmerc-AfterProcedure
           When 5006 PERFORM ef-setmerc-AfterProcedure
           When 5007 PERFORM ef-setmerc-AfterProcedure
           When 5008 PERFORM ef-marca-AfterProcedure
           When 5009 PERFORM ef-setmerc-AfterProcedure
           When 5010 PERFORM ef-classe-1-AfterProcedure
           When 5011 PERFORM ef-classe-2-AfterProcedure
           When 5012 PERFORM ef-classe-3-AfterProcedure
           When 5013 PERFORM ef-clase-4-AfterProcedure
           When 5014 PERFORM ef-udm-AfterProcedure
           When 5015 PERFORM ef-imballo-AfterProcedure
           When 5016 PERFORM ef-clase-4-AfterProcedure
           When 5017 PERFORM ef-dogana-AfterProcedure
           When 5019 PERFORM ef-peso-utf-AfterProcedure
           When 5020 PERFORM ef-peso-non-utf-AfterProcedure
           When 5021 PERFORM ef-dogana-AfterProcedure
           When 5022 PERFORM Form1-DaCb-1-AfterProcedure
           When 5023 PERFORM Form1-DaRb-1-AfterProcedure
           When 5024 PERFORM Form1-DaRb-2-AfterProcedure
           When 5025 PERFORM chk-utf-AfterProcedure
           When 5026 PERFORM ef-perce-imposte-AfterProcedure
           When 5027 PERFORM ef-perce-imposte-AfterProcedure
           When 5028 PERFORM ef-perce-imposte-AfterProcedure
           When 5029 PERFORM ef-perce-imposte-AfterProcedure
           When 5030 PERFORM chk-cobat-AfterProcedure
           When 5031 PERFORM ef-amperaggio-AfterProcedure
           When 5033 PERFORM ef-sconto-agente-AfterProcedure
           When 5034 PERFORM ef-prezzo-vendita-AfterProcedure
           When 5035 PERFORM ef-sconto-acquisto-AfterProcedure
           When 5036 PERFORM ef-prezzo-acquisto-AfterProcedure
           When 5037 PERFORM ef-sconto-agente-AfterProcedure
           When 5038 PERFORM ef-prezzo-acquisto-AfterProcedure
           When 5039 PERFORM ef-sconto-agente-AfterProcedure
           When 5040 PERFORM ef-prezzo-acquisto-AfterProcedure
           When 5041 PERFORM ef-ean-1-AfterProcedure
           When 5042 PERFORM ef-ean-2-AfterProcedure
           When 5043 PERFORM ef-ean-3-AfterProcedure
           When 5044 PERFORM ef-ean-4-AfterProcedure
           When 5045 PERFORM ef-ean-5-AfterProcedure
           When 5046 PERFORM ef-ean-5-AfterProcedure
           When 5047 PERFORM ef-forn-AfterProcedure
           When 5048 PERFORM ef-forn-AfterProcedure
           When 5049 PERFORM Form1-DaEf-1-AfterProcedure
           When 5051 PERFORM chk-utf-AfterProcedure
           When 5052 PERFORM chk-cobat-AfterProcedure
           When 5053 PERFORM chk-cobat-AfterProcedure
           When 5054 PERFORM chk-utf-AfterProcedure
           When 5055 PERFORM chk-cobat-AfterProcedure
           When 5056 PERFORM chk-utf-AfterProcedure
           When 5057 PERFORM chk-cobat-AfterProcedure
           When 5058 PERFORM chk-utf-AfterProcedure
           When 5059 PERFORM chk-utf-AfterProcedure
           When 5060 PERFORM chk-cobat-AfterProcedure
           When 5061 PERFORM chk-utf-AfterProcedure
           When 5062 PERFORM chk-utf-AfterProcedure
           When 5063 PERFORM chk-utf-AfterProcedure
           When 5064 PERFORM ef-note-AfterProcedure
           When 5065 PERFORM ef-foto-AfterProcedure
           When 5066 PERFORM ef-foto-AfterProcedure
           When 5067 PERFORM ef-scheda-AfterProcedure
           When 5068 PERFORM ef-scheda-AfterProcedure
           When 5069 PERFORM ef-scheda-AfterProcedure
           When 5070 PERFORM ef-scheda-AfterProcedure
           When 5071 PERFORM ef-ean-5-AfterProcedure
           When 5072 PERFORM ef-ean-5-AfterProcedure
           When 5073 PERFORM ef-ean-5-AfterProcedure
           When 5074 PERFORM ef-ean-5-AfterProcedure
           When 5075 PERFORM ef-ean-5-AfterProcedure
           When 5076 PERFORM ef-ean-5-AfterProcedure
           When 62 PERFORM ef-ean-5-AfterProcedure
           When 5077 PERFORM ef-ean-5-AfterProcedure
           When 5078 PERFORM ef-ean-5-AfterProcedure
           When 5079 PERFORM ef-ean-5-AfterProcedure
           When 5080 PERFORM ef-ean-5-AfterProcedure
           When 5081 PERFORM ef-ean-5-AfterProcedure
           When 5082 PERFORM ef-ean-5-AfterProcedure
           When 5083 PERFORM chk-utf-AfterProcedure
           When 5084 PERFORM chk-cobat-AfterProcedure
           When 5085 PERFORM chk-utf-AfterProcedure
           When 93 PERFORM ef-voce-AfterProcedure
           When 94 PERFORM ef-voce-AfterProcedure
           When 95 PERFORM ef-voce-AfterProcedure
           When 96 PERFORM ef-voce-AfterProcedure
           When 97 PERFORM ef-voce-AfterProcedure
           When 98 PERFORM EF-PREZZO-FINITO-AfterProcedure
           When 99 PERFORM ef-voce-AfterProcedure
           When 100 PERFORM ef-voce-AfterProcedure
           When 101 PERFORM ef-voce-AfterProcedure
           When 5086 PERFORM ef-voce-AfterProcedure
           When 5087 PERFORM ef-voce-AfterProcedure
           When 5088 PERFORM ef-voce-AfterProcedure
           When 105 PERFORM ef-voce-AfterProcedure
           When 106 PERFORM ef-voce-AfterProcedure
           When 107 PERFORM ef-voce-AfterProcedure
           When 108 PERFORM ef-voce-AfterProcedure
           When 109 PERFORM ef-voce-AfterProcedure
           When 110 PERFORM ef-voce-AfterProcedure
           When 111 PERFORM ef-voce-AfterProcedure
           When 112 PERFORM ef-voce-AfterProcedure
           When 113 PERFORM ef-voce-AfterProcedure
           When 114 PERFORM ef-voce-AfterProcedure
           When 115 PERFORM ef-voce-AfterProcedure
           When 116 PERFORM ef-voce-AfterProcedure
           When 117 PERFORM ef-voce-AfterProcedure
           When 118 PERFORM ef-voce-AfterProcedure
           When 119 PERFORM ef-voce-AfterProcedure
           When 120 PERFORM ef-voce-AfterProcedure
           When 121 PERFORM ef-voce-AfterProcedure
           When 122 PERFORM ef-voce-AfterProcedure
           When 123 PERFORM ef-voce-AfterProcedure
           When 124 PERFORM ef-voce-AfterProcedure
           When 125 PERFORM ef-voce-AfterProcedure
           When 126 PERFORM ef-voce-AfterProcedure
           When 127 PERFORM ef-voce-AfterProcedure
           When 128 PERFORM ef-voce-AfterProcedure
           When 129 PERFORM ef-voce-AfterProcedure
           When 130 PERFORM ef-voce-AfterProcedure
           When 131 PERFORM ef-voce-AfterProcedure
           When 132 PERFORM ef-voce-AfterProcedure
           When 5089 PERFORM ef-voce-AfterProcedure
           When 5090 PERFORM ef-voce-AfterProcedure
           END-EVALUATE
           perform Form1-AFTER-SCREEN
           .

       form-ean-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "." to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-gdo-BeforeProcedure
           END-EVALUATE
           perform form-ean-BEFORE-SCREEN
           .

       form-frn-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "." to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-gdo-BeforeProcedure
           END-EVALUATE
           perform form-frn-BEFORE-SCREEN
           .

       Screen1-Ta-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Cmd-Tabchanged ALSO 5000 ALSO
                    Form1-Handle
              PERFORM Screen1-Ta-1-Ev-Cmd-Tabchanged
           END-EVALUATE
           .

       cbo-utf-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Ntf-Selchange ALSO 5018 ALSO
                    Form1-Handle
              PERFORM cbo-utf-Ev-Ntf-Selchange
           END-EVALUATE
           .

       cbo-stato-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Ntf-Selchange ALSO 5050 ALSO
                    Form1-Handle
              PERFORM cbo-stato-Ev-Ntf-Selchange
           END-EVALUATE
           .

       gd-righe-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 190 ALSO
                    Form1-Handle 
              PERFORM gd-righe-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 190 ALSO
                    Form1-Handle 
              PERFORM gd-righe-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 190 ALSO
                    Form1-Handle 
              PERFORM gd-righe-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 190 ALSO
                    Form1-Handle 
              PERFORM gd-righe-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 190 ALSO
                    Form1-Handle 
              PERFORM gd-righe-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 190 ALSO
                    Form1-Handle 
              PERFORM gd-righe-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Heading-Clicked ALSO 190 ALSO
                    Form1-Handle 
              PERFORM gd-righe-Ev-Msg-Heading-Clicked
           END-EVALUATE
           .

       Screen1-Event-Proc.
           .

       form3-Event-Proc.
           .

      * USER DEFINE PARAGRAPH
       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "abilita-toolbar.cpy".
           copy "riempi-combo-utf.cpy".
      *****     copy "riempi-combo-stato.cpy".
           copy "riempi-combo-cobat.cpy".
           copy "color-custom.cpy".
           copy "status.cpy".
           copy "garticoli-procedure.cpy".
           copy "apri-note.cpy".
           copy "costo-medio.cpy".
           copy "utydata.cpy". 
           copy "prz-finito-forn.cpy".
           copy "imposte-fornitore.cpy".
           copy "addizionale-piombo-fornitore.cpy".
           copy "accessoxx.cpy".
           copy "trova-parametro.cpy".


      ***--- |DUMMY NON TOCCARE
       RECUPERO-ANAGRAFICA 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       anagr01-Ev-After-Program.
      * <TOTEM:PARA. anagr01-Ev-After-Program>
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CALL "w$bitmap" USING WBITMAP-DESTROY, elemento-bmp 
           .
      * <TOTEM:END>
       anagr01-Ev-Before-Program.
      * <TOTEM:PARA. anagr01-Ev-Before-Program>
           move LK-BL-PROG-ID    TO COMO-PROG-ID.
LABLAB

           copy resource "..\RESOURCE\elemento.bmp".
           call "W$BITMAP" using wbitmap-load, "elemento.bmp"
                          giving elemento-bmp.

      * Verdana10B-Occidentale
           INITIALIZE WFONT-DATA, font-evidenzia-griglia
           MOVE 10               TO WFONT-SIZE
           MOVE "Arial"          TO WFONT-NAME
           SET WFONT-BOLD        TO true
           SET WFONT-ITALIC      TO true
           SET WFONT-UNDERLINE   TO FALSE
           SET WFONT-STRIKEOUT   TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0                TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     font-evidenzia-griglia, WFONT-DATA
           .
      * <TOTEM:END>
       NUOVO-LinkTo.
      * <TOTEM:PARA. NUOVO-LinkTo>
           INQUIRE TOOL-NUOVO, ENABLED IN E-NUOVO.

           IF E-NUOVO = 1
              PERFORM NUOVO
           END-IF                    
           .
      * <TOTEM:END>
       CANCELLA-LinkTo.
      * <TOTEM:PARA. CANCELLA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD.
                              
           INQUIRE TOOL-CANCELLA, ENABLED IN E-CANCELLA
           IF E-CANCELLA = 1
              PERFORM CANCELLA
           END-IF                                                
           .
      * <TOTEM:END>
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD           

           INQUIRE TOOL-SALVA, ENABLED IN E-SALVA
           IF E-SALVA = 1
              PERFORM SALVA
           END-IF           
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
           INQUIRE TOOL-ANTEPRIMA, ENABLED IN E-ANTEPRIMA.
           IF E-ANTEPRIMA = 1
                PERFORM ANTEPRIMA
           END-IF 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
           INQUIRE TOOL-MODIFICA, ENABLED IN E-MODIFICA.

           IF E-MODIFICA = 1
              PERFORM MODIFICA
           END-IF 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
           INQUIRE TOOL-STAMPA, ENABLED IN E-STAMPA
           IF E-STAMPA = 1
                PERFORM STAMPA
           END-IF 
           .
      * <TOTEM:END>
       TOOL-PRIMO.
      * <TOTEM:PARA. TOOL-PRIMO>
           PERFORM PRIMO 
           .
      * <TOTEM:END>
       TOOL-PRECEDENTE.
      * <TOTEM:PARA. TOOL-PRECEDENTE>
           if nuovo             
              perform PRIMO
           else
              perform PRECEDENTE
           end-if 
           .
      * <TOTEM:END>
       TOOL-SUCCESSIVO.
      * <TOTEM:PARA. TOOL-SUCCESSIVO>
           if nuovo             
              perform ULTIMO
           else
              perform SUCCESSIVO
           end-if 
           .
      * <TOTEM:END>
       TOOL-ULTIMO.
      * <TOTEM:PARA. TOOL-ULTIMO>
           PERFORM ULTIMO 
           .
      * <TOTEM:END>
       TOOL-SELEZIONA-LinkTo.
      * <TOTEM:PARA. TOOL-SELEZIONA-LinkTo>
           inquire tool-seleziona, enabled in e-seleziona
           if e-seleziona = 1
              perform SELEZIONA
           end-if 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca
           if e-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       TOOL-ORD-LinkTo.
      * <TOTEM:PARA. TOOL-ORD-LinkTo>
           perform ORDINAMENTO 
           .
      * <TOTEM:END>
       TOOL-ORD-BeforeProcedure.
      * <TOTEM:PARA. TOOL-ORD-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-ORD-AfterProcedure.
      * <TOTEM:PARA. TOOL-ORD-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-codice-BeforeProcedure.
      * <TOTEM:PARA. ef-codice-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU

           .
      * <TOTEM:END>

       ef-codice-AfterProcedure.
      * <TOTEM:PARA. ef-codice-AfterProcedure>
              INQUIRE ef-codice, VALUE IN art-codice of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codice-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-des-BeforeProcedure.
      * <TOTEM:PARA. ef-des-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-setmerc-BeforeProcedure.
      * <TOTEM:PARA. ef-setmerc-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-marca-BeforeProcedure.
      * <TOTEM:PARA. ef-marca-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-classe-1-BeforeProcedure.
      * <TOTEM:PARA. ef-classe-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-classe-2-BeforeProcedure.
      * <TOTEM:PARA. ef-classe-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-classe-3-BeforeProcedure.
      * <TOTEM:PARA. ef-classe-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-clase-4-BeforeProcedure.
      * <TOTEM:PARA. ef-clase-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-udm-BeforeProcedure.
      * <TOTEM:PARA. ef-udm-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-forn-BeforeProcedure.
      * <TOTEM:PARA. ef-forn-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-peso-utf-BeforeProcedure.
      * <TOTEM:PARA. ef-peso-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-peso-non-utf-BeforeProcedure.
      * <TOTEM:PARA. ef-peso-non-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-imballo-BeforeProcedure.
      * <TOTEM:PARA. ef-imballo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-prezzo-vendita-BeforeProcedure.
      * <TOTEM:PARA. ef-prezzo-vendita-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-sconto-agente-BeforeProcedure.
      * <TOTEM:PARA. ef-sconto-agente-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-prezzo-acquisto-BeforeProcedure.
      * <TOTEM:PARA. ef-prezzo-acquisto-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-sconto-acquisto-BeforeProcedure.
      * <TOTEM:PARA. ef-sconto-acquisto-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-dogana-BeforeProcedure.
      * <TOTEM:PARA. ef-dogana-BeforeProcedure>
           inquire cbo-stato, value in cbo-stato-buf.
           if nuovo or cbo-stato-buf = "Sospeso"
              modify ef-dogana, not read-only
              move 1 to StatusHelp
              perform STATUS-HELP
           else
              modify ef-dogana,     read-only
              move 0 to StatusHelp
              perform STATUS-HELP
           end-if.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-perce-imposte-BeforeProcedure.
      * <TOTEM:PARA. ef-perce-imposte-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-amperaggio-BeforeProcedure.
      * <TOTEM:PARA. ef-amperaggio-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-BeforeProcedure.
      * <TOTEM:PARA. ef-note-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-1-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-2-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-3-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-4-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-5-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-5-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-foto-BeforeProcedure.
      * <TOTEM:PARA. ef-foto-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-scheda-BeforeProcedure.
      * <TOTEM:PARA. ef-scheda-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-des-AfterProcedure.
      * <TOTEM:PARA. ef-des-AfterProcedure>
              INQUIRE ef-des1, VALUE IN art-descrizione1 OF articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-des2, VALUE IN art-descrizione2 OF articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-des-altern, VALUE IN art-descrizione-2 of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des-altern-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-setmerc-AfterProcedure.
      * <TOTEM:PARA. ef-setmerc-AfterProcedure>
              INQUIRE ef-coll, VALUE IN art-collegato of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-coll-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-setmerc, VALUE IN art-settore-merceologico of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-setmerc-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-iva, VALUE IN art-codice-iva of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-iva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-mag, VALUE IN art-mag-std of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-marca-AfterProcedure.
      * <TOTEM:PARA. ef-marca-AfterProcedure>
              INQUIRE ef-marca, VALUE IN art-marca-prodotto of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-marca-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-classe-1-AfterProcedure.
      * <TOTEM:PARA. ef-classe-1-AfterProcedure>
              INQUIRE ef-classe-1, VALUE IN art-classe-1 of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-classe-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-classe-2-AfterProcedure.
      * <TOTEM:PARA. ef-classe-2-AfterProcedure>
              INQUIRE ef-classe-2, VALUE IN art-classe-2 of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-classe-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-classe-3-AfterProcedure.
      * <TOTEM:PARA. ef-classe-3-AfterProcedure>
              INQUIRE ef-classe-3, VALUE IN art-classe-3 of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-classe-3-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-clase-4-AfterProcedure.
      * <TOTEM:PARA. ef-clase-4-AfterProcedure>
              INQUIRE ef-classe-4, VALUE IN art-classe-4 of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-classe-4-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-udm-imballo, VALUE IN art-udm-imballo of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-udm-imballo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-udm-AfterProcedure.
      * <TOTEM:PARA. ef-udm-AfterProcedure>
              INQUIRE ef-udm, VALUE IN art-unita-di-misura of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-udm-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-forn-AfterProcedure.
      * <TOTEM:PARA. ef-forn-AfterProcedure>
              INQUIRE ef-forn, VALUE IN art-cod-fornitore of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-forn-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-destino, VALUE IN art-cod-desf-forn OF articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-destino-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-peso-utf-AfterProcedure.
      * <TOTEM:PARA. ef-peso-utf-AfterProcedure>
              INQUIRE ef-peso-utf, VALUE IN art-peso-utf of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-peso-utf-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-peso-non-utf-AfterProcedure.
      * <TOTEM:PARA. ef-peso-non-utf-AfterProcedure>
              INQUIRE ef-peso-non-utf, VALUE IN art-peso-non-utf of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-peso-non-utf-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-imballo-AfterProcedure.
      * <TOTEM:PARA. ef-imballo-AfterProcedure>
              INQUIRE ef-imballo, VALUE IN art-imballo-standard of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-imballo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-prezzo-vendita-AfterProcedure.
      * <TOTEM:PARA. ef-prezzo-vendita-AfterProcedure>
              INQUIRE ef-prezzo-acq, VALUE IN art-prezzo-acquisto of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prezzo-acq-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sconto-agente-AfterProcedure.
      * <TOTEM:PARA. ef-sconto-agente-AfterProcedure>
              INQUIRE ef-reale, VALUE IN art-peso-reale of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-reale-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-litri, VALUE IN art-litri of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-litri-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-sconto-agente, VALUE IN 
           art-perce-sconto-agente of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-agente-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-prezzo-acquisto-AfterProcedure.
      * <TOTEM:PARA. ef-prezzo-acquisto-AfterProcedure>
              INQUIRE ef-prz-vend, VALUE IN art-prezzo-vendita of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prz-vend-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-prezzo-banco, VALUE IN art-prezzo-banco of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prezzo-banco-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-min-vend, VALUE IN art-prz-min-vend of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-min-vend-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sconto-acquisto-AfterProcedure.
      * <TOTEM:PARA. ef-sconto-acquisto-AfterProcedure>
              INQUIRE ef-sconto-acquisto, VALUE IN 
           art-perce-sconto-acquisto of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-acquisto-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-dogana-AfterProcedure.
      * <TOTEM:PARA. ef-dogana-AfterProcedure>
              INQUIRE ef-dogana, VALUE IN art-cod-doganale of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-dogana-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-prodener, VALUE IN art-cod-prodener OF articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prodener-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-perce-imposte-AfterProcedure.
      * <TOTEM:PARA. ef-perce-imposte-AfterProcedure>
              INQUIRE ef-perce-imposte, VALUE IN art-perce-imposte of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-perce-imposte-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-perce-cou, VALUE IN art-perce-cou of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-perce-cou-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-scorta, VALUE IN art-scorta of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-scorta-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-moq, VALUE IN art-moq of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-moq-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-amperaggio-AfterProcedure.
      * <TOTEM:PARA. ef-amperaggio-AfterProcedure>
              INQUIRE ef-amperaggio, VALUE IN art-amperaggio of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-amperaggio-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-AfterProcedure.
      * <TOTEM:PARA. ef-note-AfterProcedure>
              INQUIRE ef-note-agg, VALUE IN art-note-agg of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-agg-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-1-AfterProcedure.
      * <TOTEM:PARA. ef-ean-1-AfterProcedure>
              INQUIRE ef-ean-1, VALUE IN art-codice-ean-1 of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-2-AfterProcedure.
      * <TOTEM:PARA. ef-ean-2-AfterProcedure>
              INQUIRE ef-ean-2, VALUE IN art-codice-ean-2 of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-3-AfterProcedure.
      * <TOTEM:PARA. ef-ean-3-AfterProcedure>
              INQUIRE ef-ean-3, VALUE IN art-codice-ean-3 of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-3-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-4-AfterProcedure.
      * <TOTEM:PARA. ef-ean-4-AfterProcedure>
              INQUIRE ef-ean-4, VALUE IN art-codice-ean-4 of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-4-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-5-AfterProcedure.
      * <TOTEM:PARA. ef-ean-5-AfterProcedure>
              INQUIRE ef-ean-5, VALUE IN art-codice-ean-5 of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-5-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-art-for, VALUE IN art-cod-art-frn of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-art-for-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-altezza-pz, VALUE IN art-altezza-pz OF articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-altezza-pz-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-larghezza-pz, VALUE IN art-larghezza-pz OF 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-larghezza-pz-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-profondita-pz, VALUE IN art-profondita-pz of 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-profondita-pz-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-qta-cartone, VALUE IN art-conf-cartone OF 
           articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-qta-cartone-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-qta-stda, VALUE IN art-cartone-UDC OF articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-qta-stda-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-adr, VALUE IN art-adr OF articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-adr-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-peso-SHI, VALUE IN art-peso-SHI of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-peso-SHI-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-peso-GET, VALUE IN art-peso-GET of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-peso-GET-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-altezza, VALUE IN art-altezza of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-altezza-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-larghezza, VALUE IN art-larghezza of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-larghezza-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-profondita, VALUE IN art-profondita of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-profondita-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-qta-epal, VALUE IN art-qta-epal of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-qta-epal-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-qta-std, VALUE IN art-qta-std of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-qta-std-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-foto-AfterProcedure.
      * <TOTEM:PARA. ef-foto-AfterProcedure>
              INQUIRE ef-foto, VALUE IN art-foto of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-foto-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-brand, VALUE IN art-logo-brand OF articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-brand-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-scheda-AfterProcedure.
      * <TOTEM:PARA. ef-scheda-AfterProcedure>
              INQUIRE ef-scheda, VALUE IN art-scheda-tecnica of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-scheda-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-toss, VALUE IN art-tossicologica of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-toss-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-des-ing, VALUE IN art-des-ing of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des-ing-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-des-spa, VALUE IN art-des-spa of articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des-spa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       cbo-utf-BeforeProcedure.
      * <TOTEM:PARA. cbo-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cbo-stato-BeforeProcedure.
      * <TOTEM:PARA. cbo-stato-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cbo-utf-AfterProcedure.
      * <TOTEM:PARA. cbo-utf-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       cbo-stato-AfterProcedure.
      * <TOTEM:PARA. cbo-stato-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform NO-SOSPESO.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-utf-BeforeProcedure.
      * <TOTEM:PARA. chk-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-utf-AfterProcedure.
      * <TOTEM:PARA. chk-utf-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-cobat-BeforeProcedure.
      * <TOTEM:PARA. chk-cobat-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-cobat-AfterProcedure.
      * <TOTEM:PARA. chk-cobat-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-imposte-LinkTo.
      * <TOTEM:PARA. chk-imposte-LinkTo>
           perform CHK-IMPOSTE-PRESSED 
           .
      * <TOTEM:END>
       chk-cobat-LinkTo.
      * <TOTEM:PARA. chk-cobat-LinkTo>
           perform CHK-COBAT-PRESSED 
           .
      * <TOTEM:END>
       cbo-utf-Ev-Ntf-Selchange.
      * <TOTEM:PARA. cbo-utf-Ev-Ntf-Selchange>
           perform SELEZIONE-COMBO-UTF 
           .
      * <TOTEM:END>
       pb-foto-LinkTo.
      * <TOTEM:PARA. pb-foto-LinkTo>
           perform PB-FOTO-PRESSED 
           .
      * <TOTEM:END>
       pb-scheda-LinkTo.
      * <TOTEM:PARA. pb-scheda-LinkTo>
           perform PB-SCHEDA-PRESSED 
           .
      * <TOTEM:END>
       ef-voce-BeforeProcedure.
      * <TOTEM:PARA. ef-voce-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-voce-AfterProcedure.
      * <TOTEM:PARA. ef-voce-AfterProcedure>
              INQUIRE ef-peso-utf-prg, VALUE IN prg-peso-utf
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-peso-utf-prg-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-peso-non-utf-prg, VALUE IN prg-peso-non-utf
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-peso-non-utf-prg-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-COSTO-ULTIMO, VALUE IN prg-costo-ultimo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-COSTO-ULTIMO-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-COSTO-MEDIO, VALUE IN prg-costo-medio
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-COSTO-MEDIO-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-COSTO-MP, VALUE IN costo-mp-2dec
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-COSTO-MP-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ORD-CLI, VALUE IN prg-impegnato
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ORD-CLI-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-giac-buona, VALUE IN giac-buona
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-giac-buona-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ORD-FORN, VALUE IN prg-ordinato-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ORD-FORN-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ORD-FORNa, VALUE IN prg-ordinato-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ORD-FORNa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ORD-FORNb, VALUE IN prg-ordinato-3
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ORD-FORNb-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ORD-FORNc, VALUE IN prg-ordinato-4
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ORD-FORNc-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ORD-FORNca, VALUE IN prg-ordinato-5
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ORD-FORNca-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ORD-FORNcb, VALUE IN prg-ordinato-6
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ORD-FORNcb-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-INI-UDM, VALUE IN prg-ini-udm
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-INI-UDM-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-INI-KG, VALUE IN prg-ini-kg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-INI-KG-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-INI-VALORE, VALUE IN prg-ini-valore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-INI-VALORE-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ACQ-UDM, VALUE IN prg-acq-udm
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ACQ-UDM-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ACQ-KG, VALUE IN prg-acq-kg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ACQ-KG-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ACQ-VALORE, VALUE IN prg-acq-valore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ACQ-VALORE-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-VEN-UDM, VALUE IN prg-ven-udm
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-VEN-UDM-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-VEN-KG, VALUE IN prg-ven-kg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-VEN-KG-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-VEN-VALORE, VALUE IN prg-ven-valore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-VEN-VALORE-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-VAR-UDM, VALUE IN prg-var-inv-udm
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-VAR-UDM-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-VAR-KG, VALUE IN prg-var-inv-kg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-VAR-KG-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-VAR-VALORE, VALUE IN prg-var-inv-valore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-VAR-VALORE-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-FORN-UDM, VALUE IN prg-resi-fornitori-udm
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-FORN-UDM-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-FORN-KG, VALUE IN prg-resi-fornitori-kg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-FORN-KG-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-FORN-VALORE, VALUE IN prg-resi-fornitori-valore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-FORN-VALORE-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-CLI-UDM, VALUE IN prg-resi-da-cli-udm
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-CLI-UDM-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-CLI-KG, VALUE IN prg-resi-da-cli-kg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-CLI-KG-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-CLI-VALORE, VALUE IN prg-resi-da-cli-valore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-CLI-VALORE-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-FORN-UDMa, VALUE IN prg-udm-el
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-FORN-UDMa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-FORN-KGa, VALUE IN prg-kg-el
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-FORN-KGa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-FORN-VALOREa, VALUE IN prg-valore-el
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-FORN-VALOREa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-CLI-UDMa, VALUE IN prg-udm-ul
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-CLI-UDMa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-CLI-KGa, VALUE IN prg-kg-ul
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-CLI-KGa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-CLI-VALOREa, VALUE IN prg-valore-ul
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-CLI-VALOREa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-gia-udm, VALUE IN prg-giacenza-udm
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gia-udm-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-gia-kg, VALUE IN prg-giacenza-kg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gia-kg-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-dt-val-da, VALUE IN data-val-da
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-dt-val-da-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-dt-val-a, VALUE IN data-val-a
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-dt-val-a-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       EF-PREZZO-FINITO-AfterProcedure.
      * <TOTEM:PARA. EF-PREZZO-FINITO-AfterProcedure>
              INQUIRE EF-GIACENZA, VALUE IN prg-giacenza
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-GIACENZA-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-codici-LinkTo.
      * <TOTEM:PARA. pb-codici-LinkTo>
           perform PB-CODICI-PRESSED 
           .
      * <TOTEM:END>
       pb-dettagli-LinkTo.
      * <TOTEM:PARA. pb-dettagli-LinkTo>
           perform PB-DETTAGLI-PRESSED 
           .
      * <TOTEM:END>
       pb-dettagli-BeforeProcedure.
      * <TOTEM:PARA. pb-dettagli-BeforeProcedure>
           modify pb-dettagli, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-dettagli-AfterProcedure.
      * <TOTEM:PARA. pb-dettagli-AfterProcedure>
           modify pb-dettagli, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-codici-BeforeProcedure.
      * <TOTEM:PARA. pb-codici-BeforeProcedure>
           move 2 to NumBitmapCodici.
           display pb-codici 
           .
      * <TOTEM:END>
       pb-codici-AfterProcedure.
      * <TOTEM:PARA. pb-codici-AfterProcedure>
           move 1 to NumBitmapCodici.
           display pb-codici 
           .
      * <TOTEM:END>
       pb-distinta-BeforeProcedure.
      * <TOTEM:PARA. pb-distinta-BeforeProcedure>
           move 2 to BitmapNumDistinta.
           modify pb-distinta, bitmap-number = BitmapNumDistinta 
           .
      * <TOTEM:END>
       pb-distinta-AfterProcedure.
      * <TOTEM:PARA. pb-distinta-AfterProcedure>
           move 1 to BitmapNumDistinta.
           modify pb-distinta, bitmap-number = BitmapNumDistinta 
           .
      * <TOTEM:END>
       pb-distinta-LinkTo.
      * <TOTEM:PARA. pb-distinta-LinkTo>
           perform PB-DISTINTA-PRESSED 
           .
      * <TOTEM:END>
       pb-note-LinkTo.
      * <TOTEM:PARA. pb-note-LinkTo>
           perform PUSH-NOTE-PRESSED 
           .
      * <TOTEM:END>
       pb-stampa-BeforeProcedure.
      * <TOTEM:PARA. pb-stampa-BeforeProcedure>
           modify PB-STAMPA, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-stampa-AfterProcedure.
      * <TOTEM:PARA. pb-stampa-AfterProcedure>
           modify PB-STAMPA, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-stampa-LinkTo.
      * <TOTEM:PARA. pb-stampa-LinkTo>
           perform PB-STAMPA-PRESSED 
           .
      * <TOTEM:END>
       Form1-Cm-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-Cm-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-Cm-1-AfterProcedure.
      * <TOTEM:PARA. Form1-Cm-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-ean-BeforeProcedure.
      * <TOTEM:PARA. pb-ean-BeforeProcedure>
           modify pb-ean, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ean-AfterProcedure.
      * <TOTEM:PARA. pb-ean-AfterProcedure>
           modify pb-ean, bitmap-number = 1 
           .
      * <TOTEM:END>
       ef-gdo-BeforeProcedure.
      * <TOTEM:PARA. ef-gdo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gdo-AfterProcedure.
      * <TOTEM:PARA. ef-gdo-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-ok-BeforeProcedure.
      * <TOTEM:PARA. pb-ok-BeforeProcedure>
           modify pb-ok, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ok-AfterProcedure.
      * <TOTEM:PARA. pb-ok-AfterProcedure>
           modify pb-ok, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-ok-LinkTo.
      * <TOTEM:PARA. pb-ok-LinkTo>
           perform PB-OK-EAN-PRESSED 
           .
      * <TOTEM:END>
       pb-annulla-BeforeProcedure.
      * <TOTEM:PARA. pb-annulla-BeforeProcedure>
           modify pb-annulla, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-annulla-AfterProcedure.
      * <TOTEM:PARA. pb-annulla-AfterProcedure>
           modify pb-annulla, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ean-LinkTo.
      * <TOTEM:PARA. pb-ean-LinkTo>
           perform PB-EAN-PRESSED 
           .
      * <TOTEM:END>
       pb-toss-LinkTo.
      * <TOTEM:PARA. pb-toss-LinkTo>
           perform PB-TOSS-PRESSED 
           .
      * <TOTEM:END>
       cbo-stato-Ev-Ntf-Selchange.
      * <TOTEM:PARA. cbo-stato-Ev-Ntf-Selchange>
           perform CBO-STATO-SELCHANGE 
           .
      * <TOTEM:END>
       gd-righe-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-righe-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd-righe-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-righe-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       gd-righe-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-righe-Ev-Msg-End-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd-righe-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-righe-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd-righe-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-righe-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd-righe-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-righe-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd-righe-Ev-Msg-Heading-Clicked.
      * <TOTEM:PARA. gd-righe-Ev-Msg-Heading-Clicked>
           if event-data-2 not = 1
              perform SPOSTAMENTO
           end-if
           .
      * <TOTEM:END>
       Screen1-Ta-1-Ev-Cmd-Tabchanged.
      * <TOTEM:PARA. Screen1-Ta-1-Ev-Cmd-Tabchanged>
           if event-data-1 = 1
              move ef-scorta-buf to art-scorta of articoli
              if sco-moq-si
                 move 1 to v-moq
              else
                 move 0 to v-moq
              end-if
              if art-scorta of articoli = 9
                 move 1 to v-reale
              else
                 move 0 to v-reale
              end-if
           else
              move 0 to v-moq
              move 0 to v-reale
              if event-data-1 = 2   
                 inquire ef-des-ing, value in art-des-ing of articoli
                 if art-des-ing of articoli = spaces  
                    inquire ef-des1, value in como-des
                    inquire ef-des2, value in como-des2          
                    inspect como-des replacing trailing spaces by 
           low-value
                    string como-des delimited low-value
                           como-des2
                      into ef-des-ing-buf
                    end-string                                        
                    display ef-des-ing
                 end-if
                 inquire ef-des-spa, value in art-des-spa of articoli
                 if art-des-spa of articoli = spaces  
                    inquire ef-des1, value in como-des
                    inquire ef-des2, value in como-des2          
                    inspect como-des replacing trailing spaces by 
           low-value
                    string como-des delimited low-value
                           como-des2
                      into ef-des-spa-buf
                    end-string                                        
                    display ef-des-spa
                 end-if
              end-if
           end-if.
           display ef-moq ef-reale            
           .
      * <TOTEM:END>
       Form1-DaRb-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaRb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaRb-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaRb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       Form1-DaRb-2-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaRb-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaRb-2-AfterProcedure.
      * <TOTEM:PARA. Form1-DaRb-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-brand-LinkTo.
      * <TOTEM:PARA. pb-brand-LinkTo>
           perform PB-BRAND-PRESSED 
           .
      * <TOTEM:END>
       pb-lista-BeforeProcedure.
      * <TOTEM:PARA. pb-lista-BeforeProcedure>
           modify pb-lista, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-lista-AfterProcedure.
      * <TOTEM:PARA. pb-lista-AfterProcedure>
           modify pb-lista, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-lista-LinkTo.
      * <TOTEM:PARA. pb-lista-LinkTo>
           perform PB-LISTA-PRESSED 
           .
      * <TOTEM:END>
       ef-scorta-BeforeProcedure.
      * <TOTEM:PARA. ef-scorta-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move ef-coll-buf to como-articolo.
           if como-articolo = 0
              modify ef-scorta not read-only
           else
              modify ef-scorta     read-only
           end-if.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-AfterProcedure>
              INQUIRE ef-note2, VALUE IN art-note2 OF articoli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-oka-LinkTo.
      * <TOTEM:PARA. pb-oka-LinkTo>
           perform PB-OK-FRN-PRESSED 
           .
      * <TOTEM:END>
       pb-frn-LinkTo.
      * <TOTEM:PARA. pb-frn-LinkTo>
           perform PB-FRN-PRESSED 
           .
      * <TOTEM:END>
       pb-frn-BeforeProcedure.
      * <TOTEM:PARA. pb-frn-BeforeProcedure>
           modify pb-frn, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-frn-AfterProcedure.
      * <TOTEM:PARA. pb-frn-AfterProcedure>
           modify pb-frn, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-oka-BeforeProcedure.
      * <TOTEM:PARA. pb-oka-BeforeProcedure>
           modify pb-oka, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-oka-AfterProcedure.
      * <TOTEM:PARA. pb-oka-AfterProcedure>
           modify pb-oka, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-annullaa-BeforeProcedure.
      * <TOTEM:PARA. pb-annullaa-BeforeProcedure>
           modify pb-annullaa, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-annullaa-AfterProcedure.
      * <TOTEM:PARA. pb-annullaa-AfterProcedure>
           modify pb-annullaa, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-copiada-BeforeProcedure.
      * <TOTEM:PARA. pb-copiada-BeforeProcedure>
           modify pb-copiada, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-copiada-AfterProcedure.
      * <TOTEM:PARA. pb-copiada-AfterProcedure>
           modify pb-copiada, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-copiada-LinkTo.
      * <TOTEM:PARA. pb-copiada-LinkTo>
           perform PB-COPIADA-PRESSED 
           .
      * <TOTEM:END>
       Form1-DaCb-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaCb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaCb-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaCb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>

      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

