      *{TOTEM}PRG-COMMENT
      * gclienti.Cbl
      * gclienti.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          gclienti.
       AUTHOR.              andre.
       DATE-WRITTEN.        venerdì 20 settembre 2024 15:22:28.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:gclienti, INIT:gclienti, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "tvettori.sl".
           COPY "tnazioni.sl".
           COPY "destini.sl".
           COPY "recapiti.sl".
           COPY "ttipocli.sl".
           COPY "tgrupgdo.sl".
           COPY "tregioni.sl".
           COPY "tprov.sl".
           COPY "tcodpag.sl".
           COPY "tivaese.sl".
           COPY "ABI.sl".
           COPY "tparamge.sl".
           COPY "lockfile.sl".
           COPY "evaclides.sl".
           COPY "tparameva.sl".
           COPY "cli-prg.sl".
           COPY "articoli.sl".
           COPY "progmag.sl".
           COPY "timballi.sl".
           COPY "timbalqta.sl".
           COPY "tmagaz.sl".
           COPY "pagbloc.sl".
           COPY "EDI-clides.sl".
           COPY "agenti.sl".
           COPY "note.sl".
           COPY "note.sl"
                REPLACING ==note== BY ==note1==,
                          ==STATUS-note== BY ==STATUS-note2==
                .
           COPY "clienti.sl".
           COPY "grade.sl".
           COPY "anacap.sl".
           COPY "notec.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "tvettori.fd".
           COPY "tnazioni.fd".
           COPY "destini.fd".
           COPY "recapiti.fd".
           COPY "ttipocli.fd".
           COPY "tgrupgdo.fd".
           COPY "tregioni.fd".
           COPY "tprov.fd".
           COPY "tcodpag.fd".
           COPY "tivaese.fd".
           COPY "ABI.fd".
           COPY "tparamge.fd".
           COPY "lockfile.fd".
           COPY "evaclides.fd".
           COPY "tparameva.fd".
           COPY "cli-prg.fd".
           COPY "articoli.fd".
           COPY "progmag.fd".
           COPY "timballi.fd".
           COPY "timbalqta.fd".
           COPY "tmagaz.fd".
           COPY "pagbloc.fd".
           COPY "EDI-clides.fd".
           COPY "agenti.fd".
           COPY "note.fd".
           COPY "note.fd"
                REPLACING ==note== BY ==note1==,
                          ==STATUS-note== BY ==STATUS-note2==
                .
           COPY "clienti.fd".
           COPY "grade.fd".
           COPY "anacap.fd".
           COPY "notec.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "fonts.def".
               COPY "crtvars.def".
               COPY "opensave.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "standard.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
      * Properties & User defined Working Stoarge
           COPY  "LINK-RICE-CLIENTI.DEF".
           COPY  "GCLIENTI-WS.DEF".
       77 fido-tmp         PIC  s9(13)v99
                  VALUE IS 0.
       77 Sum  PIC  s9(13)v99
                  VALUE IS 0.
       77 scr-note-bolla-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 csv-esposizione  PIC  ----.---.---.--9,99.
       77 csv-fido         PIC  ----.---.---.--9,99.
       77 csv-residuo      PIC  ----.---.---.--9,99.
       77 STATUS-grade     PIC  X(2).
           88 Valid-STATUS-grade VALUE IS "00" THRU "09". 
       77 STATUS-sitfin    PIC  X(2).
           88 Valid-STATUS-sitfin VALUE IS "00" THRU "09". 
       77 RICERCA-BMP      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 Form1-Tb-1-Handleaa
                  USAGE IS HANDLE OF WINDOW.
       77 ef-ricerca-piva-buf          PIC  X(11).
       77 STATUS-anacap    PIC  X(2).
           88 Valid-STATUS-anacap VALUE IS "00" THRU "09". 
       77 Form1-Pg-7-Visible           PIC  9
                  VALUE IS 0.
       77 STATUS-notec     PIC  X(2).
           88 Valid-STATUS-notec VALUE IS "00" THRU "09". 

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 Screen1-Ta-1-TAB-VALUE  PIC  99  VALUE 1.
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
      * DATA CONTROL BUFFER
       01 Form1-BUF.
      * Data.Entry-Field
              05 ef-codice-BUF PIC x(5).
              05 ef-codice-VALUEBUF PIC 9(5).
      * Page
              05 PAGE-1-BUF.
      * Data.Entry-Field
              10 ef-ragsoc-1-BUF PIC X(40).
              10 ef-ragsoc-1-VALUEBUF PIC X(40).
      * Data.Entry-Field
              10 ef-ragsoc-2-BUF PIC X(40).
      * Data.Entry-Field
              10 ef-indirizzo-BUF PIC X(40).
      * Data.Entry-Field
              10 ef-cap-BUF PIC X(5).
      * Data.Entry-Field
              10 ef-localita-BUF PIC X(35).
      * Data.Entry-Field
              10 ef-prov-BUF PIC X(2).
      * Data.Entry-Field
              10 ef-nazione-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-sdi-BUF PIC X(10).
      * Data.Entry-Field
              10 ef-tel-1-BUF PIC X(15).
      * Data.Entry-Field
              10 ef-tel-2-BUF PIC X(15).
      * Data.Entry-Field
              10 ef-fax-BUF PIC X(15).
      * Data.Entry-Field
              10 ef-mail-BUF PIC X(500).
      * Data.Entry-Field
              10 ef-maila-BUF PIC X(500).
      * Data.Entry-Field
              10 ef-url-BUF PIC X(100).
      * Data.Entry-Field
              10 ef-tipo-BUF PIC X(2).
      * Data.Entry-Field
              10 ef-gdo-BUF PIC X(5).
              10 ef-gdo-VALUEBUF PIC X(5).
      * Data.Check-Box
              10 chk-utf-BUF PIC 9 VALUE ZERO.
              10 chk-utf-VALUEBUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-referente-BUF PIC X(30).
      * Data.Entry-Field
              10 ef-vettore-BUF PIC 9(5).
      * Data.Check-Box
              10 chk-inoltro-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-agente-BUF PIC 9(5).
      * Data.Entry-Field
              10 ef-agente2-BUF PIC 9(5).
      * Data.Check-Box
              10 chk-superamento-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-24000-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-cod-ditta-BUF PIC X(15).
      * Data.Entry-Field
              10 ef-PFA-perce-BUF PIC zz9,999.
      * Data.Entry-Field
              10 ef-note-BUF PIC X(2000).
      * Data.Entry-Field
              10 ef-note-agg-BUF PIC X(256).
      * Data.Check-Box
              10 chk-invio-bolle-EDI-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-destino-auto-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-escludi-fido-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-contrassegno-BUF PIC 9 VALUE ZERO.
      * Data.Radio-Button
              10 Form1-RADIO-1-BUF PIC 99 VALUE ZERO.
      * Data.Entry-Field
              10 ef-gg-BUF PIC z(3).
      * Data.Check-Box
              10 chk-fido-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-esi-BUF PIC X.
      * Data.Entry-Field
              10 ef-codfis-BUF PIC X(16).
      * Data.Entry-Field
              10 ef-piva-BUF PIC X(11).
      * Data.Entry-Field
              10 ef-iva-ese-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-pag-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-cod-iva-BUF PIC X(3).
      * Data.Check-Box
              10 chk-spost-ago-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-spost-dic-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-fido-BUF PIC zz.zzz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-fido-data-BUF PIC 99/99/9999.
      * Data.Entry-Field
              10 ef-fido-extra-BUF PIC zz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-fide-BUF PIC zz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-PFA-BUF PIC zz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-data-fido-extra-BUF PIC 99/99/9999.
      * Data.Entry-Field
              10 ef-grade-BUF PIC zz.
      * Data.Entry-Field
              10 ef-abi-BUF PIC X(5).
      * Data.Entry-Field
              10 ef-cab-BUF PIC X(5).
      * Data.Label
              10 lab-agente-BUF PIC X(40).
      * Data.Label
              10 lab-vettore-BUF PIC X(40).
      * Data.Label
              10 lab-tipo-BUF PIC X(30).
      * Data.Label
              10 lab-gdo-BUF PIC X(30).
      * Data.Label
              10 lab-nazione-BUF PIC X(30).
      * Data.Label
              10 lab-citta-BUF PIC X(30).
      * Data.Label
              10 lab-regione-BUF PIC X(30).
      * Data.Label
              10 lab-agente2-BUF PIC X(40).
      * Page
              05 PAGE-2-BUF.
      * Data.Entry-Field
              10 ef-ragsoc-1-d-BUF PIC x(100).
      * Data.Entry-Field
              10 ef-ragsoc-2-d-BUF PIC x(100).
      * Data.Entry-Field
              10 ef-indirizzo-d-BUF PIC X(40).
      * Data.Entry-Field
              10 ef-cap-d-BUF PIC X(5).
      * Data.Entry-Field
              10 ef-localita-d-BUF PIC X(35).
      * Data.Entry-Field
              10 ef-prov-d-BUF PIC X(2).
      * Data.Entry-Field
              10 ef-nazione-d-BUF PIC X(3).
      * Data.Check-Box
              10 chk-invio-d-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-telef-1-d-BUF PIC X(15).
      * Data.Entry-Field
              10 ef-telef-2-d-BUF PIC X(15).
      * Data.Entry-Field
              10 ef-fax-d-BUF PIC X(15).
      * Data.Entry-Field
              10 ef-mail-d-BUF PIC X(500).
      * Data.Entry-Field
              10 ef-referente-d-BUF PIC X(30).
      * Data.Entry-Field
              10 ef-piva-d-BUF PIC 9(11)b.
      * Data.Entry-Field
              10 ef-agente-d-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-vettore-d-BUF PIC 9(5).
      * Data.Check-Box
              10 chk-deposito-utf-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-superamento-d-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-cod-ditta-d-BUF PIC X(15).
      * Data.Entry-Field
              10 ef-CIG-d-BUF PIC X(15).
      * Data.Entry-Field
              10 ef-note-1-BUF PIC X(19).
      * Data.Entry-Field
              10 ef-note-data-BUF PIC 99/99/9999.
      * Data.Entry-Field
              10 ef-note-2-BUF PIC X(30).
      * Data.Entry-Field
              10 ef-note-3-BUF PIC X(30).
      * Data.Entry-Field
              10 ef-note-4-BUF PIC X(30).
      * Data.Label
              10 lab-vettore-d-BUF PIC X(40).
      * Data.Label
              10 lab-nazione-d-BUF PIC X(30).
      * Data.Label
              10 lab-citta-d-BUF PIC X(30).
      * Data.Label
              10 lab-regione-d-BUF PIC X(30).
      * Data.Label
              10 lab-agente-d-BUF PIC X(40).
      * Page
              05 PAGE-3-BUF.
      * Data.Entry-Field
              10 ef-ragsoc-1-r-BUF PIC X(40).
      * Data.Entry-Field
              10 ef-ragsoc-2-r-BUF PIC X(40).
      * Data.Entry-Field
              10 ef-indirizzo-r-BUF PIC X(40).
      * Data.Entry-Field
              10 ef-localita-r-BUF PIC X(35).
      * Data.Entry-Field
              10 ef-cap-r-BUF PIC X(5).
      * Data.Entry-Field
              10 ef-prov-r-BUF PIC X(2).
      * Data.Entry-Field
              10 ef-nazione-r-BUF PIC X(3).
      * Data.Check-Box
              10 chk-dett-dest-sdi-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-escludi-int-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-dich-n-BUF PIC X(8).
      * Data.Entry-Field
              10 ef-data-dich-BUF PIC 99/99/9999.
      * Data.Entry-Field
              10 ef-data-reg-BUF PIC 99/99/9999.
      * Data.Entry-Field
              10 ef-reg-n-BUF PIC X(8).
      * Data.Label
              10 lab-citta-r-BUF PIC X(30).
      * Data.Label
              10 lab-regione-r-BUF PIC X(30).
      * Data.Label
              10 lab-nazione-r-BUF PIC X(30).
      * Page
              05 PAGE-4-BUF.
      * Data.Check-Box
              10 chk-escludi-e-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-intera-e-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-accorpa-e-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-saldo-banco-e-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-saldo-promo-e-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-gg-e-BUF PIC zz9.
      * Page
              05 PAGE-6-BUF.
      * Data.Entry-Field
              10 ef-id-edi-BUF PIC X(35).
      * Data.Entry-Field
              10 ef-q-id-edi-BUF PIC X(4).
      * Data.Entry-Field
              10 ef-codforn-edi-BUF PIC X(17).
      * Data.Entry-Field
              10 ef-q-codforn-edi-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-piva-c-edi-BUF PIC X(35).
      * Data.Entry-Field
              10 ef-ragsoc-c-edi-BUF PIC X(70).
      * Data.Entry-Field
              10 ef-ind-c-edi-BUF PIC X(35).
      * Data.Entry-Field
              10 ef-citta-c-edi-BUF PIC X(35).
      * Data.Entry-Field
              10 ef-prov-c-edi-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-cap-c-edi-BUF PIC X(5).
      * Data.Entry-Field
              10 ef-codcli-edi-BUF PIC X(17).
      * Data.Entry-Field
              10 ef-q-codcli-edi-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-dest-edi-BUF PIC X(17).
      * Data.Entry-Field
              10 ef-q-dest-edi-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-ragsoc-d-edi-BUF PIC X(70).
      * Data.Entry-Field
              10 ef-ind-d-edi-BUF PIC X(35).
      * Data.Entry-Field
              10 ef-citta-d-edi-BUF PIC X(35).
      * Data.Entry-Field
              10 ef-prov-d-edi-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-cap-d-edi-BUF PIC X(5).
      * Data.Check-Box
              10 chk-imp-i-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-imp-a-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-exp-i-BUF PIC 9 VALUE ZERO.
      * Page
              05 Form1-Pg-7-BUF.
      * Data.Entry-Field
              10 ef-note-cli-BUF PIC x(3000).
      * Data.Label
              05 lab-data-BUF PIC 99/99/9999.
      * Data.Label
              05 lab-des-BUF PIC X(40).

       77 TMP-Form1-KEY1-ORDER  PIC X VALUE "A".
       77 TMP-Form1-KEY2-ORDER  PIC X VALUE "A".
       77 TMP-Form1-clienti-RESTOREBUF  PIC X(4410).
       77 TMP-Form1-KEYIS  PIC 9(3) VALUE 1.
       77 Form1-MULKEY-TMPBUF   PIC X(4410).
       77 Form1-KEYISTMP2   PIC X(40).
      * Form1 : PKEY & AKEY'S TEMP BUFFER
       77 Form1-PKEYTMP   PIC X(6).
       77 STATUS-scr-stampa-FLAG-REFRESH PIC  9.
          88 scr-stampa-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 STATUS-scr-fido-FLAG-REFRESH PIC  9.
          88 scr-fido-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 STATUS-scr-note-bolla-FLAG-REFRESH PIC  9.
          88 scr-note-bolla-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 STATUS-scr-ricerca-FLAG-REFRESH PIC  9.
          88 scr-ricerca-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 TMP-DataSet1-tvettori-BUF     PIC X(1847).
       77 TMP-DataSet1-tnazioni-BUF     PIC X(190).
       77 TMP-DataSet1-destini-BUF     PIC X(3976).
       77 TMP-DataSet1-recapiti-BUF     PIC X(328).
       77 TMP-DataSet1-ttipocli-BUF     PIC X(889).
       77 TMP-DataSet1-tgrupgdo-BUF     PIC X(1206).
       77 TMP-DataSet1-tregioni-BUF     PIC X(190).
       77 TMP-DataSet1-tprov-BUF     PIC X(192).
       77 TMP-DataSet1-tcodpag-BUF     PIC X(1380).
       77 TMP-DataSet1-tivaese-BUF     PIC X(1380).
       77 TMP-DataSet1-ABI-BUF     PIC X(167).
       77 TMP-DataSet1-tparamge-BUF     PIC X(815).
       77 TMP-DataSet1-lockfile-BUF     PIC X(183).
       77 TMP-DataSet1-evaclides-BUF     PIC X(774).
       77 TMP-DataSet1-tparameva-BUF     PIC X(810).
       77 TMP-DataSet1-cli-prg-BUF     PIC X(577).
       77 TMP-DataSet1-articoli-BUF     PIC X(3669).
       77 TMP-DataSet1-progmag-BUF     PIC X(1090).
       77 TMP-DataSet1-timballi-BUF     PIC X(210).
       77 TMP-DataSet1-timbalqta-BUF     PIC X(167).
       77 TMP-DataSet1-tmagaz-BUF     PIC X(612).
       77 TMP-DataSet1-pagbloc-BUF     PIC X(609).
       77 TMP-DataSet1-EDI-clides-BUF     PIC X(840).
       77 TMP-DataSet1-agenti-BUF     PIC X(1233).
       77 TMP-DataSet1-note-BUF     PIC X(284).
       77 TMP-DataSet1-note1-BUF     PIC X(284).
       77 TMP-DataSet1-clienti-BUF     PIC X(4410).


       77 TMP-DataSet1-grade-BUF     PIC X(754).
       77 TMP-DataSet1-anacap-BUF     PIC X(1209).
       77 TMP-DataSet1-notec-BUF     PIC X(6062).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-tvettori-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tvettori-LOCK  VALUE "Y".
       77 DataSet1-tvettori-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tvettori-KEY-Asc  VALUE "A".
          88 DataSet1-tvettori-KEY-Desc VALUE "D".
       77 DataSet1-tnazioni-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tnazioni-LOCK  VALUE "Y".
       77 DataSet1-tnazioni-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tnazioni-KEY-Asc  VALUE "A".
          88 DataSet1-tnazioni-KEY-Desc VALUE "D".
       77 DataSet1-destini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-destini-LOCK  VALUE "Y".
       77 DataSet1-destini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-destini-KEY-Asc  VALUE "A".
          88 DataSet1-destini-KEY-Desc VALUE "D".
       77 DataSet1-recapiti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-recapiti-LOCK  VALUE "Y".
       77 DataSet1-recapiti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-recapiti-KEY-Asc  VALUE "A".
          88 DataSet1-recapiti-KEY-Desc VALUE "D".
       77 DataSet1-ttipocli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-ttipocli-LOCK  VALUE "Y".
       77 DataSet1-ttipocli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-ttipocli-KEY-Asc  VALUE "A".
          88 DataSet1-ttipocli-KEY-Desc VALUE "D".
       77 DataSet1-tgrupgdo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tgrupgdo-LOCK  VALUE "Y".
       77 DataSet1-tgrupgdo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tgrupgdo-KEY-Asc  VALUE "A".
          88 DataSet1-tgrupgdo-KEY-Desc VALUE "D".
       77 DataSet1-tregioni-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tregioni-LOCK  VALUE "Y".
       77 DataSet1-tregioni-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tregioni-KEY-Asc  VALUE "A".
          88 DataSet1-tregioni-KEY-Desc VALUE "D".
       77 DataSet1-tprov-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tprov-LOCK  VALUE "Y".
       77 DataSet1-tprov-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tprov-KEY-Asc  VALUE "A".
          88 DataSet1-tprov-KEY-Desc VALUE "D".
       77 DataSet1-tcodpag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcodpag-LOCK  VALUE "Y".
       77 DataSet1-tcodpag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcodpag-KEY-Asc  VALUE "A".
          88 DataSet1-tcodpag-KEY-Desc VALUE "D".
       77 DataSet1-tivaese-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tivaese-LOCK  VALUE "Y".
       77 DataSet1-tivaese-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tivaese-KEY-Asc  VALUE "A".
          88 DataSet1-tivaese-KEY-Desc VALUE "D".
       77 DataSet1-ABI-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-ABI-LOCK  VALUE "Y".
       77 DataSet1-ABI-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-ABI-KEY-Asc  VALUE "A".
          88 DataSet1-ABI-KEY-Desc VALUE "D".
       77 DataSet1-tparamge-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tparamge-LOCK  VALUE "Y".
       77 DataSet1-tparamge-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tparamge-KEY-Asc  VALUE "A".
          88 DataSet1-tparamge-KEY-Desc VALUE "D".
       77 DataSet1-lockfile-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-lockfile-LOCK  VALUE "Y".
       77 DataSet1-lockfile-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-lockfile-KEY-Asc  VALUE "A".
          88 DataSet1-lockfile-KEY-Desc VALUE "D".
       77 DataSet1-evaclides-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-evaclides-LOCK  VALUE "Y".
       77 DataSet1-evaclides-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-evaclides-KEY-Asc  VALUE "A".
          88 DataSet1-evaclides-KEY-Desc VALUE "D".
       77 DataSet1-tparameva-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tparameva-LOCK  VALUE "Y".
       77 DataSet1-tparameva-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tparameva-KEY-Asc  VALUE "A".
          88 DataSet1-tparameva-KEY-Desc VALUE "D".
       77 DataSet1-cli-prg-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-cli-prg-LOCK  VALUE "Y".
       77 DataSet1-cli-prg-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-cli-prg-KEY-Asc  VALUE "A".
          88 DataSet1-cli-prg-KEY-Desc VALUE "D".
       77 DataSet1-articoli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-articoli-LOCK  VALUE "Y".
       77 DataSet1-articoli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-articoli-KEY-Asc  VALUE "A".
          88 DataSet1-articoli-KEY-Desc VALUE "D".
       77 DataSet1-progmag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-progmag-LOCK  VALUE "Y".
       77 DataSet1-progmag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-progmag-KEY-Asc  VALUE "A".
          88 DataSet1-progmag-KEY-Desc VALUE "D".
       77 DataSet1-timballi-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timballi-LOCK  VALUE "Y".
       77 DataSet1-timballi-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timballi-KEY-Asc  VALUE "A".
          88 DataSet1-timballi-KEY-Desc VALUE "D".
       77 DataSet1-timbalqta-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timbalqta-LOCK  VALUE "Y".
       77 DataSet1-timbalqta-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timbalqta-KEY-Asc  VALUE "A".
          88 DataSet1-timbalqta-KEY-Desc VALUE "D".
       77 DataSet1-tmagaz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmagaz-LOCK  VALUE "Y".
       77 DataSet1-tmagaz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmagaz-KEY-Asc  VALUE "A".
          88 DataSet1-tmagaz-KEY-Desc VALUE "D".
       77 DataSet1-pagbloc-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-pagbloc-LOCK  VALUE "Y".
       77 DataSet1-pagbloc-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-pagbloc-KEY-Asc  VALUE "A".
          88 DataSet1-pagbloc-KEY-Desc VALUE "D".
       77 DataSet1-EDI-clides-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-EDI-clides-LOCK  VALUE "Y".
       77 DataSet1-EDI-clides-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-EDI-clides-KEY-Asc  VALUE "A".
          88 DataSet1-EDI-clides-KEY-Desc VALUE "D".
       77 DataSet1-agenti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-agenti-LOCK  VALUE "Y".
       77 DataSet1-agenti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-agenti-KEY-Asc  VALUE "A".
          88 DataSet1-agenti-KEY-Desc VALUE "D".
       77 DataSet1-note-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-note-LOCK  VALUE "Y".
       77 DataSet1-note-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-note-KEY-Asc  VALUE "A".
          88 DataSet1-note-KEY-Desc VALUE "D".
       77 DataSet1-note1-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-note1-LOCK  VALUE "Y".
       77 DataSet1-note1-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-note1-KEY-Asc  VALUE "A".
          88 DataSet1-note1-KEY-Desc VALUE "D".
       77 DataSet1-clienti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-clienti-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-clienti-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti-KEY1-Asc  VALUE "A".
          88 DataSet1-clienti-KEY1-Desc VALUE "D".
       77 DataSet1-clienti-KEY2-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti-KEY2-Asc  VALUE "A".
          88 DataSet1-clienti-KEY2-Desc VALUE "D".
       77 DataSet1-grade-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-grade-LOCK  VALUE "Y".
       77 DataSet1-grade-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-grade-KEY-Asc  VALUE "A".
          88 DataSet1-grade-KEY-Desc VALUE "D".
       77 DataSet1-anacap-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-anacap-LOCK  VALUE "Y".
       77 DataSet1-anacap-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-anacap-KEY-Asc  VALUE "A".
          88 DataSet1-anacap-KEY-Desc VALUE "D".
       77 DataSet1-notec-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-notec-LOCK  VALUE "Y".
       77 DataSet1-notec-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-notec-KEY-Asc  VALUE "A".
          88 DataSet1-notec-KEY-Desc VALUE "D".

       77 tvettori-k-des-SPLITBUF  PIC X(41).
       77 destini-K1-SPLITBUF  PIC X(111).
       77 destini-k-localita-SPLITBUF  PIC X(36).
       77 tgrupgdo-gdo-k-g2-SPLITBUF  PIC X(9).
       77 tcodpag-TBL-CODICE-01-SPLITBUF  PIC X(53).
       77 tivaese-key01-SPLITBUF  PIC X(53).
       77 ABI-ABI-CODICE1-SPLITBUF  PIC X(101).
       77 ABI-ABI-CODICE2-SPLITBUF  PIC X(101).
       77 articoli-art-k1-SPLITBUF  PIC X(51).
       77 articoli-art-k-frn-SPLITBUF  PIC X(16).
       77 progmag-key01-SPLITBUF  PIC X(21).
       77 EDI-clides-ecd-k-orders-SPLITBUF  PIC X(35).
       77 clienti-cli-K1-SPLITBUF  PIC X(47).
       77 clienti-cli-K3-SPLITBUF  PIC X(12).
       77 clienti-cli-K4-SPLITBUF  PIC X(8).
       77 anacap-k-prov-SPLITBUF  PIC X(158).
       77 anacap-k-comune-SPLITBUF  PIC X(158).

       01 old-cli-rec.
           05 old-cli-chiave.
               10 old-cli-tipo-CF      PIC  X(1).
                   88 old-cli-tipo-C VALUE IS "C". 
                   88 old-cli-tipo-F VALUE IS "F". 
               10 old-cli-codice       PIC  9(5).
           05 old-cli-dati.
               10 old-cli-ragsoc-1     PIC  x(40).
               10 old-cli-ragsoc-2     PIC  x(40).
               10 old-cli-indirizzo    PIC  x(40).
               10 old-cli-cap          PIC  x(5).
               10 old-cli-localita     PIC  x(35).
               10 old-cli-prov         PIC  x(2).
               10 old-cli-nazione      PIC  x(3).
               10 old-cli-codfis       PIC  x(16).
               10 old-cli-piva         PIC  x(11).
               10 old-cli-tel-1        PIC  x(15).
               10 old-cli-tel-2        PIC  x(15).
               10 old-cli-fax          PIC  x(15).
               10 old-cli-email        PIC  x(500).
               10 old-cli-web          PIC  x(100).
      *(( XFD NAME = old-cli-tipo_1 ))
               10 old-cli-tipo         PIC  x(2).
               10 old-cli-gdo          PIC  x(5).
               10 old-cli-utf          PIC  x.
               10 old-cli-referente    PIC  x(30).
               10 old-cli-note         PIC  x(2000).
               10 old-cli-note-agg     PIC  x(256).
               10 old-cli-vettore      PIC  9(5).
               10 old-cli-inoltro      PIC  x.
               10 old-cli-agente       PIC  9(5).
               10 old-cli-iva-ese      PIC  x(3).
               10 old-cli-pag          PIC  x(3).
               10 old-cli-spost-ric-agosto         PIC  x.
               10 old-cli-spost-ric-dicembre       PIC  x.
               10 old-cli-fido         PIC  9(11)v9(2).
               10 old-cli-fido-data    PIC  9(8).
               10 old-cli-abi          PIC  x(5).
               10 old-cli-cab          PIC  x(5).
               10 old-cli-superamento-500          PIC  x.
               10 old-cli-stato        PIC  x.
                   88 old-cli-attivo VALUE IS "A". 
                   88 old-cli-disattivo VALUE IS "D". 
                   88 old-cli-bloccato VALUE IS "B". 
               10 old-cli-dich-esp     PIC  x(8).
               10 old-cli-data-dich    PIC  9(8).
               10 old-cli-data-reg     PIC  9(8).
               10 old-cli-num-reg      PIC  x(8).
               10 old-cli-fido-extra   PIC  9(8)v99.
               10 old-cli-tipo-persona PIC  x.
                   88 old-cli-fisica VALUE IS "F". 
                   88 old-cli-giuridica VALUE IS space. 
               10 old-cli-referente-ord            PIC  x(30).
               10 old-cli-tel-dir-ref-ord          PIC  x(20).
               10 old-cli-mail-ref-ord PIC  x(100).
      *(( XFD NAME = old-cli-blocco-24000_1 ))
               10 old-cli-blocco-24000 PIC  9.
                   88 old-cli-si-blocco VALUE IS 1. 
                   88 old-cli-no-blocco VALUE IS 0. 
               10 old-cli-cod-ditta    PIC  x(15).
               10 old-cli-gg-dilazione PIC  9(3).
               10 old-cli-gestione-fido            PIC  9.
                   88 old-cli-gestione-fido-si VALUE IS 1. 
                   88 old-cli-gestione-fido-no VALUE IS 0. 
               10 old-cli-saldi-banco  PIC  9(1).
                   88 old-cli-saldi-banco-si VALUE IS 1. 
                   88 old-cli-saldi-banco-no VALUE IS 0. 
               10 old-cli-cau-blocco   PIC  x.
                   88 old-cli-no-angraf VALUE IS "N". 
                   88 old-cli-prob-pag VALUE IS "P". 
                   88 old-cli-nuovo-ragsoc VALUE IS "R". 
                   88 old-cli-fuori-fido VALUE IS "F". 
                   88 old-cli-blocco-amm VALUE IS "A". 
               10 old-cli-dati-comuni.
                   15 old-cli-data-creazione           PIC  9(8).
                   15 old-cli-ora-creazione            PIC  9(8).
                   15 old-cli-utente-creazione         PIC  X(10).
                   15 old-cli-data-ultima-modifica     PIC  9(8).
                   15 old-cli-ora-ultima-modifica      PIC  9(8).
                   15 old-cli-utente-ultima-modifica   PIC  X(10).
               10 old-cli-vuoti.
                   15 old-cli-sost         PIC  x.
                       88 old-cli-sost-auto VALUE IS "A". 
                       88 old-cli-sost-richiesta VALUE IS "R". 
                       88 old-cli-sost-no VALUE IS " " "N". 
                   15 old-cli-tipo-art     PIC  9.
                       88 old-cli-tipo-art-diretti VALUE IS 1. 
                       88 old-cli-tipo-art-gruppi VALUE IS 2. 
                       88 old-cli-tipo-art-specialist VALUE IS 3. 
                       88 old-cli-tipo-art-DO VALUE IS 4. 
                       88 old-cli-tipo-art-GDA VALUE IS 5. 
                       88 old-cli-tipo-art-GDS VALUE IS 6. 
                       88 old-cli-tipo-art-ESTERO VALUE IS 7. 
                   15 old-cli-iva          PIC  X(3).
                   15 old-cli-invio-bolle-EDI          PIC  x.
                       88 old-cli-invio-bolle-EDI-si VALUE IS "S". 
                       88 old-cli-invio-bolle-EDI-no VALUE IS "N" " ". 
                   15 old-cli-destino-auto-EDI         PIC  x.
                       88 old-cli-destino-auto-EDI-si VALUE IS "S". 
                       88 old-cli-destino-auto-EDI-no VALUE IS "N" " ". 
      *(( XFD NAME = old-cli-agente-2 ))
                   15 old-cli-agente2      PIC  9(5).
                   15 old-cli-codice-SDI   PIC  X(10).
                   15 old-cli-pec          PIC  X(500).
                   15 old-cli-esigibilita-iva          PIC  X.
                       88 old-cli-esigibilita-iva-immediata VALUE IS "I"
           . 
                       88 old-cli-esigibilita-iva-differita VALUE IS "D"
           . 
                       88 old-cli-esigibilita-iva-scissione VALUE IS "S"
           . 
      *(( XFD NAME = old-cli-alfa-vuoto-1_8 ))             
                   15 old-cli-contrassegno PIC  x.

                   15 FILLER           PIC  X(376).
                   15 old-cli-fidejussione PIC  s9(8)v9(4).
                   15 old-cli-pfa          PIC  s9(8)v9(4).
                   15 old-cli-pfa-perce    PIC  9(3)v999.
                   15 old-cli-data-fido-extra          PIC  9(8).
                   15 old-cli-grade        pic 99.     
                   15 old-cli-escludi-fido PIC  9.
                       88 old-cli-escludi-fido-si VALUE IS 1. 
                       88 old-cli-escludi-fido-no VALUE IS 0. 
                   15 old-cli-num-vuoto-3  PIC  9(13).

       01 old-des-rec.
           05 old-des-chiave.
               10 old-des-codice       PIC  9(5).
               10 old-des-prog         PIC  9(5).
           05 old-des-dati.
               10 old-des-ragsoc-1     PIC  x(100).
               10 old-des-ragsoc-2     PIC  x(100).
               10 old-des-indirizzo    PIC  x(40).
               10 old-des-cap          PIC  x(5).
               10 old-des-localita     PIC  x(35).
               10 old-des-prov         PIC  x(2).
               10 old-des-nazione      PIC  x(3).
               10 old-des-telef-1      PIC  x(15).
               10 old-des-telef-2      PIC  x(15).
               10 old-des-fax          PIC  X(15).
               10 old-des-mail         PIC  X(500).
               10 old-des-referente    PIC  x(30).
               10 old-des-vettore      PIC  9(5).
               10 old-des-deposito-UTF PIC  x.
               10 old-des-superamento-500          PIC  x.
               10 old-des-stato        PIC  x.
                   88 old-des-attivo VALUE IS "A". 
                   88 old-des-disattivo VALUE IS "D". 
                   88 old-des-bloccato VALUE IS "B". 
               10 old-des-dati-comuni.
                   15 old-des-data-creazione           PIC  9(8).
                   15 old-des-ora-creazione            PIC  9(8).
                   15 old-des-utente-creazione         PIC  X(10).
                   15 old-des-data-ultima-modifica     PIC  9(8).
                   15 old-des-ora-ultima-modifica      PIC  9(8).
                   15 old-des-utente-ultima-modifica   PIC  X(10).
               10 old-des-vuoti.
                   15 old-des-piva         PIC  9(11).
                   15 old-des-piva-dupl    PIC  9(1).
                       88 old-des-si-piva-dupl VALUE IS 1. 
                       88 old-des-no-piva-dupl VALUE IS 0. 
                   15 old-des-cod-ditta    PIC  x(15).
                   15 old-des-tipo-art     PIC  9.
                       88 old-des-tipo-art-diretti VALUE IS 1. 
                       88 old-des-tipo-art-gruppi VALUE IS 2. 
                       88 old-des-tipo-art-specialist VALUE IS 3. 
                       88 old-des-tipo-art-DO VALUE IS 4. 
                       88 old-des-tipo-art-GDA VALUE IS 5. 
                       88 old-des-tipo-art-GDS VALUE IS 6. 
                       88 old-des-tipo-art-ESTERO VALUE IS 7. 
                   15 old-des-num-vuoto-2  PIC  9(1).
                   15 old-des-saldi-banco  PIC  9(1).
                       88 old-des-saldi-banco-si VALUE IS 1. 
                       88 old-des-saldi-banco-no VALUE IS 0. 
                   15 old-des-saldi-promo  PIC  9(1).
                       88 old-des-saldi-promo-si VALUE IS 1. 
                       88 old-des-saldi-promo-no VALUE IS 0. 
                   15 old-des-escludi-evadi-tutto      PIC  9(1).
                       88 old-des-escludi-evadi-tutto-si VALUE IS 1. 
                       88 old-des-escludi-evadi-tutto-no VALUE IS 0. 
                   15 old-des-accorpa-master           PIC  9(1).
                       88 old-des-accorpa-master-si VALUE IS 1. 
                       88 old-des-accorpa-master-no VALUE IS 0. 
                   15 old-des-age-codice   PIC  9(5).
                   15 old-des-num-vuoto-3  PIC  9(7).
                   15 old-des-invio-fatt   PIC  x.
                       88 old-des-si-invio VALUE IS "S". 
                       88 old-des-no-invio VALUE IS "N". 
                   15 old-des-note-bolla-1 PIC  X(500).
                   15 old-des-note-bolla-2 PIC  X(500).
                   15 old-des-CIG pic x(15).
                   15 FILLER           PIC  X(1985).

       01 old-notc-rec.
           05 old-notc-chiave.
               10 old-notc-codice      PIC  9(5).
               10 old-notc-prog        PIC  9(5).
           05 old-notc-dati.
               10 old-notc-note        PIC  x(3000).
               10 FILLER           PIC  x(3000).
           05 old-notc-dati-comuni.
               10 old-notc-data-creazione          PIC  9(8).
               10 old-notc-ora-creazione           PIC  9(8).
               10 old-notc-utente-creazione        PIC  X(10).
               10 old-notc-data-ultima-modifica    PIC  9(8).
               10 old-notc-ora-ultima-modifica     PIC  9(8).
               10 old-notc-utente-ultima-modifica  PIC  X(10).
      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-ef-codice VALUE 5001.
       78  78-ID-ef-ragsoc-1 VALUE 5002.
       78  78-ID-ef-ragsoc-2 VALUE 5003.
       78  78-ID-ef-indirizzo VALUE 5004.
       78  78-ID-ef-cap VALUE 5005.
       78  78-ID-ef-localita VALUE 5006.
       78  78-ID-ef-prov VALUE 5007.
       78  78-ID-ef-nazione VALUE 5008.
       78  78-ID-ef-sdi VALUE 5009.
       78  78-ID-ef-tel-1 VALUE 5010.
       78  78-ID-ef-tel-2 VALUE 5011.
       78  78-ID-ef-fax VALUE 5012.
       78  78-ID-ef-mail VALUE 5013.
       78  78-ID-ef-url VALUE 5014.
       78  78-ID-ef-tipo VALUE 5015.
       78  78-ID-ef-gdo VALUE 5016.
       78  78-ID-chk-utf VALUE 5017.
       78  78-ID-ef-referente VALUE 5018.
       78  78-ID-ef-vettore VALUE 5019.
       78  78-ID-chk-inoltro VALUE 5020.
       78  78-ID-ef-agente VALUE 5021.
       78  78-ID-cbo-stato VALUE 5022.
       78  78-ID-cbo-cau-blocco VALUE 5023.
       78  78-ID-ef-agente2 VALUE 5024.
       78  78-ID-chk-superamento VALUE 5025.
       78  78-ID-chk-24000 VALUE 5026.
       78  78-ID-ef-cod-ditta VALUE 5027.
       78  78-ID-ef-PFA-perce VALUE 5028.
       78  78-ID-ef-note VALUE 5029.
       78  78-ID-ef-note-agg VALUE 5030.
       78  78-ID-cbo-sost-art VALUE 5031.
       78  78-ID-cbo-tipo-art VALUE 5032.
       78  78-ID-chk-invio-bolle-EDI VALUE 5033.
       78  78-ID-chk-destino-auto VALUE 5034.
       78  78-ID-chk-escludi-fido VALUE 5035.
       78  78-ID-chk-contrassegno VALUE 5036.
       78  78-ID-rb-pers VALUE 5037.
       78  78-ID-rb-soc VALUE 5038.
       78  78-ID-ef-gg VALUE 5039.
       78  78-ID-chk-fido VALUE 5040.
       78  78-ID-ef-esi VALUE 5041.
       78  78-ID-ef-codfis VALUE 5042.
       78  78-ID-ef-piva VALUE 5043.
       78  78-ID-ef-iva-ese VALUE 5044.
       78  78-ID-ef-pag VALUE 5045.
       78  78-ID-ef-cod-iva VALUE 5046.
       78  78-ID-chk-spost-ago VALUE 5047.
       78  78-ID-chk-spost-dic VALUE 5048.
       78  78-ID-ef-fido VALUE 5049.
       78  78-ID-ef-fido-data VALUE 5050.
       78  78-ID-ef-fido-extra VALUE 5051.
       78  78-ID-ef-fide VALUE 5052.
       78  78-ID-ef-PFA VALUE 5053.
       78  78-ID-ef-data-fido-extra VALUE 5054.
       78  78-ID-ef-grade VALUE 5055.
       78  78-ID-ef-abi VALUE 5056.
       78  78-ID-ef-cab VALUE 5057.
       78  78-ID-form1-gd-1 VALUE 5058.
       78  78-ID-ef-ragsoc-1-d VALUE 5059.
       78  78-ID-ef-ragsoc-2-d VALUE 5060.
       78  78-ID-ef-indirizzo-d VALUE 5061.
       78  78-ID-ef-cap-d VALUE 5062.
       78  78-ID-ef-localita-d VALUE 5063.
       78  78-ID-ef-prov-d VALUE 5064.
       78  78-ID-ef-nazione-d VALUE 5065.
       78  78-ID-chk-invio-d VALUE 5066.
       78  78-ID-ef-telef-1-d VALUE 5067.
       78  78-ID-ef-telef-2-d VALUE 5068.
       78  78-ID-ef-fax-d VALUE 5069.
       78  78-ID-ef-mail-d VALUE 5070.
       78  78-ID-ef-referente-d VALUE 5071.
       78  78-ID-ef-piva-d VALUE 5072.
       78  78-ID-ef-agente-d VALUE 5073.
       78  78-ID-ef-vettore-d VALUE 5074.
       78  78-ID-chk-deposito-utf VALUE 5075.
       78  78-ID-chk-superamento-d VALUE 5076.
       78  78-ID-cbo-stato-d VALUE 5077.
       78  78-ID-cbo-tipo-art-d VALUE 5078.
       78  78-ID-ef-cod-ditta-d VALUE 5079.
       78  78-ID-ef-CIG-d VALUE 5080.
       78  78-ID-ef-note-1 VALUE 5081.
       78  78-ID-ef-note-data VALUE 5082.
       78  78-ID-ef-note-2 VALUE 5083.
       78  78-ID-ef-note-3 VALUE 5084.
       78  78-ID-ef-note-4 VALUE 5085.
       78  78-ID-ef-ragsoc-1-r VALUE 5086.
       78  78-ID-ef-ragsoc-2-r VALUE 5087.
       78  78-ID-ef-indirizzo-r VALUE 5088.
       78  78-ID-ef-localita-r VALUE 5089.
       78  78-ID-ef-cap-r VALUE 5090.
       78  78-ID-ef-prov-r VALUE 5091.
       78  78-ID-ef-nazione-r VALUE 5092.
       78  78-ID-cbo-invio VALUE 5093.
       78  78-ID-chk-dett-dest-sdi VALUE 5094.
       78  78-ID-chk-escludi-int VALUE 5095.
       78  78-ID-ef-dich-n VALUE 5096.
       78  78-ID-ef-data-dich VALUE 5097.
       78  78-ID-ef-data-reg VALUE 5098.
       78  78-ID-ef-reg-n VALUE 5099.
       78  78-ID-gd-destini-e VALUE 5100.
       78  78-ID-chk-escludi-e VALUE 5101.
       78  78-ID-chk-intera-e VALUE 5102.
       78  78-ID-chk-accorpa-e VALUE 5103.
       78  78-ID-chk-saldo-banco-e VALUE 5104.
       78  78-ID-chk-saldo-promo-e VALUE 5105.
       78  78-ID-ef-gg-e VALUE 5106.
       78  78-ID-gd-evasioni VALUE 5107.
       78  78-ID-gd-prg VALUE 5108.
       78  78-ID-ef-id-edi VALUE 5109.
       78  78-ID-ef-q-id-edi VALUE 5110.
       78  78-ID-ef-codforn-edi VALUE 5111.
       78  78-ID-ef-q-codforn-edi VALUE 5112.
       78  78-ID-ef-piva-c-edi VALUE 5113.
       78  78-ID-ef-ragsoc-c-edi VALUE 5114.
       78  78-ID-ef-ind-c-edi VALUE 5115.
       78  78-ID-ef-citta-c-edi VALUE 5116.
       78  78-ID-ef-prov-c-edi VALUE 5117.
       78  78-ID-ef-cap-c-edi VALUE 5118.
       78  78-ID-ef-codcli-edi VALUE 5119.
       78  78-ID-ef-q-codcli-edi VALUE 5120.
       78  78-ID-ef-dest-edi VALUE 5121.
       78  78-ID-ef-q-dest-edi VALUE 5122.
       78  78-ID-ef-ragsoc-d-edi VALUE 5123.
       78  78-ID-ef-ind-d-edi VALUE 5124.
       78  78-ID-ef-citta-d-edi VALUE 5125.
       78  78-ID-ef-prov-d-edi VALUE 5126.
       78  78-ID-ef-cap-d-edi VALUE 5127.
       78  78-ID-chk-imp-i VALUE 5128.
       78  78-ID-chk-imp-a VALUE 5129.
       78  78-ID-chk-exp-i VALUE 5130.
       78  78-ID-ef-note-cli VALUE 5131.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "COMMON-LINKAGE.DEF".

      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           AFTER PROCEDURE Form1-AfterProcedure,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           .

      * ENTRY FIELD
       05
           ef-codice, 
           Entry-Field, 
           COL 16,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-k,
           ID IS 78-ID-ef-codice,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 5,
           VALUE ef-codice-BUF,
           .

      * TAB
       05
           Screen1-Ta-1, 
           Tab-Control, 
           COL 2,50, 
           LINE 5,08,
           LINES 53,31 ,
           SIZE 155,00 ,
           ID IS 5000,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           EVENT PROCEDURE Screen1-Ta-1-Event-Proc,
           .

      * PAGE
       05
           PAGE-1, 
           VISIBLE Form1-Pg-1-Visible,
           COL 4, 
           LINE 7,
           .

      * ENTRY FIELD
       10
           ef-ragsoc-1, 
           Entry-Field, 
           COL 21,17, 
           LINE 9,23,
           LINES 1,31 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ragsoc-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 40,
           VALUE ef-ragsoc-1-BUF,
           .

      * ENTRY FIELD
       10
           ef-ragsoc-2, 
           Entry-Field, 
           COL 96,17, 
           LINE 9,23,
           LINES 1,31 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ragsoc-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 40,
           VALUE ef-ragsoc-2-BUF,
           .

      * ENTRY FIELD
       10
           ef-indirizzo, 
           Entry-Field, 
           COL 21,17, 
           LINE 11,23,
           LINES 1,31 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-indirizzo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 40,
           VALUE ef-indirizzo-BUF,
           .

      * ENTRY FIELD
       10
           ef-cap, 
           Entry-Field, 
           COL 96,17, 
           LINE 11,23,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cap,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           VALUE ef-cap-BUF,
           .

      * ENTRY FIELD
       10
           ef-localita, 
           Entry-Field, 
           COL 114,17, 
           LINE 11,23,
           LINES 1,31 ,
           SIZE 40,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-localita,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-localita-BUF,
           .

      * ENTRY FIELD
       10
           ef-prov, 
           Entry-Field, 
           COL 21,17, 
           LINE 13,23,
           LINES 1,31 ,
           SIZE 4,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prov,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 2,
           VALUE ef-prov-BUF,
           .

      * ENTRY FIELD
       10
           ef-nazione, 
           Entry-Field, 
           COL 96,17, 
           LINE 13,23,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-nazione,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-nazione-BUF,
           .

      * ENTRY FIELD
       10
           ef-sdi, 
           Entry-Field, 
           COL 140,17, 
           LINE 13,23,
           LINES 1,31 ,
           SIZE 14,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sdi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 7,
           VALUE ef-sdi-BUF,
           .

      * ENTRY FIELD
       10
           ef-tel-1, 
           Entry-Field, 
           COL 21,17, 
           LINE 15,23,
           LINES 1,31 ,
           SIZE 26,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-tel-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-tel-1-BUF,
           .

      * ENTRY FIELD
       10
           ef-tel-2, 
           Entry-Field, 
           COL 53,17, 
           LINE 15,23,
           LINES 1,31 ,
           SIZE 26,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-tel-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-tel-2-BUF,
           .

      * ENTRY FIELD
       10
           ef-fax, 
           Entry-Field, 
           COL 96,17, 
           LINE 15,23,
           LINES 1,31 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-fax,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-fax-BUF,
           .

      * ENTRY FIELD
       10
           ef-mail, 
           Entry-Field, 
           COL 21,17, 
           LINE 17,23,
           LINES 2,38 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-mail,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 500,
           VSCROLL-BAR,
           VALUE ef-mail-BUF,
           .

      * ENTRY FIELD
       10
           ef-maila, 
           Entry-Field, 
           COL 21,17, 
           LINE 20,08,
           LINES 2,38 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 500,
           VSCROLL-BAR,
           VALUE ef-maila-BUF,
           .

      * ENTRY FIELD
       10
           ef-url, 
           Entry-Field, 
           COL 96,17, 
           LINE 17,23,
           LINES 1,31 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-url,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-url-BUF,
           .

      * ENTRY FIELD
       10
           ef-tipo, 
           Entry-Field, 
           COL 21,17, 
           LINE 22,92,
           LINES 1,31 ,
           SIZE 4,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-tipo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 2,
           VALUE ef-tipo-BUF,
           .

      * ENTRY FIELD
       10
           ef-gdo, 
           Entry-Field, 
           COL 96,17, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gdo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           VALUE ef-gdo-BUF,
           .

      * CHECK BOX
       10
           chk-utf, 
           Check-Box, 
           COL 151,17, 
           LINE 22,08,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "cli-utf",
           VALUE chk-utf-BUF,
            .

      * ENTRY FIELD
       10
           ef-referente, 
           Entry-Field, 
           COL 21,17, 
           LINE 24,54,
           LINES 1,31 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-referente,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-referente-BUF,
           .

      * ENTRY FIELD
       10
           ef-vettore, 
           Entry-Field, 
           COL 96,17, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vettore,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-vettore-BUF,
           .

      * CHECK BOX
       10
           chk-inoltro, 
           Check-Box, 
           COL 151,17, 
           LINE 24,08,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-inoltro,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Check Box",
           VALUE chk-inoltro-BUF,
           VISIBLE 0,
            .

      * ENTRY FIELD
       10
           ef-agente, 
           Entry-Field, 
           COL 21,17, 
           LINE 26,39,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-agente,
           FONT IS Small-Font,
           ID IS 78-ID-ef-agente,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-agente-BUF,
           .

      * COMBO-BOX
       10
           cbo-stato, 
           Combo-Box, 
           COL 96,17, 
           LINE 26,46,
           LINES 5,00 ,
           SIZE 16,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-stato,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-stato-buf,
           AFTER PROCEDURE cbo-stato-AfterProcedure, 
           EVENT PROCEDURE cbo-stato-Event-Proc,
           .

      * COMBO-BOX
       10
           cbo-cau-blocco, 
           Combo-Box, 
           COL 127,50, 
           LINE 26,46,
           LINES 7,00 ,
           SIZE 27,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod-blocco,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-cau-blocco,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-cau-blocco-buf,
           AFTER PROCEDURE cbo-stato-AfterProcedure, 
           .

      * ENTRY FIELD
       10
           ef-agente2, 
           Entry-Field, 
           COL 21,17, 
           LINE 28,08,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-agente,
           FONT IS Small-Font,
           ID IS 78-ID-ef-agente2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-agente2-BUF,
           .

      * CHECK BOX
       10
           chk-superamento, 
           Check-Box, 
           COL 35,17, 
           LINE 29,85,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-superamento,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "cli-superamento-500",
           VALUE chk-superamento-BUF,
           VISIBLE 0,
            .

      * CHECK BOX
       10
           chk-24000, 
           Check-Box, 
           COL 76,17, 
           LINE 29,85,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-24000,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-24000-BUF,
           VISIBLE 0,
            .

      * ENTRY FIELD
       10
           ef-cod-ditta, 
           Entry-Field, 
           COL 96,17, 
           LINE 29,08,
           LINES 1,31 ,
           SIZE 42,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cod-ditta,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-cod-ditta-BUF,
           .

      * ENTRY FIELD
       10
           ef-PFA-perce, 
           Entry-Field, 
           COL 146,17, 
           LINE 29,08,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-PFA-perce,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           VALUE ef-PFA-perce-BUF,
           .

      * ENTRY FIELD
       10
           ef-note, 
           Entry-Field, 
           COL 21,17, 
           LINE 31,39,
           LINES 8,50 ,
           SIZE 133,00 ,
           BOXED,
           COLOR IS 513,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 2000,
           READ-ONLY,
           VSCROLL-BAR,
           USE-RETURN,
           VALUE ef-note-BUF,
           .

      * ENTRY FIELD
       10
           ef-note-agg, 
           Entry-Field, 
           COL 21,17, 
           LINE 40,62,
           LINES 1,31 ,
           SIZE 130,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-agg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-note-agg-BUF,
           .

      * PUSH BUTTON
       10
           pb-note, 
           Push-Button, 
           COL 151,17, 
           LINE 40,23,
           LINES 1,31 ,
           SIZE 3,00 ,
           EXCEPTION-VALUE 1001,
           FONT IS Small-Font,
           ID IS 69,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * COMBO-BOX
       10
           cbo-sost-art, 
           Combo-Box, 
           COL 21,17, 
           LINE 42,69,
           LINES 5,00 ,
           SIZE 16,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-sost-art,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-sost-art-buf,
           AFTER PROCEDURE cbo-stato-AfterProcedure, 
           .

      * COMBO-BOX
       10
           cbo-tipo-art, 
           Combo-Box, 
           COL 47,84, 
           LINE 42,69,
           LINES 5,00 ,
           SIZE 16,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-tipo-art,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-tipo-art-buf,
           AFTER PROCEDURE cbo-stato-AfterProcedure, 
           .

      * CHECK BOX
       10
           chk-invio-bolle-EDI, 
           Check-Box, 
           COL 78,67, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-invio-bolle-EDI,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-invio-bolle-EDI-BUF,
            .

      * CHECK BOX
       10
           chk-destino-auto, 
           Check-Box, 
           COL 110,34, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-destino-auto,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-destino-auto-BUF,
            .

      * CHECK BOX
       10
           chk-escludi-fido, 
           Check-Box, 
           COL 125,34, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-escludi-fido,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-escludi-fido-BUF,
            .

      * CHECK BOX
       10
           chk-contrassegno, 
           Check-Box, 
           COL 143,67, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-contrassegno,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-contrassegno-BUF,
            .

      * RADIO BUTTON
       10
           rb-pers, 
           Radio-Button, 
           COL 21,17, 
           LINE 46,08,
           LINES 1,15 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           FLAT,
           GROUP 1,
           GROUP-VALUE 1,
           ID IS 78-ID-rb-pers,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "&F",
           VALUE Form1-RADIO-1-BUF,
           BEFORE PROCEDURE Form1-DaRb-1-BeforeProcedure, 
            .

      * RADIO BUTTON
       10
           rb-soc, 
           Radio-Button, 
           COL 39,17, 
           LINE 46,08,
           LINES 1,15 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           FLAT,
           GROUP 1,
           GROUP-VALUE 2,
           ID IS 78-ID-rb-soc,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "&S",
           VALUE Form1-RADIO-1-BUF,
           BEFORE PROCEDURE Form1-DaRb-1-BeforeProcedure, 
            .

      * ENTRY FIELD
       10
           ef-gg, 
           Entry-Field, 
           COL 96,17, 
           LINE 45,85,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-gg-BUF,
           .

      * CHECK BOX
       10
           chk-fido, 
           Check-Box, 
           COL 121,17, 
           LINE 45,85,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-fido,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Check Box",
           VALUE chk-fido-BUF,
           VISIBLE 0,
            .

      * ENTRY FIELD
       10
           ef-esi, 
           Entry-Field, 
           COL 142,84, 
           LINE 45,85,
           LINES 1,31 ,
           SIZE 3,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-esi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 1,
           VALUE ef-esi-BUF,
           .

      * ENTRY FIELD
       10
           ef-codfis, 
           Entry-Field, 
           COL 21,17, 
           LINE 47,77,
           LINES 1,31 ,
           SIZE 24,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-codfis,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 16,
           VALUE ef-codfis-BUF,
           .

      * ENTRY FIELD
       10
           ef-piva, 
           Entry-Field, 
           COL 59,17, 
           LINE 47,77,
           LINES 1,31 ,
           SIZE 20,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-piva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 11,
           VALUE ef-piva-BUF,
           .

      * ENTRY FIELD
       10
           ef-iva-ese, 
           Entry-Field, 
           COL 96,17, 
           LINE 47,77,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-iva-ese,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-iva-ese-BUF,
           .

      * ENTRY FIELD
       10
           ef-pag, 
           Entry-Field, 
           COL 21,17, 
           LINE 49,77,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-pag-BUF,
           .

      * ENTRY FIELD
       10
           ef-cod-iva, 
           Entry-Field, 
           COL 96,17, 
           LINE 49,77,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cod-iva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-cod-iva-BUF,
           .

      * CHECK BOX
       10
           chk-spost-ago, 
           Check-Box, 
           COL 124,50, 
           LINE 51,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-spost-ago,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Check Box",
           VALUE chk-spost-ago-BUF,
            .

      * CHECK BOX
       10
           chk-spost-dic, 
           Check-Box, 
           COL 149,50, 
           LINE 51,15,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-spost-dic,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-spost-dic-BUF,
            .

      * ENTRY FIELD
       10
           ef-fido, 
           Entry-Field, 
           COL 21,17, 
           LINE 51,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-fido,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 17,
           VALUE ef-fido-BUF,
           .

      * ENTRY FIELD
       10
           ef-fido-data, 
           Entry-Field, 
           COL 57,50, 
           LINE 51,77,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-fido-data,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 10,
           VALUE ef-fido-data-BUF,
           .

      * ENTRY FIELD
       10
           ef-fido-extra, 
           Entry-Field, 
           COL 96,17, 
           LINE 51,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-fido-extra,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 11,
           VALUE ef-fido-extra-BUF,
           .

      * ENTRY FIELD
       10
           ef-fide, 
           Entry-Field, 
           COL 21,17, 
           LINE 53,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-fide,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           VALUE ef-fide-BUF,
           .

      * ENTRY FIELD
       10
           ef-PFA, 
           Entry-Field, 
           COL 57,50, 
           LINE 53,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-PFA,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           VALUE ef-PFA-BUF,
           .

      * ENTRY FIELD
       10
           ef-data-fido-extra, 
           Entry-Field, 
           COL 82,50, 
           LINE 53,69,
           LINES 1,31 ,
           SIZE 12,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data-fido-extra,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-data-fido-extra-BUF,
           .

      * ENTRY FIELD
       10
           ef-grade, 
           Entry-Field, 
           COL 104,17, 
           LINE 53,69,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-grade,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 10,
           VALUE ef-grade-BUF,
           BEFORE PROCEDURE ef-data-fido-extra-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-espo, 
           Push-Button, 
           COL 121,84, 
           LINE 53,31,
           LINES 23,00 ,
           SIZE 91,00 ,
           BITMAP-HANDLE ESPOSIZIONE_91X21-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1008,
           FLAT,
           FONT IS Small-Font,
           ID IS 173,
           TITLE "Es&posizione",
           AFTER PROCEDURE pb-espo-AfterProcedure, 
           BEFORE PROCEDURE pb-espo-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-finanz, 
           Push-Button, 
           COL 138,17, 
           LINE 53,31,
           LINES 23,00 ,
           SIZE 91,00 ,
           BITMAP-HANDLE SITFIN_91X21-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1007,
           FLAT,
           FONT IS Small-Font,
           ID IS 189,
           TITLE "Visualizza la situazione finanziaria del Cliente verif
      -    "icando situazione attuale fido concesso e scaduto",
           AFTER PROCEDURE pb-finanz-AfterProcedure, 
           BEFORE PROCEDURE pb-finanz-BeforeProcedure, 
           .

      * ENTRY FIELD
       10
           ef-abi, 
           Entry-Field, 
           COL 21,17, 
           LINE 55,69,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-abi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           NUMERIC,
           VALUE ef-abi-BUF,
           .

      * ENTRY FIELD
       10
           ef-cab, 
           Entry-Field, 
           COL 57,50, 
           LINE 55,69,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cab,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           NUMERIC,
           VALUE ef-cab-BUF,
           .

      * PUSH BUTTON
       10
           pb-nota-pie, 
           Push-Button, 
           COL 135,17, 
           LINE 55,46,
           LINES 21,00 ,
           SIZE 109,00 ,
           BITMAP-HANDLE NOTE_109X23-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1000,
           FLAT,
           FONT IS Small-Font,
           ID IS 135,
           TITLE "&Note a pié bolla",
           AFTER PROCEDURE pb-nota-pie-AfterProcedure, 
           BEFORE PROCEDURE pb-nota-pie-BeforeProcedure, 
           .

      * LABEL
       10
           Form1-La-1abbba, 
           Label, 
           COL 4,17, 
           LINE 7,23,
           LINES 1,31 ,
           SIZE 16,83 ,
           COLOR IS 80,
           ID IS 560,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Sezione Anagrafica",
           .

      * BAR
       10
           Form1-Br-2aca, 
           Bar,
           COL 21,67, 
           LINE 7,77,
           SIZE 135,00 ,
           ID IS 559,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-1abbbaa, 
           Label, 
           COL 4,17, 
           LINE 44,54,
           LINES 1,31 ,
           SIZE 16,83 ,
           COLOR IS 80,
           ID IS 561,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Dati Fatturazione",
           .

      * BAR
       10
           Form1-Br-2acaa, 
           Bar,
           COL 21,84, 
           LINE 45,00,
           SIZE 135,00 ,
           ID IS 562,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-1, 
           Label, 
           COL 5,17, 
           LINE 9,23,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Ragione Sociale 1",
           .

      * LABEL
       10
           Form1-La-2, 
           Label, 
           COL 83,34, 
           LINE 9,23,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 4,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Rag. Sociale 2",
           .

      * LABEL
       10
           Form1-La-3, 
           Label, 
           COL 5,17, 
           LINE 11,23,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 6,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Indirizzo",
           .

      * LABEL
       10
           Form1-La-4, 
           Label, 
           COL 83,34, 
           LINE 11,23,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 8,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "C.A.P.",
           .

      * LABEL
       10
           Form1-La-6, 
           Label, 
           COL 106,17, 
           LINE 11,23,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Località",
           .

      * LABEL
       10
           Form1-La-7, 
           Label, 
           COL 5,17, 
           LINE 13,23,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Provincia",
           .

      * LABEL
       10
           Form1-La-8, 
           Label, 
           COL 83,34, 
           LINE 13,23,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Nazione",
           .

      * LABEL
       10
           Form1-La-9, 
           Label, 
           COL 5,17, 
           LINE 47,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 18,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Fiscale",
           .

      * LABEL
       10
           Form1-La-10, 
           Label, 
           COL 47,17, 
           LINE 47,77,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Partita IVA",
           .

      * LABEL
       10
           Form1-La-11, 
           Label, 
           COL 5,17, 
           LINE 15,23,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 24,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Telefono 1",
           .

      * LABEL
       10
           Form1-La-12, 
           Label, 
           COL 47,67, 
           LINE 15,23,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tel. 2",
           .

      * LABEL
       10
           Form1-La-13, 
           Label, 
           COL 83,34, 
           LINE 15,23,
           LINES 1,31 ,
           SIZE 4,00 ,
           FONT IS Small-Font,
           ID IS 26,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Fax",
           .

      * LABEL
       10
           Form1-La-14, 
           Label, 
           COL 5,17, 
           LINE 17,23,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "E-mail",
           .

      * LABEL
       10
           Form1-La-15, 
           Label, 
           COL 83,34, 
           LINE 17,23,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 28,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "U.R.L.",
           .

      * LABEL
       10
           Form1-La-16, 
           Label, 
           COL 5,17, 
           LINE 24,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Referente",
           .

      * LABEL
       10
           Form1-La-17, 
           Label, 
           COL 83,34, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 32,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore",
           .

      * LABEL
       10
           Form1-La-18, 
           Label, 
           COL 138,17, 
           LINE 24,08,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Inoltro",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-19, 
           Label, 
           COL 5,17, 
           LINE 26,39,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 36,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Agente provvigioni",
           .

      * LABEL
       10
           Form1-La-21, 
           Label, 
           COL 82,17, 
           LINE 47,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 40,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. Esenzione",
           .

      * LABEL
       10
           Form1-La-22, 
           Label, 
           COL 5,17, 
           LINE 49,77,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Cod. Pagamento",
           .

      * LABEL
       10
           Form1-La-23, 
           Label, 
           COL 110,50, 
           LINE 51,23,
           LINES 2,00 ,
           SIZE 12,50 ,
           FONT IS Small-Font,
           ID IS 48,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Spostamento ricevute agosto",
           .

      * LABEL
       10
           Form1-La-24, 
           Label, 
           COL 133,84, 
           LINE 51,23,
           LINES 2,00 ,
           SIZE 14,33 ,
           FONT IS Small-Font,
           ID IS 51,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Spostamento ricevute dicembre",
           .

      * LABEL
       10
           Form1-La-25, 
           Label, 
           COL 5,17, 
           LINE 51,77,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 67,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Fido CERVED ",
           .

      * LABEL
       10
           Form1-La-26, 
           Label, 
           COL 40,50, 
           LINE 51,77,
           LINES 1,31 ,
           SIZE 16,00 ,
           FONT IS Small-Font,
           ID IS 73,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Fido alla data",
           .

      * LABEL
       10
           Form1-La-27, 
           Label, 
           COL 40,50, 
           LINE 55,69,
           LINES 1,31 ,
           SIZE 16,00 ,
           FONT IS Small-Font,
           ID IS 74,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice CAB",
           .

      * LABEL
       10
           Form1-La-28, 
           Label, 
           COL 5,17, 
           LINE 55,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 75,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Codice ABI",
           .

      * LABEL
       10
           Form1-La-29, 
           Label, 
           COL 83,34, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 76,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Stato",
           .

      * LABEL
       10
           Form1-La-30, 
           Label, 
           COL 5,17, 
           LINE 22,92,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 77,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tipo cliente",
           .

      * LABEL
       10
           Form1-La-31, 
           Label, 
           COL 83,34, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 38,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Gruppo GDO",
           .

      * LABEL
       10
           Form1-La-32, 
           Label, 
           COL 138,17, 
           LINE 22,08,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 78,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Deposito UTF",
           .

      * LABEL
       10
           Form1-La-33, 
           Label, 
           COL 5,17, 
           LINE 31,39,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 79,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note",
           .

      * LABEL
       10
           Form1-La-34, 
           Label, 
           COL 5,17, 
           LINE 40,62,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 80,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note aggiuntive",
           .

      * DB_LABEL
       10
           lab-agente, 
           Label, 
           COL 28,17, 
           LINE 26,39,
           LINES 1,31 ,
           SIZE 51,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 81,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-agente-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-vettore, 
           Label, 
           COL 106,17, 
           LINE 24,46,
           LINES 1,31 ,
           SIZE 38,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS AUTO-ID,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-vettore-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-tipo, 
           Label, 
           COL 28,17, 
           LINE 22,92,
           LINES 1,15 ,
           SIZE 51,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 83,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-tipo-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-gdo, 
           Label, 
           COL 106,17, 
           LINE 22,46,
           LINES 1,31 ,
           SIZE 31,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS AUTO-ID,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-gdo-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-nazione, 
           Label, 
           COL 106,17, 
           LINE 13,23,
           LINES 1,31 ,
           SIZE 20,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 85,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-nazione-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-citta, 
           Label, 
           COL 28,17, 
           LINE 13,23,
           LINES 1,15 ,
           SIZE 25,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 86,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-citta-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-regione, 
           Label, 
           COL 54,17, 
           LINE 13,23,
           LINES 1,15 ,
           SIZE 25,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 87,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-regione-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-60, 
           Label, 
           COL 5,00, 
           LINE 29,85,
           LINES 1,31 ,
           SIZE 29,00 ,
           FONT IS Small-Font,
           ID IS 88,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Blocco bolle superiori a 500 Kg. UTF",
           VISIBLE 0,
           .

      * LABEL
       10
           lab-banca, 
           Label, 
           COL 72,17, 
           LINE 55,08,
           LINES 2,54 ,
           SIZE 62,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 167,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-banca-buf,
           .

      * LABEL
       10
           lab-iva-ese, 
           Label, 
           COL 106,17, 
           LINE 47,77,
           LINES 1,31 ,
           SIZE 44,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-iva-ese-buf,
           .

      * LABEL
       10
           lab-pag, 
           Label, 
           COL 29,17, 
           LINE 49,77,
           LINES 1,50 ,
           SIZE 50,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 172,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-pag-buf,
           .

      * LABEL
       10
           Form1-La-66, 
           Label, 
           COL 25,17, 
           LINE 45,85,
           LINES 1,15 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 174,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Persona &Fisica",
           .

      * LABEL
       10
           Form1-La-67, 
           Label, 
           COL 43,17, 
           LINE 45,85,
           LINES 1,15 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 180,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "&Società",
           .

      * LABEL
       10
           Form1-La-26a, 
           Label, 
           COL 76,00, 
           LINE 51,77,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 181,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Fido extra assicurato ",
           .

      * LABEL
       10
           Form1-La-60b, 
           Label, 
           COL 46,17, 
           LINE 29,85,
           LINES 1,31 ,
           SIZE 29,00 ,
           FONT IS Small-Font,
           ID IS 182,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Blocco ordini superiori 24000 Kg",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-15a, 
           Label, 
           COL 83,34, 
           LINE 28,69,
           LINES 2,08 ,
           SIZE 12,50 ,
           FONT IS Small-Font,
           ID IS 183,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Ditta/Registro",
           .

      * LABEL
       10
           Form1-La-21a, 
           Label, 
           COL 82,17, 
           LINE 45,85,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 184,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG dilazione",
           .

      * LABEL
       10
           Form1-La-23a, 
           Label, 
           COL 105,50, 
           LINE 45,85,
           LINES 1,31 ,
           SIZE 12,50 ,
           FONT IS Small-Font,
           ID IS 185,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Gestione fido",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-29a, 
           Label, 
           COL 113,50, 
           LINE 26,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 186,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Causale Blocco",
           .

      * LABEL
       10
           Form1-La-25a, 
           Label, 
           COL 5,17, 
           LINE 53,77,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 188,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Fido assicurato ",
           .

      * LABEL
       10
           Form1-La-26b, 
           Label, 
           COL 40,50, 
           LINE 53,77,
           LINES 1,31 ,
           SIZE 16,00 ,
           FONT IS Small-Font,
           ID IS 193,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Fido commerciale ",
           .

      * LABEL
       10
           Form1-La-26ba, 
           Label, 
           COL 139,17, 
           LINE 29,08,
           LINES 1,31 ,
           SIZE 5,50 ,
           FONT IS Small-Font,
           ID IS 194,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "PFA %",
           .

      * LABEL
       10
           Form1-La-29aa, 
           Label, 
           COL 5,17, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 195,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sost. articolo",
           .

      * LABEL
       10
           Form1-La-29aaa, 
           Label, 
           COL 38,50, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 196,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tipologia",
           .

      * LABEL
       10
           Form1-La-21b, 
           Label, 
           COL 82,17, 
           LINE 49,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 197,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. IVA",
           .

      * LABEL
       10
           lab-cod-iva, 
           Label, 
           COL 106,17, 
           LINE 49,77,
           LINES 1,31 ,
           SIZE 44,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 198,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cod-iva-buf,
           .

      * LABEL
       10
           Form1-La-26aa, 
           Label, 
           COL 76,17, 
           LINE 53,77,
           LINES 1,31 ,
           SIZE 5,00 ,
           FONT IS Small-Font,
           ID IS 199,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Data",
           .

      * LABEL
       10
           Form1-La-29b, 
           Label, 
           COL 65,50, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 200,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Invio bolle EDI",
           .

      * LABEL
       10
           Form1-La-29ba, 
           Label, 
           COL 84,67, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 25,00 ,
           FONT IS Small-Font,
           ID IS 201,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Aggiunta auomatica destini EDI",
           .

      * LABEL
       10
           Form1-La-19a, 
           Label, 
           COL 5,17, 
           LINE 28,08,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 202,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Agente 2",
           .

      * DB_LABEL
       10
           lab-agente2, 
           Label, 
           COL 28,17, 
           LINE 28,08,
           LINES 1,31 ,
           SIZE 51,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 203,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-agente2-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-8a, 
           Label, 
           COL 128,34, 
           LINE 13,23,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 204,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice SDI",
           .

      * LABEL
       10
           Form1-La-14a, 
           Label, 
           COL 5,17, 
           LINE 20,08,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 205,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "PEC",
           .

      * LABEL
       10
           Form1-La-81, 
           Label, 
           COL 129,00, 
           LINE 45,85,
           LINES 1,31 ,
           SIZE 12,17 ,
           ID IS 289,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Esigibilità IVA",
           .

      * LABEL
       10
           Form1-La-26aaa, 
           Label, 
           COL 96,17, 
           LINE 53,77,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 290,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Grade",
           .

      * LABEL
       10
           Form1-La-29baa, 
           Label, 
           COL 114,67, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 291,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Escludi fido",
           .

      * LABEL
       10
           Form1-La-29baaa, 
           Label, 
           COL 131,34, 
           LINE 42,69,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 292,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Contrassegno",
           .

      * PAGE
       05
           PAGE-2, 
           VISIBLE Form1-Pg-2-Visible,
           COL 4, 
           LINE 7,
           .

      * GRID
       10
           form1-gd-1, 
           Grid, 
           COL 4,34, 
           LINE 7,77,
           LINES 15,46 ,
           SIZE 151,17 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           DATA-COLUMNS (1, 6, 106, 146, 151, 186),
           ALIGNMENT ("R", "U", "U", "U", "U", "U"),
           SEPARATION (5, 5, 5, 5, 5, 5),
           DATA-TYPES ("9(5)", "X", "X", "X", "X", "X"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-COLOR 481
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           HSCROLL,
           ID IS 78-ID-form1-gd-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           USE-TAB,
           VIRTUAL-WIDTH 148,
           VPADDING 50,
           VSCROLL,
           EVENT PROCEDURE Form1-Gd-1-Event-Proc,
           .

      * ENTRY FIELD
       10
           ef-ragsoc-1-d, 
           Entry-Field, 
           COL 18,17, 
           LINE 26,77,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ragsoc-1-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 100,
           VALUE ef-ragsoc-1-d-BUF,
           .

      * ENTRY FIELD
       10
           ef-ragsoc-2-d, 
           Entry-Field, 
           COL 93,17, 
           LINE 26,77,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ragsoc-2-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 100,
           VALUE ef-ragsoc-2-d-BUF,
           .
      * ENTRY FIELD
       10
           ef-indirizzo-d, 
           Entry-Field, 
           COL 18,17, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-indirizzo-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 40,
           VALUE ef-indirizzo-d-BUF,
           .

      * ENTRY FIELD
       10
           ef-cap-d, 
           Entry-Field, 
           COL 93,17, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cap-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           VALUE ef-cap-d-BUF,
           .

      * ENTRY FIELD
       10
           ef-localita-d, 
           Entry-Field, 
           COL 110,17, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 40,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-localita-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-localita-d-BUF,
           .

      * ENTRY FIELD
       10
           ef-prov-d, 
           Entry-Field, 
           COL 18,17, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 4,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prov-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 2,
           VALUE ef-prov-d-BUF,
           .

      * ENTRY FIELD
       10
           ef-nazione-d, 
           Entry-Field, 
           COL 93,17, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 5,83 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-nazione-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-nazione-d-BUF,
           .

      * CHECK BOX
       10
           chk-invio-d, 
           Check-Box, 
           COL 147,17, 
           LINE 30,62,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-destini,
           FLAT,
           ID IS 78-ID-chk-invio-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-invio-d-BUF,
            .
      * ENTRY FIELD
       10
           ef-telef-1-d, 
           Entry-Field, 
           COL 18,17, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 25,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-telef-1-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-telef-1-d-BUF,
           .
      * ENTRY FIELD
       10
           ef-telef-2-d, 
           Entry-Field, 
           COL 50,17, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 25,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-telef-2-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-telef-2-d-BUF,
           .
      * ENTRY FIELD
       10
           ef-fax-d, 
           Entry-Field, 
           COL 93,17, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-fax-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-fax-d-BUF,
           .
      * ENTRY FIELD
       10
           ef-mail-d, 
           Entry-Field, 
           COL 18,17, 
           LINE 34,77,
           LINES 3,50 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-mail-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 500,
           VSCROLL-BAR,
           VALUE ef-mail-d-BUF,
           .
      * ENTRY FIELD
       10
           ef-referente-d, 
           Entry-Field, 
           COL 93,17, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 37,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-referente-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-referente-d-BUF,
           .
      * ENTRY FIELD
       10
           ef-piva-d, 
           Entry-Field, 
           COL 137,17, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-piva-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 11,
           VALUE ef-piva-d-BUF,
           .

      * ENTRY FIELD
       10
           ef-agente-d, 
           Entry-Field, 
           COL 93,17, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 5,83 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-agente-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-agente-d-BUF,
           BEFORE PROCEDURE ef-agente-d-BeforeProcedure, 
           .

      * ENTRY FIELD
       10
           ef-vettore-d, 
           Entry-Field, 
           COL 18,17, 
           LINE 39,08,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vettore-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-vettore-d-BUF,
           .

      * CHECK BOX
       10
           chk-deposito-utf, 
           Check-Box, 
           COL 93,17, 
           LINE 39,08,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-destini,
           FLAT,
           ID IS 78-ID-chk-deposito-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Check Box",
           VALUE chk-deposito-utf-BUF,
            .
      * CHECK BOX
       10
           chk-superamento-d, 
           Check-Box, 
           COL 118,17, 
           LINE 39,08,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-destini,
           FLAT,
           ID IS 78-ID-chk-superamento-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "cli-superamento-500",
           VALUE chk-superamento-d-BUF,
           VISIBLE 0,
            .
      * COMBO-BOX
       10
           cbo-stato-d, 
           Combo-Box, 
           COL 133,17, 
           LINE 39,23,
           LINES 5,00 ,
           SIZE 17,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-stato-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-stato-d-buf,
           AFTER PROCEDURE cbo-stato-d-AfterProcedure, 
           .
      * COMBO-BOX
       10
           cbo-tipo-art-d, 
           Combo-Box, 
           COL 18,50, 
           LINE 41,62,
           LINES 5,00 ,
           SIZE 15,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-tipo-art-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-tipo-art-d-buf,
           AFTER PROCEDURE cbo-stato-d-AfterProcedure, 
           .
      * ENTRY FIELD
       10
           ef-cod-ditta-d, 
           Entry-Field, 
           COL 92,84, 
           LINE 41,62,
           LINES 1,31 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cod-ditta-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-cod-ditta-d-BUF,
           .

      * ENTRY FIELD
       10
           ef-CIG-d, 
           Entry-Field, 
           COL 93,17, 
           LINE 44,00,
           LINES 1,31 ,
           SIZE 15,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-CIG-d,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 15,
           VALUE ef-CIG-d-BUF,
           .
      * ENTRY FIELD
       10
           ef-note-1, 
           Entry-Field, 
           COL 18,17, 
           LINE 47,46,
           LINES 1,31 ,
           SIZE 38,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 19,
           VALUE ef-note-1-BUF,
           .
      * ENTRY FIELD
       10
           ef-note-data, 
           Entry-Field, 
           COL 64,17, 
           LINE 47,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-data,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-note-data-BUF,
           .

      * ENTRY FIELD
       10
           ef-note-2, 
           Entry-Field, 
           COL 93,17, 
           LINE 47,46,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-note-2-BUF,
           .
      * ENTRY FIELD
       10
           ef-note-3, 
           Entry-Field, 
           COL 18,17, 
           LINE 49,46,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-note-3-BUF,
           .
      * ENTRY FIELD
       10
           ef-note-4, 
           Entry-Field, 
           COL 93,17, 
           LINE 49,46,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-note-4-BUF,
           .
      * PUSH BUTTON
       10
           pb-note-bolla, 
           Push-Button, 
           COL 151,50, 
           LINE 49,46,
           LINES 1,31 ,
           SIZE 4,00 ,
           EXCEPTION-VALUE 75,
           FONT IS Small-Font,
           ID IS 278,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * BAR
       10
           Form1-Br-1, 
           Bar,
           COL 3,17, 
           LINE 25,77,
           SIZE 153,67 ,
           ID IS 91,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-35, 
           Label, 
           COL 5,00, 
           LINE 26,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 93,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Rag. Sociale I",
           .

      * LABEL
       10
           Form1-La-36, 
           Label, 
           COL 79,17, 
           LINE 26,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 95,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Rag. Sociale II",
           .

      * LABEL
       10
           Form1-La-37, 
           Label, 
           COL 5,00, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 97,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Indirizzo",
           .

      * LABEL
       10
           Form1-La-38, 
           Label, 
           COL 79,17, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 100,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "CAP",
           .

      * LABEL
       10
           Form1-La-39, 
           Label, 
           COL 102,17, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 102,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Località",
           .

      * LABEL
       10
           Form1-La-40, 
           Label, 
           COL 5,00, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 104,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Provincia",
           .

      * LABEL
       10
           Form1-La-41, 
           Label, 
           COL 79,17, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 106,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Nazione",
           .

      * LABEL
       10
           Form1-La-42, 
           Label, 
           COL 5,00, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 108,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Telefono 1",
           .

      * LABEL
       10
           Form1-La-43, 
           Label, 
           COL 44,17, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 5,00 ,
           FONT IS Small-Font,
           ID IS 110,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tel. 2",
           .

      * LABEL
       10
           Form1-La-44, 
           Label, 
           COL 79,17, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 4,00 ,
           FONT IS Small-Font,
           ID IS 111,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Fax",
           .

      * LABEL
       10
           Form1-La-45, 
           Label, 
           COL 5,00, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 112,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "E-mail",
           .

      * LABEL
       10
           Form1-La-46, 
           Label, 
           COL 79,17, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 117,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Referente",
           .

      * LABEL
       10
           Form1-La-47, 
           Label, 
           COL 5,00, 
           LINE 39,08,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 119,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore",
           .

      * LABEL
       10
           Form1-La-48, 
           Label, 
           COL 79,17, 
           LINE 39,08,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 121,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Deposito UTF",
           .

      * LABEL
       10
           Form1-La-49, 
           Label, 
           COL 5,00, 
           LINE 47,00,
           LINES 2,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 122,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Dati di consegna",
           .

      * LABEL
       10
           Form1-La-50, 
           Label, 
           COL 79,17, 
           LINE 47,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 132,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note 2",
           .

      * LABEL
       10
           Form1-La-51, 
           Label, 
           COL 5,00, 
           LINE 49,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 133,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note 3",
           .

      * LABEL
       10
           Form1-La-52, 
           Label, 
           COL 79,17, 
           LINE 49,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 134,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note 4",
           .

      * LABEL
       10
           Form1-La-1abbbaaa, 
           Label, 
           COL 4,17, 
           LINE 45,31,
           LINES 1,31 ,
           SIZE 16,83 ,
           COLOR IS 80,
           ID IS 136,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Note a pié bolla",
           .

      * BAR
       10
           Form1-Br-3, 
           Bar,
           COL 21,34, 
           LINE 45,85,
           SIZE 135,00 ,
           ID IS 137,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           WIDTH 1,
           .

      * DB_LABEL
       10
           lab-vettore-d, 
           Label, 
           COL 28,17, 
           LINE 39,08,
           LINES 1,31 ,
           SIZE 47,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 138,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-vettore-d-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-nazione-d, 
           Label, 
           COL 102,17, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 31,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 139,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-nazione-d-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-citta-d, 
           Label, 
           COL 28,17, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 23,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 140,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-citta-d-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-regione-d, 
           Label, 
           COL 52,17, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 23,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 141,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-regione-d-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-53, 
           Label, 
           COL 58,17, 
           LINE 47,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           FONT IS Small-Font,
           ID IS 142,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data",
           .

      * PUSH BUTTON
       10
           pb-grid-salva, 
           Push-Button, 
           COL 110,17, 
           LINE 23,54,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 6,
           UNFRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 1004,
           FLAT,
           FONT IS Small-Font,
           ID IS 143,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "&Salva la riga appena inserita o quella modificata",
           AFTER PROCEDURE pb-grid-salva-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-salva-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-grid-nuovo, 
           Push-Button, 
           COL 123,17, 
           LINE 23,54,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 5,
           UNFRAMED,
           SQUARE,
           ENABLED E-NUOVO,
           EXCEPTION-VALUE 1003,
           FLAT,
           FONT IS Small-Font,
           ID IS 144,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Aggiunge una riga n&uova alla griglia",
           AFTER PROCEDURE pb-grid-nuovo-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-nuovo-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-grid-elimina, 
           Push-Button, 
           COL 136,17, 
           LINE 23,54,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 4,
           UNFRAMED,
           SQUARE,
           ENABLED E-CANCELLA,
           EXCEPTION-VALUE 1005,
           FLAT,
           FONT IS Small-Font,
           ID IS 145,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "&Elimina la riga selezionata",
           VISIBLE 0,
           AFTER PROCEDURE pb-grid-elimina-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-elimina-BeforeProcedure, 
           .

      * LABEL
       10
           Form1-La-54, 
           Label, 
           COL 125,17, 
           LINE 39,23,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 156,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Stato",
           .

      * LABEL
       10
           Form1-La-60aa, 
           Label, 
           COL 135,17, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 160,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Invio Fatture",
           .

      * LABEL
       10
           Form1-La-60a, 
           Label, 
           COL 101,17, 
           LINE 39,23,
           LINES 2,00 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 159,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Blocco bolle superiori a 500 Kg. UTF",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-46a, 
           Label, 
           COL 131,17, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 5,00 ,
           FONT IS Small-Font,
           ID IS 163,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "P.IVA",
           .

      * LABEL
       10
           Form1-La-15aa, 
           Label, 
           COL 78,84, 
           LINE 41,08,
           LINES 2,08 ,
           SIZE 12,50 ,
           FONT IS Small-Font,
           ID IS 164,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Ditta/Registro",
           .

      * LABEL
       10
           Form1-La-54a, 
           Label, 
           COL 5,00, 
           LINE 41,62,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 175,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tipologia",
           .

      * LABEL
       10
           Form1-La-46b, 
           Label, 
           COL 79,17, 
           LINE 44,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 176,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "CIG",
           .

      * LABEL
       10
           Form1-La-41a, 
           Label, 
           COL 79,17, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 177,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Agente",
           .

      * DB_LABEL
       10
           lab-agente-d, 
           Label, 
           COL 102,17, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 31,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 187,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-agente-d-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * PAGE
       05
           PAGE-3, 
           VISIBLE Form1-Pg-3-Visible,
           COL 4, 
           LINE 7,
           .

      * ENTRY FIELD
       10
           ef-ragsoc-1-r, 
           Entry-Field, 
           COL 19,17, 
           LINE 9,77,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ragsoc-1-r,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 40,
           VALUE ef-ragsoc-1-r-BUF,
           .

      * ENTRY FIELD
       10
           ef-ragsoc-2-r, 
           Entry-Field, 
           COL 94,17, 
           LINE 9,77,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ragsoc-2-r,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 40,
           VALUE ef-ragsoc-2-r-BUF,
           .

      * ENTRY FIELD
       10
           ef-indirizzo-r, 
           Entry-Field, 
           COL 19,17, 
           LINE 11,77,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-indirizzo-r,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 40,
           VALUE ef-indirizzo-r-BUF,
           .

      * ENTRY FIELD
       10
           ef-localita-r, 
           Entry-Field, 
           COL 94,17, 
           LINE 11,77,
           LINES 1,31 ,
           SIZE 57,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-localita-r,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-localita-r-BUF,
           .

      * ENTRY FIELD
       10
           ef-cap-r, 
           Entry-Field, 
           COL 19,17, 
           LINE 13,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cap-r,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           VALUE ef-cap-r-BUF,
           .

      * ENTRY FIELD
       10
           ef-prov-r, 
           Entry-Field, 
           COL 94,17, 
           LINE 13,77,
           LINES 1,31 ,
           SIZE 4,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prov-r,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 2,
           VALUE ef-prov-r-BUF,
           .

      * ENTRY FIELD
       10
           ef-nazione-r, 
           Entry-Field, 
           COL 19,17, 
           LINE 15,77,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-nazione-r,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-nazione-r-BUF,
           .

      * COMBO-BOX
       10
           cbo-invio, 
           Combo-Box, 
           COL 94,17, 
           LINE 15,77,
           LINES 5,00 ,
           SIZE 13,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-invio,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-invio-buf,
           AFTER PROCEDURE cbo-invio-AfterProcedure, 
           .

      * CHECK BOX
       10
           chk-dett-dest-sdi, 
           Check-Box, 
           COL 24,67, 
           LINE 17,77,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-dett-dest-sdi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Check Box",
           VALUE chk-dett-dest-sdi-BUF,
           BEFORE PROCEDURE Form1-DaCb-1-BeforeProcedure, 
            .

      * CHECK BOX
       10
           chk-escludi-int, 
           Check-Box, 
           COL 41,34, 
           LINE 17,77,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-escludi-int,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Check Box",
           VALUE chk-escludi-int-BUF,
           BEFORE PROCEDURE Form1-DaCb-1-BeforeProcedure, 
            .

      * ENTRY FIELD
       10
           ef-dich-n, 
           Entry-Field, 
           COL 19,17, 
           LINE 23,54,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-dich-n,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 8,
           VALUE ef-dich-n-BUF,
           .

      * ENTRY FIELD
       10
           ef-data-dich, 
           Entry-Field, 
           COL 38,17, 
           LINE 23,54,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data-dich,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 10,
           VALUE ef-data-dich-BUF,
           .

      * ENTRY FIELD
       10
           ef-data-reg, 
           Entry-Field, 
           COL 19,17, 
           LINE 25,54,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data-reg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 10,
           VALUE ef-data-reg-BUF,
           .

      * ENTRY FIELD
       10
           ef-reg-n, 
           Entry-Field, 
           COL 38,17, 
           LINE 25,54,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-reg-n,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 8,
           VALUE ef-reg-n-BUF,
           .

      * LABEL
       10
           Form1-La-55, 
           Label, 
           COL 5,17, 
           LINE 11,77,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 154,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Indirizzo",
           .

      * LABEL
       10
           Form1-La-56, 
           Label, 
           COL 5,17, 
           LINE 13,77,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 155,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "CAP",
           .

      * LABEL
       10
           Form1-La-57, 
           Label, 
           COL 80,17, 
           LINE 11,77,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 165,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Località",
           .

      * LABEL
       10
           Form1-La-58, 
           Label, 
           COL 80,17, 
           LINE 13,77,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 146,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Provincia",
           .

      * LABEL
       10
           Form1-La-59, 
           Label, 
           COL 5,17, 
           LINE 15,77,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 148,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Nazione",
           .

      * LABEL
       10
           Form1-La-35a, 
           Label, 
           COL 5,17, 
           LINE 9,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 211,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Rag. Sociale I",
           .

      * LABEL
       10
           Form1-La-35b, 
           Label, 
           COL 80,17, 
           LINE 9,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 212,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Rag. Sociale II",
           .

      * DB_LABEL
       10
           lab-citta-r, 
           Label, 
           COL 99,17, 
           LINE 13,77,
           LINES 1,31 ,
           SIZE 26,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 213,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-citta-r-BUF,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-regione-r, 
           Label, 
           COL 125,17, 
           LINE 13,77,
           LINES 1,31 ,
           SIZE 26,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 214,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-regione-r-BUF,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-nazione-r, 
           Label, 
           COL 26,17, 
           LINE 15,77,
           LINES 1,31 ,
           SIZE 50,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 215,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-nazione-r-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * BAR
       10
           Form1-Br-4, 
           Bar,
           COL 3,17, 
           LINE 29,08,
           SIZE 153,67 ,
           ID IS 216,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           WIDTH 1,
           .

      * BAR
       10
           Form1-Br-4a, 
           Bar,
           COL 3,17, 
           LINE 29,62,
           SIZE 153,67 ,
           ID IS 217,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-1abbbaaaa, 
           Label, 
           COL 4,17, 
           LINE 20,54,
           LINES 1,31 ,
           SIZE 21,00 ,
           COLOR IS 80,
           ID IS 218,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Dichiarazione d'intento",
           .

      * BAR
       10
           Form1-Br-3a, 
           Bar,
           COL 25,17, 
           LINE 21,08,
           SIZE 131,00 ,
           ID IS 219,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-61, 
           Label, 
           COL 5,17, 
           LINE 23,08,
           LINES 2,00 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 220,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Dichiarazione esportatore n.",
           .

      * LABEL
       10
           Form1-La-62, 
           Label, 
           COL 33,17, 
           LINE 23,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           FONT IS Small-Font,
           ID IS 221,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "del",
           .

      * LABEL
       10
           Form1-La-63, 
           Label, 
           COL 5,17, 
           LINE 25,54,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 222,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "registrata il",
           .

      * LABEL
       10
           Form1-La-64, 
           Label, 
           COL 33,17, 
           LINE 25,54,
           LINES 1,31 ,
           SIZE 3,00 ,
           FONT IS Small-Font,
           ID IS 223,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "n.",
           .

      * LABEL
       10
           Form1-La-65, 
           Label, 
           COL 80,17, 
           LINE 15,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tipo invio",
           .

      * LABEL
       10
           Form1-La-59a, 
           Label, 
           COL 5,17, 
           LINE 17,77,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 39,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Dettaglio destino SDI",
           .

      * LABEL
       10
           Form1-La-59aa, 
           Label, 
           COL 30,17, 
           LINE 17,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Escludi INT",
           .

      * PAGE
       05
           PAGE-4, 
           VISIBLE Form1-Pg-4-Visible,
           COL 4, 
           LINE 7,
           .

      * GRID
       10
           gd-destini-e, 
           Grid, 
           COL 14,50, 
           LINE 7,77,
           LINES 20,62 ,
           SIZE 131,17 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           DATA-COLUMNS (1, 6, 56, 106),
           ALIGNMENT ("R", "U", "U", "U"),
           SEPARATION (5, 5, 5, 5),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-destini-e,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 128,
           VPADDING 40,
           VSCROLL,
           EVENT PROCEDURE Form1-Gd-2-Event-Proc,
           .

      * CHECK BOX
       10
           chk-escludi-e, 
           Check-Box, 
           COL 38,00, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-escludi-e,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "cli-utf",
           VALUE chk-escludi-e-BUF,
            .
      * CHECK BOX
       10
           chk-intera-e, 
           Check-Box, 
           COL 38,00, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-intera-e,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "cli-utf",
           VALUE chk-intera-e-BUF,
            .
      * CHECK BOX
       10
           chk-accorpa-e, 
           Check-Box, 
           COL 38,00, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-accorpa-e,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "cli-utf",
           VALUE chk-accorpa-e-BUF,
            .
      * CHECK BOX
       10
           chk-saldo-banco-e, 
           Check-Box, 
           COL 38,00, 
           LINE 36,77,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-saldo-banco-e,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "cli-utf",
           VALUE chk-saldo-banco-e-BUF,
            .
      * CHECK BOX
       10
           chk-saldo-promo-e, 
           Check-Box, 
           COL 38,00, 
           LINE 38,77,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-saldo-promo-e,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "cli-utf",
           VALUE chk-saldo-promo-e-BUF,
            .
      * ENTRY FIELD
       10
           ef-gg-e, 
           Entry-Field, 
           COL 34,17, 
           LINE 40,77,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-agente,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-e,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-gg-e-BUF,
           .
      * GRID
       10
           gd-evasioni, 
           Grid, 
           COL 52,84, 
           LINE 30,77,
           LINES 17,69 ,
           SIZE 57,17 ,
           BOXED,
           DATA-COLUMNS (1, 4, 54),
           ALIGNMENT ("R", "U", "C"),
           SEPARATION (5, 5, 5),
           DATA-TYPES ("X", "X", "U"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-evasioni,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 54,
           VPADDING 40,
           VSCROLL,
           EVENT PROCEDURE Form1-Gd-2-Event-Proc,
           .

      * PUSH BUTTON
       10
           pb-copia, 
           Push-Button, 
           COL 18,00, 
           LINE 45,46,
           LINES 40,00 ,
           SIZE 132,00 ,
           BITMAP-HANDLE COPIA-CLIDES-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           ENABLED mod,
           EXCEPTION-VALUE 1009,
           FLAT,
           FONT IS Small-Font,
           ID IS 125,
           AFTER PROCEDURE pb-copia-AfterProcedure, 
           BEFORE PROCEDURE pb-copia-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-salva-eva, 
           Push-Button, 
           COL 110,17, 
           LINE 46,54,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 6,
           UNFRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 1011,
           FLAT,
           FONT IS Small-Font,
           ID IS 166,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           AFTER PROCEDURE pb-salva-eva-AfterProcedure, 
           BEFORE PROCEDURE pb-salva-eva-BeforeProcedure, 
           .

      * LABEL
       10
           Form1-La-32ab, 
           Label, 
           COL 14,50, 
           LINE 37,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 168,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Tenere SALDI:",
           .

      * LABEL
       10
           Form1-La-32aac, 
           Label, 
           COL 28,17, 
           LINE 36,77,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 224,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "BANCO",
           .

      * LABEL
       10
           Form1-La-32aaab, 
           Label, 
           COL 28,17, 
           LINE 38,77,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 225,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "PROMO",
           .

      * LABEL
       10
           Form1-La-32aabb, 
           Label, 
           COL 14,50, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 226,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE 'Esclusione "Evadi Tutto"',
           .

      * LABEL
       10
           Form1-La-32aaaab, 
           Label, 
           COL 14,50, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 227,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Accorpamento Master",
           .

      * LABEL
       10
           Form1-La-19aa, 
           Label, 
           COL 14,50, 
           LINE 40,77,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 228,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG validità volantino",
           .

      * BAR
       10
           Form1-Br-5, 
           Bar,
           COL 14,50, 
           LINE 29,31,
           SIZE 131,17 ,
           ID IS 229,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * BAR
       10
           Form1-Br-5a, 
           Bar,
           COL 14,50, 
           LINE 29,69,
           SIZE 131,17 ,
           ID IS 230,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-32aabba, 
           Label, 
           COL 14,50, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 21,00 ,
           FONT IS Small-Font,
           ID IS 231,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Evasione intera (no promo)",
           .

      * LABEL
       10
           Form1-La-68, 
           Label, 
           COL 153,50, 
           LINE 48,92,
           LINES 0,62 ,
           SIZE 3,33 ,
           FONT IS Large-Font,
           ID IS 232,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Label",
           VISIBLE 0,
           .

      * PAGE
       05
           PAGE-5, 
           VISIBLE Form1-Pg-5-Visible,
           COL 4, 
           LINE 7,
           .

      * GRID
       10
           gd-prg, 
           Grid, 
           COL 5,34, 
           LINE 8,39,
           LINES 35,85 ,
           SIZE 149,17 ,
           BOXED,
           DATA-COLUMNS (1, 7, 47, 50, 90, 93, 133),
           ALIGNMENT ("R", "U", "C", "U", "C", "U", "R"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           HSCROLL,
           ID IS 78-ID-gd-prg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 146,
           VPADDING 50,
           VSCROLL,
           EVENT PROCEDURE gd-prg-Event-Proc,
           .

      * PUSH BUTTON
       10
           pb-grid-nuovo-prg, 
           Push-Button, 
           COL 128,84, 
           LINE 45,08,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 5,
           UNFRAMED,
           SQUARE,
           ENABLED E-NUOVO,
           EXCEPTION-VALUE 1012,
           FLAT,
           FONT IS Small-Font,
           ID IS 234,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Aggiunge una riga n&uova alla griglia",
           AFTER PROCEDURE pb-grid-nuovo-prg-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-nuovo-prg-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-grid-elimina-prg, 
           Push-Button, 
           COL 141,84, 
           LINE 45,08,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 4,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1032,
           FLAT,
           FONT IS Small-Font,
           ID IS 235,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "&Elimina la riga selezionata",
           AFTER PROCEDURE pb-grid-elimina-prg-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-elimina-prg-BeforeProcedure, 
           .

      * PAGE
       05
           PAGE-6, 
           VISIBLE Form1-Pg-6-Visible,
           COL 4, 
           LINE 7,
           .

      * FRAME
       10
           Form1-Fr-1, 
           Frame, 
           COL 5,00, 
           LINE 7,31,
           LINES 11,00 ,
           SIZE 149,83 ,
           ID IS 236,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Dati Cliente",
           TITLE-POSITION 1,
           .

      * ENTRY FIELD
       10
           ef-id-edi, 
           Entry-Field, 
           COL 26,00, 
           LINE 9,39,
           LINES 1,31 ,
           SIZE 52,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-id-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-id-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-1-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-69, 
           Label, 
           COL 8,33, 
           LINE 9,39,
           LINES 1,31 ,
           SIZE 11,00 ,
           ID IS 237,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "ID EDI",
           .

      * ENTRY FIELD
       10
           ef-q-id-edi, 
           Entry-Field, 
           COL 79,67, 
           LINE 9,39,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-q-id-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 4,
           VALUE ef-q-id-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-2-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-71, 
           Label, 
           COL 8,33, 
           LINE 11,00,
           LINES 1,31 ,
           SIZE 14,67 ,
           ID IS 239,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Fornitore",
           .

      * ENTRY FIELD
       10
           ef-codforn-edi, 
           Entry-Field, 
           COL 26,00, 
           LINE 11,00,
           LINES 1,31 ,
           SIZE 52,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-codforn-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 17,
           VALUE ef-codforn-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-3-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-72, 
           Label, 
           COL 8,33, 
           LINE 12,62,
           LINES 1,31 ,
           SIZE 14,67 ,
           ID IS 241,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "P.IVA cliente",
           .

      * ENTRY FIELD
       10
           ef-q-codforn-edi, 
           Entry-Field, 
           COL 79,67, 
           LINE 11,08,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-q-codforn-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-q-codforn-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-4-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-73, 
           Label, 
           COL 79,67, 
           LINE 12,62,
           LINES 1,31 ,
           SIZE 14,00 ,
           ID IS 243,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Ragione Sociale",
           .

      * ENTRY FIELD
       10
           ef-piva-c-edi, 
           Entry-Field, 
           COL 26,00, 
           LINE 12,62,
           LINES 1,31 ,
           SIZE 52,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-piva-c-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-piva-c-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-5-BeforeProcedure, 
           .
      * ENTRY FIELD
       10
           ef-ragsoc-c-edi, 
           Entry-Field, 
           COL 94,67, 
           LINE 12,62,
           LINES 1,31 ,
           SIZE 58,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-ragsoc-c-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 70,
           VALUE ef-ragsoc-c-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-6-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-75, 
           Label, 
           COL 8,33, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 14,67 ,
           ID IS 246,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Indirizzo",
           .

      * ENTRY FIELD
       10
           ef-ind-c-edi, 
           Entry-Field, 
           COL 26,00, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 52,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-ind-c-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-ind-c-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-7-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-76, 
           Label, 
           COL 79,67, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 14,00 ,
           ID IS 248,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Città",
           .

      * ENTRY FIELD
       10
           ef-citta-c-edi, 
           Entry-Field, 
           COL 94,67, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 32,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-citta-c-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-citta-c-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-8-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-77, 
           Label, 
           COL 127,33, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 5,00 ,
           ID IS 250,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prov.",
           .

      * ENTRY FIELD
       10
           ef-prov-c-edi, 
           Entry-Field, 
           COL 132,50, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-prov-c-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-prov-c-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-9-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-78, 
           Label, 
           COL 140,33, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 5,00 ,
           ID IS 252,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "CAP",
           .

      * ENTRY FIELD
       10
           ef-cap-c-edi, 
           Entry-Field, 
           COL 145,67, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-cap-c-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           VALUE ef-cap-c-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-10-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-79, 
           Label, 
           COL 8,33, 
           LINE 16,00,
           LINES 1,31 ,
           SIZE 14,67 ,
           ID IS 254,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Cliente",
           .

      * ENTRY FIELD
       10
           ef-codcli-edi, 
           Entry-Field, 
           COL 26,00, 
           LINE 16,00,
           LINES 1,31 ,
           SIZE 52,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-codcli-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 17,
           VALUE ef-codcli-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-11-BeforeProcedure, 
           .
      * ENTRY FIELD
       10
           ef-q-codcli-edi, 
           Entry-Field, 
           COL 79,67, 
           LINE 16,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-q-codcli-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-q-codcli-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-12-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-70, 
           Label, 
           COL 95,00, 
           LINE 9,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           COLOR IS 5,
           ID IS 257,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "01T7 - 01T8",
           .

      * LABEL
       10
           Form1-La-70a, 
           Label, 
           COL 95,00, 
           LINE 11,08,
           LINES 1,31 ,
           SIZE 15,00 ,
           COLOR IS 5,
           ID IS 258,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "01T9 - 01T10",
           .

      * LABEL
       10
           Form1-La-70aa, 
           Label, 
           COL 95,00, 
           LINE 16,00,
           LINES 1,31 ,
           SIZE 13,00 ,
           COLOR IS 5,
           ID IS 259,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "01T34 - 01T35",
           .

      * LABEL
       10
           Form1-La-70aab, 
           Label, 
           COL 111,67, 
           LINE 16,00,
           LINES 1,31 ,
           SIZE 13,00 ,
           COLOR IS 2,
           ID IS 260,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "01T19 - 01T20",
           .

      * LABEL
       10
           Form1-La-70b, 
           Label, 
           COL 111,67, 
           LINE 9,54,
           LINES 1,31 ,
           SIZE 15,00 ,
           COLOR IS 2,
           ID IS 261,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "01T7 - 01T8",
           .

      * LABEL
       10
           Form1-La-70ab, 
           Label, 
           COL 111,67, 
           LINE 11,08,
           LINES 1,31 ,
           SIZE 15,00 ,
           COLOR IS 2,
           ID IS 262,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "01T9 - 01T10",
           .

      * LABEL
       10
           Form1-La-70aaba, 
           Label, 
           COL 128,67, 
           LINE 16,00,
           LINES 1,31 ,
           SIZE 15,00 ,
           COLOR IS 3,
           ID IS 263,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "01T21",
           .

      * LABEL
       10
           Form1-La-70c, 
           Label, 
           COL 95,00, 
           LINE 8,16,
           LINES 1,31 ,
           SIZE 15,00 ,
           COLOR IS 5,
           ID IS 264,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "FATTURE",
           .

      * LABEL
       10
           Form1-La-70ba, 
           Label, 
           COL 111,67, 
           LINE 8,16,
           LINES 1,31 ,
           SIZE 15,00 ,
           COLOR IS 2,
           ID IS 265,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BOLLE",
           .

      * LABEL
       10
           Form1-La-70aabaa, 
           Label, 
           COL 128,67, 
           LINE 8,16,
           LINES 1,31 ,
           SIZE 15,00 ,
           COLOR IS 3,
           ID IS 266,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "ORDINI IMPORT",
           .

      * FRAME
       10
           Form1-Fr-1a, 
           Frame, 
           COL 5,00, 
           LINE 25,69,
           LINES 23,50 ,
           SIZE 149,83 ,
           ID IS 267,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Dati Destino",
           TITLE-POSITION 1,
           .

      * LABEL
       10
           Form1-La-71a, 
           Label, 
           COL 8,33, 
           LINE 43,69,
           LINES 1,31 ,
           SIZE 14,67 ,
           ID IS 268,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Destino",
           .

      * ENTRY FIELD
       10
           ef-dest-edi, 
           Entry-Field, 
           COL 26,00, 
           LINE 43,69,
           LINES 1,31 ,
           SIZE 50,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-dest-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 17,
           VALUE ef-dest-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-3-BeforeProcedure, 
           .
      * ENTRY FIELD
       10
           ef-q-dest-edi, 
           Entry-Field, 
           COL 79,67, 
           LINE 43,69,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-q-dest-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-q-dest-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-4-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-73a, 
           Label, 
           COL 8,33, 
           LINE 45,31,
           LINES 1,31 ,
           SIZE 14,67 ,
           ID IS 271,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Ragione Sociale",
           .

      * ENTRY FIELD
       10
           ef-ragsoc-d-edi, 
           Entry-Field, 
           COL 26,00, 
           LINE 45,31,
           LINES 1,31 ,
           SIZE 50,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-ragsoc-d-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 70,
           VALUE ef-ragsoc-d-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-6-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-75a, 
           Label, 
           COL 79,67, 
           LINE 45,31,
           LINES 1,31 ,
           SIZE 12,00 ,
           ID IS 273,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Indirizzo",
           .

      * ENTRY FIELD
       10
           ef-ind-d-edi, 
           Entry-Field, 
           COL 94,67, 
           LINE 45,31,
           LINES 1,31 ,
           SIZE 50,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-ind-d-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-ind-d-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-7-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-76a, 
           Label, 
           COL 8,33, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 14,67 ,
           ID IS 275,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Città",
           .

      * ENTRY FIELD
       10
           ef-citta-d-edi, 
           Entry-Field, 
           COL 26,00, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 50,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-citta-d-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-citta-d-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-8-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-77a, 
           Label, 
           COL 79,67, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 10,00 ,
           ID IS 277,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Provincia",
           .

      * ENTRY FIELD
       10
           ef-prov-d-edi, 
           Entry-Field, 
           COL 94,67, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-prov-d-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-prov-d-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-9-BeforeProcedure, 
           .
      * LABEL
       10
           Form1-La-78a, 
           Label, 
           COL 103,67, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 5,00 ,
           ID IS 280,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "CAP",
           .

      * ENTRY FIELD
       10
           ef-cap-d-edi, 
           Entry-Field, 
           COL 109,00, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-cap-d-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           VALUE ef-cap-d-edi-BUF,
           BEFORE PROCEDURE Form1-DaEf-10-BeforeProcedure, 
           .
      * GRID
       10
           form1-gd-1-edi, 
           Grid, 
           COL 7,67, 
           LINE 27,31,
           LINES 15,31 ,
           SIZE 144,50 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           DATA-COLUMNS (1, 6, 46, 86, 91, 126),
           ALIGNMENT ("R", "U", "U", "U", "U", "U"),
           SEPARATION (5, 5, 5, 5, 5, 5),
           DATA-TYPES ("9(5)", "X", "X", "X", "X", "X"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-COLOR 481
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           HSCROLL,
           ID IS 282,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           USE-TAB,
           VIRTUAL-WIDTH 141,
           VPADDING 50,
           VSCROLL,
           EVENT PROCEDURE Form1-Gd-1-Event-Proc,
           .

      * PUSH BUTTON
       10
           pb-grid-salva-edi, 
           Push-Button, 
           COL 138,83, 
           LINE 42,92,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 6,
           UNFRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 1013,
           FLAT,
           FONT IS Small-Font,
           ID IS 283,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "&Salva la riga appena inserita o quella modificata",
           AFTER PROCEDURE pb-grid-salva-edi-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-salva-edi-BeforeProcedure, 
           .

      * LABEL
       10
           Form1-La-70aaa, 
           Label, 
           COL 95,00, 
           LINE 43,69,
           LINES 1,31 ,
           SIZE 13,00 ,
           COLOR IS 5,
           ID IS 284,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "02D7 - 02D8",
           .

      * LABEL
       10
           Form1-La-70aaaa, 
           Label, 
           COL 111,67, 
           LINE 43,69,
           LINES 1,31 ,
           SIZE 13,00 ,
           COLOR IS 2,
           ID IS 285,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "01T29 - 01T30",
           .

      * LABEL
       10
           Form1-La-70aaaaa, 
           Label, 
           COL 128,67, 
           LINE 43,69,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 3,
           ID IS 286,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "01T28",
           .

      * FRAME
       10
           Form1-Fr-2, 
           Frame, 
           COL 5,00, 
           LINE 18,62,
           LINES 6,69 ,
           SIZE 149,83 ,
           ID IS 287,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Personalizzazione",
           .

      * CHECK BOX
       10
           chk-imp-i, 
           Check-Box, 
           COL 39,33, 
           LINE 20,00,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-imp-i,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-imp-i-BUF,
           BEFORE PROCEDURE Form1-DaCb-1-BeforeProcedure, 
            .
      * CHECK BOX
       10
           chk-imp-a, 
           Check-Box, 
           COL 39,33, 
           LINE 21,47,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-imp-a,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-imp-a-BUF,
            .
      * CHECK BOX
       10
           chk-exp-i, 
           Check-Box, 
           COL 111,00, 
           LINE 20,00,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-exp-i,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-exp-i-BUF,
           BEFORE PROCEDURE Form1-DaCb-1-BeforeProcedure, 
            .
      * LABEL
       10
           Form1-La-74, 
           Label, 
           COL 6,67, 
           LINE 20,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           ID IS 297,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "IMPORT",
           .

      * LABEL
       10
           Form1-La-74a, 
           Label, 
           COL 81,50, 
           LINE 20,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           ID IS 298,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "EXPORT",
           .

      * BAR
       10
           Form1-Br-6, 
           Bar,
           COL 79,67, 
           LINE 19,16,
           LINES 6,08 ,
           ID IS 299,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Form1-La-80, 
           Label, 
           COL 17,83, 
           LINE 20,00,
           LINES 1,31 ,
           SIZE 18,00 ,
           ID IS 300,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Importi complessivi",
           .

      * LABEL
       10
           Form1-La-80a, 
           Label, 
           COL 17,83, 
           LINE 21,47,
           LINES 1,31 ,
           SIZE 18,00 ,
           ID IS 301,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Articoli in pezzi",
           .

      * LABEL
       10
           Form1-La-80b, 
           Label, 
           COL 91,67, 
           LINE 20,00,
           LINES 1,31 ,
           SIZE 18,00 ,
           ID IS 302,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Esposizione imposte",
           .

      * PAGE
       05
           Form1-Pg-7, 
           VISIBLE Form1-Pg-7-Visible,
           COL 4, 
           LINE 7,
           .

      * ENTRY FIELD
       10
           ef-note-cli, 
           Entry-Field, 
           COL 5,67, 
           LINE 8,15,
           LINES 48,46 ,
           SIZE 148,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Verdana12-Occidentale,
           ID IS 78-ID-ef-note-cli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3000,
           VSCROLL-BAR,
           USE-RETURN,
           USE-TAB,
           VALUE ef-note-cli-BUF,
           BEFORE PROCEDURE Form1-DaEf-1-BeforeProcedure, 
           .

      * BAR
       05
           Form1-Br-2, 
           Bar,
           COL 1,00, 
           LINE 3,69,
           SIZE 158,00 ,
           ID IS 303,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       05
           CST-BLOCKPGM, 
           Label, 
           COL 117,67, 
           LINE 1,38,
           LINES 1,00 ,
           SIZE 13,86 ,
           ID IS 666,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Form1-La-5, 
           Label, 
           COL 3,67, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 9,67 ,
           ID IS 5003,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Codice",
           .

      * LABEL
       05
           Form1-Custom1-1, 
           Label, 
           COL 117,33, 
           LINE 3,00,
           LINES 0,62 ,
           SIZE 12,33 ,
           FONT IS Default-Font,
           ID IS 999,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * DB_LABEL
       05
           lab-data, 
           Label, 
           COL 146,83, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 10,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 1000,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-data-BUF,
           CENTER,
           TRANSPARENT,
           .

      * LABEL
       05
           Form1-La-20, 
           Label, 
           COL 133,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 13,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 1001,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data creazione",
           .

      * DB_LABEL
       05
           lab-des, 
           Label, 
           COL 25,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 85,50 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 1002,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-des-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * PUSH BUTTON
       05
           pb-ricerca, 
           Push-Button, 
           COL 132,17, 
           LINE 3,77,
           LINES 29,00 ,
           SIZE 66,00 ,
           BITMAP-HANDLE RICERCA-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1014,
           FLAT,
           ID IS 761,
           SELF-ACT,
           TITLE "&Dettagli",
           AFTER PROCEDURE pb-ricerca-AfterProcedure, 
           BEFORE PROCEDURE pb-ricerca-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-stampa, 
           Push-Button, 
           COL 144,33, 
           LINE 3,77,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-STAMPA-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1010,
           FLAT,
           ID IS 760,
           SELF-ACT,
           TITLE "&Dettagli",
           AFTER PROCEDURE pb-stampa-AfterProcedure, 
           BEFORE PROCEDURE pb-stampa-BeforeProcedure, 
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 762,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 6,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 2,
           FRAMED,
           SQUARE,
           ENABLED E-NUOVO,
           EXCEPTION-VALUE 2,
           FLAT,
           ID IS 763,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 16,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-CANCELLA,
           EXCEPTION-VALUE 4,
           FLAT,
           ID IS 764,
           SELF-ACT,
           TITLE "Cancella (F4)",
           BITMAP-NUMBER BitmapNumDelete
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 11,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 765,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 26,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 6,
           FRAMED,
           SQUARE,
           ENABLED E-ANTEPRIMA,
           EXCEPTION-VALUE 6,
           FLAT,
           ID IS 766,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 21,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 5,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 767,
           SELF-ACT,
           TITLE "Modifica (F5)",
           VALUE MOD,
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 31,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 7,
           FRAMED,
           SQUARE,
           ENABLED E-STAMPA,
           EXCEPTION-VALUE 7,
           FLAT,
           ID IS 768,
           SELF-ACT,
           TITLE "Stampa (F7)",
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 36,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 769,
           SELF-ACT,
           TITLE "Cerca (F8)",
           BITMAP-NUMBER BitmapNumZoom
           .

      * PUSH BUTTON
       05
           TOOL-SELEZIONA, 
           Push-Button, 
           COL 41,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 9,
           FRAMED,
           SQUARE,
           ENABLED E-SELEZIONA,
           EXCEPTION-VALUE 9,
           FLAT,
           ID IS 770,
           SELF-ACT,
           TITLE "Seleziona (F9)",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1a, 
           Push-Button, 
           COL 46,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 10,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1002,
           FLAT,
           ID IS 771,
           SELF-ACT,
           TITLE "&Primo",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1b, 
           Push-Button, 
           COL 51,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 11,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 67,
           FLAT,
           ID IS 772,
           SELF-ACT,
           TITLE "Precedente (PgDn)",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1c, 
           Push-Button, 
           COL 56,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 12,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 68,
           FLAT,
           ID IS 773,
           SELF-ACT,
           TITLE "Successivo (PgUp)",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1d, 
           Push-Button, 
           COL 61,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 13,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1006,
           FLAT,
           ID IS 774,
           SELF-ACT,
           TITLE "&Ultimo",
           .

      * CHECK BOX
       05
           TOOL-ORD, 
           Check-Box, 
           COL 66,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 14,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 10
           FLAT,
           ID IS 775,
           SELF-ACT,
           TITLE "Ordinamento Alfabetico (F10)",
           VALUE OrderBy,
           AFTER PROCEDURE TOOL-ORD-AfterProcedure,
           BEFORE PROCEDURE TOOL-ORD-BeforeProcedure, 
           .
      * FORM
       01 
           scr-stampa, 
           BEFORE PROCEDURE scr-stampa-BeforeProcedure,
           AFTER PROCEDURE  scr-stampa-AFTER-SCREEN
           .

      * ENTRY FIELD
       05
           ef-cod-da, 
           Entry-Field, 
           COL 2,50, 
           LINE 2,00,
           LINES 1,33 ,
           SIZE 6,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ID IS 78-ID-ef-cod-da,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-cod-da-buf,
           AFTER PROCEDURE ef-cod-da-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-cod-a, 
           Entry-Field, 
           COL 25,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ID IS 78-ID-ef-cod-a,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-cod-a-buf,
           AFTER PROCEDURE ef-cod-a-AfterProcedure, 
           .

      * CHECK BOX
       05
           chk-excel, 
           Check-Box, 
           COL 31,50, 
           LINE 1,67,
           LINES 28,00 ,
           SIZE 28,00 ,
           BITMAP-HANDLE EXCEL-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           FLAT,
           ID IS 2,
           TITLE "Generazione di file E&xcel",
           VALUE stampa-tipo,
           AFTER PROCEDURE scr-stampa-Cb-1-AfterProcedure,
           BEFORE PROCEDURE scr-stampa-Cb-1-BeforeProcedure, 
           .
      * CHECK BOX
       05
           chk-st-cli, 
           Check-Box, 
           COL 2,10, 
           LINE 4,00,
           LINES 20,00 ,
           SIZE 20,00 ,
           BITMAP-HANDLE SPUNTA2-BMP,
           BITMAP-NUMBER 2,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 20,
           VALUE e-st-cli,
           AFTER PROCEDURE chk-st-cli-AfterProcedure,
           BEFORE PROCEDURE chk-st-cli-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-st-tipo, 
           Entry-Field, 
           COL 11,00, 
           LINE 6,00,
           LINES 1,33 ,
           SIZE 4,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-st-cli,
           ID IS 78-ID-ef-st-tipo,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-st-tipo-buf,
           AFTER PROCEDURE ef-st-tipo-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-st-gdo, 
           Entry-Field, 
           COL 11,00, 
           LINE 8,50,
           LINES 1,33 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED e-st-cli,
           ID IS 78-ID-ef-st-gdo,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-st-gdo-buf,
           AFTER PROCEDURE ef-st-gdo-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-st-age, 
           Entry-Field, 
           COL 11,00, 
           LINE 11,00,
           LINES 1,33 ,
           SIZE 6,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED e-st-cli,
           ID IS 78-ID-ef-st-age,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-st-age-buf,
           AFTER PROCEDURE ef-st-age-AfterProcedure, 
           .

      * CHECK BOX
       05
           chk-st-des, 
           Check-Box, 
           COL 2,10, 
           LINE 13,67,
           LINES 20,00 ,
           SIZE 20,00 ,
           BITMAP-HANDLE SPUNTA2-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1002
           FLAT,
           ID IS 8,
           VALUE e-st-des,
           AFTER PROCEDURE chk-st-des-AfterProcedure,
           BEFORE PROCEDURE chk-st-des-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-des-da, 
           Entry-Field, 
           COL 2,50, 
           LINE 15,56,
           LINES 1,33 ,
           SIZE 6,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED e-st-des,
           ID IS 78-ID-ef-des-da,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-des-da-buf,
           AFTER PROCEDURE ef-des-da-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-des-a, 
           Entry-Field, 
           COL 25,00, 
           LINE 15,56,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED e-st-des,
           ID IS 78-ID-ef-des-a,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-des-a-buf,
           AFTER PROCEDURE ef-des-a-AfterProcedure, 
           .

      * CHECK BOX
       05
           chk-excel-2, 
           Check-Box, 
           COL 31,50, 
           LINE 15,22,
           LINES 28,00 ,
           SIZE 28,00 ,
           BITMAP-HANDLE EXCEL-BMP,
           BITMAP-NUMBER 3,
           UNFRAMED,
           SQUARE,
           ENABLED e-st-des,
           FLAT,
           ID IS 568,
           TITLE "Generazione di file E&xcel",
           VALUE stampa-tipo-des,
           AFTER PROCEDURE chk-excel-2-AfterProcedure,
           BEFORE PROCEDURE chk-excel-2-BeforeProcedure, 
           .
      * CHECK BOX
       05
           chk-st-note, 
           Check-Box, 
           COL 2,10, 
           LINE 18,39,
           LINES 20,00 ,
           SIZE 20,00 ,
           BITMAP-HANDLE SPUNTA2-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1003
           FLAT,
           ID IS 22,
           VALUE e-st-note,
           AFTER PROCEDURE chk-st-note-AfterProcedure,
           BEFORE PROCEDURE chk-st-note-BeforeProcedure, 
           .
      * CHECK BOX
       05
           chk-excel-3, 
           Check-Box, 
           COL 31,50, 
           LINE 18,22,
           LINES 28,00 ,
           SIZE 28,00 ,
           BITMAP-HANDLE EXCEL-BMP,
           BITMAP-NUMBER 3,
           UNFRAMED,
           SQUARE,
           ENABLED e-st-note,
           FLAT,
           ID IS 23,
           TITLE "Generazione di file E&xcel",
           VALUE stampa-tipo-note,
           AFTER PROCEDURE chk-excel-3-AfterProcedure,
           BEFORE PROCEDURE chk-excel-3-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           pb-sib, 
           Push-Button, 
           COL 19,50, 
           LINE 20,67,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-OK-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1000,
           FLAT,
           FONT IS Small-Font,
           ID IS 100,
           AFTER PROCEDURE pb-sib-AfterProcedure, 
           BEFORE PROCEDURE pb-sib-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-noa, 
           Push-Button, 
           COL 27,40, 
           LINE 20,67,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-CANCEL-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 27,
           FLAT,
           FONT IS Small-Font,
           ID IS 200,
           ESCAPE-BUTTON,
           AFTER PROCEDURE pb-noa-AfterProcedure, 
           BEFORE PROCEDURE pb-noa-BeforeProcedure, 
           .

      * BAR
       05
           Screen4-Br-1aaa, 
           Bar,
           COL 1,00, 
           LINE 20,56,
           SIZE 34,50 ,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       05
           scr-elab-La-1, 
           Label, 
           COL 13,00, 
           LINE 2,00,
           LINES 1,33 ,
           SIZE 7,00 ,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Codice",
           .

      * LABEL
       05
           scr-stampa-blockpgm-1, 
           Label, 
           COL 3,20, 
           LINE 21,61,
           LINES 0,50 ,
           SIZE 1,00 ,
           ID IS 5,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * LABEL
       05
           scr-stampa-Custom1-2, 
           Label, 
           COL 7,60, 
           LINE 21,44,
           LINES 0,50 ,
           SIZE 2,30 ,
           FONT IS Default-Font,
           ID IS 9,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * BITMAP
       05
           Bitmap-freccia-daa, 
           Bitmap, 
           COL 9,00, 
           LINE 2,00,
           LINES 24,00 ,
           SIZE 28,00 ,
           TRANSPARENT-COLOR tr-color,
           BITMAP-HANDLE BLUE-DA-28X24-BMP,
           BITMAP-NUMBER 1,
           ID IS 10,
           Transparent-color TR-COLOR
           .

      * BITMAP
       05
           Bitmap-freccia-finoa, 
           Bitmap, 
           COL 21,50, 
           LINE 2,00,
           LINES 24,00 ,
           SIZE 28,00 ,
           TRANSPARENT-COLOR tr-color,
           BITMAP-HANDLE BLUE-FINO-28X24-BMP,
           BITMAP-NUMBER 1,
           ID IS 13,
           Transparent-color TR-COLOR
           .

      * LABEL
       05
           lab1, 
           Label, 
           COL 2,00, 
           LINE 6,00,
           LINES 1,22 ,
           SIZE 8,00 ,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tipologia",
           .

      * LABEL
       05
           lab3, 
           Label, 
           COL 2,00, 
           LINE 11,00,
           LINES 1,22 ,
           SIZE 8,00 ,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Agente",
           .

      * LABEL
       05
           lab2, 
           Label, 
           COL 2,00, 
           LINE 8,50,
           LINES 1,22 ,
           SIZE 8,00 ,
           ID IS 16,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. GDO",
           .

      * LABEL
       05
           lab-st-tipo, 
           Label, 
           COL 16,00, 
           LINE 6,00,
           LINES 2,00 ,
           SIZE 19,00 ,
           COLOR IS 5,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-st-tipo-buf,
           .

      * LABEL
       05
           lab-st-gdo, 
           Label, 
           COL 20,00, 
           LINE 8,50,
           LINES 2,00 ,
           SIZE 15,00 ,
           COLOR IS 5,
           ID IS 18,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-st-gdo-buf,
           .

      * LABEL
       05
           lab-st-age, 
           Label, 
           COL 18,00, 
           LINE 11,00,
           LINES 2,00 ,
           SIZE 17,00 ,
           COLOR IS 5,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-st-age-buf,
           .

      * LABEL
       05
           Form1-La-1abbbaab, 
           Label, 
           COL 8,20, 
           LINE 3,94,
           LINES 1,11 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 561,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Filtri di stampa Cliente",
           .

      * BAR
       05
           Screen4-Br-1aaaaa, 
           Bar,
           COL 28,50, 
           LINE 4,67,
           SIZE 7,00 ,
           ID IS 563,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       05
           Form1-La-1abbbaaba, 
           Label, 
           COL 8,20, 
           LINE 13,56,
           LINES 1,11 ,
           SIZE 20,00 ,
           COLOR IS 80,
           ID IS 564,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Filtri di stampa Destini",
           .

      * BAR
       05
           Screen4-Br-1aaaab, 
           Bar,
           COL 4,70, 
           LINE 14,28,
           SIZE 2,80 ,
           ID IS 562,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * BAR
       05
           Screen4-Br-1aaaaaa, 
           Bar,
           COL 28,50, 
           LINE 14,28,
           SIZE 7,00 ,
           ID IS 565,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       05
           lab4, 
           Label, 
           COL 13,00, 
           LINE 15,56,
           LINES 1,33 ,
           SIZE 7,00 ,
           ENABLED 1,
           ID IS 569,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Codice",
           .

      * BITMAP
       05
           Bitmap-freccia-daaa, 
           Bitmap, 
           COL 9,00, 
           LINE 15,56,
           LINES 24,00 ,
           SIZE 28,00 ,
           TRANSPARENT-COLOR tr-color,
           BITMAP-HANDLE BLUE-DA-28X24-BMP,
           BITMAP-NUMBER 1,
           ID IS 570,
           Transparent-color TR-COLOR
           .

      * BITMAP
       05
           Bitmap-freccia-finoaa, 
           Bitmap, 
           COL 21,50, 
           LINE 15,56,
           LINES 24,00 ,
           SIZE 28,00 ,
           TRANSPARENT-COLOR tr-color,
           BITMAP-HANDLE BLUE-FINO-28X24-BMP,
           BITMAP-NUMBER 1,
           ID IS 571,
           Transparent-color TR-COLOR
           .

      * BAR
       05
           Screen4-Br-1aaaaba, 
           Bar,
           COL 4,70, 
           LINE 4,67,
           SIZE 2,80 ,
           ID IS 11,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       05
           lab5, 
           Label, 
           COL 5,20, 
           LINE 18,44,
           LINES 1,11 ,
           SIZE 26,20 ,
           ENABLED 1,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Stampa Schede Note Consegna",
           .

      * TOOLBAR
       01
           Form1-Tb-1a,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCIa, 
           Push-Button, 
           COL 1,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 24,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "&Esci",
           .

      * PUSH BUTTON
       05
           tool-st-cerca, 
           Push-Button, 
           COL 6,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 8,
           UNFRAMED,
           SQUARE,
           ENABLED E-ST-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 25,
           SELF-ACT,
           TITLE "Cerca (F8)",
           .

      * FORM
       01 
           scr-fido, 
           AFTER PROCEDURE  scr-fido-AFTER-SCREEN
           BEFORE PROCEDURE  scr-fido-BEFORE-SCREEN
           .

      * FRAME
       05
           scr-fido-Fr-1, 
           Frame, 
           COL 1,91, 
           LINE 1,56,
           LINES 20,28 ,
           SIZE 31,27 ,
           COLOR IS 2,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           HEAVY,
           .

      * LABEL
       05
           scr-fido-La-1, 
           Label, 
           COL 3,41, 
           LINE 2,67,
           LINES 1,28 ,
           SIZE 12,00 ,
           COLOR IS 5,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldo Scheda",
           .

      * LABEL
       05
           scr-fido-La-1a, 
           Label, 
           COL 3,41, 
           LINE 6,50,
           LINES 1,28 ,
           SIZE 12,00 ,
           COLOR IS 5,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "RB a scadere",
           .

      * LABEL
       05
           lab-fuori, 
           Label, 
           COL 3,46, 
           LINE 17,56,
           LINES 1,28 ,
           SIZE 15,00 ,
           COLOR IS colore-fido,
           ID IS 4,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-fuori-buf,
           .

      * LABEL
       05
           lab-scheda, 
           Label, 
           COL 17,91, 
           LINE 2,67,
           LINES 1,28 ,
           SIZE 14,00 ,
           COLOR IS 5,
           ID IS 5,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-scheda-buf,
           .

      * PUSH BUTTON
       05
           scr-fido-Pb-1, 
           Push-Button, 
           COL 13,82, 
           LINE 19,28,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-OK-BMP,
           BITMAP-NUMBER 2,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 27,
           FLAT,
           FONT IS Small-Font,
           ID IS 6,
           ESCAPE-BUTTON,
           TITLE "Conferma",
           .

      * LABEL
       05
           lab-rischio, 
           Label, 
           COL 17,91, 
           LINE 6,50,
           LINES 1,28 ,
           SIZE 14,00 ,
           COLOR IS 5,
           ID IS 7,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-rischio-buf,
           .

      * BAR
       05
           scr-fido-Br-1, 
           Bar,
           COL 17,91, 
           LINE 10,34,
           SIZE 14,00 ,
           COLOR IS 5,
           ID IS 8,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * BAR
       05
           scr-fido-Br-1a, 
           Bar,
           COL 17,91, 
           LINE 10,56,
           SIZE 14,00 ,
           COLOR IS 5,
           ID IS 9,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       05
           lab-tot, 
           Label, 
           COL 17,91, 
           LINE 17,56,
           LINES 1,28 ,
           SIZE 14,00 ,
           COLOR IS colore-fido,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-tot-buf,
           .

      * LABEL
       05
           scr-fido-La-1aa, 
           Label, 
           COL 3,46, 
           LINE 11,17,
           LINES 1,28 ,
           SIZE 12,00 ,
           COLOR IS 5,
           ID IS 11,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "ESPOSIZIONE",
           .

      * LABEL
       05
           lab-totale, 
           Label, 
           COL 17,91, 
           LINE 11,17,
           LINES 1,28 ,
           SIZE 14,00 ,
           COLOR IS 5,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-totale-buf,
           .

      * BAR
       05
           scr-fido-Br-2, 
           Bar,
           COL 2,73, 
           LINE 13,00,
           SIZE 29,55 ,
           COLOR IS 2,
           ID IS 13,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 2,
           .

      * LABEL
       05
           scr-fido-La-1ab, 
           Label, 
           COL 3,46, 
           LINE 8,45,
           LINES 1,28 ,
           SIZE 13,00 ,
           COLOR IS 5,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Ordini in essere",
           .

      * LABEL
       05
           lab-ordini, 
           Label, 
           COL 17,91, 
           LINE 8,45,
           LINES 1,28 ,
           SIZE 14,00 ,
           COLOR IS 5,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-ordini-buf,
           .

      * BAR
       05
           scr-fido-Br-2a, 
           Bar,
           COL 2,73, 
           LINE 16,34,
           SIZE 29,55 ,
           COLOR IS 2,
           ID IS 16,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 2,
           .

      * LABEL
       05
           scr-fido-La-1b, 
           Label, 
           COL 3,46, 
           LINE 14,06,
           LINES 1,28 ,
           SIZE 12,00 ,
           COLOR IS 3,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Fido",
           .

      * LABEL
       05
           lab-fido, 
           Label, 
           COL 17,91, 
           LINE 14,06,
           LINES 1,28 ,
           SIZE 14,00 ,
           COLOR IS 3,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-fido-buf,
           .

      * LABEL
       05
           scr-fido-La-1ac, 
           Label, 
           COL 3,46, 
           LINE 3,78,
           LINES 1,28 ,
           SIZE 12,00 ,
           COLOR IS 5,
           FONT IS Verdana12-Occidentale,
           ID IS 20,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "di cui scaduti",
           .

      * LABEL
       05
           lab-scaduti, 
           Label, 
           COL 17,91, 
           LINE 3,78,
           LINES 1,28 ,
           SIZE 14,00 ,
           COLOR IS 5,
           FONT IS Verdana12-Occidentale,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-scaduti-buf,
           .

      * LABEL
       05
           lab-scadenza, 
           Label, 
           COL 17,91, 
           LINE 4,89,
           LINES 1,28 ,
           SIZE 14,00 ,
           COLOR IS 5,
           FONT IS Verdana12-Occidentale,
           ID IS 22,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-scadenza-buf,
           .

      * LABEL
       05
           scr-fido-La-1aca, 
           Label, 
           COL 3,46, 
           LINE 4,84,
           LINES 1,28 ,
           SIZE 12,00 ,
           COLOR IS 5,
           FONT IS Verdana12-Occidentale,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "e a scadenza",
           .

      * FORM
       01 
           scr-note-bolla, 
           AFTER PROCEDURE  scr-note-bolla-AFTER-SCREEN
           BEFORE PROCEDURE  scr-note-bolla-BEFORE-SCREEN
           .

      * ENTRY FIELD
       05
           ef-note-bolla-1, 
           Entry-Field, 
           COL 3,33, 
           LINE 1,77,
           LINES 5,00 ,
           SIZE 134,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 130,
           VSCROLL-BAR,
           VALUE hidden-note-bolla-1,
           AFTER PROCEDURE scr-note-b-Ef-1-AfterProcedure, 
           BEFORE PROCEDURE scr-note-b-Ef-1-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-note-bolla-2, 
           Entry-Field, 
           COL 3,33, 
           LINE 8,23,
           LINES 5,00 ,
           SIZE 134,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-destini,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 130,
           VSCROLL-BAR,
           VALUE hidden-note-bolla-2,
           AFTER PROCEDURE scr-note-b-Ef-1-AfterProcedure, 
           BEFORE PROCEDURE scr-note-b-Ef-1-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           scr-note-b-Pb-1, 
           Push-Button, 
           COL 62,00, 
           LINE 14,62,
           LINES 2,15 ,
           SIZE 17,17 ,
           EXCEPTION-VALUE 27,
           FONT IS Small-Font,
           ID IS 100,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ESCAPE-BUTTON,
           TITLE "Fatto",
           .

      * FORM
       01 
           scr-ricerca, 
           BEFORE PROCEDURE scr-ricerca-BeforeProcedure,
           AFTER PROCEDURE  scr-ricerca-AFTER-SCREEN
           .

      * ENTRY FIELD
       05
           ef-ricerca-piva, 
           Entry-Field, 
           COL 13,00, 
           LINE 2,11,
           LINES 1,33 ,
           SIZE 15,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-ef-st-tipo,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 11,
           VALUE ef-ricerca-piva-buf,
           AFTER PROCEDURE ef-ricerca-piva-AfterProcedure, 
           .

      * PUSH BUTTON
       05
           pb-ricerca-ok, 
           Push-Button, 
           COL 19,50, 
           LINE 4,56,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-OK-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1000,
           FLAT,
           FONT IS Small-Font,
           ID IS 100,
           AFTER PROCEDURE pb-ricerca-ok-AfterProcedure, 
           BEFORE PROCEDURE pb-ricerca-ok-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-ricerca-cancel, 
           Push-Button, 
           COL 27,40, 
           LINE 4,56,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-CANCEL-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 27,
           FLAT,
           FONT IS Small-Font,
           ID IS 200,
           ESCAPE-BUTTON,
           AFTER PROCEDURE pb-ricerca-cancel-AfterProcedure, 
           BEFORE PROCEDURE pb-ricerca-cancel-BeforeProcedure, 
           .

      * BAR
       05
           Screen4-Br-1aaaa, 
           Bar,
           COL 1,00, 
           LINE 4,44,
           SIZE 34,50 ,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       05
           lab1a, 
           Label, 
           COL 2,00, 
           LINE 2,11,
           LINES 1,22 ,
           SIZE 10,00 ,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Partita IVA",
           .

      * LABEL
       05
           Screen1-Custom1-1, 
           Label, 
           COL 2,70, 
           LINE 5,17,
           LINES 0,44 ,
           SIZE 5,70 ,
           FONT IS Default-Font,
           ID IS 1,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, USER-CODI, LIVELLO-ABIL.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:gclienti, INIT:gclienti, BeforeDeclarative>
       CLIENTI-ERR SECTION.
           use after error procedure on clienti.
           set RecLocked to false.
           evaluate status-clienti
           when "35"
                display message "File [CLIENTI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [CLIENTI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[CLIENTI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "99" 
           when "93" 
                set RecLocked to true
                set errori    to true
                move 1 to mod-k
                move 0 to mod
                modify tool-modifica, value = mod
                perform DISPLAY-SCREEN
                set StatusVisua to true
                perform STATUS-BAR-MSG
                move "00" to status-clienti
                if ReadSecca
                   set cli-tipo-c to true
                   read clienti no lock 
                        invalid      continue
                        not invalid  perform FORM1-IUD-DISPLAY
                   end-read
                end-if
                display message box MSG-Record-gia-in-uso
                        title = tit-err
                        icon is mb-error-icon
           when "23"
                move 1 to mod-k
                move 0 to mod
                modify tool-modifica, value = mod
                set StatusVisua to true
                perform STATUS-BAR-MSG 
                if nuovo              
                   initialize cli-dati replacing numeric data by zeroes
                                            alphanumeric data by spaces
                   perform FORM1-FLD-TO-BUF
                   display form1-tb-1
                   set vecchio to true
                end-if 
                perform ABILITAZIONI
                perform DISPLAY-SCREEN
                |risetto il valore a "23" perche dentro al par. CLEAR-SCREEN
                |con l'operazione unlock viene risettato a zero cosicchè 
                |quando torna dentro ai par. di scorrimento di Totem si 
                |trova in una situazione corretta e prosegue con la read
                |uscendo con un messaggio di errore di tipo "46"
                move "23" to status-clienti
           end-evaluate.
 
      ***---
       TVETTORI-ERR SECTION.
           use after error procedure on tvettori.
           set tutto-ok  to true.
           evaluate status-tvettori
           when "35"
                display message "File [TVETTORI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TVETTORI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TVETTORI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TNAZIONI-ERR SECTION.
           use after error procedure on tnazioni.
           set tutto-ok  to true.
           evaluate status-tnazioni
           when "35"
                display message "File [TNAZIONI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TNAZIONI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TNAZIONI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       DESTINI-ERR SECTION.
           use after error procedure on destini.
           set tutto-ok  to true.
           evaluate status-destini
           when "35"
                display message "File [DESTINI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [DESTINI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[DESTINI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       RECAPITI-ERR SECTION.
           use after error procedure on recapiti.
           set tutto-ok  to true.
           evaluate status-recapiti
           when "35"
                display message "File [RECAPITI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [RECAPITI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[RECAPITI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TTIPOCLI-ERR SECTION.
           use after error procedure on ttipocli.
           set tutto-ok  to true.
           evaluate status-ttipocli
           when "35"
                display message "File [TTIPOCLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TTIPOCLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TTIPOCLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TGRUPGDO-ERR SECTION.
           use after error procedure on tgrupgdo.
           set tutto-ok  to true.
           evaluate status-tgrupgdo
           when "35"
                display message "File [TGRUPGDO] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TGRUPGDO] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TGRUPGDO] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TREGIONI-ERR SECTION.
           use after error procedure on tregioni.
           set tutto-ok  to true.
           evaluate status-tregioni
           when "35"
                display message "File [TREGIONI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TREGIONI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TREGIONI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TPROV-ERR SECTION.
           use after error procedure on tprov.
           set tutto-ok  to true.
           evaluate status-tprov
           when "35"
                display message "File [TPROV] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TPROV] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TPROV] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       AGENTI-ERR SECTION.
           use after error procedure on agenti.
           set tutto-ok  to true.
           evaluate status-agenti
           when "35"
                display message "File [AGENTI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [AGENTI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[AGENTI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TCODPAG-ERR SECTION.
           use after error procedure on tcodpag.
           set tutto-ok  to true.
           evaluate status-tcodpag
           when "35"
                display message "File [TCODPAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCODPAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCODPAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIVAESE-ERR SECTION.
           use after error procedure on tivaese.
           set tutto-ok  to true.
           evaluate status-tivaese
           when "35"
                display message "File [TIVAESE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIVAESE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIVAESE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       NOTE-ERR SECTION.
           use after error procedure on note.
           set tutto-ok  to true.
           evaluate status-note
           when "35"
                display message "File [NOTE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [NOTE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[NOTE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       ABI-ERR SECTION.
           use after error procedure on abi.
           set tutto-ok  to true.
           evaluate status-abi
           when "35"
                display message "File [ABI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [ABI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[ABI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       LOCKFILE-ERR SECTION.
           use after error procedure on lockfile.
           set tutto-ok  to true.
           evaluate status-lockfile
           when "35"
                display message "File [LOCKFILE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [LOCKFILE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[LOCKFILE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM anagr01-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:gclienti, INIT:gclienti, BeforeDestroyResource>
      * <TOTEM:END>
           DESTROY Verdana12-Occidentale
           DESTROY Verdana12B-Occidentale
           CALL "w$bitmap" USING WBITMAP-DESTROY, ESPOSIZIONE_91X21-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, SITFIN_91X21-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, NOTE_109X23-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, 
           STRIP_GRID_GCLIENTI-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, COPIA-CLIDES-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, RICERCA-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-STAMPA-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, toolbar-bmp
           CALL "w$bitmap" USING WBITMAP-DESTROY, TOOLBAR-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, EXCEL-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, SPUNTA2-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-OK-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-CANCEL-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BLUE-DA-28X24-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BLUE-FINO-28X24-BMP
      *    After-Program
           PERFORM anagr01-Ev-After-Program
           set environment "KEYSTROKE" to "DATA=46   46".
           set environment "KEYSTROKE" to "DATA=44   44".
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
      * Verdana12-Occidentale
           INITIALIZE WFONT-DATA Verdana12-Occidentale
           MOVE 12 TO WFONT-SIZE
           MOVE "Verdana" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO FALSE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Verdana12-Occidentale, WFONT-DATA
      * Verdana12B-Occidentale
           INITIALIZE WFONT-DATA Verdana12B-Occidentale
           MOVE 12 TO WFONT-SIZE
           MOVE "Verdana" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO TRUE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Verdana12B-Occidentale, WFONT-DATA
           .

       INIT-BMP.
      * pb-espo
           COPY RESOURCE "ESPOSIZIONE_91X21.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "ESPOSIZIONE_91X21.BMP", 
                   GIVING ESPOSIZIONE_91X21-BMP.
      * pb-finanz
           COPY RESOURCE "SITFIN_91X21.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "SITFIN_91X21.BMP", 
                   GIVING SITFIN_91X21-BMP.
      * pb-nota-pie
           COPY RESOURCE "NOTE_109X23.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "NOTE_109X23.BMP", 
                   GIVING NOTE_109X23-BMP.
      * pb-grid-salva
           COPY RESOURCE "STRIP_GRID_GCLIENTI.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "STRIP_GRID_GCLIENTI.BMP"
           , 
                   GIVING STRIP_GRID_GCLIENTI-BMP.
      * pb-copia
           COPY RESOURCE "COPIA-CLIDES.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "COPIA-CLIDES.BMP", 
                   GIVING COPIA-CLIDES-BMP.
      * pb-ricerca
           COPY RESOURCE "RICERCA.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "RICERCA.BMP", 
                   GIVING RICERCA-BMP.
      * pb-stampa
           COPY RESOURCE "BOTTONE-STAMPA.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-STAMPA.BMP", 
                   GIVING BOTTONE-STAMPA-BMP.
      * TOOL-ESCI
           COPY RESOURCE "toolbar.bmp".
           CALL "w$bitmap" USING WBITMAP-LOAD "toolbar.bmp", 
                   GIVING toolbar-bmp.
      * TOOL-NUOVO
           COPY RESOURCE "TOOLBAR.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "TOOLBAR.BMP", 
                   GIVING TOOLBAR-BMP.
      * chk-excel
           COPY RESOURCE "EXCEL.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "EXCEL.BMP", 
                   GIVING EXCEL-BMP.
      * chk-st-cli
           COPY RESOURCE "SPUNTA2.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "SPUNTA2.BMP", 
                   GIVING SPUNTA2-BMP.
      * pb-sib
           COPY RESOURCE "BOTTONE-OK.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-OK.BMP", 
                   GIVING BOTTONE-OK-BMP.
      * pb-noa
           COPY RESOURCE "BOTTONE-CANCEL.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-CANCEL.BMP", 
                   GIVING BOTTONE-CANCEL-BMP.
      * Bitmap-freccia-daa
           COPY RESOURCE "BLUE-DA-28X24.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BLUE-DA-28X24.BMP", 
                   GIVING BLUE-DA-28X24-BMP.
      * Bitmap-freccia-finoa
           COPY RESOURCE "BLUE-FINO-28X24.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BLUE-FINO-28X24.BMP", 
                   GIVING BLUE-FINO-28X24-BMP.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-tvettori
           PERFORM OPEN-tnazioni
           PERFORM OPEN-destini
           PERFORM OPEN-recapiti
           PERFORM OPEN-ttipocli
           PERFORM OPEN-tgrupgdo
           PERFORM OPEN-tregioni
           PERFORM OPEN-tprov
           PERFORM OPEN-tcodpag
           PERFORM OPEN-tivaese
           PERFORM OPEN-ABI
      *    tparamge OPEN MODE IS FALSE
      *    PERFORM OPEN-tparamge
           PERFORM OPEN-lockfile
           PERFORM OPEN-evaclides
           PERFORM OPEN-tparameva
           PERFORM OPEN-cli-prg
           PERFORM OPEN-articoli
           PERFORM OPEN-progmag
           PERFORM OPEN-timballi
           PERFORM OPEN-timbalqta
           PERFORM OPEN-tmagaz
           PERFORM OPEN-pagbloc
           PERFORM OPEN-EDI-clides
           PERFORM OPEN-agenti
           PERFORM OPEN-note
           PERFORM OPEN-note1
           PERFORM OPEN-clienti
           PERFORM OPEN-grade
           PERFORM OPEN-anacap
           PERFORM OPEN-notec
      *    After Open
           .

       OPEN-tvettori.
      * <TOTEM:EPT. INIT:gclienti, FD:tvettori, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tvettori
           IF NOT Valid-STATUS-tvettori
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tvettori, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tnazioni.
      * <TOTEM:EPT. INIT:gclienti, FD:tnazioni, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tnazioni
           IF NOT Valid-STATUS-tnazioni
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tnazioni, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-destini.
      * <TOTEM:EPT. INIT:gclienti, FD:destini, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O destini
           IF STATUS-destini = "35"
              OPEN OUTPUT destini
                IF Valid-STATUS-destini
                   CLOSE destini
                   OPEN I-O destini
                END-IF
           END-IF
           IF NOT Valid-STATUS-destini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:destini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-recapiti.
      * <TOTEM:EPT. INIT:gclienti, FD:recapiti, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O recapiti
           IF STATUS-recapiti = "35"
              OPEN OUTPUT recapiti
                IF Valid-STATUS-recapiti
                   CLOSE recapiti
                   OPEN I-O recapiti
                END-IF
           END-IF
           IF NOT Valid-STATUS-recapiti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:recapiti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-ttipocli.
      * <TOTEM:EPT. INIT:gclienti, FD:ttipocli, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT ttipocli
           IF NOT Valid-STATUS-ttipocli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:ttipocli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tgrupgdo.
      * <TOTEM:EPT. INIT:gclienti, FD:tgrupgdo, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tgrupgdo
           IF NOT Valid-STATUS-tgrupgdo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tgrupgdo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tregioni.
      * <TOTEM:EPT. INIT:gclienti, FD:tregioni, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tregioni
           IF NOT Valid-STATUS-tregioni
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tregioni, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tprov.
      * <TOTEM:EPT. INIT:gclienti, FD:tprov, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tprov
           IF NOT Valid-STATUS-tprov
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tprov, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcodpag.
      * <TOTEM:EPT. INIT:gclienti, FD:tcodpag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcodpag
           IF NOT Valid-STATUS-tcodpag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tcodpag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tivaese.
      * <TOTEM:EPT. INIT:gclienti, FD:tivaese, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tivaese
           IF NOT Valid-STATUS-tivaese
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tivaese, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-ABI.
      * <TOTEM:EPT. INIT:gclienti, FD:ABI, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT ABI
           IF NOT Valid-STATUS-ABI
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:ABI, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tparamge.
      * <TOTEM:EPT. INIT:gclienti, FD:tparamge, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tparamge
           IF NOT Valid-STATUS-tparamge
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tparamge, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-lockfile.
      * <TOTEM:EPT. INIT:gclienti, FD:lockfile, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O lockfile
           IF STATUS-lockfile = "35"
              OPEN OUTPUT lockfile
                IF Valid-STATUS-lockfile
                   CLOSE lockfile
                   OPEN I-O lockfile
                END-IF
           END-IF
           IF NOT Valid-STATUS-lockfile
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:lockfile, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-evaclides.
      * <TOTEM:EPT. INIT:gclienti, FD:evaclides, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O evaclides
           IF STATUS-evaclides = "35"
              OPEN OUTPUT evaclides
                IF Valid-STATUS-evaclides
                   CLOSE evaclides
                   OPEN I-O evaclides
                END-IF
           END-IF
           IF NOT Valid-STATUS-evaclides
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:evaclides, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tparameva.
      * <TOTEM:EPT. INIT:gclienti, FD:tparameva, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tparameva
           IF NOT Valid-STATUS-tparameva
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tparameva, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-cli-prg.
      * <TOTEM:EPT. INIT:gclienti, FD:cli-prg, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O cli-prg
           IF STATUS-cli-prg = "35"
              OPEN OUTPUT cli-prg
                IF Valid-STATUS-cli-prg
                   CLOSE cli-prg
                   OPEN I-O cli-prg
                END-IF
           END-IF
           IF NOT Valid-STATUS-cli-prg
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:cli-prg, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-articoli.
      * <TOTEM:EPT. INIT:gclienti, FD:articoli, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT articoli
           IF NOT Valid-STATUS-articoli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:articoli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-progmag.
      * <TOTEM:EPT. INIT:gclienti, FD:progmag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT progmag
           IF NOT Valid-STATUS-progmag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:progmag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timballi.
      * <TOTEM:EPT. INIT:gclienti, FD:timballi, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timballi
           IF NOT Valid-STATUS-timballi
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:timballi, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timbalqta.
      * <TOTEM:EPT. INIT:gclienti, FD:timbalqta, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timbalqta
           IF NOT Valid-STATUS-timbalqta
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:timbalqta, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmagaz.
      * <TOTEM:EPT. INIT:gclienti, FD:tmagaz, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmagaz
           IF NOT Valid-STATUS-tmagaz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:tmagaz, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-pagbloc.
      * <TOTEM:EPT. INIT:gclienti, FD:pagbloc, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT pagbloc
           IF NOT Valid-STATUS-pagbloc
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:pagbloc, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-EDI-clides.
      * <TOTEM:EPT. INIT:gclienti, FD:EDI-clides, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O EDI-clides
           IF STATUS-EDI-clides = "35"
              OPEN OUTPUT EDI-clides
                IF Valid-STATUS-EDI-clides
                   CLOSE EDI-clides
                   OPEN I-O EDI-clides
                END-IF
           END-IF
           IF NOT Valid-STATUS-EDI-clides
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:EDI-clides, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-agenti.
      * <TOTEM:EPT. INIT:gclienti, FD:agenti, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT agenti
           IF NOT Valid-STATUS-agenti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:agenti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-note.
      * <TOTEM:EPT. INIT:gclienti, FD:note, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O note
           IF STATUS-note = "35"
              OPEN OUTPUT note
                IF Valid-STATUS-note
                   CLOSE note
                   OPEN I-O note
                END-IF
           END-IF
           IF NOT Valid-STATUS-note
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:note, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-note1.
      * <TOTEM:EPT. INIT:gclienti, FD:note1, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O note1
           IF STATUS-note2 = "35"
              OPEN OUTPUT note1
                IF VALID-STATUS-note2
                   CLOSE note1
                   OPEN I-O note1
                END-IF
           END-IF
           IF NOT VALID-STATUS-note2
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:note1, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-clienti.
      * <TOTEM:EPT. INIT:gclienti, FD:clienti, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O clienti
           IF STATUS-clienti = "35"
              OPEN OUTPUT clienti
                IF Valid-STATUS-clienti
                   CLOSE clienti
                   OPEN I-O clienti
                END-IF
           END-IF
           IF NOT Valid-STATUS-clienti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:clienti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-grade.
      * <TOTEM:EPT. INIT:gclienti, FD:grade, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT grade
           IF NOT Valid-STATUS-grade
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:grade, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-anacap.
      * <TOTEM:EPT. INIT:gclienti, FD:anacap, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT anacap
           IF NOT Valid-STATUS-anacap
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:anacap, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-notec.
      * <TOTEM:EPT. INIT:gclienti, FD:notec, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O notec
           IF STATUS-notec = "35"
              OPEN OUTPUT notec
                IF Valid-STATUS-notec
                   CLOSE notec
                   OPEN I-O notec
                END-IF
           END-IF
           IF NOT Valid-STATUS-notec
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gclienti, FD:notec, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-tvettori
           PERFORM CLOSE-tnazioni
           PERFORM CLOSE-destini
           PERFORM CLOSE-recapiti
           PERFORM CLOSE-ttipocli
           PERFORM CLOSE-tgrupgdo
           PERFORM CLOSE-tregioni
           PERFORM CLOSE-tprov
           PERFORM CLOSE-tcodpag
           PERFORM CLOSE-tivaese
           PERFORM CLOSE-ABI
      *    tparamge CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tparamge
           PERFORM CLOSE-lockfile
           PERFORM CLOSE-evaclides
           PERFORM CLOSE-tparameva
           PERFORM CLOSE-cli-prg
           PERFORM CLOSE-articoli
           PERFORM CLOSE-progmag
           PERFORM CLOSE-timballi
           PERFORM CLOSE-timbalqta
           PERFORM CLOSE-tmagaz
           PERFORM CLOSE-pagbloc
           PERFORM CLOSE-EDI-clides
           PERFORM CLOSE-agenti
           PERFORM CLOSE-note
           PERFORM CLOSE-note1
           PERFORM CLOSE-clienti
           PERFORM CLOSE-grade
           PERFORM CLOSE-anacap
           PERFORM CLOSE-notec
      *    After Close
           .

       CLOSE-tvettori.
      * <TOTEM:EPT. INIT:gclienti, FD:tvettori, BeforeClose>
      * <TOTEM:END>
           CLOSE tvettori
           .

       CLOSE-tnazioni.
      * <TOTEM:EPT. INIT:gclienti, FD:tnazioni, BeforeClose>
      * <TOTEM:END>
           CLOSE tnazioni
           .

       CLOSE-destini.
      * <TOTEM:EPT. INIT:gclienti, FD:destini, BeforeClose>
      * <TOTEM:END>
           CLOSE destini
           .

       CLOSE-recapiti.
      * <TOTEM:EPT. INIT:gclienti, FD:recapiti, BeforeClose>
      * <TOTEM:END>
           CLOSE recapiti
           .

       CLOSE-ttipocli.
      * <TOTEM:EPT. INIT:gclienti, FD:ttipocli, BeforeClose>
      * <TOTEM:END>
           CLOSE ttipocli
           .

       CLOSE-tgrupgdo.
      * <TOTEM:EPT. INIT:gclienti, FD:tgrupgdo, BeforeClose>
      * <TOTEM:END>
           CLOSE tgrupgdo
           .

       CLOSE-tregioni.
      * <TOTEM:EPT. INIT:gclienti, FD:tregioni, BeforeClose>
      * <TOTEM:END>
           CLOSE tregioni
           .

       CLOSE-tprov.
      * <TOTEM:EPT. INIT:gclienti, FD:tprov, BeforeClose>
      * <TOTEM:END>
           CLOSE tprov
           .

       CLOSE-tcodpag.
      * <TOTEM:EPT. INIT:gclienti, FD:tcodpag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcodpag
           .

       CLOSE-tivaese.
      * <TOTEM:EPT. INIT:gclienti, FD:tivaese, BeforeClose>
      * <TOTEM:END>
           CLOSE tivaese
           .

       CLOSE-ABI.
      * <TOTEM:EPT. INIT:gclienti, FD:ABI, BeforeClose>
      * <TOTEM:END>
           CLOSE ABI
           .

       CLOSE-tparamge.
      * <TOTEM:EPT. INIT:gclienti, FD:tparamge, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-lockfile.
      * <TOTEM:EPT. INIT:gclienti, FD:lockfile, BeforeClose>
      * <TOTEM:END>
           CLOSE lockfile
           .

       CLOSE-evaclides.
      * <TOTEM:EPT. INIT:gclienti, FD:evaclides, BeforeClose>
      * <TOTEM:END>
           CLOSE evaclides
           .

       CLOSE-tparameva.
      * <TOTEM:EPT. INIT:gclienti, FD:tparameva, BeforeClose>
      * <TOTEM:END>
           CLOSE tparameva
           .

       CLOSE-cli-prg.
      * <TOTEM:EPT. INIT:gclienti, FD:cli-prg, BeforeClose>
      * <TOTEM:END>
           CLOSE cli-prg
           .

       CLOSE-articoli.
      * <TOTEM:EPT. INIT:gclienti, FD:articoli, BeforeClose>
      * <TOTEM:END>
           CLOSE articoli
           .

       CLOSE-progmag.
      * <TOTEM:EPT. INIT:gclienti, FD:progmag, BeforeClose>
      * <TOTEM:END>
           CLOSE progmag
           .

       CLOSE-timballi.
      * <TOTEM:EPT. INIT:gclienti, FD:timballi, BeforeClose>
      * <TOTEM:END>
           CLOSE timballi
           .

       CLOSE-timbalqta.
      * <TOTEM:EPT. INIT:gclienti, FD:timbalqta, BeforeClose>
      * <TOTEM:END>
           CLOSE timbalqta
           .

       CLOSE-tmagaz.
      * <TOTEM:EPT. INIT:gclienti, FD:tmagaz, BeforeClose>
      * <TOTEM:END>
           CLOSE tmagaz
           .

       CLOSE-pagbloc.
      * <TOTEM:EPT. INIT:gclienti, FD:pagbloc, BeforeClose>
      * <TOTEM:END>
           CLOSE pagbloc
           .

       CLOSE-EDI-clides.
      * <TOTEM:EPT. INIT:gclienti, FD:EDI-clides, BeforeClose>
      * <TOTEM:END>
           CLOSE EDI-clides
           .

       CLOSE-agenti.
      * <TOTEM:EPT. INIT:gclienti, FD:agenti, BeforeClose>
      * <TOTEM:END>
           CLOSE agenti
           .

       CLOSE-note.
      * <TOTEM:EPT. INIT:gclienti, FD:note, BeforeClose>
      * <TOTEM:END>
           CLOSE note
           .

       CLOSE-note1.
      * <TOTEM:EPT. INIT:gclienti, FD:note1, BeforeClose>
      * <TOTEM:END>
           CLOSE note1
           .

       CLOSE-clienti.
      * <TOTEM:EPT. INIT:gclienti, FD:clienti, BeforeClose>
      * <TOTEM:END>
           CLOSE clienti
           .

       CLOSE-grade.
      * <TOTEM:EPT. INIT:gclienti, FD:grade, BeforeClose>
      * <TOTEM:END>
           CLOSE grade
           .

       CLOSE-anacap.
      * <TOTEM:EPT. INIT:gclienti, FD:anacap, BeforeClose>
      * <TOTEM:END>
           CLOSE anacap
           .

       CLOSE-notec.
      * <TOTEM:EPT. INIT:gclienti, FD:notec, BeforeClose>
      * <TOTEM:END>
           CLOSE notec
           .

       tvettori-k-des-MERGE-SPLITBUF.
           INITIALIZE tvettori-k-des-SPLITBUF
           MOVE vet-descrizione(1:40) TO tvettori-k-des-SPLITBUF(1:40)
           .

       DataSet1-tvettori-INITSTART.
           IF DataSet1-tvettori-KEY-Asc
              MOVE Low-Value TO vet-chiave
           ELSE
              MOVE High-Value TO vet-chiave
           END-IF
           .

       DataSet1-tvettori-INITEND.
           IF DataSet1-tvettori-KEY-Asc
              MOVE High-Value TO vet-chiave
           ELSE
              MOVE Low-Value TO vet-chiave
           END-IF
           .

      * tvettori
       DataSet1-tvettori-START.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY >= vet-chiave
           ELSE
              START tvettori KEY <= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-NOTGREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY <= vet-chiave
           ELSE
              START tvettori KEY >= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-GREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY > vet-chiave
           ELSE
              START tvettori KEY < vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-LESS.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY < vet-chiave
           ELSE
              START tvettori KEY > vet-chiave
           END-IF
           .

       DataSet1-tvettori-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tvettori-LOCK
              READ tvettori WITH LOCK 
              KEY vet-chiave
           ELSE
              READ tvettori WITH NO LOCK 
              KEY vet-chiave
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT 
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-INITSTART.
           IF DataSet1-tnazioni-KEY-Asc
              MOVE Low-Value TO naz-chiave
           ELSE
              MOVE High-Value TO naz-chiave
           END-IF
           .

       DataSet1-tnazioni-INITEND.
           IF DataSet1-tnazioni-KEY-Asc
              MOVE High-Value TO naz-chiave
           ELSE
              MOVE Low-Value TO naz-chiave
           END-IF
           .

      * tnazioni
       DataSet1-tnazioni-START.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY >= naz-chiave
           ELSE
              START tnazioni KEY <= naz-chiave
           END-IF
           .

       DataSet1-tnazioni-START-NOTGREATER.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY <= naz-chiave
           ELSE
              START tnazioni KEY >= naz-chiave
           END-IF
           .

       DataSet1-tnazioni-START-GREATER.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY > naz-chiave
           ELSE
              START tnazioni KEY < naz-chiave
           END-IF
           .

       DataSet1-tnazioni-START-LESS.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY < naz-chiave
           ELSE
              START tnazioni KEY > naz-chiave
           END-IF
           .

       DataSet1-tnazioni-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tnazioni-LOCK
              READ tnazioni WITH LOCK 
              KEY naz-chiave
           ELSE
              READ tnazioni WITH NO LOCK 
              KEY naz-chiave
           END-IF
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT 
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tnazioni-KEY-Asc
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni NEXT WITH LOCK
              ELSE
                 READ tnazioni NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni PREVIOUS WITH LOCK
              ELSE
                 READ tnazioni PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tnazioni-KEY-Asc
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni PREVIOUS WITH LOCK
              ELSE
                 READ tnazioni PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni NEXT WITH LOCK
              ELSE
                 READ tnazioni NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterDelete>
      * <TOTEM:END>
           .

       destini-K1-MERGE-SPLITBUF.
           INITIALIZE destini-K1-SPLITBUF
           MOVE des-ragsoc-1(1:100) TO destini-K1-SPLITBUF(1:100)
           MOVE des-codice(1:5) TO destini-K1-SPLITBUF(101:5)
           MOVE des-prog(1:5) TO destini-K1-SPLITBUF(106:5)
           .

       destini-k-localita-MERGE-SPLITBUF.
           INITIALIZE destini-k-localita-SPLITBUF
           MOVE des-localita(1:35) TO destini-k-localita-SPLITBUF(1:35)
           .

       DataSet1-destini-INITSTART.
           IF DataSet1-destini-KEY-Asc
              MOVE Low-Value TO des-chiave
           ELSE
              MOVE High-Value TO des-chiave
           END-IF
           .

       DataSet1-destini-INITEND.
           IF DataSet1-destini-KEY-Asc
              MOVE High-Value TO des-chiave
           ELSE
              MOVE Low-Value TO des-chiave
           END-IF
           .

      * destini
       DataSet1-destini-START.
           IF DataSet1-destini-KEY-Asc
              START destini KEY >= des-chiave
           ELSE
              START destini KEY <= des-chiave
           END-IF
           .

       DataSet1-destini-START-NOTGREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY <= des-chiave
           ELSE
              START destini KEY >= des-chiave
           END-IF
           .

       DataSet1-destini-START-GREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY > des-chiave
           ELSE
              START destini KEY < des-chiave
           END-IF
           .

       DataSet1-destini-START-LESS.
           IF DataSet1-destini-KEY-Asc
              START destini KEY < des-chiave
           ELSE
              START destini KEY > des-chiave
           END-IF
           .

       DataSet1-destini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-destini-LOCK
              READ destini WITH LOCK 
              KEY des-chiave
           ELSE
              READ destini WITH NO LOCK 
              KEY des-chiave
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT 
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeWrite>
      * <TOTEM:END>
           WRITE des-rec OF destini.
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRewrite>
      * <TOTEM:END>
           REWRITE des-rec OF destini.
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeDelete>
      * <TOTEM:END>
           DELETE destini.
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-recapiti-INITSTART.
           IF DataSet1-recapiti-KEY-Asc
              MOVE Low-Value TO rec-chiave
           ELSE
              MOVE High-Value TO rec-chiave
           END-IF
           .

       DataSet1-recapiti-INITEND.
           IF DataSet1-recapiti-KEY-Asc
              MOVE High-Value TO rec-chiave
           ELSE
              MOVE Low-Value TO rec-chiave
           END-IF
           .

      * recapiti
       DataSet1-recapiti-START.
           IF DataSet1-recapiti-KEY-Asc
              START recapiti KEY >= rec-chiave
           ELSE
              START recapiti KEY <= rec-chiave
           END-IF
           .

       DataSet1-recapiti-START-NOTGREATER.
           IF DataSet1-recapiti-KEY-Asc
              START recapiti KEY <= rec-chiave
           ELSE
              START recapiti KEY >= rec-chiave
           END-IF
           .

       DataSet1-recapiti-START-GREATER.
           IF DataSet1-recapiti-KEY-Asc
              START recapiti KEY > rec-chiave
           ELSE
              START recapiti KEY < rec-chiave
           END-IF
           .

       DataSet1-recapiti-START-LESS.
           IF DataSet1-recapiti-KEY-Asc
              START recapiti KEY < rec-chiave
           ELSE
              START recapiti KEY > rec-chiave
           END-IF
           .

       DataSet1-recapiti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-recapiti-LOCK
              READ recapiti WITH LOCK 
              KEY rec-chiave
           ELSE
              READ recapiti WITH NO LOCK 
              KEY rec-chiave
           END-IF
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT 
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-recapiti-KEY-Asc
              IF DataSet1-recapiti-LOCK
                 READ recapiti NEXT WITH LOCK
              ELSE
                 READ recapiti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-recapiti-LOCK
                 READ recapiti PREVIOUS WITH LOCK
              ELSE
                 READ recapiti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-recapiti-KEY-Asc
              IF DataSet1-recapiti-LOCK
                 READ recapiti PREVIOUS WITH LOCK
              ELSE
                 READ recapiti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-recapiti-LOCK
                 READ recapiti NEXT WITH LOCK
              ELSE
                 READ recapiti NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeWrite>
      * <TOTEM:END>
           WRITE rec-rec OF recapiti.
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeRewrite>
      * <TOTEM:END>
           REWRITE rec-rec OF recapiti.
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeDelete>
      * <TOTEM:END>
           DELETE recapiti.
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-INITSTART.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE Low-Value TO tcl-chiave
           ELSE
              MOVE High-Value TO tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-INITEND.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE High-Value TO tcl-chiave
           ELSE
              MOVE Low-Value TO tcl-chiave
           END-IF
           .

      * ttipocli
       DataSet1-ttipocli-START.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY >= tcl-chiave
           ELSE
              START ttipocli KEY <= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-NOTGREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY <= tcl-chiave
           ELSE
              START ttipocli KEY >= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-GREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY > tcl-chiave
           ELSE
              START ttipocli KEY < tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-LESS.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY < tcl-chiave
           ELSE
              START ttipocli KEY > tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-ttipocli-LOCK
              READ ttipocli WITH LOCK 
              KEY tcl-chiave
           ELSE
              READ ttipocli WITH NO LOCK 
              KEY tcl-chiave
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT 
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterDelete>
      * <TOTEM:END>
           .

       tgrupgdo-gdo-k-g2-MERGE-SPLITBUF.
           INITIALIZE tgrupgdo-gdo-k-g2-SPLITBUF
           MOVE gdo-codice-G2 OF tgrupgdo(1:3) TO 
           tgrupgdo-gdo-k-g2-SPLITBUF(1:3)
           MOVE gdo-chiave OF tgrupgdo(1:5) TO 
           tgrupgdo-gdo-k-g2-SPLITBUF(4:5)
           .

       DataSet1-tgrupgdo-INITSTART.
           IF DataSet1-tgrupgdo-KEY-Asc
              MOVE Low-Value TO gdo-chiave OF tgrupgdo
           ELSE
              MOVE High-Value TO gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-INITEND.
           IF DataSet1-tgrupgdo-KEY-Asc
              MOVE High-Value TO gdo-chiave OF tgrupgdo
           ELSE
              MOVE Low-Value TO gdo-chiave OF tgrupgdo
           END-IF
           .

      * tgrupgdo
       DataSet1-tgrupgdo-START.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY >= gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY <= gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-START-NOTGREATER.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY <= gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY >= gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-START-GREATER.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY > gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY < gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-START-LESS.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY < gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY > gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tgrupgdo-LOCK
              READ tgrupgdo WITH LOCK 
              KEY gdo-chiave OF tgrupgdo
           ELSE
              READ tgrupgdo WITH NO LOCK 
              KEY gdo-chiave OF tgrupgdo
           END-IF
           PERFORM tgrupgdo-gdo-k-g2-MERGE-SPLITBUF
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT 
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tgrupgdo-KEY-Asc
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo NEXT WITH LOCK
              ELSE
                 READ tgrupgdo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo PREVIOUS WITH LOCK
              ELSE
                 READ tgrupgdo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tgrupgdo-gdo-k-g2-MERGE-SPLITBUF
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tgrupgdo-KEY-Asc
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo PREVIOUS WITH LOCK
              ELSE
                 READ tgrupgdo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo NEXT WITH LOCK
              ELSE
                 READ tgrupgdo NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tgrupgdo-gdo-k-g2-MERGE-SPLITBUF
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tregioni-INITSTART.
           IF DataSet1-tregioni-KEY-Asc
              MOVE Low-Value TO reg-chiave
           ELSE
              MOVE High-Value TO reg-chiave
           END-IF
           .

       DataSet1-tregioni-INITEND.
           IF DataSet1-tregioni-KEY-Asc
              MOVE High-Value TO reg-chiave
           ELSE
              MOVE Low-Value TO reg-chiave
           END-IF
           .

      * tregioni
       DataSet1-tregioni-START.
           IF DataSet1-tregioni-KEY-Asc
              START tregioni KEY >= reg-chiave
           ELSE
              START tregioni KEY <= reg-chiave
           END-IF
           .

       DataSet1-tregioni-START-NOTGREATER.
           IF DataSet1-tregioni-KEY-Asc
              START tregioni KEY <= reg-chiave
           ELSE
              START tregioni KEY >= reg-chiave
           END-IF
           .

       DataSet1-tregioni-START-GREATER.
           IF DataSet1-tregioni-KEY-Asc
              START tregioni KEY > reg-chiave
           ELSE
              START tregioni KEY < reg-chiave
           END-IF
           .

       DataSet1-tregioni-START-LESS.
           IF DataSet1-tregioni-KEY-Asc
              START tregioni KEY < reg-chiave
           ELSE
              START tregioni KEY > reg-chiave
           END-IF
           .

       DataSet1-tregioni-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tregioni-LOCK
              READ tregioni WITH LOCK 
              KEY reg-chiave
           ELSE
              READ tregioni WITH NO LOCK 
              KEY reg-chiave
           END-IF
           MOVE STATUS-tregioni TO TOTEM-ERR-STAT 
           MOVE "tregioni" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tregioni-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tregioni-KEY-Asc
              IF DataSet1-tregioni-LOCK
                 READ tregioni NEXT WITH LOCK
              ELSE
                 READ tregioni NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tregioni-LOCK
                 READ tregioni PREVIOUS WITH LOCK
              ELSE
                 READ tregioni PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tregioni TO TOTEM-ERR-STAT
           MOVE "tregioni" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tregioni-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tregioni-KEY-Asc
              IF DataSet1-tregioni-LOCK
                 READ tregioni PREVIOUS WITH LOCK
              ELSE
                 READ tregioni PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tregioni-LOCK
                 READ tregioni NEXT WITH LOCK
              ELSE
                 READ tregioni NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tregioni TO TOTEM-ERR-STAT
           MOVE "tregioni" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tregioni-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tregioni TO TOTEM-ERR-STAT
           MOVE "tregioni" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tregioni-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tregioni TO TOTEM-ERR-STAT
           MOVE "tregioni" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tregioni-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tregioni TO TOTEM-ERR-STAT
           MOVE "tregioni" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tregioni, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tprov-INITSTART.
           IF DataSet1-tprov-KEY-Asc
              MOVE Low-Value TO prv-chiave
           ELSE
              MOVE High-Value TO prv-chiave
           END-IF
           .

       DataSet1-tprov-INITEND.
           IF DataSet1-tprov-KEY-Asc
              MOVE High-Value TO prv-chiave
           ELSE
              MOVE Low-Value TO prv-chiave
           END-IF
           .

      * tprov
       DataSet1-tprov-START.
           IF DataSet1-tprov-KEY-Asc
              START tprov KEY >= prv-chiave
           ELSE
              START tprov KEY <= prv-chiave
           END-IF
           .

       DataSet1-tprov-START-NOTGREATER.
           IF DataSet1-tprov-KEY-Asc
              START tprov KEY <= prv-chiave
           ELSE
              START tprov KEY >= prv-chiave
           END-IF
           .

       DataSet1-tprov-START-GREATER.
           IF DataSet1-tprov-KEY-Asc
              START tprov KEY > prv-chiave
           ELSE
              START tprov KEY < prv-chiave
           END-IF
           .

       DataSet1-tprov-START-LESS.
           IF DataSet1-tprov-KEY-Asc
              START tprov KEY < prv-chiave
           ELSE
              START tprov KEY > prv-chiave
           END-IF
           .

       DataSet1-tprov-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tprov-LOCK
              READ tprov WITH LOCK 
              KEY prv-chiave
           ELSE
              READ tprov WITH NO LOCK 
              KEY prv-chiave
           END-IF
           MOVE STATUS-tprov TO TOTEM-ERR-STAT 
           MOVE "tprov" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tprov-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tprov-KEY-Asc
              IF DataSet1-tprov-LOCK
                 READ tprov NEXT WITH LOCK
              ELSE
                 READ tprov NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tprov-LOCK
                 READ tprov PREVIOUS WITH LOCK
              ELSE
                 READ tprov PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tprov TO TOTEM-ERR-STAT
           MOVE "tprov" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tprov-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tprov-KEY-Asc
              IF DataSet1-tprov-LOCK
                 READ tprov PREVIOUS WITH LOCK
              ELSE
                 READ tprov PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tprov-LOCK
                 READ tprov NEXT WITH LOCK
              ELSE
                 READ tprov NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tprov TO TOTEM-ERR-STAT
           MOVE "tprov" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tprov-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tprov TO TOTEM-ERR-STAT
           MOVE "tprov" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tprov-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tprov TO TOTEM-ERR-STAT
           MOVE "tprov" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tprov-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tprov TO TOTEM-ERR-STAT
           MOVE "tprov" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tprov, AfterDelete>
      * <TOTEM:END>
           .

       tcodpag-TBL-CODICE-01-MERGE-SPLITBUF.
           INITIALIZE tcodpag-TBL-CODICE-01-SPLITBUF
           MOVE TBLPA-CODICE1(1:2) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(1:2)
           MOVE TBLPA-DESCRIZIONE1(1:30) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(3:30)
           MOVE TBLPA-CODICE2(1:20) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(33:20)
           .

       DataSet1-tcodpag-INITSTART.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE Low-Value TO TBLPA-CODICE
           ELSE
              MOVE High-Value TO TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-INITEND.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE High-Value TO TBLPA-CODICE
           ELSE
              MOVE Low-Value TO TBLPA-CODICE
           END-IF
           .

      * tcodpag
       DataSet1-tcodpag-START.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY >= TBLPA-CODICE
           ELSE
              START tcodpag KEY <= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-NOTGREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY <= TBLPA-CODICE
           ELSE
              START tcodpag KEY >= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-GREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY > TBLPA-CODICE
           ELSE
              START tcodpag KEY < TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-LESS.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY < TBLPA-CODICE
           ELSE
              START tcodpag KEY > TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcodpag-LOCK
              READ tcodpag WITH LOCK 
              KEY TBLPA-CODICE
           ELSE
              READ tcodpag WITH NO LOCK 
              KEY TBLPA-CODICE
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT 
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeWrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRewrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeDelete>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterDelete>
      * <TOTEM:END>
           .

       tivaese-key01-MERGE-SPLITBUF.
           INITIALIZE tivaese-key01-SPLITBUF
           MOVE TBLIV-CODICE1(1:2) TO tivaese-key01-SPLITBUF(1:2)
           MOVE TBLIV-DESCRIZIONE1(1:30) TO tivaese-key01-SPLITBUF(3:30)
           MOVE TBLIV-CODICE2(1:20) TO tivaese-key01-SPLITBUF(33:20)
           .

       DataSet1-tivaese-INITSTART.
           IF DataSet1-tivaese-KEY-Asc
              MOVE Low-Value TO TBLIV-CODICE
           ELSE
              MOVE High-Value TO TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-INITEND.
           IF DataSet1-tivaese-KEY-Asc
              MOVE High-Value TO TBLIV-CODICE
           ELSE
              MOVE Low-Value TO TBLIV-CODICE
           END-IF
           .

      * tivaese
       DataSet1-tivaese-START.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY >= TBLIV-CODICE
           ELSE
              START tivaese KEY <= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-NOTGREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY <= TBLIV-CODICE
           ELSE
              START tivaese KEY >= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-GREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY > TBLIV-CODICE
           ELSE
              START tivaese KEY < TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-LESS.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY < TBLIV-CODICE
           ELSE
              START tivaese KEY > TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tivaese-LOCK
              READ tivaese WITH LOCK 
              KEY TBLIV-CODICE
           ELSE
              READ tivaese WITH NO LOCK 
              KEY TBLIV-CODICE
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT 
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterDelete>
      * <TOTEM:END>
           .

       ABI-ABI-CODICE1-MERGE-SPLITBUF.
           INITIALIZE ABI-ABI-CODICE1-SPLITBUF
           MOVE ABI-BANCA1(1:30) TO ABI-ABI-CODICE1-SPLITBUF(1:30)
           MOVE ABI-CITTA(1:30) TO ABI-ABI-CODICE1-SPLITBUF(31:30)
           MOVE ABI-BANCA2(1:30) TO ABI-ABI-CODICE1-SPLITBUF(61:30)
           MOVE ABI-CODICE(1:10) TO ABI-ABI-CODICE1-SPLITBUF(91:10)
           .

       ABI-ABI-CODICE2-MERGE-SPLITBUF.
           INITIALIZE ABI-ABI-CODICE2-SPLITBUF
           MOVE ABI-CITTA(1:30) TO ABI-ABI-CODICE2-SPLITBUF(1:30)
           MOVE ABI-BANCA1(1:30) TO ABI-ABI-CODICE2-SPLITBUF(31:30)
           MOVE ABI-BANCA2(1:30) TO ABI-ABI-CODICE2-SPLITBUF(61:30)
           MOVE ABI-CODICE(1:10) TO ABI-ABI-CODICE2-SPLITBUF(91:10)
           .

       DataSet1-ABI-INITSTART.
           IF DataSet1-ABI-KEY-Asc
              MOVE Low-Value TO ABI-CODICE
           ELSE
              MOVE High-Value TO ABI-CODICE
           END-IF
           .

       DataSet1-ABI-INITEND.
           IF DataSet1-ABI-KEY-Asc
              MOVE High-Value TO ABI-CODICE
           ELSE
              MOVE Low-Value TO ABI-CODICE
           END-IF
           .

      * ABI
       DataSet1-ABI-START.
           IF DataSet1-ABI-KEY-Asc
              START ABI KEY >= ABI-CODICE
           ELSE
              START ABI KEY <= ABI-CODICE
           END-IF
           .

       DataSet1-ABI-START-NOTGREATER.
           IF DataSet1-ABI-KEY-Asc
              START ABI KEY <= ABI-CODICE
           ELSE
              START ABI KEY >= ABI-CODICE
           END-IF
           .

       DataSet1-ABI-START-GREATER.
           IF DataSet1-ABI-KEY-Asc
              START ABI KEY > ABI-CODICE
           ELSE
              START ABI KEY < ABI-CODICE
           END-IF
           .

       DataSet1-ABI-START-LESS.
           IF DataSet1-ABI-KEY-Asc
              START ABI KEY < ABI-CODICE
           ELSE
              START ABI KEY > ABI-CODICE
           END-IF
           .

       DataSet1-ABI-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-ABI-LOCK
              READ ABI WITH LOCK 
              KEY ABI-CODICE
           ELSE
              READ ABI WITH NO LOCK 
              KEY ABI-CODICE
           END-IF
           PERFORM ABI-ABI-CODICE1-MERGE-SPLITBUF
           PERFORM ABI-ABI-CODICE2-MERGE-SPLITBUF
           MOVE STATUS-ABI TO TOTEM-ERR-STAT 
           MOVE "ABI" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-ABI-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-ABI-KEY-Asc
              IF DataSet1-ABI-LOCK
                 READ ABI NEXT WITH LOCK
              ELSE
                 READ ABI NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ABI-LOCK
                 READ ABI PREVIOUS WITH LOCK
              ELSE
                 READ ABI PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM ABI-ABI-CODICE1-MERGE-SPLITBUF
           PERFORM ABI-ABI-CODICE2-MERGE-SPLITBUF
           MOVE STATUS-ABI TO TOTEM-ERR-STAT
           MOVE "ABI" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-ABI-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-ABI-KEY-Asc
              IF DataSet1-ABI-LOCK
                 READ ABI PREVIOUS WITH LOCK
              ELSE
                 READ ABI PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ABI-LOCK
                 READ ABI NEXT WITH LOCK
              ELSE
                 READ ABI NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM ABI-ABI-CODICE1-MERGE-SPLITBUF
           PERFORM ABI-ABI-CODICE2-MERGE-SPLITBUF
           MOVE STATUS-ABI TO TOTEM-ERR-STAT
           MOVE "ABI" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-ABI-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-ABI TO TOTEM-ERR-STAT
           MOVE "ABI" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-ABI-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-ABI TO TOTEM-ERR-STAT
           MOVE "ABI" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-ABI-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-ABI TO TOTEM-ERR-STAT
           MOVE "ABI" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ABI, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tparamge-INITSTART.
           IF DataSet1-tparamge-KEY-Asc
              MOVE Low-Value TO tge-chiave
           ELSE
              MOVE High-Value TO tge-chiave
           END-IF
           .

       DataSet1-tparamge-INITEND.
           IF DataSet1-tparamge-KEY-Asc
              MOVE High-Value TO tge-chiave
           ELSE
              MOVE Low-Value TO tge-chiave
           END-IF
           .

      * tparamge
       DataSet1-tparamge-START.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY >= tge-chiave
           ELSE
              START tparamge KEY <= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-NOTGREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY <= tge-chiave
           ELSE
              START tparamge KEY >= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-GREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY > tge-chiave
           ELSE
              START tparamge KEY < tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-LESS.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY < tge-chiave
           ELSE
              START tparamge KEY > tge-chiave
           END-IF
           .

       DataSet1-tparamge-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tparamge-LOCK
              READ tparamge WITH LOCK 
              KEY tge-chiave
           ELSE
              READ tparamge WITH NO LOCK 
              KEY tge-chiave
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT 
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-lockfile-INITSTART.
           IF DataSet1-lockfile-KEY-Asc
              MOVE Low-Value TO lck-chiave
           ELSE
              MOVE High-Value TO lck-chiave
           END-IF
           .

       DataSet1-lockfile-INITEND.
           IF DataSet1-lockfile-KEY-Asc
              MOVE High-Value TO lck-chiave
           ELSE
              MOVE Low-Value TO lck-chiave
           END-IF
           .

      * lockfile
       DataSet1-lockfile-START.
           IF DataSet1-lockfile-KEY-Asc
              START lockfile KEY >= lck-chiave
           ELSE
              START lockfile KEY <= lck-chiave
           END-IF
           .

       DataSet1-lockfile-START-NOTGREATER.
           IF DataSet1-lockfile-KEY-Asc
              START lockfile KEY <= lck-chiave
           ELSE
              START lockfile KEY >= lck-chiave
           END-IF
           .

       DataSet1-lockfile-START-GREATER.
           IF DataSet1-lockfile-KEY-Asc
              START lockfile KEY > lck-chiave
           ELSE
              START lockfile KEY < lck-chiave
           END-IF
           .

       DataSet1-lockfile-START-LESS.
           IF DataSet1-lockfile-KEY-Asc
              START lockfile KEY < lck-chiave
           ELSE
              START lockfile KEY > lck-chiave
           END-IF
           .

       DataSet1-lockfile-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-lockfile-LOCK
              READ lockfile WITH LOCK 
              KEY lck-chiave
           ELSE
              READ lockfile WITH NO LOCK 
              KEY lck-chiave
           END-IF
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT 
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-lockfile-KEY-Asc
              IF DataSet1-lockfile-LOCK
                 READ lockfile NEXT WITH LOCK
              ELSE
                 READ lockfile NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-lockfile-LOCK
                 READ lockfile PREVIOUS WITH LOCK
              ELSE
                 READ lockfile PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-lockfile-KEY-Asc
              IF DataSet1-lockfile-LOCK
                 READ lockfile PREVIOUS WITH LOCK
              ELSE
                 READ lockfile PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-lockfile-LOCK
                 READ lockfile NEXT WITH LOCK
              ELSE
                 READ lockfile NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeWrite>
      * <TOTEM:END>
           WRITE lck-rec OF lockfile.
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeRewrite>
      * <TOTEM:END>
           REWRITE lck-rec OF lockfile.
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeDelete>
      * <TOTEM:END>
           DELETE lockfile.
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-evaclides-INITSTART.
           IF DataSet1-evaclides-KEY-Asc
              MOVE Low-Value TO ecd-chiave-OLD
           ELSE
              MOVE High-Value TO ecd-chiave-OLD
           END-IF
           .

       DataSet1-evaclides-INITEND.
           IF DataSet1-evaclides-KEY-Asc
              MOVE High-Value TO ecd-chiave-OLD
           ELSE
              MOVE Low-Value TO ecd-chiave-OLD
           END-IF
           .

      * evaclides
       DataSet1-evaclides-START.
           IF DataSet1-evaclides-KEY-Asc
              START evaclides KEY >= ecd-chiave-OLD
           ELSE
              START evaclides KEY <= ecd-chiave-OLD
           END-IF
           .

       DataSet1-evaclides-START-NOTGREATER.
           IF DataSet1-evaclides-KEY-Asc
              START evaclides KEY <= ecd-chiave-OLD
           ELSE
              START evaclides KEY >= ecd-chiave-OLD
           END-IF
           .

       DataSet1-evaclides-START-GREATER.
           IF DataSet1-evaclides-KEY-Asc
              START evaclides KEY > ecd-chiave-OLD
           ELSE
              START evaclides KEY < ecd-chiave-OLD
           END-IF
           .

       DataSet1-evaclides-START-LESS.
           IF DataSet1-evaclides-KEY-Asc
              START evaclides KEY < ecd-chiave-OLD
           ELSE
              START evaclides KEY > ecd-chiave-OLD
           END-IF
           .

       DataSet1-evaclides-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-evaclides-LOCK
              READ evaclides WITH LOCK 
              KEY ecd-chiave-OLD
           ELSE
              READ evaclides WITH NO LOCK 
              KEY ecd-chiave-OLD
           END-IF
           MOVE STATUS-evaclides TO TOTEM-ERR-STAT 
           MOVE "evaclides" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-evaclides-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-evaclides-KEY-Asc
              IF DataSet1-evaclides-LOCK
                 READ evaclides NEXT WITH LOCK
              ELSE
                 READ evaclides NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-evaclides-LOCK
                 READ evaclides PREVIOUS WITH LOCK
              ELSE
                 READ evaclides PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-evaclides TO TOTEM-ERR-STAT
           MOVE "evaclides" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-evaclides-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-evaclides-KEY-Asc
              IF DataSet1-evaclides-LOCK
                 READ evaclides PREVIOUS WITH LOCK
              ELSE
                 READ evaclides PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-evaclides-LOCK
                 READ evaclides NEXT WITH LOCK
              ELSE
                 READ evaclides NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-evaclides TO TOTEM-ERR-STAT
           MOVE "evaclides" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-evaclides-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, BeforeWrite>
      * <TOTEM:END>
           WRITE ecd-rec-OLD OF evaclides.
           MOVE STATUS-evaclides TO TOTEM-ERR-STAT
           MOVE "evaclides" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-evaclides-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, BeforeRewrite>
      * <TOTEM:END>
           REWRITE ecd-rec-OLD OF evaclides.
           MOVE STATUS-evaclides TO TOTEM-ERR-STAT
           MOVE "evaclides" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-evaclides-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, BeforeDelete>
      * <TOTEM:END>
           DELETE evaclides.
           MOVE STATUS-evaclides TO TOTEM-ERR-STAT
           MOVE "evaclides" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:evaclides, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tparameva-INITSTART.
           IF DataSet1-tparameva-KEY-Asc
              MOVE Low-Value TO tpa-chiave
           ELSE
              MOVE High-Value TO tpa-chiave
           END-IF
           .

       DataSet1-tparameva-INITEND.
           IF DataSet1-tparameva-KEY-Asc
              MOVE High-Value TO tpa-chiave
           ELSE
              MOVE Low-Value TO tpa-chiave
           END-IF
           .

      * tparameva
       DataSet1-tparameva-START.
           IF DataSet1-tparameva-KEY-Asc
              START tparameva KEY >= tpa-chiave
           ELSE
              START tparameva KEY <= tpa-chiave
           END-IF
           .

       DataSet1-tparameva-START-NOTGREATER.
           IF DataSet1-tparameva-KEY-Asc
              START tparameva KEY <= tpa-chiave
           ELSE
              START tparameva KEY >= tpa-chiave
           END-IF
           .

       DataSet1-tparameva-START-GREATER.
           IF DataSet1-tparameva-KEY-Asc
              START tparameva KEY > tpa-chiave
           ELSE
              START tparameva KEY < tpa-chiave
           END-IF
           .

       DataSet1-tparameva-START-LESS.
           IF DataSet1-tparameva-KEY-Asc
              START tparameva KEY < tpa-chiave
           ELSE
              START tparameva KEY > tpa-chiave
           END-IF
           .

       DataSet1-tparameva-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tparameva-LOCK
              READ tparameva WITH LOCK 
              KEY tpa-chiave
           ELSE
              READ tparameva WITH NO LOCK 
              KEY tpa-chiave
           END-IF
           MOVE STATUS-tparameva TO TOTEM-ERR-STAT 
           MOVE "tparameva" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tparameva-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tparameva-KEY-Asc
              IF DataSet1-tparameva-LOCK
                 READ tparameva NEXT WITH LOCK
              ELSE
                 READ tparameva NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparameva-LOCK
                 READ tparameva PREVIOUS WITH LOCK
              ELSE
                 READ tparameva PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparameva TO TOTEM-ERR-STAT
           MOVE "tparameva" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tparameva-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tparameva-KEY-Asc
              IF DataSet1-tparameva-LOCK
                 READ tparameva PREVIOUS WITH LOCK
              ELSE
                 READ tparameva PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparameva-LOCK
                 READ tparameva NEXT WITH LOCK
              ELSE
                 READ tparameva NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparameva TO TOTEM-ERR-STAT
           MOVE "tparameva" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tparameva-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tparameva TO TOTEM-ERR-STAT
           MOVE "tparameva" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tparameva-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tparameva TO TOTEM-ERR-STAT
           MOVE "tparameva" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tparameva-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tparameva TO TOTEM-ERR-STAT
           MOVE "tparameva" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparameva, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-INITSTART.
           IF DataSet1-cli-prg-KEY-Asc
              MOVE Low-Value TO cp-chiave
           ELSE
              MOVE High-Value TO cp-chiave
           END-IF
           .

       DataSet1-cli-prg-INITEND.
           IF DataSet1-cli-prg-KEY-Asc
              MOVE High-Value TO cp-chiave
           ELSE
              MOVE Low-Value TO cp-chiave
           END-IF
           .

      * cli-prg
       DataSet1-cli-prg-START.
           IF DataSet1-cli-prg-KEY-Asc
              START cli-prg KEY >= cp-chiave
           ELSE
              START cli-prg KEY <= cp-chiave
           END-IF
           .

       DataSet1-cli-prg-START-NOTGREATER.
           IF DataSet1-cli-prg-KEY-Asc
              START cli-prg KEY <= cp-chiave
           ELSE
              START cli-prg KEY >= cp-chiave
           END-IF
           .

       DataSet1-cli-prg-START-GREATER.
           IF DataSet1-cli-prg-KEY-Asc
              START cli-prg KEY > cp-chiave
           ELSE
              START cli-prg KEY < cp-chiave
           END-IF
           .

       DataSet1-cli-prg-START-LESS.
           IF DataSet1-cli-prg-KEY-Asc
              START cli-prg KEY < cp-chiave
           ELSE
              START cli-prg KEY > cp-chiave
           END-IF
           .

       DataSet1-cli-prg-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-cli-prg-LOCK
              READ cli-prg WITH LOCK 
              KEY cp-chiave
           ELSE
              READ cli-prg WITH NO LOCK 
              KEY cp-chiave
           END-IF
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT 
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-cli-prg-KEY-Asc
              IF DataSet1-cli-prg-LOCK
                 READ cli-prg NEXT WITH LOCK
              ELSE
                 READ cli-prg NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-cli-prg-LOCK
                 READ cli-prg PREVIOUS WITH LOCK
              ELSE
                 READ cli-prg PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-cli-prg-KEY-Asc
              IF DataSet1-cli-prg-LOCK
                 READ cli-prg PREVIOUS WITH LOCK
              ELSE
                 READ cli-prg PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-cli-prg-LOCK
                 READ cli-prg NEXT WITH LOCK
              ELSE
                 READ cli-prg NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeWrite>
      * <TOTEM:END>
           WRITE cp-rec OF cli-prg.
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeRewrite>
      * <TOTEM:END>
           REWRITE cp-rec OF cli-prg.
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeDelete>
      * <TOTEM:END>
           DELETE cli-prg.
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterDelete>
      * <TOTEM:END>
           .

       articoli-art-k1-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k1-SPLITBUF
           MOVE art-descrizione OF articoli(1:50) TO 
           articoli-art-k1-SPLITBUF(1:50)
           .

       articoli-art-k-frn-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k-frn-SPLITBUF
           MOVE art-cod-art-frn OF articoli(1:15) TO 
           articoli-art-k-frn-SPLITBUF(1:15)
           .

       DataSet1-articoli-INITSTART.
           IF DataSet1-articoli-KEY-Asc
              MOVE Low-Value TO art-chiave OF articoli
           ELSE
              MOVE High-Value TO art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-INITEND.
           IF DataSet1-articoli-KEY-Asc
              MOVE High-Value TO art-chiave OF articoli
           ELSE
              MOVE Low-Value TO art-chiave OF articoli
           END-IF
           .

      * articoli
       DataSet1-articoli-START.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY >= art-chiave OF articoli
           ELSE
              START articoli KEY <= art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-NOTGREATER.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY <= art-chiave OF articoli
           ELSE
              START articoli KEY >= art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-GREATER.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY > art-chiave OF articoli
           ELSE
              START articoli KEY < art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-LESS.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY < art-chiave OF articoli
           ELSE
              START articoli KEY > art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-articoli-LOCK
              READ articoli WITH LOCK 
              KEY art-chiave OF articoli
           ELSE
              READ articoli WITH NO LOCK 
              KEY art-chiave OF articoli
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT 
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-articoli-KEY-Asc
              IF DataSet1-articoli-LOCK
                 READ articoli NEXT WITH LOCK
              ELSE
                 READ articoli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli-LOCK
                 READ articoli PREVIOUS WITH LOCK
              ELSE
                 READ articoli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-articoli-KEY-Asc
              IF DataSet1-articoli-LOCK
                 READ articoli PREVIOUS WITH LOCK
              ELSE
                 READ articoli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli-LOCK
                 READ articoli NEXT WITH LOCK
              ELSE
                 READ articoli NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterDelete>
      * <TOTEM:END>
           .

       progmag-key01-MERGE-SPLITBUF.
           INITIALIZE progmag-key01-SPLITBUF
           MOVE prg-cod-magazzino OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(1:3)
           MOVE prg-cod-articolo OF progmag(1:6) TO 
           progmag-key01-SPLITBUF(4:6)
           MOVE prg-tipo-imballo OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(10:3)
           MOVE prg-peso OF progmag(1:8) TO progmag-key01-SPLITBUF(13:8)
           .

       DataSet1-progmag-INITSTART.
           IF DataSet1-progmag-KEY-Asc
              MOVE Low-Value TO prg-chiave OF progmag
           ELSE
              MOVE High-Value TO prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-INITEND.
           IF DataSet1-progmag-KEY-Asc
              MOVE High-Value TO prg-chiave OF progmag
           ELSE
              MOVE Low-Value TO prg-chiave OF progmag
           END-IF
           .

      * progmag
       DataSet1-progmag-START.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY >= prg-chiave OF progmag
           ELSE
              START progmag KEY <= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-NOTGREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY <= prg-chiave OF progmag
           ELSE
              START progmag KEY >= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-GREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY > prg-chiave OF progmag
           ELSE
              START progmag KEY < prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-LESS.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY < prg-chiave OF progmag
           ELSE
              START progmag KEY > prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-progmag-LOCK
              READ progmag WITH LOCK 
              KEY prg-chiave OF progmag
           ELSE
              READ progmag WITH NO LOCK 
              KEY prg-chiave OF progmag
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT 
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timballi-INITSTART.
           IF DataSet1-timballi-KEY-Asc
              MOVE Low-Value TO imb-chiave
           ELSE
              MOVE High-Value TO imb-chiave
           END-IF
           .

       DataSet1-timballi-INITEND.
           IF DataSet1-timballi-KEY-Asc
              MOVE High-Value TO imb-chiave
           ELSE
              MOVE Low-Value TO imb-chiave
           END-IF
           .

      * timballi
       DataSet1-timballi-START.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY >= imb-chiave
           ELSE
              START timballi KEY <= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-NOTGREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY <= imb-chiave
           ELSE
              START timballi KEY >= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-GREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY > imb-chiave
           ELSE
              START timballi KEY < imb-chiave
           END-IF
           .

       DataSet1-timballi-START-LESS.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY < imb-chiave
           ELSE
              START timballi KEY > imb-chiave
           END-IF
           .

       DataSet1-timballi-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timballi-LOCK
              READ timballi WITH LOCK 
              KEY imb-chiave
           ELSE
              READ timballi WITH NO LOCK 
              KEY imb-chiave
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT 
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-INITSTART.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE Low-Value TO imq-chiave
           ELSE
              MOVE High-Value TO imq-chiave
           END-IF
           .

       DataSet1-timbalqta-INITEND.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE High-Value TO imq-chiave
           ELSE
              MOVE Low-Value TO imq-chiave
           END-IF
           .

      * timbalqta
       DataSet1-timbalqta-START.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY >= imq-chiave
           ELSE
              START timbalqta KEY <= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-NOTGREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY <= imq-chiave
           ELSE
              START timbalqta KEY >= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-GREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY > imq-chiave
           ELSE
              START timbalqta KEY < imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-LESS.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY < imq-chiave
           ELSE
              START timbalqta KEY > imq-chiave
           END-IF
           .

       DataSet1-timbalqta-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timbalqta-LOCK
              READ timbalqta WITH LOCK 
              KEY imq-chiave
           ELSE
              READ timbalqta WITH NO LOCK 
              KEY imq-chiave
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT 
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-INITSTART.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE Low-Value TO mag-chiave
           ELSE
              MOVE High-Value TO mag-chiave
           END-IF
           .

       DataSet1-tmagaz-INITEND.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE High-Value TO mag-chiave
           ELSE
              MOVE Low-Value TO mag-chiave
           END-IF
           .

      * tmagaz
       DataSet1-tmagaz-START.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY >= mag-chiave
           ELSE
              START tmagaz KEY <= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-NOTGREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY <= mag-chiave
           ELSE
              START tmagaz KEY >= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-GREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY > mag-chiave
           ELSE
              START tmagaz KEY < mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-LESS.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY < mag-chiave
           ELSE
              START tmagaz KEY > mag-chiave
           END-IF
           .

       DataSet1-tmagaz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmagaz-LOCK
              READ tmagaz WITH LOCK 
              KEY mag-chiave
           ELSE
              READ tmagaz WITH NO LOCK 
              KEY mag-chiave
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT 
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-INITSTART.
           IF DataSet1-pagbloc-KEY-Asc
              MOVE Low-Value TO pgb-chiave
           ELSE
              MOVE High-Value TO pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-INITEND.
           IF DataSet1-pagbloc-KEY-Asc
              MOVE High-Value TO pgb-chiave
           ELSE
              MOVE Low-Value TO pgb-chiave
           END-IF
           .

      * pagbloc
       DataSet1-pagbloc-START.
           IF DataSet1-pagbloc-KEY-Asc
              START pagbloc KEY >= pgb-chiave
           ELSE
              START pagbloc KEY <= pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-START-NOTGREATER.
           IF DataSet1-pagbloc-KEY-Asc
              START pagbloc KEY <= pgb-chiave
           ELSE
              START pagbloc KEY >= pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-START-GREATER.
           IF DataSet1-pagbloc-KEY-Asc
              START pagbloc KEY > pgb-chiave
           ELSE
              START pagbloc KEY < pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-START-LESS.
           IF DataSet1-pagbloc-KEY-Asc
              START pagbloc KEY < pgb-chiave
           ELSE
              START pagbloc KEY > pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-pagbloc-LOCK
              READ pagbloc WITH LOCK 
              KEY pgb-chiave
           ELSE
              READ pagbloc WITH NO LOCK 
              KEY pgb-chiave
           END-IF
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT 
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-pagbloc-KEY-Asc
              IF DataSet1-pagbloc-LOCK
                 READ pagbloc NEXT WITH LOCK
              ELSE
                 READ pagbloc NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-pagbloc-LOCK
                 READ pagbloc PREVIOUS WITH LOCK
              ELSE
                 READ pagbloc PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-pagbloc-KEY-Asc
              IF DataSet1-pagbloc-LOCK
                 READ pagbloc PREVIOUS WITH LOCK
              ELSE
                 READ pagbloc PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-pagbloc-LOCK
                 READ pagbloc NEXT WITH LOCK
              ELSE
                 READ pagbloc NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterDelete>
      * <TOTEM:END>
           .

       EDI-clides-ecd-k-orders-MERGE-SPLITBUF.
           INITIALIZE EDI-clides-ecd-k-orders-SPLITBUF
           MOVE ecd-cod-dest(1:17) TO 
           EDI-clides-ecd-k-orders-SPLITBUF(1:17)
           MOVE ecd-cod-consegna(1:17) TO 
           EDI-clides-ecd-k-orders-SPLITBUF(18:17)
           .

       DataSet1-EDI-clides-INITSTART.
           IF DataSet1-EDI-clides-KEY-Asc
              MOVE Low-Value TO ecd-chiave
           ELSE
              MOVE High-Value TO ecd-chiave
           END-IF
           .

       DataSet1-EDI-clides-INITEND.
           IF DataSet1-EDI-clides-KEY-Asc
              MOVE High-Value TO ecd-chiave
           ELSE
              MOVE Low-Value TO ecd-chiave
           END-IF
           .

      * EDI-clides
       DataSet1-EDI-clides-START.
           IF DataSet1-EDI-clides-KEY-Asc
              START EDI-clides KEY >= ecd-chiave
           ELSE
              START EDI-clides KEY <= ecd-chiave
           END-IF
           .

       DataSet1-EDI-clides-START-NOTGREATER.
           IF DataSet1-EDI-clides-KEY-Asc
              START EDI-clides KEY <= ecd-chiave
           ELSE
              START EDI-clides KEY >= ecd-chiave
           END-IF
           .

       DataSet1-EDI-clides-START-GREATER.
           IF DataSet1-EDI-clides-KEY-Asc
              START EDI-clides KEY > ecd-chiave
           ELSE
              START EDI-clides KEY < ecd-chiave
           END-IF
           .

       DataSet1-EDI-clides-START-LESS.
           IF DataSet1-EDI-clides-KEY-Asc
              START EDI-clides KEY < ecd-chiave
           ELSE
              START EDI-clides KEY > ecd-chiave
           END-IF
           .

       DataSet1-EDI-clides-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-EDI-clides-LOCK
              READ EDI-clides WITH LOCK 
              KEY ecd-chiave
           ELSE
              READ EDI-clides WITH NO LOCK 
              KEY ecd-chiave
           END-IF
           PERFORM EDI-clides-ecd-k-orders-MERGE-SPLITBUF
           MOVE STATUS-EDI-clides TO TOTEM-ERR-STAT 
           MOVE "EDI-clides" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-EDI-clides-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-EDI-clides-KEY-Asc
              IF DataSet1-EDI-clides-LOCK
                 READ EDI-clides NEXT WITH LOCK
              ELSE
                 READ EDI-clides NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-EDI-clides-LOCK
                 READ EDI-clides PREVIOUS WITH LOCK
              ELSE
                 READ EDI-clides PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM EDI-clides-ecd-k-orders-MERGE-SPLITBUF
           MOVE STATUS-EDI-clides TO TOTEM-ERR-STAT
           MOVE "EDI-clides" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-EDI-clides-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-EDI-clides-KEY-Asc
              IF DataSet1-EDI-clides-LOCK
                 READ EDI-clides PREVIOUS WITH LOCK
              ELSE
                 READ EDI-clides PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-EDI-clides-LOCK
                 READ EDI-clides NEXT WITH LOCK
              ELSE
                 READ EDI-clides NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM EDI-clides-ecd-k-orders-MERGE-SPLITBUF
           MOVE STATUS-EDI-clides TO TOTEM-ERR-STAT
           MOVE "EDI-clides" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-EDI-clides-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, BeforeWrite>
      * <TOTEM:END>
           WRITE ecd-rec OF EDI-clides.
           MOVE STATUS-EDI-clides TO TOTEM-ERR-STAT
           MOVE "EDI-clides" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-EDI-clides-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, BeforeRewrite>
      * <TOTEM:END>
           REWRITE ecd-rec OF EDI-clides.
           MOVE STATUS-EDI-clides TO TOTEM-ERR-STAT
           MOVE "EDI-clides" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-EDI-clides-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, BeforeDelete>
      * <TOTEM:END>
           DELETE EDI-clides.
           MOVE STATUS-EDI-clides TO TOTEM-ERR-STAT
           MOVE "EDI-clides" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:EDI-clides, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-agenti-INITSTART.
           IF DataSet1-agenti-KEY-Asc
              MOVE Low-Value TO age-chiave
           ELSE
              MOVE High-Value TO age-chiave
           END-IF
           .

       DataSet1-agenti-INITEND.
           IF DataSet1-agenti-KEY-Asc
              MOVE High-Value TO age-chiave
           ELSE
              MOVE Low-Value TO age-chiave
           END-IF
           .

      * agenti
       DataSet1-agenti-START.
           IF DataSet1-agenti-KEY-Asc
              START agenti KEY >= age-chiave
           ELSE
              START agenti KEY <= age-chiave
           END-IF
           .

       DataSet1-agenti-START-NOTGREATER.
           IF DataSet1-agenti-KEY-Asc
              START agenti KEY <= age-chiave
           ELSE
              START agenti KEY >= age-chiave
           END-IF
           .

       DataSet1-agenti-START-GREATER.
           IF DataSet1-agenti-KEY-Asc
              START agenti KEY > age-chiave
           ELSE
              START agenti KEY < age-chiave
           END-IF
           .

       DataSet1-agenti-START-LESS.
           IF DataSet1-agenti-KEY-Asc
              START agenti KEY < age-chiave
           ELSE
              START agenti KEY > age-chiave
           END-IF
           .

       DataSet1-agenti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-agenti-LOCK
              READ agenti WITH LOCK 
              KEY age-chiave
           ELSE
              READ agenti WITH NO LOCK 
              KEY age-chiave
           END-IF
           MOVE STATUS-agenti TO TOTEM-ERR-STAT 
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-agenti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-agenti-KEY-Asc
              IF DataSet1-agenti-LOCK
                 READ agenti NEXT WITH LOCK
              ELSE
                 READ agenti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-agenti-LOCK
                 READ agenti PREVIOUS WITH LOCK
              ELSE
                 READ agenti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-agenti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-agenti-KEY-Asc
              IF DataSet1-agenti-LOCK
                 READ agenti PREVIOUS WITH LOCK
              ELSE
                 READ agenti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-agenti-LOCK
                 READ agenti NEXT WITH LOCK
              ELSE
                 READ agenti NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-agenti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-agenti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-agenti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-note-INITSTART.
           IF DataSet1-note-KEY-Asc
              MOVE Low-Value TO not-chiave OF note
           ELSE
              MOVE High-Value TO not-chiave OF note
           END-IF
           .

       DataSet1-note-INITEND.
           IF DataSet1-note-KEY-Asc
              MOVE High-Value TO not-chiave OF note
           ELSE
              MOVE Low-Value TO not-chiave OF note
           END-IF
           .

      * note
       DataSet1-note-START.
           IF DataSet1-note-KEY-Asc
              START note KEY >= not-chiave OF note
           ELSE
              START note KEY <= not-chiave OF note
           END-IF
           .

       DataSet1-note-START-NOTGREATER.
           IF DataSet1-note-KEY-Asc
              START note KEY <= not-chiave OF note
           ELSE
              START note KEY >= not-chiave OF note
           END-IF
           .

       DataSet1-note-START-GREATER.
           IF DataSet1-note-KEY-Asc
              START note KEY > not-chiave OF note
           ELSE
              START note KEY < not-chiave OF note
           END-IF
           .

       DataSet1-note-START-LESS.
           IF DataSet1-note-KEY-Asc
              START note KEY < not-chiave OF note
           ELSE
              START note KEY > not-chiave OF note
           END-IF
           .

       DataSet1-note-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeRead>
           initialize dataset1-note-lock-flag.

           .
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-note-LOCK
              READ note WITH LOCK 
              KEY not-chiave OF note
           ELSE
              READ note WITH NO LOCK 
              KEY not-chiave OF note
           END-IF
           MOVE STATUS-note TO TOTEM-ERR-STAT 
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-note-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeRead>
           initialize dataset1-note-lock-flag.

           .
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-note-KEY-Asc
              IF DataSet1-note-LOCK
                 READ note NEXT WITH LOCK
              ELSE
                 READ note NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-note-LOCK
                 READ note PREVIOUS WITH LOCK
              ELSE
                 READ note PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-note-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeRead>
           initialize dataset1-note-lock-flag.

           .
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-note-KEY-Asc
              IF DataSet1-note-LOCK
                 READ note PREVIOUS WITH LOCK
              ELSE
                 READ note PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-note-LOCK
                 READ note NEXT WITH LOCK
              ELSE
                 READ note NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-note-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeWrite>
      * <TOTEM:END>
           WRITE not-rec OF note.
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-note-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeRewrite>
      * <TOTEM:END>
           REWRITE not-rec OF note.
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-note-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeDelete>
      * <TOTEM:END>
           DELETE note.
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-note1-INITSTART.
           IF DataSet1-note1-KEY-Asc
              MOVE Low-Value TO not-chiave OF note1
           ELSE
              MOVE High-Value TO not-chiave OF note1
           END-IF
           .

       DataSet1-note1-INITEND.
           IF DataSet1-note1-KEY-Asc
              MOVE High-Value TO not-chiave OF note1
           ELSE
              MOVE Low-Value TO not-chiave OF note1
           END-IF
           .

      * note1
       DataSet1-note1-START.
           IF DataSet1-note1-KEY-Asc
              START note1 KEY >= not-chiave OF note1
           ELSE
              START note1 KEY <= not-chiave OF note1
           END-IF
           .

       DataSet1-note1-START-NOTGREATER.
           IF DataSet1-note1-KEY-Asc
              START note1 KEY <= not-chiave OF note1
           ELSE
              START note1 KEY >= not-chiave OF note1
           END-IF
           .

       DataSet1-note1-START-GREATER.
           IF DataSet1-note1-KEY-Asc
              START note1 KEY > not-chiave OF note1
           ELSE
              START note1 KEY < not-chiave OF note1
           END-IF
           .

       DataSet1-note1-START-LESS.
           IF DataSet1-note1-KEY-Asc
              START note1 KEY < not-chiave OF note1
           ELSE
              START note1 KEY > not-chiave OF note1
           END-IF
           .

       DataSet1-note1-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:note1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note1, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-note1-LOCK
              READ note1 WITH LOCK 
              KEY not-chiave OF note1
           ELSE
              READ note1 WITH NO LOCK 
              KEY not-chiave OF note1
           END-IF
           MOVE STATUS-note2 TO TOTEM-ERR-STAT 
           MOVE "note1" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note1, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-note1-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:note1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note1, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-note1-KEY-Asc
              IF DataSet1-note1-LOCK
                 READ note1 NEXT WITH LOCK
              ELSE
                 READ note1 NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-note1-LOCK
                 READ note1 PREVIOUS WITH LOCK
              ELSE
                 READ note1 PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-note2 TO TOTEM-ERR-STAT
           MOVE "note1" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note1, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-note1-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:note1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note1, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-note1-KEY-Asc
              IF DataSet1-note1-LOCK
                 READ note1 PREVIOUS WITH LOCK
              ELSE
                 READ note1 PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-note1-LOCK
                 READ note1 NEXT WITH LOCK
              ELSE
                 READ note1 NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-note2 TO TOTEM-ERR-STAT
           MOVE "note1" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note1, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-note1-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:note1, BeforeWrite>
      * <TOTEM:END>
           WRITE not-rec OF note1.
           MOVE STATUS-note2 TO TOTEM-ERR-STAT
           MOVE "note1" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note1, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-note1-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:note1, BeforeRewrite>
      * <TOTEM:END>
           REWRITE not-rec OF note1.
           MOVE STATUS-note2 TO TOTEM-ERR-STAT
           MOVE "note1" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note1, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-note1-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:note1, BeforeDelete>
      * <TOTEM:END>
           DELETE note1.
           MOVE STATUS-note2 TO TOTEM-ERR-STAT
           MOVE "note1" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note1, AfterDelete>
      * <TOTEM:END>
           .

       clienti-cli-K1-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K1-SPLITBUF
           MOVE cli-tipo-CF OF clienti(1:1) TO 
           clienti-cli-K1-SPLITBUF(1:1)
           MOVE cli-ragsoc-1 OF clienti(1:40) TO 
           clienti-cli-K1-SPLITBUF(2:40)
           MOVE cli-codice OF clienti(1:5) TO 
           clienti-cli-K1-SPLITBUF(42:5)
           .

       clienti-cli-K3-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K3-SPLITBUF
           MOVE cli-gdo OF clienti(1:5) TO clienti-cli-K3-SPLITBUF(1:5)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K3-SPLITBUF(6:6)
           .

       clienti-cli-K4-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K4-SPLITBUF
           MOVE cli-utf OF clienti(1:1) TO clienti-cli-K4-SPLITBUF(1:1)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K4-SPLITBUF(2:6)
           .

       DataSet1-clienti-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-clienti-KEY1-Asc
                 MOVE cli-min-value TO cli-chiave OF clienti
              ELSE
                 MOVE cli-max-value TO cli-chiave OF clienti
              END-IF
           WHEN 2
              IF DataSet1-clienti-KEY2-Asc
                 MOVE Low-Value TO cli-ragsoc-1 OF clienti
              ELSE
                 MOVE High-Value TO cli-ragsoc-1 OF clienti
              END-IF
           END-EVALUATE
           .

       DataSet1-clienti-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-clienti-KEY1-Asc
                 MOVE cli-max-value TO cli-chiave OF clienti
              ELSE
                 MOVE cli-min-value TO cli-chiave OF clienti
              END-IF
           WHEN 2
              IF DataSet1-clienti-KEY2-Asc
                 MOVE High-Value TO cli-ragsoc-1 OF clienti
              ELSE
                 MOVE Low-Value TO cli-ragsoc-1 OF clienti
              END-IF
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-CHANGETO-KEY2.
           MOVE 2 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-clienti-KEY1-ORDER
           WHEN 2
              MOVE "A" TO DataSet1-clienti-KEY2-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-clienti-KEY1-ORDER
           WHEN 2
              MOVE "D" TO DataSet1-clienti-KEY2-ORDER
           END-EVALUATE
           .

      * clienti
       DataSet1-clienti-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-clienti-KEY1-Asc
                 START clienti KEY >= cli-chiave OF clienti
              ELSE
                 START clienti KEY <= cli-chiave OF clienti
              END-IF
           WHEN 2
              IF DataSet1-clienti-KEY2-Asc
                 START clienti KEY >= cli-ragsoc-1 OF clienti
              ELSE
                 START clienti KEY <= cli-ragsoc-1 OF clienti
              END-IF
           END-EVALUATE
           .

       DataSet1-clienti-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-clienti-KEY1-Asc
                 START clienti KEY <= cli-chiave OF clienti
              ELSE
                 START clienti KEY >= cli-chiave OF clienti
              END-IF
           WHEN 2
              IF DataSet1-clienti-KEY2-Asc
                 START clienti KEY <= cli-ragsoc-1 OF clienti
              ELSE
                 START clienti KEY >= cli-ragsoc-1 OF clienti
              END-IF
           END-EVALUATE
           .

       DataSet1-clienti-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-clienti-KEY1-Asc
                 START clienti KEY > cli-chiave OF clienti
              ELSE
                 START clienti KEY < cli-chiave OF clienti
              END-IF
           WHEN 2
              IF DataSet1-clienti-KEY2-Asc
                 START clienti KEY > cli-ragsoc-1 OF clienti
              ELSE
                 START clienti KEY < cli-ragsoc-1 OF clienti
              END-IF
           END-EVALUATE
           .

       DataSet1-clienti-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-clienti-KEY1-Asc
                 START clienti KEY < cli-chiave OF clienti
              ELSE
                 START clienti KEY > cli-chiave OF clienti
              END-IF
           WHEN 2
              IF DataSet1-clienti-KEY2-Asc
                 START clienti KEY < cli-ragsoc-1 OF clienti
              ELSE
                 START clienti KEY > cli-ragsoc-1 OF clienti
              END-IF
           END-EVALUATE
           .

       DataSet1-clienti-START-EQUAL.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              START clienti KEY = cli-ragsoc-1 OF clienti
           END-EVALUATE
           .

       DataSet1-clienti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
           if mod = 1
              set dataset1-clienti-lock to true
           else
              initialize dataset1-clienti-lock-flag
           end-if.

           .
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-clienti-LOCK
                 READ clienti WITH LOCK 
                 KEY cli-chiave OF clienti
              ELSE
                 READ clienti WITH NO LOCK 
                 KEY cli-chiave OF clienti
              END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
      * Check Start/End Value
              IF STATUS-clienti(1:1) = "0" AND
                        NOT (cli-chiave >= cli-min-value AND cli-chiave 
           <= cli-max-value)
                   MOVE 23 TO STATUS-clienti
              END-IF
           WHEN 2
              IF DataSet1-clienti-LOCK
                 READ clienti WITH LOCK 
                 KEY cli-ragsoc-1 OF clienti
              ELSE
                 READ clienti WITH NO LOCK 
                 KEY cli-ragsoc-1 OF clienti
              END-IF
           END-EVALUATE
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT 
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
           if mod = 1
              set dataset1-clienti-lock to true
           else
              initialize dataset1-clienti-lock-flag
           end-if.

           .
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-clienti-KEY1-Asc
                 IF DataSet1-clienti-LOCK
                    READ clienti NEXT WITH LOCK
                 ELSE
                    READ clienti NEXT WITH NO LOCK
                 END-IF
                 PERFORM DataSet1-clienti-CHECK-VALUES-NEXT
              ELSE
                 IF DataSet1-clienti-LOCK
                    READ clienti PREVIOUS WITH LOCK
                 ELSE
                    READ clienti PREVIOUS WITH NO LOCK
                 END-IF
                 PERFORM DataSet1-clienti-CHECK-VALUES-PREV
              END-IF
           WHEN 2
              IF DataSet1-clienti-KEY2-Asc
                 IF DataSet1-clienti-LOCK
                    READ clienti NEXT WITH LOCK
                 ELSE
                    READ clienti NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-clienti-LOCK
                    READ clienti PREVIOUS WITH LOCK
                 ELSE
                    READ clienti PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
           if mod = 1
              set dataset1-clienti-lock to true
           else
              initialize dataset1-clienti-lock-flag
           end-if.

           .
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-clienti-KEY1-Asc
                 IF DataSet1-clienti-LOCK
                    READ clienti PREVIOUS WITH LOCK
                 ELSE
                    READ clienti PREVIOUS WITH NO LOCK
                 END-IF
                 PERFORM DataSet1-clienti-CHECK-VALUES-PREV
              ELSE
                 IF DataSet1-clienti-LOCK
                    READ clienti NEXT WITH LOCK
                 ELSE
                    READ clienti NEXT WITH NO LOCK
                 END-IF
                 PERFORM DataSet1-clienti-CHECK-VALUES-NEXT
              END-IF
           WHEN 2
              IF DataSet1-clienti-KEY2-Asc
                 IF DataSet1-clienti-LOCK
                    READ clienti PREVIOUS WITH LOCK
                 ELSE
                    READ clienti PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-clienti-LOCK
                    READ clienti NEXT WITH LOCK
                 ELSE
                    READ clienti NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeWrite>
      * <TOTEM:END>
           WRITE cli-rec OF clienti.
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRewrite>
      * <TOTEM:END>
           REWRITE cli-rec OF clienti.
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeDelete>
      * <TOTEM:END>
           DELETE clienti.
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-clienti-CHECK-VALUES-NEXT.
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
      * Check Start/End Value
              PERFORM UNTIL STATUS-clienti(1:1) NOT = "0" OR
                      (STATUS-clienti(1:1) = "0" AND (cli-chiave >= 
           cli-min-value AND cli-chiave <= cli-max-value))
                 IF cli-chiave > cli-max-value
                    MOVE "10" TO STATUS-clienti
                 ELSE
                    IF DataSet1-clienti-KEY1-Asc
                       IF DataSet1-clienti-LOCK
                          READ clienti NEXT WITH LOCK
                       ELSE
                          READ clienti NEXT WITH NO LOCK
                       END-IF
                    ELSE
                       IF DataSet1-clienti-LOCK
                          READ clienti PREVIOUS WITH LOCK
                       ELSE
                          READ clienti PREVIOUS WITH NO LOCK
                       END-IF
                    END-IF
                 END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
              END-PERFORM
           .
           
       DataSet1-clienti-CHECK-VALUES-PREV.
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
      * Check Start/End Value
              PERFORM UNTIL STATUS-clienti(1:1) NOT = "0" OR
                      (STATUS-clienti(1:1) = "0" AND (cli-chiave >= 
           cli-min-value AND cli-chiave <= cli-max-value))
                 IF cli-chiave < cli-min-value
                    MOVE "10" TO STATUS-clienti
                 ELSE
                    IF DataSet1-clienti-KEY1-Asc
                       IF DataSet1-clienti-LOCK
                          READ clienti PREVIOUS WITH LOCK
                       ELSE
                          READ clienti PREVIOUS WITH NO LOCK
                       END-IF
                    ELSE
                       IF DataSet1-clienti-LOCK
                          READ clienti NEXT WITH LOCK
                       ELSE
                          READ clienti NEXT WITH NO LOCK
                       END-IF
                    END-IF
                 END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
              END-PERFORM
           .
           
       DataSet1-grade-INITSTART.
           IF DataSet1-grade-KEY-Asc
              MOVE Low-Value TO gra-chiave
           ELSE
              MOVE High-Value TO gra-chiave
           END-IF
           .

       DataSet1-grade-INITEND.
           IF DataSet1-grade-KEY-Asc
              MOVE High-Value TO gra-chiave
           ELSE
              MOVE Low-Value TO gra-chiave
           END-IF
           .

      * grade
       DataSet1-grade-START.
           IF DataSet1-grade-KEY-Asc
              START grade KEY >= gra-chiave
           ELSE
              START grade KEY <= gra-chiave
           END-IF
           .

       DataSet1-grade-START-NOTGREATER.
           IF DataSet1-grade-KEY-Asc
              START grade KEY <= gra-chiave
           ELSE
              START grade KEY >= gra-chiave
           END-IF
           .

       DataSet1-grade-START-GREATER.
           IF DataSet1-grade-KEY-Asc
              START grade KEY > gra-chiave
           ELSE
              START grade KEY < gra-chiave
           END-IF
           .

       DataSet1-grade-START-LESS.
           IF DataSet1-grade-KEY-Asc
              START grade KEY < gra-chiave
           ELSE
              START grade KEY > gra-chiave
           END-IF
           .

       DataSet1-grade-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-grade-LOCK
              READ grade WITH LOCK 
              KEY gra-chiave
           ELSE
              READ grade WITH NO LOCK 
              KEY gra-chiave
           END-IF
           MOVE STATUS-grade TO TOTEM-ERR-STAT 
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-grade-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-grade-KEY-Asc
              IF DataSet1-grade-LOCK
                 READ grade NEXT WITH LOCK
              ELSE
                 READ grade NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-grade-LOCK
                 READ grade PREVIOUS WITH LOCK
              ELSE
                 READ grade PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-grade-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-grade-KEY-Asc
              IF DataSet1-grade-LOCK
                 READ grade PREVIOUS WITH LOCK
              ELSE
                 READ grade PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-grade-LOCK
                 READ grade NEXT WITH LOCK
              ELSE
                 READ grade NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-grade-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-grade-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-grade-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterDelete>
      * <TOTEM:END>
           .

       anacap-k-prov-MERGE-SPLITBUF.
           INITIALIZE anacap-k-prov-SPLITBUF
           MOVE anc-prov(1:2) TO anacap-k-prov-SPLITBUF(1:2)
           MOVE anc-comune(1:150) TO anacap-k-prov-SPLITBUF(3:150)
           MOVE anc-chiave(1:5) TO anacap-k-prov-SPLITBUF(153:5)
           .

       anacap-k-comune-MERGE-SPLITBUF.
           INITIALIZE anacap-k-comune-SPLITBUF
           MOVE anc-comune(1:150) TO anacap-k-comune-SPLITBUF(1:150)
           MOVE anc-prov(1:2) TO anacap-k-comune-SPLITBUF(151:2)
           MOVE anc-chiave(1:5) TO anacap-k-comune-SPLITBUF(153:5)
           .

       DataSet1-anacap-INITSTART.
           IF DataSet1-anacap-KEY-Asc
              MOVE Low-Value TO anc-chiave
           ELSE
              MOVE High-Value TO anc-chiave
           END-IF
           .

       DataSet1-anacap-INITEND.
           IF DataSet1-anacap-KEY-Asc
              MOVE High-Value TO anc-chiave
           ELSE
              MOVE Low-Value TO anc-chiave
           END-IF
           .

      * anacap
       DataSet1-anacap-START.
           IF DataSet1-anacap-KEY-Asc
              START anacap KEY >= anc-chiave
           ELSE
              START anacap KEY <= anc-chiave
           END-IF
           .

       DataSet1-anacap-START-NOTGREATER.
           IF DataSet1-anacap-KEY-Asc
              START anacap KEY <= anc-chiave
           ELSE
              START anacap KEY >= anc-chiave
           END-IF
           .

       DataSet1-anacap-START-GREATER.
           IF DataSet1-anacap-KEY-Asc
              START anacap KEY > anc-chiave
           ELSE
              START anacap KEY < anc-chiave
           END-IF
           .

       DataSet1-anacap-START-LESS.
           IF DataSet1-anacap-KEY-Asc
              START anacap KEY < anc-chiave
           ELSE
              START anacap KEY > anc-chiave
           END-IF
           .

       DataSet1-anacap-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-anacap-LOCK
              READ anacap WITH LOCK 
              KEY anc-chiave
           ELSE
              READ anacap WITH NO LOCK 
              KEY anc-chiave
           END-IF
           PERFORM anacap-k-prov-MERGE-SPLITBUF
           PERFORM anacap-k-comune-MERGE-SPLITBUF
           MOVE STATUS-anacap TO TOTEM-ERR-STAT 
           MOVE "anacap" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-anacap-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-anacap-KEY-Asc
              IF DataSet1-anacap-LOCK
                 READ anacap NEXT WITH LOCK
              ELSE
                 READ anacap NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-anacap-LOCK
                 READ anacap PREVIOUS WITH LOCK
              ELSE
                 READ anacap PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM anacap-k-prov-MERGE-SPLITBUF
           PERFORM anacap-k-comune-MERGE-SPLITBUF
           MOVE STATUS-anacap TO TOTEM-ERR-STAT
           MOVE "anacap" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-anacap-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-anacap-KEY-Asc
              IF DataSet1-anacap-LOCK
                 READ anacap PREVIOUS WITH LOCK
              ELSE
                 READ anacap PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-anacap-LOCK
                 READ anacap NEXT WITH LOCK
              ELSE
                 READ anacap NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM anacap-k-prov-MERGE-SPLITBUF
           PERFORM anacap-k-comune-MERGE-SPLITBUF
           MOVE STATUS-anacap TO TOTEM-ERR-STAT
           MOVE "anacap" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-anacap-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-anacap TO TOTEM-ERR-STAT
           MOVE "anacap" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-anacap-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-anacap TO TOTEM-ERR-STAT
           MOVE "anacap" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-anacap-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-anacap TO TOTEM-ERR-STAT
           MOVE "anacap" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:anacap, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-notec-INITSTART.
           IF DataSet1-notec-KEY-Asc
              MOVE Low-Value TO notc-chiave
           ELSE
              MOVE High-Value TO notc-chiave
           END-IF
           .

       DataSet1-notec-INITEND.
           IF DataSet1-notec-KEY-Asc
              MOVE High-Value TO notc-chiave
           ELSE
              MOVE Low-Value TO notc-chiave
           END-IF
           .

      * notec
       DataSet1-notec-START.
           IF DataSet1-notec-KEY-Asc
              START notec KEY >= notc-chiave
           ELSE
              START notec KEY <= notc-chiave
           END-IF
           .

       DataSet1-notec-START-NOTGREATER.
           IF DataSet1-notec-KEY-Asc
              START notec KEY <= notc-chiave
           ELSE
              START notec KEY >= notc-chiave
           END-IF
           .

       DataSet1-notec-START-GREATER.
           IF DataSet1-notec-KEY-Asc
              START notec KEY > notc-chiave
           ELSE
              START notec KEY < notc-chiave
           END-IF
           .

       DataSet1-notec-START-LESS.
           IF DataSet1-notec-KEY-Asc
              START notec KEY < notc-chiave
           ELSE
              START notec KEY > notc-chiave
           END-IF
           .

       DataSet1-notec-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:notec, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:notec, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-notec-LOCK
              READ notec WITH LOCK 
              KEY notc-chiave
           ELSE
              READ notec WITH NO LOCK 
              KEY notc-chiave
           END-IF
           MOVE STATUS-notec TO TOTEM-ERR-STAT 
           MOVE "notec" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:notec, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:notec, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-notec-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:notec, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:notec, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-notec-KEY-Asc
              IF DataSet1-notec-LOCK
                 READ notec NEXT WITH LOCK
              ELSE
                 READ notec NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-notec-LOCK
                 READ notec PREVIOUS WITH LOCK
              ELSE
                 READ notec PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-notec TO TOTEM-ERR-STAT
           MOVE "notec" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:notec, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:notec, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-notec-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:notec, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:notec, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-notec-KEY-Asc
              IF DataSet1-notec-LOCK
                 READ notec PREVIOUS WITH LOCK
              ELSE
                 READ notec PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-notec-LOCK
                 READ notec NEXT WITH LOCK
              ELSE
                 READ notec NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-notec TO TOTEM-ERR-STAT
           MOVE "notec" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:notec, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:notec, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-notec-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:notec, BeforeWrite>
      * <TOTEM:END>
           WRITE notc-rec OF notec.
           MOVE STATUS-notec TO TOTEM-ERR-STAT
           MOVE "notec" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:notec, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-notec-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:notec, BeforeRewrite>
      * <TOTEM:END>
           REWRITE notc-rec OF notec.
           MOVE STATUS-notec TO TOTEM-ERR-STAT
           MOVE "notec" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:notec, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-notec-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:notec, BeforeDelete>
      * <TOTEM:END>
           DELETE notec.
           MOVE STATUS-notec TO TOTEM-ERR-STAT
           MOVE "notec" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:notec, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE vet-rec OF tvettori
           INITIALIZE naz-rec OF tnazioni
           INITIALIZE des-rec OF destini
           INITIALIZE rec-rec OF recapiti
           INITIALIZE tcl-rec OF ttipocli
           INITIALIZE gdo-rec OF tgrupgdo
           INITIALIZE reg-rec OF tregioni
           INITIALIZE prv-rec OF tprov
           INITIALIZE record-tblpa OF tcodpag
           INITIALIZE record-tbliv OF tivaese
           INITIALIZE RECORD-ABI OF ABI
           INITIALIZE tge-rec OF tparamge
           INITIALIZE lck-rec OF lockfile
           INITIALIZE ecd-rec-OLD OF evaclides
           INITIALIZE tpa-rec OF tparameva
           INITIALIZE cp-rec OF cli-prg
           INITIALIZE art-rec OF articoli
           INITIALIZE prg-rec OF progmag
           INITIALIZE imb-rec OF timballi
           INITIALIZE imq-rec OF timbalqta
           INITIALIZE mag-rec OF tmagaz
           INITIALIZE pgb-rec OF pagbloc
           INITIALIZE ecd-rec OF EDI-clides
           INITIALIZE age-rec OF agenti
           INITIALIZE not-rec OF note
           INITIALIZE not-rec OF note1
           INITIALIZE cli-rec OF clienti
           INITIALIZE gra-rec OF grade
           INITIALIZE anc-rec OF anacap
           INITIALIZE notc-rec OF notec
           .


      * COMBO-BOX
       cbo-stato-Content.
           .

      * COMBO-BOX
       cbo-cau-blocco-Content.
           .

      * COMBO-BOX
       cbo-sost-art-Content.
           .

      * COMBO-BOX
       cbo-tipo-art-Content.
           .

      * GRID
       form1-gd-1-Content.
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 1, Y = 1,
                CELL-DATA = "Num",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 2, Y = 1,
                CELL-DATA = "Ragione Sociale",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 3, Y = 1,
                CELL-DATA = "Indirizzo",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 4, Y = 1,
                CELL-DATA = "CAP",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 5, Y = 1,
                CELL-DATA = "Località",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 6, Y = 1,
                CELL-DATA = "Prov.",
           .

      * COMBO-BOX
       cbo-stato-d-Content.
           .

      * COMBO-BOX
       cbo-tipo-art-d-Content.
           .

      * COMBO-BOX
       cbo-invio-Content.
           .

      * GRID
       gd-destini-e-Content.
      * CELLS' SETTING
              MODIFY gd-destini-e, X = 1, Y = 1,
                CELL-DATA = "Codice",
      * CELLS' SETTING
              MODIFY gd-destini-e, X = 2, Y = 1,
                CELL-DATA = "Ragione Sociale",
      * CELLS' SETTING
              MODIFY gd-destini-e, X = 3, Y = 1,
                CELL-DATA = "Indirizzo",
      * CELLS' SETTING
              MODIFY gd-destini-e, X = 4, Y = 1,
                CELL-DATA = "Località",
           .

      * GRID
       gd-evasioni-Content.
      * CELLS' SETTING
              MODIFY gd-evasioni, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-evasioni, X = 2, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-evasioni, X = 3, Y = 1,
                CELL-DATA = "S/N",
           .

      * GRID
       gd-prg-Content.
      * CELLS' SETTING
              MODIFY gd-prg, X = 1, Y = 1,
                CELL-DATA = "Articolo",
      * CELLS' SETTING
              MODIFY gd-prg, X = 2, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-prg, X = 3, Y = 1,
                CELL-DATA = "Magazzino",
      * CELLS' SETTING
              MODIFY gd-prg, X = 4, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-prg, X = 5, Y = 1,
                CELL-DATA = "Imballo",
      * CELLS' SETTING
              MODIFY gd-prg, X = 6, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-prg, X = 7, Y = 1,
                CELL-DATA = "Peso",
           .

      * GRID
       form1-gd-1-edi-Content.
      * CELLS' SETTING
              MODIFY form1-gd-1-edi, X = 1, Y = 1,
                CELL-DATA = "Numero",
      * CELLS' SETTING
              MODIFY form1-gd-1-edi, X = 2, Y = 1,
                CELL-DATA = "Ragione Sociale",
      * CELLS' SETTING
              MODIFY form1-gd-1-edi, X = 3, Y = 1,
                CELL-DATA = "Indirizzo",
      * CELLS' SETTING
              MODIFY form1-gd-1-edi, X = 4, Y = 1,
                CELL-DATA = "C.A.P.",
      * CELLS' SETTING
              MODIFY form1-gd-1-edi, X = 5, Y = 1,
                CELL-DATA = "Località",
      * CELLS' SETTING
              MODIFY form1-gd-1-edi, X = 6, Y = 1,
                CELL-DATA = "Provincia",
           .

       DataSet1-clienti-REF-recapiti-KEY.
           MOVE cli-codice TO rec-codice
           .

       DataSet1-clienti-REF-recapiti.
           PERFORM DataSet1-recapiti-INITREC
           PERFORM DataSet1-clienti-REF-recapiti-KEY
           PERFORM DataSet1-Relation2-EXPRESSION
           PERFORM DataSet1-recapiti-READ
           IF NOT Valid-STATUS-recapiti
              PERFORM DataSet1-recapiti-INITREC
           END-IF
           .

      * RI TYPE : Restricted
       DataSet1-clienti-REF-recapiti-INS.
           .

      * RI TYPE : Restricted
       DataSet1-clienti-REF-recapiti-UPD.
           .

      * RI TYPE : Cascade
       DataSet1-clienti-REF-recapiti-DEL.
      * <TOTEM:EPT. RELATION:DataSet1, RELATION:Relation2, BeforeCascadeDelete>
      * <TOTEM:END>
           PERFORM DataSet1-clienti-REF-recapiti-KEY
           PERFORM DataSet1-Relation2-EXPRESSION
           PERFORM DataSet1-recapiti-Rec-Delete
      * <TOTEM:EPT. RELATION:DataSet1, RELATION:Relation2, AfterCascadeDelete>
      * <TOTEM:END>
           .

       DataSet1-clienti-REF-destini-KEY.
           MOVE cli-codice TO des-codice
           .

       DataSet1-clienti-REF-destini-SUB.
           PERFORM DataSet1-destini-INITREC
           PERFORM DataSet1-destini-READ-NEXT
           .

       DataSet1-clienti-REF-destini.
      * for Each Form
           IF TOTEM-Form-Index = 1 AND TOTEM-Frame-Index = 0
               PERFORM Form1-clienti-REF-destini-P
               EXIT PARAGRAPH
           END-IF
           .

       Form1-clienti-REF-destini-P.
           PERFORM DataSet1-destini-INITREC 
           PERFORM DataSet1-destini-INITSTART
           MOVE des-rec OF destini TO TMP-DataSet1-destini-BUF
           PERFORM DataSet1-clienti-REF-destini-KEY
           PERFORM DataSet1-Relation1-EXPRESSION
           PERFORM DataSet1-destini-START
           IF Valid-STATUS-destini
              PERFORM DataSet1-destini-Read-Next
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-destini
                 OR (Valid-STATUS-destini 
                     AND NOT ( cli-codice = des-codice ))
      * CONDITION : NONE
              IF Valid-STATUS-destini
                 PERFORM Form1-Fld-To-Buf
                 MOVE des-rec OF destini TO
                    TMP-DataSet1-destini-BUF
              ELSE
                 PERFORM DataSet1-destini-INITREC
              END-IF
              PERFORM DataSet1-destini-Read-Next
           END-PERFORM
           MOVE TMP-DataSet1-destini-BUF TO
              des-rec OF destini
           .

       DataSet1-clienti-REF-destini-DEL.
      * for Each Form
           IF TOTEM-Form-Index = 1 AND TOTEM-Frame-Index = 0
               PERFORM Form1-clienti-REF-destini-DEL-P
               EXIT PARAGRAPH
           END-IF
           .

       Form1-clienti-REF-destini-DEL-P.
      * DELETE ALL DATA FROM FD
           INITIALIZE des-chiave
           PERFORM DataSet1-destini-INITSTART
           PERFORM DataSet1-clienti-REF-destini-KEY
           PERFORM DataSet1-Relation1-EXPRESSION
           PERFORM DataSet1-destini-START
           IF Valid-STATUS-destini
              PERFORM DataSet1-destini-Read-Next
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-destini
                 OR (Valid-STATUS-destini 
                     AND NOT ( cli-codice = des-codice ))
      * <TOTEM:EPT. RELATION:DataSet1, RELATION:Relation1, BeforeCascadeDelete>
      * <TOTEM:END>
              PERFORM DataSet1-destini-Rec-Delete
      * <TOTEM:EPT. RELATION:DataSet1, RELATION:Relation1, AfterCascadeDelete>
      * <TOTEM:END>
              PERFORM DataSet1-destini-Read-Next
           END-PERFORM
           .

       DataSet1-Relation1-destini-INSERT.
           PERFORM DataSet1-clienti-REF-destini-KEY
           IF DataSet1-destini-LOCK
              READ destini WITH LOCK KEY des-chiave
           ELSE
              READ destini WITH NO LOCK KEY des-chiave
           END-IF
           PERFORM DataSet1-DISPATCH-BUFTOFLD
           IF Valid-STATUS-destini
              PERFORM DataSet1-destini-Rec-Rewrite
           ELSE
              PERFORM DataSet1-destini-Rec-Write
           END-IF
           .

      * FD's Initialize Paragraph
       DataSet1-tvettori-INITREC.
           INITIALIZE vet-rec OF tvettori
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tnazioni-INITREC.
           INITIALIZE naz-rec OF tnazioni
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-destini-INITREC.
           INITIALIZE des-rec OF destini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-recapiti-INITREC.
           INITIALIZE rec-rec OF recapiti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-ttipocli-INITREC.
           INITIALIZE tcl-rec OF ttipocli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tgrupgdo-INITREC.
           INITIALIZE gdo-rec OF tgrupgdo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tregioni-INITREC.
           INITIALIZE reg-rec OF tregioni
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tprov-INITREC.
           INITIALIZE prv-rec OF tprov
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcodpag-INITREC.
           INITIALIZE record-tblpa OF tcodpag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tivaese-INITREC.
           INITIALIZE record-tbliv OF tivaese
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-ABI-INITREC.
           INITIALIZE RECORD-ABI OF ABI
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tparamge-INITREC.
           INITIALIZE tge-rec OF tparamge
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-lockfile-INITREC.
           INITIALIZE lck-rec OF lockfile
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-evaclides-INITREC.
           INITIALIZE ecd-rec-OLD OF evaclides
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tparameva-INITREC.
           INITIALIZE tpa-rec OF tparameva
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-cli-prg-INITREC.
           INITIALIZE cp-rec OF cli-prg
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-articoli-INITREC.
           INITIALIZE art-rec OF articoli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-progmag-INITREC.
           INITIALIZE prg-rec OF progmag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timballi-INITREC.
           INITIALIZE imb-rec OF timballi
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timbalqta-INITREC.
           INITIALIZE imq-rec OF timbalqta
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmagaz-INITREC.
           INITIALIZE mag-rec OF tmagaz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-pagbloc-INITREC.
           INITIALIZE pgb-rec OF pagbloc
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-EDI-clides-INITREC.
           INITIALIZE ecd-rec OF EDI-clides
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-agenti-INITREC.
           INITIALIZE age-rec OF agenti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-note-INITREC.
           INITIALIZE not-rec OF note
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-note1-INITREC.
           INITIALIZE not-rec OF note1
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-clienti-INITREC.
           INITIALIZE cli-rec OF clienti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           PERFORM DataSet1-recapiti-INITREC
           PERFORM DataSet1-destini-INITREC
           .

      * FD's Initialize Paragraph
       DataSet1-grade-INITREC.
           INITIALIZE gra-rec OF grade
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-anacap-INITREC.
           INITIALIZE anc-rec OF anacap
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-notec-INITREC.
           INITIALIZE notc-rec OF notec
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           EVALUATE TOTEM-Form-Index ALSO TOTEM-Frame-Index
              WHEN 1 ALSO 0
                  PERFORM Form1-Buf-To-Fld
           END-EVALUATE
           .

       DataSet1-Relation2-EXPRESSION.
           .

       DataSet1-Relation1-EXPRESSION.
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              SCREEN LINE 1,
              SCREEN COLUMN 0,
              LINES 59,46,
              SIZE 158,00,
              COLOR 65793,
              CONTROL FONT Small-Font,
              LABEL-OFFSET 23,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE TITOLO,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Form1-Event-Proc,
              HANDLE IS Form1-Handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              GRIP,
              PANEL-WIDTHS (100, 35, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON Form1-Handle
      * DISPLAY-COLUMNS settings
              MODIFY form1-gd-1, DISPLAY-COLUMNS (1, 7, 67, 104, 110, 
           144)
              MODIFY gd-destini-e, DISPLAY-COLUMNS (1, 9, 49, 89)
              MODIFY gd-evasioni, DISPLAY-COLUMNS (1, 6, 50)
              MODIFY gd-prg, DISPLAY-COLUMNS (1, 11, 46, 56, 91, 101, 
           136)
              MODIFY form1-gd-1-edi, DISPLAY-COLUMNS (1, 9, 49, 89, 97, 
           132)
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           perform GCLIENTI-BEFORE-ACCEPT.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
           perform GCLIENTI-AFTER-ENDACCEPT

      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY Form1-Handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
           evaluate key-status
           when 5 |modifica
                inquire tool-modifica, enabled in e-modifica
                if e-modifica = 1
                   if mod = zero move 1 to mod
                   else          move zero to mod
                   end-if
                   modify tool-modifica, value = mod
                   perform MODIFICA
                end-if
           when 10 |ordinamento alfabetico 
                if OrderBy = 0 move 1 to OrderBy
                else           move 0 to OrderBy
                end-if
                modify TOOL-ORD, value OrderBy
                perform ORDINAMENTO
           end-evaluate.

           .
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
                 IF Event-Type = Cmd-Tabchanged AND 
                                 Event-Control-Id = 5000
                    MOVE EVENT-DATA-1 TO Screen1-Ta-1-TAB-VALUE
                    PERFORM Screen1-Ta-1-TABCHANGE
                 END-IF

              WHEN Key-Status = 1001
                 PERFORM pb-note-LinkTo
              WHEN Key-Status = 1008
                 PERFORM pb-espo-LinkTo
              WHEN Key-Status = 1007
                 PERFORM pb-finanz-LinkTo
              WHEN Key-Status = 1000
                 PERFORM pb-nota-pie-LinkTo
              WHEN Key-Status = 75
                 PERFORM pb-note-bolla-LinkTo
              WHEN Key-Status = 1004
                 PERFORM pb-grid-salva-LinkTo
              WHEN Key-Status = 1003
                 PERFORM pb-grid-nuovo-LinkTo
              WHEN Key-Status = 1005
                 PERFORM pb-grid-elimina-LinkTo
              WHEN Key-Status = 1009
                 PERFORM pb-copia-LinkTo
              WHEN Key-Status = 1011
                 PERFORM pb-salva-eva-LinkTo
              WHEN Key-Status = 1012
                 PERFORM pb-grid-nuovo-prg-LinkTo
              WHEN Key-Status = 1032
                 PERFORM pb-grid-elimina-prg-LinkTo
              WHEN Key-Status = 1013
                 PERFORM pb-grid-salva-edi-LinkTo
              WHEN Key-Status = 1014
                 PERFORM pb-ricerca-LinkTo
              WHEN Key-Status = 1010
                 PERFORM pb-stampa-LinkTo
              WHEN Key-Status = 2
                 PERFORM NUOVO-LinkTo
              WHEN Key-Status = 4
                 PERFORM CANCELLA-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
              WHEN Key-Status = 9
                 PERFORM TOOL-SELEZIONA-LinkTo
              WHEN Key-Status = 1002
                 PERFORM TOOL-PRIMO
              WHEN Key-Status = 67
                 PERFORM TOOL-PRECEDENTE
              WHEN Key-Status = 68
                 PERFORM TOOL-SUCCESSIVO
              WHEN Key-Status = 1006
                 PERFORM TOOL-ULTIMO
              WHEN Key-Status = 10
                 PERFORM TOOL-ORD-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON Form1-Handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
           perform SALV-MOD.

           if errori
              move 26 to key-status
              exit paragraph
           end-if.

           .
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           MOVE 1 TO TOTEM-Form-Index
      * TAB
              MODIFY Screen1-Ta-1, RESET-TABS = 1
              MODIFY Screen1-Ta-1, 
           TAB-TO-ADD = (
                 "Dati &Cliente",
                 "&Destini",
                 "&Recapito fatture",
                 "&Evasione",
                 "&Progressivi forzati",
                 "EDI",
                 "Note",
                        )
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
                   Form1-Pg-2-Visible,
                   Form1-Pg-3-Visible,
                   Form1-Pg-4-Visible,
                   Form1-Pg-5-Visible,
                   Form1-Pg-6-Visible,
                   Form1-Pg-7-Visible,
           MOVE 1 TO Form1-Pg-1-Visible
           PERFORM Screen1-Ta-1-TABCHANGE
      * COMBO-BOX
           PERFORM cbo-stato-Content
      * COMBO-BOX
           PERFORM cbo-cau-blocco-Content
      * COMBO-BOX
           PERFORM cbo-sost-art-Content
      * COMBO-BOX
           PERFORM cbo-tipo-art-Content
      * GRID
           PERFORM form1-gd-1-Content
      * COMBO-BOX
           PERFORM cbo-stato-d-Content
      * COMBO-BOX
           PERFORM cbo-tipo-art-d-Content
      * COMBO-BOX
           PERFORM cbo-invio-Content
      * GRID
           PERFORM gd-destini-e-Content
      * GRID
           PERFORM gd-evasioni-Content
      * GRID
           PERFORM gd-prg-Content
      * GRID
           PERFORM form1-gd-1-edi-Content
           .

       Form1-DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-CHANGETO-KEY2.
           MOVE 2 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-clienti-KEY1-ORDER
           WHEN 2
              MOVE "A" TO DataSet1-clienti-KEY2-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-clienti-KEY1-ORDER
           WHEN 2
              MOVE "D" TO DataSet1-clienti-KEY2-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Update-Key.
           MOVE cli-rec OF clienti TO
                     Form1-MULKEY-TMPBUF
           PERFORM Form1-CLEAR
           PERFORM Form1-INIT-DATA
           MOVE Form1-MULKEY-TMPBUF TO
                     cli-rec OF clienti
           PERFORM DataSet1-clienti-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
           .

       Form1-DUPLICATE-PREV.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              IF cli-ragsoc-1 OF clienti = Form1-KEYISTMP2
                 MOVE DataSet1-clienti-KEY2-ORDER TO 
           TMP-Form1-KEY2-ORDER
                 MOVE "A" TO DataSet1-clienti-KEY2-ORDER
                 PERFORM DataSet1-clienti-START-EQUAL
                 IF Valid-STATUS-clienti
                    PERFORM DataSet1-clienti-Read-Next
                    PERFORM UNTIL NOT Valid-STATUS-clienti OR 
                         cli-chiave OF clienti = Form1-PKEYTMP OR
                         cli-ragsoc-1 OF clienti NOT = Form1-KEYISTMP2
                       PERFORM DataSet1-clienti-Read-Next
                    END-PERFORM
                 END-IF
                 MOVE TMP-Form1-KEY2-ORDER TO 
           DataSet1-clienti-KEY2-ORDER
              ELSE
                 PERFORM DataSet1-clienti-START-LESS
              END-IF
           WHEN OTHER
              PERFORM DataSet1-clienti-START-LESS
           END-EVALUATE
           .

       Form1-DUPLICATE-NEXT.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              IF cli-ragsoc-1 OF clienti = Form1-KEYISTMP2
                 MOVE DataSet1-clienti-KEY2-ORDER TO 
           TMP-Form1-KEY2-ORDER
                 MOVE "A" TO DataSet1-clienti-KEY2-ORDER
                 PERFORM DataSet1-clienti-START
                 IF Valid-STATUS-clienti
                    PERFORM DataSet1-clienti-Read-Next
                    PERFORM UNTIL NOT Valid-STATUS-clienti OR 
                         cli-chiave OF clienti = Form1-PKEYTMP OR
                         cli-ragsoc-1 OF clienti NOT = Form1-KEYISTMP2
                       PERFORM DataSet1-clienti-Read-Next
                    END-PERFORM
                 END-IF
                 MOVE TMP-Form1-KEY2-ORDER TO 
           DataSet1-clienti-KEY2-ORDER
              ELSE
                 PERFORM DataSet1-clienti-START-GREATER
              END-IF
           WHEN OTHER
              PERFORM DataSet1-clienti-START-GREATER
           END-EVALUATE
           .

       Form1-DUPLICATE-MOVEKEY.
           MOVE cli-chiave OF clienti TO Form1-PKEYTMP
           EVALUATE DataSet1-KEYIS
           WHEN 2
              MOVE cli-ragsoc-1 OF clienti TO 
                   Form1-KEYISTMP2
           END-EVALUATE
           .

       Form1-First.
           PERFORM Form1-DUMMY-FIRST
           PERFORM DataSet1-clienti-INITSTART
           PERFORM DataSet1-clienti-START
           IF NOT Valid-STATUS-clienti
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFirst>
      * <TOTEM:END>
           PERFORM DataSet1-clienti-Read-Next
           IF NOT Valid-STATUS-clienti
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFirst>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Previous.
              PERFORM Form1-Buf-To-Fld
              PERFORM Form1-DUPLICATE-PREV
           IF NOT Valid-STATUS-clienti
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforePrevious>
      * <TOTEM:END>
           PERFORM DataSet1-clienti-Read-Prev
           IF NOT Valid-STATUS-clienti
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterPrevious>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-PREVIOUS
           PERFORM Form1-IUD-Display
           .

       Form1-Next.
              PERFORM Form1-Buf-To-Fld
              PERFORM Form1-DUPLICATE-NEXT
           IF NOT Valid-STATUS-clienti
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeNext>
      * <TOTEM:END>
           PERFORM DataSet1-clienti-Read-Next
           IF NOT Valid-STATUS-clienti
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterNext>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-NEXT
           PERFORM Form1-IUD-Display
           .
      
       Form1-Last.
           PERFORM Form1-DUMMY-LAST
           PERFORM DataSet1-clienti-INITEND
           PERFORM DataSet1-clienti-START-NOTGREATER
           IF NOT Valid-STATUS-clienti
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeLast>
      * <TOTEM:END>
           PERFORM DataSet1-clienti-Read-Prev
           IF NOT Valid-STATUS-clienti
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterLast>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Curr.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeCurrent>
      * <TOTEM:END>
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-clienti-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCurrent>
      * <TOTEM:END>
           .

       Form1-IUD-Display.
           IF Valid-STATUS-clienti
              PERFORM Form1-ALLGRID-RESET
              PERFORM DataSet1-clienti-REF-destini
              PERFORM DataSet1-clienti-REF-recapiti
              PERFORM Form1-Fld-To-Buf
              PERFORM Form1-NAVI-FOR-MASTERGRID
              PERFORM Form1-DISPLAY
           ELSE
              IF Form1-FLAG-REFRESH
                 CONTINUE
              ELSE
                 PERFORM Form1-Extended-File-Status
              END-IF
           END-IF
           .

       Form1-Add.
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-ADD
           PERFORM DataSet1-clienti-INITREC
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAdd>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-clienti-Rec-Write
           IF Valid-STATUS-clienti
              PERFORM Form1-RESUMMARY-INS
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "301" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAdd>
      * <TOTEM:END>
           .
     
       Form1-Update.
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-clienti-START              
           IF NOT Valid-STATUS-clienti
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
           PERFORM DataSet1-clienti-Read
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-UPDATE
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeUpdate>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-clienti-Rec-Rewrite
           IF Valid-STATUS-clienti
              PERFORM Form1-RESUMMARY-DEL
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "302" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterUpdate>
      * <TOTEM:END>
           .

       Form1-Delete.
           MOVE "203" TO TOTEM-MSG-ID
           PERFORM MESSAGE-BOX-DISPLAY
           IF TOTEM-MSG-RETURN-VALUE NOT = 1
              INITIALIZE TOTEM-MSG-TEXT
              EXIT PARAGRAPH 
           END-IF
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDelete>
      * <TOTEM:END>
           PERFORM Form1-DUMMY-DELETE
      * delete
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-clienti-Rec-Delete
           IF Valid-STATUS-clienti
              PERFORM DataSet1-clienti-REF-recapiti-DEL
              PERFORM DataSet1-clienti-REF-destini-DEL
              PERFORM Form1-CLEAR
              PERFORM Form1-DUMMY-DELETE-INIT
              MOVE "303" TO TOTEM-MSG-ID
              MOVE "00" to STATUS-clienti
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDelete>
      * <TOTEM:END>
           PERFORM Form1-ERR-CHECKING
           .

       Form1-NAVI-FOR-MASTERGRID.
           .

       Form1-ERR-CHECKING.
           IF Valid-STATUS-clienti
              PERFORM Form1-SHOW-MSG-ROUTINE
           ELSE
              PERFORM Form1-Extended-File-Status
           END-IF
           .

       Form1-RESUMMARY-INS.
           .

       Form1-RESUMMARY-DEL.
           .


       Form1-DUMMY-FIRST.
           .

       Form1-DUMMY-PREVIOUS.
           .

       Form1-DUMMY-NEXT.
           .

       Form1-DUMMY-LAST.
           .

       Form1-DUMMY-CURR.
           .

       Form1-DUMMY-ADD.
           .

       Form1-DUMMY-UPDATE.
           .

       Form1-DUMMY-UPDATE-INIT.
           .

       Form1-DUMMY-DELETE.
           .

       Form1-DUMMY-DELETE-INIT.
           .

       Form1-Init-Value.
           MOVE TITOLO TO TOTEM-MSG-TITLE
           INITIALIZE Form1-BUF
      * FORM : Form1
           PERFORM DataSet1-INIT-RECORD
      * DB_CHECK BOX
              MOVE "N" TO cli-utf
      * DB_CHECK BOX
              MOVE "N" TO cli-inoltro
      * DB_CHECK BOX
              MOVE "N" TO cli-superamento-500
      * DB_CHECK BOX
              MOVE 0 TO cli-blocco-24000
      * DB_CHECK BOX
              MOVE "N" TO cli-invio-bolle-EDI
      * DB_CHECK BOX
              MOVE "N" TO cli-destino-auto-EDI
      * DB_CHECK BOX
              MOVE 0 TO cli-escludi-fido
      * DB_CHECK BOX
              MOVE "N" TO cli-contrassegno
      * DB_CHECK BOX
              MOVE 0 TO cli-gestione-fido
      * DB_CHECK BOX
              MOVE "N" TO cli-spost-ric-agosto
      * DB_CHECK BOX
              MOVE "N" TO cli-spost-ric-dicembre
      * DB_CHECK BOX
              MOVE "N" TO des-invio-fatt
      * DB_CHECK BOX
              MOVE "N" TO des-deposito-utf
      * DB_CHECK BOX
              MOVE "N" TO des-superamento-500
      * DB_CHECK BOX
              MOVE "N" TO rec-dett-dest-SDI
      * DB_CHECK BOX
              MOVE "N" TO rec-escludi-int
      * DB_CHECK BOX
              MOVE 0 TO ecd-escludi-OLD
      * DB_CHECK BOX
              MOVE 0 TO ecd-escludi-OLD
      * DB_CHECK BOX
              MOVE 0 TO ecd-accorpa-OLD
      * DB_CHECK BOX
              MOVE 0 TO ecd-saldi-banco-OLD
      * DB_CHECK BOX
              MOVE 0 TO ecd-saldi-promo-OLD
      * DB_CHECK BOX
              MOVE 0 TO ecd-import-importi
      * DB_CHECK BOX
              MOVE 0 TO ecd-import-articoli
      * DB_CHECK BOX
              MOVE 0 TO ecd-export-imposte
           MOVE ALL X'9' TO Form1-KEYISTMP2
           MOVE ALL X'9' TO Form1-PKEYTMP
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
      * ef-codice's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codice-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5001 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ragsoc-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ragsoc-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5002 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ragsoc-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ragsoc-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5003 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-indirizzo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-indirizzo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5004 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cap's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cap-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5005 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-localita's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-localita-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5006 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prov's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prov-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5007 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-nazione's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-nazione-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5008 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sdi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sdi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5009 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-tel-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-tel-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5010 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-tel-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-tel-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5011 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-fax's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-fax-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5012 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mail's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mail-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5013 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-maila's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-maila-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 15 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-url's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-url-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5014 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-tipo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-tipo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5015 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gdo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gdo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5016 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-referente's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-referente-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5018 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vettore's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vettore-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5019 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-agente's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-agente-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5021 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-agente2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-agente2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5024 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cod-ditta's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cod-ditta-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5027 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-PFA-perce's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-PFA-perce-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5028 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5029 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-agg's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-agg-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5030 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gg's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gg-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5039 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-esi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-esi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5041 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-codfis's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codfis-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5042 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-piva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-piva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5043 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-iva-ese's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-iva-ese-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5044 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5045 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cod-iva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cod-iva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5046 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-fido's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-fido-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5049 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-fido-data's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-fido-data-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5050 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-fido-extra's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-fido-extra-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5051 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-fide's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-fide-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5052 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-PFA's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-PFA-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5053 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data-fido-extra's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-fido-extra-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5054 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-grade's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-grade-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5055 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-abi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-abi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5056 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cab's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cab-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5057 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ragsoc-1-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ragsoc-1-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5059 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ragsoc-2-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ragsoc-2-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5060 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-indirizzo-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-indirizzo-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5061 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cap-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cap-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5062 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-localita-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-localita-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5063 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prov-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prov-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5064 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-nazione-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-nazione-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5065 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-telef-1-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-telef-1-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5067 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-telef-2-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-telef-2-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5068 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-fax-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-fax-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5069 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mail-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mail-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5070 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-referente-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-referente-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5071 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-piva-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-piva-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5072 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-agente-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-agente-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5073 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vettore-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vettore-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5074 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cod-ditta-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cod-ditta-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5079 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-CIG-d's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-CIG-d-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5080 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5081 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-data's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-data-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5082 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5083 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-3's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-3-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5084 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-4's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-4-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5085 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ragsoc-1-r's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ragsoc-1-r-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5086 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ragsoc-2-r's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ragsoc-2-r-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5087 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-indirizzo-r's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-indirizzo-r-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5088 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-localita-r's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-localita-r-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5089 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cap-r's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cap-r-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5090 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prov-r's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prov-r-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5091 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-nazione-r's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-nazione-r-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5092 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-dich-n's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-dich-n-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5096 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data-dich's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-dich-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5097 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data-reg's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-reg-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5098 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-reg-n's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-reg-n-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 3 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5099 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gg-e's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gg-e-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5106 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-id-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-id-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5109 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-q-id-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-q-id-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5110 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-codforn-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codforn-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5111 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-q-codforn-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-q-codforn-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5112 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-piva-c-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-piva-c-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5113 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ragsoc-c-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ragsoc-c-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5114 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ind-c-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ind-c-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5115 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-citta-c-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-citta-c-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5116 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prov-c-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prov-c-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5117 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cap-c-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cap-c-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5118 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-codcli-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codcli-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5119 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-q-codcli-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-q-codcli-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5120 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-dest-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-dest-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5121 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-q-dest-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-q-dest-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5122 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ragsoc-d-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ragsoc-d-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5123 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ind-d-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ind-d-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5124 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-citta-d-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-citta-d-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5125 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prov-d-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prov-d-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5126 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cap-d-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cap-d-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 6 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5127 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-cli's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-cli-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 7 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5131 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
           .

       ef-codice-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codice, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codice-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codice, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codice's Validation
       ef-codice-VALIDATION.
           PERFORM ef-codice-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codice-AFTER-VALIDATION
           .

       ef-ragsoc-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ragsoc-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ragsoc-1's Validation
       ef-ragsoc-1-VALIDATION.
           PERFORM ef-ragsoc-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ragsoc-1-AFTER-VALIDATION
           .

       ef-ragsoc-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ragsoc-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ragsoc-2's Validation
       ef-ragsoc-2-VALIDATION.
           PERFORM ef-ragsoc-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ragsoc-2-AFTER-VALIDATION
           .

       ef-indirizzo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-indirizzo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-indirizzo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-indirizzo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-indirizzo's Validation
       ef-indirizzo-VALIDATION.
           PERFORM ef-indirizzo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-indirizzo-AFTER-VALIDATION
           .

       ef-cap-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cap-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cap's Validation
       ef-cap-VALIDATION.
           PERFORM ef-cap-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cap-AFTER-VALIDATION
           .

       ef-localita-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-localita, BeforeValidation>
      * <TOTEM:END>
           .

       ef-localita-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-localita, AfterValidation>
      * <TOTEM:END>
           .

      * ef-localita's Validation
       ef-localita-VALIDATION.
           PERFORM ef-localita-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-localita-AFTER-VALIDATION
           .

       ef-prov-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prov-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prov's Validation
       ef-prov-VALIDATION.
           PERFORM ef-prov-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prov-AFTER-VALIDATION
           .

       ef-nazione-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-nazione, BeforeValidation>
      * <TOTEM:END>
           .

       ef-nazione-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-nazione, AfterValidation>
      * <TOTEM:END>
           .

      * ef-nazione's Validation
       ef-nazione-VALIDATION.
           PERFORM ef-nazione-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-nazione-AFTER-VALIDATION
           .

       ef-sdi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sdi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sdi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sdi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sdi's Validation
       ef-sdi-VALIDATION.
           PERFORM ef-sdi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sdi-AFTER-VALIDATION
           .

       ef-tel-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tel-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-tel-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tel-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-tel-1's Validation
       ef-tel-1-VALIDATION.
           PERFORM ef-tel-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-tel-1-AFTER-VALIDATION
           .

       ef-tel-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tel-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-tel-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tel-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-tel-2's Validation
       ef-tel-2-VALIDATION.
           PERFORM ef-tel-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-tel-2-AFTER-VALIDATION
           .

       ef-fax-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fax, BeforeValidation>
      * <TOTEM:END>
           .

       ef-fax-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fax, AfterValidation>
      * <TOTEM:END>
           .

      * ef-fax's Validation
       ef-fax-VALIDATION.
           PERFORM ef-fax-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-fax-AFTER-VALIDATION
           .

       ef-mail-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mail-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mail's Validation
       ef-mail-VALIDATION.
           PERFORM ef-mail-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mail-AFTER-VALIDATION
           .

       ef-maila-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-maila, BeforeValidation>
      * <TOTEM:END>
           .

       ef-maila-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-maila, AfterValidation>
      * <TOTEM:END>
           .

      * ef-maila's Validation
       ef-maila-VALIDATION.
           PERFORM ef-maila-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-maila-AFTER-VALIDATION
           .

       ef-url-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-url, BeforeValidation>
      * <TOTEM:END>
           .

       ef-url-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-url, AfterValidation>
      * <TOTEM:END>
           .

      * ef-url's Validation
       ef-url-VALIDATION.
           PERFORM ef-url-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-url-AFTER-VALIDATION
           .

       ef-tipo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tipo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-tipo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tipo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-tipo's Validation
       ef-tipo-VALIDATION.
           PERFORM ef-tipo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-tipo-AFTER-VALIDATION
           .

       ef-gdo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gdo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gdo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gdo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gdo's Validation
       ef-gdo-VALIDATION.
           PERFORM ef-gdo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gdo-AFTER-VALIDATION
           .

       ef-referente-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-referente, BeforeValidation>
      * <TOTEM:END>
           .

       ef-referente-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-referente, AfterValidation>
      * <TOTEM:END>
           .

      * ef-referente's Validation
       ef-referente-VALIDATION.
           PERFORM ef-referente-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-referente-AFTER-VALIDATION
           .

       ef-vettore-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vettore, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vettore-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vettore, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vettore's Validation
       ef-vettore-VALIDATION.
           PERFORM ef-vettore-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vettore-AFTER-VALIDATION
           .

       ef-agente-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-agente, BeforeValidation>
      * <TOTEM:END>
           .

       ef-agente-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-agente, AfterValidation>
      * <TOTEM:END>
           .

      * ef-agente's Validation
       ef-agente-VALIDATION.
           PERFORM ef-agente-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-agente-AFTER-VALIDATION
           .

       ef-agente2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-agente2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-agente2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-agente2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-agente2's Validation
       ef-agente2-VALIDATION.
           PERFORM ef-agente2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-agente2-AFTER-VALIDATION
           .

       ef-cod-ditta-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-ditta, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cod-ditta-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-ditta, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cod-ditta's Validation
       ef-cod-ditta-VALIDATION.
           PERFORM ef-cod-ditta-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cod-ditta-AFTER-VALIDATION
           .

       ef-PFA-perce-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-PFA-perce, BeforeValidation>
      * <TOTEM:END>
           .

       ef-PFA-perce-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-PFA-perce, AfterValidation>
      * <TOTEM:END>
           .

      * ef-PFA-perce's Validation
       ef-PFA-perce-VALIDATION.
           PERFORM ef-PFA-perce-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-PFA-perce-AFTER-VALIDATION
           .

       ef-note-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note's Validation
       ef-note-VALIDATION.
           PERFORM ef-note-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-AFTER-VALIDATION
           .

       ef-note-agg-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-agg, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-agg-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-agg, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-agg's Validation
       ef-note-agg-VALIDATION.
           PERFORM ef-note-agg-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-agg-AFTER-VALIDATION
           .

       ef-gg-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gg-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gg's Validation
       ef-gg-VALIDATION.
           PERFORM ef-gg-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gg-AFTER-VALIDATION
           .

       ef-esi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-esi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-esi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-esi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-esi's Validation
       ef-esi-VALIDATION.
           PERFORM ef-esi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-esi-AFTER-VALIDATION
           .

       ef-codfis-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codfis, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codfis-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codfis, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codfis's Validation
       ef-codfis-VALIDATION.
           PERFORM ef-codfis-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codfis-AFTER-VALIDATION
           .

       ef-piva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-piva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-piva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-piva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-piva's Validation
       ef-piva-VALIDATION.
           PERFORM ef-piva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-piva-AFTER-VALIDATION
           .

       ef-iva-ese-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva-ese, BeforeValidation>
      * <TOTEM:END>
           .

       ef-iva-ese-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva-ese, AfterValidation>
      * <TOTEM:END>
           .

      * ef-iva-ese's Validation
       ef-iva-ese-VALIDATION.
           PERFORM ef-iva-ese-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-iva-ese-AFTER-VALIDATION
           .

       ef-pag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pag's Validation
       ef-pag-VALIDATION.
           PERFORM ef-pag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pag-AFTER-VALIDATION
           .

       ef-cod-iva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-iva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cod-iva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-iva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cod-iva's Validation
       ef-cod-iva-VALIDATION.
           PERFORM ef-cod-iva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cod-iva-AFTER-VALIDATION
           .

       ef-fido-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fido, BeforeValidation>
      * <TOTEM:END>
           .

       ef-fido-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fido, AfterValidation>
      * <TOTEM:END>
           .

      * ef-fido's Validation
       ef-fido-VALIDATION.
           PERFORM ef-fido-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-fido-AFTER-VALIDATION
           .

       ef-fido-data-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fido-data, BeforeValidation>
      * <TOTEM:END>
           .

       ef-fido-data-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fido-data, AfterValidation>
      * <TOTEM:END>
           .

      * ef-fido-data's Validation
       ef-fido-data-VALIDATION.
           PERFORM ef-fido-data-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-fido-data-AFTER-VALIDATION
           .

       ef-fido-extra-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fido-extra, BeforeValidation>
      * <TOTEM:END>
           .

       ef-fido-extra-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fido-extra, AfterValidation>
      * <TOTEM:END>
           .

      * ef-fido-extra's Validation
       ef-fido-extra-VALIDATION.
           PERFORM ef-fido-extra-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-fido-extra-AFTER-VALIDATION
           .

       ef-fide-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fide, BeforeValidation>
      * <TOTEM:END>
           .

       ef-fide-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fide, AfterValidation>
      * <TOTEM:END>
           .

      * ef-fide's Validation
       ef-fide-VALIDATION.
           PERFORM ef-fide-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-fide-AFTER-VALIDATION
           .

       ef-PFA-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-PFA, BeforeValidation>
      * <TOTEM:END>
           .

       ef-PFA-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-PFA, AfterValidation>
      * <TOTEM:END>
           .

      * ef-PFA's Validation
       ef-PFA-VALIDATION.
           PERFORM ef-PFA-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-PFA-AFTER-VALIDATION
           .

       ef-data-fido-extra-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-fido-extra, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-fido-extra-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-fido-extra, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data-fido-extra's Validation
       ef-data-fido-extra-VALIDATION.
           PERFORM ef-data-fido-extra-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-fido-extra-AFTER-VALIDATION
           .

       ef-grade-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-grade, BeforeValidation>
      * <TOTEM:END>
           .

       ef-grade-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-grade, AfterValidation>
      * <TOTEM:END>
           .

      * ef-grade's Validation
       ef-grade-VALIDATION.
           PERFORM ef-grade-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-grade-AFTER-VALIDATION
           .

       ef-abi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-abi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-abi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-abi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-abi's Validation
       ef-abi-VALIDATION.
           PERFORM ef-abi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-abi-AFTER-VALIDATION
           .

       ef-cab-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cab, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cab-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cab, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cab's Validation
       ef-cab-VALIDATION.
           PERFORM ef-cab-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cab-AFTER-VALIDATION
           .

       ef-ragsoc-1-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-1-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ragsoc-1-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-1-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ragsoc-1-d's Validation
       ef-ragsoc-1-d-VALIDATION.
           PERFORM ef-ragsoc-1-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ragsoc-1-d-AFTER-VALIDATION
           .

       ef-ragsoc-2-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-2-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ragsoc-2-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-2-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ragsoc-2-d's Validation
       ef-ragsoc-2-d-VALIDATION.
           PERFORM ef-ragsoc-2-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ragsoc-2-d-AFTER-VALIDATION
           .

       ef-indirizzo-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-indirizzo-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-indirizzo-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-indirizzo-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-indirizzo-d's Validation
       ef-indirizzo-d-VALIDATION.
           PERFORM ef-indirizzo-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-indirizzo-d-AFTER-VALIDATION
           .

       ef-cap-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cap-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cap-d's Validation
       ef-cap-d-VALIDATION.
           PERFORM ef-cap-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cap-d-AFTER-VALIDATION
           .

       ef-localita-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-localita-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-localita-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-localita-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-localita-d's Validation
       ef-localita-d-VALIDATION.
           PERFORM ef-localita-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-localita-d-AFTER-VALIDATION
           .

       ef-prov-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prov-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prov-d's Validation
       ef-prov-d-VALIDATION.
           PERFORM ef-prov-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prov-d-AFTER-VALIDATION
           .

       ef-nazione-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-nazione-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-nazione-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-nazione-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-nazione-d's Validation
       ef-nazione-d-VALIDATION.
           PERFORM ef-nazione-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-nazione-d-AFTER-VALIDATION
           .

       ef-telef-1-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-telef-1-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-telef-1-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-telef-1-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-telef-1-d's Validation
       ef-telef-1-d-VALIDATION.
           PERFORM ef-telef-1-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-telef-1-d-AFTER-VALIDATION
           .

       ef-telef-2-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-telef-2-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-telef-2-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-telef-2-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-telef-2-d's Validation
       ef-telef-2-d-VALIDATION.
           PERFORM ef-telef-2-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-telef-2-d-AFTER-VALIDATION
           .

       ef-fax-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fax-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-fax-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fax-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-fax-d's Validation
       ef-fax-d-VALIDATION.
           PERFORM ef-fax-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-fax-d-AFTER-VALIDATION
           .

       ef-mail-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mail-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mail-d's Validation
       ef-mail-d-VALIDATION.
           PERFORM ef-mail-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mail-d-AFTER-VALIDATION
           .

       ef-referente-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-referente-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-referente-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-referente-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-referente-d's Validation
       ef-referente-d-VALIDATION.
           PERFORM ef-referente-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-referente-d-AFTER-VALIDATION
           .

       ef-piva-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-piva-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-piva-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-piva-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-piva-d's Validation
       ef-piva-d-VALIDATION.
           PERFORM ef-piva-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-piva-d-AFTER-VALIDATION
           .

       ef-agente-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-agente-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-agente-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-agente-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-agente-d's Validation
       ef-agente-d-VALIDATION.
           PERFORM ef-agente-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-agente-d-AFTER-VALIDATION
           .

       ef-vettore-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vettore-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vettore-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vettore-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vettore-d's Validation
       ef-vettore-d-VALIDATION.
           PERFORM ef-vettore-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vettore-d-AFTER-VALIDATION
           .

       ef-cod-ditta-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-ditta-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cod-ditta-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-ditta-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cod-ditta-d's Validation
       ef-cod-ditta-d-VALIDATION.
           PERFORM ef-cod-ditta-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cod-ditta-d-AFTER-VALIDATION
           .

       ef-CIG-d-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-CIG-d, BeforeValidation>
      * <TOTEM:END>
           .

       ef-CIG-d-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-CIG-d, AfterValidation>
      * <TOTEM:END>
           .

      * ef-CIG-d's Validation
       ef-CIG-d-VALIDATION.
           PERFORM ef-CIG-d-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-CIG-d-AFTER-VALIDATION
           .

       ef-note-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-1's Validation
       ef-note-1-VALIDATION.
           PERFORM ef-note-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-1-AFTER-VALIDATION
           .

       ef-note-data-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-data, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-data-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-data, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-data's Validation
       ef-note-data-VALIDATION.
           PERFORM ef-note-data-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-data-AFTER-VALIDATION
           .

       ef-note-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-2's Validation
       ef-note-2-VALIDATION.
           PERFORM ef-note-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-2-AFTER-VALIDATION
           .

       ef-note-3-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-3, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-3-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-3, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-3's Validation
       ef-note-3-VALIDATION.
           PERFORM ef-note-3-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-3-AFTER-VALIDATION
           .

       ef-note-4-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-4, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-4-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-4, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-4's Validation
       ef-note-4-VALIDATION.
           PERFORM ef-note-4-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-4-AFTER-VALIDATION
           .

       ef-ragsoc-1-r-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-1-r, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ragsoc-1-r-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-1-r, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ragsoc-1-r's Validation
       ef-ragsoc-1-r-VALIDATION.
           PERFORM ef-ragsoc-1-r-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ragsoc-1-r-AFTER-VALIDATION
           .

       ef-ragsoc-2-r-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-2-r, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ragsoc-2-r-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-2-r, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ragsoc-2-r's Validation
       ef-ragsoc-2-r-VALIDATION.
           PERFORM ef-ragsoc-2-r-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ragsoc-2-r-AFTER-VALIDATION
           .

       ef-indirizzo-r-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-indirizzo-r, BeforeValidation>
      * <TOTEM:END>
           .

       ef-indirizzo-r-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-indirizzo-r, AfterValidation>
      * <TOTEM:END>
           .

      * ef-indirizzo-r's Validation
       ef-indirizzo-r-VALIDATION.
           PERFORM ef-indirizzo-r-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-indirizzo-r-AFTER-VALIDATION
           .

       ef-localita-r-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-localita-r, BeforeValidation>
      * <TOTEM:END>
           .

       ef-localita-r-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-localita-r, AfterValidation>
      * <TOTEM:END>
           .

      * ef-localita-r's Validation
       ef-localita-r-VALIDATION.
           PERFORM ef-localita-r-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-localita-r-AFTER-VALIDATION
           .

       ef-cap-r-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap-r, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cap-r-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap-r, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cap-r's Validation
       ef-cap-r-VALIDATION.
           PERFORM ef-cap-r-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cap-r-AFTER-VALIDATION
           .

       ef-prov-r-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov-r, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prov-r-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov-r, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prov-r's Validation
       ef-prov-r-VALIDATION.
           PERFORM ef-prov-r-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prov-r-AFTER-VALIDATION
           .

       ef-nazione-r-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-nazione-r, BeforeValidation>
      * <TOTEM:END>
           .

       ef-nazione-r-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-nazione-r, AfterValidation>
      * <TOTEM:END>
           .

      * ef-nazione-r's Validation
       ef-nazione-r-VALIDATION.
           PERFORM ef-nazione-r-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-nazione-r-AFTER-VALIDATION
           .

       ef-dich-n-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dich-n, BeforeValidation>
      * <TOTEM:END>
           .

       ef-dich-n-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dich-n, AfterValidation>
      * <TOTEM:END>
           .

      * ef-dich-n's Validation
       ef-dich-n-VALIDATION.
           PERFORM ef-dich-n-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-dich-n-AFTER-VALIDATION
           .

       ef-data-dich-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-dich, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-dich-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-dich, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data-dich's Validation
       ef-data-dich-VALIDATION.
           PERFORM ef-data-dich-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-dich-AFTER-VALIDATION
           .

       ef-data-reg-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-reg, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-reg-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-reg, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data-reg's Validation
       ef-data-reg-VALIDATION.
           PERFORM ef-data-reg-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-reg-AFTER-VALIDATION
           .

       ef-reg-n-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-reg-n, BeforeValidation>
      * <TOTEM:END>
           .

       ef-reg-n-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-reg-n, AfterValidation>
      * <TOTEM:END>
           .

      * ef-reg-n's Validation
       ef-reg-n-VALIDATION.
           PERFORM ef-reg-n-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-reg-n-AFTER-VALIDATION
           .

       ef-gg-e-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-e, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gg-e-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-e, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gg-e's Validation
       ef-gg-e-VALIDATION.
           PERFORM ef-gg-e-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gg-e-AFTER-VALIDATION
           .

       ef-id-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-id-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-id-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-id-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-id-edi's Validation
       ef-id-edi-VALIDATION.
           PERFORM ef-id-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-id-edi-AFTER-VALIDATION
           .

       ef-q-id-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-q-id-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-q-id-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-q-id-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-q-id-edi's Validation
       ef-q-id-edi-VALIDATION.
           PERFORM ef-q-id-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-q-id-edi-AFTER-VALIDATION
           .

       ef-codforn-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codforn-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codforn-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codforn-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codforn-edi's Validation
       ef-codforn-edi-VALIDATION.
           PERFORM ef-codforn-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codforn-edi-AFTER-VALIDATION
           .

       ef-q-codforn-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-q-codforn-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-q-codforn-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-q-codforn-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-q-codforn-edi's Validation
       ef-q-codforn-edi-VALIDATION.
           PERFORM ef-q-codforn-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-q-codforn-edi-AFTER-VALIDATION
           .

       ef-piva-c-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-piva-c-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-piva-c-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-piva-c-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-piva-c-edi's Validation
       ef-piva-c-edi-VALIDATION.
           PERFORM ef-piva-c-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-piva-c-edi-AFTER-VALIDATION
           .

       ef-ragsoc-c-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-c-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ragsoc-c-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-c-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ragsoc-c-edi's Validation
       ef-ragsoc-c-edi-VALIDATION.
           PERFORM ef-ragsoc-c-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ragsoc-c-edi-AFTER-VALIDATION
           .

       ef-ind-c-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ind-c-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ind-c-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ind-c-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ind-c-edi's Validation
       ef-ind-c-edi-VALIDATION.
           PERFORM ef-ind-c-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ind-c-edi-AFTER-VALIDATION
           .

       ef-citta-c-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-citta-c-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-citta-c-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-citta-c-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-citta-c-edi's Validation
       ef-citta-c-edi-VALIDATION.
           PERFORM ef-citta-c-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-citta-c-edi-AFTER-VALIDATION
           .

       ef-prov-c-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov-c-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prov-c-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov-c-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prov-c-edi's Validation
       ef-prov-c-edi-VALIDATION.
           PERFORM ef-prov-c-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prov-c-edi-AFTER-VALIDATION
           .

       ef-cap-c-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap-c-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cap-c-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap-c-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cap-c-edi's Validation
       ef-cap-c-edi-VALIDATION.
           PERFORM ef-cap-c-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cap-c-edi-AFTER-VALIDATION
           .

       ef-codcli-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codcli-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codcli-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codcli-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codcli-edi's Validation
       ef-codcli-edi-VALIDATION.
           PERFORM ef-codcli-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codcli-edi-AFTER-VALIDATION
           .

       ef-q-codcli-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-q-codcli-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-q-codcli-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-q-codcli-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-q-codcli-edi's Validation
       ef-q-codcli-edi-VALIDATION.
           PERFORM ef-q-codcli-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-q-codcli-edi-AFTER-VALIDATION
           .

       ef-dest-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dest-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-dest-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dest-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-dest-edi's Validation
       ef-dest-edi-VALIDATION.
           PERFORM ef-dest-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-dest-edi-AFTER-VALIDATION
           .

       ef-q-dest-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-q-dest-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-q-dest-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-q-dest-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-q-dest-edi's Validation
       ef-q-dest-edi-VALIDATION.
           PERFORM ef-q-dest-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-q-dest-edi-AFTER-VALIDATION
           .

       ef-ragsoc-d-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-d-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ragsoc-d-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ragsoc-d-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ragsoc-d-edi's Validation
       ef-ragsoc-d-edi-VALIDATION.
           PERFORM ef-ragsoc-d-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ragsoc-d-edi-AFTER-VALIDATION
           .

       ef-ind-d-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ind-d-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ind-d-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ind-d-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ind-d-edi's Validation
       ef-ind-d-edi-VALIDATION.
           PERFORM ef-ind-d-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ind-d-edi-AFTER-VALIDATION
           .

       ef-citta-d-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-citta-d-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-citta-d-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-citta-d-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-citta-d-edi's Validation
       ef-citta-d-edi-VALIDATION.
           PERFORM ef-citta-d-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-citta-d-edi-AFTER-VALIDATION
           .

       ef-prov-d-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov-d-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prov-d-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prov-d-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prov-d-edi's Validation
       ef-prov-d-edi-VALIDATION.
           PERFORM ef-prov-d-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prov-d-edi-AFTER-VALIDATION
           .

       ef-cap-d-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap-d-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cap-d-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cap-d-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cap-d-edi's Validation
       ef-cap-d-edi-VALIDATION.
           PERFORM ef-cap-d-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cap-d-edi-AFTER-VALIDATION
           .

       ef-note-cli-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-cli, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-cli-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-cli, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-cli's Validation
       ef-note-cli-VALIDATION.
           PERFORM ef-note-cli-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-cli-AFTER-VALIDATION
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * DB_Entry-Field : ef-codice
           MOVE ef-codice-BUF TO cli-codice
      * DB_Entry-Field : ef-ragsoc-1
           MOVE ef-ragsoc-1-BUF TO cli-ragsoc-1
      * DB_Entry-Field : ef-ragsoc-2
           MOVE ef-ragsoc-2-BUF TO cli-ragsoc-2
      * DB_Entry-Field : ef-indirizzo
           MOVE ef-indirizzo-BUF TO cli-indirizzo
      * DB_Entry-Field : ef-cap
           MOVE ef-cap-BUF TO cli-cap
      * DB_Entry-Field : ef-localita
           MOVE ef-localita-BUF TO cli-localita
      * DB_Entry-Field : ef-prov
           MOVE ef-prov-BUF TO cli-prov
      * DB_Entry-Field : ef-nazione
           MOVE ef-nazione-BUF TO cli-nazione
      * DB_Entry-Field : ef-sdi
           MOVE ef-sdi-BUF TO cli-codice-SDI
      * DB_Entry-Field : ef-tel-1
           MOVE ef-tel-1-BUF TO cli-tel-1
      * DB_Entry-Field : ef-tel-2
           MOVE ef-tel-2-BUF TO cli-tel-2
      * DB_Entry-Field : ef-fax
           MOVE ef-fax-BUF TO cli-fax
      * DB_Entry-Field : ef-mail
           MOVE ef-mail-BUF TO cli-email
      * DB_Entry-Field : ef-maila
           MOVE ef-maila-BUF TO cli-pec
      * DB_Entry-Field : ef-url
           MOVE ef-url-BUF TO cli-web
      * DB_Entry-Field : ef-tipo
           MOVE ef-tipo-BUF TO cli-tipo
      * DB_Entry-Field : ef-gdo
           MOVE ef-gdo-BUF TO cli-gdo
      * DB_CHECK BOX : chk-utf
              IF chk-utf-BUF = 1
                 MOVE "S" TO cli-utf
              ELSE
                 MOVE "N" TO cli-utf
              END-IF
      * DB_Entry-Field : ef-referente
           MOVE ef-referente-BUF TO cli-referente
      * DB_Entry-Field : ef-vettore
           MOVE ef-vettore-BUF TO cli-vettore
      * DB_CHECK BOX : chk-inoltro
              IF chk-inoltro-BUF = 1
                 MOVE "S" TO cli-inoltro
              ELSE
                 MOVE "N" TO cli-inoltro
              END-IF
      * DB_Entry-Field : ef-agente
           MOVE ef-agente-BUF TO cli-agente
      * DB_Entry-Field : ef-agente2
           MOVE ef-agente2-BUF TO cli-agente2
      * DB_CHECK BOX : chk-superamento
              IF chk-superamento-BUF = 1
                 MOVE "S" TO cli-superamento-500
              ELSE
                 MOVE "N" TO cli-superamento-500
              END-IF
      * DB_CHECK BOX : chk-24000
              IF chk-24000-BUF = 1
                 MOVE 1 TO cli-blocco-24000
              ELSE
                 MOVE 0 TO cli-blocco-24000
              END-IF
      * DB_Entry-Field : ef-cod-ditta
           MOVE ef-cod-ditta-BUF TO cli-cod-ditta
      * DB_Entry-Field : ef-PFA-perce
           MOVE ef-PFA-perce-BUF TO cli-pfa-perce
      * DB_Entry-Field : ef-note
           MOVE ef-note-BUF TO cli-note
      * DB_Entry-Field : ef-note-agg
           MOVE ef-note-agg-BUF TO cli-note-agg
      * DB_CHECK BOX : chk-invio-bolle-EDI
              IF chk-invio-bolle-EDI-BUF = 1
                 MOVE "S" TO cli-invio-bolle-EDI
              ELSE
                 MOVE "N" TO cli-invio-bolle-EDI
              END-IF
      * DB_CHECK BOX : chk-destino-auto
              IF chk-destino-auto-BUF = 1
                 MOVE "S" TO cli-destino-auto-EDI
              ELSE
                 MOVE "N" TO cli-destino-auto-EDI
              END-IF
      * DB_CHECK BOX : chk-escludi-fido
              IF chk-escludi-fido-BUF = 1
                 MOVE 1 TO cli-escludi-fido
              ELSE
                 MOVE 0 TO cli-escludi-fido
              END-IF
      * DB_CHECK BOX : chk-contrassegno
              IF chk-contrassegno-BUF = 1
                 MOVE "S" TO cli-contrassegno
              ELSE
                 MOVE "N" TO cli-contrassegno
              END-IF
      * DB_RADIOBOX : rb-pers, rb-soc, 
           EVALUATE Form1-RADIO-1-BUF
           WHEN 1
              MOVE "F" TO cli-tipo-persona
           WHEN 2
              MOVE SPACE TO cli-tipo-persona
           WHEN OTHER
              MOVE SPACE TO cli-tipo-persona
           END-EVALUATE
      * DB_Entry-Field : ef-gg
           MOVE ef-gg-BUF TO cli-gg-dilazione
      * DB_CHECK BOX : chk-fido
              IF chk-fido-BUF = 1
                 MOVE 1 TO cli-gestione-fido
              ELSE
                 MOVE 0 TO cli-gestione-fido
              END-IF
      * DB_Entry-Field : ef-esi
           MOVE ef-esi-BUF TO cli-esigibilita-iva
      * DB_Entry-Field : ef-codfis
           MOVE ef-codfis-BUF TO cli-codfis
      * DB_Entry-Field : ef-piva
           MOVE ef-piva-BUF TO cli-piva
      * DB_Entry-Field : ef-iva-ese
           MOVE ef-iva-ese-BUF TO cli-iva-ese
      * DB_Entry-Field : ef-pag
           MOVE ef-pag-BUF TO cli-pag
      * DB_Entry-Field : ef-cod-iva
           MOVE ef-cod-iva-BUF TO cli-iva
      * DB_CHECK BOX : chk-spost-ago
              IF chk-spost-ago-BUF = 1
                 MOVE "S" TO cli-spost-ric-agosto
              ELSE
                 MOVE "N" TO cli-spost-ric-agosto
              END-IF
      * DB_CHECK BOX : chk-spost-dic
              IF chk-spost-dic-BUF = 1
                 MOVE "S" TO cli-spost-ric-dicembre
              ELSE
                 MOVE "N" TO cli-spost-ric-dicembre
              END-IF
      * DB_Entry-Field : ef-fido
           MOVE ef-fido-BUF TO cli-fido
      * DB_Entry-Field : ef-fido-data
           MOVE ef-fido-data-BUF TO cli-fido-data
      * DB_Entry-Field : ef-fido-extra
           MOVE ef-fido-extra-BUF TO cli-fido-extra
      * DB_Entry-Field : ef-fide
           MOVE ef-fide-BUF TO cli-fidejussione
      * DB_Entry-Field : ef-PFA
           MOVE ef-PFA-BUF TO cli-pfa
      * DB_Entry-Field : ef-data-fido-extra
           MOVE ef-data-fido-extra-BUF TO cli-data-fido-extra
      * DB_Entry-Field : ef-grade
           MOVE ef-grade-BUF TO cli-grade
      * DB_Entry-Field : ef-abi
           MOVE ef-abi-BUF TO cli-abi
      * DB_Entry-Field : ef-cab
           MOVE ef-cab-BUF TO cli-cab
      * DB_Entry-Field : ef-ragsoc-1-d
           MOVE ef-ragsoc-1-d-BUF TO des-ragsoc-1
      * DB_Entry-Field : ef-ragsoc-2-d
           MOVE ef-ragsoc-2-d-BUF TO des-ragsoc-2
      * DB_Entry-Field : ef-indirizzo-d
           MOVE ef-indirizzo-d-BUF TO des-indirizzo
      * DB_Entry-Field : ef-cap-d
           MOVE ef-cap-d-BUF TO des-cap
      * DB_Entry-Field : ef-localita-d
           MOVE ef-localita-d-BUF TO des-localita
      * DB_Entry-Field : ef-prov-d
           MOVE ef-prov-d-BUF TO des-prov
      * DB_Entry-Field : ef-nazione-d
           MOVE ef-nazione-d-BUF TO des-nazione
      * DB_CHECK BOX : chk-invio-d
              IF chk-invio-d-BUF = 1
                 MOVE "S" TO des-invio-fatt
              ELSE
                 MOVE "N" TO des-invio-fatt
              END-IF
      * DB_Entry-Field : ef-telef-1-d
           MOVE ef-telef-1-d-BUF TO des-telef-1
      * DB_Entry-Field : ef-telef-2-d
           MOVE ef-telef-2-d-BUF TO des-telef-2
      * DB_Entry-Field : ef-fax-d
           MOVE ef-fax-d-BUF TO des-fax
      * DB_Entry-Field : ef-mail-d
           MOVE ef-mail-d-BUF TO des-mail
      * DB_Entry-Field : ef-referente-d
           MOVE ef-referente-d-BUF TO des-referente
      * DB_Entry-Field : ef-piva-d
           MOVE ef-piva-d-BUF TO des-piva
      * DB_Entry-Field : ef-agente-d
           MOVE ef-agente-d-BUF TO des-age-codice
      * DB_Entry-Field : ef-vettore-d
           MOVE ef-vettore-d-BUF TO des-vettore
      * DB_CHECK BOX : chk-deposito-utf
              IF chk-deposito-utf-BUF = 1
                 MOVE "S" TO des-deposito-utf
              ELSE
                 MOVE "N" TO des-deposito-utf
              END-IF
      * DB_CHECK BOX : chk-superamento-d
              IF chk-superamento-d-BUF = 1
                 MOVE "S" TO des-superamento-500
              ELSE
                 MOVE "N" TO des-superamento-500
              END-IF
      * DB_Entry-Field : ef-cod-ditta-d
           MOVE ef-cod-ditta-d-BUF TO des-cod-ditta
      * DB_Entry-Field : ef-CIG-d
           MOVE ef-CIG-d-BUF TO des-CIG
      * DB_Entry-Field : ef-note-1
           MOVE ef-note-1-BUF TO not-note-1 OF note1
      * DB_Entry-Field : ef-note-data
           MOVE ef-note-data-BUF TO not-data OF note1
      * DB_Entry-Field : ef-note-2
           MOVE ef-note-2-BUF TO not-note-2 OF note1
      * DB_Entry-Field : ef-note-3
           MOVE ef-note-3-BUF TO not-note-3 OF note1
      * DB_Entry-Field : ef-note-4
           MOVE ef-note-4-BUF TO not-note-4 OF note1
      * DB_Entry-Field : ef-ragsoc-1-r
           MOVE ef-ragsoc-1-r-BUF TO rec-ragsoc-1
      * DB_Entry-Field : ef-ragsoc-2-r
           MOVE ef-ragsoc-2-r-BUF TO rec-ragsoc-2
      * DB_Entry-Field : ef-indirizzo-r
           MOVE ef-indirizzo-r-BUF TO rec-indirizzo
      * DB_Entry-Field : ef-localita-r
           MOVE ef-localita-r-BUF TO rec-localita
      * DB_Entry-Field : ef-cap-r
           MOVE ef-cap-r-BUF TO rec-cap
      * DB_Entry-Field : ef-prov-r
           MOVE ef-prov-r-BUF TO rec-provincia
      * DB_Entry-Field : ef-nazione-r
           MOVE ef-nazione-r-BUF TO rec-nazione
      * DB_CHECK BOX : chk-dett-dest-sdi
              IF chk-dett-dest-sdi-BUF = 1
                 MOVE "S" TO rec-dett-dest-SDI
              ELSE
                 MOVE "N" TO rec-dett-dest-SDI
              END-IF
      * DB_CHECK BOX : chk-escludi-int
              IF chk-escludi-int-BUF = 1
                 MOVE "S" TO rec-escludi-int
              ELSE
                 MOVE "N" TO rec-escludi-int
              END-IF
      * DB_Entry-Field : ef-dich-n
           MOVE ef-dich-n-BUF TO cli-dich-esp
      * DB_Entry-Field : ef-data-dich
           MOVE ef-data-dich-BUF TO cli-data-dich
      * DB_Entry-Field : ef-data-reg
           MOVE ef-data-reg-BUF TO cli-data-reg
      * DB_Entry-Field : ef-reg-n
           MOVE ef-reg-n-BUF TO cli-num-reg
      * DB_CHECK BOX : chk-escludi-e
              IF chk-escludi-e-BUF = 1
                 MOVE 1 TO ecd-escludi-OLD
              ELSE
                 MOVE 0 TO ecd-escludi-OLD
              END-IF
      * DB_CHECK BOX : chk-intera-e
              IF chk-intera-e-BUF = 1
                 MOVE 1 TO ecd-escludi-OLD
              ELSE
                 MOVE 0 TO ecd-escludi-OLD
              END-IF
      * DB_CHECK BOX : chk-accorpa-e
              IF chk-accorpa-e-BUF = 1
                 MOVE 1 TO ecd-accorpa-OLD
              ELSE
                 MOVE 0 TO ecd-accorpa-OLD
              END-IF
      * DB_CHECK BOX : chk-saldo-banco-e
              IF chk-saldo-banco-e-BUF = 1
                 MOVE 1 TO ecd-saldi-banco-OLD
              ELSE
                 MOVE 0 TO ecd-saldi-banco-OLD
              END-IF
      * DB_CHECK BOX : chk-saldo-promo-e
              IF chk-saldo-promo-e-BUF = 1
                 MOVE 1 TO ecd-saldi-promo-OLD
              ELSE
                 MOVE 0 TO ecd-saldi-promo-OLD
              END-IF
      * DB_Entry-Field : ef-gg-e
           MOVE ef-gg-e-BUF TO ecd-gg-scadenza-vol-OLD
      * DB_Entry-Field : ef-id-edi
           MOVE ef-id-edi-BUF TO ecd-id-edi
      * DB_Entry-Field : ef-q-id-edi
           MOVE ef-q-id-edi-BUF TO ecd-q-id-edi
      * DB_Entry-Field : ef-codforn-edi
           MOVE ef-codforn-edi-BUF TO ecd-codforn
      * DB_Entry-Field : ef-q-codforn-edi
           MOVE ef-q-codforn-edi-BUF TO ecd-q-codforn
      * DB_Entry-Field : ef-piva-c-edi
           MOVE ef-piva-c-edi-BUF TO ecd-piva
      * DB_Entry-Field : ef-ragsoc-c-edi
           MOVE ef-ragsoc-c-edi-BUF TO ecd-ragsoc-c
      * DB_Entry-Field : ef-ind-c-edi
           MOVE ef-ind-c-edi-BUF TO ecd-indirizzo-c
      * DB_Entry-Field : ef-citta-c-edi
           MOVE ef-citta-c-edi-BUF TO ecd-citta-c
      * DB_Entry-Field : ef-prov-c-edi
           MOVE ef-prov-c-edi-BUF TO ecd-prov-c
      * DB_Entry-Field : ef-cap-c-edi
           MOVE ef-cap-c-edi-BUF TO ecd-cap-c
      * DB_Entry-Field : ef-codcli-edi
           MOVE ef-codcli-edi-BUF TO ecd-cod-dest
      * DB_Entry-Field : ef-q-codcli-edi
           MOVE ef-q-codcli-edi-BUF TO ecd-q-cod-dest
      * DB_Entry-Field : ef-dest-edi
           MOVE ef-dest-edi-BUF TO ecd-cod-consegna
      * DB_Entry-Field : ef-q-dest-edi
           MOVE ef-q-dest-edi-BUF TO ecd-q-cod-consegna
      * DB_Entry-Field : ef-ragsoc-d-edi
           MOVE ef-ragsoc-d-edi-BUF TO ecd-ragsoc-d
      * DB_Entry-Field : ef-ind-d-edi
           MOVE ef-ind-d-edi-BUF TO ecd-indirizzo-d
      * DB_Entry-Field : ef-citta-d-edi
           MOVE ef-citta-d-edi-BUF TO ecd-citta-d
      * DB_Entry-Field : ef-prov-d-edi
           MOVE ef-prov-d-edi-BUF TO ecd-prov-d
      * DB_Entry-Field : ef-cap-d-edi
           MOVE ef-cap-d-edi-BUF TO ecd-cap-d
      * DB_CHECK BOX : chk-imp-i
              IF chk-imp-i-BUF = 1
                 MOVE 1 TO ecd-import-importi
              ELSE
                 MOVE 0 TO ecd-import-importi
              END-IF
      * DB_CHECK BOX : chk-imp-a
              IF chk-imp-a-BUF = 1
                 MOVE 1 TO ecd-import-articoli
              ELSE
                 MOVE 0 TO ecd-import-articoli
              END-IF
      * DB_CHECK BOX : chk-exp-i
              IF chk-exp-i-BUF = 1
                 MOVE 1 TO ecd-export-imposte
              ELSE
                 MOVE 0 TO ecd-export-imposte
              END-IF
      * DB_Entry-Field : ef-note-cli
           MOVE ef-note-cli-BUF TO notc-note
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
           perform GCLIENTI-AFTER-BUF-TO-FLD.

           .
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * <TOTEM:END>
      * DB_Entry-Field : ef-codice
           MOVE cli-codice TO ef-codice-BUF
      * DB_Entry-Field : ef-ragsoc-1
           MOVE cli-ragsoc-1 TO ef-ragsoc-1-BUF
      * DB_Entry-Field : ef-ragsoc-2
           MOVE cli-ragsoc-2 TO ef-ragsoc-2-BUF
      * DB_Entry-Field : ef-indirizzo
           MOVE cli-indirizzo TO ef-indirizzo-BUF
      * DB_Entry-Field : ef-cap
           MOVE cli-cap TO ef-cap-BUF
      * DB_Entry-Field : ef-localita
           MOVE cli-localita TO ef-localita-BUF
      * DB_Entry-Field : ef-prov
           MOVE cli-prov TO ef-prov-BUF
      * DB_Entry-Field : ef-nazione
           MOVE cli-nazione TO ef-nazione-BUF
      * DB_Entry-Field : ef-sdi
           MOVE cli-codice-SDI TO ef-sdi-BUF
      * DB_Entry-Field : ef-tel-1
           MOVE cli-tel-1 TO ef-tel-1-BUF
      * DB_Entry-Field : ef-tel-2
           MOVE cli-tel-2 TO ef-tel-2-BUF
      * DB_Entry-Field : ef-fax
           MOVE cli-fax TO ef-fax-BUF
      * DB_Entry-Field : ef-mail
           MOVE cli-email TO ef-mail-BUF
      * DB_Entry-Field : ef-maila
           MOVE cli-pec TO ef-maila-BUF
      * DB_Entry-Field : ef-url
           MOVE cli-web TO ef-url-BUF
      * DB_Entry-Field : ef-tipo
           MOVE cli-tipo TO ef-tipo-BUF
      * DB_Entry-Field : ef-gdo
           MOVE cli-gdo TO ef-gdo-BUF
      * DB_CHECK BOX : chk-utf
              IF cli-utf = "S"
                 MOVE 1 TO chk-utf-BUF
              ELSE
                 MOVE 0 TO chk-utf-BUF
              END-IF
      * DB_Entry-Field : ef-referente
           MOVE cli-referente TO ef-referente-BUF
      * DB_Entry-Field : ef-vettore
           MOVE cli-vettore TO ef-vettore-BUF
      * DB_CHECK BOX : chk-inoltro
              IF cli-inoltro = "S"
                 MOVE 1 TO chk-inoltro-BUF
              ELSE
                 MOVE 0 TO chk-inoltro-BUF
              END-IF
      * DB_Entry-Field : ef-agente
           MOVE cli-agente TO ef-agente-BUF
      * DB_Entry-Field : ef-agente2
           MOVE cli-agente2 TO ef-agente2-BUF
      * DB_CHECK BOX : chk-superamento
              IF cli-superamento-500 = "S"
                 MOVE 1 TO chk-superamento-BUF
              ELSE
                 MOVE 0 TO chk-superamento-BUF
              END-IF
      * DB_CHECK BOX : chk-24000
              IF cli-blocco-24000 = 1
                 MOVE 1 TO chk-24000-BUF
              ELSE
                 MOVE 0 TO chk-24000-BUF
              END-IF
      * DB_Entry-Field : ef-cod-ditta
           MOVE cli-cod-ditta TO ef-cod-ditta-BUF
      * DB_Entry-Field : ef-PFA-perce
           MOVE cli-pfa-perce TO ef-PFA-perce-BUF
      * DB_Entry-Field : ef-note
           MOVE cli-note TO ef-note-BUF
      * DB_Entry-Field : ef-note-agg
           MOVE cli-note-agg TO ef-note-agg-BUF
      * DB_CHECK BOX : chk-invio-bolle-EDI
              IF cli-invio-bolle-EDI = "S"
                 MOVE 1 TO chk-invio-bolle-EDI-BUF
              ELSE
                 MOVE 0 TO chk-invio-bolle-EDI-BUF
              END-IF
      * DB_CHECK BOX : chk-destino-auto
              IF cli-destino-auto-EDI = "S"
                 MOVE 1 TO chk-destino-auto-BUF
              ELSE
                 MOVE 0 TO chk-destino-auto-BUF
              END-IF
      * DB_CHECK BOX : chk-escludi-fido
              IF cli-escludi-fido = 1
                 MOVE 1 TO chk-escludi-fido-BUF
              ELSE
                 MOVE 0 TO chk-escludi-fido-BUF
              END-IF
      * DB_CHECK BOX : chk-contrassegno
              IF cli-contrassegno = "S"
                 MOVE 1 TO chk-contrassegno-BUF
              ELSE
                 MOVE 0 TO chk-contrassegno-BUF
              END-IF
      * DB_RADIOBOX : rb-pers, rb-soc, 
           EVALUATE cli-tipo-persona
           WHEN "F"
              MOVE 1 TO Form1-RADIO-1-BUF
           WHEN SPACE
              MOVE 2 TO Form1-RADIO-1-BUF
           WHEN OTHER
              MOVE ZERO TO Form1-RADIO-1-BUF
           END-EVALUATE
      * DB_Entry-Field : ef-gg
           MOVE cli-gg-dilazione TO ef-gg-BUF
      * DB_CHECK BOX : chk-fido
              IF cli-gestione-fido = 1
                 MOVE 1 TO chk-fido-BUF
              ELSE
                 MOVE 0 TO chk-fido-BUF
              END-IF
      * DB_Entry-Field : ef-esi
           MOVE cli-esigibilita-iva TO ef-esi-BUF
      * DB_Entry-Field : ef-codfis
           MOVE cli-codfis TO ef-codfis-BUF
      * DB_Entry-Field : ef-piva
           MOVE cli-piva TO ef-piva-BUF
      * DB_Entry-Field : ef-iva-ese
           MOVE cli-iva-ese TO ef-iva-ese-BUF
      * DB_Entry-Field : ef-pag
           MOVE cli-pag TO ef-pag-BUF
      * DB_Entry-Field : ef-cod-iva
           MOVE cli-iva TO ef-cod-iva-BUF
      * DB_CHECK BOX : chk-spost-ago
              IF cli-spost-ric-agosto = "S"
                 MOVE 1 TO chk-spost-ago-BUF
              ELSE
                 MOVE 0 TO chk-spost-ago-BUF
              END-IF
      * DB_CHECK BOX : chk-spost-dic
              IF cli-spost-ric-dicembre = "S"
                 MOVE 1 TO chk-spost-dic-BUF
              ELSE
                 MOVE 0 TO chk-spost-dic-BUF
              END-IF
      * DB_Entry-Field : ef-fido
           MOVE cli-fido TO ef-fido-BUF
      * DB_Entry-Field : ef-fido-data
           MOVE cli-fido-data TO ef-fido-data-BUF
      * DB_Entry-Field : ef-fido-extra
           MOVE cli-fido-extra TO ef-fido-extra-BUF
      * DB_Entry-Field : ef-fide
           MOVE cli-fidejussione TO ef-fide-BUF
      * DB_Entry-Field : ef-PFA
           MOVE cli-pfa TO ef-PFA-BUF
      * DB_Entry-Field : ef-data-fido-extra
           MOVE cli-data-fido-extra TO ef-data-fido-extra-BUF
      * DB_Entry-Field : ef-grade
           MOVE cli-grade TO ef-grade-BUF
      * DB_Entry-Field : ef-abi
           MOVE cli-abi TO ef-abi-BUF
      * DB_Entry-Field : ef-cab
           MOVE cli-cab TO ef-cab-BUF
      * DB_LABEL : lab-agente
              MOVE age-ragsoc-1  TO lab-agente-BUF
      * DB_LABEL : lab-vettore
              MOVE vet-descrizione  TO lab-vettore-BUF
      * DB_LABEL : lab-tipo
              MOVE tcl-descrizione  TO lab-tipo-BUF
      * DB_LABEL : lab-gdo
              MOVE gdo-intestazione  TO lab-gdo-BUF
      * DB_LABEL : lab-nazione
              MOVE naz-descrizione  TO lab-nazione-BUF
      * DB_LABEL : lab-citta
              MOVE prv-descrizione  TO lab-citta-BUF
      * DB_LABEL : lab-regione
              MOVE reg-descrizione  TO lab-regione-BUF
      * DB_LABEL : lab-agente2
              MOVE age-ragsoc-1  TO lab-agente2-BUF
      * DB_Entry-Field : ef-ragsoc-1-d
           MOVE des-ragsoc-1 TO ef-ragsoc-1-d-BUF
      * DB_Entry-Field : ef-ragsoc-2-d
           MOVE des-ragsoc-2 TO ef-ragsoc-2-d-BUF
      * DB_Entry-Field : ef-indirizzo-d
           MOVE des-indirizzo TO ef-indirizzo-d-BUF
      * DB_Entry-Field : ef-cap-d
           MOVE des-cap TO ef-cap-d-BUF
      * DB_Entry-Field : ef-localita-d
           MOVE des-localita TO ef-localita-d-BUF
      * DB_Entry-Field : ef-prov-d
           MOVE des-prov TO ef-prov-d-BUF
      * DB_Entry-Field : ef-nazione-d
           MOVE des-nazione TO ef-nazione-d-BUF
      * DB_CHECK BOX : chk-invio-d
              IF des-invio-fatt = "S"
                 MOVE 1 TO chk-invio-d-BUF
              ELSE
                 MOVE 0 TO chk-invio-d-BUF
              END-IF
      * DB_Entry-Field : ef-telef-1-d
           MOVE des-telef-1 TO ef-telef-1-d-BUF
      * DB_Entry-Field : ef-telef-2-d
           MOVE des-telef-2 TO ef-telef-2-d-BUF
      * DB_Entry-Field : ef-fax-d
           MOVE des-fax TO ef-fax-d-BUF
      * DB_Entry-Field : ef-mail-d
           MOVE des-mail TO ef-mail-d-BUF
      * DB_Entry-Field : ef-referente-d
           MOVE des-referente TO ef-referente-d-BUF
      * DB_Entry-Field : ef-piva-d
           MOVE des-piva TO ef-piva-d-BUF
      * DB_Entry-Field : ef-agente-d
           MOVE des-age-codice TO ef-agente-d-BUF
      * DB_Entry-Field : ef-vettore-d
           MOVE des-vettore TO ef-vettore-d-BUF
      * DB_CHECK BOX : chk-deposito-utf
              IF des-deposito-utf = "S"
                 MOVE 1 TO chk-deposito-utf-BUF
              ELSE
                 MOVE 0 TO chk-deposito-utf-BUF
              END-IF
      * DB_CHECK BOX : chk-superamento-d
              IF des-superamento-500 = "S"
                 MOVE 1 TO chk-superamento-d-BUF
              ELSE
                 MOVE 0 TO chk-superamento-d-BUF
              END-IF
      * DB_Entry-Field : ef-cod-ditta-d
           MOVE des-cod-ditta TO ef-cod-ditta-d-BUF
      * DB_Entry-Field : ef-CIG-d
           MOVE des-CIG TO ef-CIG-d-BUF
      * DB_Entry-Field : ef-note-1
           MOVE not-note-1 OF note1 TO ef-note-1-BUF
      * DB_Entry-Field : ef-note-data
           MOVE not-data OF note1 TO ef-note-data-BUF
      * DB_Entry-Field : ef-note-2
           MOVE not-note-2 OF note1 TO ef-note-2-BUF
      * DB_Entry-Field : ef-note-3
           MOVE not-note-3 OF note1 TO ef-note-3-BUF
      * DB_Entry-Field : ef-note-4
           MOVE not-note-4 OF note1 TO ef-note-4-BUF
      * DB_LABEL : lab-vettore-d
              MOVE vet-descrizione  TO lab-vettore-d-BUF
      * DB_LABEL : lab-nazione-d
              MOVE naz-descrizione  TO lab-nazione-d-BUF
      * DB_LABEL : lab-citta-d
              MOVE prv-descrizione  TO lab-citta-d-BUF
      * DB_LABEL : lab-regione-d
              MOVE reg-descrizione  TO lab-regione-d-BUF
      * DB_LABEL : lab-agente-d
              MOVE age-ragsoc-1  TO lab-agente-d-BUF
      * DB_Entry-Field : ef-ragsoc-1-r
           MOVE rec-ragsoc-1 TO ef-ragsoc-1-r-BUF
      * DB_Entry-Field : ef-ragsoc-2-r
           MOVE rec-ragsoc-2 TO ef-ragsoc-2-r-BUF
      * DB_Entry-Field : ef-indirizzo-r
           MOVE rec-indirizzo TO ef-indirizzo-r-BUF
      * DB_Entry-Field : ef-localita-r
           MOVE rec-localita TO ef-localita-r-BUF
      * DB_Entry-Field : ef-cap-r
           MOVE rec-cap TO ef-cap-r-BUF
      * DB_Entry-Field : ef-prov-r
           MOVE rec-provincia TO ef-prov-r-BUF
      * DB_Entry-Field : ef-nazione-r
           MOVE rec-nazione TO ef-nazione-r-BUF
      * DB_CHECK BOX : chk-dett-dest-sdi
              IF rec-dett-dest-SDI = "S"
                 MOVE 1 TO chk-dett-dest-sdi-BUF
              ELSE
                 MOVE 0 TO chk-dett-dest-sdi-BUF
              END-IF
      * DB_CHECK BOX : chk-escludi-int
              IF rec-escludi-int = "S"
                 MOVE 1 TO chk-escludi-int-BUF
              ELSE
                 MOVE 0 TO chk-escludi-int-BUF
              END-IF
      * DB_Entry-Field : ef-dich-n
           MOVE cli-dich-esp TO ef-dich-n-BUF
      * DB_Entry-Field : ef-data-dich
           MOVE cli-data-dich TO ef-data-dich-BUF
      * DB_Entry-Field : ef-data-reg
           MOVE cli-data-reg TO ef-data-reg-BUF
      * DB_Entry-Field : ef-reg-n
           MOVE cli-num-reg TO ef-reg-n-BUF
      * DB_LABEL : lab-citta-r
              MOVE prv-descrizione  TO lab-citta-r-BUF
      * DB_LABEL : lab-regione-r
              MOVE naz-descrizione  TO lab-regione-r-BUF
      * DB_LABEL : lab-nazione-r
              MOVE naz-descrizione  TO lab-nazione-r-BUF
      * DB_CHECK BOX : chk-escludi-e
              IF ecd-escludi-OLD = 1
                 MOVE 1 TO chk-escludi-e-BUF
              ELSE
                 MOVE 0 TO chk-escludi-e-BUF
              END-IF
      * DB_CHECK BOX : chk-intera-e
              IF ecd-escludi-OLD = 1
                 MOVE 1 TO chk-intera-e-BUF
              ELSE
                 MOVE 0 TO chk-intera-e-BUF
              END-IF
      * DB_CHECK BOX : chk-accorpa-e
              IF ecd-accorpa-OLD = 1
                 MOVE 1 TO chk-accorpa-e-BUF
              ELSE
                 MOVE 0 TO chk-accorpa-e-BUF
              END-IF
      * DB_CHECK BOX : chk-saldo-banco-e
              IF ecd-saldi-banco-OLD = 1
                 MOVE 1 TO chk-saldo-banco-e-BUF
              ELSE
                 MOVE 0 TO chk-saldo-banco-e-BUF
              END-IF
      * DB_CHECK BOX : chk-saldo-promo-e
              IF ecd-saldi-promo-OLD = 1
                 MOVE 1 TO chk-saldo-promo-e-BUF
              ELSE
                 MOVE 0 TO chk-saldo-promo-e-BUF
              END-IF
      * DB_Entry-Field : ef-gg-e
           MOVE ecd-gg-scadenza-vol-OLD TO ef-gg-e-BUF
      * DB_Entry-Field : ef-id-edi
           MOVE ecd-id-edi TO ef-id-edi-BUF
      * DB_Entry-Field : ef-q-id-edi
           MOVE ecd-q-id-edi TO ef-q-id-edi-BUF
      * DB_Entry-Field : ef-codforn-edi
           MOVE ecd-codforn TO ef-codforn-edi-BUF
      * DB_Entry-Field : ef-q-codforn-edi
           MOVE ecd-q-codforn TO ef-q-codforn-edi-BUF
      * DB_Entry-Field : ef-piva-c-edi
           MOVE ecd-piva TO ef-piva-c-edi-BUF
      * DB_Entry-Field : ef-ragsoc-c-edi
           MOVE ecd-ragsoc-c TO ef-ragsoc-c-edi-BUF
      * DB_Entry-Field : ef-ind-c-edi
           MOVE ecd-indirizzo-c TO ef-ind-c-edi-BUF
      * DB_Entry-Field : ef-citta-c-edi
           MOVE ecd-citta-c TO ef-citta-c-edi-BUF
      * DB_Entry-Field : ef-prov-c-edi
           MOVE ecd-prov-c TO ef-prov-c-edi-BUF
      * DB_Entry-Field : ef-cap-c-edi
           MOVE ecd-cap-c TO ef-cap-c-edi-BUF
      * DB_Entry-Field : ef-codcli-edi
           MOVE ecd-cod-dest TO ef-codcli-edi-BUF
      * DB_Entry-Field : ef-q-codcli-edi
           MOVE ecd-q-cod-dest TO ef-q-codcli-edi-BUF
      * DB_Entry-Field : ef-dest-edi
           MOVE ecd-cod-consegna TO ef-dest-edi-BUF
      * DB_Entry-Field : ef-q-dest-edi
           MOVE ecd-q-cod-consegna TO ef-q-dest-edi-BUF
      * DB_Entry-Field : ef-ragsoc-d-edi
           MOVE ecd-ragsoc-d TO ef-ragsoc-d-edi-BUF
      * DB_Entry-Field : ef-ind-d-edi
           MOVE ecd-indirizzo-d TO ef-ind-d-edi-BUF
      * DB_Entry-Field : ef-citta-d-edi
           MOVE ecd-citta-d TO ef-citta-d-edi-BUF
      * DB_Entry-Field : ef-prov-d-edi
           MOVE ecd-prov-d TO ef-prov-d-edi-BUF
      * DB_Entry-Field : ef-cap-d-edi
           MOVE ecd-cap-d TO ef-cap-d-edi-BUF
      * DB_CHECK BOX : chk-imp-i
              IF ecd-import-importi = 1
                 MOVE 1 TO chk-imp-i-BUF
              ELSE
                 MOVE 0 TO chk-imp-i-BUF
              END-IF
      * DB_CHECK BOX : chk-imp-a
              IF ecd-import-articoli = 1
                 MOVE 1 TO chk-imp-a-BUF
              ELSE
                 MOVE 0 TO chk-imp-a-BUF
              END-IF
      * DB_CHECK BOX : chk-exp-i
              IF ecd-export-imposte = 1
                 MOVE 1 TO chk-exp-i-BUF
              ELSE
                 MOVE 0 TO chk-exp-i-BUF
              END-IF
      * DB_Entry-Field : ef-note-cli
           MOVE notc-note TO ef-note-cli-BUF
      * DB_LABEL : lab-data
              MOVE cli-data-creazione  TO lab-data-BUF
      * DB_LABEL : lab-des
              MOVE cli-ragsoc-1  TO lab-des-BUF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
           perform GCLIENTI-AFTER-FLD-TO-BUF.

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           if cli-ragsoc-1 not = old-cli-ragsoc-1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ragsoc-1 è l'ID del campo ef-ragsoc-1
              move 78-ID-ef-ragsoc-1 to store-id 
           end-if

           if cli-ragsoc-2 not = old-cli-ragsoc-2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ragsoc-2 è l'ID del campo ef-ragsoc-2
              move 78-ID-ef-ragsoc-2 to store-id 
           end-if

           if cli-indirizzo not = old-cli-indirizzo
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-indirizzo è l'ID del campo ef-indirizzo
              move 78-ID-ef-indirizzo to store-id 
           end-if

           if cli-cap not = old-cli-cap
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cap è l'ID del campo ef-cap
              move 78-ID-ef-cap to store-id 
           end-if

           if cli-localita not = old-cli-localita
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-localita è l'ID del campo ef-localita
              move 78-ID-ef-localita to store-id 
           end-if

           if cli-prov not = old-cli-prov
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-prov è l'ID del campo ef-prov
              move 78-ID-ef-prov to store-id 
           end-if

           if cli-nazione not = old-cli-nazione
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-nazione è l'ID del campo ef-nazione
              move 78-ID-ef-nazione to store-id 
           end-if

           if cli-codice-SDI not = old-cli-codice-SDI
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-sdi è l'ID del campo ef-sdi
              move 78-ID-ef-sdi to store-id 
           end-if

           if cli-tel-1 not = old-cli-tel-1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-tel-1 è l'ID del campo ef-tel-1
              move 78-ID-ef-tel-1 to store-id 
           end-if

           if cli-tel-2 not = old-cli-tel-2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-tel-2 è l'ID del campo ef-tel-2
              move 78-ID-ef-tel-2 to store-id 
           end-if

           if cli-fax not = old-cli-fax
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-fax è l'ID del campo ef-fax
              move 78-ID-ef-fax to store-id 
           end-if

           if cli-email not = old-cli-email
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-mail è l'ID del campo ef-mail
              move 78-ID-ef-mail to store-id 
           end-if

           if cli-pec not = old-cli-pec
              and SiSalvato
              set NoSalvato to true
              |15 è l'ID del campo ef-maila
              move 15 to store-id
           end-if

           if cli-web not = old-cli-web
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-url è l'ID del campo ef-url
              move 78-ID-ef-url to store-id 
           end-if

           if cli-tipo not = old-cli-tipo
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-tipo è l'ID del campo ef-tipo
              move 78-ID-ef-tipo to store-id 
           end-if

           if cli-gdo not = old-cli-gdo
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-gdo è l'ID del campo ef-gdo
              move 78-ID-ef-gdo to store-id 
           end-if

           if cli-utf not = old-cli-utf
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-utf è l'ID del campo chk-utf
              move 78-ID-chk-utf to store-id 
           end-if

           if cli-referente not = old-cli-referente
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-referente è l'ID del campo ef-referente
              move 78-ID-ef-referente to store-id 
           end-if

           if cli-vettore not = old-cli-vettore
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-vettore è l'ID del campo ef-vettore
              move 78-ID-ef-vettore to store-id 
           end-if

           if cli-inoltro not = old-cli-inoltro
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-inoltro è l'ID del campo chk-inoltro
              move 78-ID-chk-inoltro to store-id 
           end-if

           if cli-agente not = old-cli-agente
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-agente è l'ID del campo ef-agente
              move 78-ID-ef-agente to store-id 
           end-if

           if cli-stato not = old-cli-stato
              and SiSalvato
              set NoSalvato to true
              |78-ID-cbo-stato è l'ID del campo cbo-stato
              move 78-ID-cbo-stato to store-id 
           end-if

           if cli-cau-blocco not = old-cli-cau-blocco
              and SiSalvato
              set NoSalvato to true
              |78-ID-cbo-cau-blocco è l'ID del campo cbo-cau-blocco
              move 78-ID-cbo-cau-blocco to store-id 
           end-if

           if cli-agente2 not = old-cli-agente2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-agente2 è l'ID del campo ef-agente2
              move 78-ID-ef-agente2 to store-id 
           end-if

           if cli-superamento-500 not = old-cli-superamento-500
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-superamento è l'ID del campo chk-superamento
              move 78-ID-chk-superamento to store-id 
           end-if

           if cli-blocco-24000 not = old-cli-blocco-24000
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-24000 è l'ID del campo chk-24000
              move 78-ID-chk-24000 to store-id 
           end-if

           if cli-cod-ditta not = old-cli-cod-ditta
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cod-ditta è l'ID del campo ef-cod-ditta
              move 78-ID-ef-cod-ditta to store-id 
           end-if

           if cli-pfa-perce not = old-cli-pfa-perce
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-PFA-perce è l'ID del campo ef-PFA-perce
              move 78-ID-ef-PFA-perce to store-id 
           end-if

           if cli-note not = old-cli-note
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note è l'ID del campo ef-note
              move 78-ID-ef-note to store-id 
           end-if

           if cli-note-agg not = old-cli-note-agg
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-agg è l'ID del campo ef-note-agg
              move 78-ID-ef-note-agg to store-id 
           end-if

           if cli-sost not = old-cli-sost
              and SiSalvato
              set NoSalvato to true
              |78-ID-cbo-sost-art è l'ID del campo cbo-sost-art
              move 78-ID-cbo-sost-art to store-id 
           end-if

           if cli-tipo-art not = old-cli-tipo-art
              and SiSalvato
              set NoSalvato to true
              |78-ID-cbo-tipo-art è l'ID del campo cbo-tipo-art
              move 78-ID-cbo-tipo-art to store-id 
           end-if

           if cli-invio-bolle-EDI not = old-cli-invio-bolle-EDI
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-invio-bolle-EDI è l'ID del campo chk-invio-bolle-EDI
              move 78-ID-chk-invio-bolle-EDI to store-id 
           end-if

           if cli-destino-auto-EDI not = old-cli-destino-auto-EDI
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-destino-auto è l'ID del campo chk-destino-auto
              move 78-ID-chk-destino-auto to store-id 
           end-if

           if cli-escludi-fido not = old-cli-escludi-fido
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-escludi-fido è l'ID del campo chk-escludi-fido
              move 78-ID-chk-escludi-fido to store-id 
           end-if

           if cli-contrassegno not = old-cli-contrassegno
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-contrassegno è l'ID del campo chk-contrassegno
              move 78-ID-chk-contrassegno to store-id 
           end-if

           if cli-tipo-persona not = old-cli-tipo-persona
              and SiSalvato
              set NoSalvato to true
              |78-ID-rb-pers è l'ID del campo rb-pers
              move 78-ID-rb-pers to store-id 
           end-if

           if cli-tipo-persona not = old-cli-tipo-persona
              and SiSalvato
              set NoSalvato to true
              |78-ID-rb-soc è l'ID del campo rb-soc
              move 78-ID-rb-soc to store-id 
           end-if

           if cli-gg-dilazione not = old-cli-gg-dilazione
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-gg è l'ID del campo ef-gg
              move 78-ID-ef-gg to store-id 
           end-if

           if cli-gestione-fido not = old-cli-gestione-fido
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-fido è l'ID del campo chk-fido
              move 78-ID-chk-fido to store-id 
           end-if

           if cli-esigibilita-iva not = old-cli-esigibilita-iva
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-esi è l'ID del campo ef-esi
              move 78-ID-ef-esi to store-id 
           end-if

           if cli-codfis not = old-cli-codfis
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-codfis è l'ID del campo ef-codfis
              move 78-ID-ef-codfis to store-id 
           end-if

           if cli-piva not = old-cli-piva
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-piva è l'ID del campo ef-piva
              move 78-ID-ef-piva to store-id 
           end-if

           if cli-iva-ese not = old-cli-iva-ese
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-iva-ese è l'ID del campo ef-iva-ese
              move 78-ID-ef-iva-ese to store-id 
           end-if

           if cli-pag not = old-cli-pag
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-pag è l'ID del campo ef-pag
              move 78-ID-ef-pag to store-id 
           end-if

           if cli-iva not = old-cli-iva
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cod-iva è l'ID del campo ef-cod-iva
              move 78-ID-ef-cod-iva to store-id 
           end-if

           if cli-spost-ric-agosto not = old-cli-spost-ric-agosto
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-spost-ago è l'ID del campo chk-spost-ago
              move 78-ID-chk-spost-ago to store-id 
           end-if

           if cli-spost-ric-dicembre not = old-cli-spost-ric-dicembre
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-spost-dic è l'ID del campo chk-spost-dic
              move 78-ID-chk-spost-dic to store-id 
           end-if

           if cli-fido not = old-cli-fido
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-fido è l'ID del campo ef-fido
              move 78-ID-ef-fido to store-id 
           end-if

           if cli-fido-data not = old-cli-fido-data
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-fido-data è l'ID del campo ef-fido-data
              move 78-ID-ef-fido-data to store-id 
           end-if

           if cli-fido-extra not = old-cli-fido-extra
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-fido-extra è l'ID del campo ef-fido-extra
              move 78-ID-ef-fido-extra to store-id 
           end-if

           if cli-fidejussione not = old-cli-fidejussione
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-fide è l'ID del campo ef-fide
              move 78-ID-ef-fide to store-id 
           end-if

           if cli-pfa not = old-cli-pfa
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-PFA è l'ID del campo ef-PFA
              move 78-ID-ef-PFA to store-id 
           end-if

           if cli-data-fido-extra not = old-cli-data-fido-extra
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data-fido-extra è l'ID del campo ef-data-fido-extra
              move 78-ID-ef-data-fido-extra to store-id 
           end-if

           if cli-grade not = old-cli-grade
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-grade è l'ID del campo ef-grade
              move 78-ID-ef-grade to store-id 
           end-if

           if cli-abi not = old-cli-abi
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-abi è l'ID del campo ef-abi
              move 78-ID-ef-abi to store-id 
           end-if

           if cli-cab not = old-cli-cab
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cab è l'ID del campo ef-cab
              move 78-ID-ef-cab to store-id 
           end-if

           if des-tipo-art not = old-des-tipo-art
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cod-ditta-d è l'ID del campo ef-cod-ditta-d
              move 78-ID-ef-cod-ditta-d to store-id 
           end-if

           if rec-ragsoc-1 not = old-rec-ragsoc-1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ragsoc-1-r è l'ID del campo ef-ragsoc-1-r
              move 78-ID-ef-ragsoc-1-r to store-id 
           end-if

           if rec-ragsoc-2 not = old-rec-ragsoc-2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ragsoc-2-r è l'ID del campo ef-ragsoc-2-r
              move 78-ID-ef-ragsoc-2-r to store-id 
           end-if

           if rec-indirizzo not = old-rec-indirizzo
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-indirizzo-r è l'ID del campo ef-indirizzo-r
              move 78-ID-ef-indirizzo-r to store-id 
           end-if

           if rec-localita not = old-rec-localita
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-localita-r è l'ID del campo ef-localita-r
              move 78-ID-ef-localita-r to store-id 
           end-if

           if rec-cap not = old-rec-cap
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cap-r è l'ID del campo ef-cap-r
              move 78-ID-ef-cap-r to store-id 
           end-if

           if rec-provincia not = old-rec-provincia
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-prov-r è l'ID del campo ef-prov-r
              move 78-ID-ef-prov-r to store-id 
           end-if

           if rec-nazione not = old-rec-nazione
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-nazione-r è l'ID del campo ef-nazione-r
              move 78-ID-ef-nazione-r to store-id 
           end-if

           if rec-invio not = old-rec-invio
              and SiSalvato
              set NoSalvato to true
              |78-ID-cbo-invio è l'ID del campo cbo-invio
              move 78-ID-cbo-invio to store-id 
           end-if

           if rec-dett-dest-SDI not = old-rec-dett-dest-SDI
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-dett-dest-sdi è l'ID del campo chk-dett-dest-sdi
              move 78-ID-chk-dett-dest-sdi to store-id 
           end-if

           if rec-escludi-int not = old-rec-escludi-int
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-escludi-int è l'ID del campo chk-escludi-int
              move 78-ID-chk-escludi-int to store-id 
           end-if

           if cli-dich-esp not = old-cli-dich-esp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-dich-n è l'ID del campo ef-dich-n
              move 78-ID-ef-dich-n to store-id 
           end-if

           if cli-data-dich not = old-cli-data-dich
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data-dich è l'ID del campo ef-data-dich
              move 78-ID-ef-data-dich to store-id 
           end-if

           if cli-data-reg not = old-cli-data-reg
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data-reg è l'ID del campo ef-data-reg
              move 78-ID-ef-data-reg to store-id 
           end-if

           if cli-num-reg not = old-cli-num-reg
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-reg-n è l'ID del campo ef-reg-n
              move 78-ID-ef-reg-n to store-id 
           end-if

           if notc-note not = old-notc-note
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-cli è l'ID del campo ef-note-cli
              move 78-ID-ef-note-cli to store-id 
           end-if

           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           MOVE DataSet1-clienti-KEY1-ORDER TO TMP-Form1-KEY1-ORDER
           MOVE DataSet1-clienti-KEY2-ORDER TO TMP-Form1-KEY2-ORDER
           MOVE DataSet1-KEYIS TO TMP-Form1-KEYIS
           MOVE cli-rec OF clienti TO 
              TMP-Form1-clienti-RESTOREBUF
           .             

       Form1-Restore-Status.
           MOVE TMP-Form1-KEY1-ORDER TO DataSet1-clienti-KEY1-ORDER
           MOVE TMP-Form1-KEY2-ORDER TO DataSet1-clienti-KEY2-ORDER
           MOVE TMP-Form1-KEYIS TO DataSet1-KEYIS
           MOVE TMP-Form1-clienti-RESTOREBUF TO
              cli-rec OF clienti
           PERFORM DataSet1-clienti-START
           IF Valid-STATUS-clienti
              PERFORM DataSet1-clienti-Read-Next
           ELSE
              PERFORM DataSet1-clienti-INITREC
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-clienti OR
              (Valid-STATUS-clienti AND
                 cli-rec OF clienti = 
                   TMP-Form1-clienti-RESTOREBUF)
              PERFORM DataSet1-clienti-Read-Next
           END-PERFORM
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-cap è l'ID del campo ef-cap
           when 78-ID-ef-cap
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-prov è l'ID del campo ef-prov
           when 78-ID-ef-prov
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-nazione è l'ID del campo ef-nazione
           when 78-ID-ef-nazione
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-tipo è l'ID del campo ef-tipo
           when 78-ID-ef-tipo
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-gdo è l'ID del campo ef-gdo
           when 78-ID-ef-gdo
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-vettore è l'ID del campo ef-vettore
           when 78-ID-ef-vettore
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-agente è l'ID del campo ef-agente
           when 78-ID-ef-agente
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-agente2 è l'ID del campo ef-agente2
           when 78-ID-ef-agente2
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-iva-ese è l'ID del campo ef-iva-ese
           when 78-ID-ef-iva-ese
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cod-iva è l'ID del campo ef-cod-iva
           when 78-ID-ef-cod-iva
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-abi è l'ID del campo ef-abi
           when 78-ID-ef-abi
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cab è l'ID del campo ef-cab
           when 78-ID-ef-cab
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cap-d è l'ID del campo ef-cap-d
           when 78-ID-ef-cap-d
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-prov-d è l'ID del campo ef-prov-d
           when 78-ID-ef-prov-d
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-nazione-d è l'ID del campo ef-nazione-d
           when 78-ID-ef-nazione-d
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-agente-d è l'ID del campo ef-agente-d
           when 78-ID-ef-agente-d
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-vettore-d è l'ID del campo ef-vettore-d
           when 78-ID-ef-vettore-d
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-prov-r è l'ID del campo ef-prov-r
           when 78-ID-ef-prov-r
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-nazione-r è l'ID del campo ef-nazione-r
           when 78-ID-ef-nazione-r
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |78-ID-ef-PFA-perce è l'ID del campo ef-PFA-perce
           when 78-ID-ef-PFA-perce
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-fido è l'ID del campo ef-fido
           when 78-ID-ef-fido
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-fido-extra è l'ID del campo ef-fido-extra
           when 78-ID-ef-fido-extra
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-fide è l'ID del campo ef-fide
           when 78-ID-ef-fide
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-PFA è l'ID del campo ef-PFA
           when 78-ID-ef-PFA
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-cap è l'ID del campo ef-cap
           when 78-ID-ef-cap
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-prov è l'ID del campo ef-prov
           when 78-ID-ef-prov
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-nazione è l'ID del campo ef-nazione
           when 78-ID-ef-nazione
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-tipo è l'ID del campo ef-tipo
           when 78-ID-ef-tipo
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-gdo è l'ID del campo ef-gdo
           when 78-ID-ef-gdo
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-vettore è l'ID del campo ef-vettore
           when 78-ID-ef-vettore
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-agente è l'ID del campo ef-agente
           when 78-ID-ef-agente
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-agente2 è l'ID del campo ef-agente2
           when 78-ID-ef-agente2
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-iva-ese è l'ID del campo ef-iva-ese
           when 78-ID-ef-iva-ese
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cod-iva è l'ID del campo ef-cod-iva
           when 78-ID-ef-cod-iva
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-abi è l'ID del campo ef-abi
           when 78-ID-ef-abi
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cab è l'ID del campo ef-cab
           when 78-ID-ef-cab
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cap-d è l'ID del campo ef-cap-d
           when 78-ID-ef-cap-d
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-prov-d è l'ID del campo ef-prov-d
           when 78-ID-ef-prov-d
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-nazione-d è l'ID del campo ef-nazione-d
           when 78-ID-ef-nazione-d
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-agente-d è l'ID del campo ef-agente-d
           when 78-ID-ef-agente-d
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-vettore-d è l'ID del campo ef-vettore-d
           when 78-ID-ef-vettore-d
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-prov-r è l'ID del campo ef-prov-r
           when 78-ID-ef-prov-r
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-nazione-r è l'ID del campo ef-nazione-r
           when 78-ID-ef-nazione-r
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |78-ID-ef-PFA-perce è l'ID del campo ef-PFA-perce
           when 78-ID-ef-PFA-perce
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-fido è l'ID del campo ef-fido
           when 78-ID-ef-fido
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-fido-extra è l'ID del campo ef-fido-extra
           when 78-ID-ef-fido-extra
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-fide è l'ID del campo ef-fide
           when 78-ID-ef-fide
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-PFA è l'ID del campo ef-PFA
           when 78-ID-ef-PFA
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |78-ID-ef-codice è l'ID del campo ef-codice
           when 78-ID-ef-codice
                perform CONTROLLO
           |78-ID-ef-ragsoc-1 è l'ID del campo ef-ragsoc-1
           when 78-ID-ef-ragsoc-1
                perform CONTROLLO
           |78-ID-ef-indirizzo è l'ID del campo ef-indirizzo
           when 78-ID-ef-indirizzo
                perform CONTROLLO
           |78-ID-ef-cap è l'ID del campo ef-cap
           when 78-ID-ef-cap
                perform CONTROLLO
           |78-ID-ef-localita è l'ID del campo ef-localita
           when 78-ID-ef-localita
                perform CONTROLLO
           |78-ID-ef-prov è l'ID del campo ef-prov
           when 78-ID-ef-prov
                perform CONTROLLO
           |78-ID-ef-nazione è l'ID del campo ef-nazione
           when 78-ID-ef-nazione
                perform CONTROLLO
           |78-ID-ef-sdi è l'ID del campo ef-sdi
           when 78-ID-ef-sdi
                perform CONTROLLO
           |78-ID-ef-mail è l'ID del campo ef-mail
           when 78-ID-ef-mail
                perform CONTROLLO
           |15 è l'ID del campo ef-maila
           when 15
                perform CONTROLLO
           |78-ID-ef-tipo è l'ID del campo ef-tipo
           when 78-ID-ef-tipo
                perform CONTROLLO
           |78-ID-ef-gdo è l'ID del campo ef-gdo
           when 78-ID-ef-gdo
                perform CONTROLLO
           |78-ID-ef-vettore è l'ID del campo ef-vettore
           when 78-ID-ef-vettore
                perform CONTROLLO
           |78-ID-ef-agente è l'ID del campo ef-agente
           when 78-ID-ef-agente
                perform CONTROLLO
           |78-ID-cbo-stato è l'ID del campo cbo-stato
           when 78-ID-cbo-stato
                perform CONTROLLO
           |78-ID-cbo-cau-blocco è l'ID del campo cbo-cau-blocco
           when 78-ID-cbo-cau-blocco
                perform CONTROLLO
           |78-ID-ef-agente2 è l'ID del campo ef-agente2
           when 78-ID-ef-agente2
                perform CONTROLLO
           |78-ID-ef-gg è l'ID del campo ef-gg
           when 78-ID-ef-gg
                perform CONTROLLO
           |78-ID-ef-esi è l'ID del campo ef-esi
           when 78-ID-ef-esi
                perform CONTROLLO
           |78-ID-ef-codfis è l'ID del campo ef-codfis
           when 78-ID-ef-codfis
                perform CONTROLLO
           |78-ID-ef-piva è l'ID del campo ef-piva
           when 78-ID-ef-piva
                perform CONTROLLO
           |78-ID-ef-iva-ese è l'ID del campo ef-iva-ese
           when 78-ID-ef-iva-ese
                perform CONTROLLO
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                perform CONTROLLO
           |78-ID-ef-cod-iva è l'ID del campo ef-cod-iva
           when 78-ID-ef-cod-iva
                perform CONTROLLO
           |78-ID-ef-fido-data è l'ID del campo ef-fido-data
           when 78-ID-ef-fido-data
                perform CONTROLLO
           |78-ID-ef-fide è l'ID del campo ef-fide
           when 78-ID-ef-fide
                perform CONTROLLO
           |78-ID-ef-data-fido-extra è l'ID del campo ef-data-fido-extra
           when 78-ID-ef-data-fido-extra
                perform CONTROLLO
           |78-ID-ef-grade è l'ID del campo ef-grade
           when 78-ID-ef-grade
                perform CONTROLLO
           |78-ID-ef-cab è l'ID del campo ef-cab
           when 78-ID-ef-cab
                perform CONTROLLO
           |78-ID-ef-ragsoc-1-d è l'ID del campo ef-ragsoc-1-d
           when 78-ID-ef-ragsoc-1-d
                perform CONTROLLO
           |78-ID-ef-indirizzo-d è l'ID del campo ef-indirizzo-d
           when 78-ID-ef-indirizzo-d
                perform CONTROLLO
           |78-ID-ef-cap-d è l'ID del campo ef-cap-d
           when 78-ID-ef-cap-d
                perform CONTROLLO
           |78-ID-ef-localita-d è l'ID del campo ef-localita-d
           when 78-ID-ef-localita-d
                perform CONTROLLO
           |78-ID-ef-prov-d è l'ID del campo ef-prov-d
           when 78-ID-ef-prov-d
                perform CONTROLLO
           |78-ID-ef-nazione-d è l'ID del campo ef-nazione-d
           when 78-ID-ef-nazione-d
                perform CONTROLLO
           |78-ID-ef-piva-d è l'ID del campo ef-piva-d
           when 78-ID-ef-piva-d
                perform CONTROLLO
           |78-ID-ef-agente-d è l'ID del campo ef-agente-d
           when 78-ID-ef-agente-d
                perform CONTROLLO
           |78-ID-ef-vettore-d è l'ID del campo ef-vettore-d
           when 78-ID-ef-vettore-d
                perform CONTROLLO
           |78-ID-ef-note-data è l'ID del campo ef-note-data
           when 78-ID-ef-note-data
                perform CONTROLLO
           |78-ID-ef-prov-r è l'ID del campo ef-prov-r
           when 78-ID-ef-prov-r
                perform CONTROLLO
           |78-ID-ef-nazione-r è l'ID del campo ef-nazione-r
           when 78-ID-ef-nazione-r
                perform CONTROLLO
           |78-ID-cbo-invio è l'ID del campo cbo-invio
           when 78-ID-cbo-invio
                perform CONTROLLO
           |78-ID-ef-data-dich è l'ID del campo ef-data-dich
           when 78-ID-ef-data-dich
                perform CONTROLLO
           |78-ID-ef-data-reg è l'ID del campo ef-data-reg
           when 78-ID-ef-data-reg
                perform CONTROLLO
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.

       scr-stampa-Open-Routine.
           PERFORM scr-stampa-Scrn
           PERFORM scr-stampa-Proc
           .

       scr-stampa-Scrn.
           PERFORM scr-stampa-Create-Win
           PERFORM scr-stampa-Init-Value
           PERFORM scr-stampa-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1a
           PERFORM scr-stampa-DISPLAY
           .

       scr-stampa-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 21,78,
              SIZE 34,50,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Verdana12-Occidentale,
              LINK TO THREAD,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE scr-stampa-Event-Proc,
              HANDLE IS scr-stampa-Handle,
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,67,   
              HANDLE IN Form1-Tb-1-Handlea
           DISPLAY Form1-Tb-1a UPON Form1-Tb-1-Handlea

      * Status-bar
           DISPLAY scr-stampa UPON scr-stampa-Handle
      * DISPLAY-COLUMNS settings
           .

       scr-stampa-PROC.
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, BeforeAccept>
           perform SCR-STAMPA-BEFORE-ACCEPT.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT scr-stampa
                 ON EXCEPTION
                    PERFORM scr-stampa-Evaluate-Func
                 MOVE 2 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY scr-stampa-Handle
           INITIALIZE Key-Status
           .

       scr-stampa-Evaluate-Func.
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM scr-stampa-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM scr-stampa-Exit
                 END-IF
              WHEN Key-Status = 1001
                 PERFORM chk-st-cli-LinkTo
              WHEN Key-Status = 1002
                 PERFORM chk-st-des-LinkTo
              WHEN Key-Status = 1003
                 PERFORM chk-st-note-LinkTo
              WHEN Key-Status = 1000
                 PERFORM pb-sib-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       scr-stampa-CLEAR.
           PERFORM scr-stampa-INIT-VALUE
           PERFORM scr-stampa-DISPLAY
           .

       scr-stampa-DISPLAY.
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1a
           DISPLAY scr-stampa UPON scr-stampa-Handle
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       scr-stampa-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       scr-stampa-Init-Data.
           MOVE 2 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       scr-stampa-Init-Value.
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, SetDefault>
      * <TOTEM:END>
           PERFORM scr-stampa-FLD-TO-BUF
           .


       scr-stampa-ALLGRID-RESET.
           .

      * for Form's Validation
       scr-stampa-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       scr-stampa-Buf-To-Fld.
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, AfterBufToFld>
      * <TOTEM:END>
           .

       scr-stampa-Fld-To-Buf.
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-stampa, FORM:scr-stampa, AfterFldToBuf>
      * <TOTEM:END>
           .

       scr-stampa-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform scr-stampa-BUF-TO-FLD.
           move 0 to scelta.
           .
       scr-stampa-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM scr-stampa-SHOW-MSG-ROUTINE
           .

       scr-stampa-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM scr-stampa-DISPLAY-MESSAGE
           .

       scr-stampa-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       scr-stampa-Save-Status.
           .             

       scr-stampa-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen scr-stampa
      ***---
       scr-stampa-BEFORE-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen scr-stampa
      ***---
       scr-stampa-AFTER-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.

       scr-fido-Open-Routine.
           PERFORM scr-fido-Scrn
           PERFORM scr-fido-Proc
           .

       scr-fido-Scrn.
           PERFORM scr-fido-Create-Win
           PERFORM scr-fido-Init-Value
           PERFORM scr-fido-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM scr-fido-DISPLAY
           .

       scr-fido-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 21,44,
              SIZE 33,09,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Verdana12B-Occidentale,
              LINK TO THREAD,
              NO SCROLL,
              TITLE-BAR,
              TITLE "GELSUX - Esposizione fido clienti",
              WITH SYSTEM MENU,
              USER-GRAY,
           VISIBLE v-screen-fido,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE scr-fido-Event-Proc,
              HANDLE IS scr-fido-Handle,
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY scr-fido UPON scr-fido-Handle
      * DISPLAY-COLUMNS settings
           .

       scr-fido-PROC.
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, BeforeAccept>
           initialize calfido-linkage replacing numeric data by zeroes
                                        alphanumeric data by spaces.
           move ef-codice-buf   to link-cli-codice.
           call "C$JUSTIFY"  using link-cli-codice, "R".
           inspect link-cli-codice replacing leading x"20" by x"30".
           move ef-fido-buf        to cli-fido.
           move ef-fido-extra-buf  to cli-fido-extra.
           call   "calfido"  using calfido-linkage.
           cancel "calfido".

      *****     if saldo            = 0 and
      *****        effetti-rischio  = 0 and
      *****        cli-fido         = 0 and
      *****        ordini-in-essere = 0 and
      *****        cli-fido-extra   = 0
      *****        move 27 to key-status
      *****     else
              move ef-fide-buf  to cli-fidejussione
              move ef-pfa-buf   to cli-pfa
                                                   
              move ef-fido-buf      to cli-fido

              move cli-fido-extra   to lab-extra-buf

              move saldo            to lab-scheda-buf
              move saldo-scaduto    to lab-scaduti-buf
              move saldo-scadenza   to lab-scadenza-buf
              move effetti-rischio  to lab-rischio-buf
              move ordini-in-essere to lab-ordini-buf

              compute totale = saldo           +
                               effetti-rischio +
                               ordini-in-essere

              move totale to lab-totale-buf 

              if cli-gestione-fido-si       
                 if tcl-fido-nuovo-si            
                    compute fido-tmp = cli-fido
                 else
                    compute tot-fido = cli-fido + cli-pfa
                 end-if
              else
                 if tcl-fido-nuovo-si
                    compute fido-tmp = cli-fido
                 else
                    compute tot-fido = cli-fido + 
                                       cli-pfa  + 
                                       cli-fidejussione
                 end-if
              end-if  
              if tcl-fido-nuovo-si  
                 move 0 to tot-fido
                 if cli-fidejussione > 0

                    if cli-grade > 0
                       move spaces to gra-codice
                       read grade no lock
                            invalid move 0 to Sum
                        not invalid
                            perform varying idx from 1 by 1 
                                      until idx > 20
                               if gra-da(idx) <= cli-grade and
                                  gra-a(idx)  >= cli-grade
                                  move gra-perce(idx) to Sum
                                  exit perform
                               end-if
                            end-perform
                        end-read
                        if Sum > 0
                           compute cli-fidejussione = 
                                   cli-fidejussione * Sum / 100
                        end-if
                    end-if

                    compute tot-fido = 
                            cli-fidejussione +
                            cli-fido-extra   +
                            cli-pfa
                 else
                    open input tparamge
                    move spaces to tge-chiave
                    read  tparamge
                    close tparamge
                    if tge-blocco-fido < cli-fido
                       compute tot-fido = tge-blocco-fido + cli-pfa
                    else
                       compute tot-fido = fido-tmp + cli-pfa
                    end-if
                 end-if 
              else
                 compute tot-fido = cli-fido + cli-pfa + 
           cli-fidejussione| + cli-fido-extra
              end-if  
              move tot-fido  to lab-fido-buf

              if totale > tot-fido
                 move 5 to colore-fido
                 move "FUORI FIDO DI" to lab-fuori-buf
                 compute totale = totale - tot-fido
              else
                 move 3 to colore-fido
                 move "FIDO RESIDUO"  to lab-fuori-buf
                 compute totale = tot-fido - totale
              end-if

              move 1 to v-screen-fido

              move totale to lab-tot-buf
              display scr-fido

              modify scr-fido-handle, visible v-screen-fido

      *****     end-if.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT scr-fido
                 ON EXCEPTION
                    PERFORM scr-fido-Evaluate-Func
                 MOVE 3 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY scr-fido-Handle
           INITIALIZE Key-Status
           .

       scr-fido-Evaluate-Func.
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM scr-fido-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM scr-fido-Exit
                 END-IF
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       scr-fido-CLEAR.
           PERFORM scr-fido-INIT-VALUE
           PERFORM scr-fido-DISPLAY
           .

       scr-fido-DISPLAY.
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY scr-fido UPON scr-fido-Handle
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       scr-fido-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       scr-fido-Init-Data.
           MOVE 3 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       scr-fido-Init-Value.
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, SetDefault>
      * <TOTEM:END>
           PERFORM scr-fido-FLD-TO-BUF
           .


       scr-fido-ALLGRID-RESET.
           .

      * for Form's Validation
       scr-fido-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       scr-fido-Buf-To-Fld.
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, AfterBufToFld>
      * <TOTEM:END>
           .

       scr-fido-Fld-To-Buf.
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-fido, FORM:scr-fido, AfterFldToBuf>
      * <TOTEM:END>
           .

       scr-fido-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform scr-fido-BUF-TO-FLD.
           move 0 to scelta.
           .
       scr-fido-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM scr-fido-SHOW-MSG-ROUTINE
           .

       scr-fido-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM scr-fido-DISPLAY-MESSAGE
           .

       scr-fido-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       scr-fido-Save-Status.
           .             

       scr-fido-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen scr-fido
      ***---
       scr-fido-BEFORE-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen scr-fido
      ***---
       scr-fido-AFTER-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.

       scr-note-bolla-Open-Routine.
           PERFORM scr-note-bolla-Scrn
           PERFORM scr-note-bolla-Proc
           .

       scr-note-bolla-Scrn.
           PERFORM scr-note-bolla-Create-Win
           PERFORM scr-note-bolla-Init-Value
           PERFORM scr-note-bolla-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM scr-note-bolla-DISPLAY
           .

       scr-note-bolla-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 17,00,
              SIZE 139,17,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Small-Font,
              LINK TO THREAD,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE scr-note-bolla-Event-Proc,
              HANDLE IS scr-note-bolla-Handle,
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY scr-note-bolla UPON scr-note-bolla-Handle
      * DISPLAY-COLUMNS settings
           .

       scr-note-bolla-PROC.
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, BeforeAccept>
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT scr-note-bolla
                 ON EXCEPTION
                    PERFORM scr-note-bolla-Evaluate-Func
                 MOVE 4 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY scr-note-bolla-Handle
           INITIALIZE Key-Status
           .

       scr-note-bolla-Evaluate-Func.
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM scr-note-bolla-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM scr-note-bolla-Exit
                 END-IF
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       scr-note-bolla-CLEAR.
           PERFORM scr-note-bolla-INIT-VALUE
           PERFORM scr-note-bolla-DISPLAY
           .

       scr-note-bolla-DISPLAY.
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY scr-note-bolla UPON scr-note-bolla-Handle
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       scr-note-bolla-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       scr-note-bolla-Init-Data.
           MOVE 4 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       scr-note-bolla-Init-Value.
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, SetDefault>
      * <TOTEM:END>
           PERFORM scr-note-bolla-FLD-TO-BUF
           .


       scr-note-bolla-ALLGRID-RESET.
           .

      * for Form's Validation
       scr-note-bolla-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       scr-note-bolla-Buf-To-Fld.
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, AfterBufToFld>
      * <TOTEM:END>
           .

       scr-note-bolla-Fld-To-Buf.
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-note-bolla, FORM:scr-note-bolla, AfterFldToBuf>
      * <TOTEM:END>
           .

       scr-note-bolla-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform scr-note-bolla-BUF-TO-FLD.
           move 0 to scelta.
           .
       scr-note-bolla-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM scr-note-bolla-SHOW-MSG-ROUTINE
           .

       scr-note-bolla-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM scr-note-bolla-DISPLAY-MESSAGE
           .

       scr-note-bolla-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       scr-note-bolla-Save-Status.
           .             

       scr-note-bolla-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen scr-note-bolla
      ***---
       scr-note-bolla-BEFORE-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen scr-note-bolla
      ***---
       scr-note-bolla-AFTER-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.

       scr-ricerca-Open-Routine.
           PERFORM scr-ricerca-Scrn
           PERFORM scr-ricerca-Proc
           .

       scr-ricerca-Scrn.
           PERFORM scr-ricerca-Create-Win
           PERFORM scr-ricerca-Init-Value
           PERFORM scr-ricerca-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM scr-ricerca-DISPLAY
           .

       scr-ricerca-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 5,61,
              SIZE 34,50,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Verdana12-Occidentale,
              LINK TO THREAD,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE scr-stampa-Event-Proc,
              HANDLE IS scr-stampa-Handle,
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY scr-ricerca UPON scr-stampa-Handle
      * DISPLAY-COLUMNS settings
           .

       scr-ricerca-PROC.
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, BeforeAccept>
           move spaces to ef-ricerca-piva-buf.
           display ef-ricerca-piva.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT scr-ricerca
                 ON EXCEPTION
                    PERFORM scr-ricerca-Evaluate-Func
                 MOVE 5 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY scr-stampa-Handle
           INITIALIZE Key-Status
           .

       scr-ricerca-Evaluate-Func.
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM scr-ricerca-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM scr-ricerca-Exit
                 END-IF
              WHEN Key-Status = 1000
                 PERFORM pb-ricerca-ok-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       scr-ricerca-CLEAR.
           PERFORM scr-ricerca-INIT-VALUE
           PERFORM scr-ricerca-DISPLAY
           .

       scr-ricerca-DISPLAY.
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY scr-ricerca UPON scr-stampa-Handle
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       scr-ricerca-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       scr-ricerca-Init-Data.
           MOVE 5 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       scr-ricerca-Init-Value.
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, SetDefault>
      * <TOTEM:END>
           PERFORM scr-ricerca-FLD-TO-BUF
           .


       scr-ricerca-ALLGRID-RESET.
           .

      * for Form's Validation
       scr-ricerca-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       scr-ricerca-Buf-To-Fld.
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, AfterBufToFld>
      * <TOTEM:END>
           .

       scr-ricerca-Fld-To-Buf.
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-ricerca, FORM:scr-ricerca, AfterFldToBuf>
      * <TOTEM:END>
           .

       scr-ricerca-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform scr-ricerca-BUF-TO-FLD.
           move 0 to scelta.
           .
       scr-ricerca-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM scr-ricerca-SHOW-MSG-ROUTINE
           .

       scr-ricerca-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM scr-ricerca-DISPLAY-MESSAGE
           .

       scr-ricerca-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       scr-ricerca-Save-Status.
           .             

       scr-ricerca-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen scr-ricerca
      ***---
       scr-ricerca-BEFORE-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen scr-ricerca
      ***---
       scr-ricerca-AFTER-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.



       Screen1-Ta-1-TABCHANGE.
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
                   Form1-Pg-2-Visible,
                   Form1-Pg-3-Visible,
                   Form1-Pg-4-Visible,
                   Form1-Pg-5-Visible,
                   Form1-Pg-6-Visible,
                   Form1-Pg-7-Visible,
           EVALUATE Screen1-Ta-1-TAB-VALUE
           WHEN 1
                  MOVE 1 TO Form1-Pg-1-Visible
                  MODIFY Screen1-Ta-1, VALUE = 1
           WHEN 2
                  MOVE 1 TO Form1-Pg-2-Visible
                  MODIFY Screen1-Ta-1, VALUE = 2
           WHEN 3
                  MOVE 1 TO Form1-Pg-3-Visible
                  MODIFY Screen1-Ta-1, VALUE = 3
           WHEN 4
                  MOVE 1 TO Form1-Pg-4-Visible
                  MODIFY Screen1-Ta-1, VALUE = 4
           WHEN 5
                  MOVE 1 TO Form1-Pg-5-Visible
                  MODIFY Screen1-Ta-1, VALUE = 5
           WHEN 6
                  MOVE 1 TO Form1-Pg-6-Visible
                  MODIFY Screen1-Ta-1, VALUE = 6
           WHEN 7
                  MOVE 1 TO Form1-Pg-7-Visible
                  MODIFY Screen1-Ta-1, VALUE = 7
           END-EVALUATE
           MOVE 5000 TO CONTROL-ID
           DISPLAY Form1
           .

       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "Digitare il Codice del Cliente" to 
           TOTEM-HINT-TEXT
           WHEN 5002 MOVE "Digitare la Ragione Sociale I" to 
           TOTEM-HINT-TEXT
           WHEN 5003 MOVE "Digitare la Ragione Sociale II" to 
           TOTEM-HINT-TEXT
           WHEN 5004 MOVE "Digitare l'indirizzo" to TOTEM-HINT-TEXT
           WHEN 5005 MOVE "Digitare il CAP" to TOTEM-HINT-TEXT
           WHEN 5006 MOVE "Digitare la localit" to TOTEM-HINT-TEXT
           WHEN 5007 MOVE "Digitare la provincia" to TOTEM-HINT-TEXT
           WHEN 5008 MOVE "Digitare la nazione" to TOTEM-HINT-TEXT
           WHEN 5009 MOVE "Digitare il codice SDI (7 caratteri)" to 
           TOTEM-HINT-TEXT
           WHEN 5010 MOVE "Digitare il numero di telefono I" to 
           TOTEM-HINT-TEXT
           WHEN 5011 MOVE "Digitare il numero di telefono II" to 
           TOTEM-HINT-TEXT
           WHEN 5012 MOVE "Digitare il numero di fax" to TOTEM-HINT-TEXT
           WHEN 5013 MOVE "Digitare l'indirizzo di posta elettronica" 
           to TOTEM-HINT-TEXT
           WHEN 15 MOVE "Digitare l'indirizzo di posta elettronica" to 
           TOTEM-HINT-TEXT
           WHEN 5014 MOVE "Digitare l'URL" to TOTEM-HINT-TEXT
           WHEN 5015 MOVE "Digitare il tipo d'imposta" to 
           TOTEM-HINT-TEXT
           WHEN 5016 MOVE "Digitare il gruppo GDO" to TOTEM-HINT-TEXT
           WHEN 5017 MOVE "UTF/Non UTF" to TOTEM-HINT-TEXT
           WHEN 5018 MOVE "Digitare il referente" to TOTEM-HINT-TEXT
           WHEN 5019 MOVE "Digitare il codice del vettore" to 
           TOTEM-HINT-TEXT
           WHEN 5020 MOVE "Inoltro/Non inoltro" to TOTEM-HINT-TEXT
           WHEN 5021 MOVE "Digitare il codice dell'agente provvigioni" 
           to TOTEM-HINT-TEXT
           WHEN 5022 MOVE "Selezionare uno stato" to TOTEM-HINT-TEXT
           WHEN 5023 MOVE "Selezionare la causale" to TOTEM-HINT-TEXT
           WHEN 5024 MOVE "Digitare il codice dell'agente 2" to 
           TOTEM-HINT-TEXT
           WHEN 5025 MOVE "Attiva il meccanismo di controllo in fase di 
      -    "caricamento degli ordini" to TOTEM-HINT-TEXT
           WHEN 5026 MOVE "Attiva il meccanismo di controllo in fase di 
      -    "caricamento degli ordini" to TOTEM-HINT-TEXT
           WHEN 5027 MOVE "Digitare il codice ditta/regsitro" to 
           TOTEM-HINT-TEXT
           WHEN 5028 MOVE "Digitare la % PFA" to TOTEM-HINT-TEXT
           WHEN 5029 MOVE "Digitare le note" to TOTEM-HINT-TEXT
           WHEN 5030 MOVE "Digitare il path delle note aggiuntive" to 
           TOTEM-HINT-TEXT
           WHEN 5031 MOVE "Selezionare il tipo di sostituziona atuomatic
      -    "a dell'articolo" to TOTEM-HINT-TEXT
           WHEN 5032 MOVE "Selezionare la tipologia del cliente" to 
           TOTEM-HINT-TEXT
           WHEN 5033 MOVE "Attiva l'invio delle bolle EDI per questo cli
      -    "ente" to TOTEM-HINT-TEXT
           WHEN 5034 MOVE "Attiva l'aggiunta automatica del destino EDI 
      -    "se non esiste in fase di import" to TOTEM-HINT-TEXT
           WHEN 5035 MOVE "Esclude il cliente dai controlli sul fido (si
      -    "a il blocco sullo stato cliente che il controllo in inserime
      -    "nto ordine/importazione)" to TOTEM-HINT-TEXT
           WHEN 5036 MOVE "Imposta il flag di constrassegno sugli ordini
      -    " master" to TOTEM-HINT-TEXT
           WHEN 5039 MOVE "Digitare i giorni di dilazione pagamento conc
      -    "essi" to TOTEM-HINT-TEXT
           WHEN 5040 MOVE "Controlla la situazione finanaziaria al momen
      -    "to del salvataggio dell'ordine" to TOTEM-HINT-TEXT
           WHEN 5041 MOVE "Valori ammessi: D = differita - I = Immediata
      -    " - S = Scissione di pagamenti" to TOTEM-HINT-TEXT
           WHEN 5042 MOVE "Digitare il codice fiscale" to 
           TOTEM-HINT-TEXT
           WHEN 5043 MOVE "Digitare la partita IVA" to TOTEM-HINT-TEXT
           WHEN 5044 MOVE "Digitare il codice IVA" to TOTEM-HINT-TEXT
           WHEN 5045 MOVE "Digitare il codice di pagamento" to 
           TOTEM-HINT-TEXT
           WHEN 5046 MOVE "Digitare il codice IVA" to TOTEM-HINT-TEXT
           WHEN 5047 MOVE "Spostamento/Non spostamento delle ricevute ad
      -    " agosto" to TOTEM-HINT-TEXT
           WHEN 5048 MOVE "Spostamento/Non spostamento delle ricevute a 
      -    "dicembre" to TOTEM-HINT-TEXT
           WHEN 5049 MOVE "Digitare l'importo del fido" to 
           TOTEM-HINT-TEXT
           WHEN 5050 MOVE "Digitare la data del fido" to TOTEM-HINT-TEXT
           WHEN 5051 MOVE "Digitare il valore del fido extra" to 
           TOTEM-HINT-TEXT
           WHEN 5052 MOVE "Digitare l'importo della fiddo EULER" to 
           TOTEM-HINT-TEXT
           WHEN 5053 MOVE "Digitare il valore in Euro del fido commercia
      -    "le" to TOTEM-HINT-TEXT
           WHEN 5054 MOVE "Una data superiore a quella odierna porta all
      -    "'azzeramento del fido extra" to TOTEM-HINT-TEXT
           WHEN 5056 MOVE "Digitare il codice CAB" to TOTEM-HINT-TEXT
           WHEN 5057 MOVE "Digitare il codice ABI" to TOTEM-HINT-TEXT
           WHEN 5059 MOVE "Digitare la Ragione Sociale I di destinazione
      -    "" to TOTEM-HINT-TEXT
           WHEN 5060 MOVE "Digitare la Ragione Sociale II di destinazion
      -    "e" to TOTEM-HINT-TEXT
           WHEN 5061 MOVE "Digitare l'indirizzo di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5062 MOVE "Digitare il CAP di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5063 MOVE "Digitare la località di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5064 MOVE "Digitare la provincia di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5065 MOVE "Digitare la nazione di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5066 MOVE "Indica l'invio della fattura a questo detino"
            to TOTEM-HINT-TEXT
           WHEN 5067 MOVE "Digitare il numero di telefono I di destinazi
      -    "one" to TOTEM-HINT-TEXT
           WHEN 5068 MOVE "Digitare il numero di telefono II di destinaz
      -    "ione" to TOTEM-HINT-TEXT
           WHEN 5069 MOVE "Digitare il numero di fax di destinazione" 
           to TOTEM-HINT-TEXT
           WHEN 5070 MOVE "Digitare l'indirizzo e-mail di destinazione" 
           to TOTEM-HINT-TEXT
           WHEN 5071 MOVE "Digitare il referente di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5072 MOVE "Digitare la partita IVA" to TOTEM-HINT-TEXT
           WHEN 5074 MOVE "Digitare il vettore di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5075 MOVE "Inoltro/Non inoltro" to TOTEM-HINT-TEXT
           WHEN 5076 MOVE "Indica il superamento dei 500 Kg. UTF" to 
           TOTEM-HINT-TEXT
           WHEN 5077 MOVE "Selezionare uno stato" to TOTEM-HINT-TEXT
           WHEN 5078 MOVE "Selezionare la tipologia" to TOTEM-HINT-TEXT
           WHEN 5079 MOVE "Digitare il codice ditta/regsitro" to 
           TOTEM-HINT-TEXT
           WHEN 5080 MOVE "Digitare il referente di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5081 MOVE "Digitare i dati di consegna" to 
           TOTEM-HINT-TEXT
           WHEN 5082 MOVE "Digitare la data di Consegna" to 
           TOTEM-HINT-TEXT
           WHEN 5083 MOVE "Digitare le note di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5084 MOVE "Digitare le note di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5085 MOVE "Digitare le note di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5086 MOVE "Digitare la Ragione Sociale I per il recapito
      -    "" to TOTEM-HINT-TEXT
           WHEN 5087 MOVE "Digitare la Ragione Sociale II per il recapit
      -    "o" to TOTEM-HINT-TEXT
           WHEN 5088 MOVE "Digitare l'indirizzo per il recapito" to 
           TOTEM-HINT-TEXT
           WHEN 5089 MOVE "Digitare la località per il recapito" to 
           TOTEM-HINT-TEXT
           WHEN 5090 MOVE "Digitare il CAP per il recapito" to 
           TOTEM-HINT-TEXT
           WHEN 5091 MOVE "Digitare la provincia per il recapito" to 
           TOTEM-HINT-TEXT
           WHEN 5092 MOVE "Digitare la nazione per il recapito" to 
           TOTEM-HINT-TEXT
           WHEN 5093 MOVE "Selezionare un tipo d'invio" to 
           TOTEM-HINT-TEXT
           WHEN 5096 MOVE "Digitare il numero di dichiarazione esportato
      -    "re" to TOTEM-HINT-TEXT
           WHEN 5097 MOVE "Digitare la data di dichiarazione" to 
           TOTEM-HINT-TEXT
           WHEN 5098 MOVE "Digitare la data di registrazione" to 
           TOTEM-HINT-TEXT
           WHEN 5099 MOVE "Digitare il numero di registrazione" to 
           TOTEM-HINT-TEXT
           WHEN 5101 MOVE "Esclude il cliente dalla funzione EVADI TUTTO
      -    " in evasione automatica" to TOTEM-HINT-TEXT
           WHEN 5102 MOVE "Esclude il cliente dalla funzione EVADI TUTTO
      -    " in evasione automatica" to TOTEM-HINT-TEXT
           WHEN 5103 MOVE "Accorpamento MAster appartenenti allo stesso 
      -    "cliente" to TOTEM-HINT-TEXT
           WHEN 5104 MOVE "Tenere/non tenere saldi BANCO" to 
           TOTEM-HINT-TEXT
           WHEN 5105 MOVE "Tenere/non tenere saldi PROMO" to 
           TOTEM-HINT-TEXT
           WHEN 5106 MOVE "Se valorizzato sostituisce il valore dei para
      -    "metri generali" to TOTEM-HINT-TEXT
           WHEN 5129 MOVE "Se spuntato considera il campo in qta pezzi (
      -    "17) SENZA moltiplicare pergli imballi (22)" to 
           TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-codice-BeforeProcedure
           When 5002 PERFORM ef-ragsoc-1-BeforeProcedure
           When 5003 PERFORM ef-ragsoc-2-BeforeProcedure
           When 5004 PERFORM ef-indirizzo-BeforeProcedure
           When 5005 PERFORM ef-cap-BeforeProcedure
           When 5006 PERFORM ef-localita-BeforeProcedure
           When 5007 PERFORM ef-prov-BeforeProcedure
           When 5008 PERFORM ef-nazione-BeforeProcedure
           When 5009 PERFORM ef-localitaa-BeforeProcedure
           When 5010 PERFORM ef-tel-1-BeforeProcedure
           When 5011 PERFORM ef-tel-2-BeforeProcedure
           When 5012 PERFORM ef-fax-BeforeProcedure
           When 5013 PERFORM ef-mail-BeforeProcedure
           When 15 PERFORM ef-mail-BeforeProcedure
           When 5014 PERFORM ef-url-BeforeProcedure
           When 5015 PERFORM ef-tipo-BeforeProcedure
           When 5016 PERFORM ef-gdo-BeforeProcedure
           When 5017 PERFORM chk-utf-BeforeProcedure
           When 5018 PERFORM ef-referente-BeforeProcedure
           When 5019 PERFORM ef-vettore-BeforeProcedure
           When 5020 PERFORM chk-inoltro-BeforeProcedure
           When 5021 PERFORM ef-agente-BeforeProcedure
           When 5022 PERFORM cbo-stato-BeforeProcedure
           When 5023 PERFORM cbo-stato-BeforeProcedure
           When 5024 PERFORM ef-agente-BeforeProcedure
           When 5025 PERFORM chk-superamento-BeforeProcedure
           When 5026 PERFORM chk-superamento-BeforeProcedure
           When 5027 PERFORM ef-url-BeforeProcedure
           When 5028 PERFORM ef-fido-data-BeforeProcedure
           When 5029 PERFORM ef-note-BeforeProcedure
           When 5030 PERFORM ef-note-agg-BeforeProcedure
           When 5031 PERFORM cbo-stato-BeforeProcedure
           When 5032 PERFORM cbo-stato-BeforeProcedure
           When 5033 PERFORM chk-superamento-BeforeProcedure
           When 5034 PERFORM chk-superamento-BeforeProcedure
           When 5035 PERFORM chk-superamento-BeforeProcedure
           When 5036 PERFORM chk-superamento-BeforeProcedure
           When 5039 PERFORM ef-iva-BeforeProcedure
           When 5040 PERFORM chk-spost-ago-BeforeProcedure
           When 5041 PERFORM ef-iva-BeforeProcedure
           When 5042 PERFORM ef-codfis-BeforeProcedure
           When 5043 PERFORM ef-piva-BeforeProcedure
           When 5044 PERFORM ef-iva-BeforeProcedure
           When 5045 PERFORM ef-pag-BeforeProcedure
           When 5046 PERFORM ef-iva-BeforeProcedure
           When 5047 PERFORM chk-spost-ago-BeforeProcedure
           When 5048 PERFORM chk-spost-dic-BeforeProcedure
           When 5049 PERFORM ef-fido-BeforeProcedure
           When 5050 PERFORM ef-fido-data-BeforeProcedure
           When 5051 PERFORM ef-fido-extra-BeforeProcedure
           When 5052 PERFORM ef-fido-BeforeProcedure
           When 5053 PERFORM ef-fido-data-BeforeProcedure
           When 5054 PERFORM ef-data-fido-extra-BeforeProcedure
           When 5056 PERFORM ef-cab-BeforeProcedure
           When 5057 PERFORM ef-abi-BeforeProcedure
           When 5059 PERFORM ef-ragsoc-1-d-BeforeProcedure
           When 5060 PERFORM ef-ragsoc-2-d-BeforeProcedure
           When 5061 PERFORM ef-indirizzo-d-BeforeProcedure
           When 5062 PERFORM ef-cap-d-BeforeProcedure
           When 5063 PERFORM ef-localita-d-BeforeProcedure
           When 5064 PERFORM ef-prov-d-BeforeProcedure
           When 5065 PERFORM ef-nazione-d-BeforeProcedure
           When 5066 PERFORM chk-superamento-d-BeforeProcedure
           When 5067 PERFORM ef-telef-1-d-BeforeProcedure
           When 5068 PERFORM ef-telef-2-d-BeforeProcedure
           When 5069 PERFORM ef-fax-d-BeforeProcedure
           When 5070 PERFORM ef-mail-d-BeforeProcedure
           When 5071 PERFORM ef-referente-d-BeforeProcedure
           When 5072 PERFORM ef-referente-d-BeforeProcedure
           When 5074 PERFORM ef-vettore-d-BeforeProcedure
           When 5075 PERFORM chk-deposito-utf-BeforeProcedure
           When 5076 PERFORM chk-superamento-d-BeforeProcedure
           When 5077 PERFORM cbo-stato-d-BeforeProcedure
           When 5078 PERFORM cbo-stato-d-BeforeProcedure
           When 5079 PERFORM ef-url-BeforeProcedure
           When 5080 PERFORM ef-referente-d-BeforeProcedure
           When 5081 PERFORM ef-note-1-BeforeProcedure
           When 5082 PERFORM Form1-DaEf-1-BeforeProcedure
           When 5083 PERFORM ef-note-2-BeforeProcedure
           When 5084 PERFORM ef-note-3-BeforeProcedure
           When 5085 PERFORM ef-note-4-BeforeProcedure
           When 5086 PERFORM ef-ragsoc-1-r-BeforeProcedure
           When 5087 PERFORM ef-ragsoc-2-r-BeforeProcedure
           When 5088 PERFORM ef-indirizzo-r-BeforeProcedure
           When 5089 PERFORM ef-localita-r-BeforeProcedure
           When 5090 PERFORM ef-cap-r-BeforeProcedure
           When 5091 PERFORM ef-prov-r-BeforeProcedure
           When 5092 PERFORM ef-nazione-r-BeforeProcedure
           When 5093 PERFORM cbo-invio-BeforeProcedure
           When 5096 PERFORM Form1-DaEf-1-BeforeProcedure
           When 5097 PERFORM Form1-DaEf-2-BeforeProcedure
           When 5098 PERFORM Form1-DaEf-3-BeforeProcedure
           When 5099 PERFORM Form1-DaEf-4-BeforeProcedure
           When 5101 PERFORM chk-escludi-e-BeforeProcedure
           When 5102 PERFORM chk-intera-e-BeforeProcedure
           When 5103 PERFORM chk-accorpa-e-BeforeProcedure
           When 5104 PERFORM chk-saldo-banco-e-BeforeProcedure
           When 5105 PERFORM chk-saldo-promo-e-BeforeProcedure
           When 5106 PERFORM ef-gg-e-BeforeProcedure
           When 5129 PERFORM Form1-DaCb-1-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Form1-AfterProcedure.
           EVALUATE Control-Id
           When 5001 PERFORM ef-codice-AfterProcedure
           When 5002 PERFORM ef-ragsoc-1-AfterProcedure
           When 5003 PERFORM ef-ragsoc-2-AfterProcedure
           When 5004 PERFORM ef-indirizzo-AfterProcedure
           When 5005 PERFORM ef-cap-AfterProcedure
           When 5006 PERFORM ef-localita-AfterProcedure
           When 5007 PERFORM ef-prov-AfterProcedure
           When 5008 PERFORM ef-nazione-AfterProcedure
           When 5009 PERFORM ef-localitaa-AfterProcedure
           When 5010 PERFORM ef-tel-1-AfterProcedure
           When 5011 PERFORM ef-tel-2-AfterProcedure
           When 5012 PERFORM ef-fax-AfterProcedure
           When 5013 PERFORM ef-mail-AfterProcedure
           When 15 PERFORM ef-mail-AfterProcedure
           When 5014 PERFORM ef-url-AfterProcedure
           When 5015 PERFORM ef-tipo-AfterProcedure
           When 5016 PERFORM ef-gdo-AfterProcedure
           When 5017 PERFORM chk-utf-AfterProcedure
           When 5018 PERFORM ef-referente-AfterProcedure
           When 5019 PERFORM ef-vettore-AfterProcedure
           When 5020 PERFORM chk-inoltro-AfterProcedure
           When 5021 PERFORM ef-agente-AfterProcedure
           When 5024 PERFORM ef-agente-AfterProcedure
           When 5025 PERFORM chk-superamento-AfterProcedure
           When 5026 PERFORM chk-superamento-AfterProcedure
           When 5027 PERFORM ef-url-AfterProcedure
           When 5028 PERFORM ef-fido-data-AfterProcedure
           When 5029 PERFORM ef-note-AfterProcedure
           When 5030 PERFORM ef-note-agg-AfterProcedure
           When 5033 PERFORM chk-superamento-AfterProcedure
           When 5034 PERFORM chk-superamento-AfterProcedure
           When 5035 PERFORM chk-superamento-AfterProcedure
           When 5036 PERFORM chk-superamento-AfterProcedure
           When 5037 PERFORM Form1-DaRb-1-AfterProcedure
           When 5038 PERFORM Form1-DaRb-1-AfterProcedure
           When 5039 PERFORM ef-iva-AfterProcedure
           When 5040 PERFORM chk-spost-ago-AfterProcedure
           When 5041 PERFORM ef-iva-AfterProcedure
           When 5042 PERFORM ef-codfis-AfterProcedure
           When 5043 PERFORM ef-piva-AfterProcedure
           When 5044 PERFORM ef-iva-AfterProcedure
           When 5045 PERFORM ef-pag-AfterProcedure
           When 5046 PERFORM ef-iva-AfterProcedure
           When 5047 PERFORM chk-spost-ago-AfterProcedure
           When 5048 PERFORM chk-spost-dic-AfterProcedure
           When 5049 PERFORM ef-fido-AfterProcedure
           When 5050 PERFORM ef-fido-data-AfterProcedure
           When 5051 PERFORM ef-fido-extra-AfterProcedure
           When 5052 PERFORM ef-fido-AfterProcedure
           When 5053 PERFORM ef-fido-data-AfterProcedure
           When 5054 PERFORM ef-data-fido-extra-AfterProcedure
           When 5055 PERFORM ef-data-fido-extra-AfterProcedure
           When 5056 PERFORM ef-cab-AfterProcedure
           When 5057 PERFORM ef-abi-AfterProcedure
           When 5059 PERFORM ef-ragsoc-1-d-AfterProcedure
           When 5060 PERFORM ef-ragsoc-2-d-AfterProcedure
           When 5061 PERFORM ef-indirizzo-d-AfterProcedure
           When 5062 PERFORM ef-cap-d-AfterProcedure
           When 5063 PERFORM ef-localita-d-AfterProcedure
           When 5064 PERFORM ef-prov-d-AfterProcedure
           When 5065 PERFORM ef-nazione-d-AfterProcedure
           When 5066 PERFORM chk-superamento-d-AfterProcedure
           When 5067 PERFORM ef-telef-1-d-AfterProcedure
           When 5068 PERFORM ef-telef-2-d-AfterProcedure
           When 5069 PERFORM ef-fax-d-AfterProcedure
           When 5070 PERFORM ef-mail-d-AfterProcedure
           When 5071 PERFORM ef-referente-d-AfterProcedure
           When 5072 PERFORM ef-referente-d-AfterProcedure
           When 5073 PERFORM ef-agente-d-AfterProcedure
           When 5074 PERFORM ef-vettore-d-AfterProcedure
           When 5075 PERFORM chk-deposito-utf-AfterProcedure
           When 5076 PERFORM chk-superamento-d-AfterProcedure
           When 5079 PERFORM ef-url-AfterProcedure
           When 5080 PERFORM ef-referente-d-AfterProcedure
           When 5081 PERFORM ef-note-1-AfterProcedure
           When 5082 PERFORM Form1-DaEf-1-AfterProcedure
           When 5083 PERFORM ef-note-2-AfterProcedure
           When 5084 PERFORM ef-note-3-AfterProcedure
           When 5085 PERFORM ef-note-4-AfterProcedure
           When 5086 PERFORM ef-ragsoc-1-r-AfterProcedure
           When 5087 PERFORM ef-ragsoc-2-r-AfterProcedure
           When 5088 PERFORM ef-indirizzo-r-AfterProcedure
           When 5089 PERFORM ef-localita-r-AfterProcedure
           When 5090 PERFORM ef-cap-r-AfterProcedure
           When 5091 PERFORM ef-prov-r-AfterProcedure
           When 5092 PERFORM ef-nazione-r-AfterProcedure
           When 5094 PERFORM Form1-DaCb-1-AfterProcedure
           When 5095 PERFORM Form1-DaCb-1-AfterProcedure
           When 5096 PERFORM Form1-DaEf-1-AfterProcedure
           When 5097 PERFORM Form1-DaEf-2-AfterProcedure
           When 5098 PERFORM Form1-DaEf-3-AfterProcedure
           When 5099 PERFORM Form1-DaEf-4-AfterProcedure
           When 5101 PERFORM chk-escludi-e-AfterProcedure
           When 5102 PERFORM chk-intera-e-AfterProcedure
           When 5103 PERFORM chk-accorpa-e-AfterProcedure
           When 5104 PERFORM chk-saldo-banco-e-AfterProcedure
           When 5105 PERFORM chk-saldo-promo-e-AfterProcedure
           When 5106 PERFORM ef-gg-e-AfterProcedure
           When 5109 PERFORM Form1-DaEf-1-AfterProcedure
           When 5110 PERFORM Form1-DaEf-2-AfterProcedure
           When 5111 PERFORM Form1-DaEf-3-AfterProcedure
           When 5112 PERFORM Form1-DaEf-4-AfterProcedure
           When 5113 PERFORM Form1-DaEf-5-AfterProcedure
           When 5114 PERFORM Form1-DaEf-6-AfterProcedure
           When 5115 PERFORM Form1-DaEf-7-AfterProcedure
           When 5116 PERFORM Form1-DaEf-8-AfterProcedure
           When 5117 PERFORM Form1-DaEf-9-AfterProcedure
           When 5118 PERFORM Form1-DaEf-10-AfterProcedure
           When 5119 PERFORM Form1-DaEf-11-AfterProcedure
           When 5120 PERFORM Form1-DaEf-12-AfterProcedure
           When 5121 PERFORM Form1-DaEf-3-AfterProcedure
           When 5122 PERFORM Form1-DaEf-4-AfterProcedure
           When 5123 PERFORM Form1-DaEf-6-AfterProcedure
           When 5124 PERFORM Form1-DaEf-7-AfterProcedure
           When 5125 PERFORM Form1-DaEf-8-AfterProcedure
           When 5126 PERFORM Form1-DaEf-9-AfterProcedure
           When 5127 PERFORM Form1-DaEf-10-AfterProcedure
           When 5128 PERFORM Form1-DaCb-1-AfterProcedure
           When 5129 PERFORM Form1-DaCb-1-AfterProcedure
           When 5130 PERFORM Form1-DaCb-1-AfterProcedure
           When 5131 PERFORM Form1-DaEf-1-AfterProcedure
           END-EVALUATE
           perform Form1-AFTER-SCREEN
           .

       scr-stampa-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 78-ID-ef-cod-da MOVE "." to TOTEM-HINT-TEXT
           WHEN 78-ID-ef-cod-a MOVE "." to TOTEM-HINT-TEXT
           WHEN 78-ID-ef-st-tipo MOVE "." to TOTEM-HINT-TEXT
           WHEN 78-ID-ef-st-gdo MOVE "." to TOTEM-HINT-TEXT
           WHEN 78-ID-ef-st-age MOVE "." to TOTEM-HINT-TEXT
           WHEN 78-ID-ef-des-da MOVE "." to TOTEM-HINT-TEXT
           WHEN 78-ID-ef-des-a MOVE "." to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 78-ID-ef-cod-da PERFORM ef-cod-da-BeforeProcedure
           When 78-ID-ef-cod-a PERFORM ef-cod-a-BeforeProcedure
           When 78-ID-ef-st-tipo PERFORM ef-st-tipo-BeforeProcedure
           When 78-ID-ef-st-gdo PERFORM ef-st-gdo-BeforeProcedure
           When 78-ID-ef-st-age PERFORM ef-st-age-BeforeProcedure
           When 78-ID-ef-des-da PERFORM ef-des-da-BeforeProcedure
           When 78-ID-ef-des-a PERFORM ef-des-a-BeforeProcedure
           END-EVALUATE
           perform scr-stampa-BEFORE-SCREEN
           .

       scr-ricerca-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 78-ID-ef-st-tipo MOVE "." to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 78-ID-ef-st-tipo PERFORM ef-ricerca-piva-BeforeProcedure
           END-EVALUATE
           perform scr-ricerca-BEFORE-SCREEN
           .

       Form1-Event-Proc.
           .

       Screen1-Ta-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Cmd-Tabchanged ALSO 5000 ALSO
                    Form1-Handle
              PERFORM Screen1-Ta-1-Ev-Cmd-Tabchanged
           END-EVALUATE
           .

       cbo-stato-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Ntf-Selchange ALSO 5022 ALSO
                    Form1-Handle
              PERFORM cbo-stato-Ev-Ntf-Selchange
           END-EVALUATE
           .

       Form1-Gd-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 5058 ALSO
                    Form1-Handle 
              PERFORM form1-gd-1-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5058 ALSO
                    Form1-Handle 
              PERFORM form1-gd-1-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5058 ALSO
                    Form1-Handle 
              PERFORM form1-gd-1-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5058 ALSO
                    Form1-Handle 
              PERFORM form1-gd-1-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5058 ALSO
                    Form1-Handle 
              PERFORM form1-gd-1-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5058 ALSO
                    Form1-Handle 
              PERFORM form1-gd-1-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 282 ALSO
                    Form1-Handle 
              PERFORM form1-gd-edi-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 282 ALSO
                    Form1-Handle 
              PERFORM form1-gd-1-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 282 ALSO
                    Form1-Handle 
              PERFORM form1-gd-edi-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 282 ALSO
                    Form1-Handle 
              PERFORM form1-gd-edi-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 282 ALSO
                    Form1-Handle 
              PERFORM form1-gd-edi-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 282 ALSO
                    Form1-Handle 
              PERFORM form1-gd-edi-Ev-Msg-Goto-Cell-Mouse
           END-EVALUATE
           .

       Form1-Gd-2-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 5100 ALSO
                    Form1-Handle 
              PERFORM gd-destini-e-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5100 ALSO
                    Form1-Handle 
              PERFORM gd-destini-e-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5100 ALSO
                    Form1-Handle 
              PERFORM gd-destini-e-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5100 ALSO
                    Form1-Handle 
              PERFORM gd-destini-e-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5100 ALSO
                    Form1-Handle 
              PERFORM gd-destini-e-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5100 ALSO
                    Form1-Handle 
              PERFORM gd-destini-e-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5107 ALSO
                    Form1-Handle 
              PERFORM gd-evasioni-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5107 ALSO
                    Form1-Handle 
              PERFORM gd-evasioni-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5107 ALSO
                    Form1-Handle 
              PERFORM gd-evasioni-Ev-Msg-End-Drag
           WHEN Msg-Finish-Entry ALSO 5107 ALSO
                    Form1-Handle 
              PERFORM gd-evasioni-Ev-Msg-Finish-Entry
           WHEN Msg-Goto-Cell ALSO 5107 ALSO
                    Form1-Handle 
              PERFORM gd-evasioni-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5107 ALSO
                    Form1-Handle 
              PERFORM gd-evasioni-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5107 ALSO
                    Form1-Handle 
              PERFORM gd-evasioni-Ev-Msg-Goto-Cell-Mouse
           END-EVALUATE
           .

       gd-prg-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 5108 ALSO
                    Form1-Handle 
              PERFORM gd-prg-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5108 ALSO
                    Form1-Handle 
              PERFORM gd-prg-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5108 ALSO
                    Form1-Handle 
              PERFORM gd-prg-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5108 ALSO
                    Form1-Handle 
              PERFORM gd-prg-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5108 ALSO
                    Form1-Handle 
              PERFORM gd-prg-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5108 ALSO
                    Form1-Handle 
              PERFORM gd-prg-Ev-Msg-Goto-Cell-Mouse
           END-EVALUATE
           .

       scr-stampa-Event-Proc.
           .

       scr-fido-Event-Proc.
           .

       scr-note-bolla-Event-Proc.
           .

      * USER DEFINE PARAGRAPH
       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "gclienti-procedure.cpy".
           copy "abilita-toolbar.cpy".   
           copy "riempi-combo-invio.cpy".
           copy "riempi-combo-stato.cpy".
           copy "riempi-combo-destini.cpy".
           copy "color-custom.cpy".
           Copy "utydata.cpy".
           Copy "apri-note.cpy".
           copy "status.cpy".
           copy "calcola-colore-trasparente.cpy".
           copy "stampa-procedure.cpy" 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       anagr01-Ev-After-Program.
      * <TOTEM:PARA. anagr01-Ev-After-Program>
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM 
           .
      * <TOTEM:END>
       anagr01-Ev-Before-Program.
      * <TOTEM:PARA. anagr01-Ev-Before-Program>
           move LK-BL-PROG-ID    TO COMO-PROG-ID.
           move LK-BL-PROG-ID    TO COMO-PROG-ID.
           perform GCLIENTI-BEFORE-PROGRAM 
           .
      * <TOTEM:END>
       NUOVO-LinkTo.
      * <TOTEM:PARA. NUOVO-LinkTo>
           INQUIRE TOOL-NUOVO, ENABLED IN E-NUOVO.

           IF E-NUOVO = 1
              PERFORM NUOVO
           END-IF                    
           .
      * <TOTEM:END>
       CANCELLA-LinkTo.
      * <TOTEM:PARA. CANCELLA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD.
                              
           INQUIRE TOOL-CANCELLA, ENABLED IN E-CANCELLA
           IF E-CANCELLA = 1
              PERFORM CANCELLA
           END-IF                                                
           .
      * <TOTEM:END>
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD           

           INQUIRE TOOL-SALVA, ENABLED IN E-SALVA
           IF E-SALVA = 1
              PERFORM SALVA
           END-IF           
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
           inquire tool-anteprima, enabled in e-anteprima.
           if e-anteprima = 1
              set anteprima to true
              perform SCR-STAMPA-OPEN-ROUTINE
           end-if 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
           INQUIRE TOOL-MODIFICA, ENABLED IN E-MODIFICA.

           IF E-MODIFICA = 1
              PERFORM MODIFICA
           END-IF 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
           inquire tool-stampa, enabled in e-stampa
           if e-stampa = 1
              set stampa to true
              perform SCR-STAMPA-OPEN-ROUTINE
           end-if 
           .
      * <TOTEM:END>
       TOOL-PRIMO.
      * <TOTEM:PARA. TOOL-PRIMO>
           PERFORM PRIMO 
           .
      * <TOTEM:END>
       TOOL-PRECEDENTE.
      * <TOTEM:PARA. TOOL-PRECEDENTE>
           if nuovo             
              perform PRIMO
           else
              perform PRECEDENTE
           end-if 
           .
      * <TOTEM:END>
       TOOL-SUCCESSIVO.
      * <TOTEM:PARA. TOOL-SUCCESSIVO>
           if nuovo             
              perform ULTIMO
           else
              perform SUCCESSIVO
           end-if 
           .
      * <TOTEM:END>
       TOOL-ULTIMO.
      * <TOTEM:PARA. TOOL-ULTIMO>
           PERFORM ULTIMO 
           .
      * <TOTEM:END>
       TOOL-SELEZIONA-LinkTo.
      * <TOTEM:PARA. TOOL-SELEZIONA-LinkTo>
           inquire tool-seleziona, enabled in e-seleziona
           if e-seleziona = 1
              perform SELEZIONA
           end-if 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-st-cerca, enabled in e-st-cerca
           if e-st-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       TOOL-ORD-LinkTo.
      * <TOTEM:PARA. TOOL-ORD-LinkTo>
           perform ORDINAMENTO 
           .
      * <TOTEM:END>
       TOOL-ORD-BeforeProcedure.
      * <TOTEM:PARA. TOOL-ORD-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-ORD-AfterProcedure.
      * <TOTEM:PARA. TOOL-ORD-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-codice-BeforeProcedure.
      * <TOTEM:PARA. ef-codice-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU

           .
      * <TOTEM:END>

       ef-codice-AfterProcedure.
      * <TOTEM:PARA. ef-codice-AfterProcedure>
              INQUIRE ef-codice, VALUE IN cli-codice
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codice-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-nota-pie-LinkTo.
      * <TOTEM:PARA. pb-nota-pie-LinkTo>
           perform PUSH-NOTA-PIE-PRESSED 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Begin-Drag>
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-End-Drag.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-End-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       ef-ragsoc-1-BeforeProcedure.
      * <TOTEM:PARA. ef-ragsoc-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ragsoc-2-BeforeProcedure.
      * <TOTEM:PARA. ef-ragsoc-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-indirizzo-BeforeProcedure.
      * <TOTEM:PARA. ef-indirizzo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cap-BeforeProcedure.
      * <TOTEM:PARA. ef-cap-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-localita-BeforeProcedure.
      * <TOTEM:PARA. ef-localita-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-prov-BeforeProcedure.
      * <TOTEM:PARA. ef-prov-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-nazione-BeforeProcedure.
      * <TOTEM:PARA. ef-nazione-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-tel-1-BeforeProcedure.
      * <TOTEM:PARA. ef-tel-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-tel-2-BeforeProcedure.
      * <TOTEM:PARA. ef-tel-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-fax-BeforeProcedure.
      * <TOTEM:PARA. ef-fax-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-mail-BeforeProcedure.
      * <TOTEM:PARA. ef-mail-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-url-BeforeProcedure.
      * <TOTEM:PARA. ef-url-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-tipo-BeforeProcedure.
      * <TOTEM:PARA. ef-tipo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gdo-BeforeProcedure.
      * <TOTEM:PARA. ef-gdo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-referente-BeforeProcedure.
      * <TOTEM:PARA. ef-referente-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-vettore-BeforeProcedure.
      * <TOTEM:PARA. ef-vettore-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-agente-BeforeProcedure.
      * <TOTEM:PARA. ef-agente-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-BeforeProcedure.
      * <TOTEM:PARA. ef-note-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-agg-BeforeProcedure.
      * <TOTEM:PARA. ef-note-agg-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-codfis-BeforeProcedure.
      * <TOTEM:PARA. ef-codfis-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-piva-BeforeProcedure.
      * <TOTEM:PARA. ef-piva-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-iva-BeforeProcedure.
      * <TOTEM:PARA. ef-iva-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-pag-BeforeProcedure.
      * <TOTEM:PARA. ef-pag-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-fido-BeforeProcedure.
      * <TOTEM:PARA. ef-fido-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-fido-data-BeforeProcedure.
      * <TOTEM:PARA. ef-fido-data-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cab-BeforeProcedure.
      * <TOTEM:PARA. ef-cab-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-abi-BeforeProcedure.
      * <TOTEM:PARA. ef-abi-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ragsoc-1-d-BeforeProcedure.
      * <TOTEM:PARA. ef-ragsoc-1-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ragsoc-2-d-BeforeProcedure.
      * <TOTEM:PARA. ef-ragsoc-2-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-indirizzo-d-BeforeProcedure.
      * <TOTEM:PARA. ef-indirizzo-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cap-d-BeforeProcedure.
      * <TOTEM:PARA. ef-cap-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-localita-d-BeforeProcedure.
      * <TOTEM:PARA. ef-localita-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-prov-d-BeforeProcedure.
      * <TOTEM:PARA. ef-prov-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-nazione-d-BeforeProcedure.
      * <TOTEM:PARA. ef-nazione-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-telef-1-d-BeforeProcedure.
      * <TOTEM:PARA. ef-telef-1-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-telef-2-d-BeforeProcedure.
      * <TOTEM:PARA. ef-telef-2-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-fax-d-BeforeProcedure.
      * <TOTEM:PARA. ef-fax-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-mail-d-BeforeProcedure.
      * <TOTEM:PARA. ef-mail-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-referente-d-BeforeProcedure.
      * <TOTEM:PARA. ef-referente-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-vettore-d-BeforeProcedure.
      * <TOTEM:PARA. ef-vettore-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-1-BeforeProcedure.
      * <TOTEM:PARA. ef-note-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-2-BeforeProcedure.
      * <TOTEM:PARA. ef-note-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-3-BeforeProcedure.
      * <TOTEM:PARA. ef-note-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-4-BeforeProcedure.
      * <TOTEM:PARA. ef-note-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ragsoc-1-r-BeforeProcedure.
      * <TOTEM:PARA. ef-ragsoc-1-r-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ragsoc-2-r-BeforeProcedure.
      * <TOTEM:PARA. ef-ragsoc-2-r-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-indirizzo-r-BeforeProcedure.
      * <TOTEM:PARA. ef-indirizzo-r-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-localita-r-BeforeProcedure.
      * <TOTEM:PARA. ef-localita-r-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cap-r-BeforeProcedure.
      * <TOTEM:PARA. ef-cap-r-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-prov-r-BeforeProcedure.
      * <TOTEM:PARA. ef-prov-r-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-nazione-r-BeforeProcedure.
      * <TOTEM:PARA. ef-nazione-r-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ragsoc-1-AfterProcedure.
      * <TOTEM:PARA. ef-ragsoc-1-AfterProcedure>
              INQUIRE ef-ragsoc-1, VALUE IN cli-ragsoc-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ragsoc-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ragsoc-2-AfterProcedure.
      * <TOTEM:PARA. ef-ragsoc-2-AfterProcedure>
              INQUIRE ef-ragsoc-2, VALUE IN cli-ragsoc-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ragsoc-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-indirizzo-AfterProcedure.
      * <TOTEM:PARA. ef-indirizzo-AfterProcedure>
              INQUIRE ef-indirizzo, VALUE IN cli-indirizzo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-indirizzo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cap-AfterProcedure.
      * <TOTEM:PARA. ef-cap-AfterProcedure>
              INQUIRE ef-cap, VALUE IN cli-cap
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cap-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-localita-AfterProcedure.
      * <TOTEM:PARA. ef-localita-AfterProcedure>
              INQUIRE ef-localita, VALUE IN cli-localita
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-localita-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-prov-AfterProcedure.
      * <TOTEM:PARA. ef-prov-AfterProcedure>
              INQUIRE ef-prov, VALUE IN cli-prov
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prov-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-nazione-AfterProcedure.
      * <TOTEM:PARA. ef-nazione-AfterProcedure>
              INQUIRE ef-nazione, VALUE IN cli-nazione
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-nazione-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-tel-1-AfterProcedure.
      * <TOTEM:PARA. ef-tel-1-AfterProcedure>
              INQUIRE ef-tel-1, VALUE IN cli-tel-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-tel-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-tel-2-AfterProcedure.
      * <TOTEM:PARA. ef-tel-2-AfterProcedure>
              INQUIRE ef-tel-2, VALUE IN cli-tel-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-tel-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-fax-AfterProcedure.
      * <TOTEM:PARA. ef-fax-AfterProcedure>
              INQUIRE ef-fax, VALUE IN cli-fax
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-fax-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-mail-AfterProcedure.
      * <TOTEM:PARA. ef-mail-AfterProcedure>
              INQUIRE ef-mail, VALUE IN cli-email
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mail-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-maila, VALUE IN cli-pec
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-maila-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-url-AfterProcedure.
      * <TOTEM:PARA. ef-url-AfterProcedure>
              INQUIRE ef-url, VALUE IN cli-web
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-url-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cod-ditta, VALUE IN cli-cod-ditta
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cod-ditta-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cod-ditta-d, VALUE IN des-cod-ditta
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cod-ditta-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-tipo-AfterProcedure.
      * <TOTEM:PARA. ef-tipo-AfterProcedure>
              INQUIRE ef-tipo, VALUE IN cli-tipo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-tipo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-gdo-AfterProcedure.
      * <TOTEM:PARA. ef-gdo-AfterProcedure>
              INQUIRE ef-gdo, VALUE IN cli-gdo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gdo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-referente-AfterProcedure.
      * <TOTEM:PARA. ef-referente-AfterProcedure>
              INQUIRE ef-referente, VALUE IN cli-referente
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-referente-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-vettore-AfterProcedure.
      * <TOTEM:PARA. ef-vettore-AfterProcedure>
              INQUIRE ef-vettore, VALUE IN cli-vettore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vettore-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-agente-AfterProcedure.
      * <TOTEM:PARA. ef-agente-AfterProcedure>
              INQUIRE ef-agente, VALUE IN cli-agente
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-agente-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-agente2, VALUE IN cli-agente2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-agente2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-AfterProcedure.
      * <TOTEM:PARA. ef-note-AfterProcedure>
              INQUIRE ef-note, VALUE IN cli-note
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-agg-AfterProcedure.
      * <TOTEM:PARA. ef-note-agg-AfterProcedure>
              INQUIRE ef-note-agg, VALUE IN cli-note-agg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-agg-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-codfis-AfterProcedure.
      * <TOTEM:PARA. ef-codfis-AfterProcedure>
              INQUIRE ef-codfis, VALUE IN cli-codfis
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codfis-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-piva-AfterProcedure.
      * <TOTEM:PARA. ef-piva-AfterProcedure>
              INQUIRE ef-piva, VALUE IN cli-piva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-piva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-iva-AfterProcedure.
      * <TOTEM:PARA. ef-iva-AfterProcedure>
              INQUIRE ef-gg, VALUE IN cli-gg-dilazione
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gg-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-esi, VALUE IN cli-esigibilita-iva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-esi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-iva-ese, VALUE IN cli-iva-ese
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-iva-ese-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cod-iva, VALUE IN cli-iva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cod-iva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-pag-AfterProcedure.
      * <TOTEM:PARA. ef-pag-AfterProcedure>
              INQUIRE ef-pag, VALUE IN cli-pag
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-fido-AfterProcedure.
      * <TOTEM:PARA. ef-fido-AfterProcedure>
              INQUIRE ef-fido, VALUE IN cli-fido
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-fido-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-fide, VALUE IN cli-fidejussione
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-fide-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-fido-data-AfterProcedure.
      * <TOTEM:PARA. ef-fido-data-AfterProcedure>
              INQUIRE ef-PFA-perce, VALUE IN cli-pfa-perce
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-PFA-perce-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-fido-data, VALUE IN cli-fido-data
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-fido-data-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-PFA, VALUE IN cli-pfa
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-PFA-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cab-AfterProcedure.
      * <TOTEM:PARA. ef-cab-AfterProcedure>
              INQUIRE ef-abi, VALUE IN cli-abi
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-abi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-abi-AfterProcedure.
      * <TOTEM:PARA. ef-abi-AfterProcedure>
              INQUIRE ef-cab, VALUE IN cli-cab
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cab-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ragsoc-1-d-AfterProcedure.
      * <TOTEM:PARA. ef-ragsoc-1-d-AfterProcedure>
              INQUIRE ef-ragsoc-1-d, VALUE IN des-ragsoc-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ragsoc-1-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ragsoc-2-d-AfterProcedure.
      * <TOTEM:PARA. ef-ragsoc-2-d-AfterProcedure>
              INQUIRE ef-ragsoc-2-d, VALUE IN des-ragsoc-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ragsoc-2-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-indirizzo-d-AfterProcedure.
      * <TOTEM:PARA. ef-indirizzo-d-AfterProcedure>
              INQUIRE ef-indirizzo-d, VALUE IN des-indirizzo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-indirizzo-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cap-d-AfterProcedure.
      * <TOTEM:PARA. ef-cap-d-AfterProcedure>
              INQUIRE ef-cap-d, VALUE IN des-cap
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cap-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-localita-d-AfterProcedure.
      * <TOTEM:PARA. ef-localita-d-AfterProcedure>
              INQUIRE ef-localita-d, VALUE IN des-localita
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-localita-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-prov-d-AfterProcedure.
      * <TOTEM:PARA. ef-prov-d-AfterProcedure>
              INQUIRE ef-prov-d, VALUE IN des-prov
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prov-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-nazione-d-AfterProcedure.
      * <TOTEM:PARA. ef-nazione-d-AfterProcedure>
              INQUIRE ef-nazione-d, VALUE IN des-nazione
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-nazione-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-telef-1-d-AfterProcedure.
      * <TOTEM:PARA. ef-telef-1-d-AfterProcedure>
              INQUIRE ef-telef-1-d, VALUE IN des-telef-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-telef-1-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-telef-2-d-AfterProcedure.
      * <TOTEM:PARA. ef-telef-2-d-AfterProcedure>
              INQUIRE ef-telef-2-d, VALUE IN des-telef-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-telef-2-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-fax-d-AfterProcedure.
      * <TOTEM:PARA. ef-fax-d-AfterProcedure>
              INQUIRE ef-fax-d, VALUE IN des-fax
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-fax-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-mail-d-AfterProcedure.
      * <TOTEM:PARA. ef-mail-d-AfterProcedure>
              INQUIRE ef-mail-d, VALUE IN des-mail
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mail-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-referente-d-AfterProcedure.
      * <TOTEM:PARA. ef-referente-d-AfterProcedure>
              INQUIRE ef-referente-d, VALUE IN des-referente
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-referente-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-piva-d, VALUE IN des-piva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-piva-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-CIG-d, VALUE IN des-CIG
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-CIG-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-vettore-d-AfterProcedure.
      * <TOTEM:PARA. ef-vettore-d-AfterProcedure>
              INQUIRE ef-vettore-d, VALUE IN des-vettore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vettore-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-1-AfterProcedure.
      * <TOTEM:PARA. ef-note-1-AfterProcedure>
              INQUIRE ef-note-1, VALUE IN not-note-1 OF note1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-2-AfterProcedure.
      * <TOTEM:PARA. ef-note-2-AfterProcedure>
              INQUIRE ef-note-2, VALUE IN not-note-2 OF note1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-3-AfterProcedure.
      * <TOTEM:PARA. ef-note-3-AfterProcedure>
              INQUIRE ef-note-3, VALUE IN not-note-3 OF note1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-3-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-4-AfterProcedure.
      * <TOTEM:PARA. ef-note-4-AfterProcedure>
              INQUIRE ef-note-4, VALUE IN not-note-4 OF note1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-4-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ragsoc-1-r-AfterProcedure.
      * <TOTEM:PARA. ef-ragsoc-1-r-AfterProcedure>
              INQUIRE ef-ragsoc-1-r, VALUE IN rec-ragsoc-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ragsoc-1-r-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ragsoc-2-r-AfterProcedure.
      * <TOTEM:PARA. ef-ragsoc-2-r-AfterProcedure>
              INQUIRE ef-ragsoc-2-r, VALUE IN rec-ragsoc-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ragsoc-2-r-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-indirizzo-r-AfterProcedure.
      * <TOTEM:PARA. ef-indirizzo-r-AfterProcedure>
              INQUIRE ef-indirizzo-r, VALUE IN rec-indirizzo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-indirizzo-r-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-localita-r-AfterProcedure.
      * <TOTEM:PARA. ef-localita-r-AfterProcedure>
              INQUIRE ef-localita-r, VALUE IN rec-localita
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-localita-r-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cap-r-AfterProcedure.
      * <TOTEM:PARA. ef-cap-r-AfterProcedure>
              INQUIRE ef-cap-r, VALUE IN rec-cap
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cap-r-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-prov-r-AfterProcedure.
      * <TOTEM:PARA. ef-prov-r-AfterProcedure>
              INQUIRE ef-prov-r, VALUE IN rec-provincia
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prov-r-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-nazione-r-AfterProcedure.
      * <TOTEM:PARA. ef-nazione-r-AfterProcedure>
              INQUIRE ef-nazione-r, VALUE IN rec-nazione
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-nazione-r-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       cbo-stato-BeforeProcedure.
      * <TOTEM:PARA. cbo-stato-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cbo-stato-AfterProcedure.
      * <TOTEM:PARA. cbo-stato-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-utf-BeforeProcedure.
      * <TOTEM:PARA. chk-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-inoltro-BeforeProcedure.
      * <TOTEM:PARA. chk-inoltro-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-spost-ago-BeforeProcedure.
      * <TOTEM:PARA. chk-spost-ago-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-spost-dic-BeforeProcedure.
      * <TOTEM:PARA. chk-spost-dic-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-utf-AfterProcedure.
      * <TOTEM:PARA. chk-utf-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-inoltro-AfterProcedure.
      * <TOTEM:PARA. chk-inoltro-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-spost-ago-AfterProcedure.
      * <TOTEM:PARA. chk-spost-ago-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-spost-dic-AfterProcedure.
      * <TOTEM:PARA. chk-spost-dic-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-note-LinkTo.
      * <TOTEM:PARA. pb-note-LinkTo>
           perform PUSH-NOTE-PRESSED 
           .
      * <TOTEM:END>
       Form1-DaEf-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
              INQUIRE ef-note-data, VALUE IN not-data OF note1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-data-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-dich-n, VALUE IN cli-dich-esp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-dich-n-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-id-edi, VALUE IN ecd-id-edi
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-id-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-note-cli, VALUE IN notc-note
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-cli-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-grid-nuovo-LinkTo.
      * <TOTEM:PARA. pb-grid-nuovo-LinkTo>
           perform PUSH-GRID-NUOVO-PRESSED 
           .
      * <TOTEM:END>
       pb-grid-salva-LinkTo.
      * <TOTEM:PARA. pb-grid-salva-LinkTo>
           perform PUSH-GRID-SALVA-PRESSED 
           .
      * <TOTEM:END>
       pb-grid-elimina-LinkTo.
      * <TOTEM:PARA. pb-grid-elimina-LinkTo>
           perform PUSH-GRID-ELIMINA-PRESSED 
           .
      * <TOTEM:END>
       cbo-stato-d-BeforeProcedure.
      * <TOTEM:PARA. cbo-stato-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cbo-stato-d-AfterProcedure.
      * <TOTEM:PARA. cbo-stato-d-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-superamento-BeforeProcedure.
      * <TOTEM:PARA. chk-superamento-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-superamento-AfterProcedure.
      * <TOTEM:PARA. chk-superamento-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-superamento-d-BeforeProcedure.
      * <TOTEM:PARA. chk-superamento-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-superamento-d-AfterProcedure.
      * <TOTEM:PARA. chk-superamento-d-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       Form1-DaEf-2-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-2-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-2-AfterProcedure>
              INQUIRE ef-data-dich, VALUE IN cli-data-dich
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-dich-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-q-id-edi, VALUE IN ecd-q-id-edi
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-q-id-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaEf-3-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-3-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-3-AfterProcedure>
              INQUIRE ef-data-reg, VALUE IN cli-data-reg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-reg-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-codforn-edi, VALUE IN ecd-codforn
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codforn-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-dest-edi, VALUE IN ecd-cod-consegna
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-dest-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaEf-4-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-4-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-4-AfterProcedure>
              INQUIRE ef-reg-n, VALUE IN cli-num-reg
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-reg-n-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-q-codforn-edi, VALUE IN ecd-q-codforn
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-q-codforn-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-q-dest-edi, VALUE IN ecd-q-cod-consegna
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-q-dest-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       cbo-invio-BeforeProcedure.
      * <TOTEM:PARA. cbo-invio-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cbo-invio-AfterProcedure.
      * <TOTEM:PARA. cbo-invio-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-grid-salva-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-salva-BeforeProcedure>
           modify pb-grid-salva, bitmap-number = 3 
           .
      * <TOTEM:END>
       pb-grid-salva-AfterProcedure.
      * <TOTEM:PARA. pb-grid-salva-AfterProcedure>
           modify pb-grid-salva, bitmap-number = 6 
           .
      * <TOTEM:END>
       pb-grid-nuovo-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-nuovo-BeforeProcedure>
           modify pb-grid-nuovo, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-grid-nuovo-AfterProcedure.
      * <TOTEM:PARA. pb-grid-nuovo-AfterProcedure>
           modify pb-grid-nuovo, bitmap-number = 5 
           .
      * <TOTEM:END>
       pb-grid-elimina-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-elimina-BeforeProcedure>
           modify pb-grid-elimina, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-grid-elimina-AfterProcedure.
      * <TOTEM:PARA. pb-grid-elimina-AfterProcedure>
           modify pb-grid-elimina, bitmap-number = 4 
           .
      * <TOTEM:END>
       ef-cod-da-BeforeProcedure.
      * <TOTEM:PARA. ef-cod-da-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cod-da-AfterProcedure.
      * <TOTEM:PARA. ef-cod-da-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CHECK-INTERVALLO.
           move 0 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-cod-a-BeforeProcedure.
      * <TOTEM:PARA. ef-cod-a-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cod-a-AfterProcedure.
      * <TOTEM:PARA. ef-cod-a-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CHECK-INTERVALLO.
           move 0 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       scr-stampa-Cb-1-BeforeProcedure.
      * <TOTEM:PARA. scr-stampa-Cb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           modify chk-excel, bitmap-number = 2 
           .
      * <TOTEM:END>
       scr-stampa-Cb-1-AfterProcedure.
      * <TOTEM:PARA. scr-stampa-Cb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           modify chk-excel, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-sib-BeforeProcedure.
      * <TOTEM:PARA. pb-sib-BeforeProcedure>
           modify pb-sib, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-sib-AfterProcedure.
      * <TOTEM:PARA. pb-sib-AfterProcedure>
           modify pb-sib, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-sib-LinkTo.
      * <TOTEM:PARA. pb-sib-LinkTo>
           perform SCR-STAMPA-BOTTON-SI-PRESSED 
           .
      * <TOTEM:END>
       pb-noa-BeforeProcedure.
      * <TOTEM:PARA. pb-noa-BeforeProcedure>
           modify pb-noa, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-noa-AfterProcedure.
      * <TOTEM:PARA. pb-noa-AfterProcedure>
           modify pb-noa, bitmap-number = 1 
           .
      * <TOTEM:END>
       ef-st-tipo-BeforeProcedure.
      * <TOTEM:PARA. ef-st-tipo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-st-gdo-BeforeProcedure.
      * <TOTEM:PARA. ef-st-gdo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-st-age-BeforeProcedure.
      * <TOTEM:PARA. ef-st-age-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-st-tipo-AfterProcedure.
      * <TOTEM:PARA. ef-st-tipo-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CHECK-INTERVALLO.
           move 0 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-st-gdo-AfterProcedure.
      * <TOTEM:PARA. ef-st-gdo-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CHECK-INTERVALLO.
           move 0 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-st-age-AfterProcedure.
      * <TOTEM:PARA. ef-st-age-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CHECK-INTERVALLO.
           move 0 to e-st-cerca.
           modify tool-st-cerca, enabled = e-st-cerca.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-st-cli-LinkTo.
      * <TOTEM:PARA. chk-st-cli-LinkTo>
           if e-st-cli = 1
              modify chk-st-cli, bitmap-number = 2
           else
              modify chk-st-cli, bitmap-number = 1
              move spaces to ef-st-tipo-buf
              move spaces to ef-st-gdo-buf
              move 0      to ef-st-age-buf
              move "Blank = TUTTI" to lab-st-tipo-buf
              move "Blank = TUTTI" to lab-st-gdo-buf
              move "0 = TUTTI"     to lab-st-age-buf
           end-if.

           display lab1 lab2 lab3
                    ef-st-tipo  ef-st-age  ef-st-gdo
                   lab-st-tipo lab-st-age lab-st-gdo 
           .
      * <TOTEM:END>
       chk-st-des-LinkTo.
      * <TOTEM:PARA. chk-st-des-LinkTo>
           if e-st-des = 1
              modify chk-st-des,  bitmap-number = 2
              modify chk-excel-2, bitmap-number = 1
           else
              modify chk-st-des,  bitmap-number = 1 
              modify chk-excel-2, bitmap-number = 3
              move 0              to stampa-tipo-des
              move 0              to ef-des-da-buf
              move 99999          to ef-des-a-buf
           end-if.

           display lab4 ef-des-da ef-des-a.
           modify chk-excel-2, 
                  value = stampa-tipo-des, 
                enabled = e-st-des 
           .
      * <TOTEM:END>
       chk-st-note-LinkTo.
      * <TOTEM:PARA. chk-st-note-LinkTo>
           if e-st-note = 1
              modify chk-st-note, bitmap-number = 2
              modify chk-excel-3, bitmap-number = 1
           else
              modify chk-st-note, bitmap-number = 1
              modify chk-excel-3, bitmap-number = 3
              move 0              to stampa-tipo-note
           end-if.

           display lab5.
           modify chk-excel-3,
                  value = stampa-tipo-note,
                enabled = e-st-note 
           .
      * <TOTEM:END>
       ef-des-da-BeforeProcedure.
      * <TOTEM:PARA. ef-des-da-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-des-a-BeforeProcedure.
      * <TOTEM:PARA. ef-des-a-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-des-da-AfterProcedure.
      * <TOTEM:PARA. ef-des-da-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-des-a-AfterProcedure.
      * <TOTEM:PARA. ef-des-a-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CHECK-INTERVALLO     
           .
      * <TOTEM:END>
       chk-deposito-utf-BeforeProcedure.
      * <TOTEM:PARA. chk-deposito-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-deposito-utf-AfterProcedure.
      * <TOTEM:PARA. chk-deposito-utf-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-espo-BeforeProcedure.
      * <TOTEM:PARA. pb-espo-BeforeProcedure>
           modify pb-espo, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-espo-AfterProcedure.
      * <TOTEM:PARA. pb-espo-AfterProcedure>
           modify pb-espo, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-nota-pie-BeforeProcedure.
      * <TOTEM:PARA. pb-nota-pie-BeforeProcedure>
           modify pb-nota-pie, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-nota-pie-AfterProcedure.
      * <TOTEM:PARA. pb-nota-pie-AfterProcedure>
           modify pb-nota-pie, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-stampa-BeforeProcedure.
      * <TOTEM:PARA. pb-stampa-BeforeProcedure>
           modify pb-stampa, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-stampa-AfterProcedure.
      * <TOTEM:PARA. pb-stampa-AfterProcedure>
           modify pb-stampa, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-stampa-LinkTo.
      * <TOTEM:PARA. pb-stampa-LinkTo>
           perform PB-STAMPA-PRESSED 
           .
      * <TOTEM:END>
       Form1-DaRb-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaRb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       Form1-DaRb-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaRb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-fido-extra-BeforeProcedure.
      * <TOTEM:PARA. ef-fido-extra-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-fido-extra-AfterProcedure.
      * <TOTEM:PARA. ef-fido-extra-AfterProcedure>
              INQUIRE ef-fido-extra, VALUE IN cli-fido-extra
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-fido-extra-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-finanz-LinkTo.
      * <TOTEM:PARA. pb-finanz-LinkTo>
           if vecchio and cli-gestione-fido-si
              initialize calfido-linkage 
                         sitfin-linkage replacing numeric data by zeroes
                                             alphanumeric data by spaces
              move ef-codice-buf   to link-cli-codice
              call "C$JUSTIFY"  using link-cli-codice, "R"
              inspect link-cli-codice replacing leading x"20" by x"30"
              move ef-fido-buf        to cli-fido
              move ef-fido-extra-buf  to cli-fido-extra
              call   "sitfin"  using sitfin-linkage
                                    calfido-linkage
              cancel "sitfin"
           end-if 
           .
      * <TOTEM:END>
       pb-finanz-BeforeProcedure.
      * <TOTEM:PARA. pb-finanz-BeforeProcedure>
           modify pb-finanz, bitmap-number 2 
           .
      * <TOTEM:END>
       pb-finanz-AfterProcedure.
      * <TOTEM:PARA. pb-finanz-AfterProcedure>
           modify pb-finanz, bitmap-number 1 
           .
      * <TOTEM:END>
       pb-espo-LinkTo.
      * <TOTEM:PARA. pb-espo-LinkTo>
           if vecchio
              move 0 to v-screen-fido
              modify scr-fido-Handle, visible v-screen-fido
              perform SCR-FIDO-OPEN-ROUTINE
           end-if.
           modify pb-espo, bitmap-number = 1 
           .
      * <TOTEM:END>
       cbo-stato-Ev-Ntf-Selchange.
      * <TOTEM:PARA. cbo-stato-Ev-Ntf-Selchange>
           perform CHANGE-STATO
           .
      * <TOTEM:END>
       pb-copia-LinkTo.
      * <TOTEM:PARA. pb-copia-LinkTo>
           perform PB-COPIA-PRESSED 
           .
      * <TOTEM:END>
       gd-destini-e-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-destini-e-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       gd-destini-e-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-destini-e-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-DESTINI-E 
           .
      * <TOTEM:END>
       gd-destini-e-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-destini-e-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-DESTINI-E 
           .
      * <TOTEM:END>
       gd-destini-e-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-destini-e-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-DESTINI-E 
           .
      * <TOTEM:END>
       gd-destini-e-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-destini-e-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-DESTINI-E 
           .
      * <TOTEM:END>
       gd-destini-e-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-destini-e-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-DESTINI-E
           .
      * <TOTEM:END>
       gd-evasioni-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-evasioni-Ev-Msg-Begin-Entry>
           if event-data-1 not = 3 or mod = 0
              set event-action to event-action-fail
           end-if 
           .
      * <TOTEM:END>
       gd-evasioni-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-evasioni-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-GD-EVASIONI 
           .
      * <TOTEM:END>
       gd-evasioni-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-evasioni-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-GD-EVASIONI 
           .
      * <TOTEM:END>
       gd-evasioni-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-evasioni-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-GD-EVASIONI 
           .
      * <TOTEM:END>
       gd-evasioni-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-evasioni-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-GD-EVASIONI 
           .
      * <TOTEM:END>
       gd-evasioni-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-evasioni-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-GD-EVASIONI 
           .
      * <TOTEM:END>
       gd-evasioni-Ev-Msg-Finish-Entry.
      * <TOTEM:PARA. gd-evasioni-Ev-Msg-Finish-Entry>
           inquire gd-evasioni, cursor-y in riga.
           inquire gd-evasioni(riga, 3), cell-data in col-scelta.
           if col-scelta = "S" or = "N"
              continue
           else
              set errori to true
              set event-action to event-action-fail
              display message "Valori ammessi S/N"
                        title tit-err
                         icon 2
           end-if 
           .
      * <TOTEM:END>
       pb-salva-eva-BeforeProcedure.
      * <TOTEM:PARA. pb-salva-eva-BeforeProcedure>
           modify pb-salva-eva, bitmap-number = 3 
           .
      * <TOTEM:END>
       pb-salva-eva-AfterProcedure.
      * <TOTEM:PARA. pb-salva-eva-AfterProcedure>
           modify pb-salva-eva, bitmap-number = 6 
           .
      * <TOTEM:END>
       pb-salva-eva-LinkTo.
      * <TOTEM:PARA. pb-salva-eva-LinkTo>
           perform PB-SALVA-EVA-PRESSED 
           .
      * <TOTEM:END>
       ef-gg-e-BeforeProcedure.
      * <TOTEM:PARA. ef-gg-e-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg-e-AfterProcedure.
      * <TOTEM:PARA. ef-gg-e-AfterProcedure>
              INQUIRE ef-gg-e, VALUE IN ecd-gg-scadenza-vol-OLD
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gg-e-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       chk-saldo-banco-e-BeforeProcedure.
      * <TOTEM:PARA. chk-saldo-banco-e-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-saldo-promo-e-BeforeProcedure.
      * <TOTEM:PARA. chk-saldo-promo-e-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-escludi-e-BeforeProcedure.
      * <TOTEM:PARA. chk-escludi-e-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-accorpa-e-BeforeProcedure.
      * <TOTEM:PARA. chk-accorpa-e-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-intera-e-BeforeProcedure.
      * <TOTEM:PARA. chk-intera-e-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-saldo-banco-e-AfterProcedure.
      * <TOTEM:PARA. chk-saldo-banco-e-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-saldo-promo-e-AfterProcedure.
      * <TOTEM:PARA. chk-saldo-promo-e-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-escludi-e-AfterProcedure.
      * <TOTEM:PARA. chk-escludi-e-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-accorpa-e-AfterProcedure.
      * <TOTEM:PARA. chk-accorpa-e-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-intera-e-AfterProcedure.
      * <TOTEM:PARA. chk-intera-e-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       Screen1-Ta-1-Ev-Cmd-Tabchanged.
      * <TOTEM:PARA. Screen1-Ta-1-Ev-Cmd-Tabchanged>
           perform CHANGE-TAB 
           .
      * <TOTEM:END>
       pb-copia-BeforeProcedure.
      * <TOTEM:PARA. pb-copia-BeforeProcedure>
           modify pb-copia, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-copia-AfterProcedure.
      * <TOTEM:PARA. pb-copia-AfterProcedure>
           modify pb-copia, bitmap-number = 1 
           .
      * <TOTEM:END>
       ef-data-fido-extra-BeforeProcedure.
      * <TOTEM:PARA. ef-data-fido-extra-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-data-fido-extra-AfterProcedure.
      * <TOTEM:PARA. ef-data-fido-extra-AfterProcedure>
              INQUIRE ef-data-fido-extra, VALUE IN cli-data-fido-extra
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-fido-extra-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-grade, VALUE IN cli-grade
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-grade-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-grid-elimina-prg-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-elimina-prg-BeforeProcedure>
           modify pb-grid-elimina-prg, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-grid-elimina-prg-AfterProcedure.
      * <TOTEM:PARA. pb-grid-elimina-prg-AfterProcedure>
           modify pb-grid-elimina-prg, bitmap-number = 4 
           .
      * <TOTEM:END>
       pb-grid-nuovo-prg-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-nuovo-prg-BeforeProcedure>
           modify pb-grid-nuovo-prg, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-grid-nuovo-prg-AfterProcedure.
      * <TOTEM:PARA. pb-grid-nuovo-prg-AfterProcedure>
           modify pb-grid-nuovo-prg, bitmap-number = 5 
           .
      * <TOTEM:END>
       pb-grid-nuovo-prg-LinkTo.
      * <TOTEM:PARA. pb-grid-nuovo-prg-LinkTo>
           perform PUSH-GRID-NUOVO-PRG-PRESSED 
           .
      * <TOTEM:END>
       pb-grid-elimina-prg-LinkTo.
      * <TOTEM:PARA. pb-grid-elimina-prg-LinkTo>
           perform PUSH-GRID-ELIMINA-PRG-PRESSED 
           .
      * <TOTEM:END>
       gd-prg-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-prg-Ev-Msg-Begin-Entry>
           perform GD-PRG-ENTRY 
           .
      * <TOTEM:END>
       gd-prg-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-prg-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-PRG 
           .
      * <TOTEM:END>
       gd-prg-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-prg-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-PRG 
           .
      * <TOTEM:END>
       gd-prg-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-prg-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-PRG 
           .
      * <TOTEM:END>
       gd-prg-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-prg-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-PRG 
           .
      * <TOTEM:END>
       gd-prg-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-prg-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-PRG 
           .
      * <TOTEM:END>
       Form1-DaEf-5-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-5-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-5-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-5-AfterProcedure>
              INQUIRE ef-piva-c-edi, VALUE IN ecd-piva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-piva-c-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaEf-6-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-6-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-6-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-6-AfterProcedure>
              INQUIRE ef-ragsoc-c-edi, VALUE IN ecd-ragsoc-c
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ragsoc-c-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-ragsoc-d-edi, VALUE IN ecd-ragsoc-d
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ragsoc-d-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaEf-7-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-7-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-7-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-7-AfterProcedure>
              INQUIRE ef-ind-c-edi, VALUE IN ecd-indirizzo-c
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ind-c-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-ind-d-edi, VALUE IN ecd-indirizzo-d
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ind-d-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaEf-8-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-8-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-8-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-8-AfterProcedure>
              INQUIRE ef-citta-c-edi, VALUE IN ecd-citta-c
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-citta-c-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-citta-d-edi, VALUE IN ecd-citta-d
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-citta-d-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaEf-9-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-9-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-9-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-9-AfterProcedure>
              INQUIRE ef-prov-c-edi, VALUE IN ecd-prov-c
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prov-c-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-prov-d-edi, VALUE IN ecd-prov-d
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prov-d-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaEf-10-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-10-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-10-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-10-AfterProcedure>
              INQUIRE ef-cap-c-edi, VALUE IN ecd-cap-c
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cap-c-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cap-d-edi, VALUE IN ecd-cap-d
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cap-d-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaEf-11-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-11-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-11-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-11-AfterProcedure>
              INQUIRE ef-codcli-edi, VALUE IN ecd-cod-dest
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codcli-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaEf-12-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-12-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-12-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-12-AfterProcedure>
              INQUIRE ef-q-codcli-edi, VALUE IN ecd-q-cod-dest
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-q-codcli-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       form1-gd-edi-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. form1-gd-edi-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-EDI 
           .
      * <TOTEM:END>
       form1-gd-edi-Ev-Msg-End-Drag.
      * <TOTEM:PARA. form1-gd-edi-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-EDI 
           .
      * <TOTEM:END>
       form1-gd-edi-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. form1-gd-edi-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-EDI 
           .
      * <TOTEM:END>
       form1-gd-edi-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. form1-gd-edi-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-EDI 
           .
      * <TOTEM:END>
       form1-gd-edi-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. form1-gd-edi-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-EDI 
           .
      * <TOTEM:END>
       pb-grid-salva-edi-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-salva-edi-BeforeProcedure>
           modify pb-grid-salva-edi, bitmap-number = 3 
           .
      * <TOTEM:END>
       pb-grid-salva-edi-AfterProcedure.
      * <TOTEM:PARA. pb-grid-salva-edi-AfterProcedure>
           modify pb-grid-salva-edi, bitmap-number = 6 
           .
      * <TOTEM:END>
       pb-grid-salva-edi-LinkTo.
      * <TOTEM:PARA. pb-grid-salva-edi-LinkTo>
           perform PUSH-GRID-SALVA-EDI-PRESSED 
           .
      * <TOTEM:END>
       Form1-DaCb-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaCb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaCb-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaCb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-note-bolla-LinkTo.
      * <TOTEM:PARA. pb-note-bolla-LinkTo>
           perform SCR-NOTE-BOLLA-OPEN-ROUTINE.                         
           modify form1-gd-1(riga, 29), hidden-data hidden-note-bolla-1.
           modify form1-gd-1(riga, 30), hidden-data hidden-note-bolla-2 
           .
      * <TOTEM:END>
       scr-note-b-Ef-1-BeforeProcedure.
      * <TOTEM:PARA. scr-note-b-Ef-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       scr-note-b-Ef-1-AfterProcedure.
      * <TOTEM:PARA. scr-note-b-Ef-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-localitaa-BeforeProcedure.
      * <TOTEM:PARA. ef-localitaa-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-localitaa-AfterProcedure.
      * <TOTEM:PARA. ef-localitaa-AfterProcedure>
              INQUIRE ef-sdi, VALUE IN cli-codice-SDI
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sdi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-ricerca-BeforeProcedure.
      * <TOTEM:PARA. pb-ricerca-BeforeProcedure>
           modify pb-ricerca, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ricerca-AfterProcedure.
      * <TOTEM:PARA. pb-ricerca-AfterProcedure>
           modify pb-ricerca, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-ricerca-LinkTo.
      * <TOTEM:PARA. pb-ricerca-LinkTo>
           perform SALV-MOD.
           if errori
              exit paragraph 
           end-if.
           perform VALORIZZA-OLD.
           move 0 to cli-codice.
           perform SCR-RICERCA-OPEN-ROUTINE.
           if cli-codice not = 0
              perform MODIFICA
           end-if 
           .
      * <TOTEM:END>
       pb-ricerca-ok-BeforeProcedure.
      * <TOTEM:PARA. pb-ricerca-ok-BeforeProcedure>
           modify pb-ricerca-ok, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ricerca-ok-AfterProcedure.
      * <TOTEM:PARA. pb-ricerca-ok-AfterProcedure>
           modify pb-ricerca-ok, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-ricerca-cancel-BeforeProcedure.
      * <TOTEM:PARA. pb-ricerca-cancel-BeforeProcedure>
           modify pb-ricerca-cancel, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ricerca-cancel-AfterProcedure.
      * <TOTEM:PARA. pb-ricerca-cancel-AfterProcedure>
           modify pb-ricerca-cancel, bitmap-number = 1 
           .
      * <TOTEM:END>
       ef-ricerca-piva-BeforeProcedure.
      * <TOTEM:PARA. ef-ricerca-piva-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ricerca-piva-AfterProcedure.
      * <TOTEM:PARA. ef-ricerca-piva-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-ricerca-ok-LinkTo.
      * <TOTEM:PARA. pb-ricerca-ok-LinkTo>
           if ef-ricerca-piva-buf = spaces exit paragraph end-if.
           move ef-ricerca-piva-buf      to link-rc-piva.
           move "C" to link-rc-CF.
           call   "rice-clienti" using rice-clienti-linkage
           cancel "rice-clienti".
           if link-rc-annulla = 0
              if link-rc-codice = 0
                 display message "Nessun cliente trovato coi filtri rich
      -    "iesti"
                           title titolo
                            icon 2
              else
                 move link-rc-codice to ef-codice-buf cli-codice
              end-if
           end-if.

           move 27 to key-status 
           .
      * <TOTEM:END>
       chk-excel-2-BeforeProcedure.
      * <TOTEM:PARA. chk-excel-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           modify chk-excel-2, bitmap-number = 2 
           .
      * <TOTEM:END>
       chk-excel-3-BeforeProcedure.
      * <TOTEM:PARA. chk-excel-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           modify chk-excel-3, bitmap-number = 2 
           .
      * <TOTEM:END>
       chk-excel-2-AfterProcedure.
      * <TOTEM:PARA. chk-excel-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           modify chk-excel-2, bitmap-number = 1 
           .
      * <TOTEM:END>
       chk-excel-3-AfterProcedure.
      * <TOTEM:PARA. chk-excel-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           modify chk-excel-3, bitmap-number = 1 
           .
      * <TOTEM:END>
       chk-st-cli-BeforeProcedure.
      * <TOTEM:PARA. chk-st-cli-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-st-des-BeforeProcedure.
      * <TOTEM:PARA. chk-st-des-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-st-note-BeforeProcedure.
      * <TOTEM:PARA. chk-st-note-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-st-cli-AfterProcedure.
      * <TOTEM:PARA. chk-st-cli-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-st-des-AfterProcedure.
      * <TOTEM:PARA. chk-st-des-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-st-note-AfterProcedure.
      * <TOTEM:PARA. chk-st-note-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-agente-d-BeforeProcedure.
      * <TOTEM:PARA. ef-agente-d-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-agente-d-AfterProcedure.
      * <TOTEM:PARA. ef-agente-d-AfterProcedure>
              INQUIRE ef-agente-d, VALUE IN des-age-codice
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-agente-d-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>


      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

