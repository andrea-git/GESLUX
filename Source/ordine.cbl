      *{TOTEM}PRG-COMMENT
      * ordine.Cbl
      * ordine.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          ordine.
       AUTHOR.              andre.
       DATE-WRITTEN.        mercoledì 3 luglio 2019 16:10:13.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:ordine, INIT:ordine, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "mtordini.sl".
           COPY "agenti.sl".
           COPY "tvettori.sl".
           COPY "tivaese.sl".
           COPY "clienti.sl".
           COPY "destini.sl".
           COPY "articoli.sl".
           COPY "note.sl".
           COPY "tcodpag.sl".
           COPY "progmag.sl".
           COPY "timposte.sl".
           COPY "tmarche.sl".
           COPY "tmp-assorcli.sl".
           COPY "tparamge.sl".
           COPY "tmagaz.sl".
           COPY "tcaumag.sl".
           COPY "timbalqta.sl".
           COPY "timballi.sl".
           COPY "recapiti.sl".
           COPY "rmovmag.sl".
           COPY "ttipocli.sl".
           COPY "mrordini.sl".
           COPY "tmp-progmag-zoom.sl".
           COPY "zoom-tcaumag.sl".
           COPY "tpiombo.sl".
           COPY "lisagente.sl".
           COPY "lineseq.sl".
           COPY "blister.sl".
           COPY "tordini.sl".
           COPY "rordini.sl".
           COPY "zoom-tor-master.sl".
           COPY "locali.sl".
           COPY "rpromo.sl".
           COPY "tpromo.sl".
           COPY "tmp-promo-prz.sl".
           COPY "listini.sl".
           COPY "sitfin.sl".
           COPY "tscorte.sl".
           COPY "param.sl".
           COPY "cli-prg.sl".
           COPY "pagbloc.sl".
           COPY "tordforn.sl".
           COPY "rordforn.sl".
           COPY "tcontat.sl".
           COPY "tnazioni.sl".
           COPY "grade.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "mtordini.fd".
           COPY "agenti.fd".
           COPY "tvettori.fd".
           COPY "tivaese.fd".
           COPY "clienti.fd".
           COPY "destini.fd".
           COPY "articoli.fd".
           COPY "note.fd".
           COPY "tcodpag.fd".
           COPY "progmag.fd".
           COPY "timposte.fd".
           COPY "tmarche.fd".
           COPY "tmp-assorcli.fd".
           COPY "tparamge.fd".
           COPY "tmagaz.fd".
           COPY "tcaumag.fd".
           COPY "timbalqta.fd".
           COPY "timballi.fd".
           COPY "recapiti.fd".
           COPY "rmovmag.fd".
           COPY "ttipocli.fd".
           COPY "mrordini.fd".
           COPY "tmp-progmag-zoom.fd".
           COPY "zoom-tcaumag.fd".
           COPY "tpiombo.fd".
           COPY "lisagente.fd".
           COPY "lineseq.fd".
           COPY "blister.fd".
           COPY "tordini.fd".
           COPY "rordini.fd".
           COPY "zoom-tor-master.fd".
           COPY "locali.fd".
           COPY "rpromo.fd".
           COPY "tpromo.fd".
           COPY "tmp-promo-prz.fd".
           COPY "listini.fd".
           COPY "sitfin.fd".
           COPY "tscorte.fd".
           COPY "param.fd".
           COPY "cli-prg.fd".
           COPY "pagbloc.fd".
           COPY "tordforn.fd".
           COPY "rordforn.fd".
           COPY "tcontat.fd".
           COPY "tnazioni.fd".
           COPY "grade.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "ACUGUI.DEF".
               COPY "ACUCOBOL.DEF".
               COPY "FONTS.DEF".
               COPY "CRTVARS.DEF".
               COPY "SHOWMSG.DEF".
               COPY "totem.def".
               COPY "standard.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
      * Properties & User defined Working Stoarge
       77 Form1-Handle
                  USAGE IS HANDLE OF WINDOW.
           COPY  "ORDINE-WS.DEF".
           COPY  "LINK-GORDCVAR.DEF".
       77 Form1-Tb-1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 Form1-St-1-Handle
                  USAGE IS HANDLE OF STATUS-BAR.
       77 Default-Font
                  USAGE IS HANDLE OF FONT DEFAULT-FONT.
       77 hid-old-qta      PIC  9(8).
       78 TITOLO VALUE IS "Geslux - Caricamento Ordini MASTER". 
       77 col-qta-e        PIC  9(8).
       01 FILLER           PIC  9
                  VALUE IS 0.
           88 TrovataScortaForzata VALUE IS 1    WHEN SET TO FALSE  0. 
       78 78-NumColMan VALUE IS 12. 
       01 rec-grid.
           05 col-num          PIC  z(5).
           05 col-art          PIC  zzzzz9.
           05 col-des          PIC  x(50).
           05 col-qta          PIC  z(7)9.
           05 col-uni          PIC  zzz.zzz.zz9,99.
           05 col-tot          PIC  zzz.zzz.zz9,99.
           05 col-cons         PIC  z.zz9,99.
           05 col-cou          PIC  z.zz9,99.
           05 col-add          PIC  z.zz9,99.
           05 col-imp          PIC  zzz.zzz.zz9,99.
           05 col-iva          PIC  x(3).
           05 col-oma          PIC  x.
       01 old-rec-grid.
           05 old-col-num      PIC  z(5).
           05 old-col-art      PIC  zzzzz9.
           05 old-col-des      PIC  x(50).
           05 old-col-qta      PIC  z(7)9.
           05 old-col-uni      PIC  zzz.zzz.zz9,99.
           05 old-col-tot      PIC  zzz.zzz.zz9,99.
           05 old-col-cons     PIC  z.zz9,99.
           05 old-col-cou      PIC  z.zz9,99.
           05 old-col-add      PIC  z.zz9,99.
           05 old-col-imp      PIC  zzz.zzz.zz9,99.
           05 old-col-iva      PIC  x(3).
           05 old-col-oma      PIC  x.
       01 gruppo-hidden.
           05 HiddenKey.
               10 hid-cod-articolo PIC  9(6).
               10 hid-cod-magazzino            PIC  X(3).
               10 hid-tipo-imballo PIC  X(3).
               10 hid-peso         PIC  9(5)V9(3).
           05 hid-imballi      PIC  9(4).
           05 hid-utf          PIC  9(5)V9(3).
           05 hid-non-utf      PIC  9(5)V9(3).
           05 hid-omaggio      PIC  x.
           05 hid-sconto       PIC  9(4)v999.
           05 hid-cons         PIC  9(4)v999.
           05 hid-cobat        PIC  9(4)v999.
           05 hid-des-imballo  PIC  x(50).
           05 hid-cod-art-cli  PIC  x(15).
           05 hid-cod-iva      PIC  x(3).
           05 hid-var-piu      PIC  99v99.
           05 hid-var-meno     PIC  99v99.
           05 hid-prezzo       PIC  9(9)v99.
           05 hid-giacenza     PIC  s9(8).
           05 hid-impegnato    PIC  s9(8).
           05 hid-ordinato     PIC  s9(8).
           05 hid-perce-iva    PIC  9(3)v99.
           05 hid-qta-omaggi   PIC  9(8).
           05 hid-evadi-dal    PIC  9(8).
           05 hid-blister      PIC  9.
           05 hid-flag-bloccato            PIC  9.
               88 hid-bloccato VALUE IS 1    WHEN SET TO FALSE  0. 
           05 hid-prz-commle   PIC  9(6)v99.
           05 hid-promo        PIC  9(15).
           05 hid-prz-promo    PIC  X.
               88 hid-si-prz-promo VALUE IS "S". 
               88 hid-no-prz-promo VALUE IS "N". 
           05 hid-bli-codice   PIC  9(6).
           05 hid-bli-qta      PIC  9(8).
           05 hid-bli-perce    PIC  9(3)v99.
           05 hid-saldo        PIC  X.
               88 hid-si-saldo VALUE IS "S". 
               88 hid-no-saldo VALUE IS " ". 
           05 hid-prz-manuale  PIC  9.
               88 hid-si-prz-manuale VALUE IS 1. 
               88 hid-no-prz-manuale VALUE IS 0. 
           05 hid-stato-riga   PIC  9(2).
       77 como-gruppo-hidden           PIC  x(1000).
       77 AUTO-ID          PIC  9(6)
                  VALUE IS 0,00.
       77 old-hid-evadi-dal            PIC  9(8).
       77 STATUS-int-mrordini          PIC  X(2).
           88 Valid-STATUS-int-mrordini VALUE IS "00" THRU "09". 
       77 STATUS-int-mtordini          PIC  X(2).
           88 Valid-STATUS-int-mtordini VALUE IS "00" THRU "09". 
       77 STATUS-bmrordini PIC  X(2).
           88 Valid-STATUS-bmrordini VALUE IS "00" THRU "09". 
       77 STATUS-bmtordini PIC  X(2).
           88 Valid-STATUS-bmtordini VALUE IS "00" THRU "09". 
       77 Small-Font
                  USAGE IS HANDLE OF FONT SMALL-FONT.
       77 STATUS-tpiombo   PIC  X(2).
           88 Valid-STATUS-tpiombo VALUE IS "00" THRU "09". 
       77 STATUS-lisagente PIC  X(2).
           88 Valid-STATUS-lisagente VALUE IS "00" THRU "09". 
       77 wstampa          PIC  X(256).
       77 STATUS-lineseq   PIC  X(2).
           88 Valid-STATUS-lineseq VALUE IS "00" THRU "09". 
       77 scr-conf-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 Verdana12-Occidentale
                  USAGE IS HANDLE OF FONT.
       01 tipo-scelta      PIC  9.
           88 scelta-si VALUE IS 1. 
           88 scelta-attesa VALUE IS 2. 
           88 scelta-annulla VALUE IS 3. 
       77 Verdana12B-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 STATUS-rordini   PIC  X(2).
           88 Valid-STATUS-rordini VALUE IS "00" THRU "09". 
       77 STATUS-tordini   PIC  X(2).
           88 Valid-STATUS-tordini VALUE IS "00" THRU "09". 
       77 path-tmp-tordini-zoom        PIC  X(256).
       77 STATUS-tmp-tordini-zoom      PIC  X(2).
           88 Valid-STATUS-tmp-tordini-zoom VALUE IS "00" THRU "09". 
       77 mod-vettori      PIC  9
                  VALUE IS 1.
       77 STATUS-sitfin    PIC  X(2).
           88 Valid-STATUS-sitfin VALUE IS "00" THRU "09". 
       77 status-catart    PIC  X(2).
           88 Valid-status-catart VALUE IS "00" THRU "09". 
       77 STATUS-tscorte   PIC  X(2).
           88 Valid-STATUS-tscorte VALUE IS "00" THRU "09". 
       77 como-prezzo-proposto         PIC  9(9)v99.
       77 como-sconto-proposto         PIC  9(2)v99.
       77 STATUS-evaclides PIC  X(2).
           88 Valid-STATUS-evaclides VALUE IS "00" THRU "09". 
       77 STATUS-param     PIC  X(2).
           88 Valid-STATUS-param VALUE IS "00" THRU "09". 
       77 lab-tipo-iva-buf PIC  X(30).
       77 STATUS-cli-prg   PIC  X(2).
           88 Valid-STATUS-cli-prg VALUE IS "00" THRU "09". 
       77 STATUS-pagbloc   PIC  X(2).
           88 Valid-STATUS-pagbloc VALUE IS "00" THRU "09". 
       77 STATUS-rordforn  PIC  X(2).
           88 Valid-STATUS-rordforn VALUE IS "00" THRU "09". 
       77 STATUS-tordforn  PIC  X(2).
           88 Valid-STATUS-tordforn VALUE IS "00" THRU "09". 
       77 scr-data-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 ef-dal-tutto-buf PIC  99/99/9999.
       77 STATUS-tcontat   PIC  X(2).
           88 Valid-STATUS-tcontat VALUE IS "00" THRU "09". 
       77 STATUS-tnazioni  PIC  X(2).
           88 Valid-STATUS-tnazioni VALUE IS "00" THRU "09". 
       77 v-form           PIC  9
                  VALUE IS 0.
       77 STATUS-grade     PIC  X(2).
           88 Valid-STATUS-grade VALUE IS "00" THRU "09". 

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 Screen1-Ta-1-TAB-VALUE  PIC  99  VALUE 1.
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
      * DATA CONTROL BUFFER
       01 Form1-BUF.
      * Data.Entry-Field
              05 ef-anno-BUF PIC 9(4).
              05 ef-anno-VALUEBUF PIC 9(4).
      * Data.Entry-Field
              05 ef-cau-BUF PIC X(4).
      * Data.Entry-Field
              05 ef-cli-BUF PIC x(5).
              05 ef-cli-VALUEBUF PIC 9(5).
      * Data.Entry-Field
              05 ef-des-BUF PIC x(5).
              05 ef-des-VALUEBUF PIC 9(5).
      * Data.Label
              05 lab-cli-BUF PIC X(40).
      * Data.Label
              05 lab-ind-cli-BUF PIC X(40).
      * Data.Label
              05 lab-loc-cli-BUF PIC X(35).
      * Data.Label
              05 lab-des-BUF PIC X(40).
      * Data.Label
              05 lab-ind-des-BUF PIC X(40).
      * Data.Label
              05 lab-loc-des-BUF PIC X(35).
      * Page
              05 PAGE-1-BUF.
      * Data.Entry-Field
              10 ef-num-ord-BUF PIC X(50).
              10 ef-num-ord-VALUEBUF PIC X(50).
      * Data.Entry-Field
              10 ef-data-BUF PIC 99/99/9999.
              10 ef-data-VALUEBUF PIC 9(8).
      * Data.Entry-Field
              10 ef-gest-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-data-pass-BUF PIC 99/99/9999.
      * Data.Entry-Field
              10 ef-age-BUF PIC zzzz9.
              10 ef-age-VALUEBUF PIC 9(5).
      * Data.Check-Box
              10 chk-ritira-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-pag-BUF PIC X(3).
      * Data.Check-Box
              10 chk-prenot-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-iva-BUF PIC X(3).
      * Data.Check-Box
              10 chk-saldi-banco-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-vet-BUF PIC 9(5).
      * Data.Check-Box
              10 chk-saldi-promo-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-forn-BUF PIC 9(5).
      * Data.Check-Box
              10 chk-urgente-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-immediato-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-note-1-BUF PIC X(19).
      * Data.Entry-Field
              10 ef-data-cons-BUF PIC 99/99/9999.
              10 ef-data-cons-VALUEBUF PIC 9(8).
      * Data.Entry-Field
              10 ef-note-2-BUF PIC X(30).
      * Data.Entry-Field
              10 ef-note-3-BUF PIC X(30).
      * Data.Entry-Field
              10 ef-note-4-BUF PIC X(30).
      * Data.Entry-Field
              10 ef-note-bolla-1-BUF PIC x(500).
      * Data.Entry-Field
              10 ef-note-bolla-2-BUF PIC x(500).
      * Data.Label
              10 lab-age-BUF PIC X(40).
      * Data.Label
              10 lab-vet-BUF PIC X(40).
      * Data.Label
              10 lab-forn-BUF PIC X(40).
      * Page
              05 PAGE-2-BUF.
      * Data.Entry-Field
              10 ef-art-BUF PIC z(6).
      * Data.Entry-Field
              10 ef-evadi-dal-BUF PIC 99/99/9999.
      * Data.Check-Box
              10 chk-blister-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-qta-BUF PIC zz.zzz.zz9.
      * Data.Entry-Field
              10 ef-qta-oma-BUF PIC z(8).
      * Data.Entry-Field
              10 ef-uni-BUF PIC zzz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-sconto-BUF PIC z9,99.
      * Data.Entry-Field
              10 ef-cons-BUF PIC z.zz9,99.
      * Data.Entry-Field
              10 ef-cou-BUF PIC z.zz9,99.
      * Data.Entry-Field
              10 ef-imp-BUF PIC zzz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-cod-iva-BUF PIC X(3).
      * Data.Label
              10 lab-art-BUF PIC X(100).
      * Data.Entry-Field
              10 ef-add-BUF PIC z.zz9,99.
      * Data.Label
              05 lab-cau-BUF PIC X(40).

       77 TMP-Form1-KEY1-ORDER  PIC X VALUE "A".
       77 TMP-Form1-mtordini-RESTOREBUF  PIC X(2122).
       77 TMP-Form1-KEYIS  PIC 9(3) VALUE 1.
       77 Form1-MULKEY-TMPBUF   PIC X(2122).
       77 STATUS-scr-conf-FLAG-REFRESH PIC  9.
          88 scr-conf-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 TMP-DataSet1-mtordini-BUF     PIC X(2122).
       77 TMP-DataSet1-agenti-BUF     PIC X(1233).
       77 TMP-DataSet1-tvettori-BUF     PIC X(1847).
       77 TMP-DataSet1-tivaese-BUF     PIC X(1380).
       77 TMP-DataSet1-clienti-BUF     PIC X(1910).
       77 TMP-DataSet1-destini-BUF     PIC X(3386).
       77 TMP-DataSet1-articoli-BUF     PIC X(3669).
       77 TMP-DataSet1-note-BUF     PIC X(284).
       77 TMP-DataSet1-tcodpag-BUF     PIC X(1380).
       77 TMP-DataSet1-progmag-BUF     PIC X(1090).
       77 TMP-DataSet1-timposte-BUF     PIC X(717).
       77 TMP-DataSet1-tmarche-BUF     PIC X(217).
       77 TMP-DataSet1-tmp-assorcli-BUF     PIC X(245).
       77 TMP-DataSet1-tparamge-BUF     PIC X(815).
       77 TMP-DataSet1-tmagaz-BUF     PIC X(212).
       77 TMP-DataSet1-tcaumag-BUF     PIC X(254).
       77 TMP-DataSet1-timbalqta-BUF     PIC X(167).
       77 TMP-DataSet1-timballi-BUF     PIC X(210).
       77 TMP-DataSet1-recapiti-BUF     PIC X(328).
       77 TMP-DataSet1-rmovmag-BUF     PIC X(446).
       77 TMP-DataSet1-ttipocli-BUF     PIC X(889).
       77 TMP-DataSet1-mrordini-BUF     PIC X(891).
       77 TMP-DataSet1-tmp-progmag-zoom-BUF     PIC X(195).
       77 TMP-DataSet1-zoom-tcaumag-BUF     PIC X(87).
       77 TMP-DataSet1-tpiombo-BUF     PIC X(739).
       77 TMP-DataSet1-lisagente-BUF     PIC X(245).
       77 TMP-DataSet1-lineseq-BUF     PIC X(900).
       77 TMP-DataSet1-blister-BUF     PIC X(2967).
       77 TMP-DataSet1-tordini-BUF     PIC X(3898).
       77 TMP-DataSet1-rordini-BUF     PIC X(667).
       77 TMP-DataSet1-zoom-tor-master-BUF     PIC X(125).
       77 TMP-DataSet1-locali-BUF     PIC X(203).
       77 TMP-DataSet1-rpromo-BUF     PIC X(209).
       77 TMP-DataSet1-tpromo-BUF     PIC X(263).
       77 TMP-DataSet1-tmp-promo-prz-BUF     PIC X(74).
       77 TMP-DataSet1-listini-BUF     PIC X(207).
       77 TMP-DataSet1-sitfin-BUF     PIC X(888).
       77 TMP-DataSet1-tscorte-BUF     PIC X(205).
       77 TMP-DataSet1-param-BUF     PIC X(980).
       77 TMP-DataSet1-cli-prg-BUF     PIC X(577).
       77 TMP-DataSet1-pagbloc-BUF     PIC X(609).
       77 TMP-DataSet1-tordforn-BUF     PIC X(556).
       77 TMP-DataSet1-rordforn-BUF     PIC X(544).
       77 TMP-DataSet1-tcontat-BUF     PIC X(3270).
       77 TMP-DataSet1-tnazioni-BUF     PIC X(190).
       77 TMP-DataSet1-grade-BUF     PIC X(754).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-mtordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-mtordini-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-mtordini-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-mtordini-KEY1-Asc  VALUE "A".
          88 DataSet1-mtordini-KEY1-Desc VALUE "D".
       77 DataSet1-agenti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-agenti-LOCK  VALUE "Y".
       77 DataSet1-agenti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-agenti-KEY-Asc  VALUE "A".
          88 DataSet1-agenti-KEY-Desc VALUE "D".
       77 DataSet1-tvettori-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tvettori-LOCK  VALUE "Y".
       77 DataSet1-tvettori-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tvettori-KEY-Asc  VALUE "A".
          88 DataSet1-tvettori-KEY-Desc VALUE "D".
       77 DataSet1-tivaese-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tivaese-LOCK  VALUE "Y".
       77 DataSet1-tivaese-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tivaese-KEY-Asc  VALUE "A".
          88 DataSet1-tivaese-KEY-Desc VALUE "D".
       77 DataSet1-clienti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-clienti-LOCK  VALUE "Y".
       77 DataSet1-clienti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti-KEY-Asc  VALUE "A".
          88 DataSet1-clienti-KEY-Desc VALUE "D".
       77 DataSet1-destini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-destini-LOCK  VALUE "Y".
       77 DataSet1-destini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-destini-KEY-Asc  VALUE "A".
          88 DataSet1-destini-KEY-Desc VALUE "D".
       77 DataSet1-articoli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-articoli-LOCK  VALUE "Y".
       77 DataSet1-articoli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-articoli-KEY-Asc  VALUE "A".
          88 DataSet1-articoli-KEY-Desc VALUE "D".
       77 DataSet1-note-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-note-LOCK  VALUE "Y".
       77 DataSet1-note-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-note-KEY-Asc  VALUE "A".
          88 DataSet1-note-KEY-Desc VALUE "D".
       77 DataSet1-tcodpag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcodpag-LOCK  VALUE "Y".
       77 DataSet1-tcodpag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcodpag-KEY-Asc  VALUE "A".
          88 DataSet1-tcodpag-KEY-Desc VALUE "D".
       77 DataSet1-progmag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-progmag-LOCK  VALUE "Y".
       77 DataSet1-progmag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-progmag-KEY-Asc  VALUE "A".
          88 DataSet1-progmag-KEY-Desc VALUE "D".
       77 DataSet1-timposte-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timposte-LOCK  VALUE "Y".
       77 DataSet1-timposte-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timposte-KEY-Asc  VALUE "A".
          88 DataSet1-timposte-KEY-Desc VALUE "D".
       77 DataSet1-tmarche-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmarche-LOCK  VALUE "Y".
       77 DataSet1-tmarche-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmarche-KEY-Asc  VALUE "A".
          88 DataSet1-tmarche-KEY-Desc VALUE "D".
       77 DataSet1-tmp-assorcli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-assorcli-LOCK  VALUE "Y".
       77 DataSet1-tmp-assorcli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-assorcli-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-assorcli-KEY-Desc VALUE "D".
       77 DataSet1-tparamge-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tparamge-LOCK  VALUE "Y".
       77 DataSet1-tparamge-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tparamge-KEY-Asc  VALUE "A".
          88 DataSet1-tparamge-KEY-Desc VALUE "D".
       77 DataSet1-tmagaz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmagaz-LOCK  VALUE "Y".
       77 DataSet1-tmagaz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmagaz-KEY-Asc  VALUE "A".
          88 DataSet1-tmagaz-KEY-Desc VALUE "D".
       77 DataSet1-tcaumag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcaumag-LOCK  VALUE "Y".
       77 DataSet1-tcaumag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcaumag-KEY-Asc  VALUE "A".
          88 DataSet1-tcaumag-KEY-Desc VALUE "D".
       77 DataSet1-timbalqta-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timbalqta-LOCK  VALUE "Y".
       77 DataSet1-timbalqta-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timbalqta-KEY-Asc  VALUE "A".
          88 DataSet1-timbalqta-KEY-Desc VALUE "D".
       77 DataSet1-timballi-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timballi-LOCK  VALUE "Y".
       77 DataSet1-timballi-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timballi-KEY-Asc  VALUE "A".
          88 DataSet1-timballi-KEY-Desc VALUE "D".
       77 DataSet1-recapiti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-recapiti-LOCK  VALUE "Y".
       77 DataSet1-recapiti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-recapiti-KEY-Asc  VALUE "A".
          88 DataSet1-recapiti-KEY-Desc VALUE "D".
       77 DataSet1-rmovmag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rmovmag-LOCK  VALUE "Y".
       77 DataSet1-rmovmag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rmovmag-KEY-Asc  VALUE "A".
          88 DataSet1-rmovmag-KEY-Desc VALUE "D".
       77 DataSet1-ttipocli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-ttipocli-LOCK  VALUE "Y".
       77 DataSet1-ttipocli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-ttipocli-KEY-Asc  VALUE "A".
          88 DataSet1-ttipocli-KEY-Desc VALUE "D".
       77 DataSet1-mrordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-mrordini-LOCK  VALUE "Y".
       77 DataSet1-mrordini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-mrordini-KEY-Asc  VALUE "A".
          88 DataSet1-mrordini-KEY-Desc VALUE "D".
       77 DataSet1-tmp-progmag-zoom-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-progmag-zoom-LOCK  VALUE "Y".
       77 DataSet1-tmp-progmag-zoom-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-progmag-zoom-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-progmag-zoom-KEY-Desc VALUE "D".
       77 DataSet1-zoom-tcaumag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-zoom-tcaumag-LOCK  VALUE "Y".
       77 DataSet1-zoom-tcaumag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-zoom-tcaumag-KEY-Asc  VALUE "A".
          88 DataSet1-zoom-tcaumag-KEY-Desc VALUE "D".
       77 DataSet1-tpiombo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tpiombo-LOCK  VALUE "Y".
       77 DataSet1-tpiombo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tpiombo-KEY-Asc  VALUE "A".
          88 DataSet1-tpiombo-KEY-Desc VALUE "D".
       77 DataSet1-lisagente-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-lisagente-LOCK  VALUE "Y".
       77 DataSet1-lisagente-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-lisagente-KEY-Asc  VALUE "A".
          88 DataSet1-lisagente-KEY-Desc VALUE "D".
       77 DataSet1-lineseq-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-lineseq-LOCK  VALUE "Y".
       77 DataSet1-lineseq-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-lineseq-KEY-Asc  VALUE "A".
          88 DataSet1-lineseq-KEY-Desc VALUE "D".
       77 DataSet1-blister-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-blister-LOCK  VALUE "Y".
       77 DataSet1-blister-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-blister-KEY-Asc  VALUE "A".
          88 DataSet1-blister-KEY-Desc VALUE "D".
       77 DataSet1-tordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tordini-LOCK  VALUE "Y".
       77 DataSet1-tordini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tordini-KEY-Asc  VALUE "A".
          88 DataSet1-tordini-KEY-Desc VALUE "D".
       77 DataSet1-rordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rordini-LOCK  VALUE "Y".
       77 DataSet1-rordini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rordini-KEY-Asc  VALUE "A".
          88 DataSet1-rordini-KEY-Desc VALUE "D".
       77 DataSet1-zoom-tor-master-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-zoom-tor-master-LOCK  VALUE "Y".
       77 DataSet1-zoom-tor-master-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-zoom-tor-master-KEY-Asc  VALUE "A".
          88 DataSet1-zoom-tor-master-KEY-Desc VALUE "D".
       77 DataSet1-locali-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-locali-LOCK  VALUE "Y".
       77 DataSet1-locali-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-locali-KEY-Asc  VALUE "A".
          88 DataSet1-locali-KEY-Desc VALUE "D".
       77 DataSet1-rpromo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rpromo-LOCK  VALUE "Y".
       77 DataSet1-rpromo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rpromo-KEY-Asc  VALUE "A".
          88 DataSet1-rpromo-KEY-Desc VALUE "D".
       77 DataSet1-tpromo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tpromo-LOCK  VALUE "Y".
       77 DataSet1-tpromo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tpromo-KEY-Asc  VALUE "A".
          88 DataSet1-tpromo-KEY-Desc VALUE "D".
       77 DataSet1-tmp-promo-prz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-promo-prz-LOCK  VALUE "Y".
       77 DataSet1-tmp-promo-prz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-promo-prz-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-promo-prz-KEY-Desc VALUE "D".
       77 DataSet1-listini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-listini-LOCK  VALUE "Y".
       77 DataSet1-listini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-listini-KEY-Asc  VALUE "A".
          88 DataSet1-listini-KEY-Desc VALUE "D".
       77 DataSet1-sitfin-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-sitfin-LOCK  VALUE "Y".
       77 DataSet1-sitfin-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-sitfin-KEY-Asc  VALUE "A".
          88 DataSet1-sitfin-KEY-Desc VALUE "D".
       77 DataSet1-tscorte-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tscorte-LOCK  VALUE "Y".
       77 DataSet1-tscorte-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tscorte-KEY-Asc  VALUE "A".
          88 DataSet1-tscorte-KEY-Desc VALUE "D".
       77 DataSet1-param-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-param-LOCK  VALUE "Y".
       77 DataSet1-param-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-param-KEY-Asc  VALUE "A".
          88 DataSet1-param-KEY-Desc VALUE "D".
       77 DataSet1-cli-prg-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-cli-prg-LOCK  VALUE "Y".
       77 DataSet1-cli-prg-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-cli-prg-KEY-Asc  VALUE "A".
          88 DataSet1-cli-prg-KEY-Desc VALUE "D".
       77 DataSet1-pagbloc-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-pagbloc-LOCK  VALUE "Y".
       77 DataSet1-pagbloc-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-pagbloc-KEY-Asc  VALUE "A".
          88 DataSet1-pagbloc-KEY-Desc VALUE "D".
       77 DataSet1-tordforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tordforn-LOCK  VALUE "Y".
       77 DataSet1-tordforn-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tordforn-KEY-Asc  VALUE "A".
          88 DataSet1-tordforn-KEY-Desc VALUE "D".
       77 DataSet1-rordforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rordforn-LOCK  VALUE "Y".
       77 DataSet1-rordforn-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rordforn-KEY-Asc  VALUE "A".
          88 DataSet1-rordforn-KEY-Desc VALUE "D".
       77 DataSet1-tcontat-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcontat-LOCK  VALUE "Y".
       77 DataSet1-tcontat-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcontat-KEY-Asc  VALUE "A".
          88 DataSet1-tcontat-KEY-Desc VALUE "D".
       77 DataSet1-tnazioni-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tnazioni-LOCK  VALUE "Y".
       77 DataSet1-tnazioni-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tnazioni-KEY-Asc  VALUE "A".
          88 DataSet1-tnazioni-KEY-Desc VALUE "D".
       77 DataSet1-grade-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-grade-LOCK  VALUE "Y".
       77 DataSet1-grade-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-grade-KEY-Asc  VALUE "A".
          88 DataSet1-grade-KEY-Desc VALUE "D".

       77 mtordini-mto-k-ord-cli-SPLITBUF  PIC X(55).
       77 mtordini-mto-k-data-SPLITBUF  PIC X(21).
       77 mtordini-mto-k-clides-SPLITBUF  PIC X(19).
       77 mtordini-mto-k-age-SPLITBUF  PIC X(14).
       77 mtordini-k-mto-stato-sel-SPLITBUF  PIC X(15).
       77 mtordini-k-mto-stato-SPLITBUF  PIC X(14).
       77 mtordini-mto-k-gdo-SPLITBUF  PIC X(26).
       77 mtordini-mto-k-bloc-SPLITBUF  PIC X(20).
       77 mtordini-k-giang-SPLITBUF  PIC X(21).
       77 mtordini-mto-k-promo-SPLITBUF  PIC X(25).
       77 tvettori-k-des-SPLITBUF  PIC X(41).
       77 tivaese-key01-SPLITBUF  PIC X(53).
       77 clienti-cli-K1-SPLITBUF  PIC X(47).
       77 clienti-cli-K3-SPLITBUF  PIC X(12).
       77 clienti-cli-K4-SPLITBUF  PIC X(8).
       77 destini-K1-SPLITBUF  PIC X(51).
       77 destini-k-localita-SPLITBUF  PIC X(36).
       77 articoli-art-k1-SPLITBUF  PIC X(51).
       77 articoli-art-k-frn-SPLITBUF  PIC X(16).
       77 tcodpag-TBL-CODICE-01-SPLITBUF  PIC X(53).
       77 progmag-key01-SPLITBUF  PIC X(21).
       77 tmp-assorcli-key01-SPLITBUF  PIC X(22).
       77 tcaumag-k-mag-SPLITBUF  PIC X(5).
       77 rmovmag-k-articolo-SPLITBUF  PIC X(19).
       77 rmovmag-rmo-chiave-ricerca-SPLITBUF  PIC X(25).
       77 rmovmag-k-progmag-SPLITBUF  PIC X(21).
       77 rmovmag-k-art-data-SPLITBUF  PIC X(15).
       77 mrordini-mro-k-promo-SPLITBUF  PIC X(33).
       77 mrordini-mro-k-articolo-SPLITBUF  PIC X(24).
       77 mrordini-mro-k-progr-SPLITBUF  PIC X(18).
       77 mrordini-mro-k-tprev-SPLITBUF  PIC X(39).
       77 tmp-progmag-zoom-key-des-SPLITBUF  PIC X(64).
       77 tmp-progmag-zoom-key-art-SPLITBUF  PIC X(7).
       77 lisagente-k-codice-SPLITBUF  PIC X(5).
       77 blister-k-magaz-SPLITBUF  PIC X(10).
       77 blister-k-des-SPLITBUF  PIC X(51).
       77 tordini-k-causale-SPLITBUF  PIC X(17).
       77 tordini-k1-SPLITBUF  PIC X(23).
       77 tordini-k2-SPLITBUF  PIC X(21).
       77 tordini-k-bolla-SPLITBUF  PIC X(13).
       77 tordini-k3-SPLITBUF  PIC X(22).
       77 tordini-k-fattura-SPLITBUF  PIC X(13).
       77 tordini-k4-SPLITBUF  PIC X(30).
       77 tordini-k-contab-SPLITBUF  PIC X(14).
       77 tordini-k-tipo-SPLITBUF  PIC X(14).
       77 tordini-k-data-SPLITBUF  PIC X(17).
       77 tordini-k-agfatt-SPLITBUF  PIC X(42).
       77 tordini-k-stbolle-SPLITBUF  PIC X(34).
       77 tordini-k-andamento-data-SPLITBUF  PIC X(10).
       77 tordini-k-andamento-cliente-SPLITBUF  PIC X(15).
       77 tordini-k-andamento-clides-SPLITBUF  PIC X(20).
       77 tordini-k-promo-SPLITBUF  PIC X(29).
       77 tordini-k-or-SPLITBUF  PIC X(21).
       77 tordini-k-tor-inviare-SPLITBUF  PIC X(14).
       77 tordini-k-tor-tipocli-SPLITBUF  PIC X(25).
       77 tordini-k-tor-gdo-SPLITBUF  PIC X(28).
       77 rordini-ror-k-promo-SPLITBUF  PIC X(16).
       77 rordini-ror-k-articolo-SPLITBUF  PIC X(24).
       77 rordini-ror-k-master-SPLITBUF  PIC X(35).
       77 rordini-ror-k-stbolle-SPLITBUF  PIC X(30).
       77 locali-loc-chiave-gdo-fine-SPLITBUF  PIC X(32).
       77 locali-loc-chiave-fine-SPLITBUF  PIC X(32).
       77 locali-loc-chiave-ini-SPLITBUF  PIC X(32).
       77 rpromo-k-stampa-SPLITBUF  PIC X(32).
       77 tpromo-tpr-chiave-ricerca-SPLITBUF  PIC X(22).
       77 tpromo-tpr-chiave-gdo-fine-SPLITBUF  PIC X(22).
       77 tpromo-tpr-chiave-fine-SPLITBUF  PIC X(22).
       77 tpromo-tpr-chiave-ini-SPLITBUF  PIC X(22).
       77 tpromo-tpr-chiave-volantino-SPLITBUF  PIC X(22).
       77 tpromo-tpr-k-fine-vol-SPLITBUF  PIC X(22).
       77 tpromo-tpr-k-data-ins-SPLITBUF  PIC X(29).
       77 listini-lst-k-articolo-SPLITBUF  PIC X(20).
       77 listini-lst-k-cod-art-cli-SPLITBUF  PIC X(29).
       77 tordforn-tof-k-causale-SPLITBUF  PIC X(17).
       77 tordforn-tof-k-stato-SPLITBUF  PIC X(14).
       77 tordforn-k-fornitore-SPLITBUF  PIC X(24).
       77 tordforn-tof-k-data-SPLITBUF  PIC X(21).
       77 rordforn-rof-k-articolo-SPLITBUF  PIC X(24).
       77 rordforn-rof-k-art-mag-SPLITBUF  PIC X(27).
      * FOR SPLIT KEY BUFFER
       77 DataSet1-tmp-progmag-zoom-SPLIT-BUF1   PIC X(64).


      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-ef-anno VALUE 5001.
       78  78-ID-ef-cau VALUE 5002.
       78  78-ID-ef-cli VALUE 5003.
       78  78-ID-ef-des VALUE 5004.
       78  78-ID-ef-num-ord VALUE 5005.
       78  78-ID-ef-data VALUE 5006.
       78  78-ID-ef-gest VALUE 5007.
       78  78-ID-ef-data-pass VALUE 5008.
       78  78-ID-ef-age VALUE 5009.
       78  78-ID-chk-ritira VALUE 5010.
       78  78-ID-ef-pag VALUE 5011.
       78  78-ID-chk-prenot VALUE 5012.
       78  78-ID-ef-iva VALUE 5013.
       78  78-ID-chk-saldi-banco VALUE 5014.
       78  78-ID-ef-vet VALUE 5015.
       78  78-ID-chk-saldi-promo VALUE 5016.
       78  78-ID-ef-forn VALUE 5017.
       78  78-ID-chk-urgente VALUE 5018.
       78  78-ID-chk-immediato VALUE 5019.
       78  78-ID-ef-note-1 VALUE 5020.
       78  78-ID-ef-data-cons VALUE 5021.
       78  78-ID-ef-note-2 VALUE 5022.
       78  78-ID-ef-note-3 VALUE 5023.
       78  78-ID-ef-note-4 VALUE 5024.
       78  78-ID-ef-note-bolla-1 VALUE 5025.
       78  78-ID-ef-note-bolla-2 VALUE 5026.
       78  78-ID-cbo-stato VALUE 5027.
       78  78-ID-ef-art VALUE 5028.
       78  78-ID-ef-evadi-dal VALUE 5029.
       78  78-ID-chk-blister VALUE 5030.
       78  78-ID-ef-qta VALUE 5031.
       78  78-ID-ef-qta-oma VALUE 5032.
       78  78-ID-ef-uni VALUE 5033.
       78  78-ID-ef-sconto VALUE 5034.
       78  78-ID-ef-cons VALUE 5035.
       78  78-ID-ef-cou VALUE 5036.
       78  78-ID-ef-imp VALUE 5037.
       78  78-ID-ef-cod-iva VALUE 5038.
       78  78-ID-ef-add VALUE 5039.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "COMMON-LINKAGE.DEF".

      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           AFTER PROCEDURE Form1-AfterProcedure,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           .

      * ENTRY FIELD
       05
           ef-anno, 
           Entry-Field, 
           COL 12,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-k,
           FONT IS Small-Font,
           ID IS 78-ID-ef-anno,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           READ-ONLY,
           VALUE ef-anno-BUF,
           .

      * ENTRY FIELD
       05
           ef-cau, 
           Entry-Field, 
           COL 57,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-k,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cau,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 4,
           VALUE ef-cau-BUF,
           .

      * ENTRY FIELD
       05
           ef-cli, 
           Entry-Field, 
           COL 12,00, 
           LINE 4,50,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-k,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 5,
           VALUE ef-cli-BUF,
           .

      * ENTRY FIELD
       05
           ef-des, 
           Entry-Field, 
           COL 12,00, 
           LINE 7,00,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-k,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 5,
           VALUE ef-des-BUF,
           .

      * BAR
       05
           Form1-Br-2, 
           Bar,
           COL 1,17, 
           LINE 9,38,
           SIZE 157,83 ,
           COLOR IS 14,
           ID IS 100,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * LABEL
       05
           CST-BLOCKPGM, 
           Label, 
           COL 144,33, 
           LINE 9,62,
           LINES 1,00 ,
           SIZE 13,86 ,
           ID IS 999,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Form1-Custom1-1, 
           Label, 
           COL 123,83, 
           LINE 9,85,
           LINES 0,62 ,
           SIZE 12,33 ,
           FONT IS Default-Font,
           ID IS 666,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Form1-La-1, 
           Label, 
           COL 3,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Anno",
           .

      * LABEL
       05
           Form1-La-2, 
           Label, 
           COL 3,00, 
           LINE 4,50,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cliente",
           .

      * LABEL
       05
           Form1-La-3, 
           Label, 
           COL 3,00, 
           LINE 7,00,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 5,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Destino",
           .

      * DB_LABEL
       05
           lab-cli, 
           Label, 
           COL 20,00, 
           LINE 4,50,
           LINES 2,00 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 7,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-cli-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-ind-cli, 
           Label, 
           COL 66,00, 
           LINE 4,50,
           LINES 2,00 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 8,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-ind-cli-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-loc-cli, 
           Label, 
           COL 112,00, 
           LINE 4,50,
           LINES 2,00 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 9,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-loc-cli-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-des, 
           Label, 
           COL 20,00, 
           LINE 7,00,
           LINES 2,00 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-des-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-ind-des, 
           Label, 
           COL 66,00, 
           LINE 7,00,
           LINES 2,00 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 11,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-ind-des-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-loc-des, 
           Label, 
           COL 112,00, 
           LINE 7,00,
           LINES 2,00 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-loc-des-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * TAB
       05
           Screen1-Ta-1, 
           Tab-Control, 
           COL 2,50, 
           LINE 11,00,
           LINES 35,00 ,
           SIZE 155,00 ,
           ID IS 5000,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           EVENT PROCEDURE Screen1-Ta-1-Event-Proc,
           .

      * PAGE
       05
           PAGE-1, 
           VISIBLE Form1-Pg-1-Visible,
           COL 4, 
           LINE 13,
           .

      * ENTRY FIELD
       10
           ef-num-ord, 
           Entry-Field, 
           COL 27,17, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 31,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-num-ord,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 35,
           VALUE ef-num-ord-BUF,
           .

      * ENTRY FIELD
       10
           ef-data, 
           Entry-Field, 
           COL 71,17, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-data-BUF,
           .

      * ENTRY FIELD
       10
           ef-gest, 
           Entry-Field, 
           COL 96,17, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gest,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-gest-BUF,
           VISIBLE v-gest-plus,
           .

      * ENTRY FIELD
       10
           ef-data-pass, 
           Entry-Field, 
           COL 142,17, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data-pass,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-data-pass-BUF,
           .

      * ENTRY FIELD
       10
           ef-age, 
           Entry-Field, 
           COL 27,17, 
           LINE 16,31,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-age,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           READ-ONLY,
           VALUE ef-age-BUF,
           .

      * CHECK BOX
       10
           chk-ritira, 
           Check-Box, 
           COL 142,17, 
           LINE 16,31,
           LINES 1,31 ,
           SIZE 2,70 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-ritira,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-ritira-BUF,
            .

      * ENTRY FIELD
       10
           ef-pag, 
           Entry-Field, 
           COL 27,17, 
           LINE 18,38,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           READ-ONLY,
           VALUE ef-pag-BUF,
           .

      * CHECK BOX
       10
           chk-prenot, 
           Check-Box, 
           COL 142,17, 
           LINE 18,31,
           LINES 1,31 ,
           SIZE 2,67 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 78-ID-chk-prenot,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-prenot-BUF,
            .

      * ENTRY FIELD
       10
           ef-iva, 
           Entry-Field, 
           COL 27,17, 
           LINE 20,31,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-iva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           READ-ONLY,
           VALUE ef-iva-BUF,
           .

      * CHECK BOX
       10
           chk-saldi-banco, 
           Check-Box, 
           COL 142,17, 
           LINE 20,31,
           LINES 1,31 ,
           SIZE 2,67 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1007
           FLAT,
           ID IS 78-ID-chk-saldi-banco,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-saldi-banco-BUF,
           BEFORE PROCEDURE chk-saldi-banco-BeforeProcedure, 
            .

      * ENTRY FIELD
       10
           ef-vet, 
           Entry-Field, 
           COL 27,17, 
           LINE 22,15,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-vettori,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vet,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-vet-BUF,
           .

      * CHECK BOX
       10
           chk-saldi-promo, 
           Check-Box, 
           COL 142,17, 
           LINE 22,31,
           LINES 1,31 ,
           SIZE 2,67 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1008
           FLAT,
           ID IS 78-ID-chk-saldi-promo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-saldi-promo-BUF,
           BEFORE PROCEDURE chk-saldi-bancoa-BeforeProcedure, 
            .

      * ENTRY FIELD
       10
           ef-forn, 
           Entry-Field, 
           COL 27,17, 
           LINE 24,07,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-forn,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-forn-BUF,
           VISIBLE v-forn,
           .

      * CHECK BOX
       10
           chk-urgente, 
           Check-Box, 
           COL 108,84, 
           LINE 24,31,
           LINES 1,31 ,
           SIZE 2,67 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-urgente,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Urgente",
           VALUE chk-urgente-BUF,
           BEFORE PROCEDURE chk-urgente-BeforeProcedure, 
            .


      * CHECK BOX
       10
           chk-immediato, 
           Check-Box, 
           COL 142,17, 
           LINE 24,31,
           LINES 1,31 ,
           SIZE 2,67 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-immediato,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-immediato-BUF,
           BEFORE PROCEDURE chk-saldi-bancoa-BeforeProcedure, 
            .

      * ENTRY FIELD
       10
           ef-note-1, 
           Entry-Field, 
           COL 27,17, 
           LINE 26,15,
           LINES 1,31 ,
           SIZE 35,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 19,
           VALUE ef-note-1-BUF,
           .

      * ENTRY FIELD
       10
           ef-data-cons, 
           Entry-Field, 
           COL 71,17, 
           LINE 26,15,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data-cons,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-data-cons-BUF,
           .

      * ENTRY FIELD
       10
           ef-note-2, 
           Entry-Field, 
           COL 96,17, 
           LINE 26,15,
           LINES 1,31 ,
           SIZE 55,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-note-2-BUF,
           .

      * ENTRY FIELD
       10
           ef-note-3, 
           Entry-Field, 
           COL 27,17, 
           LINE 28,00,
           LINES 1,31 ,
           SIZE 55,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-note-3-BUF,
           .

      * ENTRY FIELD
       10
           ef-note-4, 
           Entry-Field, 
           COL 96,17, 
           LINE 28,00,
           LINES 1,31 ,
           SIZE 55,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-note-4-BUF,
           .

      * ENTRY FIELD
       10
           ef-note-bolla-1, 
           Entry-Field, 
           COL 27,17, 
           LINE 30,07,
           LINES 2,50 ,
           SIZE 124,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-note-bolla-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 130,
           VSCROLL-BAR,
           VALUE ef-note-bolla-1-BUF,
           BEFORE PROCEDURE Form1-DaEf-1-BeforeProcedure, 
           .

      * ENTRY FIELD
       10
           ef-note-bolla-2, 
           Entry-Field, 
           COL 27,17, 
           LINE 34,69,
           LINES 2,50 ,
           SIZE 124,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           ID IS 78-ID-ef-note-bolla-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 130,
           VSCROLL-BAR,
           VALUE ef-note-bolla-2-BUF,
           BEFORE PROCEDURE Form1-DaEf-1-BeforeProcedure, 
           .

      * COMBO-BOX
       10
           cbo-stato, 
           Combo-Box, 
           COL 27,17, 
           LINE 39,92,
           LINES 5,00 ,
           SIZE 17,00 ,
           3-D,
           COLOR IS 513,
           ENABLED 0,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-stato,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-stato-buf,
           AFTER PROCEDURE cbo-stato-AfterProcedure, 
           .

      * LABEL
       10
           Form1-La-4, 
           Label, 
           COL 5,17, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 13,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Numero ordine cliente",
           .

      * LABEL
       10
           Form1-La-5, 
           Label, 
           COL 60,17, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data ordine",
           .

      * LABEL
       10
           Form1-La-6, 
           Label, 
           COL 120,17, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data passaggio ordine",
           .

      * LABEL
       10
           Form1-La-7, 
           Label, 
           COL 5,17, 
           LINE 16,31,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice agente",
           .

      * LABEL
       10
           Form1-La-8, 
           Label, 
           COL 5,17, 
           LINE 18,38,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 22,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice pagamento",
           .

      * LABEL
       10
           lab-tipo-iva, 
           Label, 
           COL 5,17, 
           LINE 20,31,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-tipo-iva-buf,
           .

      * LABEL
       10
           Form1-La-10, 
           Label, 
           COL 5,17, 
           LINE 22,15,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice vettore",
           .

      * LABEL
       10
           Form1-La-11, 
           Label, 
           COL 5,17, 
           LINE 26,15,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Dati di consegna",
           .

      * LABEL
       10
           Form1-La-12, 
           Label, 
           COL 64,17, 
           LINE 26,15,
           LINES 1,31 ,
           SIZE 5,00 ,
           FONT IS Small-Font,
           ID IS 29,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data",
           .

      * LABEL
       10
           Form1-La-13, 
           Label, 
           COL 86,17, 
           LINE 26,15,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 31,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note 2",
           .

      * LABEL
       10
           Form1-La-14, 
           Label, 
           COL 5,17, 
           LINE 28,00,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 33,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note 3",
           .

      * LABEL
       10
           Form1-La-15, 
           Label, 
           COL 86,17, 
           LINE 28,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 35,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note 4",
           .

      * LABEL
       10
           Form1-La-29, 
           Label, 
           COL 5,17, 
           LINE 40,07,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 57,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Stato",
           .

      * DB_LABEL
       10
           lab-age, 
           Label, 
           COL 35,17, 
           LINE 16,31,
           LINES 1,31 ,
           SIZE 60,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-age-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-vet, 
           Label, 
           COL 35,17, 
           LINE 22,15,
           LINES 1,31 ,
           SIZE 60,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 48,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-vet-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           lab-pag, 
           Label, 
           COL 35,17, 
           LINE 18,38,
           LINES 1,54 ,
           SIZE 60,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-pag-buf,
           .

      * LABEL
       10
           lab-iva, 
           Label, 
           COL 35,17, 
           LINE 20,31,
           LINES 1,54 ,
           SIZE 60,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 47,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-iva-buf,
           .

      * LABEL
       10
           lab-gest, 
           Label, 
           COL 86,17, 
           LINE 14,31,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 49,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Gest Plus",
           VISIBLE v-gest-plus,
           .

      * LABEL
       10
           Form1-La-28, 
           Label, 
           COL 120,17, 
           LINE 16,31,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Ritira in Lubex",
           .

      * LABEL
       10
           Form1-La-28a, 
           Label, 
           COL 120,17, 
           LINE 17,92,
           LINES 2,08 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 16,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prenotazione quantità (no saldi)",
           .

      * LABEL
       10
           Form1-La-28aa, 
           Label, 
           COL 120,17, 
           LINE 20,31,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 18,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "TENERE SALDI BANCO",
           .

      * LABEL
       10
           LabFor, 
           Label, 
           COL 5,17, 
           LINE 24,07,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 50,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Fornitore associato",
           VISIBLE v-forn,
           .

      * DB_LABEL
       10
           lab-forn, 
           Label, 
           COL 35,17, 
           LINE 24,07,
           LINES 1,31 ,
           SIZE 60,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 51,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-forn-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           VISIBLE v-forn,
           .

      * LABEL
       10
           Form1-La-28aaa, 
           Label, 
           COL 120,17, 
           LINE 22,31,
           LINES 1,31 ,
           SIZE 20,50 ,
           FONT IS Small-Font,
           ID IS 52,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "TENERE SALDI PROMO",
           VISIBLE 1,
           .

      * LABEL
       10
           Form1-La-28aaaa, 
           Label, 
           COL 120,17, 
           LINE 24,31,
           LINES 1,31 ,
           SIZE 20,50 ,
           FONT IS Small-Font,
           ID IS 53,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "EVASIONE IMMEDIATA",
           VISIBLE 1,
           .

      * LABEL
       10
           Form1-La-14a, 
           Label, 
           COL 5,17, 
           LINE 30,07,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 54,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note bolla 1",
           .

      * LABEL
       10
           Form1-La-14aa, 
           Label, 
           COL 5,17, 
           LINE 34,69,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 59,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note bolla 2",
           .

      * LABEL
       10
           Form1-La-28aaaaa, 
           Label, 
           COL 96,17, 
           LINE 24,31,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 60,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "URGENTE",
           VISIBLE 1,
           .

      * PAGE
       05
           PAGE-2, 
           VISIBLE Form1-Pg-2-Visible,
           COL 4, 
           LINE 13,
           .

      * PUSH BUTTON
       10
           pb-blister, 
           Push-Button, 
           COL 17,67, 
           LINE 36,69,
           LINES 1,31 ,
           SIZE 4,00 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1004,
           FONT IS Small-Font,
           ID IS 69,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "...",
           VISIBLE v-blister,
           .

      * ENTRY FIELD
       10
           ef-art, 
           Entry-Field, 
           COL 22,17, 
           LINE 36,69,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-art,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-art-BUF,
           VISIBLE v-manuale,
           .

      * ENTRY FIELD
       10
           ef-evadi-dal, 
           Entry-Field, 
           COL 92,17, 
           LINE 36,69,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-evadi-dal,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-evadi-dal-BUF,
           VISIBLE v-manuale,
           .

      * CHECK BOX
       10
           chk-blister, 
           Check-Box, 
           COL 152,84, 
           LINE 41,69,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1003
           FLAT,
           ID IS 78-ID-chk-blister,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "&B",
           VALUE chk-blister-BUF,
           VISIBLE 0,
            .
      * ENTRY FIELD
       10
           ef-qta, 
           Entry-Field, 
           COL 116,50, 
           LINE 36,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-qta,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-qta-BUF,
           VISIBLE v-manuale,
           .

      * ENTRY FIELD
       10
           ef-qta-oma, 
           Entry-Field, 
           COL 144,84, 
           LINE 38,23,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-qta-oma,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-qta-oma-BUF,
           VISIBLE 0,
           .

      * ENTRY FIELD
       10
           ef-uni, 
           Entry-Field, 
           COL 22,17, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 14,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-uni,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           READ-ONLY,
           VALUE ef-uni-BUF,
           VISIBLE v-gdo,
           .

      * ENTRY FIELD
       10
           ef-sconto, 
           Entry-Field, 
           COL 68,67, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           READ-ONLY,
           VALUE ef-sconto-BUF,
           VISIBLE v-gdo,
           .

      * ENTRY FIELD
       10
           ef-cons, 
           Entry-Field, 
           COL 92,17, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cons,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           READ-ONLY,
           VALUE ef-cons-BUF,
           VISIBLE v-gdo,
           .

      * ENTRY FIELD
       10
           ef-cou, 
           Entry-Field, 
           COL 116,50, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cou,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           READ-ONLY,
           VALUE ef-cou-BUF,
           VISIBLE v-gdo,
           .

      * ENTRY FIELD
       10
           ef-imp, 
           Entry-Field, 
           COL 22,17, 
           LINE 41,46,
           LINES 1,31 ,
           SIZE 14,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           READ-ONLY,
           VALUE ef-imp-BUF,
           VISIBLE v-gdo,
           .

      * ENTRY FIELD
       10
           ef-cod-iva, 
           Entry-Field, 
           COL 68,67, 
           LINE 41,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cod-iva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-cod-iva-BUF,
           VISIBLE v-gdo,
           .

      * GRID
       10
           Form1-Gd-1, 
           Grid, 
           COL 5,17, 
           LINE 15,69,
           LINES 19,54 ,
           SIZE 150,00 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           CENTERED-HEADINGS,
           COLOR IS 516,
           DATA-COLUMNS (1, 6, 12, 62, 70, 84, 98, 106, 114, 122, 136, 
           139),
           ALIGNMENT ("R", "R", "U", "R", "R", "R", "R", "R", "R", "R", 
           "C", "C"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("9(5)", "9(6)", "X", "9(8)", "9(12)", "9(5)", "9(
      -    "7)", "9(7)", "9(7)", "9(12)", "x(3)", "X"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 2000,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ROW-HEADINGS,
           TILED-HEADINGS,
           VISIBLE v-manuale,
           VPADDING 54,
           VSCROLL,
           EVENT PROCEDURE Form1-Gd-1-Event-Proc,
           .

      * PUSH BUTTON
       10
           pb-grid-nuovo, 
           Push-Button, 
           COL 129,17, 
           LINE 35,99,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 5,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1002,
           FLAT,
           FONT IS Small-Font,
           ID IS 64,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Aggi&unge una riga all'ordine",
           VISIBLE v-manuale,
           AFTER PROCEDURE pb-grid-nuovo-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-nuovo-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-grid-elimina, 
           Push-Button, 
           COL 142,17, 
           LINE 35,99,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 4,
           UNFRAMED,
           SQUARE,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1005,
           FLAT,
           FONT IS Small-Font,
           ID IS 1001,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "&Elimina la riga selezionata",
           VISIBLE v-manuale,
           AFTER PROCEDURE pb-grid-elimina-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-elimina-BeforeProcedure, 
           .

      * LABEL
       10
           Form1-La-19, 
           Label, 
           COL 5,17, 
           LINE 36,69,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 4,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Articolo",
           VISIBLE v-manuale,
           .

      * LABEL
       10
           Form1-La-20, 
           Label, 
           COL 112,00, 
           LINE 36,69,
           LINES 1,31 ,
           SIZE 3,00 ,
           FONT IS Small-Font,
           ID IS 26,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Qtà",
           VISIBLE v-manuale,
           .

      * LABEL
       10
           Form1-La-21, 
           Label, 
           COL 5,17, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prezzo Unitario",
           VISIBLE v-gdo,
           .

      * LABEL
       10
           Form1-La-22, 
           Label, 
           COL 81,17, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "I. Consumo",
           VISIBLE v-gdo,
           .

      * LABEL
       10
           lab-imposta, 
           Label, 
           COL 102,50, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 12,50 ,
           FONT IS Small-Font,
           ID IS 37,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE label-cou-cobat,
           VISIBLE v-gdo,
           .

      * LABEL
       10
           Form1-La-24, 
           Label, 
           COL 5,17, 
           LINE 41,46,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 38,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imponibile Merce",
           VISIBLE v-gdo,
           .

      * LABEL
       10
           Form1-La-25, 
           Label, 
           COL 48,67, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 39,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Percentuale Sconto",
           VISIBLE v-gdo,
           .

      * LABEL
       10
           Form1-La-26, 
           Label, 
           COL 48,67, 
           LINE 41,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 41,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice I.V.A.",
           VISIBLE v-gdo,
           .

      * DB_LABEL
       10
           lab-art, 
           Label, 
           COL 31,17, 
           LINE 36,69,
           LINES 2,54 ,
           SIZE 48,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 44,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-art-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           VISIBLE v-manuale,
           .

      * LABEL
       10
           lab-gia, 
           Label, 
           COL 5,17, 
           LINE 44,38,
           LINES 1,31 ,
           SIZE 16,00 ,
           COLOR IS Colorgiacenza,
           FONT IS Small-Font,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GIACENZA",
           .

      * LABEL
       10
           lab-imp, 
           Label, 
           COL 63,17, 
           LINE 44,38,
           LINES 1,31 ,
           SIZE 19,00 ,
           COLOR IS ColorImpegnato,
           FONT IS Small-Font,
           ID IS 42,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "IMPEGNATO",
           .

      * LABEL
       10
           lab-ord, 
           Label, 
           COL 121,34, 
           LINE 44,38,
           LINES 1,31 ,
           SIZE 19,00 ,
           COLOR IS ColorOrdinato,
           FONT IS Small-Font,
           ID IS 43,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "ORDINATO",
           .

      * LABEL
       10
           lab-giacenza, 
           Label, 
           COL 22,17, 
           LINE 44,38,
           LINES 1,31 ,
           SIZE 10,00 ,
           COLOR IS ColorGiacenza,
           FONT IS Small-Font,
           ID IS 61,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE giacenza-ed,
           .

      * LABEL
       10
           lab-impegnato, 
           Label, 
           COL 83,00, 
           LINE 44,38,
           LINES 1,31 ,
           SIZE 10,00 ,
           COLOR IS ColorImpegnato,
           FONT IS Small-Font,
           ID IS 62,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE impegnato-ed,
           .

      * LABEL
       10
           lab-ordinato, 
           Label, 
           COL 142,00, 
           LINE 44,38,
           LINES 1,31 ,
           SIZE 10,00 ,
           COLOR IS ColorOrdinato,
           FONT IS Small-Font,
           ID IS 63,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE ordinato-ed,
           .

      * BAR
       10
           Form1-Br-1, 
           Bar,
           COL 3,17, 
           LINE 44,00,
           SIZE 153,67 ,
           ID IS 65,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           lab-iva-2, 
           Label, 
           COL 77,50, 
           LINE 41,46,
           LINES 1,54 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 66,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-KEY-LETTER,
           TRANSPARENT,
           TITLE lab-iva-2-buf,
           VISIBLE v-gdo,
           .

      * LABEL
       10
           Form1-La-20a, 
           Label, 
           COL 131,84, 
           LINE 38,23,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 67,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "di cui omaggio",
           VISIBLE 0,
           .

      * LABEL
       10
           Form1-La-27, 
           Label, 
           COL 146,84, 
           LINE 41,69,
           LINES 1,31 ,
           SIZE 5,00 ,
           FONT IS Small-Font,
           ID IS 73,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "&Blister",
           VISIBLE 0,
           .

      * LABEL
       10
           lab-forzato, 
           Label, 
           COL 23,17, 
           LINE 13,38,
           LINES 1,92 ,
           SIZE 69,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 75,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-forzato-buf,
           VISIBLE v-blister,
           .

      * ENTRY FIELD
       10
           ef-add, 
           Entry-Field, 
           COL 144,84, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-add,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           READ-ONLY,
           VALUE ef-add-BUF,
           VISIBLE v-gdo,
           .

      * LABEL
       10
           lab-impostaa, 
           Label, 
           COL 131,84, 
           LINE 39,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 77,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Addiz. piombo",
           VISIBLE v-gdo,
           .

      * PUSH BUTTON
       10
           pb-forza, 
           Push-Button, 
           COL 5,17, 
           LINE 13,38,
           LINES 1,92 ,
           SIZE 16,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1006,
           FONT IS Small-Font,
           ID IS 78,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-TAB,
           TITLE "Forza &Volantino",
           VISIBLE v-forza,
           .

      * LABEL
       10
           lab-impostaaa, 
           Label, 
           COL 81,17, 
           LINE 36,69,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 79,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Evadi dal",
           VISIBLE v-manuale,
           .

      * PUSH BUTTON
       10
           pb-evadi-dal, 
           Push-Button, 
           COL 94,17, 
           LINE 13,38,
           LINES 1,92 ,
           SIZE 16,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1009,
           FONT IS Small-Font,
           ID IS 80,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-TAB,
           TITLE "Evadi dal",
           .

      * LABEL
       05
           Form1-La-18, 
           Label, 
           COL 39,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 81,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Causale di magazzino",
           .

      * DB_LABEL
       05
           lab-cau, 
           Label, 
           COL 66,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 60,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 82,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-cau-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * BAR
       05
           Form1-Br-3, 
           Bar,
           COL 1,17, 
           LINE 1,00,
           LINES 45,31 ,
           COLOR IS 14,
           ID IS 85,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * BAR
       05
           Form1-Br-3a, 
           Bar,
           COL 158,50, 
           LINE 1,00,
           LINES 45,31 ,
           COLOR IS 14,
           ID IS 86,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * BAR
       05
           Form1-Br-3b, 
           Bar,
           COL 1,17, 
           LINE 1,00,
           SIZE 157,83 ,
           COLOR IS 14,
           ID IS 87,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * BAR
       05
           Form1-Br-3ba, 
           Bar,
           COL 1,17, 
           LINE 46,23,
           SIZE 157,83 ,
           COLOR IS 14,
           ID IS 88,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 110,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 6,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 23,
           FRAMED,
           SQUARE,
           ENABLED E-NUOVO,
           FLAT,
           ID IS 111,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 16,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CANCELLA,
           FLAT,
           ID IS 112,
           SELF-ACT,
           TITLE "Cancella (F4)",
           BITMAP-NUMBER BitmapNumDelete
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 11,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 113,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 26,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 17,
           FRAMED,
           SQUARE,
           ENABLED E-ANTEPRIMA,
           EXCEPTION-VALUE 6,
           FLAT,
           ID IS 114,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 21,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 5,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 115,
           SELF-ACT,
           TITLE "Modifica (F5)",
           VALUE 1,
           BITMAP-NUMBER BitmapNumEdit
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 31,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 18,
           FRAMED,
           SQUARE,
           ENABLED E-STAMPA,
           EXCEPTION-VALUE 7,
           FLAT,
           ID IS 116,
           SELF-ACT,
           TITLE "Stampa (F7)",
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 36,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 117,
           SELF-ACT,
           TITLE "Cerca (F8)",
           BITMAP-NUMBER BitmapNumZoom
           .

      * PUSH BUTTON
       05
           TOOL-SELEZIONA, 
           Push-Button, 
           COL 41,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-SELEZIONA,
           FLAT,
           ID IS 118,
           SELF-ACT,
           TITLE "Seleziona (F9)",
           BITMAP-NUMBER BitmapNumSelect
           .

      * FORM
       01 
           scr-conf, 
           AFTER PROCEDURE  scr-conf-AFTER-SCREEN
           BEFORE PROCEDURE  scr-conf-BEFORE-SCREEN
           .

      * PUSH BUTTON
       05
           pb-attesa, 
           Push-Button, 
           COL 2,40, 
           LINE 5,56,
           LINES 1,89 ,
           SIZE 19,50 ,
           EXCEPTION-VALUE 27,
           ID IS 4,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Resta in attesa",
           .

      * PUSH BUTTON
       05
           pb-si, 
           Push-Button, 
           COL 23,70, 
           LINE 5,56,
           LINES 1,89 ,
           SIZE 19,50 ,
           EXCEPTION-VALUE 1000,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Si, confermo",
           .

      * PUSH BUTTON
       05
           pb-no, 
           Push-Button, 
           COL 44,90, 
           LINE 5,56,
           LINES 1,89 ,
           SIZE 19,50 ,
           EXCEPTION-VALUE 1001,
           ID IS 5,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "No, annullo l'ordine",
           .

      * LABEL
       05
           scr-conf-La-1, 
           Label, 
           COL 12,90, 
           LINE 1,67,
           LINES 1,11 ,
           SIZE 41,10 ,
           COLOR IS 5,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "** ATTENZIONE **",
           .

      * LABEL
       05
           scr-conf-La-1a, 
           Label, 
           COL 11,40, 
           LINE 3,39,
           LINES 1,39 ,
           SIZE 44,10 ,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Confermi i prezzi e la registrazione dell'ordine?",
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, USER-CODI, LIVELLO-ABIL.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:ordine, INIT:ordine, BeforeDeclarative>
       PROGMAG-ERR SECTION.
           use after error procedure on progmag.
           set RecLocked to false.
           evaluate status-progmag
           when "35"
                display message "File [PROGMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [PROGMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[PROGMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "93"
           when "99" set RecLocked to true
           end-evaluate.
 
      ***---
       mtordini-ERR SECTION.
           use after error procedure on mtordini.
           set tutto-ok  to true.
           evaluate status-mtordini
           when "35"
                display message "File [mtordini] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [mtordini] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[mtordini] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       AGENTI-ERR SECTION.
           use after error procedure on agenti.
           set tutto-ok  to true.
           evaluate status-agenti
           when "35"
                display message "File [AGENTI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [AGENTI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[AGENTI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TVETTORI-ERR SECTION.
           use after error procedure on tvettori.
           set tutto-ok  to true.
           evaluate status-tvettori
           when "35"
                display message "File [TVETTORI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TVETTORI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TVETTORI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIVAESE-ERR SECTION.
           use after error procedure on tivaese.
           set tutto-ok  to true.
           evaluate status-tivaese
           when "35"
                display message "File [TIVAESE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIVAESE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIVAESE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       CLIENTI-ERR SECTION.
           use after error procedure on clienti.
           set tutto-ok  to true.
           evaluate status-clienti
           when "35"
                display message "File [CLIENTI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [CLIENTI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[CLIENTI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       DESTINI-ERR SECTION.
           use after error procedure on destini.
           set tutto-ok  to true.
           evaluate status-destini
           when "35"
                display message "File [DESTINI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [DESTINI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[DESTINI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       ARTICOLI-ERR SECTION.
           use after error procedure on articoli.
           set tutto-ok  to true.
           evaluate status-articoli
           when "35"
                display message "File [ARTICOLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [ARTICOLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[ARTICOLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       NOTE-ERR SECTION.
           use after error procedure on note.
           set tutto-ok  to true.
           evaluate status-note
           when "35"
                display message "File [NOTE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [NOTE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[NOTE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TCODPAG-ERR SECTION.
           use after error procedure on tcodpag.
           set tutto-ok  to true.
           evaluate status-tcodpag
           when "35"
                display message "File [TCODPAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCODPAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCODPAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.     
 
      ***---
       TIMPOSTE-ERR SECTION.
           use after error procedure on timposte.
           set tutto-ok  to true.
           evaluate status-timposte
           when "35"
                display message "File [TIMPOSTE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMPOSTE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMPOSTE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMARCHE-ERR SECTION.
           use after error procedure on tmarche.
           set tutto-ok  to true.
           evaluate status-tmarche
           when "35"
                display message "File [TMARCHE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMARCHE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMARCHE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMP-ASSORCLI-ERR SECTION.
           use after error procedure on tmp-assorcli.
           set tutto-ok  to true.
           evaluate status-tmp-assorcli
           when "35"
                display message "File [TMP-ASSORCLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMP-ASSORCLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMP-ASSORCLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TPARAMGE-ERR SECTION.
           use after error procedure on tparamge.
           set tutto-ok  to true.
           evaluate status-tparamge
           when "35"
                display message "File [TPARAMGE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TPARAMGE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TPARAMGE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMAGAZ-ERR SECTION.
           use after error procedure on tmagaz.
           set tutto-ok  to true.
           evaluate status-tmagaz
           when "35"
                display message "File [TMAGAZ] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMAGAZ] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMAGAZ] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TCAUMAG-ERR SECTION.
           use after error procedure on tcaumag.
           set tutto-ok  to true.
           evaluate status-tcaumag
           when "35"
                display message "File [TCAUMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCAUMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCAUMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALQTA-ERR SECTION.
           use after error procedure on timbalqta.
           set tutto-ok  to true.
           evaluate status-timbalqta
           when "35"
                display message "File [TIMBALQTA] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALQTA] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALQTA] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALLI-ERR SECTION.
           use after error procedure on timballi.
           set tutto-ok  to true.
           evaluate status-timballi
           when "35"
                display message "File [TIMBALLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       RECAPITI-ERR SECTION.
           use after error procedure on recapiti.
           set tutto-ok  to true.
           evaluate status-recapiti
           when "35"
                display message "File [RECAPITI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [RECAPITI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[RECAPITI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       RMOVMAG-ERR SECTION.
           use after error procedure on rmovmag.
           set tutto-ok  to true.
           evaluate status-rmovmag
           when "35"
                display message "File [RMOVMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [RMOVMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[RMOVMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TTIPOCLI-ERR SECTION.
           use after error procedure on ttipocli.
           set tutto-ok  to true.
           evaluate status-ttipocli
           when "35"
                display message "File [TTIPOCLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TTIPOCLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TTIPOCLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       MRORDINI-ERR SECTION.
           use after error procedure on mrordini.
           set tutto-ok  to true.
           evaluate status-mrordini      
           when "35"
                display message "File [mrordini] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [mrordini] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[mrordini] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMP-PROGMAG-ZOOM-ERR SECTION.
           use after error procedure on tmp-progmag-zoom.
           set tutto-ok  to true.
           evaluate status-tmp-progmag-zoom
           when "35"
                display message "File [TMP-PROGMAG-ZOOM] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMP-PROGMAG-ZOOM] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMP-PROGMAG-ZOOM] Indexed file corrupt
      -    "!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM ordine-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:ordine, INIT:ordine, BeforeDestroyResource>
      * <TOTEM:END>
           DESTROY Verdana12-Occidentale
           CALL "w$bitmap" USING WBITMAP-DESTROY, 
           STRIP_GRID_GCLIENTI-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, TOOLBAR-BMP
      *    After-Program
           PERFORM ordine-Ev-After-Program
           set environment "KEYSTROKE" to "DATA=46   46".
           set environment "KEYSTROKE" to "DATA=44   44".
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
      * Verdana12-Occidentale
           INITIALIZE WFONT-DATA Verdana12-Occidentale
           MOVE 12 TO WFONT-SIZE
           MOVE "Verdana" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO FALSE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Verdana12-Occidentale, WFONT-DATA
           .

       INIT-BMP.
      * pb-grid-nuovo
           COPY RESOURCE "STRIP_GRID_GCLIENTI.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "STRIP_GRID_GCLIENTI.BMP"
           , 
                   GIVING STRIP_GRID_GCLIENTI-BMP.
      * TOOL-ESCI
           COPY RESOURCE "TOOLBAR.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "TOOLBAR.BMP", 
                   GIVING TOOLBAR-BMP.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
           PERFORM ordine-Ev-Before-DSD-Open
           PERFORM OPEN-mtordini
           PERFORM OPEN-agenti
           PERFORM OPEN-tvettori
           PERFORM OPEN-tivaese
           PERFORM OPEN-clienti
           PERFORM OPEN-destini
           PERFORM OPEN-articoli
           PERFORM OPEN-note
           PERFORM OPEN-tcodpag
           PERFORM OPEN-progmag
           PERFORM OPEN-timposte
           PERFORM OPEN-tmarche
      *    tmp-assorcli OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-assorcli
           PERFORM OPEN-tparamge
           PERFORM OPEN-tmagaz
           PERFORM OPEN-tcaumag
           PERFORM OPEN-timbalqta
           PERFORM OPEN-timballi
           PERFORM OPEN-recapiti
           PERFORM OPEN-rmovmag
           PERFORM OPEN-ttipocli
           PERFORM OPEN-mrordini
      *    tmp-progmag-zoom OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-progmag-zoom
      *    zoom-tcaumag OPEN MODE IS FALSE
      *    PERFORM OPEN-zoom-tcaumag
           PERFORM OPEN-tpiombo
           PERFORM OPEN-lisagente
      *    lineseq OPEN MODE IS FALSE
      *    PERFORM OPEN-lineseq
           PERFORM OPEN-blister
      *    tordini OPEN MODE IS FALSE
      *    PERFORM OPEN-tordini
      *    rordini OPEN MODE IS FALSE
      *    PERFORM OPEN-rordini
      *    zoom-tor-master OPEN MODE IS FALSE
      *    PERFORM OPEN-zoom-tor-master
           PERFORM OPEN-locali
           PERFORM OPEN-rpromo
           PERFORM OPEN-tpromo
      *    tmp-promo-prz OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-promo-prz
           PERFORM OPEN-listini
           PERFORM OPEN-sitfin
           PERFORM OPEN-tscorte
           PERFORM OPEN-param
           PERFORM OPEN-cli-prg
           PERFORM OPEN-pagbloc
           PERFORM OPEN-tordforn
           PERFORM OPEN-rordforn
      *    tcontat OPEN MODE IS FALSE
      *    PERFORM OPEN-tcontat
           PERFORM OPEN-tnazioni
           PERFORM OPEN-grade
      *    After Open
           .

       OPEN-mtordini.
      * <TOTEM:EPT. INIT:ordine, FD:mtordini, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O mtordini
           IF STATUS-mtordini = "35"
              OPEN OUTPUT mtordini
                IF Valid-STATUS-mtordini
                   CLOSE mtordini
                   OPEN I-O mtordini
                END-IF
           END-IF
           IF NOT Valid-STATUS-mtordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:mtordini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-agenti.
      * <TOTEM:EPT. INIT:ordine, FD:agenti, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT agenti
           IF NOT Valid-STATUS-agenti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:agenti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tvettori.
      * <TOTEM:EPT. INIT:ordine, FD:tvettori, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tvettori
           IF NOT Valid-STATUS-tvettori
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tvettori, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tivaese.
      * <TOTEM:EPT. INIT:ordine, FD:tivaese, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tivaese
           IF NOT Valid-STATUS-tivaese
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tivaese, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-clienti.
      * <TOTEM:EPT. INIT:ordine, FD:clienti, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT clienti
           IF NOT Valid-STATUS-clienti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:clienti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-destini.
      * <TOTEM:EPT. INIT:ordine, FD:destini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT destini
           IF NOT Valid-STATUS-destini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:destini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-articoli.
      * <TOTEM:EPT. INIT:ordine, FD:articoli, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT articoli
           IF NOT Valid-STATUS-articoli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:articoli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-note.
      * <TOTEM:EPT. INIT:ordine, FD:note, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT note
           IF NOT Valid-STATUS-note
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:note, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcodpag.
      * <TOTEM:EPT. INIT:ordine, FD:tcodpag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcodpag
           IF NOT Valid-STATUS-tcodpag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tcodpag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-progmag.
      * <TOTEM:EPT. INIT:ordine, FD:progmag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT progmag
           IF NOT Valid-STATUS-progmag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:progmag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timposte.
      * <TOTEM:EPT. INIT:ordine, FD:timposte, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timposte
           IF NOT Valid-STATUS-timposte
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:timposte, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmarche.
      * <TOTEM:EPT. INIT:ordine, FD:tmarche, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmarche
           IF NOT Valid-STATUS-tmarche
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tmarche, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-assorcli.
      * <TOTEM:EPT. INIT:ordine, FD:tmp-assorcli, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O tmp-assorcli
           IF STATUS-tmp-assorcli = "35"
              OPEN OUTPUT tmp-assorcli
                IF Valid-STATUS-tmp-assorcli
                   CLOSE tmp-assorcli
                   OPEN I-O tmp-assorcli
                END-IF
           END-IF
           IF NOT Valid-STATUS-tmp-assorcli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tmp-assorcli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tparamge.
      * <TOTEM:EPT. INIT:ordine, FD:tparamge, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tparamge
           IF NOT Valid-STATUS-tparamge
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tparamge, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmagaz.
      * <TOTEM:EPT. INIT:ordine, FD:tmagaz, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmagaz
           IF NOT Valid-STATUS-tmagaz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tmagaz, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcaumag.
      * <TOTEM:EPT. INIT:ordine, FD:tcaumag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcaumag
           IF NOT Valid-STATUS-tcaumag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tcaumag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timbalqta.
      * <TOTEM:EPT. INIT:ordine, FD:timbalqta, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timbalqta
           IF NOT Valid-STATUS-timbalqta
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:timbalqta, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timballi.
      * <TOTEM:EPT. INIT:ordine, FD:timballi, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timballi
           IF NOT Valid-STATUS-timballi
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:timballi, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-recapiti.
      * <TOTEM:EPT. INIT:ordine, FD:recapiti, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT recapiti
           IF NOT Valid-STATUS-recapiti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:recapiti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rmovmag.
      * <TOTEM:EPT. INIT:ordine, FD:rmovmag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rmovmag
           IF NOT Valid-STATUS-rmovmag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:rmovmag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-ttipocli.
      * <TOTEM:EPT. INIT:ordine, FD:ttipocli, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT ttipocli
           IF NOT Valid-STATUS-ttipocli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:ttipocli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-mrordini.
      * <TOTEM:EPT. INIT:ordine, FD:mrordini, BeforeOpen>
           if status-mrordini = "9E"
              exit paragraph
           end-if

           .
      * <TOTEM:END>
           OPEN  I-O mrordini
           IF STATUS-mrordini = "35"
              OPEN OUTPUT mrordini
                IF Valid-STATUS-mrordini
                   CLOSE mrordini
                   OPEN I-O mrordini
                END-IF
           END-IF
           IF NOT Valid-STATUS-mrordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:mrordini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-progmag-zoom.
      * <TOTEM:EPT. INIT:ordine, FD:tmp-progmag-zoom, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-progmag-zoom
           IF NOT Valid-STATUS-tmp-progmag-zoom
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tmp-progmag-zoom, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-zoom-tcaumag.
      * <TOTEM:EPT. INIT:ordine, FD:zoom-tcaumag, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT zoom-tcaumag
           IF NOT Valid-STATUS-zoom-tcaumag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:zoom-tcaumag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tpiombo.
      * <TOTEM:EPT. INIT:ordine, FD:tpiombo, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tpiombo
           IF NOT Valid-STATUS-tpiombo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tpiombo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-lisagente.
      * <TOTEM:EPT. INIT:ordine, FD:lisagente, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT lisagente
           IF NOT Valid-STATUS-lisagente
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:lisagente, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-lineseq.
      * <TOTEM:EPT. INIT:ordine, FD:lineseq, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT lineseq
           IF NOT Valid-STATUS-lineseq
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:lineseq, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-blister.
      * <TOTEM:EPT. INIT:ordine, FD:blister, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT blister
           IF NOT Valid-STATUS-blister
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:blister, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tordini.
      * <TOTEM:EPT. INIT:ordine, FD:tordini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tordini
           IF NOT Valid-STATUS-tordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tordini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rordini.
      * <TOTEM:EPT. INIT:ordine, FD:rordini, BeforeOpen>
           if status-rordini = "9E"
              exit paragraph
           end-if

           .
      * <TOTEM:END>
           OPEN  INPUT rordini
           IF NOT Valid-STATUS-rordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:rordini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-zoom-tor-master.
      * <TOTEM:EPT. INIT:ordine, FD:zoom-tor-master, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT zoom-tor-master
           IF NOT Valid-STATUS-zoom-tor-master
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:zoom-tor-master, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-locali.
      * <TOTEM:EPT. INIT:ordine, FD:locali, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT locali
           IF NOT Valid-STATUS-locali
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:locali, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rpromo.
      * <TOTEM:EPT. INIT:ordine, FD:rpromo, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O rpromo
           IF STATUS-rpromo = "35"
              OPEN OUTPUT rpromo
                IF Valid-STATUS-rpromo
                   CLOSE rpromo
                   OPEN I-O rpromo
                END-IF
           END-IF
           IF NOT Valid-STATUS-rpromo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:rpromo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tpromo.
      * <TOTEM:EPT. INIT:ordine, FD:tpromo, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O tpromo
           IF STATUS-tpromo = "35"
              OPEN OUTPUT tpromo
                IF Valid-STATUS-tpromo
                   CLOSE tpromo
                   OPEN I-O tpromo
                END-IF
           END-IF
           IF NOT Valid-STATUS-tpromo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tpromo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-promo-prz.
      * <TOTEM:EPT. INIT:ordine, FD:tmp-promo-prz, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-promo-prz
           IF NOT Valid-STATUS-tmp-promo-prz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tmp-promo-prz, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-listini.
      * <TOTEM:EPT. INIT:ordine, FD:listini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT listini
           IF NOT Valid-STATUS-listini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:listini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-sitfin.
      * <TOTEM:EPT. INIT:ordine, FD:sitfin, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT sitfin
           IF NOT Valid-STATUS-sitfin
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:sitfin, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tscorte.
      * <TOTEM:EPT. INIT:ordine, FD:tscorte, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tscorte
           IF NOT Valid-STATUS-tscorte
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tscorte, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-param.
      * <TOTEM:EPT. INIT:ordine, FD:param, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT param
           IF NOT Valid-STATUS-param
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:param, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-cli-prg.
      * <TOTEM:EPT. INIT:ordine, FD:cli-prg, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT cli-prg
           IF NOT Valid-STATUS-cli-prg
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:cli-prg, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-pagbloc.
      * <TOTEM:EPT. INIT:ordine, FD:pagbloc, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT pagbloc
           IF NOT Valid-STATUS-pagbloc
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:pagbloc, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tordforn.
      * <TOTEM:EPT. INIT:ordine, FD:tordforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tordforn
           IF NOT Valid-STATUS-tordforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tordforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rordforn.
      * <TOTEM:EPT. INIT:ordine, FD:rordforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rordforn
           IF NOT Valid-STATUS-rordforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:rordforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcontat.
      * <TOTEM:EPT. INIT:ordine, FD:tcontat, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcontat
           IF NOT Valid-STATUS-tcontat
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tcontat, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tnazioni.
      * <TOTEM:EPT. INIT:ordine, FD:tnazioni, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tnazioni
           IF NOT Valid-STATUS-tnazioni
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:tnazioni, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-grade.
      * <TOTEM:EPT. INIT:ordine, FD:grade, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT grade
           IF NOT Valid-STATUS-grade
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:ordine, FD:grade, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-mtordini
           PERFORM CLOSE-agenti
           PERFORM CLOSE-tvettori
           PERFORM CLOSE-tivaese
           PERFORM CLOSE-clienti
           PERFORM CLOSE-destini
           PERFORM CLOSE-articoli
           PERFORM CLOSE-note
           PERFORM CLOSE-tcodpag
           PERFORM CLOSE-progmag
           PERFORM CLOSE-timposte
           PERFORM CLOSE-tmarche
      *    tmp-assorcli CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-assorcli
           PERFORM CLOSE-tparamge
           PERFORM CLOSE-tmagaz
           PERFORM CLOSE-tcaumag
           PERFORM CLOSE-timbalqta
           PERFORM CLOSE-timballi
           PERFORM CLOSE-recapiti
           PERFORM CLOSE-rmovmag
           PERFORM CLOSE-ttipocli
           PERFORM CLOSE-mrordini
      *    tmp-progmag-zoom CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-progmag-zoom
      *    zoom-tcaumag CLOSE MODE IS FALSE
      *    PERFORM CLOSE-zoom-tcaumag
           PERFORM CLOSE-tpiombo
           PERFORM CLOSE-lisagente
      *    lineseq CLOSE MODE IS FALSE
      *    PERFORM CLOSE-lineseq
           PERFORM CLOSE-blister
      *    tordini CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tordini
      *    rordini CLOSE MODE IS FALSE
      *    PERFORM CLOSE-rordini
      *    zoom-tor-master CLOSE MODE IS FALSE
      *    PERFORM CLOSE-zoom-tor-master
           PERFORM CLOSE-locali
           PERFORM CLOSE-rpromo
           PERFORM CLOSE-tpromo
      *    tmp-promo-prz CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-promo-prz
           PERFORM CLOSE-listini
           PERFORM CLOSE-sitfin
           PERFORM CLOSE-tscorte
           PERFORM CLOSE-param
           PERFORM CLOSE-cli-prg
           PERFORM CLOSE-pagbloc
           PERFORM CLOSE-tordforn
           PERFORM CLOSE-rordforn
      *    tcontat CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tcontat
           PERFORM CLOSE-tnazioni
           PERFORM CLOSE-grade
      *    After Close
           .

       CLOSE-mtordini.
      * <TOTEM:EPT. INIT:ordine, FD:mtordini, BeforeClose>
      * <TOTEM:END>
           CLOSE mtordini
           .

       CLOSE-agenti.
      * <TOTEM:EPT. INIT:ordine, FD:agenti, BeforeClose>
      * <TOTEM:END>
           CLOSE agenti
           .

       CLOSE-tvettori.
      * <TOTEM:EPT. INIT:ordine, FD:tvettori, BeforeClose>
      * <TOTEM:END>
           CLOSE tvettori
           .

       CLOSE-tivaese.
      * <TOTEM:EPT. INIT:ordine, FD:tivaese, BeforeClose>
      * <TOTEM:END>
           CLOSE tivaese
           .

       CLOSE-clienti.
      * <TOTEM:EPT. INIT:ordine, FD:clienti, BeforeClose>
      * <TOTEM:END>
           CLOSE clienti
           .

       CLOSE-destini.
      * <TOTEM:EPT. INIT:ordine, FD:destini, BeforeClose>
      * <TOTEM:END>
           CLOSE destini
           .

       CLOSE-articoli.
      * <TOTEM:EPT. INIT:ordine, FD:articoli, BeforeClose>
      * <TOTEM:END>
           CLOSE articoli
           .

       CLOSE-note.
      * <TOTEM:EPT. INIT:ordine, FD:note, BeforeClose>
      * <TOTEM:END>
           CLOSE note
           .

       CLOSE-tcodpag.
      * <TOTEM:EPT. INIT:ordine, FD:tcodpag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcodpag
           .

       CLOSE-progmag.
      * <TOTEM:EPT. INIT:ordine, FD:progmag, BeforeClose>
      * <TOTEM:END>
           CLOSE progmag
           .

       CLOSE-timposte.
      * <TOTEM:EPT. INIT:ordine, FD:timposte, BeforeClose>
      * <TOTEM:END>
           CLOSE timposte
           .

       CLOSE-tmarche.
      * <TOTEM:EPT. INIT:ordine, FD:tmarche, BeforeClose>
      * <TOTEM:END>
           CLOSE tmarche
           .

       CLOSE-tmp-assorcli.
      * <TOTEM:EPT. INIT:ordine, FD:tmp-assorcli, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-tparamge.
      * <TOTEM:EPT. INIT:ordine, FD:tparamge, BeforeClose>
      * <TOTEM:END>
           CLOSE tparamge
           .

       CLOSE-tmagaz.
      * <TOTEM:EPT. INIT:ordine, FD:tmagaz, BeforeClose>
      * <TOTEM:END>
           CLOSE tmagaz
           .

       CLOSE-tcaumag.
      * <TOTEM:EPT. INIT:ordine, FD:tcaumag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcaumag
           .

       CLOSE-timbalqta.
      * <TOTEM:EPT. INIT:ordine, FD:timbalqta, BeforeClose>
      * <TOTEM:END>
           CLOSE timbalqta
           .

       CLOSE-timballi.
      * <TOTEM:EPT. INIT:ordine, FD:timballi, BeforeClose>
      * <TOTEM:END>
           CLOSE timballi
           .

       CLOSE-recapiti.
      * <TOTEM:EPT. INIT:ordine, FD:recapiti, BeforeClose>
      * <TOTEM:END>
           CLOSE recapiti
           .

       CLOSE-rmovmag.
      * <TOTEM:EPT. INIT:ordine, FD:rmovmag, BeforeClose>
      * <TOTEM:END>
           CLOSE rmovmag
           .

       CLOSE-ttipocli.
      * <TOTEM:EPT. INIT:ordine, FD:ttipocli, BeforeClose>
      * <TOTEM:END>
           CLOSE ttipocli
           .

       CLOSE-mrordini.
      * <TOTEM:EPT. INIT:ordine, FD:mrordini, BeforeClose>
           if status-mrordini = "9E"
              exit paragraph
           end-if

           .
      * <TOTEM:END>
           CLOSE mrordini
           .

       CLOSE-tmp-progmag-zoom.
      * <TOTEM:EPT. INIT:ordine, FD:tmp-progmag-zoom, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-zoom-tcaumag.
      * <TOTEM:EPT. INIT:ordine, FD:zoom-tcaumag, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-tpiombo.
      * <TOTEM:EPT. INIT:ordine, FD:tpiombo, BeforeClose>
      * <TOTEM:END>
           CLOSE tpiombo
           .

       CLOSE-lisagente.
      * <TOTEM:EPT. INIT:ordine, FD:lisagente, BeforeClose>
      * <TOTEM:END>
           CLOSE lisagente
           .

       CLOSE-lineseq.
      * <TOTEM:EPT. INIT:ordine, FD:lineseq, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-blister.
      * <TOTEM:EPT. INIT:ordine, FD:blister, BeforeClose>
      * <TOTEM:END>
           CLOSE blister
           .

       CLOSE-tordini.
      * <TOTEM:EPT. INIT:ordine, FD:tordini, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-rordini.
      * <TOTEM:EPT. INIT:ordine, FD:rordini, BeforeClose>
           if status-rordini = "9E"
              exit paragraph
           end-if

           .
      * <TOTEM:END>
           .

       CLOSE-zoom-tor-master.
      * <TOTEM:EPT. INIT:ordine, FD:zoom-tor-master, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-locali.
      * <TOTEM:EPT. INIT:ordine, FD:locali, BeforeClose>
      * <TOTEM:END>
           CLOSE locali
           .

       CLOSE-rpromo.
      * <TOTEM:EPT. INIT:ordine, FD:rpromo, BeforeClose>
      * <TOTEM:END>
           CLOSE rpromo
           .

       CLOSE-tpromo.
      * <TOTEM:EPT. INIT:ordine, FD:tpromo, BeforeClose>
      * <TOTEM:END>
           CLOSE tpromo
           .

       CLOSE-tmp-promo-prz.
      * <TOTEM:EPT. INIT:ordine, FD:tmp-promo-prz, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-listini.
      * <TOTEM:EPT. INIT:ordine, FD:listini, BeforeClose>
      * <TOTEM:END>
           CLOSE listini
           .

       CLOSE-sitfin.
      * <TOTEM:EPT. INIT:ordine, FD:sitfin, BeforeClose>
      * <TOTEM:END>
           CLOSE sitfin
           .

       CLOSE-tscorte.
      * <TOTEM:EPT. INIT:ordine, FD:tscorte, BeforeClose>
      * <TOTEM:END>
           CLOSE tscorte
           .

       CLOSE-param.
      * <TOTEM:EPT. INIT:ordine, FD:param, BeforeClose>
      * <TOTEM:END>
           CLOSE param
           .

       CLOSE-cli-prg.
      * <TOTEM:EPT. INIT:ordine, FD:cli-prg, BeforeClose>
      * <TOTEM:END>
           CLOSE cli-prg
           .

       CLOSE-pagbloc.
      * <TOTEM:EPT. INIT:ordine, FD:pagbloc, BeforeClose>
      * <TOTEM:END>
           CLOSE pagbloc
           .

       CLOSE-tordforn.
      * <TOTEM:EPT. INIT:ordine, FD:tordforn, BeforeClose>
      * <TOTEM:END>
           CLOSE tordforn
           .

       CLOSE-rordforn.
      * <TOTEM:EPT. INIT:ordine, FD:rordforn, BeforeClose>
      * <TOTEM:END>
           CLOSE rordforn
           .

       CLOSE-tcontat.
      * <TOTEM:EPT. INIT:ordine, FD:tcontat, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-tnazioni.
      * <TOTEM:EPT. INIT:ordine, FD:tnazioni, BeforeClose>
      * <TOTEM:END>
           CLOSE tnazioni
           .

       CLOSE-grade.
      * <TOTEM:EPT. INIT:ordine, FD:grade, BeforeClose>
      * <TOTEM:END>
           CLOSE grade
           .

       mtordini-mto-k-ord-cli-MERGE-SPLITBUF.
           INITIALIZE mtordini-mto-k-ord-cli-SPLITBUF
           MOVE mto-anno(1:4) TO mtordini-mto-k-ord-cli-SPLITBUF(1:4)
           MOVE mto-num-ord-cli(1:50) TO 
           mtordini-mto-k-ord-cli-SPLITBUF(5:50)
           .

       mtordini-mto-k-data-MERGE-SPLITBUF.
           INITIALIZE mtordini-mto-k-data-SPLITBUF
           MOVE mto-data-ordine(1:8) TO 
           mtordini-mto-k-data-SPLITBUF(1:8)
           MOVE mto-chiave(1:12) TO mtordini-mto-k-data-SPLITBUF(9:12)
           .

       mtordini-mto-k-clides-MERGE-SPLITBUF.
           INITIALIZE mtordini-mto-k-clides-SPLITBUF
           MOVE mto-cod-cli(1:5) TO mtordini-mto-k-clides-SPLITBUF(1:5)
           MOVE mto-prg-destino(1:5) TO 
           mtordini-mto-k-clides-SPLITBUF(6:5)
           MOVE mto-data-ordine(1:8) TO 
           mtordini-mto-k-clides-SPLITBUF(11:8)
           .

       mtordini-mto-k-age-MERGE-SPLITBUF.
           INITIALIZE mtordini-mto-k-age-SPLITBUF
           MOVE mto-cod-agente(1:5) TO mtordini-mto-k-age-SPLITBUF(1:5)
           MOVE mto-data-ordine(1:8) TO mtordini-mto-k-age-SPLITBUF(6:8)
           .

       mtordini-k-mto-stato-sel-MERGE-SPLITBUF.
           INITIALIZE mtordini-k-mto-stato-sel-SPLITBUF
           MOVE mto-stato-ordine(1:1) TO 
           mtordini-k-mto-stato-sel-SPLITBUF(1:1)
           MOVE mto-cod-cli(1:5) TO 
           mtordini-k-mto-stato-sel-SPLITBUF(2:5)
           MOVE mto-data-ordine(1:8) TO 
           mtordini-k-mto-stato-sel-SPLITBUF(7:8)
           .

       mtordini-k-mto-stato-MERGE-SPLITBUF.
           INITIALIZE mtordini-k-mto-stato-SPLITBUF
           MOVE mto-stato-ordine(1:1) TO 
           mtordini-k-mto-stato-SPLITBUF(1:1)
           MOVE mto-chiave(1:12) TO mtordini-k-mto-stato-SPLITBUF(2:12)
           .

       mtordini-mto-k-gdo-MERGE-SPLITBUF.
           INITIALIZE mtordini-mto-k-gdo-SPLITBUF
           MOVE mto-gdo(1:5) TO mtordini-mto-k-gdo-SPLITBUF(1:5)
           MOVE mto-data-ordine(1:8) TO mtordini-mto-k-gdo-SPLITBUF(6:8)
           MOVE mto-chiave(1:12) TO mtordini-mto-k-gdo-SPLITBUF(14:12)
           .

       mtordini-mto-k-bloc-MERGE-SPLITBUF.
           INITIALIZE mtordini-mto-k-bloc-SPLITBUF
           MOVE mto-stato-attivazione(1:1) TO 
           mtordini-mto-k-bloc-SPLITBUF(1:1)
           MOVE mto-data-ordine(1:8) TO 
           mtordini-mto-k-bloc-SPLITBUF(2:8)
           MOVE mto-cod-cli(1:5) TO mtordini-mto-k-bloc-SPLITBUF(10:5)
           MOVE mto-prg-destino(1:5) TO 
           mtordini-mto-k-bloc-SPLITBUF(15:5)
           .

       mtordini-k-giang-MERGE-SPLITBUF.
           INITIALIZE mtordini-k-giang-SPLITBUF
           MOVE mto-data-note1(1:8) TO mtordini-k-giang-SPLITBUF(1:8)
           MOVE mto-chiave(1:12) TO mtordini-k-giang-SPLITBUF(9:12)
           .

       mtordini-mto-k-promo-MERGE-SPLITBUF.
           INITIALIZE mtordini-mto-k-promo-SPLITBUF
           MOVE mto-promo(1:1) TO mtordini-mto-k-promo-SPLITBUF(1:1)
           MOVE mto-tipo-CF(1:1) TO mtordini-mto-k-promo-SPLITBUF(2:1)
           MOVE mto-cod-cli(1:5) TO mtordini-mto-k-promo-SPLITBUF(3:5)
           MOVE mto-prg-destino(1:5) TO 
           mtordini-mto-k-promo-SPLITBUF(8:5)
           MOVE mto-chiave(1:12) TO mtordini-mto-k-promo-SPLITBUF(13:12)
           .

       DataSet1-mtordini-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-mtordini-KEY1-Asc
                 MOVE Low-Value TO mto-chiave
              ELSE
                 MOVE High-Value TO mto-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-mtordini-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-mtordini-KEY1-Asc
                 MOVE High-Value TO mto-chiave
              ELSE
                 MOVE Low-Value TO mto-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-mtordini-KEY1-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-mtordini-KEY1-ORDER
           END-EVALUATE
           .

      * mtordini
       DataSet1-mtordini-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-mtordini-KEY1-Asc
                 START mtordini KEY >= mto-chiave
              ELSE
                 START mtordini KEY <= mto-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-mtordini-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-mtordini-KEY1-Asc
                 START mtordini KEY <= mto-chiave
              ELSE
                 START mtordini KEY >= mto-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-mtordini-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-mtordini-KEY1-Asc
                 START mtordini KEY > mto-chiave
              ELSE
                 START mtordini KEY < mto-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-mtordini-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-mtordini-KEY1-Asc
                 START mtordini KEY < mto-chiave
              ELSE
                 START mtordini KEY > mto-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-mtordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-mtordini-LOCK
                 READ mtordini WITH LOCK 
                 KEY mto-chiave
              ELSE
                 READ mtordini WITH NO LOCK 
                 KEY mto-chiave
              END-IF
           END-EVALUATE
           PERFORM mtordini-mto-k-ord-cli-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-data-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-clides-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-age-MERGE-SPLITBUF
           PERFORM mtordini-k-mto-stato-sel-MERGE-SPLITBUF
           PERFORM mtordini-k-mto-stato-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-gdo-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-bloc-MERGE-SPLITBUF
           PERFORM mtordini-k-giang-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-promo-MERGE-SPLITBUF
           MOVE STATUS-mtordini TO TOTEM-ERR-STAT 
           MOVE "mtordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-mtordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-mtordini-KEY1-Asc
                 IF DataSet1-mtordini-LOCK
                    READ mtordini NEXT WITH LOCK
                 ELSE
                    READ mtordini NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-mtordini-LOCK
                    READ mtordini PREVIOUS WITH LOCK
                 ELSE
                    READ mtordini PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM mtordini-mto-k-ord-cli-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-data-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-clides-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-age-MERGE-SPLITBUF
           PERFORM mtordini-k-mto-stato-sel-MERGE-SPLITBUF
           PERFORM mtordini-k-mto-stato-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-gdo-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-bloc-MERGE-SPLITBUF
           PERFORM mtordini-k-giang-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-promo-MERGE-SPLITBUF
           MOVE STATUS-mtordini TO TOTEM-ERR-STAT
           MOVE "mtordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-mtordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-mtordini-KEY1-Asc
                 IF DataSet1-mtordini-LOCK
                    READ mtordini PREVIOUS WITH LOCK
                 ELSE
                    READ mtordini PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-mtordini-LOCK
                    READ mtordini NEXT WITH LOCK
                 ELSE
                    READ mtordini NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM mtordini-mto-k-ord-cli-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-data-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-clides-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-age-MERGE-SPLITBUF
           PERFORM mtordini-k-mto-stato-sel-MERGE-SPLITBUF
           PERFORM mtordini-k-mto-stato-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-gdo-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-bloc-MERGE-SPLITBUF
           PERFORM mtordini-k-giang-MERGE-SPLITBUF
           PERFORM mtordini-mto-k-promo-MERGE-SPLITBUF
           MOVE STATUS-mtordini TO TOTEM-ERR-STAT
           MOVE "mtordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-mtordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, BeforeWrite>
      * <TOTEM:END>
           WRITE mto-rec OF mtordini.
           MOVE STATUS-mtordini TO TOTEM-ERR-STAT
           MOVE "mtordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-mtordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, BeforeRewrite>
      * <TOTEM:END>
           REWRITE mto-rec OF mtordini.
           MOVE STATUS-mtordini TO TOTEM-ERR-STAT
           MOVE "mtordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-mtordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, BeforeDelete>
      * <TOTEM:END>
           DELETE mtordini.
           MOVE STATUS-mtordini TO TOTEM-ERR-STAT
           MOVE "mtordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mtordini, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-agenti-INITSTART.
           IF DataSet1-agenti-KEY-Asc
              MOVE Low-Value TO age-chiave
           ELSE
              MOVE High-Value TO age-chiave
           END-IF
           .

       DataSet1-agenti-INITEND.
           IF DataSet1-agenti-KEY-Asc
              MOVE High-Value TO age-chiave
           ELSE
              MOVE Low-Value TO age-chiave
           END-IF
           .

      * agenti
       DataSet1-agenti-START.
           IF DataSet1-agenti-KEY-Asc
              START agenti KEY >= age-chiave
           ELSE
              START agenti KEY <= age-chiave
           END-IF
           .

       DataSet1-agenti-START-NOTGREATER.
           IF DataSet1-agenti-KEY-Asc
              START agenti KEY <= age-chiave
           ELSE
              START agenti KEY >= age-chiave
           END-IF
           .

       DataSet1-agenti-START-GREATER.
           IF DataSet1-agenti-KEY-Asc
              START agenti KEY > age-chiave
           ELSE
              START agenti KEY < age-chiave
           END-IF
           .

       DataSet1-agenti-START-LESS.
           IF DataSet1-agenti-KEY-Asc
              START agenti KEY < age-chiave
           ELSE
              START agenti KEY > age-chiave
           END-IF
           .

       DataSet1-agenti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-agenti-LOCK
              READ agenti WITH LOCK 
              KEY age-chiave
           ELSE
              READ agenti WITH NO LOCK 
              KEY age-chiave
           END-IF
           MOVE STATUS-agenti TO TOTEM-ERR-STAT 
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-agenti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-agenti-KEY-Asc
              IF DataSet1-agenti-LOCK
                 READ agenti NEXT WITH LOCK
              ELSE
                 READ agenti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-agenti-LOCK
                 READ agenti PREVIOUS WITH LOCK
              ELSE
                 READ agenti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-agenti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-agenti-KEY-Asc
              IF DataSet1-agenti-LOCK
                 READ agenti PREVIOUS WITH LOCK
              ELSE
                 READ agenti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-agenti-LOCK
                 READ agenti NEXT WITH LOCK
              ELSE
                 READ agenti NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-agenti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-agenti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-agenti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-agenti TO TOTEM-ERR-STAT
           MOVE "agenti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:agenti, AfterDelete>
      * <TOTEM:END>
           .

       tvettori-k-des-MERGE-SPLITBUF.
           INITIALIZE tvettori-k-des-SPLITBUF
           MOVE vet-descrizione(1:40) TO tvettori-k-des-SPLITBUF(1:40)
           .

       DataSet1-tvettori-INITSTART.
           IF DataSet1-tvettori-KEY-Asc
              MOVE Low-Value TO vet-chiave
           ELSE
              MOVE High-Value TO vet-chiave
           END-IF
           .

       DataSet1-tvettori-INITEND.
           IF DataSet1-tvettori-KEY-Asc
              MOVE High-Value TO vet-chiave
           ELSE
              MOVE Low-Value TO vet-chiave
           END-IF
           .

      * tvettori
       DataSet1-tvettori-START.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY >= vet-chiave
           ELSE
              START tvettori KEY <= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-NOTGREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY <= vet-chiave
           ELSE
              START tvettori KEY >= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-GREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY > vet-chiave
           ELSE
              START tvettori KEY < vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-LESS.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY < vet-chiave
           ELSE
              START tvettori KEY > vet-chiave
           END-IF
           .

       DataSet1-tvettori-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tvettori-LOCK
              READ tvettori WITH LOCK 
              KEY vet-chiave
           ELSE
              READ tvettori WITH NO LOCK 
              KEY vet-chiave
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT 
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterDelete>
      * <TOTEM:END>
           .

       tivaese-key01-MERGE-SPLITBUF.
           INITIALIZE tivaese-key01-SPLITBUF
           MOVE TBLIV-CODICE1(1:2) TO tivaese-key01-SPLITBUF(1:2)
           MOVE TBLIV-DESCRIZIONE1(1:30) TO tivaese-key01-SPLITBUF(3:30)
           MOVE TBLIV-CODICE2(1:20) TO tivaese-key01-SPLITBUF(33:20)
           .

       DataSet1-tivaese-INITSTART.
           IF DataSet1-tivaese-KEY-Asc
              MOVE Low-Value TO TBLIV-CODICE
           ELSE
              MOVE High-Value TO TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-INITEND.
           IF DataSet1-tivaese-KEY-Asc
              MOVE High-Value TO TBLIV-CODICE
           ELSE
              MOVE Low-Value TO TBLIV-CODICE
           END-IF
           .

      * tivaese
       DataSet1-tivaese-START.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY >= TBLIV-CODICE
           ELSE
              START tivaese KEY <= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-NOTGREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY <= TBLIV-CODICE
           ELSE
              START tivaese KEY >= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-GREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY > TBLIV-CODICE
           ELSE
              START tivaese KEY < TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-LESS.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY < TBLIV-CODICE
           ELSE
              START tivaese KEY > TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tivaese-LOCK
              READ tivaese WITH LOCK 
              KEY TBLIV-CODICE
           ELSE
              READ tivaese WITH NO LOCK 
              KEY TBLIV-CODICE
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT 
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterDelete>
      * <TOTEM:END>
           .

       clienti-cli-K1-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K1-SPLITBUF
           MOVE cli-tipo-CF OF clienti(1:1) TO 
           clienti-cli-K1-SPLITBUF(1:1)
           MOVE cli-ragsoc-1 OF clienti(1:40) TO 
           clienti-cli-K1-SPLITBUF(2:40)
           MOVE cli-codice OF clienti(1:5) TO 
           clienti-cli-K1-SPLITBUF(42:5)
           .

       clienti-cli-K3-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K3-SPLITBUF
           MOVE cli-gdo OF clienti(1:5) TO clienti-cli-K3-SPLITBUF(1:5)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K3-SPLITBUF(6:6)
           .

       clienti-cli-K4-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K4-SPLITBUF
           MOVE cli-utf OF clienti(1:1) TO clienti-cli-K4-SPLITBUF(1:1)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K4-SPLITBUF(2:6)
           .

       DataSet1-clienti-INITSTART.
           IF DataSet1-clienti-KEY-Asc
              MOVE Low-Value TO cli-chiave OF clienti
           ELSE
              MOVE High-Value TO cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-INITEND.
           IF DataSet1-clienti-KEY-Asc
              MOVE High-Value TO cli-chiave OF clienti
           ELSE
              MOVE Low-Value TO cli-chiave OF clienti
           END-IF
           .

      * clienti
       DataSet1-clienti-START.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY >= cli-chiave OF clienti
           ELSE
              START clienti KEY <= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-NOTGREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY <= cli-chiave OF clienti
           ELSE
              START clienti KEY >= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-GREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY > cli-chiave OF clienti
           ELSE
              START clienti KEY < cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-LESS.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY < cli-chiave OF clienti
           ELSE
              START clienti KEY > cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-clienti-LOCK
              READ clienti WITH LOCK 
              KEY cli-chiave OF clienti
           ELSE
              READ clienti WITH NO LOCK 
              KEY cli-chiave OF clienti
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT 
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterDelete>
      * <TOTEM:END>
           .

       destini-K1-MERGE-SPLITBUF.
           INITIALIZE destini-K1-SPLITBUF
           MOVE des-ragsoc-1(1:40) TO destini-K1-SPLITBUF(1:40)
           MOVE des-codice(1:5) TO destini-K1-SPLITBUF(41:5)
           MOVE des-prog(1:5) TO destini-K1-SPLITBUF(46:5)
           .

       destini-k-localita-MERGE-SPLITBUF.
           INITIALIZE destini-k-localita-SPLITBUF
           MOVE des-localita(1:35) TO destini-k-localita-SPLITBUF(1:35)
           .

       DataSet1-destini-INITSTART.
           IF DataSet1-destini-KEY-Asc
              MOVE Low-Value TO des-chiave
           ELSE
              MOVE High-Value TO des-chiave
           END-IF
           .

       DataSet1-destini-INITEND.
           IF DataSet1-destini-KEY-Asc
              MOVE High-Value TO des-chiave
           ELSE
              MOVE Low-Value TO des-chiave
           END-IF
           .

      * destini
       DataSet1-destini-START.
           IF DataSet1-destini-KEY-Asc
              START destini KEY >= des-chiave
           ELSE
              START destini KEY <= des-chiave
           END-IF
           .

       DataSet1-destini-START-NOTGREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY <= des-chiave
           ELSE
              START destini KEY >= des-chiave
           END-IF
           .

       DataSet1-destini-START-GREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY > des-chiave
           ELSE
              START destini KEY < des-chiave
           END-IF
           .

       DataSet1-destini-START-LESS.
           IF DataSet1-destini-KEY-Asc
              START destini KEY < des-chiave
           ELSE
              START destini KEY > des-chiave
           END-IF
           .

       DataSet1-destini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-destini-LOCK
              READ destini WITH LOCK 
              KEY des-chiave
           ELSE
              READ destini WITH NO LOCK 
              KEY des-chiave
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT 
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterDelete>
      * <TOTEM:END>
           .

       articoli-art-k1-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k1-SPLITBUF
           MOVE art-descrizione OF articoli(1:50) TO 
           articoli-art-k1-SPLITBUF(1:50)
           .

       articoli-art-k-frn-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k-frn-SPLITBUF
           MOVE art-cod-art-frn OF articoli(1:15) TO 
           articoli-art-k-frn-SPLITBUF(1:15)
           .

       DataSet1-articoli-INITSTART.
           IF DataSet1-articoli-KEY-Asc
              MOVE Low-Value TO art-chiave OF articoli
           ELSE
              MOVE High-Value TO art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-INITEND.
           IF DataSet1-articoli-KEY-Asc
              MOVE High-Value TO art-chiave OF articoli
           ELSE
              MOVE Low-Value TO art-chiave OF articoli
           END-IF
           .

      * articoli
       DataSet1-articoli-START.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY >= art-chiave OF articoli
           ELSE
              START articoli KEY <= art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-NOTGREATER.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY <= art-chiave OF articoli
           ELSE
              START articoli KEY >= art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-GREATER.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY > art-chiave OF articoli
           ELSE
              START articoli KEY < art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-LESS.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY < art-chiave OF articoli
           ELSE
              START articoli KEY > art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-articoli-LOCK
              READ articoli WITH LOCK 
              KEY art-chiave OF articoli
           ELSE
              READ articoli WITH NO LOCK 
              KEY art-chiave OF articoli
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT 
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-articoli-KEY-Asc
              IF DataSet1-articoli-LOCK
                 READ articoli NEXT WITH LOCK
              ELSE
                 READ articoli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli-LOCK
                 READ articoli PREVIOUS WITH LOCK
              ELSE
                 READ articoli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-articoli-KEY-Asc
              IF DataSet1-articoli-LOCK
                 READ articoli PREVIOUS WITH LOCK
              ELSE
                 READ articoli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli-LOCK
                 READ articoli NEXT WITH LOCK
              ELSE
                 READ articoli NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-note-INITSTART.
           IF DataSet1-note-KEY-Asc
              MOVE Low-Value TO not-chiave OF note
           ELSE
              MOVE High-Value TO not-chiave OF note
           END-IF
           .

       DataSet1-note-INITEND.
           IF DataSet1-note-KEY-Asc
              MOVE High-Value TO not-chiave OF note
           ELSE
              MOVE Low-Value TO not-chiave OF note
           END-IF
           .

      * note
       DataSet1-note-START.
           IF DataSet1-note-KEY-Asc
              START note KEY >= not-chiave OF note
           ELSE
              START note KEY <= not-chiave OF note
           END-IF
           .

       DataSet1-note-START-NOTGREATER.
           IF DataSet1-note-KEY-Asc
              START note KEY <= not-chiave OF note
           ELSE
              START note KEY >= not-chiave OF note
           END-IF
           .

       DataSet1-note-START-GREATER.
           IF DataSet1-note-KEY-Asc
              START note KEY > not-chiave OF note
           ELSE
              START note KEY < not-chiave OF note
           END-IF
           .

       DataSet1-note-START-LESS.
           IF DataSet1-note-KEY-Asc
              START note KEY < not-chiave OF note
           ELSE
              START note KEY > not-chiave OF note
           END-IF
           .

       DataSet1-note-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-note-LOCK
              READ note WITH LOCK 
              KEY not-chiave OF note
           ELSE
              READ note WITH NO LOCK 
              KEY not-chiave OF note
           END-IF
           MOVE STATUS-note TO TOTEM-ERR-STAT 
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-note-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-note-KEY-Asc
              IF DataSet1-note-LOCK
                 READ note NEXT WITH LOCK
              ELSE
                 READ note NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-note-LOCK
                 READ note PREVIOUS WITH LOCK
              ELSE
                 READ note PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-note-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-note-KEY-Asc
              IF DataSet1-note-LOCK
                 READ note PREVIOUS WITH LOCK
              ELSE
                 READ note PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-note-LOCK
                 READ note NEXT WITH LOCK
              ELSE
                 READ note NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-note-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-note-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-note-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:note, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-note TO TOTEM-ERR-STAT
           MOVE "note" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:note, AfterDelete>
      * <TOTEM:END>
           .

       tcodpag-TBL-CODICE-01-MERGE-SPLITBUF.
           INITIALIZE tcodpag-TBL-CODICE-01-SPLITBUF
           MOVE TBLPA-CODICE1(1:2) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(1:2)
           MOVE TBLPA-DESCRIZIONE1(1:30) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(3:30)
           MOVE TBLPA-CODICE2(1:20) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(33:20)
           .

       DataSet1-tcodpag-INITSTART.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE Low-Value TO TBLPA-CODICE
           ELSE
              MOVE High-Value TO TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-INITEND.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE High-Value TO TBLPA-CODICE
           ELSE
              MOVE Low-Value TO TBLPA-CODICE
           END-IF
           .

      * tcodpag
       DataSet1-tcodpag-START.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY >= TBLPA-CODICE
           ELSE
              START tcodpag KEY <= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-NOTGREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY <= TBLPA-CODICE
           ELSE
              START tcodpag KEY >= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-GREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY > TBLPA-CODICE
           ELSE
              START tcodpag KEY < TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-LESS.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY < TBLPA-CODICE
           ELSE
              START tcodpag KEY > TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcodpag-LOCK
              READ tcodpag WITH LOCK 
              KEY TBLPA-CODICE
           ELSE
              READ tcodpag WITH NO LOCK 
              KEY TBLPA-CODICE
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT 
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeWrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRewrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeDelete>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterDelete>
      * <TOTEM:END>
           .

       progmag-key01-MERGE-SPLITBUF.
           INITIALIZE progmag-key01-SPLITBUF
           MOVE prg-cod-magazzino OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(1:3)
           MOVE prg-cod-articolo OF progmag(1:6) TO 
           progmag-key01-SPLITBUF(4:6)
           MOVE prg-tipo-imballo OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(10:3)
           MOVE prg-peso OF progmag(1:8) TO progmag-key01-SPLITBUF(13:8)
           .

       DataSet1-progmag-INITSTART.
           IF DataSet1-progmag-KEY-Asc
              MOVE Low-Value TO prg-chiave OF progmag
           ELSE
              MOVE High-Value TO prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-INITEND.
           IF DataSet1-progmag-KEY-Asc
              MOVE High-Value TO prg-chiave OF progmag
           ELSE
              MOVE Low-Value TO prg-chiave OF progmag
           END-IF
           .

      * progmag
       DataSet1-progmag-START.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY >= prg-chiave OF progmag
           ELSE
              START progmag KEY <= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-NOTGREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY <= prg-chiave OF progmag
           ELSE
              START progmag KEY >= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-GREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY > prg-chiave OF progmag
           ELSE
              START progmag KEY < prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-LESS.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY < prg-chiave OF progmag
           ELSE
              START progmag KEY > prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-progmag-LOCK
              READ progmag WITH LOCK 
              KEY prg-chiave OF progmag
           ELSE
              READ progmag WITH NO LOCK 
              KEY prg-chiave OF progmag
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT 
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timposte-INITSTART.
           IF DataSet1-timposte-KEY-Asc
              MOVE Low-Value TO imp-chiave
           ELSE
              MOVE High-Value TO imp-chiave
           END-IF
           .

       DataSet1-timposte-INITEND.
           IF DataSet1-timposte-KEY-Asc
              MOVE High-Value TO imp-chiave
           ELSE
              MOVE Low-Value TO imp-chiave
           END-IF
           .

      * timposte
       DataSet1-timposte-START.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY >= imp-chiave
           ELSE
              START timposte KEY <= imp-chiave
           END-IF
           .

       DataSet1-timposte-START-NOTGREATER.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY <= imp-chiave
           ELSE
              START timposte KEY >= imp-chiave
           END-IF
           .

       DataSet1-timposte-START-GREATER.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY > imp-chiave
           ELSE
              START timposte KEY < imp-chiave
           END-IF
           .

       DataSet1-timposte-START-LESS.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY < imp-chiave
           ELSE
              START timposte KEY > imp-chiave
           END-IF
           .

       DataSet1-timposte-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timposte-LOCK
              READ timposte WITH LOCK 
              KEY imp-chiave
           ELSE
              READ timposte WITH NO LOCK 
              KEY imp-chiave
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT 
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timposte-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timposte-KEY-Asc
              IF DataSet1-timposte-LOCK
                 READ timposte NEXT WITH LOCK
              ELSE
                 READ timposte NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timposte-LOCK
                 READ timposte PREVIOUS WITH LOCK
              ELSE
                 READ timposte PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timposte-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timposte-KEY-Asc
              IF DataSet1-timposte-LOCK
                 READ timposte PREVIOUS WITH LOCK
              ELSE
                 READ timposte PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timposte-LOCK
                 READ timposte NEXT WITH LOCK
              ELSE
                 READ timposte NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmarche-INITSTART.
           IF DataSet1-tmarche-KEY-Asc
              MOVE Low-Value TO mar-chiave
           ELSE
              MOVE High-Value TO mar-chiave
           END-IF
           .

       DataSet1-tmarche-INITEND.
           IF DataSet1-tmarche-KEY-Asc
              MOVE High-Value TO mar-chiave
           ELSE
              MOVE Low-Value TO mar-chiave
           END-IF
           .

      * tmarche
       DataSet1-tmarche-START.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY >= mar-chiave
           ELSE
              START tmarche KEY <= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-NOTGREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY <= mar-chiave
           ELSE
              START tmarche KEY >= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-GREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY > mar-chiave
           ELSE
              START tmarche KEY < mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-LESS.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY < mar-chiave
           ELSE
              START tmarche KEY > mar-chiave
           END-IF
           .

       DataSet1-tmarche-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmarche-LOCK
              READ tmarche WITH LOCK 
              KEY mar-chiave
           ELSE
              READ tmarche WITH NO LOCK 
              KEY mar-chiave
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT 
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterDelete>
      * <TOTEM:END>
           .

       tmp-assorcli-key01-MERGE-SPLITBUF.
           INITIALIZE tmp-assorcli-key01-SPLITBUF
           MOVE tmp-asc-cod-gruppo-gdo(1:5) TO 
           tmp-assorcli-key01-SPLITBUF(1:5)
           MOVE tmp-asc-cod-articolo(1:6) TO 
           tmp-assorcli-key01-SPLITBUF(6:6)
           MOVE tmp-asc-cod-cliente(1:5) TO 
           tmp-assorcli-key01-SPLITBUF(12:5)
           MOVE tmp-asc-progressivo-destino(1:5) TO 
           tmp-assorcli-key01-SPLITBUF(17:5)
           .

       DataSet1-tmp-assorcli-INITSTART.
           IF DataSet1-tmp-assorcli-KEY-Asc
              MOVE Low-Value TO tmp-asc-chiave
           ELSE
              MOVE High-Value TO tmp-asc-chiave
           END-IF
           .

       DataSet1-tmp-assorcli-INITEND.
           IF DataSet1-tmp-assorcli-KEY-Asc
              MOVE High-Value TO tmp-asc-chiave
           ELSE
              MOVE Low-Value TO tmp-asc-chiave
           END-IF
           .

      * tmp-assorcli
       DataSet1-tmp-assorcli-START.
           IF DataSet1-tmp-assorcli-KEY-Asc
              START tmp-assorcli KEY >= tmp-asc-chiave
           ELSE
              START tmp-assorcli KEY <= tmp-asc-chiave
           END-IF
           .

       DataSet1-tmp-assorcli-START-NOTGREATER.
           IF DataSet1-tmp-assorcli-KEY-Asc
              START tmp-assorcli KEY <= tmp-asc-chiave
           ELSE
              START tmp-assorcli KEY >= tmp-asc-chiave
           END-IF
           .

       DataSet1-tmp-assorcli-START-GREATER.
           IF DataSet1-tmp-assorcli-KEY-Asc
              START tmp-assorcli KEY > tmp-asc-chiave
           ELSE
              START tmp-assorcli KEY < tmp-asc-chiave
           END-IF
           .

       DataSet1-tmp-assorcli-START-LESS.
           IF DataSet1-tmp-assorcli-KEY-Asc
              START tmp-assorcli KEY < tmp-asc-chiave
           ELSE
              START tmp-assorcli KEY > tmp-asc-chiave
           END-IF
           .

       DataSet1-tmp-assorcli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmp-assorcli-LOCK
              READ tmp-assorcli WITH LOCK 
              KEY tmp-asc-chiave
           ELSE
              READ tmp-assorcli WITH NO LOCK 
              KEY tmp-asc-chiave
           END-IF
           PERFORM tmp-assorcli-key01-MERGE-SPLITBUF
           MOVE STATUS-tmp-assorcli TO TOTEM-ERR-STAT 
           MOVE "tmp-assorcli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-assorcli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmp-assorcli-KEY-Asc
              IF DataSet1-tmp-assorcli-LOCK
                 READ tmp-assorcli NEXT WITH LOCK
              ELSE
                 READ tmp-assorcli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmp-assorcli-LOCK
                 READ tmp-assorcli PREVIOUS WITH LOCK
              ELSE
                 READ tmp-assorcli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tmp-assorcli-key01-MERGE-SPLITBUF
           MOVE STATUS-tmp-assorcli TO TOTEM-ERR-STAT
           MOVE "tmp-assorcli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-assorcli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmp-assorcli-KEY-Asc
              IF DataSet1-tmp-assorcli-LOCK
                 READ tmp-assorcli PREVIOUS WITH LOCK
              ELSE
                 READ tmp-assorcli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmp-assorcli-LOCK
                 READ tmp-assorcli NEXT WITH LOCK
              ELSE
                 READ tmp-assorcli NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tmp-assorcli-key01-MERGE-SPLITBUF
           MOVE STATUS-tmp-assorcli TO TOTEM-ERR-STAT
           MOVE "tmp-assorcli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-assorcli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, BeforeWrite>
      * <TOTEM:END>
           WRITE tmp-asc-rec OF tmp-assorcli.
           MOVE STATUS-tmp-assorcli TO TOTEM-ERR-STAT
           MOVE "tmp-assorcli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-assorcli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, BeforeRewrite>
      * <TOTEM:END>
           REWRITE tmp-asc-rec OF tmp-assorcli.
           MOVE STATUS-tmp-assorcli TO TOTEM-ERR-STAT
           MOVE "tmp-assorcli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-assorcli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, BeforeDelete>
      * <TOTEM:END>
           DELETE tmp-assorcli.
           MOVE STATUS-tmp-assorcli TO TOTEM-ERR-STAT
           MOVE "tmp-assorcli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-assorcli, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tparamge-INITSTART.
           IF DataSet1-tparamge-KEY-Asc
              MOVE Low-Value TO tge-chiave
           ELSE
              MOVE High-Value TO tge-chiave
           END-IF
           .

       DataSet1-tparamge-INITEND.
           IF DataSet1-tparamge-KEY-Asc
              MOVE High-Value TO tge-chiave
           ELSE
              MOVE Low-Value TO tge-chiave
           END-IF
           .

      * tparamge
       DataSet1-tparamge-START.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY >= tge-chiave
           ELSE
              START tparamge KEY <= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-NOTGREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY <= tge-chiave
           ELSE
              START tparamge KEY >= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-GREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY > tge-chiave
           ELSE
              START tparamge KEY < tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-LESS.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY < tge-chiave
           ELSE
              START tparamge KEY > tge-chiave
           END-IF
           .

       DataSet1-tparamge-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tparamge-LOCK
              READ tparamge WITH LOCK 
              KEY tge-chiave
           ELSE
              READ tparamge WITH NO LOCK 
              KEY tge-chiave
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT 
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-INITSTART.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE Low-Value TO mag-chiave
           ELSE
              MOVE High-Value TO mag-chiave
           END-IF
           .

       DataSet1-tmagaz-INITEND.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE High-Value TO mag-chiave
           ELSE
              MOVE Low-Value TO mag-chiave
           END-IF
           .

      * tmagaz
       DataSet1-tmagaz-START.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY >= mag-chiave
           ELSE
              START tmagaz KEY <= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-NOTGREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY <= mag-chiave
           ELSE
              START tmagaz KEY >= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-GREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY > mag-chiave
           ELSE
              START tmagaz KEY < mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-LESS.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY < mag-chiave
           ELSE
              START tmagaz KEY > mag-chiave
           END-IF
           .

       DataSet1-tmagaz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmagaz-LOCK
              READ tmagaz WITH LOCK 
              KEY mag-chiave
           ELSE
              READ tmagaz WITH NO LOCK 
              KEY mag-chiave
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT 
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterDelete>
      * <TOTEM:END>
           .

       tcaumag-k-mag-MERGE-SPLITBUF.
           INITIALIZE tcaumag-k-mag-SPLITBUF
           MOVE tca-cod-magaz(1:3) TO tcaumag-k-mag-SPLITBUF(1:3)
           MOVE tca-ord-forn(1:1) TO tcaumag-k-mag-SPLITBUF(4:1)
           .

       DataSet1-tcaumag-INITSTART.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE Low-Value TO tca-chiave
           ELSE
              MOVE High-Value TO tca-chiave
           END-IF
           .

       DataSet1-tcaumag-INITEND.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE High-Value TO tca-chiave
           ELSE
              MOVE Low-Value TO tca-chiave
           END-IF
           .

      * tcaumag
       DataSet1-tcaumag-START.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY >= tca-chiave
           ELSE
              START tcaumag KEY <= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-NOTGREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY <= tca-chiave
           ELSE
              START tcaumag KEY >= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-GREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY > tca-chiave
           ELSE
              START tcaumag KEY < tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-LESS.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY < tca-chiave
           ELSE
              START tcaumag KEY > tca-chiave
           END-IF
           .

       DataSet1-tcaumag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcaumag-LOCK
              READ tcaumag WITH LOCK 
              KEY tca-chiave
           ELSE
              READ tcaumag WITH NO LOCK 
              KEY tca-chiave
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT 
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-INITSTART.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE Low-Value TO imq-chiave
           ELSE
              MOVE High-Value TO imq-chiave
           END-IF
           .

       DataSet1-timbalqta-INITEND.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE High-Value TO imq-chiave
           ELSE
              MOVE Low-Value TO imq-chiave
           END-IF
           .

      * timbalqta
       DataSet1-timbalqta-START.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY >= imq-chiave
           ELSE
              START timbalqta KEY <= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-NOTGREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY <= imq-chiave
           ELSE
              START timbalqta KEY >= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-GREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY > imq-chiave
           ELSE
              START timbalqta KEY < imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-LESS.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY < imq-chiave
           ELSE
              START timbalqta KEY > imq-chiave
           END-IF
           .

       DataSet1-timbalqta-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timbalqta-LOCK
              READ timbalqta WITH LOCK 
              KEY imq-chiave
           ELSE
              READ timbalqta WITH NO LOCK 
              KEY imq-chiave
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT 
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timballi-INITSTART.
           IF DataSet1-timballi-KEY-Asc
              MOVE Low-Value TO imb-chiave
           ELSE
              MOVE High-Value TO imb-chiave
           END-IF
           .

       DataSet1-timballi-INITEND.
           IF DataSet1-timballi-KEY-Asc
              MOVE High-Value TO imb-chiave
           ELSE
              MOVE Low-Value TO imb-chiave
           END-IF
           .

      * timballi
       DataSet1-timballi-START.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY >= imb-chiave
           ELSE
              START timballi KEY <= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-NOTGREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY <= imb-chiave
           ELSE
              START timballi KEY >= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-GREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY > imb-chiave
           ELSE
              START timballi KEY < imb-chiave
           END-IF
           .

       DataSet1-timballi-START-LESS.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY < imb-chiave
           ELSE
              START timballi KEY > imb-chiave
           END-IF
           .

       DataSet1-timballi-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timballi-LOCK
              READ timballi WITH LOCK 
              KEY imb-chiave
           ELSE
              READ timballi WITH NO LOCK 
              KEY imb-chiave
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT 
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-recapiti-INITSTART.
           IF DataSet1-recapiti-KEY-Asc
              MOVE Low-Value TO rec-chiave
           ELSE
              MOVE High-Value TO rec-chiave
           END-IF
           .

       DataSet1-recapiti-INITEND.
           IF DataSet1-recapiti-KEY-Asc
              MOVE High-Value TO rec-chiave
           ELSE
              MOVE Low-Value TO rec-chiave
           END-IF
           .

      * recapiti
       DataSet1-recapiti-START.
           IF DataSet1-recapiti-KEY-Asc
              START recapiti KEY >= rec-chiave
           ELSE
              START recapiti KEY <= rec-chiave
           END-IF
           .

       DataSet1-recapiti-START-NOTGREATER.
           IF DataSet1-recapiti-KEY-Asc
              START recapiti KEY <= rec-chiave
           ELSE
              START recapiti KEY >= rec-chiave
           END-IF
           .

       DataSet1-recapiti-START-GREATER.
           IF DataSet1-recapiti-KEY-Asc
              START recapiti KEY > rec-chiave
           ELSE
              START recapiti KEY < rec-chiave
           END-IF
           .

       DataSet1-recapiti-START-LESS.
           IF DataSet1-recapiti-KEY-Asc
              START recapiti KEY < rec-chiave
           ELSE
              START recapiti KEY > rec-chiave
           END-IF
           .

       DataSet1-recapiti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-recapiti-LOCK
              READ recapiti WITH LOCK 
              KEY rec-chiave
           ELSE
              READ recapiti WITH NO LOCK 
              KEY rec-chiave
           END-IF
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT 
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-recapiti-KEY-Asc
              IF DataSet1-recapiti-LOCK
                 READ recapiti NEXT WITH LOCK
              ELSE
                 READ recapiti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-recapiti-LOCK
                 READ recapiti PREVIOUS WITH LOCK
              ELSE
                 READ recapiti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-recapiti-KEY-Asc
              IF DataSet1-recapiti-LOCK
                 READ recapiti PREVIOUS WITH LOCK
              ELSE
                 READ recapiti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-recapiti-LOCK
                 READ recapiti NEXT WITH LOCK
              ELSE
                 READ recapiti NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-recapiti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-recapiti TO TOTEM-ERR-STAT
           MOVE "recapiti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:recapiti, AfterDelete>
      * <TOTEM:END>
           .

       rmovmag-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rmovmag-k-articolo-SPLITBUF
           MOVE rmo-anno OF rmovmag(1:4) TO 
           rmovmag-k-articolo-SPLITBUF(1:4)
           MOVE rmo-movim OF rmovmag(1:8) TO 
           rmovmag-k-articolo-SPLITBUF(5:8)
           MOVE rmo-articolo OF rmovmag(1:6) TO 
           rmovmag-k-articolo-SPLITBUF(13:6)
           .

       rmovmag-rmo-chiave-ricerca-MERGE-SPLITBUF.
           INITIALIZE rmovmag-rmo-chiave-ricerca-SPLITBUF
           MOVE rmo-tipo OF rmovmag(1:1) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(1:1)
           MOVE rmo-cod-clifor OF rmovmag(1:5) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(2:5)
           MOVE rmo-causale OF rmovmag(1:4) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(7:4)
           MOVE rmo-articolo OF rmovmag(1:6) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(11:6)
           MOVE rmo-data-movim OF rmovmag(1:8) TO 
           rmovmag-rmo-chiave-ricerca-SPLITBUF(17:8)
           .

       rmovmag-k-progmag-MERGE-SPLITBUF.
           INITIALIZE rmovmag-k-progmag-SPLITBUF
           MOVE rmo-chiave-progmag OF rmovmag(1:20) TO 
           rmovmag-k-progmag-SPLITBUF(1:20)
           .

       rmovmag-k-art-data-MERGE-SPLITBUF.
           INITIALIZE rmovmag-k-art-data-SPLITBUF
           MOVE rmo-articolo OF rmovmag(1:6) TO 
           rmovmag-k-art-data-SPLITBUF(1:6)
           MOVE rmo-data-movim OF rmovmag(1:8) TO 
           rmovmag-k-art-data-SPLITBUF(7:8)
           .

       DataSet1-rmovmag-INITSTART.
           IF DataSet1-rmovmag-KEY-Asc
              MOVE Low-Value TO rmo-chiave OF rmovmag
           ELSE
              MOVE High-Value TO rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-INITEND.
           IF DataSet1-rmovmag-KEY-Asc
              MOVE High-Value TO rmo-chiave OF rmovmag
           ELSE
              MOVE Low-Value TO rmo-chiave OF rmovmag
           END-IF
           .

      * rmovmag
       DataSet1-rmovmag-START.
           IF DataSet1-rmovmag-KEY-Asc
              START rmovmag KEY >= rmo-chiave OF rmovmag
           ELSE
              START rmovmag KEY <= rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-START-NOTGREATER.
           IF DataSet1-rmovmag-KEY-Asc
              START rmovmag KEY <= rmo-chiave OF rmovmag
           ELSE
              START rmovmag KEY >= rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-START-GREATER.
           IF DataSet1-rmovmag-KEY-Asc
              START rmovmag KEY > rmo-chiave OF rmovmag
           ELSE
              START rmovmag KEY < rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-START-LESS.
           IF DataSet1-rmovmag-KEY-Asc
              START rmovmag KEY < rmo-chiave OF rmovmag
           ELSE
              START rmovmag KEY > rmo-chiave OF rmovmag
           END-IF
           .

       DataSet1-rmovmag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rmovmag-LOCK
              READ rmovmag WITH LOCK 
              KEY rmo-chiave OF rmovmag
           ELSE
              READ rmovmag WITH NO LOCK 
              KEY rmo-chiave OF rmovmag
           END-IF
           PERFORM rmovmag-k-articolo-MERGE-SPLITBUF
           PERFORM rmovmag-rmo-chiave-ricerca-MERGE-SPLITBUF
           PERFORM rmovmag-k-progmag-MERGE-SPLITBUF
           PERFORM rmovmag-k-art-data-MERGE-SPLITBUF
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT 
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rmovmag-KEY-Asc
              IF DataSet1-rmovmag-LOCK
                 READ rmovmag NEXT WITH LOCK
              ELSE
                 READ rmovmag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rmovmag-LOCK
                 READ rmovmag PREVIOUS WITH LOCK
              ELSE
                 READ rmovmag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rmovmag-k-articolo-MERGE-SPLITBUF
           PERFORM rmovmag-rmo-chiave-ricerca-MERGE-SPLITBUF
           PERFORM rmovmag-k-progmag-MERGE-SPLITBUF
           PERFORM rmovmag-k-art-data-MERGE-SPLITBUF
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rmovmag-KEY-Asc
              IF DataSet1-rmovmag-LOCK
                 READ rmovmag PREVIOUS WITH LOCK
              ELSE
                 READ rmovmag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rmovmag-LOCK
                 READ rmovmag NEXT WITH LOCK
              ELSE
                 READ rmovmag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rmovmag-k-articolo-MERGE-SPLITBUF
           PERFORM rmovmag-rmo-chiave-ricerca-MERGE-SPLITBUF
           PERFORM rmovmag-k-progmag-MERGE-SPLITBUF
           PERFORM rmovmag-k-art-data-MERGE-SPLITBUF
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rmovmag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rmovmag TO TOTEM-ERR-STAT
           MOVE "rmovmag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rmovmag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-INITSTART.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE Low-Value TO tcl-chiave
           ELSE
              MOVE High-Value TO tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-INITEND.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE High-Value TO tcl-chiave
           ELSE
              MOVE Low-Value TO tcl-chiave
           END-IF
           .

      * ttipocli
       DataSet1-ttipocli-START.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY >= tcl-chiave
           ELSE
              START ttipocli KEY <= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-NOTGREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY <= tcl-chiave
           ELSE
              START ttipocli KEY >= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-GREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY > tcl-chiave
           ELSE
              START ttipocli KEY < tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-LESS.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY < tcl-chiave
           ELSE
              START ttipocli KEY > tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-ttipocli-LOCK
              READ ttipocli WITH LOCK 
              KEY tcl-chiave
           ELSE
              READ ttipocli WITH NO LOCK 
              KEY tcl-chiave
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT 
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterDelete>
      * <TOTEM:END>
           .

       mrordini-mro-k-promo-MERGE-SPLITBUF.
           INITIALIZE mrordini-mro-k-promo-SPLITBUF
           MOVE mro-promo(1:15) TO mrordini-mro-k-promo-SPLITBUF(1:15)
           MOVE mro-chiave(1:17) TO mrordini-mro-k-promo-SPLITBUF(16:17)
           .

       mrordini-mro-k-articolo-MERGE-SPLITBUF.
           INITIALIZE mrordini-mro-k-articolo-SPLITBUF
           MOVE mro-cod-articolo(1:6) TO 
           mrordini-mro-k-articolo-SPLITBUF(1:6)
           MOVE mro-chiave(1:17) TO 
           mrordini-mro-k-articolo-SPLITBUF(7:17)
           .

       mrordini-mro-k-progr-MERGE-SPLITBUF.
           INITIALIZE mrordini-mro-k-progr-SPLITBUF
           MOVE mro-chiave-testa(1:12) TO 
           mrordini-mro-k-progr-SPLITBUF(1:12)
           MOVE mro-progr(1:5) TO mrordini-mro-k-progr-SPLITBUF(13:5)
           .

       mrordini-mro-k-tprev-MERGE-SPLITBUF.
           INITIALIZE mrordini-mro-k-tprev-SPLITBUF
           MOVE mro-promo(1:15) TO mrordini-mro-k-tprev-SPLITBUF(1:15)
           MOVE mro-prg-cod-articolo(1:6) TO 
           mrordini-mro-k-tprev-SPLITBUF(16:6)
           MOVE mro-chiave(1:17) TO mrordini-mro-k-tprev-SPLITBUF(22:17)
           .

       DataSet1-mrordini-INITSTART.
           IF DataSet1-mrordini-KEY-Asc
              MOVE Low-Value TO mro-chiave
           ELSE
              MOVE High-Value TO mro-chiave
           END-IF
           .

       DataSet1-mrordini-INITEND.
           IF DataSet1-mrordini-KEY-Asc
              MOVE High-Value TO mro-chiave
           ELSE
              MOVE Low-Value TO mro-chiave
           END-IF
           .

      * mrordini
       DataSet1-mrordini-START.
           IF DataSet1-mrordini-KEY-Asc
              START mrordini KEY >= mro-chiave
           ELSE
              START mrordini KEY <= mro-chiave
           END-IF
           .

       DataSet1-mrordini-START-NOTGREATER.
           IF DataSet1-mrordini-KEY-Asc
              START mrordini KEY <= mro-chiave
           ELSE
              START mrordini KEY >= mro-chiave
           END-IF
           .

       DataSet1-mrordini-START-GREATER.
           IF DataSet1-mrordini-KEY-Asc
              START mrordini KEY > mro-chiave
           ELSE
              START mrordini KEY < mro-chiave
           END-IF
           .

       DataSet1-mrordini-START-LESS.
           IF DataSet1-mrordini-KEY-Asc
              START mrordini KEY < mro-chiave
           ELSE
              START mrordini KEY > mro-chiave
           END-IF
           .

       DataSet1-mrordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-mrordini-LOCK
              READ mrordini WITH LOCK 
              KEY mro-chiave
           ELSE
              READ mrordini WITH NO LOCK 
              KEY mro-chiave
           END-IF
           PERFORM mrordini-mro-k-promo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-articolo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-progr-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-tprev-MERGE-SPLITBUF
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT 
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-mrordini-KEY-Asc
              IF DataSet1-mrordini-LOCK
                 READ mrordini NEXT WITH LOCK
              ELSE
                 READ mrordini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-mrordini-LOCK
                 READ mrordini PREVIOUS WITH LOCK
              ELSE
                 READ mrordini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM mrordini-mro-k-promo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-articolo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-progr-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-tprev-MERGE-SPLITBUF
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-mrordini-KEY-Asc
              IF DataSet1-mrordini-LOCK
                 READ mrordini PREVIOUS WITH LOCK
              ELSE
                 READ mrordini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-mrordini-LOCK
                 READ mrordini NEXT WITH LOCK
              ELSE
                 READ mrordini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM mrordini-mro-k-promo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-articolo-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-progr-MERGE-SPLITBUF
           PERFORM mrordini-mro-k-tprev-MERGE-SPLITBUF
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeWrite>
      * <TOTEM:END>
           WRITE mro-rec OF mrordini.
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeRewrite>
      * <TOTEM:END>
           REWRITE mro-rec OF mrordini.
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-mrordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, BeforeDelete>
      * <TOTEM:END>
           DELETE mrordini.
           MOVE STATUS-mrordini TO TOTEM-ERR-STAT
           MOVE "mrordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:mrordini, AfterDelete>
      * <TOTEM:END>
           .

       tmp-progmag-zoom-key-des-MERGE-SPLITBUF.
           INITIALIZE tmp-progmag-zoom-key-des-SPLITBUF
           MOVE tmp-prg-z-art-des(1:40) TO 
           tmp-progmag-zoom-key-des-SPLITBUF(1:40)
           MOVE tmp-prg-z-chiave(1:23) TO 
           tmp-progmag-zoom-key-des-SPLITBUF(41:23)
           .

       tmp-progmag-zoom-key-des-SPLITBUF-TOFLD.
           MOVE tmp-progmag-zoom-key-des-SPLITBUF(1:40) TO 
           tmp-prg-z-art-des(1:40)
           MOVE tmp-progmag-zoom-key-des-SPLITBUF(41:23) TO 
           tmp-prg-z-chiave(1:23)
           .

       tmp-progmag-zoom-key-art-MERGE-SPLITBUF.
           INITIALIZE tmp-progmag-zoom-key-art-SPLITBUF
           MOVE tmp-prg-z-cod-articolo(1:6) TO 
           tmp-progmag-zoom-key-art-SPLITBUF(1:6)
           .

       DataSet1-tmp-progmag-zoom-INITSTART.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE Low-Value TO tmp-prg-z-art-des
           ELSE
              MOVE High-Value TO tmp-prg-z-art-des
           END-IF
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE Low-Value TO tmp-prg-z-chiave
           ELSE
              MOVE High-Value TO tmp-prg-z-chiave
           END-IF
           .

       DataSet1-tmp-progmag-zoom-INITEND.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE High-Value to tmp-prg-z-art-des
           ELSE
              MOVE Low-Value to tmp-prg-z-art-des
           END-IF
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE High-Value to tmp-prg-z-chiave
           ELSE
              MOVE Low-Value to tmp-prg-z-chiave
           END-IF
           .

       DataSet1-tmp-progmag-zoom-TMPBUF-TO-FLD.
           MOVE DataSet1-tmp-progmag-zoom-SPLIT-BUF1(1:40) TO
                tmp-prg-z-art-des(1:40)
           MOVE DataSet1-tmp-progmag-zoom-SPLIT-BUF1(41:23) TO
                tmp-prg-z-chiave(1:23)
           .

       DataSet1-tmp-progmag-zoom-FLD-TO-TMPBUF.
           MOVE tmp-prg-z-art-des(1:40) TO
                DataSet1-tmp-progmag-zoom-SPLIT-BUF1(1:40)
           MOVE tmp-prg-z-chiave(1:23) TO
                DataSet1-tmp-progmag-zoom-SPLIT-BUF1(41:23)
           .

      * tmp-progmag-zoom
       DataSet1-tmp-progmag-zoom-START.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY >= key-des
           ELSE
              START tmp-progmag-zoom KEY <= key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-START-NOTGREATER.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY <= key-des
           ELSE
              START tmp-progmag-zoom KEY >= key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-START-GREATER.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY > key-des
           ELSE
              START tmp-progmag-zoom KEY < key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-START-LESS.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY < key-des
           ELSE
              START tmp-progmag-zoom KEY > key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeWrite>
      * <TOTEM:END>
           WRITE tmp-prg-z-rec OF tmp-progmag-zoom.
           MOVE STATUS-tmp-progmag-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-progmag-zoom" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-progmag-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-progmag-zoom" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-progmag-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-progmag-zoom" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-INITSTART.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              MOVE Low-Value TO zoom-tca-chiave
           ELSE
              MOVE High-Value TO zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-INITEND.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              MOVE High-Value TO zoom-tca-chiave
           ELSE
              MOVE Low-Value TO zoom-tca-chiave
           END-IF
           .

      * zoom-tcaumag
       DataSet1-zoom-tcaumag-START.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              START zoom-tcaumag KEY >= zoom-tca-chiave
           ELSE
              START zoom-tcaumag KEY <= zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-START-NOTGREATER.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              START zoom-tcaumag KEY <= zoom-tca-chiave
           ELSE
              START zoom-tcaumag KEY >= zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-START-GREATER.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              START zoom-tcaumag KEY > zoom-tca-chiave
           ELSE
              START zoom-tcaumag KEY < zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-START-LESS.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              START zoom-tcaumag KEY < zoom-tca-chiave
           ELSE
              START zoom-tcaumag KEY > zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeWrite>
      * <TOTEM:END>
           WRITE zoom-tca-rec OF zoom-tcaumag.
           MOVE status-zooom-tcaumag TO TOTEM-ERR-STAT
           MOVE "zoom-tcaumag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeRewrite>
      * <TOTEM:END>
           MOVE status-zooom-tcaumag TO TOTEM-ERR-STAT
           MOVE "zoom-tcaumag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeDelete>
      * <TOTEM:END>
           MOVE status-zooom-tcaumag TO TOTEM-ERR-STAT
           MOVE "zoom-tcaumag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-INITSTART.
           IF DataSet1-tpiombo-KEY-Asc
              MOVE Low-Value TO tpb-chiave
           ELSE
              MOVE High-Value TO tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-INITEND.
           IF DataSet1-tpiombo-KEY-Asc
              MOVE High-Value TO tpb-chiave
           ELSE
              MOVE Low-Value TO tpb-chiave
           END-IF
           .

      * tpiombo
       DataSet1-tpiombo-START.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY >= tpb-chiave
           ELSE
              START tpiombo KEY <= tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-NOTGREATER.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY <= tpb-chiave
           ELSE
              START tpiombo KEY >= tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-GREATER.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY > tpb-chiave
           ELSE
              START tpiombo KEY < tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-LESS.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY < tpb-chiave
           ELSE
              START tpiombo KEY > tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tpiombo-LOCK
              READ tpiombo WITH LOCK 
              KEY tpb-chiave
           ELSE
              READ tpiombo WITH NO LOCK 
              KEY tpb-chiave
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT 
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tpiombo-KEY-Asc
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo NEXT WITH LOCK
              ELSE
                 READ tpiombo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo PREVIOUS WITH LOCK
              ELSE
                 READ tpiombo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tpiombo-KEY-Asc
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo PREVIOUS WITH LOCK
              ELSE
                 READ tpiombo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo NEXT WITH LOCK
              ELSE
                 READ tpiombo NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterDelete>
      * <TOTEM:END>
           .

       lisagente-k-codice-MERGE-SPLITBUF.
           INITIALIZE lisagente-k-codice-SPLITBUF
           MOVE lis-codice OF lisagente(1:4) TO 
           lisagente-k-codice-SPLITBUF(1:4)
           .

       DataSet1-lisagente-INITSTART.
           IF DataSet1-lisagente-KEY-Asc
              MOVE Low-Value TO lis-chiave OF lisagente
           ELSE
              MOVE High-Value TO lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-INITEND.
           IF DataSet1-lisagente-KEY-Asc
              MOVE High-Value TO lis-chiave OF lisagente
           ELSE
              MOVE Low-Value TO lis-chiave OF lisagente
           END-IF
           .

      * lisagente
       DataSet1-lisagente-START.
           IF DataSet1-lisagente-KEY-Asc
              START lisagente KEY >= lis-chiave OF lisagente
           ELSE
              START lisagente KEY <= lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-START-NOTGREATER.
           IF DataSet1-lisagente-KEY-Asc
              START lisagente KEY <= lis-chiave OF lisagente
           ELSE
              START lisagente KEY >= lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-START-GREATER.
           IF DataSet1-lisagente-KEY-Asc
              START lisagente KEY > lis-chiave OF lisagente
           ELSE
              START lisagente KEY < lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-START-LESS.
           IF DataSet1-lisagente-KEY-Asc
              START lisagente KEY < lis-chiave OF lisagente
           ELSE
              START lisagente KEY > lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-lisagente-LOCK
              READ lisagente WITH LOCK 
              KEY lis-chiave OF lisagente
           ELSE
              READ lisagente WITH NO LOCK 
              KEY lis-chiave OF lisagente
           END-IF
           PERFORM lisagente-k-codice-MERGE-SPLITBUF
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT 
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-lisagente-KEY-Asc
              IF DataSet1-lisagente-LOCK
                 READ lisagente NEXT WITH LOCK
              ELSE
                 READ lisagente NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-lisagente-LOCK
                 READ lisagente PREVIOUS WITH LOCK
              ELSE
                 READ lisagente PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM lisagente-k-codice-MERGE-SPLITBUF
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-lisagente-KEY-Asc
              IF DataSet1-lisagente-LOCK
                 READ lisagente PREVIOUS WITH LOCK
              ELSE
                 READ lisagente PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-lisagente-LOCK
                 READ lisagente NEXT WITH LOCK
              ELSE
                 READ lisagente NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM lisagente-k-codice-MERGE-SPLITBUF
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-lineseq-INITSTART.
           .

       DataSet1-lineseq-INITEND.
           .

       DataSet1-lineseq-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-lineseq-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-lineseq-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-lineseq-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, BeforeWrite>
      * <TOTEM:END>
           WRITE line-riga OF lineseq.
           MOVE STATUS-lineseq TO TOTEM-ERR-STAT
           MOVE "lineseq" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-lineseq-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-lineseq TO TOTEM-ERR-STAT
           MOVE "lineseq" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-lineseq-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-lineseq TO TOTEM-ERR-STAT
           MOVE "lineseq" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lineseq, AfterDelete>
      * <TOTEM:END>
           .

       blister-k-magaz-MERGE-SPLITBUF.
           INITIALIZE blister-k-magaz-SPLITBUF
           MOVE bli-magazzino(1:3) TO blister-k-magaz-SPLITBUF(1:3)
           MOVE bli-codice(1:6) TO blister-k-magaz-SPLITBUF(4:6)
           .

       blister-k-des-MERGE-SPLITBUF.
           INITIALIZE blister-k-des-SPLITBUF
           MOVE bli-descrizione(1:50) TO blister-k-des-SPLITBUF(1:50)
           .

       DataSet1-blister-INITSTART.
           IF DataSet1-blister-KEY-Asc
              MOVE Low-Value TO bli-chiave
           ELSE
              MOVE High-Value TO bli-chiave
           END-IF
           .

       DataSet1-blister-INITEND.
           IF DataSet1-blister-KEY-Asc
              MOVE High-Value TO bli-chiave
           ELSE
              MOVE Low-Value TO bli-chiave
           END-IF
           .

      * blister
       DataSet1-blister-START.
           IF DataSet1-blister-KEY-Asc
              START blister KEY >= bli-chiave
           ELSE
              START blister KEY <= bli-chiave
           END-IF
           .

       DataSet1-blister-START-NOTGREATER.
           IF DataSet1-blister-KEY-Asc
              START blister KEY <= bli-chiave
           ELSE
              START blister KEY >= bli-chiave
           END-IF
           .

       DataSet1-blister-START-GREATER.
           IF DataSet1-blister-KEY-Asc
              START blister KEY > bli-chiave
           ELSE
              START blister KEY < bli-chiave
           END-IF
           .

       DataSet1-blister-START-LESS.
           IF DataSet1-blister-KEY-Asc
              START blister KEY < bli-chiave
           ELSE
              START blister KEY > bli-chiave
           END-IF
           .

       DataSet1-blister-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-blister-LOCK
              READ blister WITH LOCK 
              KEY bli-chiave
           ELSE
              READ blister WITH NO LOCK 
              KEY bli-chiave
           END-IF
           PERFORM blister-k-magaz-MERGE-SPLITBUF
           PERFORM blister-k-des-MERGE-SPLITBUF
           MOVE STATUS-blister TO TOTEM-ERR-STAT 
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-blister-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-blister-KEY-Asc
              IF DataSet1-blister-LOCK
                 READ blister NEXT WITH LOCK
              ELSE
                 READ blister NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-blister-LOCK
                 READ blister PREVIOUS WITH LOCK
              ELSE
                 READ blister PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM blister-k-magaz-MERGE-SPLITBUF
           PERFORM blister-k-des-MERGE-SPLITBUF
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-blister-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-blister-KEY-Asc
              IF DataSet1-blister-LOCK
                 READ blister PREVIOUS WITH LOCK
              ELSE
                 READ blister PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-blister-LOCK
                 READ blister NEXT WITH LOCK
              ELSE
                 READ blister NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM blister-k-magaz-MERGE-SPLITBUF
           PERFORM blister-k-des-MERGE-SPLITBUF
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-blister-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-blister-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-blister-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterDelete>
      * <TOTEM:END>
           .

       tordini-k-causale-MERGE-SPLITBUF.
           INITIALIZE tordini-k-causale-SPLITBUF
           MOVE tor-causale(1:4) TO tordini-k-causale-SPLITBUF(1:4)
           MOVE tor-anno(1:4) TO tordini-k-causale-SPLITBUF(5:4)
           MOVE tor-numero(1:8) TO tordini-k-causale-SPLITBUF(9:8)
           .

       tordini-k1-MERGE-SPLITBUF.
           INITIALIZE tordini-k1-SPLITBUF
           MOVE tor-cod-cli(1:5) TO tordini-k1-SPLITBUF(1:5)
           MOVE tor-prg-destino(1:5) TO tordini-k1-SPLITBUF(6:5)
           MOVE tor-anno(1:4) TO tordini-k1-SPLITBUF(11:4)
           MOVE tor-numero(1:8) TO tordini-k1-SPLITBUF(15:8)
           .

       tordini-k2-MERGE-SPLITBUF.
           INITIALIZE tordini-k2-SPLITBUF
           MOVE tor-data-passaggio-ordine(1:8) TO 
           tordini-k2-SPLITBUF(1:8)
           MOVE tor-anno(1:4) TO tordini-k2-SPLITBUF(9:4)
           MOVE tor-numero(1:8) TO tordini-k2-SPLITBUF(13:8)
           .

       tordini-k-bolla-MERGE-SPLITBUF.
           INITIALIZE tordini-k-bolla-SPLITBUF
           MOVE tor-anno-bolla(1:4) TO tordini-k-bolla-SPLITBUF(1:4)
           MOVE tor-num-bolla(1:8) TO tordini-k-bolla-SPLITBUF(5:8)
           .

       tordini-k3-MERGE-SPLITBUF.
           INITIALIZE tordini-k3-SPLITBUF
           MOVE tor-anno-bolla(1:4) TO tordini-k3-SPLITBUF(1:4)
           MOVE tor-data-bolla(1:8) TO tordini-k3-SPLITBUF(5:8)
           MOVE tor-num-bolla(1:8) TO tordini-k3-SPLITBUF(13:8)
           MOVE tor-bolla-prenotata(1:1) TO tordini-k3-SPLITBUF(21:1)
           .

       tordini-k-fattura-MERGE-SPLITBUF.
           INITIALIZE tordini-k-fattura-SPLITBUF
           MOVE tor-anno-fattura(1:4) TO tordini-k-fattura-SPLITBUF(1:4)
           MOVE tor-num-fattura(1:8) TO tordini-k-fattura-SPLITBUF(5:8)
           .

       tordini-k4-MERGE-SPLITBUF.
           INITIALIZE tordini-k4-SPLITBUF
           MOVE tor-anno-fattura(1:4) TO tordini-k4-SPLITBUF(1:4)
           MOVE tor-data-fattura(1:8) TO tordini-k4-SPLITBUF(5:8)
           MOVE tor-num-fattura(1:8) TO tordini-k4-SPLITBUF(13:8)
           MOVE tor-num-prenot(1:8) TO tordini-k4-SPLITBUF(21:8)
           MOVE tor-fatt-prenotata(1:1) TO tordini-k4-SPLITBUF(29:1)
           .

       tordini-k-contab-MERGE-SPLITBUF.
           INITIALIZE tordini-k-contab-SPLITBUF
           MOVE tor-agg-contab(1:1) TO tordini-k-contab-SPLITBUF(1:1)
           MOVE tor-anno-fattura(1:4) TO tordini-k-contab-SPLITBUF(2:4)
           MOVE tor-num-fattura(1:8) TO tordini-k-contab-SPLITBUF(6:8)
           .

       tordini-k-tipo-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tipo-SPLITBUF
           MOVE tor-tipo(1:1) TO tordini-k-tipo-SPLITBUF(1:1)
           MOVE tor-chiave(1:12) TO tordini-k-tipo-SPLITBUF(2:12)
           .

       tordini-k-data-MERGE-SPLITBUF.
           INITIALIZE tordini-k-data-SPLITBUF
           MOVE tor-data-creazione(1:8) TO tordini-k-data-SPLITBUF(1:8)
           MOVE tor-numero(1:8) TO tordini-k-data-SPLITBUF(9:8)
           .

       tordini-k-agfatt-MERGE-SPLITBUF.
           INITIALIZE tordini-k-agfatt-SPLITBUF
           MOVE tor-anno-fattura(1:4) TO tordini-k-agfatt-SPLITBUF(1:4)
           MOVE tor-data-fattura(1:8) TO tordini-k-agfatt-SPLITBUF(5:8)
           MOVE tor-num-fattura(1:8) TO tordini-k-agfatt-SPLITBUF(13:8)
           MOVE tor-num-prenot(1:8) TO tordini-k-agfatt-SPLITBUF(21:8)
           MOVE tor-fatt-prenotata(1:1) TO 
           tordini-k-agfatt-SPLITBUF(29:1)
           MOVE tor-chiave(1:12) TO tordini-k-agfatt-SPLITBUF(30:12)
           .

       tordini-k-stbolle-MERGE-SPLITBUF.
           INITIALIZE tordini-k-stbolle-SPLITBUF
           MOVE tor-anno-bolla(1:4) TO tordini-k-stbolle-SPLITBUF(1:4)
           MOVE tor-data-bolla(1:8) TO tordini-k-stbolle-SPLITBUF(5:8)
           MOVE tor-num-bolla(1:8) TO tordini-k-stbolle-SPLITBUF(13:8)
           MOVE tor-bolla-prenotata(1:1) TO 
           tordini-k-stbolle-SPLITBUF(21:1)
           MOVE tor-chiave(1:12) TO tordini-k-stbolle-SPLITBUF(22:12)
           .

       tordini-k-andamento-data-MERGE-SPLITBUF.
           INITIALIZE tordini-k-andamento-data-SPLITBUF
           MOVE tor-agg-contab(1:1) TO 
           tordini-k-andamento-data-SPLITBUF(1:1)
           MOVE tor-data-fattura(1:8) TO 
           tordini-k-andamento-data-SPLITBUF(2:8)
           .

       tordini-k-andamento-cliente-MERGE-SPLITBUF.
           INITIALIZE tordini-k-andamento-cliente-SPLITBUF
           MOVE tor-cod-cli(1:5) TO 
           tordini-k-andamento-cliente-SPLITBUF(1:5)
           MOVE tor-agg-contab(1:1) TO 
           tordini-k-andamento-cliente-SPLITBUF(6:1)
           MOVE tor-data-fattura(1:8) TO 
           tordini-k-andamento-cliente-SPLITBUF(7:8)
           .

       tordini-k-andamento-clides-MERGE-SPLITBUF.
           INITIALIZE tordini-k-andamento-clides-SPLITBUF
           MOVE tor-cod-cli(1:5) TO 
           tordini-k-andamento-clides-SPLITBUF(1:5)
           MOVE tor-prg-destino(1:5) TO 
           tordini-k-andamento-clides-SPLITBUF(6:5)
           MOVE tor-agg-contab(1:1) TO 
           tordini-k-andamento-clides-SPLITBUF(11:1)
           MOVE tor-data-fattura(1:8) TO 
           tordini-k-andamento-clides-SPLITBUF(12:8)
           .

       tordini-k-promo-MERGE-SPLITBUF.
           INITIALIZE tordini-k-promo-SPLITBUF
           MOVE tor-stato(1:1) TO tordini-k-promo-SPLITBUF(1:1)
           MOVE tor-promo(1:1) TO tordini-k-promo-SPLITBUF(2:1)
           MOVE tor-data-ordine(1:8) TO tordini-k-promo-SPLITBUF(3:8)
           MOVE tor-numero(1:8) TO tordini-k-promo-SPLITBUF(11:8)
           MOVE tor-cod-cli(1:5) TO tordini-k-promo-SPLITBUF(19:5)
           MOVE tor-prg-destino(1:5) TO tordini-k-promo-SPLITBUF(24:5)
           .

       tordini-k-or-MERGE-SPLITBUF.
           INITIALIZE tordini-k-or-SPLITBUF
           MOVE tor-cod-cli(1:5) TO tordini-k-or-SPLITBUF(1:5)
           MOVE tor-prg-destino(1:5) TO tordini-k-or-SPLITBUF(6:5)
           MOVE tor-num-ord-cli(1:10) TO tordini-k-or-SPLITBUF(11:10)
           .

       tordini-k-tor-inviare-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tor-inviare-SPLITBUF
           MOVE tor-da-inviare OF tordini(1:1) TO 
           tordini-k-tor-inviare-SPLITBUF(1:1)
           MOVE tor-chiave OF tordini(1:12) TO 
           tordini-k-tor-inviare-SPLITBUF(2:12)
           .

       tordini-k-tor-tipocli-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tor-tipocli-SPLITBUF
           MOVE tor-tipocli OF tordini(1:2) TO 
           tordini-k-tor-tipocli-SPLITBUF(1:2)
           MOVE tor-cod-cli OF tordini(1:5) TO 
           tordini-k-tor-tipocli-SPLITBUF(3:5)
           MOVE tor-prg-destino OF tordini(1:5) TO 
           tordini-k-tor-tipocli-SPLITBUF(8:5)
           MOVE tor-chiave OF tordini(1:12) TO 
           tordini-k-tor-tipocli-SPLITBUF(13:12)
           .

       tordini-k-tor-gdo-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tor-gdo-SPLITBUF
           MOVE tor-gdo OF tordini(1:5) TO 
           tordini-k-tor-gdo-SPLITBUF(1:5)
           MOVE tor-cod-cli OF tordini(1:5) TO 
           tordini-k-tor-gdo-SPLITBUF(6:5)
           MOVE tor-prg-destino OF tordini(1:5) TO 
           tordini-k-tor-gdo-SPLITBUF(11:5)
           MOVE tor-chiave OF tordini(1:12) TO 
           tordini-k-tor-gdo-SPLITBUF(16:12)
           .

       DataSet1-tordini-INITSTART.
           IF DataSet1-tordini-KEY-Asc
              MOVE Low-Value TO tor-chiave
           ELSE
              MOVE High-Value TO tor-chiave
           END-IF
           .

       DataSet1-tordini-INITEND.
           IF DataSet1-tordini-KEY-Asc
              MOVE High-Value TO tor-chiave
           ELSE
              MOVE Low-Value TO tor-chiave
           END-IF
           .

      * tordini
       DataSet1-tordini-START.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY >= tor-chiave
           ELSE
              START tordini KEY <= tor-chiave
           END-IF
           .

       DataSet1-tordini-START-NOTGREATER.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY <= tor-chiave
           ELSE
              START tordini KEY >= tor-chiave
           END-IF
           .

       DataSet1-tordini-START-GREATER.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY > tor-chiave
           ELSE
              START tordini KEY < tor-chiave
           END-IF
           .

       DataSet1-tordini-START-LESS.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY < tor-chiave
           ELSE
              START tordini KEY > tor-chiave
           END-IF
           .

       DataSet1-tordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tordini-LOCK
              READ tordini WITH LOCK 
              KEY tor-chiave
           ELSE
              READ tordini WITH NO LOCK 
              KEY tor-chiave
           END-IF
           PERFORM tordini-k-causale-MERGE-SPLITBUF
           PERFORM tordini-k1-MERGE-SPLITBUF
           PERFORM tordini-k2-MERGE-SPLITBUF
           PERFORM tordini-k-bolla-MERGE-SPLITBUF
           PERFORM tordini-k3-MERGE-SPLITBUF
           PERFORM tordini-k-fattura-MERGE-SPLITBUF
           PERFORM tordini-k4-MERGE-SPLITBUF
           PERFORM tordini-k-contab-MERGE-SPLITBUF
           PERFORM tordini-k-tipo-MERGE-SPLITBUF
           PERFORM tordini-k-data-MERGE-SPLITBUF
           PERFORM tordini-k-agfatt-MERGE-SPLITBUF
           PERFORM tordini-k-stbolle-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-data-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-clides-MERGE-SPLITBUF
           PERFORM tordini-k-promo-MERGE-SPLITBUF
           PERFORM tordini-k-or-MERGE-SPLITBUF
           PERFORM tordini-k-tor-inviare-MERGE-SPLITBUF
           PERFORM tordini-k-tor-tipocli-MERGE-SPLITBUF
           PERFORM tordini-k-tor-gdo-MERGE-SPLITBUF
           MOVE STATUS-tordini TO TOTEM-ERR-STAT 
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tordini-KEY-Asc
              IF DataSet1-tordini-LOCK
                 READ tordini NEXT WITH LOCK
              ELSE
                 READ tordini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tordini-LOCK
                 READ tordini PREVIOUS WITH LOCK
              ELSE
                 READ tordini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tordini-k-causale-MERGE-SPLITBUF
           PERFORM tordini-k1-MERGE-SPLITBUF
           PERFORM tordini-k2-MERGE-SPLITBUF
           PERFORM tordini-k-bolla-MERGE-SPLITBUF
           PERFORM tordini-k3-MERGE-SPLITBUF
           PERFORM tordini-k-fattura-MERGE-SPLITBUF
           PERFORM tordini-k4-MERGE-SPLITBUF
           PERFORM tordini-k-contab-MERGE-SPLITBUF
           PERFORM tordini-k-tipo-MERGE-SPLITBUF
           PERFORM tordini-k-data-MERGE-SPLITBUF
           PERFORM tordini-k-agfatt-MERGE-SPLITBUF
           PERFORM tordini-k-stbolle-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-data-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-clides-MERGE-SPLITBUF
           PERFORM tordini-k-promo-MERGE-SPLITBUF
           PERFORM tordini-k-or-MERGE-SPLITBUF
           PERFORM tordini-k-tor-inviare-MERGE-SPLITBUF
           PERFORM tordini-k-tor-tipocli-MERGE-SPLITBUF
           PERFORM tordini-k-tor-gdo-MERGE-SPLITBUF
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tordini-KEY-Asc
              IF DataSet1-tordini-LOCK
                 READ tordini PREVIOUS WITH LOCK
              ELSE
                 READ tordini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tordini-LOCK
                 READ tordini NEXT WITH LOCK
              ELSE
                 READ tordini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tordini-k-causale-MERGE-SPLITBUF
           PERFORM tordini-k1-MERGE-SPLITBUF
           PERFORM tordini-k2-MERGE-SPLITBUF
           PERFORM tordini-k-bolla-MERGE-SPLITBUF
           PERFORM tordini-k3-MERGE-SPLITBUF
           PERFORM tordini-k-fattura-MERGE-SPLITBUF
           PERFORM tordini-k4-MERGE-SPLITBUF
           PERFORM tordini-k-contab-MERGE-SPLITBUF
           PERFORM tordini-k-tipo-MERGE-SPLITBUF
           PERFORM tordini-k-data-MERGE-SPLITBUF
           PERFORM tordini-k-agfatt-MERGE-SPLITBUF
           PERFORM tordini-k-stbolle-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-data-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-clides-MERGE-SPLITBUF
           PERFORM tordini-k-promo-MERGE-SPLITBUF
           PERFORM tordini-k-or-MERGE-SPLITBUF
           PERFORM tordini-k-tor-inviare-MERGE-SPLITBUF
           PERFORM tordini-k-tor-tipocli-MERGE-SPLITBUF
           PERFORM tordini-k-tor-gdo-MERGE-SPLITBUF
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterDelete>
      * <TOTEM:END>
           .

       rordini-ror-k-promo-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-promo-SPLITBUF
           MOVE ror-promo OF rordini(1:15) TO 
           rordini-ror-k-promo-SPLITBUF(1:15)
           .

       rordini-ror-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-articolo-SPLITBUF
           MOVE ror-cod-articolo OF rordini(1:6) TO 
           rordini-ror-k-articolo-SPLITBUF(1:6)
           MOVE ror-chiave OF rordini(1:17) TO 
           rordini-ror-k-articolo-SPLITBUF(7:17)
           .

       rordini-ror-k-master-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-master-SPLITBUF
           MOVE ror-chiave-ordine OF rordini(1:17) TO 
           rordini-ror-k-master-SPLITBUF(1:17)
           MOVE ror-chiave OF rordini(1:17) TO 
           rordini-ror-k-master-SPLITBUF(18:17)
           .

       rordini-ror-k-stbolle-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-stbolle-SPLITBUF
           MOVE ror-anno OF rordini(1:4) TO 
           rordini-ror-k-stbolle-SPLITBUF(1:4)
           MOVE ror-num-ordine OF rordini(1:8) TO 
           rordini-ror-k-stbolle-SPLITBUF(5:8)
           MOVE ror-chiave-ordine OF rordini(1:17) TO 
           rordini-ror-k-stbolle-SPLITBUF(13:17)
           .

       DataSet1-rordini-INITSTART.
           IF DataSet1-rordini-KEY-Asc
              MOVE Low-Value TO ror-chiave OF rordini
           ELSE
              MOVE High-Value TO ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-INITEND.
           IF DataSet1-rordini-KEY-Asc
              MOVE High-Value TO ror-chiave OF rordini
           ELSE
              MOVE Low-Value TO ror-chiave OF rordini
           END-IF
           .

      * rordini
       DataSet1-rordini-START.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY >= ror-chiave OF rordini
           ELSE
              START rordini KEY <= ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-START-NOTGREATER.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY <= ror-chiave OF rordini
           ELSE
              START rordini KEY >= ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-START-GREATER.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY > ror-chiave OF rordini
           ELSE
              START rordini KEY < ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-START-LESS.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY < ror-chiave OF rordini
           ELSE
              START rordini KEY > ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rordini-LOCK
              READ rordini WITH LOCK 
              KEY ror-chiave OF rordini
           ELSE
              READ rordini WITH NO LOCK 
              KEY ror-chiave OF rordini
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT 
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rordini-KEY-Asc
              IF DataSet1-rordini-LOCK
                 READ rordini NEXT WITH LOCK
              ELSE
                 READ rordini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordini-LOCK
                 READ rordini PREVIOUS WITH LOCK
              ELSE
                 READ rordini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rordini-KEY-Asc
              IF DataSet1-rordini-LOCK
                 READ rordini PREVIOUS WITH LOCK
              ELSE
                 READ rordini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordini-LOCK
                 READ rordini NEXT WITH LOCK
              ELSE
                 READ rordini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-zoom-tor-master-INITSTART.
           IF DataSet1-zoom-tor-master-KEY-Asc
              MOVE Low-Value TO ztm-chiave
           ELSE
              MOVE High-Value TO ztm-chiave
           END-IF
           .

       DataSet1-zoom-tor-master-INITEND.
           IF DataSet1-zoom-tor-master-KEY-Asc
              MOVE High-Value TO ztm-chiave
           ELSE
              MOVE Low-Value TO ztm-chiave
           END-IF
           .

      * zoom-tor-master
       DataSet1-zoom-tor-master-START.
           IF DataSet1-zoom-tor-master-KEY-Asc
              START zoom-tor-master KEY >= ztm-chiave
           ELSE
              START zoom-tor-master KEY <= ztm-chiave
           END-IF
           .

       DataSet1-zoom-tor-master-START-NOTGREATER.
           IF DataSet1-zoom-tor-master-KEY-Asc
              START zoom-tor-master KEY <= ztm-chiave
           ELSE
              START zoom-tor-master KEY >= ztm-chiave
           END-IF
           .

       DataSet1-zoom-tor-master-START-GREATER.
           IF DataSet1-zoom-tor-master-KEY-Asc
              START zoom-tor-master KEY > ztm-chiave
           ELSE
              START zoom-tor-master KEY < ztm-chiave
           END-IF
           .

       DataSet1-zoom-tor-master-START-LESS.
           IF DataSet1-zoom-tor-master-KEY-Asc
              START zoom-tor-master KEY < ztm-chiave
           ELSE
              START zoom-tor-master KEY > ztm-chiave
           END-IF
           .

       DataSet1-zoom-tor-master-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-zoom-tor-master-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-zoom-tor-master-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-zoom-tor-master-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, BeforeWrite>
      * <TOTEM:END>
           WRITE ztm-rec OF zoom-tor-master.
           MOVE STATUS-zoom-tor-master TO TOTEM-ERR-STAT
           MOVE "zoom-tor-master" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-tor-master-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-zoom-tor-master TO TOTEM-ERR-STAT
           MOVE "zoom-tor-master" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-tor-master-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-zoom-tor-master TO TOTEM-ERR-STAT
           MOVE "zoom-tor-master" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tor-master, AfterDelete>
      * <TOTEM:END>
           .

       locali-loc-chiave-gdo-fine-MERGE-SPLITBUF.
           INITIALIZE locali-loc-chiave-gdo-fine-SPLITBUF
           MOVE loc-gdo(1:5) TO locali-loc-chiave-gdo-fine-SPLITBUF(1:5)
           MOVE loc-cliente(1:5) TO 
           locali-loc-chiave-gdo-fine-SPLITBUF(6:5)
           MOVE loc-destino(1:5) TO 
           locali-loc-chiave-gdo-fine-SPLITBUF(11:5)
           MOVE loc-fine-dpo(1:8) TO 
           locali-loc-chiave-gdo-fine-SPLITBUF(16:8)
           MOVE loc-ini-dpo(1:8) TO 
           locali-loc-chiave-gdo-fine-SPLITBUF(24:8)
           .

       locali-loc-chiave-fine-MERGE-SPLITBUF.
           INITIALIZE locali-loc-chiave-fine-SPLITBUF
           MOVE loc-fine-dpo(1:8) TO 
           locali-loc-chiave-fine-SPLITBUF(1:8)
           MOVE loc-ini-dpo(1:8) TO locali-loc-chiave-fine-SPLITBUF(9:8)
           MOVE loc-gdo(1:5) TO locali-loc-chiave-fine-SPLITBUF(17:5)
           MOVE loc-cliente(1:5) TO 
           locali-loc-chiave-fine-SPLITBUF(22:5)
           MOVE loc-destino(1:5) TO 
           locali-loc-chiave-fine-SPLITBUF(27:5)
           .

       locali-loc-chiave-ini-MERGE-SPLITBUF.
           INITIALIZE locali-loc-chiave-ini-SPLITBUF
           MOVE loc-ini-dpo(1:8) TO locali-loc-chiave-ini-SPLITBUF(1:8)
           MOVE loc-fine-dpo(1:8) TO locali-loc-chiave-ini-SPLITBUF(9:8)
           MOVE loc-gdo(1:5) TO locali-loc-chiave-ini-SPLITBUF(17:5)
           MOVE loc-cliente(1:5) TO locali-loc-chiave-ini-SPLITBUF(22:5)
           MOVE loc-destino(1:5) TO locali-loc-chiave-ini-SPLITBUF(27:5)
           .

       DataSet1-locali-INITSTART.
           IF DataSet1-locali-KEY-Asc
              MOVE Low-Value TO loc-chiave
           ELSE
              MOVE High-Value TO loc-chiave
           END-IF
           .

       DataSet1-locali-INITEND.
           IF DataSet1-locali-KEY-Asc
              MOVE High-Value TO loc-chiave
           ELSE
              MOVE Low-Value TO loc-chiave
           END-IF
           .

      * locali
       DataSet1-locali-START.
           IF DataSet1-locali-KEY-Asc
              START locali KEY >= loc-chiave
           ELSE
              START locali KEY <= loc-chiave
           END-IF
           .

       DataSet1-locali-START-NOTGREATER.
           IF DataSet1-locali-KEY-Asc
              START locali KEY <= loc-chiave
           ELSE
              START locali KEY >= loc-chiave
           END-IF
           .

       DataSet1-locali-START-GREATER.
           IF DataSet1-locali-KEY-Asc
              START locali KEY > loc-chiave
           ELSE
              START locali KEY < loc-chiave
           END-IF
           .

       DataSet1-locali-START-LESS.
           IF DataSet1-locali-KEY-Asc
              START locali KEY < loc-chiave
           ELSE
              START locali KEY > loc-chiave
           END-IF
           .

       DataSet1-locali-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-locali-LOCK
              READ locali WITH LOCK 
              KEY loc-chiave
           ELSE
              READ locali WITH NO LOCK 
              KEY loc-chiave
           END-IF
           PERFORM locali-loc-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-ini-MERGE-SPLITBUF
           MOVE STATUS-locali TO TOTEM-ERR-STAT 
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-locali-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-locali-KEY-Asc
              IF DataSet1-locali-LOCK
                 READ locali NEXT WITH LOCK
              ELSE
                 READ locali NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-locali-LOCK
                 READ locali PREVIOUS WITH LOCK
              ELSE
                 READ locali PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM locali-loc-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-ini-MERGE-SPLITBUF
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-locali-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-locali-KEY-Asc
              IF DataSet1-locali-LOCK
                 READ locali PREVIOUS WITH LOCK
              ELSE
                 READ locali PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-locali-LOCK
                 READ locali NEXT WITH LOCK
              ELSE
                 READ locali NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM locali-loc-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-ini-MERGE-SPLITBUF
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-locali-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-locali-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-locali-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterDelete>
      * <TOTEM:END>
           .

       rpromo-k-stampa-MERGE-SPLITBUF.
           INITIALIZE rpromo-k-stampa-SPLITBUF
           MOVE rpr-codice(1:15) TO rpromo-k-stampa-SPLITBUF(1:15)
           MOVE rpr-data-creazione(1:8) TO 
           rpromo-k-stampa-SPLITBUF(16:8)
           MOVE rpr-ora-creazione(1:8) TO rpromo-k-stampa-SPLITBUF(24:8)
           .

       DataSet1-rpromo-INITSTART.
           IF DataSet1-rpromo-KEY-Asc
              MOVE Low-Value TO rpr-chiave
           ELSE
              MOVE High-Value TO rpr-chiave
           END-IF
           .

       DataSet1-rpromo-INITEND.
           IF DataSet1-rpromo-KEY-Asc
              MOVE High-Value TO rpr-chiave
           ELSE
              MOVE Low-Value TO rpr-chiave
           END-IF
           .

      * rpromo
       DataSet1-rpromo-START.
           IF DataSet1-rpromo-KEY-Asc
              START rpromo KEY >= rpr-chiave
           ELSE
              START rpromo KEY <= rpr-chiave
           END-IF
           .

       DataSet1-rpromo-START-NOTGREATER.
           IF DataSet1-rpromo-KEY-Asc
              START rpromo KEY <= rpr-chiave
           ELSE
              START rpromo KEY >= rpr-chiave
           END-IF
           .

       DataSet1-rpromo-START-GREATER.
           IF DataSet1-rpromo-KEY-Asc
              START rpromo KEY > rpr-chiave
           ELSE
              START rpromo KEY < rpr-chiave
           END-IF
           .

       DataSet1-rpromo-START-LESS.
           IF DataSet1-rpromo-KEY-Asc
              START rpromo KEY < rpr-chiave
           ELSE
              START rpromo KEY > rpr-chiave
           END-IF
           .

       DataSet1-rpromo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rpromo-LOCK
              READ rpromo WITH LOCK 
              KEY rpr-chiave
           ELSE
              READ rpromo WITH NO LOCK 
              KEY rpr-chiave
           END-IF
           PERFORM rpromo-k-stampa-MERGE-SPLITBUF
           MOVE STATUS-rpromo TO TOTEM-ERR-STAT 
           MOVE "rpromo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rpromo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rpromo-KEY-Asc
              IF DataSet1-rpromo-LOCK
                 READ rpromo NEXT WITH LOCK
              ELSE
                 READ rpromo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rpromo-LOCK
                 READ rpromo PREVIOUS WITH LOCK
              ELSE
                 READ rpromo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rpromo-k-stampa-MERGE-SPLITBUF
           MOVE STATUS-rpromo TO TOTEM-ERR-STAT
           MOVE "rpromo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rpromo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rpromo-KEY-Asc
              IF DataSet1-rpromo-LOCK
                 READ rpromo PREVIOUS WITH LOCK
              ELSE
                 READ rpromo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rpromo-LOCK
                 READ rpromo NEXT WITH LOCK
              ELSE
                 READ rpromo NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rpromo-k-stampa-MERGE-SPLITBUF
           MOVE STATUS-rpromo TO TOTEM-ERR-STAT
           MOVE "rpromo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rpromo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, BeforeWrite>
      * <TOTEM:END>
           WRITE rpr-rec OF rpromo.
           MOVE STATUS-rpromo TO TOTEM-ERR-STAT
           MOVE "rpromo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rpromo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, BeforeRewrite>
      * <TOTEM:END>
           REWRITE rpr-rec OF rpromo.
           MOVE STATUS-rpromo TO TOTEM-ERR-STAT
           MOVE "rpromo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rpromo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, BeforeDelete>
      * <TOTEM:END>
           DELETE rpromo.
           MOVE STATUS-rpromo TO TOTEM-ERR-STAT
           MOVE "rpromo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rpromo, AfterDelete>
      * <TOTEM:END>
           .

       tpromo-tpr-chiave-ricerca-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-ricerca-SPLITBUF
           MOVE tpr-chiave-ricerca OF tpromo(1:21) TO 
           tpromo-tpr-chiave-ricerca-SPLITBUF(1:21)
           .

       tpromo-tpr-chiave-gdo-fine-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-gdo-fine-SPLITBUF
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-chiave-gdo-fine-SPLITBUF(1:5)
           MOVE tpr-fine-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-gdo-fine-SPLITBUF(6:8)
           MOVE tpr-ini-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-gdo-fine-SPLITBUF(14:8)
           .

       tpromo-tpr-chiave-fine-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-fine-SPLITBUF
           MOVE tpr-fine-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-fine-SPLITBUF(1:8)
           MOVE tpr-ini-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-fine-SPLITBUF(9:8)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-chiave-fine-SPLITBUF(17:5)
           .

       tpromo-tpr-chiave-ini-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-ini-SPLITBUF
           MOVE tpr-ini-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-ini-SPLITBUF(1:8)
           MOVE tpr-fine-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-ini-SPLITBUF(9:8)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-chiave-ini-SPLITBUF(17:5)
           .

       tpromo-tpr-chiave-volantino-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-volantino-SPLITBUF
           MOVE tpr-ini-volantino OF tpromo(1:8) TO 
           tpromo-tpr-chiave-volantino-SPLITBUF(1:8)
           MOVE tpr-fine-volantino OF tpromo(1:8) TO 
           tpromo-tpr-chiave-volantino-SPLITBUF(9:8)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-chiave-volantino-SPLITBUF(17:5)
           .

       tpromo-tpr-k-fine-vol-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-k-fine-vol-SPLITBUF
           MOVE tpr-fine-volantino OF tpromo(1:8) TO 
           tpromo-tpr-k-fine-vol-SPLITBUF(1:8)
           MOVE tpr-ini-volantino OF tpromo(1:8) TO 
           tpromo-tpr-k-fine-vol-SPLITBUF(9:8)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-k-fine-vol-SPLITBUF(17:5)
           .

       tpromo-tpr-k-data-ins-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-k-data-ins-SPLITBUF
           MOVE tpr-data-creazione OF tpromo(1:8) TO 
           tpromo-tpr-k-data-ins-SPLITBUF(1:8)
           MOVE tpr-codice OF tpromo(1:15) TO 
           tpromo-tpr-k-data-ins-SPLITBUF(9:15)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-k-data-ins-SPLITBUF(24:5)
           .

       DataSet1-tpromo-INITSTART.
           IF DataSet1-tpromo-KEY-Asc
              MOVE Low-Value TO tpr-chiave OF tpromo
           ELSE
              MOVE High-Value TO tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-INITEND.
           IF DataSet1-tpromo-KEY-Asc
              MOVE High-Value TO tpr-chiave OF tpromo
           ELSE
              MOVE Low-Value TO tpr-chiave OF tpromo
           END-IF
           .

      * tpromo
       DataSet1-tpromo-START.
           IF DataSet1-tpromo-KEY-Asc
              START tpromo KEY >= tpr-chiave OF tpromo
           ELSE
              START tpromo KEY <= tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-START-NOTGREATER.
           IF DataSet1-tpromo-KEY-Asc
              START tpromo KEY <= tpr-chiave OF tpromo
           ELSE
              START tpromo KEY >= tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-START-GREATER.
           IF DataSet1-tpromo-KEY-Asc
              START tpromo KEY > tpr-chiave OF tpromo
           ELSE
              START tpromo KEY < tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-START-LESS.
           IF DataSet1-tpromo-KEY-Asc
              START tpromo KEY < tpr-chiave OF tpromo
           ELSE
              START tpromo KEY > tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tpromo-LOCK
              READ tpromo WITH LOCK 
              KEY tpr-chiave OF tpromo
           ELSE
              READ tpromo WITH NO LOCK 
              KEY tpr-chiave OF tpromo
           END-IF
           PERFORM tpromo-tpr-chiave-ricerca-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-ini-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-volantino-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-fine-vol-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-data-ins-MERGE-SPLITBUF
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT 
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tpromo-KEY-Asc
              IF DataSet1-tpromo-LOCK
                 READ tpromo NEXT WITH LOCK
              ELSE
                 READ tpromo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpromo-LOCK
                 READ tpromo PREVIOUS WITH LOCK
              ELSE
                 READ tpromo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tpromo-tpr-chiave-ricerca-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-ini-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-volantino-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-fine-vol-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-data-ins-MERGE-SPLITBUF
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tpromo-KEY-Asc
              IF DataSet1-tpromo-LOCK
                 READ tpromo PREVIOUS WITH LOCK
              ELSE
                 READ tpromo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpromo-LOCK
                 READ tpromo NEXT WITH LOCK
              ELSE
                 READ tpromo NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tpromo-tpr-chiave-ricerca-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-ini-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-volantino-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-fine-vol-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-data-ins-MERGE-SPLITBUF
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeWrite>
      * <TOTEM:END>
           WRITE tpr-rec OF tpromo.
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeRewrite>
      * <TOTEM:END>
           REWRITE tpr-rec OF tpromo.
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeDelete>
      * <TOTEM:END>
           DELETE tpromo.
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmp-promo-prz-INITSTART.
           IF DataSet1-tmp-promo-prz-KEY-Asc
              MOVE Low-Value TO tprz-chiave
           ELSE
              MOVE High-Value TO tprz-chiave
           END-IF
           .

       DataSet1-tmp-promo-prz-INITEND.
           IF DataSet1-tmp-promo-prz-KEY-Asc
              MOVE High-Value TO tprz-chiave
           ELSE
              MOVE Low-Value TO tprz-chiave
           END-IF
           .

      * tmp-promo-prz
       DataSet1-tmp-promo-prz-START.
           IF DataSet1-tmp-promo-prz-KEY-Asc
              START tmp-promo-prz KEY >= tprz-chiave
           ELSE
              START tmp-promo-prz KEY <= tprz-chiave
           END-IF
           .

       DataSet1-tmp-promo-prz-START-NOTGREATER.
           IF DataSet1-tmp-promo-prz-KEY-Asc
              START tmp-promo-prz KEY <= tprz-chiave
           ELSE
              START tmp-promo-prz KEY >= tprz-chiave
           END-IF
           .

       DataSet1-tmp-promo-prz-START-GREATER.
           IF DataSet1-tmp-promo-prz-KEY-Asc
              START tmp-promo-prz KEY > tprz-chiave
           ELSE
              START tmp-promo-prz KEY < tprz-chiave
           END-IF
           .

       DataSet1-tmp-promo-prz-START-LESS.
           IF DataSet1-tmp-promo-prz-KEY-Asc
              START tmp-promo-prz KEY < tprz-chiave
           ELSE
              START tmp-promo-prz KEY > tprz-chiave
           END-IF
           .

       DataSet1-tmp-promo-prz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-promo-prz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-promo-prz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-promo-prz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, BeforeWrite>
      * <TOTEM:END>
           WRITE tprz-rec OF tmp-promo-prz.
           MOVE STATUS-tmp-promo-prz TO TOTEM-ERR-STAT
           MOVE "tmp-promo-prz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-promo-prz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-promo-prz TO TOTEM-ERR-STAT
           MOVE "tmp-promo-prz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-promo-prz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-promo-prz TO TOTEM-ERR-STAT
           MOVE "tmp-promo-prz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-promo-prz, AfterDelete>
      * <TOTEM:END>
           .

       listini-lst-k-articolo-MERGE-SPLITBUF.
           INITIALIZE listini-lst-k-articolo-SPLITBUF
           MOVE lst-gdo OF listini(1:5) TO 
           listini-lst-k-articolo-SPLITBUF(1:5)
           MOVE lst-articolo OF listini(1:6) TO 
           listini-lst-k-articolo-SPLITBUF(6:6)
           MOVE lst-data OF listini(1:8) TO 
           listini-lst-k-articolo-SPLITBUF(12:8)
           .

       listini-lst-k-cod-art-cli-MERGE-SPLITBUF.
           INITIALIZE listini-lst-k-cod-art-cli-SPLITBUF
           MOVE lst-gdo OF listini(1:5) TO 
           listini-lst-k-cod-art-cli-SPLITBUF(1:5)
           MOVE lst-cod-art-cli OF listini(1:15) TO 
           listini-lst-k-cod-art-cli-SPLITBUF(6:15)
           MOVE lst-data OF listini(1:8) TO 
           listini-lst-k-cod-art-cli-SPLITBUF(21:8)
           .

       DataSet1-listini-INITSTART.
           IF DataSet1-listini-KEY-Asc
              MOVE Low-Value TO lst-chiave OF listini
           ELSE
              MOVE High-Value TO lst-chiave OF listini
           END-IF
           .

       DataSet1-listini-INITEND.
           IF DataSet1-listini-KEY-Asc
              MOVE High-Value TO lst-chiave OF listini
           ELSE
              MOVE Low-Value TO lst-chiave OF listini
           END-IF
           .

      * listini
       DataSet1-listini-START.
           IF DataSet1-listini-KEY-Asc
              START listini KEY >= lst-chiave OF listini
           ELSE
              START listini KEY <= lst-chiave OF listini
           END-IF
           .

       DataSet1-listini-START-NOTGREATER.
           IF DataSet1-listini-KEY-Asc
              START listini KEY <= lst-chiave OF listini
           ELSE
              START listini KEY >= lst-chiave OF listini
           END-IF
           .

       DataSet1-listini-START-GREATER.
           IF DataSet1-listini-KEY-Asc
              START listini KEY > lst-chiave OF listini
           ELSE
              START listini KEY < lst-chiave OF listini
           END-IF
           .

       DataSet1-listini-START-LESS.
           IF DataSet1-listini-KEY-Asc
              START listini KEY < lst-chiave OF listini
           ELSE
              START listini KEY > lst-chiave OF listini
           END-IF
           .

       DataSet1-listini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:listini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:listini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-listini-LOCK
              READ listini WITH LOCK 
              KEY lst-chiave OF listini
           ELSE
              READ listini WITH NO LOCK 
              KEY lst-chiave OF listini
           END-IF
           PERFORM listini-lst-k-articolo-MERGE-SPLITBUF
           PERFORM listini-lst-k-cod-art-cli-MERGE-SPLITBUF
           MOVE STATUS-listini TO TOTEM-ERR-STAT 
           MOVE "listini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:listini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:listini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-listini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:listini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:listini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-listini-KEY-Asc
              IF DataSet1-listini-LOCK
                 READ listini NEXT WITH LOCK
              ELSE
                 READ listini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-listini-LOCK
                 READ listini PREVIOUS WITH LOCK
              ELSE
                 READ listini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM listini-lst-k-articolo-MERGE-SPLITBUF
           PERFORM listini-lst-k-cod-art-cli-MERGE-SPLITBUF
           MOVE STATUS-listini TO TOTEM-ERR-STAT
           MOVE "listini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:listini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:listini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-listini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:listini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:listini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-listini-KEY-Asc
              IF DataSet1-listini-LOCK
                 READ listini PREVIOUS WITH LOCK
              ELSE
                 READ listini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-listini-LOCK
                 READ listini NEXT WITH LOCK
              ELSE
                 READ listini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM listini-lst-k-articolo-MERGE-SPLITBUF
           PERFORM listini-lst-k-cod-art-cli-MERGE-SPLITBUF
           MOVE STATUS-listini TO TOTEM-ERR-STAT
           MOVE "listini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:listini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:listini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-listini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:listini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-listini TO TOTEM-ERR-STAT
           MOVE "listini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:listini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-listini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:listini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-listini TO TOTEM-ERR-STAT
           MOVE "listini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:listini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-listini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:listini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-listini TO TOTEM-ERR-STAT
           MOVE "listini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:listini, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-sitfin-INITSTART.
           IF DataSet1-sitfin-KEY-Asc
              MOVE Low-Value TO sf-chiave
           ELSE
              MOVE High-Value TO sf-chiave
           END-IF
           .

       DataSet1-sitfin-INITEND.
           IF DataSet1-sitfin-KEY-Asc
              MOVE High-Value TO sf-chiave
           ELSE
              MOVE Low-Value TO sf-chiave
           END-IF
           .

      * sitfin
       DataSet1-sitfin-START.
           IF DataSet1-sitfin-KEY-Asc
              START sitfin KEY >= sf-chiave
           ELSE
              START sitfin KEY <= sf-chiave
           END-IF
           .

       DataSet1-sitfin-START-NOTGREATER.
           IF DataSet1-sitfin-KEY-Asc
              START sitfin KEY <= sf-chiave
           ELSE
              START sitfin KEY >= sf-chiave
           END-IF
           .

       DataSet1-sitfin-START-GREATER.
           IF DataSet1-sitfin-KEY-Asc
              START sitfin KEY > sf-chiave
           ELSE
              START sitfin KEY < sf-chiave
           END-IF
           .

       DataSet1-sitfin-START-LESS.
           IF DataSet1-sitfin-KEY-Asc
              START sitfin KEY < sf-chiave
           ELSE
              START sitfin KEY > sf-chiave
           END-IF
           .

       DataSet1-sitfin-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-sitfin-LOCK
              READ sitfin WITH LOCK 
              KEY sf-chiave
           ELSE
              READ sitfin WITH NO LOCK 
              KEY sf-chiave
           END-IF
           MOVE STATUS-sitfin TO TOTEM-ERR-STAT 
           MOVE "sitfin" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-sitfin-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-sitfin-KEY-Asc
              IF DataSet1-sitfin-LOCK
                 READ sitfin NEXT WITH LOCK
              ELSE
                 READ sitfin NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-sitfin-LOCK
                 READ sitfin PREVIOUS WITH LOCK
              ELSE
                 READ sitfin PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-sitfin TO TOTEM-ERR-STAT
           MOVE "sitfin" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-sitfin-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-sitfin-KEY-Asc
              IF DataSet1-sitfin-LOCK
                 READ sitfin PREVIOUS WITH LOCK
              ELSE
                 READ sitfin PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-sitfin-LOCK
                 READ sitfin NEXT WITH LOCK
              ELSE
                 READ sitfin NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-sitfin TO TOTEM-ERR-STAT
           MOVE "sitfin" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-sitfin-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-sitfin TO TOTEM-ERR-STAT
           MOVE "sitfin" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-sitfin-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-sitfin TO TOTEM-ERR-STAT
           MOVE "sitfin" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-sitfin-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-sitfin TO TOTEM-ERR-STAT
           MOVE "sitfin" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:sitfin, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tscorte-INITSTART.
           IF DataSet1-tscorte-KEY-Asc
              MOVE Low-Value TO sco-chiave
           ELSE
              MOVE High-Value TO sco-chiave
           END-IF
           .

       DataSet1-tscorte-INITEND.
           IF DataSet1-tscorte-KEY-Asc
              MOVE High-Value TO sco-chiave
           ELSE
              MOVE Low-Value TO sco-chiave
           END-IF
           .

      * tscorte
       DataSet1-tscorte-START.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY >= sco-chiave
           ELSE
              START tscorte KEY <= sco-chiave
           END-IF
           .

       DataSet1-tscorte-START-NOTGREATER.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY <= sco-chiave
           ELSE
              START tscorte KEY >= sco-chiave
           END-IF
           .

       DataSet1-tscorte-START-GREATER.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY > sco-chiave
           ELSE
              START tscorte KEY < sco-chiave
           END-IF
           .

       DataSet1-tscorte-START-LESS.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY < sco-chiave
           ELSE
              START tscorte KEY > sco-chiave
           END-IF
           .

       DataSet1-tscorte-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tscorte-LOCK
              READ tscorte WITH LOCK 
              KEY sco-chiave
           ELSE
              READ tscorte WITH NO LOCK 
              KEY sco-chiave
           END-IF
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT 
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tscorte-KEY-Asc
              IF DataSet1-tscorte-LOCK
                 READ tscorte NEXT WITH LOCK
              ELSE
                 READ tscorte NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tscorte-LOCK
                 READ tscorte PREVIOUS WITH LOCK
              ELSE
                 READ tscorte PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tscorte-KEY-Asc
              IF DataSet1-tscorte-LOCK
                 READ tscorte PREVIOUS WITH LOCK
              ELSE
                 READ tscorte PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tscorte-LOCK
                 READ tscorte NEXT WITH LOCK
              ELSE
                 READ tscorte NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-param-INITSTART.
           IF DataSet1-param-KEY-Asc
              MOVE Low-Value TO prm-chiave OF param
           ELSE
              MOVE High-Value TO prm-chiave OF param
           END-IF
           .

       DataSet1-param-INITEND.
           IF DataSet1-param-KEY-Asc
              MOVE High-Value TO prm-chiave OF param
           ELSE
              MOVE Low-Value TO prm-chiave OF param
           END-IF
           .

      * param
       DataSet1-param-START.
           IF DataSet1-param-KEY-Asc
              START param KEY >= prm-chiave OF param
           ELSE
              START param KEY <= prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-NOTGREATER.
           IF DataSet1-param-KEY-Asc
              START param KEY <= prm-chiave OF param
           ELSE
              START param KEY >= prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-GREATER.
           IF DataSet1-param-KEY-Asc
              START param KEY > prm-chiave OF param
           ELSE
              START param KEY < prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-LESS.
           IF DataSet1-param-KEY-Asc
              START param KEY < prm-chiave OF param
           ELSE
              START param KEY > prm-chiave OF param
           END-IF
           .

       DataSet1-param-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-param-LOCK
              READ param WITH LOCK 
              KEY prm-chiave OF param
           ELSE
              READ param WITH NO LOCK 
              KEY prm-chiave OF param
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT 
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-param-KEY-Asc
              IF DataSet1-param-LOCK
                 READ param NEXT WITH LOCK
              ELSE
                 READ param NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param-LOCK
                 READ param PREVIOUS WITH LOCK
              ELSE
                 READ param PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-param-KEY-Asc
              IF DataSet1-param-LOCK
                 READ param PREVIOUS WITH LOCK
              ELSE
                 READ param PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param-LOCK
                 READ param NEXT WITH LOCK
              ELSE
                 READ param NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-INITSTART.
           IF DataSet1-cli-prg-KEY-Asc
              MOVE Low-Value TO cp-chiave
           ELSE
              MOVE High-Value TO cp-chiave
           END-IF
           .

       DataSet1-cli-prg-INITEND.
           IF DataSet1-cli-prg-KEY-Asc
              MOVE High-Value TO cp-chiave
           ELSE
              MOVE Low-Value TO cp-chiave
           END-IF
           .

      * cli-prg
       DataSet1-cli-prg-START.
           IF DataSet1-cli-prg-KEY-Asc
              START cli-prg KEY >= cp-chiave
           ELSE
              START cli-prg KEY <= cp-chiave
           END-IF
           .

       DataSet1-cli-prg-START-NOTGREATER.
           IF DataSet1-cli-prg-KEY-Asc
              START cli-prg KEY <= cp-chiave
           ELSE
              START cli-prg KEY >= cp-chiave
           END-IF
           .

       DataSet1-cli-prg-START-GREATER.
           IF DataSet1-cli-prg-KEY-Asc
              START cli-prg KEY > cp-chiave
           ELSE
              START cli-prg KEY < cp-chiave
           END-IF
           .

       DataSet1-cli-prg-START-LESS.
           IF DataSet1-cli-prg-KEY-Asc
              START cli-prg KEY < cp-chiave
           ELSE
              START cli-prg KEY > cp-chiave
           END-IF
           .

       DataSet1-cli-prg-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-cli-prg-LOCK
              READ cli-prg WITH LOCK 
              KEY cp-chiave
           ELSE
              READ cli-prg WITH NO LOCK 
              KEY cp-chiave
           END-IF
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT 
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-cli-prg-KEY-Asc
              IF DataSet1-cli-prg-LOCK
                 READ cli-prg NEXT WITH LOCK
              ELSE
                 READ cli-prg NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-cli-prg-LOCK
                 READ cli-prg PREVIOUS WITH LOCK
              ELSE
                 READ cli-prg PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-cli-prg-KEY-Asc
              IF DataSet1-cli-prg-LOCK
                 READ cli-prg PREVIOUS WITH LOCK
              ELSE
                 READ cli-prg PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-cli-prg-LOCK
                 READ cli-prg NEXT WITH LOCK
              ELSE
                 READ cli-prg NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-cli-prg-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-cli-prg TO TOTEM-ERR-STAT
           MOVE "cli-prg" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:cli-prg, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-INITSTART.
           IF DataSet1-pagbloc-KEY-Asc
              MOVE Low-Value TO pgb-chiave
           ELSE
              MOVE High-Value TO pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-INITEND.
           IF DataSet1-pagbloc-KEY-Asc
              MOVE High-Value TO pgb-chiave
           ELSE
              MOVE Low-Value TO pgb-chiave
           END-IF
           .

      * pagbloc
       DataSet1-pagbloc-START.
           IF DataSet1-pagbloc-KEY-Asc
              START pagbloc KEY >= pgb-chiave
           ELSE
              START pagbloc KEY <= pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-START-NOTGREATER.
           IF DataSet1-pagbloc-KEY-Asc
              START pagbloc KEY <= pgb-chiave
           ELSE
              START pagbloc KEY >= pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-START-GREATER.
           IF DataSet1-pagbloc-KEY-Asc
              START pagbloc KEY > pgb-chiave
           ELSE
              START pagbloc KEY < pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-START-LESS.
           IF DataSet1-pagbloc-KEY-Asc
              START pagbloc KEY < pgb-chiave
           ELSE
              START pagbloc KEY > pgb-chiave
           END-IF
           .

       DataSet1-pagbloc-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-pagbloc-LOCK
              READ pagbloc WITH LOCK 
              KEY pgb-chiave
           ELSE
              READ pagbloc WITH NO LOCK 
              KEY pgb-chiave
           END-IF
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT 
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-pagbloc-KEY-Asc
              IF DataSet1-pagbloc-LOCK
                 READ pagbloc NEXT WITH LOCK
              ELSE
                 READ pagbloc NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-pagbloc-LOCK
                 READ pagbloc PREVIOUS WITH LOCK
              ELSE
                 READ pagbloc PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-pagbloc-KEY-Asc
              IF DataSet1-pagbloc-LOCK
                 READ pagbloc PREVIOUS WITH LOCK
              ELSE
                 READ pagbloc PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-pagbloc-LOCK
                 READ pagbloc NEXT WITH LOCK
              ELSE
                 READ pagbloc NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-pagbloc-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-pagbloc TO TOTEM-ERR-STAT
           MOVE "pagbloc" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:pagbloc, AfterDelete>
      * <TOTEM:END>
           .

       tordforn-tof-k-causale-MERGE-SPLITBUF.
           INITIALIZE tordforn-tof-k-causale-SPLITBUF
           MOVE tof-causale(1:4) TO tordforn-tof-k-causale-SPLITBUF(1:4)
           MOVE tof-chiave(1:12) TO 
           tordforn-tof-k-causale-SPLITBUF(5:12)
           .

       tordforn-tof-k-stato-MERGE-SPLITBUF.
           INITIALIZE tordforn-tof-k-stato-SPLITBUF
           MOVE tof-stato(1:1) TO tordforn-tof-k-stato-SPLITBUF(1:1)
           MOVE tof-chiave(1:12) TO tordforn-tof-k-stato-SPLITBUF(2:12)
           .

       tordforn-k-fornitore-MERGE-SPLITBUF.
           INITIALIZE tordforn-k-fornitore-SPLITBUF
           MOVE tof-cod-forn(1:5) TO tordforn-k-fornitore-SPLITBUF(1:5)
           MOVE tof-destino(1:5) TO tordforn-k-fornitore-SPLITBUF(6:5)
           MOVE tof-stato(1:1) TO tordforn-k-fornitore-SPLITBUF(11:1)
           MOVE tof-chiave(1:12) TO tordforn-k-fornitore-SPLITBUF(12:12)
           .

       tordforn-tof-k-data-MERGE-SPLITBUF.
           INITIALIZE tordforn-tof-k-data-SPLITBUF
           MOVE tof-data-ordine OF tordforn(1:8) TO 
           tordforn-tof-k-data-SPLITBUF(1:8)
           MOVE tof-chiave OF tordforn(1:12) TO 
           tordforn-tof-k-data-SPLITBUF(9:12)
           .

       DataSet1-tordforn-INITSTART.
           IF DataSet1-tordforn-KEY-Asc
              MOVE Low-Value TO tof-chiave
           ELSE
              MOVE High-Value TO tof-chiave
           END-IF
           .

       DataSet1-tordforn-INITEND.
           IF DataSet1-tordforn-KEY-Asc
              MOVE High-Value TO tof-chiave
           ELSE
              MOVE Low-Value TO tof-chiave
           END-IF
           .

      * tordforn
       DataSet1-tordforn-START.
           IF DataSet1-tordforn-KEY-Asc
              START tordforn KEY >= tof-chiave
           ELSE
              START tordforn KEY <= tof-chiave
           END-IF
           .

       DataSet1-tordforn-START-NOTGREATER.
           IF DataSet1-tordforn-KEY-Asc
              START tordforn KEY <= tof-chiave
           ELSE
              START tordforn KEY >= tof-chiave
           END-IF
           .

       DataSet1-tordforn-START-GREATER.
           IF DataSet1-tordforn-KEY-Asc
              START tordforn KEY > tof-chiave
           ELSE
              START tordforn KEY < tof-chiave
           END-IF
           .

       DataSet1-tordforn-START-LESS.
           IF DataSet1-tordforn-KEY-Asc
              START tordforn KEY < tof-chiave
           ELSE
              START tordforn KEY > tof-chiave
           END-IF
           .

       DataSet1-tordforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tordforn-LOCK
              READ tordforn WITH LOCK 
              KEY tof-chiave
           ELSE
              READ tordforn WITH NO LOCK 
              KEY tof-chiave
           END-IF
           PERFORM tordforn-tof-k-causale-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-stato-MERGE-SPLITBUF
           PERFORM tordforn-k-fornitore-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-data-MERGE-SPLITBUF
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT 
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tordforn-KEY-Asc
              IF DataSet1-tordforn-LOCK
                 READ tordforn NEXT WITH LOCK
              ELSE
                 READ tordforn NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tordforn-LOCK
                 READ tordforn PREVIOUS WITH LOCK
              ELSE
                 READ tordforn PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tordforn-tof-k-causale-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-stato-MERGE-SPLITBUF
           PERFORM tordforn-k-fornitore-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-data-MERGE-SPLITBUF
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tordforn-KEY-Asc
              IF DataSet1-tordforn-LOCK
                 READ tordforn PREVIOUS WITH LOCK
              ELSE
                 READ tordforn PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tordforn-LOCK
                 READ tordforn NEXT WITH LOCK
              ELSE
                 READ tordforn NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tordforn-tof-k-causale-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-stato-MERGE-SPLITBUF
           PERFORM tordforn-k-fornitore-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-data-MERGE-SPLITBUF
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterDelete>
      * <TOTEM:END>
           .

       rordforn-rof-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rordforn-rof-k-articolo-SPLITBUF
           MOVE rof-cod-articolo OF rordforn(1:6) TO 
           rordforn-rof-k-articolo-SPLITBUF(1:6)
           MOVE rof-chiave OF rordforn(1:17) TO 
           rordforn-rof-k-articolo-SPLITBUF(7:17)
           .

       rordforn-rof-k-art-mag-MERGE-SPLITBUF.
           INITIALIZE rordforn-rof-k-art-mag-SPLITBUF
           MOVE rof-cod-articolo OF rordforn(1:6) TO 
           rordforn-rof-k-art-mag-SPLITBUF(1:6)
           MOVE rof-cod-magazzino OF rordforn(1:3) TO 
           rordforn-rof-k-art-mag-SPLITBUF(7:3)
           MOVE rof-chiave OF rordforn(1:17) TO 
           rordforn-rof-k-art-mag-SPLITBUF(10:17)
           .

       DataSet1-rordforn-INITSTART.
           IF DataSet1-rordforn-KEY-Asc
              MOVE Low-Value TO rof-chiave OF rordforn
           ELSE
              MOVE High-Value TO rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-INITEND.
           IF DataSet1-rordforn-KEY-Asc
              MOVE High-Value TO rof-chiave OF rordforn
           ELSE
              MOVE Low-Value TO rof-chiave OF rordforn
           END-IF
           .

      * rordforn
       DataSet1-rordforn-START.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY >= rof-chiave OF rordforn
           ELSE
              START rordforn KEY <= rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-START-NOTGREATER.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY <= rof-chiave OF rordforn
           ELSE
              START rordforn KEY >= rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-START-GREATER.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY > rof-chiave OF rordforn
           ELSE
              START rordforn KEY < rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-START-LESS.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY < rof-chiave OF rordforn
           ELSE
              START rordforn KEY > rof-chiave OF rordforn
           END-IF
           .

       DataSet1-rordforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rordforn-LOCK
              READ rordforn WITH LOCK 
              KEY rof-chiave OF rordforn
           ELSE
              READ rordforn WITH NO LOCK 
              KEY rof-chiave OF rordforn
           END-IF
           PERFORM rordforn-rof-k-articolo-MERGE-SPLITBUF
           PERFORM rordforn-rof-k-art-mag-MERGE-SPLITBUF
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT 
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rordforn-KEY-Asc
              IF DataSet1-rordforn-LOCK
                 READ rordforn NEXT WITH LOCK
              ELSE
                 READ rordforn NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordforn-LOCK
                 READ rordforn PREVIOUS WITH LOCK
              ELSE
                 READ rordforn PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordforn-rof-k-articolo-MERGE-SPLITBUF
           PERFORM rordforn-rof-k-art-mag-MERGE-SPLITBUF
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rordforn-KEY-Asc
              IF DataSet1-rordforn-LOCK
                 READ rordforn PREVIOUS WITH LOCK
              ELSE
                 READ rordforn PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordforn-LOCK
                 READ rordforn NEXT WITH LOCK
              ELSE
                 READ rordforn NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordforn-rof-k-articolo-MERGE-SPLITBUF
           PERFORM rordforn-rof-k-art-mag-MERGE-SPLITBUF
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tcontat-INITSTART.
           IF DataSet1-tcontat-KEY-Asc
              MOVE Low-Value TO con-chiave
           ELSE
              MOVE High-Value TO con-chiave
           END-IF
           .

       DataSet1-tcontat-INITEND.
           IF DataSet1-tcontat-KEY-Asc
              MOVE High-Value TO con-chiave
           ELSE
              MOVE Low-Value TO con-chiave
           END-IF
           .

      * tcontat
       DataSet1-tcontat-START.
           IF DataSet1-tcontat-KEY-Asc
              START tcontat KEY >= con-chiave
           ELSE
              START tcontat KEY <= con-chiave
           END-IF
           .

       DataSet1-tcontat-START-NOTGREATER.
           IF DataSet1-tcontat-KEY-Asc
              START tcontat KEY <= con-chiave
           ELSE
              START tcontat KEY >= con-chiave
           END-IF
           .

       DataSet1-tcontat-START-GREATER.
           IF DataSet1-tcontat-KEY-Asc
              START tcontat KEY > con-chiave
           ELSE
              START tcontat KEY < con-chiave
           END-IF
           .

       DataSet1-tcontat-START-LESS.
           IF DataSet1-tcontat-KEY-Asc
              START tcontat KEY < con-chiave
           ELSE
              START tcontat KEY > con-chiave
           END-IF
           .

       DataSet1-tcontat-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcontat-LOCK
              READ tcontat WITH LOCK 
              KEY con-chiave
           ELSE
              READ tcontat WITH NO LOCK 
              KEY con-chiave
           END-IF
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT 
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcontat-KEY-Asc
              IF DataSet1-tcontat-LOCK
                 READ tcontat NEXT WITH LOCK
              ELSE
                 READ tcontat NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcontat-LOCK
                 READ tcontat PREVIOUS WITH LOCK
              ELSE
                 READ tcontat PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcontat-KEY-Asc
              IF DataSet1-tcontat-LOCK
                 READ tcontat PREVIOUS WITH LOCK
              ELSE
                 READ tcontat PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcontat-LOCK
                 READ tcontat NEXT WITH LOCK
              ELSE
                 READ tcontat NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-INITSTART.
           IF DataSet1-tnazioni-KEY-Asc
              MOVE Low-Value TO naz-chiave
           ELSE
              MOVE High-Value TO naz-chiave
           END-IF
           .

       DataSet1-tnazioni-INITEND.
           IF DataSet1-tnazioni-KEY-Asc
              MOVE High-Value TO naz-chiave
           ELSE
              MOVE Low-Value TO naz-chiave
           END-IF
           .

      * tnazioni
       DataSet1-tnazioni-START.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY >= naz-chiave
           ELSE
              START tnazioni KEY <= naz-chiave
           END-IF
           .

       DataSet1-tnazioni-START-NOTGREATER.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY <= naz-chiave
           ELSE
              START tnazioni KEY >= naz-chiave
           END-IF
           .

       DataSet1-tnazioni-START-GREATER.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY > naz-chiave
           ELSE
              START tnazioni KEY < naz-chiave
           END-IF
           .

       DataSet1-tnazioni-START-LESS.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY < naz-chiave
           ELSE
              START tnazioni KEY > naz-chiave
           END-IF
           .

       DataSet1-tnazioni-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tnazioni-LOCK
              READ tnazioni WITH LOCK 
              KEY naz-chiave
           ELSE
              READ tnazioni WITH NO LOCK 
              KEY naz-chiave
           END-IF
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT 
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tnazioni-KEY-Asc
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni NEXT WITH LOCK
              ELSE
                 READ tnazioni NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni PREVIOUS WITH LOCK
              ELSE
                 READ tnazioni PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tnazioni-KEY-Asc
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni PREVIOUS WITH LOCK
              ELSE
                 READ tnazioni PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni NEXT WITH LOCK
              ELSE
                 READ tnazioni NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-grade-INITSTART.
           IF DataSet1-grade-KEY-Asc
              MOVE Low-Value TO gra-chiave
           ELSE
              MOVE High-Value TO gra-chiave
           END-IF
           .

       DataSet1-grade-INITEND.
           IF DataSet1-grade-KEY-Asc
              MOVE High-Value TO gra-chiave
           ELSE
              MOVE Low-Value TO gra-chiave
           END-IF
           .

      * grade
       DataSet1-grade-START.
           IF DataSet1-grade-KEY-Asc
              START grade KEY >= gra-chiave
           ELSE
              START grade KEY <= gra-chiave
           END-IF
           .

       DataSet1-grade-START-NOTGREATER.
           IF DataSet1-grade-KEY-Asc
              START grade KEY <= gra-chiave
           ELSE
              START grade KEY >= gra-chiave
           END-IF
           .

       DataSet1-grade-START-GREATER.
           IF DataSet1-grade-KEY-Asc
              START grade KEY > gra-chiave
           ELSE
              START grade KEY < gra-chiave
           END-IF
           .

       DataSet1-grade-START-LESS.
           IF DataSet1-grade-KEY-Asc
              START grade KEY < gra-chiave
           ELSE
              START grade KEY > gra-chiave
           END-IF
           .

       DataSet1-grade-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-grade-LOCK
              READ grade WITH LOCK 
              KEY gra-chiave
           ELSE
              READ grade WITH NO LOCK 
              KEY gra-chiave
           END-IF
           MOVE STATUS-grade TO TOTEM-ERR-STAT 
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-grade-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-grade-KEY-Asc
              IF DataSet1-grade-LOCK
                 READ grade NEXT WITH LOCK
              ELSE
                 READ grade NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-grade-LOCK
                 READ grade PREVIOUS WITH LOCK
              ELSE
                 READ grade PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-grade-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-grade-KEY-Asc
              IF DataSet1-grade-LOCK
                 READ grade PREVIOUS WITH LOCK
              ELSE
                 READ grade PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-grade-LOCK
                 READ grade NEXT WITH LOCK
              ELSE
                 READ grade NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-grade-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-grade-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-grade-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:grade, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-grade TO TOTEM-ERR-STAT
           MOVE "grade" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:grade, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE mto-rec OF mtordini
           INITIALIZE age-rec OF agenti
           INITIALIZE vet-rec OF tvettori
           INITIALIZE record-tbliv OF tivaese
           INITIALIZE cli-rec OF clienti
           INITIALIZE des-rec OF destini
           INITIALIZE art-rec OF articoli
           INITIALIZE not-rec OF note
           INITIALIZE record-tblpa OF tcodpag
           INITIALIZE prg-rec OF progmag
           INITIALIZE imp-rec OF timposte
           INITIALIZE mar-rec OF tmarche
           INITIALIZE tmp-asc-rec OF tmp-assorcli
           INITIALIZE tge-rec OF tparamge
           INITIALIZE mag-rec OF tmagaz
           INITIALIZE tca-rec OF tcaumag
           INITIALIZE imq-rec OF timbalqta
           INITIALIZE imb-rec OF timballi
           INITIALIZE rec-rec OF recapiti
           INITIALIZE rmo-rec OF rmovmag
           INITIALIZE tcl-rec OF ttipocli
           INITIALIZE mro-rec OF mrordini
           INITIALIZE tmp-prg-z-rec OF tmp-progmag-zoom
           INITIALIZE zoom-tca-rec OF zoom-tcaumag
           INITIALIZE tpb-rec OF tpiombo
           INITIALIZE lis-rec OF lisagente
           INITIALIZE line-riga OF lineseq
           INITIALIZE bli-rec OF blister
           INITIALIZE tor-rec OF tordini
           INITIALIZE ror-rec OF rordini
           INITIALIZE ztm-rec OF zoom-tor-master
           INITIALIZE loc-rec OF locali
           INITIALIZE rpr-rec OF rpromo
           INITIALIZE tpr-rec OF tpromo
           INITIALIZE tprz-rec OF tmp-promo-prz
           INITIALIZE lst-rec OF listini
           INITIALIZE sf-rec OF sitfin
           INITIALIZE sco-rec OF tscorte
           INITIALIZE prm-rec OF param
           INITIALIZE cp-rec OF cli-prg
           INITIALIZE pgb-rec OF pagbloc
           INITIALIZE tof-rec OF tordforn
           INITIALIZE rof-rec OF rordforn
           INITIALIZE con-rec OF tcontat
           INITIALIZE naz-rec OF tnazioni
           INITIALIZE gra-rec OF grade
           .


      * COMBO-BOX
       cbo-stato-Content.
           .

      * GRID
       Form1-Gd-1-Content.
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 2, Y = 1,
                CELL-DATA = "Articolo",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 3, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 4, Y = 1,
                CELL-DATA = "Q.tà",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 5, Y = 1,
                CELL-DATA = "Prz. unitario",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 6, Y = 1,
                CELL-DATA = "Totale riga",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 7, Y = 1,
                CELL-DATA = "Consumo",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 8, Y = 1,
                CELL-DATA = "Cou/Cobat",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 9, Y = 1,
                CELL-DATA = "Add. Piombo",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 10, Y = 1,
                CELL-DATA = "Imp. merce",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 11, Y = 1,
                CELL-DATA = "Cod. IVA",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 12, Y = 1,
                CELL-DATA = "Omaggio",
           .

      * FD's Initialize Paragraph
       DataSet1-mtordini-INITREC.
           INITIALIZE mto-rec OF mtordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-agenti-INITREC.
           INITIALIZE age-rec OF agenti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tvettori-INITREC.
           INITIALIZE vet-rec OF tvettori
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tivaese-INITREC.
           INITIALIZE record-tbliv OF tivaese
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-clienti-INITREC.
           INITIALIZE cli-rec OF clienti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-destini-INITREC.
           INITIALIZE des-rec OF destini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-articoli-INITREC.
           INITIALIZE art-rec OF articoli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-note-INITREC.
           INITIALIZE not-rec OF note
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcodpag-INITREC.
           INITIALIZE record-tblpa OF tcodpag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-progmag-INITREC.
           INITIALIZE prg-rec OF progmag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timposte-INITREC.
           INITIALIZE imp-rec OF timposte
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmarche-INITREC.
           INITIALIZE mar-rec OF tmarche
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-assorcli-INITREC.
           INITIALIZE tmp-asc-rec OF tmp-assorcli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tparamge-INITREC.
           INITIALIZE tge-rec OF tparamge
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmagaz-INITREC.
           INITIALIZE mag-rec OF tmagaz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcaumag-INITREC.
           INITIALIZE tca-rec OF tcaumag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timbalqta-INITREC.
           INITIALIZE imq-rec OF timbalqta
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timballi-INITREC.
           INITIALIZE imb-rec OF timballi
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-recapiti-INITREC.
           INITIALIZE rec-rec OF recapiti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rmovmag-INITREC.
           INITIALIZE rmo-rec OF rmovmag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-ttipocli-INITREC.
           INITIALIZE tcl-rec OF ttipocli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-mrordini-INITREC.
           INITIALIZE mro-rec OF mrordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-progmag-zoom-INITREC.
           INITIALIZE tmp-prg-z-rec OF tmp-progmag-zoom
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-zoom-tcaumag-INITREC.
           INITIALIZE zoom-tca-rec OF zoom-tcaumag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tpiombo-INITREC.
           INITIALIZE tpb-rec OF tpiombo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-lisagente-INITREC.
           INITIALIZE lis-rec OF lisagente
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-lineseq-INITREC.
           INITIALIZE line-riga OF lineseq
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-blister-INITREC.
           INITIALIZE bli-rec OF blister
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tordini-INITREC.
           INITIALIZE tor-rec OF tordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rordini-INITREC.
           INITIALIZE ror-rec OF rordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-zoom-tor-master-INITREC.
           INITIALIZE ztm-rec OF zoom-tor-master
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-locali-INITREC.
           INITIALIZE loc-rec OF locali
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rpromo-INITREC.
           INITIALIZE rpr-rec OF rpromo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tpromo-INITREC.
           INITIALIZE tpr-rec OF tpromo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-promo-prz-INITREC.
           INITIALIZE tprz-rec OF tmp-promo-prz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-listini-INITREC.
           INITIALIZE lst-rec OF listini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-sitfin-INITREC.
           INITIALIZE sf-rec OF sitfin
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tscorte-INITREC.
           INITIALIZE sco-rec OF tscorte
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-param-INITREC.
           INITIALIZE prm-rec OF param
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-cli-prg-INITREC.
           INITIALIZE cp-rec OF cli-prg
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-pagbloc-INITREC.
           INITIALIZE pgb-rec OF pagbloc
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tordforn-INITREC.
           INITIALIZE tof-rec OF tordforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rordforn-INITREC.
           INITIALIZE rof-rec OF rordforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcontat-INITREC.
           INITIALIZE con-rec OF tcontat
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tnazioni-INITREC.
           INITIALIZE naz-rec OF tnazioni
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-grade-INITREC.
           INITIALIZE gra-rec OF grade
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           EVALUATE TOTEM-Form-Index ALSO TOTEM-Frame-Index
              WHEN 1 ALSO 0
                  PERFORM Form1-Buf-To-Fld
           END-EVALUATE
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              SCREEN LINE 1,
              SCREEN COLUMN 0,
              LINES 47,15,
              SIZE 158,00,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Small-Font,
              LABEL-OFFSET 23,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE TITOLO,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
           VISIBLE v-form,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Form1-Event-Proc,
              HANDLE IS Form1-Handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              GRIP,
              PANEL-WIDTHS (100, 35, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON Form1-Handle
      * DISPLAY-COLUMNS settings
              MODIFY Form1-Gd-1, DISPLAY-COLUMNS (1, 8, 16, 51, 60, 72, 
           84, 95, 106, 117, 129, 138)
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           if status-mrordini = "9E" or
              status-rordini  = "9E"
              move 27 to key-status
           else
              move 1 to v-form
              modify form1-handle, visible v-form
              set MousePressed to false
              perform LEGGI-ANNO
              perform INIT
              perform INIT-OLD-REC
              perform ABILITA-TOOLBAR
              perform ABILITAZIONI
              set StatusVisua to true
              perform STATUS-BAR-MSG
              accept data-oggi from century-date
              move 0        to volantino-forzato
              move spaces   to lab-forzato-buf
              move 0        to v-gest-plus
              display lab-gest ef-gest
              accept versione-evasione from environment "VERSIONE_EVASIO
      -    "NE"
           end-if.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
           perform ORDINI-AFTER-END-ACCEPT

      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY Form1-Handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
                 IF Event-Type = Cmd-Tabchanged AND 
                                 Event-Control-Id = 5000
                    MOVE EVENT-DATA-1 TO Screen1-Ta-1-TAB-VALUE
                    PERFORM Screen1-Ta-1-TABCHANGE
                 END-IF

              WHEN Key-Status = 1000
                 PERFORM chk-ritira-LinkTo
              WHEN Key-Status = 1001
                 PERFORM chk-prenot-LinkTo
              WHEN Key-Status = 1007
                 PERFORM chk-saldi-banco-LinkTo
              WHEN Key-Status = 1008
                 PERFORM chk-saldi-promo-LinkTo
              WHEN Key-Status = 1004
                 PERFORM pb-blister-LinkTo
              WHEN Key-Status = 1003
                 PERFORM chk-blister-LinkTo
              WHEN Key-Status = 1002
                 PERFORM pb-grid-nuovo-LinkTo
              WHEN Key-Status = 1005
                 PERFORM pb-grid-elimina-LinkTo
              WHEN Key-Status = 1006
                 PERFORM pb-forza-LinkTo
              WHEN Key-Status = 1009
                 PERFORM pb-evadi-dal-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON Form1-Handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
           if mod-k = 0
              display message "Confermare la perdita dei dati inseriti?"
                        title titolo
                         type mb-yes-no
                       giving scelta
                      default mb-no
              if scelta = MB-YES
                 perform CANCELLA-COLORE
                 perform INIT
                 perform INIT-OLD-REC
                 set OrdineTradizionale to false
                 move 0 to mod-campi, mod, v-blister, v-gest-plus,
                           v-gdo v-forza 
                           mod-vettori
                 move spaces to lab-forzato-buf
                 move 1 to mod-k mod-cliente-destino mod-destino
                 perform LEGGI-ANNO
                 perform DISPLAY-SCREEN
                 perform SECCA-TMP-ASSORCLI

                 initialize gruppo-hidden 
                            replacing numeric data by zeroes
                                 alphanumeric data by spaces

              end-if  
              move 26 to KEY-STATUS
              exit paragraph
           end-if.

           set environment "KEYSTROKE" to "DATA=44   44".
           set environment "KEYSTROKE" to "DATA=46   46".

           .
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * TAB
              MODIFY Screen1-Ta-1, RESET-TABS = 1
              MODIFY Screen1-Ta-1, 
           TAB-TO-ADD = (
                 " - Sezione dati di &Testata - ",
                 " - Sezione &Righe - ",
                        )
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
                   Form1-Pg-2-Visible,
           MOVE 1 TO Form1-Pg-1-Visible
           PERFORM Screen1-Ta-1-TABCHANGE
      * COMBO-BOX
           PERFORM cbo-stato-Content
      * GRID
           PERFORM Form1-Gd-1-Content
           .

       Form1-DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-mtordini-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-mtordini-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Update-Key.
           MOVE mto-rec OF mtordini TO
                     Form1-MULKEY-TMPBUF
           PERFORM Form1-CLEAR
           PERFORM Form1-INIT-DATA
           MOVE Form1-MULKEY-TMPBUF TO
                     mto-rec OF mtordini
           PERFORM DataSet1-mtordini-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
           .

       Form1-DUPLICATE-MOVEKEY.
           .

       Form1-First.
           PERFORM Form1-DUMMY-FIRST
           PERFORM DataSet1-mtordini-INITSTART
           PERFORM DataSet1-mtordini-START
           IF NOT Valid-STATUS-mtordini
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFirst>
      * <TOTEM:END>
           PERFORM DataSet1-mtordini-Read-Next
           IF NOT Valid-STATUS-mtordini
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFirst>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Previous.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-mtordini-START-LESS
           IF NOT Valid-STATUS-mtordini
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforePrevious>
      * <TOTEM:END>
           PERFORM DataSet1-mtordini-Read-Prev
           IF NOT Valid-STATUS-mtordini
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterPrevious>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-PREVIOUS
           PERFORM Form1-IUD-Display
           .

       Form1-Next.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-mtordini-START-GREATER
           IF NOT Valid-STATUS-mtordini
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeNext>
      * <TOTEM:END>
           PERFORM DataSet1-mtordini-Read-Next
           IF NOT Valid-STATUS-mtordini
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterNext>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-NEXT
           PERFORM Form1-IUD-Display
           .
      
       Form1-Last.
           PERFORM Form1-DUMMY-LAST
           PERFORM DataSet1-mtordini-INITEND
           PERFORM DataSet1-mtordini-START-NOTGREATER
           IF NOT Valid-STATUS-mtordini
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeLast>
      * <TOTEM:END>
           PERFORM DataSet1-mtordini-Read-Prev
           IF NOT Valid-STATUS-mtordini
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterLast>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Curr.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeCurrent>
      * <TOTEM:END>
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-mtordini-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCurrent>
      * <TOTEM:END>
           .

       Form1-IUD-Display.
           IF Valid-STATUS-mtordini
              PERFORM Form1-ALLGRID-RESET
              PERFORM Form1-Fld-To-Buf
              PERFORM Form1-NAVI-FOR-MASTERGRID
              PERFORM Form1-DISPLAY
           ELSE
              IF Form1-FLAG-REFRESH
                 CONTINUE
              ELSE
                 PERFORM Form1-Extended-File-Status
              END-IF
           END-IF
           .

       Form1-Add.
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-ADD
           PERFORM DataSet1-mtordini-INITREC
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAdd>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-mtordini-Rec-Write
           IF Valid-STATUS-mtordini
              PERFORM Form1-RESUMMARY-INS
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "301" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAdd>
      * <TOTEM:END>
           .
     
       Form1-Update.
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-mtordini-START              
           IF NOT Valid-STATUS-mtordini
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
           PERFORM DataSet1-mtordini-Read
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-UPDATE
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeUpdate>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-mtordini-Rec-Rewrite
           IF Valid-STATUS-mtordini
              PERFORM Form1-RESUMMARY-DEL
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "302" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterUpdate>
      * <TOTEM:END>
           .

       Form1-Delete.
           MOVE "203" TO TOTEM-MSG-ID
           PERFORM MESSAGE-BOX-DISPLAY
           IF TOTEM-MSG-RETURN-VALUE NOT = 1
              INITIALIZE TOTEM-MSG-TEXT
              EXIT PARAGRAPH 
           END-IF
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDelete>
      * <TOTEM:END>
           PERFORM Form1-DUMMY-DELETE
      * delete
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-mtordini-Rec-Delete
           IF Valid-STATUS-mtordini
              PERFORM Form1-CLEAR
              PERFORM Form1-DUMMY-DELETE-INIT
              MOVE "303" TO TOTEM-MSG-ID
              MOVE "00" to STATUS-mtordini
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDelete>
      * <TOTEM:END>
           PERFORM Form1-ERR-CHECKING
           .

       Form1-NAVI-FOR-MASTERGRID.
           .

       Form1-ERR-CHECKING.
           IF Valid-STATUS-mtordini
              PERFORM Form1-SHOW-MSG-ROUTINE
           ELSE
              PERFORM Form1-Extended-File-Status
           END-IF
           .

       Form1-RESUMMARY-INS.
           .

       Form1-RESUMMARY-DEL.
           .


       Form1-DUMMY-FIRST.
           .

       Form1-DUMMY-PREVIOUS.
           .

       Form1-DUMMY-NEXT.
           .

       Form1-DUMMY-LAST.
           .

       Form1-DUMMY-CURR.
           .

       Form1-DUMMY-ADD.
           .

       Form1-DUMMY-UPDATE.
           .

       Form1-DUMMY-UPDATE-INIT.
           .

       Form1-DUMMY-DELETE.
           .

       Form1-DUMMY-DELETE-INIT.
           .

       Form1-Init-Value.
           MOVE TITOLO TO TOTEM-MSG-TITLE
           INITIALIZE Form1-BUF
      * FORM : Form1
           PERFORM DataSet1-INIT-RECORD
      * DB_CHECK BOX
              MOVE 0 TO mto-ritira-in-lubex
      * DB_CHECK BOX
              MOVE 0 TO mto-prenotazione-qta
      * DB_CHECK BOX
              MOVE 0 TO mto-saldi-banco
      * DB_CHECK BOX
              MOVE 0 TO mto-saldi-promo
      * DB_CHECK BOX
              MOVE 0 TO mto-urgente
      * DB_CHECK BOX
              MOVE 0 TO mto-immediato
      * DB_CHECK BOX
              MOVE 0 TO mro-blister
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
      * ef-anno's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-anno-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5001 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cau's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cau-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5002 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cli's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cli-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5003 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5004 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-num-ord's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-num-ord-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5005 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5006 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gest's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gest-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5007 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data-pass's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-pass-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5008 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-age's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-age-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5009 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5011 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-iva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-iva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5013 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vet's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vet-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5015 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-forn's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-forn-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5017 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5020 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data-cons's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-cons-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5021 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5022 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-3's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-3-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5023 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-4's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-4-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5024 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-bolla-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-bolla-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5025 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-bolla-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-bolla-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5026 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-art's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-art-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5028 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-evadi-dal's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-evadi-dal-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5029 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-qta's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-qta-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5031 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-qta-oma's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-qta-oma-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5032 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-uni's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-uni-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5033 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5034 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cons's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cons-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5035 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cou's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cou-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5036 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5037 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cod-iva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cod-iva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5038 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-add's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-add-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5039 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
           .

       ef-anno-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-anno, BeforeValidation>
      * <TOTEM:END>
           .

       ef-anno-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-anno, AfterValidation>
      * <TOTEM:END>
           .

      * ef-anno's Validation
       ef-anno-VALIDATION.
           PERFORM ef-anno-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-anno-AFTER-VALIDATION
           .

       ef-cau-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cau-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cau's Validation
       ef-cau-VALIDATION.
           PERFORM ef-cau-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cau-AFTER-VALIDATION
           .

       ef-cli-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cli-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cli's Validation
       ef-cli-VALIDATION.
           PERFORM ef-cli-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cli-AFTER-VALIDATION
           .

       ef-des-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des's Validation
       ef-des-VALIDATION.
           PERFORM ef-des-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des-AFTER-VALIDATION
           .

       ef-num-ord-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-num-ord, BeforeValidation>
      * <TOTEM:END>
           .

       ef-num-ord-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-num-ord, AfterValidation>
      * <TOTEM:END>
           .

      * ef-num-ord's Validation
       ef-num-ord-VALIDATION.
           PERFORM ef-num-ord-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-num-ord-AFTER-VALIDATION
           .

       ef-data-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data's Validation
       ef-data-VALIDATION.
           PERFORM ef-data-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-AFTER-VALIDATION
           .

       ef-gest-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gest, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gest-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gest, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gest's Validation
       ef-gest-VALIDATION.
           PERFORM ef-gest-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gest-AFTER-VALIDATION
           .

       ef-data-pass-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-pass, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-pass-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-pass, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data-pass's Validation
       ef-data-pass-VALIDATION.
           PERFORM ef-data-pass-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-pass-AFTER-VALIDATION
           .

       ef-age-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-age, BeforeValidation>
      * <TOTEM:END>
           .

       ef-age-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-age, AfterValidation>
      * <TOTEM:END>
           .

      * ef-age's Validation
       ef-age-VALIDATION.
           PERFORM ef-age-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-age-AFTER-VALIDATION
           .

       ef-pag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pag's Validation
       ef-pag-VALIDATION.
           PERFORM ef-pag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pag-AFTER-VALIDATION
           .

       ef-iva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-iva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-iva's Validation
       ef-iva-VALIDATION.
           PERFORM ef-iva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-iva-AFTER-VALIDATION
           .

       ef-vet-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vet, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vet-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vet, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vet's Validation
       ef-vet-VALIDATION.
           PERFORM ef-vet-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vet-AFTER-VALIDATION
           .

       ef-forn-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-forn, BeforeValidation>
      * <TOTEM:END>
           .

       ef-forn-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-forn, AfterValidation>
      * <TOTEM:END>
           .

      * ef-forn's Validation
       ef-forn-VALIDATION.
           PERFORM ef-forn-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-forn-AFTER-VALIDATION
           .

       ef-note-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-1's Validation
       ef-note-1-VALIDATION.
           PERFORM ef-note-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-1-AFTER-VALIDATION
           .

       ef-data-cons-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-cons, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-cons-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-cons, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data-cons's Validation
       ef-data-cons-VALIDATION.
           PERFORM ef-data-cons-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-cons-AFTER-VALIDATION
           .

       ef-note-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-2's Validation
       ef-note-2-VALIDATION.
           PERFORM ef-note-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-2-AFTER-VALIDATION
           .

       ef-note-3-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-3, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-3-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-3, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-3's Validation
       ef-note-3-VALIDATION.
           PERFORM ef-note-3-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-3-AFTER-VALIDATION
           .

       ef-note-4-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-4, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-4-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-4, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-4's Validation
       ef-note-4-VALIDATION.
           PERFORM ef-note-4-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-4-AFTER-VALIDATION
           .

       ef-note-bolla-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-bolla-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-bolla-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-bolla-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-bolla-1's Validation
       ef-note-bolla-1-VALIDATION.
           PERFORM ef-note-bolla-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-bolla-1-AFTER-VALIDATION
           .

       ef-note-bolla-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-bolla-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-bolla-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-bolla-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-bolla-2's Validation
       ef-note-bolla-2-VALIDATION.
           PERFORM ef-note-bolla-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-bolla-2-AFTER-VALIDATION
           .

       ef-art-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-art, BeforeValidation>
      * <TOTEM:END>
           .

       ef-art-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-art, AfterValidation>
      * <TOTEM:END>
           .

      * ef-art's Validation
       ef-art-VALIDATION.
           PERFORM ef-art-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-art-AFTER-VALIDATION
           .

       ef-evadi-dal-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-evadi-dal, BeforeValidation>
      * <TOTEM:END>
           .

       ef-evadi-dal-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-evadi-dal, AfterValidation>
      * <TOTEM:END>
           .

      * ef-evadi-dal's Validation
       ef-evadi-dal-VALIDATION.
           PERFORM ef-evadi-dal-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-evadi-dal-AFTER-VALIDATION
           .

       ef-qta-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta, BeforeValidation>
      * <TOTEM:END>
           .

       ef-qta-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta, AfterValidation>
      * <TOTEM:END>
           .

      * ef-qta's Validation
       ef-qta-VALIDATION.
           PERFORM ef-qta-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-qta-AFTER-VALIDATION
           .

       ef-qta-oma-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-oma, BeforeValidation>
      * <TOTEM:END>
           .

       ef-qta-oma-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta-oma, AfterValidation>
      * <TOTEM:END>
           .

      * ef-qta-oma's Validation
       ef-qta-oma-VALIDATION.
           PERFORM ef-qta-oma-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-qta-oma-AFTER-VALIDATION
           .

       ef-uni-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-uni, BeforeValidation>
      * <TOTEM:END>
           .

       ef-uni-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-uni, AfterValidation>
      * <TOTEM:END>
           .

      * ef-uni's Validation
       ef-uni-VALIDATION.
           PERFORM ef-uni-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-uni-AFTER-VALIDATION
           .

       ef-sconto-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto's Validation
       ef-sconto-VALIDATION.
           PERFORM ef-sconto-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-AFTER-VALIDATION
           .

       ef-cons-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cons, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cons-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cons, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cons's Validation
       ef-cons-VALIDATION.
           PERFORM ef-cons-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cons-AFTER-VALIDATION
           .

       ef-cou-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cou, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cou-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cou, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cou's Validation
       ef-cou-VALIDATION.
           PERFORM ef-cou-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cou-AFTER-VALIDATION
           .

       ef-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-imp's Validation
       ef-imp-VALIDATION.
           PERFORM ef-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-imp-AFTER-VALIDATION
           .

       ef-cod-iva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-iva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cod-iva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-iva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cod-iva's Validation
       ef-cod-iva-VALIDATION.
           PERFORM ef-cod-iva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cod-iva-AFTER-VALIDATION
           .

       ef-add-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-add, BeforeValidation>
      * <TOTEM:END>
           .

       ef-add-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-add, AfterValidation>
      * <TOTEM:END>
           .

      * ef-add's Validation
       ef-add-VALIDATION.
           PERFORM ef-add-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-add-AFTER-VALIDATION
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * DB_Entry-Field : ef-anno
           MOVE ef-anno-BUF TO mto-anno
      * DB_Entry-Field : ef-cau
           MOVE ef-cau-BUF TO mto-causale
      * DB_Entry-Field : ef-cli
           MOVE ef-cli-BUF TO mto-cod-cli
      * DB_Entry-Field : ef-des
           MOVE ef-des-BUF TO mto-prg-destino
      * DB_Entry-Field : ef-num-ord
           MOVE ef-num-ord-BUF TO mto-num-ord-cli
      * DB_Entry-Field : ef-data
           MOVE ef-data-BUF TO mto-data-ordine
      * DB_Entry-Field : ef-gest
           MOVE ef-gest-BUF TO mto-gest-plus
      * DB_Entry-Field : ef-data-pass
           MOVE ef-data-pass-BUF TO mto-data-passaggio-ordine
      * DB_Entry-Field : ef-age
           MOVE ef-age-BUF TO mto-cod-agente
      * DB_CHECK BOX : chk-ritira
              IF chk-ritira-BUF = 1
                 MOVE 1 TO mto-ritira-in-lubex
              ELSE
                 MOVE 0 TO mto-ritira-in-lubex
              END-IF
      * DB_Entry-Field : ef-pag
           MOVE ef-pag-BUF TO mto-cod-pagamento
      * DB_CHECK BOX : chk-prenot
              IF chk-prenot-BUF = 1
                 MOVE 1 TO mto-prenotazione-qta
              ELSE
                 MOVE 0 TO mto-prenotazione-qta
              END-IF
      * DB_Entry-Field : ef-iva
           MOVE ef-iva-BUF TO mto-cod-ese-iva
      * DB_CHECK BOX : chk-saldi-banco
              IF chk-saldi-banco-BUF = 1
                 MOVE 1 TO mto-saldi-banco
              ELSE
                 MOVE 0 TO mto-saldi-banco
              END-IF
      * DB_Entry-Field : ef-vet
           MOVE ef-vet-BUF TO mto-vettore
      * DB_CHECK BOX : chk-saldi-promo
              IF chk-saldi-promo-BUF = 1
                 MOVE 1 TO mto-saldi-promo
              ELSE
                 MOVE 0 TO mto-saldi-promo
              END-IF
      * DB_Entry-Field : ef-forn
           MOVE ef-forn-BUF TO mto-forn-reso
      * DB_CHECK BOX : chk-urgente
              IF chk-urgente-BUF = 1
                 MOVE 1 TO mto-urgente
              ELSE
                 MOVE 0 TO mto-urgente
              END-IF
      * DB_CHECK BOX : chk-immediato
              IF chk-immediato-BUF = 1
                 MOVE 1 TO mto-immediato
              ELSE
                 MOVE 0 TO mto-immediato
              END-IF
      * DB_Entry-Field : ef-note-1
           MOVE ef-note-1-BUF TO mto-note1
      * DB_Entry-Field : ef-data-cons
           MOVE ef-data-cons-BUF TO mto-data-note1
      * DB_Entry-Field : ef-note-2
           MOVE ef-note-2-BUF TO mto-note2
      * DB_Entry-Field : ef-note-3
           MOVE ef-note-3-BUF TO mto-note3
      * DB_Entry-Field : ef-note-4
           MOVE ef-note-4-BUF TO mto-note4
      * DB_Entry-Field : ef-note-bolla-1
           MOVE ef-note-bolla-1-BUF TO mto-note-bolla-1
      * DB_Entry-Field : ef-note-bolla-2
           MOVE ef-note-bolla-2-BUF TO mto-note-bolla-2
      * DB_Entry-Field : ef-art
           MOVE ef-art-BUF TO mro-cod-articolo
      * DB_Entry-Field : ef-evadi-dal
           MOVE ef-evadi-dal-BUF TO mro-evadi-dal
      * DB_CHECK BOX : chk-blister
              IF chk-blister-BUF = 1
                 MOVE 1 TO mro-blister
              ELSE
                 MOVE 0 TO mro-blister
              END-IF
      * DB_Entry-Field : ef-qta
           MOVE ef-qta-BUF TO mro-qta
      * DB_Entry-Field : ef-qta-oma
           MOVE ef-qta-oma-BUF TO mro-qta-omaggi
      * DB_Entry-Field : ef-uni
           MOVE ef-uni-BUF TO mro-prz-unitario
      * DB_Entry-Field : ef-sconto
           MOVE ef-sconto-BUF TO mro-perce-sconto
      * DB_Entry-Field : ef-cons
           MOVE ef-cons-BUF TO mro-imp-consumo
      * DB_Entry-Field : ef-cou
           MOVE ef-cou-BUF TO mro-imp-cou-cobat
      * DB_Entry-Field : ef-imp
           MOVE ef-imp-BUF TO mro-imponib-merce
      * DB_Entry-Field : ef-cod-iva
           MOVE ef-cod-iva-BUF TO mro-cod-iva
      * DB_Entry-Field : ef-add
           MOVE ef-add-BUF TO mro-add-piombo
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
           move "IV"             to tbliv-codice1.
           move mto-cod-ese-iva  to tbliv-codice2.

           perform SCARICA-COMBO-STATO.
           move stato                 to mto-stato-attivazione.
      *
           move ef-data-buf           to como-data.
           perform DATE-TO-FILE.
           move como-data             to mto-data-ordine.

           move ef-data-pass-buf      to como-data.
           perform DATE-TO-FILE.
           move como-data             to mto-data-passaggio-ordine.

           move ef-data-cons-buf      to como-data.
           perform DATE-TO-FILE.
           move como-data             to mto-data-note1.
      *
           move ef-cli-buf            to mto-cod-cli     convert.  
           move ef-des-buf            to mto-prg-destino convert.  
           
           accept como-ora          from time.
                          
           move data-oggi             to mto-data-creazione.            
                 
           move como-ora              to mto-ora-creazione.
           move user-codi             to mto-utente-creazione.
                                    
           initialize mto-vuoti replacing numeric data by zeroes
                                     alphanumeric data by spaces.

LUBEXX     move ef-gest-buf to mto-gest-plus.

           .
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * <TOTEM:END>
      * DB_Entry-Field : ef-anno
           MOVE mto-anno TO ef-anno-BUF
      * DB_Entry-Field : ef-cau
           MOVE mto-causale TO ef-cau-BUF
      * DB_Entry-Field : ef-cli
           MOVE mto-cod-cli TO ef-cli-BUF
      * DB_Entry-Field : ef-des
           MOVE mto-prg-destino TO ef-des-BUF
      * DB_LABEL : lab-cli
              MOVE cli-ragsoc-1  TO lab-cli-BUF
      * DB_LABEL : lab-ind-cli
              MOVE cli-indirizzo  TO lab-ind-cli-BUF
      * DB_LABEL : lab-loc-cli
              MOVE cli-localita  TO lab-loc-cli-BUF
      * DB_LABEL : lab-des
              MOVE des-ragsoc-1  TO lab-des-BUF
      * DB_LABEL : lab-ind-des
              MOVE des-indirizzo  TO lab-ind-des-BUF
      * DB_LABEL : lab-loc-des
              MOVE des-localita  TO lab-loc-des-BUF
      * DB_Entry-Field : ef-num-ord
           MOVE mto-num-ord-cli TO ef-num-ord-BUF
      * DB_Entry-Field : ef-data
           MOVE mto-data-ordine TO ef-data-BUF
      * DB_Entry-Field : ef-gest
           MOVE mto-gest-plus TO ef-gest-BUF
      * DB_Entry-Field : ef-data-pass
           MOVE mto-data-passaggio-ordine TO ef-data-pass-BUF
      * DB_Entry-Field : ef-age
           MOVE mto-cod-agente TO ef-age-BUF
      * DB_CHECK BOX : chk-ritira
              IF mto-ritira-in-lubex = 1
                 MOVE 1 TO chk-ritira-BUF
              ELSE
                 MOVE 0 TO chk-ritira-BUF
              END-IF
      * DB_Entry-Field : ef-pag
           MOVE mto-cod-pagamento TO ef-pag-BUF
      * DB_CHECK BOX : chk-prenot
              IF mto-prenotazione-qta = 1
                 MOVE 1 TO chk-prenot-BUF
              ELSE
                 MOVE 0 TO chk-prenot-BUF
              END-IF
      * DB_Entry-Field : ef-iva
           MOVE mto-cod-ese-iva TO ef-iva-BUF
      * DB_CHECK BOX : chk-saldi-banco
              IF mto-saldi-banco = 1
                 MOVE 1 TO chk-saldi-banco-BUF
              ELSE
                 MOVE 0 TO chk-saldi-banco-BUF
              END-IF
      * DB_Entry-Field : ef-vet
           MOVE mto-vettore TO ef-vet-BUF
      * DB_CHECK BOX : chk-saldi-promo
              IF mto-saldi-promo = 1
                 MOVE 1 TO chk-saldi-promo-BUF
              ELSE
                 MOVE 0 TO chk-saldi-promo-BUF
              END-IF
      * DB_Entry-Field : ef-forn
           MOVE mto-forn-reso TO ef-forn-BUF
      * DB_CHECK BOX : chk-urgente
              IF mto-urgente = 0
                 MOVE 0 TO chk-urgente-BUF
              ELSE
                 MOVE 1 TO chk-urgente-BUF
              END-IF
      * DB_CHECK BOX : chk-immediato
              IF mto-immediato = 1
                 MOVE 1 TO chk-immediato-BUF
              ELSE
                 MOVE 0 TO chk-immediato-BUF
              END-IF
      * DB_Entry-Field : ef-note-1
           MOVE mto-note1 TO ef-note-1-BUF
      * DB_Entry-Field : ef-data-cons
           MOVE mto-data-note1 TO ef-data-cons-BUF
      * DB_Entry-Field : ef-note-2
           MOVE mto-note2 TO ef-note-2-BUF
      * DB_Entry-Field : ef-note-3
           MOVE mto-note3 TO ef-note-3-BUF
      * DB_Entry-Field : ef-note-4
           MOVE mto-note4 TO ef-note-4-BUF
      * DB_Entry-Field : ef-note-bolla-1
           MOVE mto-note-bolla-1 TO ef-note-bolla-1-BUF
      * DB_Entry-Field : ef-note-bolla-2
           MOVE mto-note-bolla-2 TO ef-note-bolla-2-BUF
      * DB_LABEL : lab-age
              MOVE age-ragsoc-1  TO lab-age-BUF
      * DB_LABEL : lab-vet
              MOVE vet-descrizione  TO lab-vet-BUF
      * DB_LABEL : lab-forn
              MOVE cli-ragsoc-1  TO lab-forn-BUF
      * DB_Entry-Field : ef-art
           MOVE mro-cod-articolo TO ef-art-BUF
      * DB_Entry-Field : ef-evadi-dal
           MOVE mro-evadi-dal TO ef-evadi-dal-BUF
      * DB_CHECK BOX : chk-blister
              IF mro-blister = 1
                 MOVE 1 TO chk-blister-BUF
              ELSE
                 MOVE 0 TO chk-blister-BUF
              END-IF
      * DB_Entry-Field : ef-qta
           MOVE mro-qta TO ef-qta-BUF
      * DB_Entry-Field : ef-qta-oma
           MOVE mro-qta-omaggi TO ef-qta-oma-BUF
      * DB_Entry-Field : ef-uni
           MOVE mro-prz-unitario TO ef-uni-BUF
      * DB_Entry-Field : ef-sconto
           MOVE mro-perce-sconto TO ef-sconto-BUF
      * DB_Entry-Field : ef-cons
           MOVE mro-imp-consumo TO ef-cons-BUF
      * DB_Entry-Field : ef-cou
           MOVE mro-imp-cou-cobat TO ef-cou-BUF
      * DB_Entry-Field : ef-imp
           MOVE mro-imponib-merce TO ef-imp-BUF
      * DB_Entry-Field : ef-cod-iva
           MOVE mro-cod-iva TO ef-cod-iva-BUF
      * DB_LABEL : lab-art
              MOVE art-descrizione  TO lab-art-BUF
      * DB_Entry-Field : ef-add
           MOVE mro-add-piombo TO ef-add-BUF
      * DB_LABEL : lab-cau
              MOVE tca-descrizione  TO lab-cau-BUF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
      *                          
           perform VALORIZZA-OLD.
      *                            
           move mto-cod-cli   to  codice-ed.
           move codice-ed     to  ef-cli-buf.   
           call "C$JUSTIFY" using ef-cli-buf, "L".
           display ef-cli.   
           
           move mto-prg-destino to codice-ed.
           move codice-ed       to ef-des-buf.   
           call "C$JUSTIFY"  using ef-des-buf, "L".
           display ef-des.   

           perform ABILITAZIONI.

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           if mto-num-ord-cli not = old-mto-num-ord-cli
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-num-ord è l'ID del campo ef-num-ord
              move 78-ID-ef-num-ord to store-id 
           end-if

           if mto-data-ordine not = old-mto-data-ordine
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data è l'ID del campo ef-data
              move 78-ID-ef-data to store-id 
           end-if

           if mto-gest-plus not = old-mto-gest-plus
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-gest è l'ID del campo ef-gest
              move 78-ID-ef-gest to store-id 
           end-if

           if mto-data-passaggio-ordine not = 
           old-mto-data-passaggio-ordine
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data-pass è l'ID del campo ef-data-pass
              move 78-ID-ef-data-pass to store-id 
           end-if

           if mto-cod-agente not = old-mto-cod-agente
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-age è l'ID del campo ef-age
              move 78-ID-ef-age to store-id 
           end-if

           if mto-ritira-in-lubex not = old-mto-ritira-in-lubex
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ritira è l'ID del campo chk-ritira
              move 78-ID-chk-ritira to store-id 
           end-if

           if mto-cod-pagamento not = old-mto-cod-pagamento
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-pag è l'ID del campo ef-pag
              move 78-ID-ef-pag to store-id 
           end-if

           if mto-prenotazione-qta not = old-mto-prenotazione-qta
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-prenot è l'ID del campo chk-prenot
              move 78-ID-chk-prenot to store-id 
           end-if

           if mto-cod-ese-iva not = old-mto-cod-ese-iva
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-iva è l'ID del campo ef-iva
              move 78-ID-ef-iva to store-id 
           end-if

           if mto-saldi-banco not = old-mto-saldi-banco
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-saldi-banco è l'ID del campo chk-saldi-banco
              move 78-ID-chk-saldi-banco to store-id 
           end-if

           if mto-vettore not = old-mto-vettore
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-vet è l'ID del campo ef-vet
              move 78-ID-ef-vet to store-id 
           end-if

           if mto-saldi-promo not = old-mto-saldi-promo
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-saldi-promo è l'ID del campo chk-saldi-promo
              move 78-ID-chk-saldi-promo to store-id 
           end-if

           if mto-forn-reso not = old-mto-forn-reso
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-forn è l'ID del campo ef-forn
              move 78-ID-ef-forn to store-id 
           end-if

           if mto-immediato not = old-mto-immediato
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-immediato è l'ID del campo chk-immediato
              move 78-ID-chk-immediato to store-id 
           end-if

           if mto-note1 not = old-mto-note1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-1 è l'ID del campo ef-note-1
              move 78-ID-ef-note-1 to store-id 
           end-if

           if mto-data-note1 not = old-mto-data-note1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data-cons è l'ID del campo ef-data-cons
              move 78-ID-ef-data-cons to store-id 
           end-if

           if mto-note2 not = old-mto-note2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-2 è l'ID del campo ef-note-2
              move 78-ID-ef-note-2 to store-id 
           end-if

           if mto-note3 not = old-mto-note3
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-3 è l'ID del campo ef-note-3
              move 78-ID-ef-note-3 to store-id 
           end-if

           if mto-note4 not = old-mto-note4
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-4 è l'ID del campo ef-note-4
              move 78-ID-ef-note-4 to store-id 
           end-if

           if mto-note-bolla-1 not = old-mto-note-bolla-1
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-bolla-1 è l'ID del campo ef-note-bolla-1
              move 78-ID-ef-note-bolla-1 to store-id 
           end-if

           if mto-note-bolla-2 not = old-mto-note-bolla-2
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-bolla-2 è l'ID del campo ef-note-bolla-2
              move 78-ID-ef-note-bolla-2 to store-id 
           end-if

           if mto-stato-ordine not = old-mto-stato-ordine
              and SiSalvato
              set NoSalvato to true
              |78-ID-cbo-stato è l'ID del campo cbo-stato
              move 78-ID-cbo-stato to store-id 
           end-if

           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           MOVE DataSet1-mtordini-KEY1-ORDER TO TMP-Form1-KEY1-ORDER
           MOVE DataSet1-KEYIS TO TMP-Form1-KEYIS
           MOVE mto-rec OF mtordini TO 
              TMP-Form1-mtordini-RESTOREBUF
           .             

       Form1-Restore-Status.
           MOVE TMP-Form1-KEY1-ORDER TO DataSet1-mtordini-KEY1-ORDER
           MOVE TMP-Form1-KEYIS TO DataSet1-KEYIS
           MOVE TMP-Form1-mtordini-RESTOREBUF TO
              mto-rec OF mtordini
           PERFORM DataSet1-mtordini-START
           IF Valid-STATUS-mtordini
              PERFORM DataSet1-mtordini-Read-Next
           ELSE
              PERFORM DataSet1-mtordini-INITREC
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-mtordini OR
              (Valid-STATUS-mtordini AND
                 mto-rec OF mtordini = 
                   TMP-Form1-mtordini-RESTOREBUF)
              PERFORM DataSet1-mtordini-Read-Next
           END-PERFORM
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-des è l'ID del campo ef-des
           when 78-ID-ef-des
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-age è l'ID del campo ef-age
           when 78-ID-ef-age
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-vet è l'ID del campo ef-vet
           when 78-ID-ef-vet
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-art è l'ID del campo ef-art
           when 78-ID-ef-art
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cod-iva è l'ID del campo ef-cod-iva
           when 78-ID-ef-cod-iva
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |78-ID-ef-uni è l'ID del campo ef-uni
           when 78-ID-ef-uni
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto è l'ID del campo ef-sconto
           when 78-ID-ef-sconto
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-imp è l'ID del campo ef-imp
           when 78-ID-ef-imp
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-des è l'ID del campo ef-des
           when 78-ID-ef-des
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-age è l'ID del campo ef-age
           when 78-ID-ef-age
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-vet è l'ID del campo ef-vet
           when 78-ID-ef-vet
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-art è l'ID del campo ef-art
           when 78-ID-ef-art
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cod-iva è l'ID del campo ef-cod-iva
           when 78-ID-ef-cod-iva
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |78-ID-ef-uni è l'ID del campo ef-uni
           when 78-ID-ef-uni
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto è l'ID del campo ef-sconto
           when 78-ID-ef-sconto
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-imp è l'ID del campo ef-imp
           when 78-ID-ef-imp
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |78-ID-ef-anno è l'ID del campo ef-anno
           when 78-ID-ef-anno
                perform CONTROLLO
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                perform CONTROLLO
           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                perform CONTROLLO
           |78-ID-ef-des è l'ID del campo ef-des
           when 78-ID-ef-des
                perform CONTROLLO
           |78-ID-ef-num-ord è l'ID del campo ef-num-ord
           when 78-ID-ef-num-ord
                perform CONTROLLO
           |78-ID-ef-data è l'ID del campo ef-data
           when 78-ID-ef-data
                perform CONTROLLO
           |78-ID-ef-data-pass è l'ID del campo ef-data-pass
           when 78-ID-ef-data-pass
                perform CONTROLLO
           |78-ID-ef-age è l'ID del campo ef-age
           when 78-ID-ef-age
                perform CONTROLLO
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                perform CONTROLLO
           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                perform CONTROLLO
           |78-ID-ef-vet è l'ID del campo ef-vet
           when 78-ID-ef-vet
                perform CONTROLLO
           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                perform CONTROLLO
           |78-ID-ef-data-cons è l'ID del campo ef-data-cons
           when 78-ID-ef-data-cons
                perform CONTROLLO
           |78-ID-ef-note-4 è l'ID del campo ef-note-4
           when 78-ID-ef-note-4
                perform CONTROLLO
           |78-ID-cbo-stato è l'ID del campo cbo-stato
           when 78-ID-cbo-stato
                perform CONTROLLO
           |78-ID-ef-art è l'ID del campo ef-art
           when 78-ID-ef-art
                perform CONTROLLO
           |78-ID-ef-evadi-dal è l'ID del campo ef-evadi-dal
           when 78-ID-ef-evadi-dal
                perform CONTROLLO
           |78-ID-ef-qta è l'ID del campo ef-qta
           when 78-ID-ef-qta
                perform CONTROLLO
           |78-ID-ef-qta-oma è l'ID del campo ef-qta-oma
           when 78-ID-ef-qta-oma
                perform CONTROLLO
           |78-ID-ef-uni è l'ID del campo ef-uni
           when 78-ID-ef-uni
                perform CONTROLLO
           |78-ID-ef-sconto è l'ID del campo ef-sconto
           when 78-ID-ef-sconto
                perform CONTROLLO
           |78-ID-ef-cons è l'ID del campo ef-cons
           when 78-ID-ef-cons
                perform CONTROLLO
           |78-ID-ef-cou è l'ID del campo ef-cou
           when 78-ID-ef-cou
                perform CONTROLLO
           |78-ID-ef-imp è l'ID del campo ef-imp
           when 78-ID-ef-imp
                perform CONTROLLO
           |78-ID-ef-add è l'ID del campo ef-add
           when 78-ID-ef-add
                perform CONTROLLO
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.

       scr-conf-Open-Routine.
           PERFORM scr-conf-Scrn
           PERFORM scr-conf-Proc
           .

       scr-conf-Scrn.
           PERFORM scr-conf-Create-Win
           PERFORM scr-conf-Init-Value
           PERFORM scr-conf-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM scr-conf-DISPLAY
           .

       scr-conf-Create-Win.
           Display Floating GRAPHICAL WINDOW
              SCREEN LINE 5,
              SCREEN COLUMN 10,
              LINES 7,06,
              SIZE 64,90,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Verdana12-Occidentale,
              LINK TO THREAD,
              NO SCROLL,
              TITLE-BAR,
              TITLE TITOLO,
              WITH SYSTEM MENU,
           VISIBLE 0,
              No WRAP,
              EVENT PROCEDURE scr-conf-Event-Proc,
              HANDLE IS scr-conf-Handle,
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY scr-conf UPON scr-conf-Handle
      * DISPLAY-COLUMNS settings
           .

       scr-conf-PROC.
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, BeforeAccept>
           inquire form1-handle line   in win-line,
                                column in win-column.

           add 2,3 to win-line.
           add  26 to win-column.

           modify scr-conf-handle,   line win-line,
                                   column win-column.

           modify scr-conf-handle, visible = true.

           set scelta-attesa to true.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT scr-conf
                 ON EXCEPTION
                    PERFORM scr-conf-Evaluate-Func
                 MOVE 2 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY scr-conf-Handle
           INITIALIZE Key-Status
           .

       scr-conf-Evaluate-Func.
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM scr-conf-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM scr-conf-Exit
                 END-IF
              WHEN Key-Status = 27
                 PERFORM pb-attesa-LinkTo
              WHEN Key-Status = 1000
                 PERFORM pb-si-LinkTo
              WHEN Key-Status = 1001
                 PERFORM pb-no-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       scr-conf-CLEAR.
           PERFORM scr-conf-INIT-VALUE
           PERFORM scr-conf-DISPLAY
           .

       scr-conf-DISPLAY.
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY scr-conf UPON scr-conf-Handle
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       scr-conf-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       scr-conf-Init-Data.
           MOVE 2 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       scr-conf-Init-Value.
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, SetDefault>
      * <TOTEM:END>
           PERFORM scr-conf-FLD-TO-BUF
           .


       scr-conf-ALLGRID-RESET.
           .

      * for Form's Validation
       scr-conf-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       scr-conf-Buf-To-Fld.
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, AfterBufToFld>
      * <TOTEM:END>
           .

       scr-conf-Fld-To-Buf.
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-conf, FORM:scr-conf, AfterFldToBuf>
      * <TOTEM:END>
           .

       scr-conf-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform scr-conf-BUF-TO-FLD.
           move 0 to scelta.
           .
       scr-conf-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM scr-conf-SHOW-MSG-ROUTINE
           .

       scr-conf-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM scr-conf-DISPLAY-MESSAGE
           .

       scr-conf-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       scr-conf-Save-Status.
           .             

       scr-conf-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen scr-conf
      ***---
       scr-conf-BEFORE-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen scr-conf
      ***---
       scr-conf-AFTER-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.



       Screen1-Ta-1-TABCHANGE.
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
                   Form1-Pg-2-Visible,
           EVALUATE Screen1-Ta-1-TAB-VALUE
           WHEN 1
                  MOVE 1 TO Form1-Pg-1-Visible
                  MODIFY Screen1-Ta-1, VALUE = 1
           WHEN 2
                  MOVE 1 TO Form1-Pg-2-Visible
                  MODIFY Screen1-Ta-1, VALUE = 2
           END-EVALUATE
           MOVE 5000 TO CONTROL-ID
           DISPLAY Form1
           .

       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "Immettere l'anno dell'ordine" to 
           TOTEM-HINT-TEXT
           WHEN 5002 MOVE "Immettere la causale di magazzino" to 
           TOTEM-HINT-TEXT
           WHEN 5003 MOVE "Immettere il cliente dell'ordine" to 
           TOTEM-HINT-TEXT
           WHEN 5004 MOVE "Immettere il destino del Cliente" to 
           TOTEM-HINT-TEXT
           WHEN 5005 MOVE "Digitare il numero d'ordine relativo al Clien
      -    "te" to TOTEM-HINT-TEXT
           WHEN 5006 MOVE "Digitare la data dell'ordine" to 
           TOTEM-HINT-TEXT
           WHEN 5007 MOVE "Digitare il codice Gest Plus" to 
           TOTEM-HINT-TEXT
           WHEN 5008 MOVE "Digitare la data di passaggio dell'ordine" 
           to TOTEM-HINT-TEXT
           WHEN 5009 MOVE "Digitare il codice dell'agente" to 
           TOTEM-HINT-TEXT
           WHEN 5010 MOVE "Indica il ritiro della merce direttamente pre
      -    "sso la sede Lubex" to TOTEM-HINT-TEXT
           WHEN 5011 MOVE "Digitare il codice di pagamento" to 
           TOTEM-HINT-TEXT
           WHEN 5012 MOVE "Indica che l'ordine sarà evaso solo totalment
      -    "e" to TOTEM-HINT-TEXT
           WHEN 5013 MOVE "Digitare il codice d'esenzione IVA" to 
           TOTEM-HINT-TEXT
           WHEN 5015 MOVE "Digitare il codice del vettore" to 
           TOTEM-HINT-TEXT
           WHEN 5017 MOVE "Digitare il codice del fornitore associato (r
      -    "eso)" to TOTEM-HINT-TEXT
           WHEN 5020 MOVE "Digitare i dati di consegna" to 
           TOTEM-HINT-TEXT
           WHEN 5021 MOVE "Digitare la data di consegna" to 
           TOTEM-HINT-TEXT
           WHEN 5022 MOVE "Digitare le note di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5023 MOVE "Digitare le note di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5024 MOVE "Digitare le note di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5027 MOVE "Selezionare uno stato" to TOTEM-HINT-TEXT
           WHEN 5028 MOVE "Digitare il codice dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5029 MOVE "Data di evadibilit" to TOTEM-HINT-TEXT
           WHEN 5030 MOVE "Indica se l'articolo selezionato è da conside
      -    "rarsi componente di un blister" to TOTEM-HINT-TEXT
           WHEN 5031 MOVE "Digitare la quantit" to TOTEM-HINT-TEXT
           WHEN 5032 MOVE "Digitare la quantità che s'intende come omagg
      -    "io" to TOTEM-HINT-TEXT
           WHEN 5033 MOVE "Digitare il prezzo unitario" to 
           TOTEM-HINT-TEXT
           WHEN 5034 MOVE "Percentuale di sconto" to TOTEM-HINT-TEXT
           WHEN 5035 MOVE "Valore imposta sul consumo" to 
           TOTEM-HINT-TEXT
           WHEN 5036 MOVE "Valore imposta COU/COBAT" to TOTEM-HINT-TEXT
           WHEN 5037 MOVE "Valore imponibile della merce" to 
           TOTEM-HINT-TEXT
           WHEN 5038 MOVE "Codice I.V.A." to TOTEM-HINT-TEXT
           WHEN 5039 MOVE "Valore addizionale piombo" to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-anno-BeforeProcedure
           When 5002 PERFORM ef-cau-BeforeProcedure
           When 5003 PERFORM ef-cli-BeforeProcedure
           When 5004 PERFORM ef-des-BeforeProcedure
           When 5005 PERFORM ef-num-ord-BeforeProcedure
           When 5006 PERFORM ef-data-BeforeProcedure
           When 5007 PERFORM ef-gest-BeforeProcedure
           When 5008 PERFORM ef-data-pass-BeforeProcedure
           When 5009 PERFORM ef-age-BeforeProcedure
           When 5010 PERFORM chk-ritira-BeforeProcedure
           When 5011 PERFORM ef-pag-BeforeProcedure
           When 5012 PERFORM chk-evas-tot-BeforeProcedure
           When 5013 PERFORM ef-iva-BeforeProcedure
           When 5015 PERFORM ef-vet-BeforeProcedure
           When 5017 PERFORM ef-vet-BeforeProcedure
           When 5020 PERFORM ef-note-1-BeforeProcedure
           When 5021 PERFORM ef-data-cons-BeforeProcedure
           When 5022 PERFORM ef-note-2-BeforeProcedure
           When 5023 PERFORM ef-note-3-BeforeProcedure
           When 5024 PERFORM ef-note-4-BeforeProcedure
           When 5027 PERFORM cbo-stato-BeforeProcedure
           When 5028 PERFORM ef-art-BeforeProcedure
           When 5029 PERFORM ef-cou-BeforeProcedure
           When 5030 PERFORM Form1-DaCb-1-BeforeProcedure
           When 5031 PERFORM ef-qta-BeforeProcedure
           When 5032 PERFORM ef-qta-BeforeProcedure
           When 5033 PERFORM ef-uni-BeforeProcedure
           When 5034 PERFORM ef-sconto-BeforeProcedure
           When 5035 PERFORM ef-cons-BeforeProcedure
           When 5036 PERFORM ef-cou-BeforeProcedure
           When 5037 PERFORM ef-imp-BeforeProcedure
           When 5038 PERFORM ef-cod-iva-BeforeProcedure
           When 5039 PERFORM ef-cou-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Form1-AfterProcedure.
           EVALUATE Control-Id
           When 5001 PERFORM ef-anno-AfterProcedure
           When 5002 PERFORM ef-cau-AfterProcedure
           When 5003 PERFORM ef-cli-AfterProcedure
           When 5004 PERFORM ef-des-AfterProcedure
           When 5005 PERFORM ef-num-ord-AfterProcedure
           When 5006 PERFORM ef-data-AfterProcedure
           When 5007 PERFORM ef-gest-AfterProcedure
           When 5008 PERFORM ef-data-pass-AfterProcedure
           When 5009 PERFORM ef-age-AfterProcedure
           When 5010 PERFORM chk-ritira-AfterProcedure
           When 5011 PERFORM ef-pag-AfterProcedure
           When 5012 PERFORM chk-evas-tot-AfterProcedure
           When 5013 PERFORM ef-iva-AfterProcedure
           When 5014 PERFORM chk-saldi-banco-AfterProcedure
           When 5015 PERFORM ef-vet-AfterProcedure
           When 5016 PERFORM chk-saldi-bancoa-AfterProcedure
           When 5017 PERFORM ef-vet-AfterProcedure
           When 5018 PERFORM chk-urgente-AfterProcedure
           When 5019 PERFORM chk-saldi-bancoa-AfterProcedure
           When 5020 PERFORM ef-note-1-AfterProcedure
           When 5021 PERFORM ef-data-cons-AfterProcedure
           When 5022 PERFORM ef-note-2-AfterProcedure
           When 5023 PERFORM ef-note-3-AfterProcedure
           When 5024 PERFORM ef-note-4-AfterProcedure
           When 5025 PERFORM Form1-DaEf-1-AfterProcedure
           When 5026 PERFORM Form1-DaEf-1-AfterProcedure
           When 5028 PERFORM ef-art-AfterProcedure
           When 5029 PERFORM ef-cou-AfterProcedure
           When 5030 PERFORM Form1-DaCb-1-AfterProcedure
           When 5031 PERFORM ef-qta-AfterProcedure
           When 5032 PERFORM ef-qta-AfterProcedure
           When 5033 PERFORM ef-uni-AfterProcedure
           When 5034 PERFORM ef-sconto-AfterProcedure
           When 5035 PERFORM ef-cons-AfterProcedure
           When 5036 PERFORM ef-cou-AfterProcedure
           When 5037 PERFORM ef-imp-AfterProcedure
           When 5038 PERFORM ef-cod-iva-AfterProcedure
           When 5039 PERFORM ef-cou-AfterProcedure
           END-EVALUATE
           perform Form1-AFTER-SCREEN
           .

       Form1-Event-Proc.
           .

       Screen1-Ta-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Cmd-Tabchanged ALSO 5000 ALSO
                    Form1-Handle
              PERFORM Screen1-Ta-1-Ev-Cmd-Tabchanged
           END-EVALUATE
           .

       Form1-Gd-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Goto-Cell-Mouse
           END-EVALUATE
           .

       scr-conf-Event-Proc.
           .

      * USER DEFINE PARAGRAPH
       ABILITAZIONI.
      * <TOTEM:PARA. ABILITAZIONI>
      *     modify cbo-stato,     enabled mod.
           modify tool-modifica,   value 1.             
           move BitmapNewDisabled     to BitmapNumNew.
           move BitmapDeleteDisabled  to BitmapNumDelete.
           move BitmapEditDisabled    to BitmapNumEdit.
           move BitmapPrintDisabled   to BitmapNumPrint.
           move BitmapPreviewDisabled to BitmapNumPreview.
           move BitmapSelectDisabled  to BitmapNumSelect.

           if livello-abil > 1 move BitmapSaveEnabled  to BitmapNumSave
                               move 1                  to e-salva
           else                move BitmapSaveDisabled to BitmapNumSave
                               move 0                  to e-salva
           end-if.

           move 0 to e-cancella 
                     e-anteprima 
                     e-stampa 
                     e-nuovo
                     e-seleziona
                     e-modifica.
                           

           if mod = 1
              inquire cbo-stato,   value cbo-stato-buf
              if cbo-stato-buf not = "Attivo" 
                 move 1 to mod-campi
                 if chk-ritira-buf = zero
                    move 1      to mod-vettori
                 else
                    move zero   to mod-vettori
                 end-if
              else
                 move 0 to mod-campi
                           mod-vettori
              end-if
              move 0 to mod-k mod-cliente-destino mod-destino
           else
              move 1 to mod-k mod-cliente-destino mod-destino
              move 0 to mod-campi
                        mod-vettori
           end-if.
           perform DISPLAY-SCREEN.
                                                      
           modify tool-nuovo,     enabled = e-nuovo,
                                  bitmap-number = BitmapNumNew.
           modify tool-cancella,  enabled = e-cancella,
                                  bitmap-number = BitmapNumDelete.
           modify tool-modifica,  enabled = e-modifica,
                                  bitmap-number = BitmapNumEdit.
           modify tool-anteprima, enabled = e-anteprima,
                                  bitmap-number = BitmapNumPreview.
           modify tool-stampa,    enabled = e-stampa,
                                  bitmap-number = BitmapNumPrint.
           modify tool-seleziona, enabled = e-seleziona,
                                  bitmap-number = BitmapNumSelect.
           modify tool-salva,     enabled = e-salva,
                                  bitmap-number = BitmapNumSave 
           .
      * <TOTEM:END>

       CHANGE-STATUS.
      * <TOTEM:PARA. CHANGE-STATUS>
           evaluate nome-file
           when "clienti"
                set chiuso to true
                perform CARICA-COMBO-STATO
                |specifico per i pgm. aventi Tab-Control
                move 1 to Screen1-Ta-1-TAB-VALUE
                perform SCREEN1-TA-1-TABCHANGE
                |******
                move 1 to mod
                move 0 to mod-campi
                          mod-vettori
                perform DISPLAY-SCREEN
           end-evaluate 
           .
      * <TOTEM:END>

       CLEAR-SCREEN.
      * <TOTEM:PARA. CLEAR-SCREEN>
      *     move cli-codice to old-cli-codice.
      *    
           initialize mto-rec  
                      cli-rec
                      des-rec
                      mro-rec replacing numeric data by zeroes
                                   alphanumeric data by spaces.
                        
           perform FORM1-FLD-TO-BUF. 
      
           perform INIT-OLD-REC.

           move spaces to lab-vet-buf 
                          lab-iva-buf 
                          lab-pag-buf 
                          lab-age-buf.
      
           perform DISPLAY-SCREEN.
      *
      *     perform RESET-GRIGLIA 
           .
      * <TOTEM:END>

       COLORE.
      * <TOTEM:PARA. COLORE>
           modify form1-gd-1, start-y = riga, y = riga,
                              start-x = 2,    x = 78-NumColMan,
                              region-color = 144 
           .
      * <TOTEM:END>

       DISPLAY-SCREEN.
      * <TOTEM:PARA. DISPLAY-SCREEN>
           display form1 
           .
      * <TOTEM:END>

       DISPLAY-SCREEN-MANUALE.
      * <TOTEM:PARA. DISPLAY-SCREEN-MANUALE>
           modify form1-gd-1, reset-grid  = 1.
           perform INTESTAZIONE.
           set FirstTime to false.
           move 1 to v-manuale.
           set lab-imp-coubat to true.
           display lab-imposta 
           .
      * <TOTEM:END>

       ENTRY-TO-ROW.
      * <TOTEM:PARA. ENTRY-TO-ROW>
           inquire form1-gd-1, last-row in tot-righe.
           inquire ef-art, value in art-codice.

           if NewRow
              display ef-cons ef-cou     ef-sconto ef-qta-oma
                      ef-qta  ef-cod-iva ef-uni    ef-imp lab-iva-2
              add 1 to tot-righe    giving riga
              move art-codice to old-art-codice
              modify form1-gd-1, insert-rows 1
              add 1        to LastPrg
              move LastPrg to col-num     
              perform COLORE
           else
              inquire form1-gd-1, cursor-y in riga        
           end-if. 

           if link-imballo-saved = 1
              move lab-art-buf to col-des
              move link-qta    to hid-imballi 
              move ef-qta-buf  to col-qta
              move link-des    to hid-des-imballo
              move 0           to link-imballo-saved
           end-if. 

           move ef-qta-oma-buf    to hid-qta-omaggi.
           move chk-blister-buf   to hid-blister.

           if hid-blister = 1 and hid-imballi not = 0
      *    Luciano start
      *        move ef-qta-buf to hid-imballi imballi-ed
              move ef-qta-buf to hid-imballi
              compute hid-imballi = hid-imballi / hid-bli-qta
              move hid-imballi  to imballi-ed
      *    Luciano Fine
              read articoli invalid continue end-read
              move "BLISTER" to link-des
              perform DESCRIZIONE-IMBALLO
           end-if.

           move ef-evadi-dal-buf  to como-data.
           perform DATE-TO-FILE.
           move como-data to hid-evadi-dal.

           move tbliv-percentuale to hid-perce-iva.
           move tbliv-codice2     to hid-cod-iva.  
                                    
           move col-cons to como-cons.
           move col-cou  to como-cou.
           move col-add  to como-add.
           move col-imp  to como-imp.
           move col-qta  to como-qta.
           compute como-tot = 
           ( como-cou + como-cons + como-add + como-imp ) * como-qta.
           move como-tot to col-tot.

           modify form1-gd-1(riga, 1),  cell-data = col-num.
           modify form1-gd-1(riga, 2),  cell-data = col-art.
           modify form1-gd-1(riga, 3),  cell-data = col-des.
           modify form1-gd-1(riga, 4),  cell-data = col-qta.
           modify form1-gd-1(riga, 5),  cell-data = col-uni.
           modify form1-gd-1(riga, 6),  cell-data = col-tot.
           modify form1-gd-1(riga, 7),  cell-data = col-cons.
           modify form1-gd-1(riga, 8),  cell-data = col-cou. 
           modify form1-gd-1(riga, 9),  cell-data = col-add.
           modify form1-gd-1(riga, 10), cell-data = col-imp.
           modify form1-gd-1(riga, 11), cell-data = col-iva.

           move col-uni to SavePrezzo.
           if SavePrezzo = 0
LUBEXX        if tca-si-speciale              
LUBEXX           modify form1-gd-1(riga, 78-NumColMan),
LUBEXX           bitmap        = conferma-bmp
LUBEXX           bitmap-number = 2
LUBEXX           bitmap-width  = 19
LUBEXX        else
                 modify form1-gd-1(riga, 78-NumColMan),
                 bitmap        = conferma-bmp
                 bitmap-number = 1
                 bitmap-width  = 19
LUBEXX        end-if
              move "S" to hid-omaggio
           else           
              modify form1-gd-1(riga, 78-NumColMan),
              bitmap        = conferma-bmp
              bitmap-number = 2
              bitmap-width  = 19
           end-if.

           move 78-ID-ef-art to control-id.
           move 4            to accept-control 

           modify form1-gd-1, cursor-y = riga.
           set NewRow         to true.

           modify form1-gd-1(riga, 1), hidden-data gruppo-hidden 
           .
      * <TOTEM:END>

       INIT.
      * <TOTEM:PARA. INIT>
           set FirstTime        to true.
           set NonCambiareTab   to false.
           set ArticoloSetFocus to false.
           set ControllaCampi   to true.
           set CheckAfterZoom   to false.
           move 0 to v-manuale v-guidata old-art-codice.
           move 1 to event-data-1 screen1-ta-1-tab-value.
           perform SCREEN1-TA-1-TABCHANGE.
           perform CLEAR-SCREEN.
           move 0 to StatusHelp LastPrg.

           move como-anno to ef-anno-buf.
           display ef-anno.

           move data-oggi to como-data.
           perform DATE-TO-SCREEN.
           move como-data to ef-data-buf ef-data-pass-buf.
           display ef-data ef-data-pass.

           move spaces to lab-art-buf lab-pag-buf lab-iva-buf 
                          lab-iva-2-buf.

           move 0 to LastPrg.

           move 78-ID-ef-cau to control-id.
           move 4 to accept-control.
      *
           |Riempio il tabellino contenente i riferimenti agli ID
           |relativi ad ogni pagina del tab-control
           |specifico per i pgm. aventi Tab-Control
           move 78-ID-ef-num-ord       to min-id(1).
           move 78-ID-cbo-stato        to max-id(1).
           |*******
      *
           Perform RIEMPI-COMBO-STATO.
      *
           move "Attivo" to cbo-stato-buf.
           Modify  cbo-stato,   value cbo-stato-buf.

           move 0 to mod.

           move tge-causale-ordini-std to ef-cau-buf tca-codice.
           read tcaumag invalid continue end-read.
           move tca-descrizione to lab-cau-buf.
           display ef-cau lab-cau.
           move 0 to como-tot-ivato.

           set NewRow to true 
           .
      * <TOTEM:END>

       LEGGI-ANNO.
      * <TOTEM:PARA. LEGGI-ANNO>
           move spaces to tge-codice.
           move 0 to tge-anno.
           read tparamge no lock invalid continue end-read.
           move tge-anno to ef-anno-buf.
           move tge-cod-iva-omag to iva-omaggio tbliv-codice2.
           move "IV"             to tbliv-codice1.
           read tivaese invalid continue end-read.
           perform MOVE-DESCR-IVA-2.        
           move lab-iva-2-buf to save-descr-iva.
           move spaces to lab-iva-2-buf.
           display ef-anno 
           .
      * <TOTEM:END>

       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "abilita-toolbar.cpy".
           copy "riempi-combo-ordine-m.cpy".
           copy "color-custom.cpy".
           copy "utydata.cpy". 
           copy "ordine-procedure.cpy".
           copy "addizionale-piombo.cpy".
           copy "recupera-prz-listino.cpy".
      *****     copy "recupero-prezzi-tradizionale.cpy".
           copy "direziona-impegnato-common.cpy".
           copy "trova-parametro.cpy".
           copy "costo-medio.cpy".
           copy "recupero-anagrafica.cpy".
           copy "accessoxx.cpy" 
           .
      * <TOTEM:END>

       RESET-GRIGLIA.
      * <TOTEM:PARA. RESET-GRIGLIA>
           modify form1-gd-1, reset-grid = 1.
           perform FORM1-GD-1-CONTENT 
           .
      * <TOTEM:END>

       ROW-TO-ENTRY.
      * <TOTEM:PARA. ROW-TO-ENTRY>
      *    Questo prf. porta i dati da grid a entry-field
      *    quando rec-grd e rec-not sono valorizzati         
         
           inquire form1-gd-1(riga, 1),  cell-data in col-num.
           inquire form1-gd-1(riga, 2),  cell-data in col-art.
           inquire form1-gd-1(riga, 3),  cell-data in col-des.
           inquire form1-gd-1(riga, 4),  cell-data in col-qta.
           inquire form1-gd-1(riga, 5),  cell-data in col-uni.
           inquire form1-gd-1(riga, 6),  cell-data in col-tot.
           inquire form1-gd-1(riga, 7),  cell-data in col-cons.
           inquire form1-gd-1(riga, 8),  cell-data in col-cou.
           inquire form1-gd-1(riga, 9),  cell-data in col-add.
           inquire form1-gd-1(riga, 10), cell-data in col-imp.
           inquire form1-gd-1(riga, 11), cell-data in col-iva.

           inquire form1-gd-1(riga, 1), hidden-data gruppo-hidden.

LUBEXX     move col-art  to art-codice.
LUBEXX     read articoli no lock invalid continue end-read.
LUBEXX*****     move art-imballo-standard to imq-codice.
LUBEXX     move hid-tipo-imballo to imq-codice.
LUBEXX     read timbalqta no lock invalid continue end-read.

           move col-art    to ef-art-buf  old-art-codice art-codice.
           set lab-imp-coubat to true.
           read articoli invalid continue end-read.
           if art-si-cobat
              set lab-imp-cobat to true
           else                        
              set lab-imp-cou   to true
           end-if.
           move col-des    to lab-art-buf.
           move col-qta    to ef-qta-buf mro-qta.
OMAGGI     move hid-qta-omaggi to ef-qta-oma-buf mro-qta-omaggi.
BLISTR     move hid-blister to chk-blister-buf.
           move hid-evadi-dal to mro-evadi-dal.
           move hid-evadi-dal to como-data.
           perform DATE-TO-SCREEN.
           move como-data  to ef-evadi-dal-buf.
           move col-uni    to ef-uni-buf old-prezzo mro-prz-unitario.
           move 0          to ef-sconto-buf mro-perce-sconto.
           move col-cons   to ef-cons-buf   mro-imp-consumo.
           move col-cou    to ef-cou-buf    mro-imp-cou-cobat.
           move col-add    to ef-add-buf    mro-add-piombo.
           move col-imp    to ef-imp-buf    mro-imponib-merce.
           move col-iva    to ef-cod-iva-buf tbliv-codice2 mro-cod-iva.
           move spaces     to tbliv-descrizione1 tbliv-descrizione2.
           move "IV"       to tbliv-codice1.
           read tivaese no lock invalid continue end-read.
           perform MOVE-DESCR-IVA-2.

           perform DISPLAY-SCREEN.

           move hid-giacenza  to prg-giacenza.
           move hid-impegnato to prg-impegnato.
           move hid-ordinato  to save-ordinato.
           perform LABEL-VALORI.
           perform DISPLAY-SCREEN.
           set NewRow         to false.
           move HiddenKey     to prg-chiave 
           .
      * <TOTEM:END>

       SALVA.
      * <TOTEM:PARA. SALVA>
           if mod-k = 1 exit paragraph end-if.
                                                
           set SaveXX to true.
           perform ACCESSOXX.

           move BitmapSaveDisabled to BitmapNumSave.
           move 0 to e-salva.
           modify tool-salva, 
                  enabled = e-salva,
            bitmap-number = BitmapNumSave.

           set tutto-ok to true.

           set StoSalvando to true.

           perform CHECK-PAGE-1.

           set StoSalvando to false.

           if tutto-ok
              if tutto-ok
                 perform CONTA-ZERI-MAN
                 if not trovato
                    display message "Impossibile registrare l'ordine in"
                                    " quanto non sono presenti righe."
                            title = tit-err
                            icon mb-warning-icon
                    set errori to true
                    perform CANCELLA-COLORE
                 else
                    move 78-ID-cbo-stato to CONTROL-ID
                    perform CONTROLLO
                 end-if
              end-if
           end-if.

           if errori
              inquire Screen1-Ta-1, value in pagina
              |******
              if store-id >= min-id(pagina) and
                 store-id <= max-id(pagina)
                 move store-id to CONTROL-ID
              end-if
              |******
              move 4 to accept-control
           else
      *****        if OrdineTradizionale
      *****           move mto-data-ordine to tor-data-ordine
      *****           perform RECUPERO-PREZZI-TRADIZIONALE
      *****           perform PULISCI-CAMPI-LABELS
      *****           perform SCR-CONF-OPEN-ROUTINE
      *****           evaluate true
      *****           when scelta-si      
      *****                perform CONTINUA-SALVATAGGIO
      *****           when scelta-attesa  
      *****                continue
      *****           when scelta-annulla 
      *****                perform TORNA-IN-VISUA
      *****           end-evaluate
      *****        else
                 perform CONTINUA-SALVATAGGIO
      *****        end-if
           end-if.

           perform DISPLAY-SCREEN.

           set environment "KEYSTROKE" to "DATA=44   44".
           set environment "KEYSTROKE" to "DATA=46   46".

PATCH      move BitmapSaveEnabled to BitmapNumSave
PATCH      move 1 to e-salva.
PATCH      modify tool-salva, 
PATCH             enabled = e-salva,
PATCH       bitmap-number = BitmapNumSave.

           perform DESTROYXX.

      ***---
       CONTINUA-SALVATAGGIO.
           perform CONTROLLA-TOTALE-MAN.
           if tutto-ok
              if tcl-si-gestione-fido or cli-gestione-fido-si
                 perform CONTROLLA-FUORI-FIDO
              end-if
      *****        if tutto-ok and cli-gestione-fido-si and cli-attivo
      *****           initialize calfido-linkage 
      *****                       sitfin-linkage
      *****                      replacing numeric data by zeroes
      *****                           alphanumeric data by spaces
      *****           move ef-cli-buf   to link-cli-codice
      *****           call "C$JUSTIFY"  using link-cli-codice, "R"
      *****           inspect link-cli-codice 
      *****                   replacing leading x"20" by x"30"
      *****           move Sum to sitfin-importo
      *****           call   "sitfin"  using sitfin-linkage
      *****                                 calfido-linkage
      *****           cancel "sitfin"
      *****           display message "Confermi l'ordine?"
      *****                      title titolo
      *****                       type mb-yes-no
      *****                       icon 2
      *****                     giving scelta
      *****           if scelta = mb-no
      *****              set errori to true
      *****           end-if
      *****        end-if
           end-if.

           if errori
              perform CANCELLA-COLORE
           else
              perform CONTA-CODICI-IVA-MAN

              if tutto-ok
                 perform CONTROLLA-QTA-BLISTER
              else
                 display message
                 "Impossibile registrare il documento in quanto"
                 " sono presenti più di tre codici IVA"
                         title = tit-err
                         icon mb-warning-icon
                 set errori to true
                 perform CANCELLA-COLORE
              end-if

              if tutto-ok
                 perform VALORIZZA-NUMERO
                 if tutto-ok
                    move cli-gdo to mto-gdo
                    perform FORM1-BUF-TO-FLD
                    perform SCRIVI-RIGHE-MAN
                    perform CANCELLA-COLORE

LABLAB              if si-promo set mto-si-promo to true
LABLAB              else        set mto-no-promo to true
LABLAB              end-if

PATCH               if mto-numero = 0
PATCH                  display message "EVASIONE ZERO"
PATCH                           x"0d0a""RICARICARE L'ORDINE"
PATCH                            title tit-err
PATCH                             icon 3
PATCH               end-if

                    set mto-registrato to true
                    move qta-tot to mto-pz-tot

                    move "C" to mto-tipo-CF

                    if mto-chiuso-man
                       set mto-chiuso to true
                    end-if

                    if TrovataScortaForzata
                       set mto-saldi-banco-si to true
                       set mto-saldi-promo-si to true
                    end-if

                    write mto-rec invalid rewrite mto-rec end-write

                    unlock mtordini all record

                    if mto-chiuso
                       if save-tpr-codice not = 0
                          perform RIGHE-PROMO-FITTIZIE
                       end-if
                    else
                       perform SOSTITUZIONE-ARTICOLO
                       if save-tpr-codice not = 0
                          perform RIGHE-PROMO-FITTIZIE
                       end-if
                    end-if
           
                    if mto-causale = tge-causale-omag
                       initialize geslock-linkage 
                                  replacing numeric data by zeroes
                                       alphanumeric data by spaces
                       move 1 to geslock-v-salva
                       set geslock-omom to true
                       move "RICORDARSI D'INSERIRE DETTAGLI PROMOZIONE!"
                         to geslock-messaggio
                       perform 5 times
                          call   "geslock" using geslock-linkage
                          cancel "geslock"
                       end-perform
                    end-if

                    call   "st-ordine-m" using mto-chiave, 
                                               link-path,
                                               "I"
                    cancel "st-ordine-m"

                    call   "check-prog-master" using mto-chiave,
                                                     "U"
                    cancel "check-prog-master"

                    perform TORNA-IN-VISUA
                 else
                    move 27 to key-status
                 end-if
              end-if
           end-if.

      *    Luciano
      *    se ho degli errori in salvataggio rimane una situazione sporca 
      *    sulle righe, forzo la situazione di una riga nuova
           if errori
              perform PULISCI-CAMPI-LABELS
              perform CANCELLA-COLORE
              move 78-ID-ef-art to control-id
              move 4            to accept-control
              set  NewRow       to true
              set  ControllaCampi to true
           end-if.
      *    Luciano fine

      ***---
       TORNA-IN-VISUA.
           move 1 to mod-k mod-cliente-destino mod-destino.
           move 0 to mod 
                     mod-campi
                     mod-vettori.
           move 0 to v-dett v-blister v-gdo v-forza.

           perform INIT.
           perform RESET-GRIGLIA.
           initialize gruppo-hidden old-art-codice.
                     
           set OrdineTradizionale to false.
           perform VALORIZZA-OLD.
           perform ABILITAZIONI.
           perform SECCA-TMP-ASSORCLI.
           perform LEGGI-ANNO.
LABLAB     move 0      to volantino-forzato.
LABLAB     move spaces to lab-forzato-buf.
LABLAB     display lab-forzato 
           .
      * <TOTEM:END>

       SCRIVI-RIGHE-MAN.
      * <TOTEM:PARA. SCRIVI-RIGHE-MAN>
LABLAB     set ordine-bloccato to false.
LABLAB     set no-promo        to true.
           inquire form1-gd-1, last-row in tot-righe.
           move 0 to store-riga qta-tot progressivo save-tpr-codice
                     mto-promo-fittizia.
           set HoSalvato to true.
           set TrovataScortaForzata to false.
           perform varying riga from 2 by 1 
                     until riga > tot-righe
              initialize mro-rec replacing numeric data by zeroes
                                      alphanumeric data by spaces
              move mto-anno   to mro-anno

              move mto-numero to mro-numero
              
PATCH**              inquire form1-gd-1(riga, 1), cell-data in col-num
PATCH**              move col-num to mro-num-riga

PATCH         subtract 1 from riga giving mro-riga
PATCH         modify form1-gd-1(riga, 1), cell-data mro-riga

              inquire form1-gd-1(riga, 2), cell-data in col-art
              move col-art to mro-cod-articolo
                                                              
              inquire form1-gd-1(riga, 4), cell-data in col-qta
              move col-qta  to mro-qta
              
              inquire form1-gd-1(riga, 5), cell-data in col-uni
              move col-uni to mro-prz-unitario

              |inquire form1-gd-1(riga, 6), cell-data in col-sconto
              move 0 to mro-perce-sconto

              inquire form1-gd-1(riga, 7), cell-data in col-cons
              move col-cons to mro-imp-consumo

              inquire form1-gd-1(riga, 8), cell-data in col-cou
              move col-cou to mro-imp-cou-cobat

              inquire form1-gd-1(riga, 9), cell-data in col-add
              move col-add to mro-add-piombo

              inquire form1-gd-1(riga, 10), cell-data in col-imp
              move col-imp to mro-imponib-merce

LUBEXX        if ef-iva-buf = spaces
                 inquire form1-gd-1(riga, 11), cell-data in col-iva
                 move col-iva to mro-cod-iva
LUBEXX        else
LUBEXX           if mro-prz-unitario = 0
LUBEXX              inquire form1-gd-1(riga, 11) cell-data in col-iva
LUBEXX              move col-iva to mro-cod-iva
LUBEXX           else
LUBEXX              move ef-iva-buf to mro-cod-iva
LUBEXX           end-if
LUBEXX        end-if               

LUBEXX*****        if not EsisteIVA
LUBEXX*****           perform CONTROLLA-PERCENTUALE-IVA
LUBEXX*****        end-if

              if mro-prz-unitario = 0
LUBEXX           if tca-no-speciale
LUBEXX              set mro-si-omaggio to true
LUBEXX           else
LUBEXX              set mro-no-omaggio to true
LUBEXX           end-if
              else
                 set mro-no-omaggio to true
              end-if

              inquire form1-gd-1(riga, 1), hidden-data in gruppo-hidden
              if hid-si-prz-promo set mro-si-prz-promo to true
              else                set mro-no-prz-promo to true
              end-if

      *****        inquire form1-gd-1(riga, 78-NumColMan + 5),  hidden-data 
      *****             in hid-imballi
              move hid-imballi to mro-qta-imballi

      *****        inquire form1-gd-1(riga, 78-NumColMan + 7), hidden-data in
      *****             hid-des-imballo
              move hid-des-imballo to mro-des-imballo

      *****        inquire form1-gd-1(riga, 78-NumColMan + 8), hidden-data in 
      *****        hid-cod-art-cli
              move hid-cod-art-cli to mro-cod-art-cli

      *****        inquire form1-gd-1(riga, 78-NumColMan + 12), hidden-data 
      *****        in hid-utf

      *****        inquire form1-gd-1(riga, 78-NumColMan + 13), hidden-data 
      *****        in hid-non-utf

      *****        inquire form1-gd-1(riga, 78-NumColMan + 18), 
      *****                hidden-data in hid-qta-omaggi
OMAGGI        move hid-qta-omaggi to mro-qta-omaggi     
              move hid-evadi-dal  to mro-evadi-dal

      *****        inquire form1-gd-1(riga, 78-NumColMan + 19), 
      *****                hidden-data in hid-blister
BLISTR        move hid-blister to mro-blister

BLISTR        move hid-bli-codice to mro-bli-codice
BLISTR        move hid-bli-perce  to mro-bli-perce
      *    Luciano
              move hid-bli-qta     to mro-bli-qta
      *    Luciano fine

BLISTR        if hid-blister = 0
                 compute mro-num-colli = mro-qta / hid-imballi
BLISTR        else
BLISTR           move hid-imballi to mro-num-colli
BLISTR        end-if

LABLAB*****        inquire form1-gd-1(riga, 78-NumColMan + 20), 
      *****                hidden-data in hid-flag-bloccato
                  
LABLAB        if hid-bloccato
                 if mro-prz-unitario >= 999999
LABLAB              set ordine-bloccato to true
                    set mro-bloccato-prezzo-si to true
                 end-if
              else                                 
                 set mro-bloccato-prezzo-no to true
LABLAB        end-if

LABLAB*****        inquire form1-gd-1(riga, 78-NumColMan + 21),
      *****                hidden-data in hid-promo
LABLAB        move hid-promo to mro-promo 

      *    Luciano
              set mro-prz-manuale-no  to true
      *    Luciano Fine

              move mto-dati-comuni to mro-dati-comuni

      *****        inquire form1-gd-1(riga, 78-NumColMan + 1),  hidden-data 
      *****        in hid-cod-articolo
      *****        inquire form1-gd-1(riga, 78-NumColMan + 2),  hidden-data 
      *****        in hid-cod-magazzino
      *****        inquire form1-gd-1(riga, 78-NumColMan + 3),  hidden-data 
      *****        in hid-tipo-imballo
      *****        inquire form1-gd-1(riga, 78-NumColMan + 4),  hidden-data 
      *****        in hid-peso

LUBEXX*       Controllo che non ci sia discrepanza tra articolo
LUBEXX*       venduto (mrordini) ed articolo scaricato (progmag)
LUBEXX        if hid-cod-articolo not = mro-cod-articolo
LUBEXX           perform VALORIZZA-PROGRESSIVO-CORRETTO
LUBEXX        end-if

              if CallWProgmag
                 initialize link-wprogmag
                 set link-update      to true
                 move HiddenKey       to link-key
                 move ef-cau-buf      to link-causale
                 move mro-qta         to link-valore link-impegnato
                 move user-codi       to link-user of link-wprogmag
                 perform VALORIZZA-ARRAY-CAUSALI
      
                 call   "wprogmag" using link-wprogmag
                 cancel "wprogmag"
              end-if

              move HiddenKey to mro-prg-chiave prg-chiave
              perform FORZA-PESO-UGUALE

              accept como-ora from time
              move data-oggi to mro-data-creazione
              move como-ora  to mro-ora-creazione
              move user-codi to mro-utente-creazione

              if mro-promo = 0 and chk-prenot-buf = 1
                 if save-tpr-codice = 0
                    perform PROMO-FITTIZIA-TESTA
                 end-if
                 move save-tpr-codice to mro-promo
              end-if

LABLAB        if mro-promo not = 0
LABLAB           set  si-promo  to true
LABLAB        end-if

PATCH         if mro-numero = 0
PATCH            display message "EVASIONE ZERO"
PATCH                     x"0d0a""RICARICARE L'ORDINE"
PATCH                      title tit-err
PATCH                       icon 3
PATCH         end-if
                                                             
              add 1 to progressivo
              move progressivo   to mro-progr
              set mro-registrato to true
              write mro-rec invalid rewrite mro-rec end-write
              add mro-qta to qta-tot

              move mro-cod-articolo to art-codice
              read articoli 
              move art-scorta to sco-codice
              read tscorte no lock
              if sco-forzata-saldi-si
                 set TrovataScortaForzata to true
              end-if

           end-perform.
                                      
LABLAB     if ordine-bloccato
LABLAB        set mto-bloccato              to true
              set mto-causale-blocco-prezzo to true
LABLAB     end-if 
           .
      * <TOTEM:END>

       VALORIZZA-NUMERO.
      * <TOTEM:PARA. VALORIZZA-NUMERO>
           inquire ef-anno value in ef-anno-buf.
           move ef-anno-buf   to link-anno.

           set  link-ordine   to true.
           set  link-crea     to true.
           move ef-cau-buf    to link-nambar-causale.

           call   "nambar" using link-nambar.
           cancel "nambar".
           
           if link-status-nambar = -1 set errori       to true
           else                       move link-numero to mto-numero
           end-if 
           .
      * <TOTEM:END>

       VALORIZZA-OLD.
      * <TOTEM:PARA. VALORIZZA-OLD>
      *     move cli-rec                 to old-cli-rec.
      *     move rec-rec                 to old-rec-rec.
      *     set vecchio                  to true.
      *
      *     if old-cli-utf = space
      *        move "N" to old-cli-utf
      *     end-if.
      *
      *     if old-cli-inoltro = space
      *        move "N" to old-cli-inoltro
      *     end-if.         
      *     
      *     if old-cli-superamento-500 = spaces
      *        move "N" to old-cli-superamento-500
      *     end-if.
      *
      *     if old-cli-spost-ric-agosto = space
      *        move "N" to old-cli-spost-ric-agosto
      *     end-if.                       
      *
      *     if old-cli-spost-ric-dicembre = space
      *        move "N" to old-cli-spost-ric-dicembre
      *     end-if.           
      *     
      *     if old-cli-stato = spaces
      *        move "A" to old-cli-stato |Attivo
      *     end-if.
      *
      *     evaluate CONTROL-ID
      *     when 78-ID-ef-prov
      *     when 78-ID-ef-nazione
      *     when 78-ID-ef-tipo
      *     when 78-ID-ef-gdo
      *     when 78-ID-ef-vettore
      *     when 78-ID-ef-agente
      *     when 78-ID-ef-iva
      *     when 78-ID-ef-pag
      *     when 78-ID-ef-abi
      *     when 78-ID-ef-cab
      *     when 78-ID-ef-prov-d
      *     when 78-ID-ef-nazione-d
      *     when 78-ID-ef-vettore-d
      *     when 78-ID-ef-prov-r
      *     when 78-ID-ef-nazione-r
      *          move 1 to StatusHelp
      *     when other
      *          move 0 to StatusHelp
      *     end-evaluate.
      *     perform STATUS-HELP.
      *
      *     move 0 to riga-nuova.
      *     set DestinoCambiato to false 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           inquire tool-modifica, value in mod           
      
           inquire tool-salva, enabled in e-salva
           if e-salva = 1
              perform SALVA
           end-if           
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
      *     INQUIRE TOOL-ANTEPRIMA, ENABLED IN E-ANTEPRIMA.
      *     IF E-ANTEPRIMA = 1
      *          PERFORM ANTEPRIMA
      *     END-IF 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
      *     INQUIRE TOOL-MODIFICA, ENABLED IN E-MODIFICA.
      *
      *     IF E-MODIFICA = 1
      *        PERFORM MODIFICA
      *     END-IF 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
      *     INQUIRE TOOL-STAMPA, ENABLED IN E-STAMPA
      *     IF E-STAMPA = 1
      *          PERFORM STAMPA
      *     END-IF 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca
           if e-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       ef-num-ord-BeforeProcedure.
      * <TOTEM:PARA. ef-num-ord-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-data-BeforeProcedure.
      * <TOTEM:PARA. ef-data-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           set ControllaCampi to true 
           .
      * <TOTEM:END>
       ef-data-pass-BeforeProcedure.
      * <TOTEM:PARA. ef-data-pass-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           set ControllaCampi to true 
           .
      * <TOTEM:END>
       ef-age-BeforeProcedure.
      * <TOTEM:PARA. ef-age-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           set ControllaCampi to true 
           .
      * <TOTEM:END>
       ef-pag-BeforeProcedure.
      * <TOTEM:PARA. ef-pag-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           set ControllaCampi to true 
           .
      * <TOTEM:END>
       ef-iva-BeforeProcedure.
      * <TOTEM:PARA. ef-iva-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           set ControllaCampi to true 
           .
      * <TOTEM:END>
       ef-vet-BeforeProcedure.
      * <TOTEM:PARA. ef-vet-BeforeProcedure>
           set ControllaCampi to true.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-1-BeforeProcedure.
      * <TOTEM:PARA. ef-note-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-data-cons-BeforeProcedure.
      * <TOTEM:PARA. ef-data-cons-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           set ControllaCampi to true 
           .
      * <TOTEM:END>
       ef-note-2-BeforeProcedure.
      * <TOTEM:PARA. ef-note-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-3-BeforeProcedure.
      * <TOTEM:PARA. ef-note-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-4-BeforeProcedure.
      * <TOTEM:PARA. ef-note-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-num-ord-AfterProcedure.
      * <TOTEM:PARA. ef-num-ord-AfterProcedure>
              INQUIRE ef-num-ord, VALUE IN mto-num-ord-cli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-num-ord-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-data-AfterProcedure.
      * <TOTEM:PARA. ef-data-AfterProcedure>
              INQUIRE ef-data, VALUE IN mto-data-ordine
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-data-pass-AfterProcedure.
      * <TOTEM:PARA. ef-data-pass-AfterProcedure>
              INQUIRE ef-data-pass, VALUE IN mto-data-passaggio-ordine
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-pass-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-age-AfterProcedure.
      * <TOTEM:PARA. ef-age-AfterProcedure>
              INQUIRE ef-age, VALUE IN mto-cod-agente
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-age-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-pag-AfterProcedure.
      * <TOTEM:PARA. ef-pag-AfterProcedure>
              INQUIRE ef-pag, VALUE IN mto-cod-pagamento
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-iva-AfterProcedure.
      * <TOTEM:PARA. ef-iva-AfterProcedure>
              INQUIRE ef-iva, VALUE IN mto-cod-ese-iva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-iva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-vet-AfterProcedure.
      * <TOTEM:PARA. ef-vet-AfterProcedure>
              INQUIRE ef-vet, VALUE IN mto-vettore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vet-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-forn, VALUE IN mto-forn-reso
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-forn-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-1-AfterProcedure.
      * <TOTEM:PARA. ef-note-1-AfterProcedure>
              INQUIRE ef-note-1, VALUE IN mto-note1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-data-cons-AfterProcedure.
      * <TOTEM:PARA. ef-data-cons-AfterProcedure>
              INQUIRE ef-data-cons, VALUE IN mto-data-note1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-cons-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-2-AfterProcedure.
      * <TOTEM:PARA. ef-note-2-AfterProcedure>
              INQUIRE ef-note-2, VALUE IN mto-note2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-3-AfterProcedure.
      * <TOTEM:PARA. ef-note-3-AfterProcedure>
              INQUIRE ef-note-3, VALUE IN mto-note3
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-3-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-4-AfterProcedure.
      * <TOTEM:PARA. ef-note-4-AfterProcedure>
              INQUIRE ef-note-4, VALUE IN mto-note4
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-4-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       cbo-stato-BeforeProcedure.
      * <TOTEM:PARA. cbo-stato-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cbo-stato-AfterProcedure.
      * <TOTEM:PARA. cbo-stato-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-anno-BeforeProcedure.
      * <TOTEM:PARA. ef-anno-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cli-BeforeProcedure.
      * <TOTEM:PARA. ef-cli-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-des-BeforeProcedure.
      * <TOTEM:PARA. ef-des-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-anno-AfterProcedure.
      * <TOTEM:PARA. ef-anno-AfterProcedure>
              INQUIRE ef-anno, VALUE IN mto-anno
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-anno-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cli-AfterProcedure.
      * <TOTEM:PARA. ef-cli-AfterProcedure>
              INQUIRE ef-cli, VALUE IN mto-cod-cli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cli-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-des-AfterProcedure.
      * <TOTEM:PARA. ef-des-AfterProcedure>
              INQUIRE ef-des, VALUE IN mto-prg-destino
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Screen1-Ta-1-Ev-Cmd-Tabchanged.
      * <TOTEM:PARA. Screen1-Ta-1-Ev-Cmd-Tabchanged>
           perform CHANGE-TAB 
           .
      * <TOTEM:END>
       ef-art-BeforeProcedure.
      * <TOTEM:PARA. ef-art-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
      *     inquire ef-art, value in art-codice.
      *     if art-codice = 0
      *        move 0          to old-art-codice
      *     else
      *        move art-codice to old-art-codice
      *     end-if.

      *    Luciano
           if hid-blister = 1
              modify ef-art, READ-ONLY 
           else
              modify ef-art, not READ-ONLY
           end-if
      *    Luciano Fine
           .
      * <TOTEM:END>
       ef-art-AfterProcedure.
      * <TOTEM:PARA. ef-art-AfterProcedure>
              INQUIRE ef-art, VALUE IN mro-cod-articolo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-art-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-qta-BeforeProcedure.
      * <TOTEM:PARA. ef-qta-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI                                         
             
           .
      * <TOTEM:END>
       ef-qta-AfterProcedure.
      * <TOTEM:PARA. ef-qta-AfterProcedure>
              INQUIRE ef-qta, VALUE IN mro-qta
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-qta-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-qta-oma, VALUE IN mro-qta-omaggi
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-qta-oma-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-uni-BeforeProcedure.
      * <TOTEM:PARA. ef-uni-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI                           
           .
      * <TOTEM:END>
       ef-uni-AfterProcedure.
      * <TOTEM:PARA. ef-uni-AfterProcedure>
              INQUIRE ef-uni, VALUE IN mro-prz-unitario
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-uni-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform BEFORE-CAMPI.                          

           .
      * <TOTEM:END>

       ef-cou-BeforeProcedure.
      * <TOTEM:PARA. ef-cou-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI                           
           .
      * <TOTEM:END>
       ef-cou-AfterProcedure.
      * <TOTEM:PARA. ef-cou-AfterProcedure>
              INQUIRE ef-evadi-dal, VALUE IN mro-evadi-dal
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-evadi-dal-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cou, VALUE IN mro-imp-cou-cobat
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cou-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-add, VALUE IN mro-add-piombo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-add-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI                           
           .
      * <TOTEM:END>
       ef-imp-AfterProcedure.
      * <TOTEM:PARA. ef-imp-AfterProcedure>
              INQUIRE ef-imp, VALUE IN mro-imponib-merce
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sconto-BeforeProcedure.
      * <TOTEM:PARA. ef-sconto-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI                           
           .
      * <TOTEM:END>
       ef-sconto-AfterProcedure.
      * <TOTEM:PARA. ef-sconto-AfterProcedure>
              INQUIRE ef-sconto, VALUE IN mro-perce-sconto
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cod-iva-BeforeProcedure.
      * <TOTEM:PARA. ef-cod-iva-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI                           
           .
      * <TOTEM:END>
       ef-cod-iva-AfterProcedure.
      * <TOTEM:PARA. ef-cod-iva-AfterProcedure>
              INQUIRE ef-cod-iva, VALUE IN mro-cod-iva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cod-iva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cons-BeforeProcedure.
      * <TOTEM:PARA. ef-cons-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI                           
           .
      * <TOTEM:END>
       ef-cons-AfterProcedure.
      * <TOTEM:PARA. ef-cons-AfterProcedure>
              INQUIRE ef-cons, VALUE IN mro-imp-consumo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cons-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-grid-elimina-LinkTo.
      * <TOTEM:PARA. pb-grid-elimina-LinkTo>
           inquire form1-gd-1, last-row in tot-righe, cursor-y riga.

           if tot-righe > 1
              if riga <= tot-righe or riga > 2
                 inquire form1-gd-1(riga, 1), 
                         hidden-data in gruppo-hidden
                 if hid-blister = 0
                    display message "Cancellare la riga selezionata?"
                              title titolo
                               type mb-yes-no
                             giving scelta
                 else
                    display message "Cancellare il blister selezionato?"
                              title titolo
                               type mb-yes-no
                             giving scelta
                 end-if
                 if scelta = mb-yes
                    if hid-blister = 0
                       modify  form1-gd-1, record-to-delete = riga
                    else
                       move riga to store-riga
                       perform until 1 = 2
                          inquire form1-gd-1(store-riga, 1),
                                  hidden-data in gruppo-hidden
                          if hid-imballi not = 0
                             modify  form1-gd-1, 
                                     record-to-delete = store-riga
                             exit perform
                          end-if
                          subtract 1 from store-riga
                       end-perform
                       perform until 1 = 2
                          inquire form1-gd-1, last-row in tot-righe
                          inquire form1-gd-1(store-riga, 1),
                                  hidden-data in gruppo-hidden
                          if hid-imballi not = 0 or 
                             store-riga > tot-righe
                             exit perform
                          end-if
                          modify form1-gd-1, 
                                 record-to-delete = store-riga
                       end-perform
                    end-if

                    inquire form1-gd-1, last-row in tot-righe
                    if tot-righe = 1
                       perform CANCELLA-COLORE
                       perform PULISCI-CAMPI-LABELS
                       set NewRow to true
                    else
                       if riga > tot-righe
                          move tot-righe to riga
                       end-if
                       modify form1-gd-1, cursor-y = riga
                       move riga to event-data-2
                       perform SPOSTAMENTO
                       set ControllaCampi to true
                    end-if
                 end-if
              else
                 display message "Occorre selezionare una riga"
                           title titolo
              end-if
           end-if 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-End-Drag.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-End-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Begin-Entry>
           set EVENT-ACTION to EVENT-ACTION-FAIL 
           .
      * <TOTEM:END>
       ordine-Ev-After-Program.
      * <TOTEM:PARA. ordine-Ev-After-Program>
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           perform ORDINI-AFTER-PROGRAM 
           .
      * <TOTEM:END>
       ordine-Ev-Before-Program.
      * <TOTEM:PARA. ordine-Ev-Before-Program>
           move LK-BL-PROG-ID    TO COMO-PROG-ID.
      * controllo che sia tutto a posto con le transazioni
           move "ordine" to pgm-name.
           perform ORDINI-BEFORE-PROGRAM  
           .
      * <TOTEM:END>
       ef-cau-BeforeProcedure.
      * <TOTEM:PARA. ef-cau-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cau-AfterProcedure.
      * <TOTEM:PARA. ef-cau-AfterProcedure>
              INQUIRE ef-cau, VALUE IN mto-causale
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cau-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-grid-elimina-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-elimina-BeforeProcedure>
           modify pb-grid-elimina, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-grid-elimina-AfterProcedure.
      * <TOTEM:PARA. pb-grid-elimina-AfterProcedure>
           modify pb-grid-elimina, bitmap-number = 4 
           .
      * <TOTEM:END>
       pb-grid-nuovo-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-nuovo-BeforeProcedure>
           modify pb-grid-nuovo, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-grid-nuovo-AfterProcedure.
      * <TOTEM:PARA. pb-grid-nuovo-AfterProcedure>
           modify pb-grid-nuovo, bitmap-number = 5 
           .
      * <TOTEM:END>
       pb-grid-nuovo-LinkTo.
      * <TOTEM:PARA. pb-grid-nuovo-LinkTo>
           if mod-campi = 0 exit paragraph end-if.
           perform PULISCI-CAMPI-LABELS.
           perform CANCELLA-COLORE.
           move 78-ID-ef-art to control-id.
           move 4            to accept-control.
           set  NewRow       to true.
           set  ControllaCampi to true 
           .
      * <TOTEM:END>
       Form1-DaCb-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaCb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI 
           .
      * <TOTEM:END>
       Form1-DaCb-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaCb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-blister-LinkTo.
      * <TOTEM:PARA. chk-blister-LinkTo>
           perform CHK-BLISTER-PRESSED 
           .
      * <TOTEM:END>
       pb-blister-LinkTo.
      * <TOTEM:PARA. pb-blister-LinkTo>
           perform PB-BLISTER-PRESSED 
           .
      * <TOTEM:END>
       ef-gest-BeforeProcedure.
      * <TOTEM:PARA. ef-gest-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gest-AfterProcedure.
      * <TOTEM:PARA. ef-gest-AfterProcedure>
              INQUIRE ef-gest, VALUE IN mto-gest-plus
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gest-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       chk-ritira-BeforeProcedure.
      * <TOTEM:PARA. chk-ritira-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-ritira-AfterProcedure.
      * <TOTEM:PARA. chk-ritira-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-si-LinkTo.
      * <TOTEM:PARA. pb-si-LinkTo>
           set scelta-si to true.
           move 27 to key-status 
           .
      * <TOTEM:END>
       pb-attesa-LinkTo.
      * <TOTEM:PARA. pb-attesa-LinkTo>
           set scelta-attesa to true.
           move 27 to key-status 
           .
      * <TOTEM:END>
       pb-no-LinkTo.
      * <TOTEM:PARA. pb-no-LinkTo>
           set scelta-annulla to true.
           move 27 to key-status 
           .
      * <TOTEM:END>
       pb-forza-LinkTo.
      * <TOTEM:PARA. pb-forza-LinkTo>
           perform PB-FORZA-PRESSED 
           .
      * <TOTEM:END>
       chk-ritira-LinkTo.
      * <TOTEM:PARA. chk-ritira-LinkTo>
           inquire chk-ritira, VALUE chk-ritira-buf
           if chk-ritira-buf = 1
              move zero   to mod-vettori
              move space  to ef-vet-buf
                             lab-vet-buf
              display lab-vet 
                      ef-vet
           else
              move 1      to mod-vettori
              display ef-vet
           end-if 
           .
      * <TOTEM:END>
       chk-evas-tot-BeforeProcedure.
      * <TOTEM:PARA. chk-evas-tot-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-evas-tot-AfterProcedure.
      * <TOTEM:PARA. chk-evas-tot-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-saldi-bancoa-BeforeProcedure.
      * <TOTEM:PARA. chk-saldi-bancoa-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-saldi-bancoa-AfterProcedure.
      * <TOTEM:PARA. chk-saldi-bancoa-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-saldi-banco-BeforeProcedure.
      * <TOTEM:PARA. chk-saldi-banco-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-saldi-banco-AfterProcedure.
      * <TOTEM:PARA. chk-saldi-banco-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-prenot-LinkTo.
      * <TOTEM:PARA. chk-prenot-LinkTo>
           if chk-prenot-buf = 1           
              move 0 to chk-saldi-banco-buf
              move 0 to chk-saldi-promo-buf
              display chk-saldi-banco chk-saldi-promo
           end-if 
           .
      * <TOTEM:END>
       chk-saldi-banco-LinkTo.
      * <TOTEM:PARA. chk-saldi-banco-LinkTo>
           if chk-prenot-buf = 1           
              move 0 to chk-saldi-banco-buf
              display chk-saldi-banco
           end-if 
           .
      * <TOTEM:END>
       chk-saldi-promo-LinkTo.
      * <TOTEM:PARA. chk-saldi-promo-LinkTo>
           if chk-prenot-buf = 1           
              move 0 to chk-saldi-promo-buf
              display chk-saldi-promo
           end-if 
           .
      * <TOTEM:END>
       pb-evadi-dal-LinkTo.
      * <TOTEM:PARA. pb-evadi-dal-LinkTo>
           perform PB-EVADI-DAL-PRESSED 
           .
      * <TOTEM:END>
       Form1-DaEf-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-AfterProcedure>
              INQUIRE ef-note-bolla-1, VALUE IN mto-note-bolla-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-bolla-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-note-bolla-2, VALUE IN mto-note-bolla-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-bolla-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       chk-urgente-BeforeProcedure.
      * <TOTEM:PARA. chk-urgente-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-urgente-AfterProcedure.
      * <TOTEM:PARA. chk-urgente-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ordine-Ev-Before-DSD-Open.
      * <TOTEM:PARA. ordine-Ev-Before-DSD-Open>
           open i-o mrordini.
           if status-mrordini = "9E"
              call "C$RERR" using extend-stat, text-message
              display message "File MRORDINI. Errore sulle transazioni"
                       x"0d0a""Errore: " extend-stat
                       x"0d0a""Eseguire il comando NOTRS da server!"
                         icon 3               
           else
              close mrordini
           end-if.
           open i-o rordini.
           if status-rordini = "9E" 
              call "C$RERR" using extend-stat, text-message
              display message "File RORDINI. Errore sulle transazioni"
                       x"0d0a""Errore: " extend-stat
                       x"0d0a""Eseguire il comando NOTRS da server!"
                         icon 3               
           else
              close rordini
           end-if 
           .
      * <TOTEM:END>

      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

