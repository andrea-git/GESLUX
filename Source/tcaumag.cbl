      *{TOTEM}PRG-COMMENT
      * tcaumag.Cbl
      * tcaumag.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          tcaumag.
       AUTHOR.              ANDREA EVENTI.
       DATE-WRITTEN.        martedì 1 aprile 2014 19:19:38.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:tcaumag, INIT:tcaumag, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "tcaumag.sl".
           COPY "tmagaz.sl".
           COPY "MAS.sl".
           COPY "tcodpag.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "tcaumag.fd".
           COPY "tmagaz.fd".
           COPY "MAS.fd".
           COPY "tcodpag.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "crtvars.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "F:\Lubex\GESLUX\Copylib\UTYDATA.DEF".
               COPY "F:\Lubex\GESLUX\Copylib\comune.def".
               COPY "F:\Lubex\GESLUX\Copylib\custom.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
          88 Screen-Time-Out VALUE 99.
      * Properties & User defined Working Stoarge
       78 titolo VALUE IS "Geslux - Tabella Causali di Magazzino". 
       77 Form1-Tb-1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 CountChar        PIC  9(3).
       77 opensave-status  PIC  s99.
       77 como-id          PIC  9(5).
       77 data-oggi        PIC  9(8).
       01 FlagErroreDes    PIC  9
                  VALUE IS 0.
           88 errore-des VALUE IS 1    WHEN SET TO FALSE  0. 
       77 toolbar-bmp      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 E-ESCI           PIC  9
                  VALUE IS 1.
       77 E-NUOVO          PIC  9
                  VALUE IS 1.
       77 E-CANCELLA       PIC  9
                  VALUE IS 1.
       77 E-SALVA          PIC  9
                  VALUE IS 1.
       77 E-ANTEPRIMA      PIC  9
                  VALUE IS 0.
       77 E-MODIFICA       PIC  9
                  VALUE IS 1.
       77 E-STAMPA         PIC  9
                  VALUE IS 0.
       77 E-CERCA          PIC  9
                  VALUE IS 0.
       77 E-SELEZIONA      PIC  9
                  VALUE IS 1.
       77 Small-Font
                  USAGE IS HANDLE OF FONT SMALL-FONT.
       77 Default-Font
                  USAGE IS HANDLE OF FONT DEFAULT-FONT.
       77 Screen1-Pg-1-Visible         PIC  9
                  VALUE IS 0.
       77 Screen1-St-1-Handle
                  USAGE IS HANDLE OF STATUS-BAR.
       77 Screen1-Pg-2-Visible         PIC  9
                  VALUE IS 0.
       77 Form1-St-1-Handle
                  USAGE IS HANDLE OF STATUS-BAR.
       77 form1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 mod-fis          PIC  9
                  VALUE IS 1.
       01 save-key.
           05 save-codice      PIC  9(5).
       01 save-key-1.
           05 save-ragsoc-1    PIC  x(40).
       77 STATUS-agenti    PIC  X(2).
           88 Valid-STATUS-agenti VALUE IS "00" THRU "09". 
       77 codice-ed        PIC  Z(4)9.
       77 AUTO-ID          PIC  9(6)
                  VALUE IS 0,00.
       77 STATUS-tcaumag   PIC  X(2).
           88 Valid-STATUS-tcaumag VALUE IS "00" THRU "09". 
       77 STATUS-tmagaz    PIC  X(2).
           88 Valid-STATUS-tmagaz VALUE IS "00" THRU "09". 
       77 STATUS-mas       PIC  X(2).
           88 Valid-STATUS-mas VALUE IS "00" THRU "09". 
       77 lab-piano-buf    PIC  x(100).
       77 status-tcodpag   PIC  X(2).
           88 Valid-status-tcodpag VALUE IS "00" THRU "09". 
       77 cbo-nota-buf     PIC  X(30).
       77 v-nota           PIC  9.

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
      * DATA CONTROL BUFFER
       01 Form1-BUF.
      * Data.Entry-Field
              05 ef-codice-BUF PIC x(4).
      * Data.Entry-Field
              05 ef-descr-BUF PIC X(40).
      * Data.Radio-Button
              05 Form1-RADIO-1-BUF PIC 99 VALUE ZERO.
      * Data.Check-Box
              05 chk-aggiorna-BUF PIC 9 VALUE ZERO.
      * Data.Radio-Button
              05 Form1-RADIO-2-BUF PIC 99 VALUE ZERO.
      * Data.Check-Box
              05 chk-giac-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-giac-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-imp-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-imp-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-ord-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-ord-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-iniz-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-iniz-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-acq-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-acq-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-ven-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-ven-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-var-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-var-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-resi-for-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-resi-for-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-resi-cli-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-resi-cli-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-giac-per-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-giac-per-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-el-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-el-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-ul-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-ul-neg-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-el-pos2-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-el-neg2-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-ul-pos2-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-ul-neg2-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-bloc-pos-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-bloc-neg-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              05 ef-tras-BUF PIC X(20).
      * Data.Entry-Field
              05 ef-contropartita-BUF PIC X(8).
      * Data.Entry-Field
              05 ef-codmag-BUF PIC X(3).
              05 ef-codmag-VALUEBUF PIC X(3).
      * Data.Entry-Field
              05 ef-codpag-BUF PIC x(3).
      * Data.Entry-Field
              05 ef-cod-edi-BUF PIC x(3).
      * Data.Check-Box
              05 chk-movim-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-stbolla-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-emifat-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-utf-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-autofat-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-trasporto-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-statistiche-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-ord-forn-BUF PIC 9 VALUE ZERO.
              05 chk-ord-forn-VALUEBUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-reso-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-cap-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-riordino-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-allerta-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-nota-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-blocco-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              05 chk-utf-estero-BUF PIC 9 VALUE ZERO.
      * Data.Label
              05 lab-mag-des-BUF PIC X(50).
      * Data.Label
              05 lab-pag-des-BUF PIC X(30).

       77 TMP-Form1-KEY1-ORDER  PIC X VALUE "A".
       77 TMP-Form1-tcaumag-RESTOREBUF  PIC X(254).
       77 TMP-Form1-KEYIS  PIC 9(3) VALUE 1.
       77 Form1-MULKEY-TMPBUF   PIC X(254).
       77 TMP-DataSet1-tcaumag-BUF     PIC X(254).
       77 TMP-DataSet1-tmagaz-BUF     PIC X(212).
       77 TMP-DataSet1-MAS-BUF     PIC X(512).
       77 TMP-DataSet1-TCODPAG-BUF     PIC X(1380).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-tcaumag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcaumag-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-tcaumag-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-tcaumag-KEY1-Asc  VALUE "A".
          88 DataSet1-tcaumag-KEY1-Desc VALUE "D".
       77 DataSet1-tmagaz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmagaz-LOCK  VALUE "Y".
       77 DataSet1-tmagaz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmagaz-KEY-Asc  VALUE "A".
          88 DataSet1-tmagaz-KEY-Desc VALUE "D".
       77 DataSet1-MAS-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-MAS-LOCK  VALUE "Y".
       77 DataSet1-MAS-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-MAS-KEY-Asc  VALUE "A".
          88 DataSet1-MAS-KEY-Desc VALUE "D".
       77 DataSet1-TCODPAG-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-TCODPAG-LOCK  VALUE "Y".
       77 DataSet1-TCODPAG-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-TCODPAG-KEY-Asc  VALUE "A".
          88 DataSet1-TCODPAG-KEY-Desc VALUE "D".

       77 tcaumag-k-mag-SPLITBUF  PIC X(5).
       77 MAS-MAS-CODICE1-SPLITBUF  PIC X(39).
       77 MAS-MAS-CODICE2-SPLITBUF  PIC X(39).
       77 TCODPAG-TBL-CODICE-01-SPLITBUF  PIC X(53).

       01 old-tca-rec.
           05 old-tca-chiave.
               10 old-tca-codice       PIC  x(4).
           05 old-tca-dati.
               10 old-tca-descrizione  PIC  X(40).
               10 old-tca-tipo         PIC  x.
                   88 old-tca-cliente VALUE IS "C". 
                   88 old-tca-fornitore VALUE IS "F". 
               10 old-tca-movimentazioni.
                   15 old-tca-agg-ultimo   PIC  X.
                       88 old-tca-si-aggiorna VALUE IS "S". 
                       88 old-tca-no-aggiorna VALUE IS "N". 
                   15 old-tca-movim-giacenza           PIC  X.
                       88 old-tca-movim-giac-pos VALUE IS "+". 
                       88 old-tca-movim-giac-neg VALUE IS "-". 
                       88 old-tca-no-movim-giac VALUE IS SPACE. 
                   15 old-tca-movim-impegnato          PIC  X.
                       88 old-tca-movim-imp-pos VALUE IS "+". 
                       88 old-tca-movim-imp-neg VALUE IS "-". 
                       88 old-tca-no-movim-imp VALUE IS SPACE. 
                   15 old-tca-movim-ordinato           PIC  X.
                       88 old-tca-movim-ord-pos VALUE IS "+". 
                       88 old-tca-movim-ord-neg VALUE IS "-". 
                       88 old-tca-no-movim-ord VALUE IS SPACE. 
                   15 old-tca-movim-iniz   PIC  X.
                       88 old-tca-movim-iniz-pos VALUE IS "+". 
                       88 old-tca-movim-iniz-neg VALUE IS "-". 
                       88 old-tca-no-movim-iniz VALUE IS SPACE. 
                   15 old-tca-movim-acquisti           PIC  X.
                       88 old-tca-movim-acq-pos VALUE IS "+". 
                       88 old-tca-movim-acq-neg VALUE IS "-". 
                       88 old-tca-no-movim-acq VALUE IS SPACE. 
                   15 old-tca-movim-vendite            PIC  X.
                       88 old-tca-movim-ven-pos VALUE IS "+". 
                       88 old-tca-movim-ven-neg VALUE IS "-". 
                       88 old-tca-no-movim-ven VALUE IS SPACE. 
                   15 old-tca-movim-var-inv            PIC  X.
                       88 old-tca-movim-var-inv-pos VALUE IS "+". 
                       88 old-tca-movim-var-inv-neg VALUE IS "-". 
                       88 old-tca-no-movim-var-inv VALUE IS SPACE. 
                   15 old-tca-movim-resi-for           PIC  X.
                       88 old-tca-movim-resi-for-pos VALUE IS "+". 
                       88 old-tca-movim-resi-for-neg VALUE IS "-". 
                       88 old-tca-no-movim-resi-for VALUE IS SPACE. 
                   15 old-tca-movim-resi-da-cli        PIC  X.
                       88 old-tca-movim-resi-cli-pos VALUE IS "+". 
                       88 old-tca-movim-resi-cli-neg VALUE IS "-". 
                       88 old-tca-no-movim-resi-cli VALUE IS SPACE. 
                   15 old-tca-movim-giac-periodo       PIC  X.
                       88 old-tca-movim-giac-periodo-pos VALUE IS "+". 
                       88 old-tca-movim-giac-periodo-neg VALUE IS "-". 
                       88 old-tca-no-movim-giac-periodo VALUE IS SPACE. 
                   15 old-tca-uscite-lav   PIC  X.
                       88 old-tca-uscite-lav-pos VALUE IS "+". 
                       88 old-tca-uscite-lav-neg VALUE IS "-". 
                       88 old-tca-no-uscite-lav VALUE IS SPACE. 
                   15 old-tca-entrate-lav  PIC  X.
                       88 old-tca-entrate-lav-pos VALUE IS "+". 
                       88 old-tca-entrate-lav-neg VALUE IS "-". 
                       88 old-tca-no-entrate-lav VALUE IS SPACE. 
                   15 old-tca-imponibile   PIC  x.
                       88 old-tca-imponibile-pos VALUE IS "+". 
                       88 old-tca-imponibile-neg VALUE IS "-". 
               10 old-tca-altri-dati.
                   15 old-tca-caus-trasporto           PIC  X(20).
                   15 old-tca-contropartita            PIC  x(8).
                   15 old-tca-movim-magaz  PIC  X(1).
                       88 old-tca-si-movim VALUE IS "S". 
                       88 old-tca-no-movim VALUE IS "N". 
                   15 old-tca-cod-magaz    PIC  X(3).
                   15 old-tca-stampa-bolla PIC  X(1).
                       88 old-tca-si-stampa VALUE IS "S". 
                       88 old-tca-no-stampa VALUE IS "N". 
                   15 old-tca-emi-fat      PIC  X(1).
                       88 old-tca-si-emissione VALUE IS "S". 
                       88 old-tca-no-emissione VALUE IS "N". 
                   15 old-tca-gest-utf     PIC  X(1).
                       88 old-tca-si-utf VALUE IS "S". 
                       88 old-tca-no-utf VALUE IS "N". 
                   15 old-tca-mov-zero     PIC  X(1).
                       88 old-tca-si-zero VALUE IS "S". 
                       88 old-tca-no-zero VALUE IS "N". 
                   15 old-tca-trasporto    PIC  X(1).
                       88 old-tca-si-tras VALUE IS "S". 
                       88 old-tca-no-tras VALUE IS "N". 
                   15 old-tca-statistiche  PIC  X(1).
                       88 old-tca-si-stat VALUE IS "S". 
                       88 old-tca-no-stat VALUE IS "N". 
               10 old-tca-dati-comuni.
                   15 old-tca-data-creazione           PIC  9(8).
                   15 old-tca-ora-creazione            PIC  9(8).
                   15 old-tca-utente-creazione         PIC  x(10).
                   15 old-tca-data-ultima-modifica     PIC  9(8).
                   15 old-tca-ora-ultima-modifica      PIC  9(8).
                   15 old-tca-utente-ultima-modifica   PIC  x(10).
               10 old-tca-vuoti.
                   15 old-tca-movim-speciale           PIC  X(1).
                       88 old-tca-si-speciale VALUE IS "S". 
                       88 old-tca-no-speciale VALUE IS "N". 
                   15 old-tca-ord-forn     PIC  X(1).
                       88 old-tca-si-ord-forn VALUE IS "S". 
                       88 old-tca-no-ord-forn VALUE IS "N". 
      *(( XFD NAME = tca-gest-utf_1 ))
                   15 old-tca-prezzo-reso  PIC  9.
                       88 old-tca-prezzo-reso-si VALUE IS 1. 
                       88 old-tca-prezzo-reso-no VALUE IS 0. 
      *(( XFD NAME = tca-gest-utf_1_1 ))
                   15 old-tca-cap-obbligatorio         PIC  9.
                       88 old-tca-cap-obbligatorio-si VALUE IS 1. 
                       88 old-tca-cap-obbligatorio-no VALUE IS 0. 
                   15 old-tca-nota-credito PIC  9.
                       88 old-tca-nota-credito-si VALUE IS 1. 
                       88 old-tca-nota-credito-no VALUE IS 0. 
      *(( XFD NAME = tca-gest-utf_1_1_2 ))
                   15 old-tca-tipo-nota    PIC  9.
                       88 old-tca-tipo-nota-reso VALUE IS 1. 
                       88 old-tca-tipo-nota-prz VALUE IS 2. 
                       88 old-tca-tipo-nota-generico VALUE IS 3. 
                   15 old-tca-num-vuoto-1  PIC  9(9).
                   15 old-tca-num-vuoto-2  PIC  9(15).
                   15 old-tca-num-vuoto-3  PIC  9(15).
                   15 old-tca-uscite-lav2   PIC  X.
                       88 old-tca-uscite-lav2-pos VALUE IS "+". 
                       88 old-tca-uscite-lav2-neg VALUE IS "-". 
                       88 old-tca-no-uscite-lav2 VALUE IS SPACE. 
                   15 old-tca-entrate-lav2  PIC  X.
                       88 old-tca-entrate-lav2-pos VALUE IS "+". 
                       88 old-tca-entrate-lav2-neg VALUE IS "-". 
                       88 old-tca-no-entrate-lav2 VALUE IS SPACE.
                   15 old-tca-giac-bloc  PIC  X.
                       88 old-tca-giac-bloc-pos VALUE IS "+". 
                       88 old-tca-giac-bloc-neg VALUE IS "-". 
                       88 old-tca-no-giac-bloc VALUE IS SPACE.  
                   15 old-tca-cod-pagamento PIC  x(3).
                   15 old-tca-riordino  PIC  X.
                       88 old-tca-riordino-si VALUE IS "S". 
                       88 old-tca-riordino-no VALUE IS "N" " ".
                   15 old-tca-blocco-modeva  PIC  X.
                       88 old-tca-blocco-modeva-si VALUE IS "S". 
                       88 old-tca-blocco-modeva-no VALUE IS "N" " ".
                   15 old-tca-invio-utf-estero  PIC  X.
                       88 old-tca-invio-utf-estero-si VALUE IS "S". 
                       88 old-tca-invio-utf-estero-no VALUE IS "N" " ". 
                   15 old-tca-causale-EDI PIC  x(3).
                   15 old-tca-alfa-vuoto-1 PIC  x(8).
                   15 old-tca-alfa-vuoto-2 PIC  x(20).
                   15 old-tca-alfa-vuoto-3 PIC  x(20).
      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-ef-codice VALUE 5001.
       78  78-ID-ef-descr VALUE 5002.
       78  78-ID-rb-cli VALUE 5003.
       78  78-ID-rb-for VALUE 5004.
       78  78-ID-chk-aggiorna VALUE 5005.
       78  78-ID-rb-si-imp VALUE 5006.
       78  78-ID-rb-no-imp VALUE 5007.
       78  78-ID-chk-giac-pos VALUE 5008.
       78  78-ID-chk-giac-neg VALUE 5009.
       78  78-ID-chk-imp-pos VALUE 5010.
       78  78-ID-chk-imp-neg VALUE 5011.
       78  78-ID-chk-ord-pos VALUE 5012.
       78  78-ID-chk-ord-neg VALUE 5013.
       78  78-ID-chk-iniz-pos VALUE 5014.
       78  78-ID-chk-iniz-neg VALUE 5015.
       78  78-ID-chk-acq-pos VALUE 5016.
       78  78-ID-chk-acq-neg VALUE 5017.
       78  78-ID-chk-ven-pos VALUE 5018.
       78  78-ID-chk-ven-neg VALUE 5019.
       78  78-ID-chk-var-pos VALUE 5020.
       78  78-ID-chk-var-neg VALUE 5021.
       78  78-ID-chk-resi-for-pos VALUE 5022.
       78  78-ID-chk-resi-for-neg VALUE 5023.
       78  78-ID-chk-resi-cli-pos VALUE 5024.
       78  78-ID-chk-resi-cli-neg VALUE 5025.
       78  78-ID-chk-giac-per-pos VALUE 5026.
       78  78-ID-chk-giac-per-neg VALUE 5027.
       78  78-ID-chk-el-pos VALUE 5028.
       78  78-ID-chk-el-neg VALUE 5029.
       78  78-ID-chk-ul-pos VALUE 5030.
       78  78-ID-chk-ul-neg VALUE 5031.
       78  78-ID-chk-el-pos2 VALUE 5032.
       78  78-ID-chk-el-neg2 VALUE 5033.
       78  78-ID-chk-ul-pos2 VALUE 5034.
       78  78-ID-chk-ul-neg2 VALUE 5035.
       78  78-ID-ef-tras VALUE 5036.
       78  78-ID-ef-contropartita VALUE 5037.
       78  78-ID-ef-codmag VALUE 5038.
       78  78-ID-ef-codpag VALUE 5039.
       78  78-ID-ef-cod-edi VALUE 5040.
       78  78-ID-chk-movim VALUE 5041.
       78  78-ID-chk-stbolla VALUE 5042.
       78  78-ID-chk-emifat VALUE 5043.
       78  78-ID-chk-utf VALUE 5044.
       78  78-ID-chk-autofat VALUE 5045.
       78  78-ID-chk-riordino VALUE 5046.
       78  78-ID-chk-allerta VALUE 5047.
       78  78-ID-chk-nota VALUE 5048.
       78  78-ID-chk-blocco VALUE 5049.
       78  78-ID-chk-utf-estero VALUE 5050.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "COMMON-LINKAGE.DEF".

      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           AFTER PROCEDURE Form1-AfterProcedure,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           .

      * ENTRY FIELD
       05
           ef-codice, 
           Entry-Field, 
           COL 13,33, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-k,
           FONT IS Small-Font,
           ID IS 78-ID-ef-codice,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 4,
           VALUE ef-codice-BUF,
           .

      * ENTRY FIELD
       05
           ef-descr, 
           Entry-Field, 
           COL 13,33, 
           LINE 5,00,
           LINES 1,31 ,
           SIZE 95,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-descr,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 40,
           VALUE ef-descr-BUF,
           .

      * RADIO BUTTON
       05
           rb-cli, 
           Radio-Button, 
           COL 41,33, 
           LINE 6,92,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED MOD,
           FLAT,
           GROUP 1,
           GROUP-VALUE 1,
           ID IS 78-ID-rb-cli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE Form1-RADIO-1-BUF,
            .

      * RADIO BUTTON
       05
           rb-for, 
           Radio-Button, 
           COL 41,33, 
           LINE 8,85,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED MOD,
           FLAT,
           GROUP 1,
           GROUP-VALUE 2,
           ID IS 78-ID-rb-for,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE Form1-RADIO-1-BUF,
            .

      * CHECK BOX
       05
           chk-aggiorna, 
           Check-Box, 
           COL 13,33, 
           LINE 8,00,
           LINES 1,23 ,
           SIZE 2,50 ,
           ENABLED MOD,
           FLAT,
           ID IS 78-ID-chk-aggiorna,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-aggiorna-BUF,
            .

      * RADIO BUTTON
       05
           rb-si-imp, 
           Radio-Button, 
           COL 66,33, 
           LINE 7,08,
           LINES 1,15 ,
           SIZE 2,50 ,
           ENABLED mod,
           FLAT,
           GROUP 2,
           GROUP-VALUE 1,
           ID IS 78-ID-rb-si-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "si-imp",
           VALUE Form1-RADIO-2-BUF,
           BEFORE PROCEDURE Screen1-DaRb-1-BeforeProcedure, 
            .

      * RADIO BUTTON
       05
           rb-no-imp, 
           Radio-Button, 
           COL 66,33, 
           LINE 9,00,
           LINES 1,15 ,
           SIZE 2,50 ,
           ENABLED mod,
           FLAT,
           GROUP 2,
           GROUP-VALUE 2,
           ID IS 78-ID-rb-no-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "no-imp",
           VALUE Form1-RADIO-2-BUF,
           BEFORE PROCEDURE Screen1-DaRb-2-BeforeProcedure, 
            .

      * CHECK BOX
       05
           chk-giac-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 14,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-giac-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-giac-pos-BUF,
            .

      * CHECK BOX
       05
           chk-giac-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 14,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1003
           FLAT,
           ID IS 78-ID-chk-giac-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-giac-neg-BUF,
            .

      * CHECK BOX
       05
           chk-imp-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 16,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1004
           FLAT,
           ID IS 78-ID-chk-imp-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-imp-pos-BUF,
            .

      * CHECK BOX
       05
           chk-imp-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 16,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1005
           FLAT,
           ID IS 78-ID-chk-imp-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-imp-neg-BUF,
            .

      * CHECK BOX
       05
           chk-ord-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 18,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1007
           FLAT,
           ID IS 78-ID-chk-ord-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-ord-pos-BUF,
            .

      * CHECK BOX
       05
           chk-ord-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 18,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1008
           FLAT,
           ID IS 78-ID-chk-ord-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-ord-neg-BUF,
            .

      * CHECK BOX
       05
           chk-iniz-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 20,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1009
           FLAT,
           ID IS 78-ID-chk-iniz-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-iniz-pos-BUF,
            .

      * CHECK BOX
       05
           chk-iniz-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 20,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1010
           FLAT,
           ID IS 78-ID-chk-iniz-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-iniz-neg-BUF,
            .

      * CHECK BOX
       05
           chk-acq-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 22,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1011
           FLAT,
           ID IS 78-ID-chk-acq-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-acq-pos-BUF,
            .

      * CHECK BOX
       05
           chk-acq-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 22,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1012
           FLAT,
           ID IS 78-ID-chk-acq-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-acq-neg-BUF,
            .

      * CHECK BOX
       05
           chk-ven-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 24,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1013
           FLAT,
           ID IS 78-ID-chk-ven-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-ven-pos-BUF,
            .

      * CHECK BOX
       05
           chk-ven-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 24,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1014
           FLAT,
           ID IS 78-ID-chk-ven-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-ven-neg-BUF,
            .

      * CHECK BOX
       05
           chk-var-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 26,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1015
           FLAT,
           ID IS 78-ID-chk-var-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-var-pos-BUF,
            .

      * CHECK BOX
       05
           chk-var-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 26,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1016
           FLAT,
           ID IS 78-ID-chk-var-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-var-neg-BUF,
            .

      * CHECK BOX
       05
           chk-resi-for-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 28,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1017
           FLAT,
           ID IS 78-ID-chk-resi-for-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-resi-for-pos-BUF,
            .

      * CHECK BOX
       05
           chk-resi-for-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 28,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1018
           FLAT,
           ID IS 78-ID-chk-resi-for-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-resi-for-neg-BUF,
            .

      * CHECK BOX
       05
           chk-resi-cli-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 30,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1019
           FLAT,
           ID IS 78-ID-chk-resi-cli-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-resi-cli-pos-BUF,
            .

      * CHECK BOX
       05
           chk-resi-cli-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 30,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1020
           FLAT,
           ID IS 78-ID-chk-resi-cli-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-resi-cli-neg-BUF,
            .

      * CHECK BOX
       05
           chk-giac-per-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 32,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1026
           FLAT,
           ID IS 78-ID-chk-giac-per-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-giac-per-pos-BUF,
            .

      * CHECK BOX
       05
           chk-giac-per-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 32,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1022
           FLAT,
           ID IS 78-ID-chk-giac-per-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-giac-per-neg-BUF,
            .

      * CHECK BOX
       05
           chk-el-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 34,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1027
           FLAT,
           ID IS 78-ID-chk-el-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-el-pos-BUF,
            .

      * CHECK BOX
       05
           chk-el-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 34,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1028
           FLAT,
           ID IS 78-ID-chk-el-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-el-neg-BUF,
            .

      * CHECK BOX
       05
           chk-ul-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 36,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1021
           FLAT,
           ID IS 78-ID-chk-ul-pos,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-ul-pos-BUF,
            .

      * CHECK BOX
       05
           chk-ul-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 36,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1029
           FLAT,
           ID IS 78-ID-chk-ul-neg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-ul-neg-BUF,
            .

      * CHECK BOX
       05
           chk-el-pos2, 
           Check-Box, 
           COL 24,50, 
           LINE 38,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1023
           FLAT,
           ID IS 78-ID-chk-el-pos2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-el-pos2-BUF,
            .

      * CHECK BOX
       05
           chk-el-neg2, 
           Check-Box, 
           COL 32,50, 
           LINE 38,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1024
           FLAT,
           ID IS 78-ID-chk-el-neg2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-el-neg2-BUF,
            .

      * CHECK BOX
       05
           chk-ul-pos2, 
           Check-Box, 
           COL 24,50, 
           LINE 40,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1025
           FLAT,
           ID IS 78-ID-chk-ul-pos2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-ul-pos2-BUF,
            .

      * CHECK BOX
       05
           chk-ul-neg2, 
           Check-Box, 
           COL 32,50, 
           LINE 40,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1030
           FLAT,
           ID IS 78-ID-chk-ul-neg2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-ul-neg2-BUF,
            .

      * CHECK BOX
       05
           chk-bloc-pos, 
           Check-Box, 
           COL 24,50, 
           LINE 42,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1031
           FLAT,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-bloc-pos-BUF,
            .

      * CHECK BOX
       05
           chk-bloc-neg, 
           Check-Box, 
           COL 32,50, 
           LINE 42,00,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED MOD,
           EXCEPTION-VALUE 1032
           FLAT,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-bloc-neg-BUF,
            .

      * ENTRY FIELD
       05
           ef-tras, 
           Entry-Field, 
           COL 63,33, 
           LINE 14,00,
           LINES 1,31 ,
           SIZE 45,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-tras,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 20,
           VALUE ef-tras-BUF,
           .

      * ENTRY FIELD
       05
           ef-contropartita, 
           Entry-Field, 
           COL 63,33, 
           LINE 16,00,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-contropartita,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 8,
           VALUE ef-contropartita-BUF,
           .

      * ENTRY FIELD
       05
           ef-codmag, 
           Entry-Field, 
           COL 63,33, 
           LINE 18,00,
           LINES 1,31 ,
           SIZE 5,83 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-codmag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-codmag-BUF,
           .

      * ENTRY FIELD
       05
           ef-codpag, 
           Entry-Field, 
           COL 63,33, 
           LINE 20,00,
           LINES 1,31 ,
           SIZE 5,83 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-codpag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-codpag-BUF,
           .

      * ENTRY FIELD
       05
           ef-cod-edi, 
           Entry-Field, 
           COL 63,33, 
           LINE 21,92,
           LINES 1,31 ,
           SIZE 5,83 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cod-edi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-cod-edi-BUF,
           .

      * CHECK BOX
       05
           chk-movim, 
           Check-Box, 
           COL 63,33, 
           LINE 23,85,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           ID IS 78-ID-chk-movim,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-movim-BUF,
            .

      * CHECK BOX
       05
           chk-stbolla, 
           Check-Box, 
           COL 63,33, 
           LINE 25,54,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           ID IS 78-ID-chk-stbolla,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-stbolla-BUF,
            .

      * CHECK BOX
       05
           chk-emifat, 
           Check-Box, 
           COL 63,33, 
           LINE 27,23,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           ID IS 78-ID-chk-emifat,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-emifat-BUF,
            .

      * CHECK BOX
       05
           chk-utf, 
           Check-Box, 
           COL 63,33, 
           LINE 28,92,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           ID IS 78-ID-chk-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-utf-BUF,
            .

      * CHECK BOX
       05
           chk-autofat, 
           Check-Box, 
           COL 63,33, 
           LINE 30,62,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           ID IS 78-ID-chk-autofat,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-autofat-BUF,
            .

      * CHECK BOX
       05
           chk-trasporto, 
           Check-Box, 
           COL 63,33, 
           LINE 32,31,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-trasporto-BUF,
            .

      * CHECK BOX
       05
           chk-statistiche, 
           Check-Box, 
           COL 63,33, 
           LINE 34,00,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-statistiche-BUF,
            .

      * CHECK BOX
       05
           chk-ord-forn, 
           Check-Box, 
           COL 63,33, 
           LINE 35,69,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-ord-forn-BUF,
            .

      * CHECK BOX
       05
           chk-reso, 
           Check-Box, 
           COL 63,33, 
           LINE 37,38,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-reso-BUF,
            .

      * CHECK BOX
       05
           chk-cap, 
           Check-Box, 
           COL 63,33, 
           LINE 39,08,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-cap-BUF,
            .

      * CHECK BOX
       05
           chk-riordino, 
           Check-Box, 
           COL 63,33, 
           LINE 40,77,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           ID IS 78-ID-chk-riordino,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-riordino-BUF,
            .

      * CHECK BOX
       05
           chk-allerta, 
           Check-Box, 
           COL 63,33, 
           LINE 42,46,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           ID IS 78-ID-chk-allerta,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-allerta-BUF,
            .

      * CHECK BOX
       05
           chk-nota, 
           Check-Box, 
           COL 63,33, 
           LINE 45,69,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1033
           FLAT,
           ID IS 78-ID-chk-nota,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-nota-BUF,
            .

      * COMBO-BOX
       05
           cbo-nota, 
           Combo-Box, 
           COL 69,83, 
           LINE 45,77,
           LINES 4,92 ,
           SIZE 25,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 53,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-nota-buf,
           VISIBLE v-nota,
           AFTER PROCEDURE Screen1-Cm-1-AfterProcedure, 
           BEFORE PROCEDURE Screen1-Cm-1-BeforeProcedure, 
           .
      * CHECK BOX
       05
           chk-blocco, 
           Check-Box, 
           COL 63,33, 
           LINE 47,38,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1033
           FLAT,
           ID IS 78-ID-chk-blocco,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-blocco-BUF,
            .

      * CHECK BOX
       05
           chk-utf-estero, 
           Check-Box, 
           COL 63,33, 
           LINE 49,08,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1033
           FLAT,
           ID IS 78-ID-chk-utf-estero,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-utf-estero-BUF,
            .

      * LABEL
       05
           Screen1-La-2baaa, 
           Label, 
           COL 2,00, 
           LINE 22,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 16,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Acquisti",
           .

      * LABEL
       05
           Screen1-La-2baaaa, 
           Label, 
           COL 2,00, 
           LINE 24,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vendite",
           .

      * LABEL
       05
           Screen1-La-2baaaaa, 
           Label, 
           COL 2,00, 
           LINE 26,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 18,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Variazioni Inventariali",
           .

      * LABEL
       05
           Screen1-La-2baaaaaa, 
           Label, 
           COL 2,00, 
           LINE 28,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Resi Fornitori",
           .

      * LABEL
       05
           Screen1-La-1, 
           Label, 
           COL 2,57, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 100,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice",
           .

      * LABEL
       05
           Screen1-Custom1-1, 
           Label, 
           COL 67,57, 
           LINE 2,00,
           LINES 0,73 ,
           SIZE 2,00 ,
           FONT IS Default-Font,
           ID IS 101,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Screen1-blockpgm-2, 
           Label, 
           COL 64,57, 
           LINE 1,85,
           LINES 1,00 ,
           SIZE 2,00 ,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Form1-La-5aaac, 
           Label, 
           COL 2,00, 
           LINE 11,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 108,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Movimentazioni",
           .

      * BAR
       05
           Form1-Br-2a, 
           Bar,
           COL 19,33, 
           LINE 11,70,
           SIZE 23,83 ,
           ID IS 109,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           SHADING (-1),
           WIDTH 1,
           .

      * LABEL
       05
           Screen1-La-2, 
           Label, 
           COL 2,00, 
           LINE 14,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giacenza Dinamica",
           .

      * LABEL
       05
           Screen1-La-2a, 
           Label, 
           COL 21,50, 
           LINE 12,62,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Positivo",
           .

      * LABEL
       05
           Screen1-La-2aa, 
           Label, 
           COL 30,50, 
           LINE 12,62,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 4,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Negativo",
           .

      * LABEL
       05
           Screen1-La-2b, 
           Label, 
           COL 2,00, 
           LINE 16,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 7,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Impegnato",
           .

      * LABEL
       05
           Screen1-La-2ba, 
           Label, 
           COL 2,00, 
           LINE 18,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Ordinato",
           .

      * LABEL
       05
           Screen1-La-2baa, 
           Label, 
           COL 2,00, 
           LINE 20,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 13,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Iniziale",
           .

      * LABEL
       05
           Screen1-La-2baaaaaaa, 
           Label, 
           COL 2,00, 
           LINE 30,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Resi da Clienti",
           .

      * LABEL
       05
           labelx, 
           Label, 
           COL 2,00, 
           LINE 32,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giacenza Periodo",
           .

      * LABEL
       05
           Screen1-La-2c, 
           Label, 
           COL 45,33, 
           LINE 6,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 20,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cliente",
           .

      * LABEL
       05
           Screen1-La-2ca, 
           Label, 
           COL 45,33, 
           LINE 8,85,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Fornitore",
           .

      * LABEL
       05
           Screen1-La-2cb, 
           Label, 
           COL 17,00, 
           LINE 8,00,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 24,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Aggiorna Costo Ultimo",
           .

      * LABEL
       05
           Screen1-La-1a, 
           Label, 
           COL 2,57, 
           LINE 5,00,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Descrizione",
           .

      * LABEL
       05
           Screen1-La-3, 
           Label, 
           COL 70,33, 
           LINE 6,92,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 6,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imponibile positivo",
           .

      * LABEL
       05
           Screen1-La-4, 
           Label, 
           COL 70,33, 
           LINE 8,85,
           LINES 1,31 ,
           SIZE 16,17 ,
           FONT IS Small-Font,
           ID IS 8,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imponibile negativo",
           .

      * LABEL
       05
           Screen1-La-5, 
           Label, 
           COL 43,50, 
           LINE 14,00,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 9,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Causale Trasporto",
           .

      * LABEL
       05
           Screen1-La-6, 
           Label, 
           COL 43,50, 
           LINE 18,00,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Magazzino",
           .

      * BAR
       05
           Screen1-Br-2, 
           Bar,
           COL 40,67, 
           LINE 11,69,
           LINES 39,46 ,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           SHADING (-1),
           WIDTH 1,
           .

      * DB_LABEL
       05
           lab-mag-des, 
           Label, 
           COL 69,50, 
           LINE 18,00,
           LINES 1,31 ,
           SIZE 49,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 28,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-mag-des-BUF,
           TRANSPARENT,
           .

      * LABEL
       05
           Form1-La-5aaaca, 
           Label, 
           COL 43,33, 
           LINE 11,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 29,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Altri dati",
           .

      * BAR
       05
           Form1-Br-2aa, 
           Bar,
           COL 60,67, 
           LINE 11,70,
           SIZE 59,50 ,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           SHADING (-1),
           WIDTH 1,
           .

      * LABEL
       05
           Screen1-La-7, 
           Label, 
           COL 43,50, 
           LINE 23,85,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 36,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Movim. magazzino",
           .

      * LABEL
       05
           Screen1-La-8, 
           Label, 
           COL 43,50, 
           LINE 25,54,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 37,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Stampa bolla",
           .

      * LABEL
       05
           Screen1-La-9, 
           Label, 
           COL 43,50, 
           LINE 27,23,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 38,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Emissione fattura",
           .

      * LABEL
       05
           Screen1-La-10, 
           Label, 
           COL 43,50, 
           LINE 28,92,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 39,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Gestione UTF",
           .

      * LABEL
       05
           Screen1-La-11, 
           Label, 
           COL 43,50, 
           LINE 30,62,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 40,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Totale Mov. ZERO",
           .

      * LABEL
       05
           Screen1-La-5a, 
           Label, 
           COL 43,50, 
           LINE 16,00,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 41,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Contropartita contabile",
           .

      * LABEL
       05
           lab-piano, 
           Label, 
           COL 74,17, 
           LINE 16,00,
           LINES 1,92 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 11,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-piano-buf,
           .

      * LABEL
       05
           labelxa, 
           Label, 
           COL 2,00, 
           LINE 34,00,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 26,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Entrate Passaggi",
           .

      * LABEL
       05
           labelxb, 
           Label, 
           COL 2,00, 
           LINE 36,00,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 31,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Uscite Passaggi",
           .

      * LABEL
       05
           Screen1-La-10a, 
           Label, 
           COL 43,50, 
           LINE 32,31,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 32,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Trasporto",
           .

      * LABEL
       05
           Screen1-La-11a, 
           Label, 
           COL 43,50, 
           LINE 34,00,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 33,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Statistiche Ven/Acq.",
           .

      * LABEL
       05
           Screen1-La-11aa, 
           Label, 
           COL 43,50, 
           LINE 42,46,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Movimento Speciale",
           .

      * LABEL
       05
           Screen1-La-12, 
           Label, 
           COL 68,17, 
           LINE 41,62,
           LINES 3,00 ,
           SIZE 36,50 ,
           FONT IS Small-Font,
           ID IS 35,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "- segnalazione in statistica                          
      -    "      - righe a prezzo 0 senza la dicitura OMAGGIO - Nessun 
      -    "controllo sul totale importo dell'ordine",
           .

      * LABEL
       05
           Screen1-La-11ab, 
           Label, 
           COL 43,50, 
           LINE 35,69,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 42,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Ordini Fornitore",
           .

      * LABEL
       05
           labelxaa, 
           Label, 
           COL 2,00, 
           LINE 38,00,
           LINES 1,31 ,
           SIZE 21,00 ,
           FONT IS Small-Font,
           ID IS 43,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Entrate Passaggi 2 (di cui)",
           .

      * LABEL
       05
           labelxba, 
           Label, 
           COL 2,00, 
           LINE 40,00,
           LINES 1,31 ,
           SIZE 20,33 ,
           FONT IS Small-Font,
           ID IS 44,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Uscite Passaggi 2 (di cui)",
           .

      * LABEL
       05
           Screen1-La-2d, 
           Label, 
           COL 2,00, 
           LINE 42,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giacenza Bloccata",
           .

      * LABEL
       05
           Screen1-La-11aba, 
           Label, 
           COL 43,50, 
           LINE 37,38,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Recupero prezzo x reso",
           .

      * BAR
       05
           Form1-Br-2aaa, 
           Bar,
           COL 1,00, 
           LINE 4,00,
           SIZE 119,17 ,
           ID IS 47,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (1),
           SHADING (-1),
           WIDTH 1,
           .

      * LABEL
       05
           Screen1-La-11abaa, 
           Label, 
           COL 43,50, 
           LINE 39,08,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 48,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "CAP obbligatorio",
           .

      * LABEL
       05
           Screen1-La-6a, 
           Label, 
           COL 43,50, 
           LINE 19,92,
           LINES 1,31 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 49,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Pagamento",
           .

      * DB_LABEL
       05
           lab-pag-des, 
           Label, 
           COL 69,50, 
           LINE 20,00,
           LINES 1,31 ,
           SIZE 49,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 50,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-pag-des-BUF,
           TRANSPARENT,
           .

      * LABEL
       05
           Screen1-La-11abaaa, 
           Label, 
           COL 43,50, 
           LINE 40,77,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 51,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Riordino",
           .

      * LABEL
       05
           Screen1-La-11abaaaa, 
           Label, 
           COL 43,50, 
           LINE 45,69,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 52,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Nota Credito",
           .

      * LABEL
       05
           Screen1-La-11abaaaaa, 
           Label, 
           COL 43,50, 
           LINE 47,38,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 54,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Blocco Mod. Evasioni",
           .

      * LABEL
       05
           Screen1-La-11abaaaaaa, 
           Label, 
           COL 43,50, 
           LINE 49,08,
           LINES 1,15 ,
           SIZE 19,00 ,
           FONT IS Small-Font,
           ID IS 55,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Invio UTF estero",
           .

      * LABEL
       05
           Screen1-La-5aa, 
           Label, 
           COL 43,50, 
           LINE 21,92,
           LINES 1,31 ,
           SIZE 16,00 ,
           FONT IS Small-Font,
           ID IS 56,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE '"TIpo vendita" EDI',
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 72,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 6,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-NUOVO,
           EXCEPTION-VALUE 2,
           FLAT,
           ID IS 73,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           BITMAP-NUMBER BitmapNumNew
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 16,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-CANCELLA,
           EXCEPTION-VALUE 4,
           FLAT,
           ID IS 74,
           SELF-ACT,
           TITLE "Cancella (F4)",
           BITMAP-NUMBER BitmapNumDelete
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 11,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 75,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 26,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-ANTEPRIMA,
           EXCEPTION-VALUE 6,
           FLAT,
           ID IS 76,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           BITMAP-NUMBER BitmapNumPreview
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 21,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 5,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 77,
           SELF-ACT,
           TITLE "Modifica (F5)",
           VALUE MOD,
           BITMAP-NUMBER BitmapNumEdit
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 31,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-STAMPA,
           EXCEPTION-VALUE 7,
           FLAT,
           ID IS 78,
           SELF-ACT,
           TITLE "Stampa (F7)",
           BITMAP-NUMBER BitmapNumPrint
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 36,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 79,
           SELF-ACT,
           TITLE "Cerca (F8)",
           BITMAP-NUMBER BitmapNumZoom
           .

      * PUSH BUTTON
       05
           TOOL-SELEZIONA, 
           Push-Button, 
           COL 41,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 9,
           FRAMED,
           SQUARE,
           ENABLED E-SELEZIONA,
           EXCEPTION-VALUE 9,
           FLAT,
           ID IS 112,
           SELF-ACT,
           TITLE "Seleziona (F9)",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1a, 
           Push-Button, 
           COL 46,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 10,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1002,
           FLAT,
           ID IS 113,
           SELF-ACT,
           TITLE "&Primo",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1b, 
           Push-Button, 
           COL 51,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 11,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 67,
           FLAT,
           ID IS 114,
           SELF-ACT,
           TITLE "Precedente (PgDn)",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1c, 
           Push-Button, 
           COL 56,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 12,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 68,
           FLAT,
           ID IS 115,
           SELF-ACT,
           TITLE "Successivo (PgUp)",
           .

      * PUSH BUTTON
       05
           Form1-Pb-1d, 
           Push-Button, 
           COL 61,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 13,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1006,
           FLAT,
           ID IS 116,
           SELF-ACT,
           TITLE "&Ultimo",
           .

      * CHECK BOX
       05
           TOOL-ORD, 
           Check-Box, 
           COL 66,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 21,
           UNFRAMED,
           SQUARE,
           ENABLED 0,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 122,
           SELF-ACT,
           TITLE "Ordinamento Alfabetico (F10)",
           VALUE OrderBy,
           AFTER PROCEDURE TOOL-ORD-AfterProcedure,
           BEFORE PROCEDURE TOOL-ORD-BeforeProcedure, 
           .
      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, USER-CODI, LIVELLO-ABIL.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:tcaumag, INIT:tcaumag, BeforeDeclarative>
       TCAUMAG-ERR SECTION.
           use after error procedure on tcaumag.
           set RecLocked to false.
           evaluate status-tcaumag
           when "35"
                display message "File [TCAUMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCAUMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCAUMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "99"
           when "93"
                set RecLocked to true
                set errori    to true
                move ZERO to mod
                modify tool-modifica, value = mod
                display form1
                set StatusVisua to true
                perform STATUS-BAR-MSG
                move "00" to status-tcaumag
                if ReadSecca
                   read tcaumag       no lock 
                        invalid      continue
                        not invalid  perform FORM1-IUD-DISPLAY
                   end-read
                end-if
                display message box MSG-Record-gia-in-uso
                        title = tit-err
                        icon is mb-error-icon
           when "23"
                move 1    to mod-k
                move ZERO to mod
                modify tool-modifica, value = mod
                set StatusVisua to true
                perform STATUS-BAR-MSG 
                if nuovo              
                   initialize tca-dati replacing numeric data by zeroes
                                            alphanumeric data by spaces
                   perform FORM1-FLD-TO-BUF
                   display form1-tb-1
                   set vecchio to true
                end-if      
                perform ABILITAZIONI
                display form1
                |RISETTO IL VALORE A "23" PERCHE DENTRO AL PAR. CLEAR-SCREEN
                |CON L'OPERAZIONE UNLOCK VIENE RISETTATO A ZERO COSICCHÈ 
                |QUANDO TORNA DENTRO AI PAR. DI SCORRIMENTO DI TOTEM SI 
                |TROVA IN UNA SITUAZIONE CORRETTA E PROSEGUE CON LA READ
                |USCENDO CON UN MESSAGGIO DI ERRORE DI TIPO "46"
                move "23" to status-tcaumag
           end-evaluate.
 
      ***---
       TMAGAZ-ERR SECTION.
           use after error procedure on tmagaz.
           set tutto-ok  to true.
           evaluate status-tmagaz
           when "35"
                display message "File [TMAGAZ] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMAGAZ] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMAGAZ] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       MAS-ERR SECTION.
           use after error procedure on MAS.
           set tutto-ok  to true.
           evaluate status-MAS
           when "35"
                display message "File [MAS] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [MAS] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[MAS] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM ginqui-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:tcaumag, INIT:tcaumag, BeforeDestroyResource>
      * <TOTEM:END>
           CALL "w$bitmap" USING WBITMAP-DESTROY, toolbar-bmp
      *    After-Program
           PERFORM ginqui-Ev-After-Program
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
           .

       INIT-BMP.
      * TOOL-ESCI
           COPY RESOURCE "toolbar.bmp".
           CALL "w$bitmap" USING WBITMAP-LOAD "toolbar.bmp", 
                   GIVING toolbar-bmp.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-tcaumag
           PERFORM OPEN-tmagaz
           PERFORM OPEN-MAS
           PERFORM OPEN-TCODPAG
      *    After Open
           .

       OPEN-tcaumag.
      * <TOTEM:EPT. INIT:tcaumag, FD:tcaumag, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O tcaumag
           IF STATUS-tcaumag = "35"
              OPEN OUTPUT tcaumag
                IF Valid-STATUS-tcaumag
                   CLOSE tcaumag
                   OPEN I-O tcaumag
                END-IF
           END-IF
           IF NOT Valid-STATUS-tcaumag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tcaumag, FD:tcaumag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmagaz.
      * <TOTEM:EPT. INIT:tcaumag, FD:tmagaz, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmagaz
           IF NOT Valid-STATUS-tmagaz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tcaumag, FD:tmagaz, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-MAS.
      * <TOTEM:EPT. INIT:tcaumag, FD:MAS, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT MAS
           IF NOT Valid-STATUS-mas
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tcaumag, FD:MAS, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-TCODPAG.
      * <TOTEM:EPT. INIT:tcaumag, FD:TCODPAG, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT TCODPAG
           IF NOT Valid-status-tcodpag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tcaumag, FD:TCODPAG, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-tcaumag
           PERFORM CLOSE-tmagaz
           PERFORM CLOSE-MAS
           PERFORM CLOSE-TCODPAG
      *    After Close
           .

       CLOSE-tcaumag.
      * <TOTEM:EPT. INIT:tcaumag, FD:tcaumag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcaumag
           .

       CLOSE-tmagaz.
      * <TOTEM:EPT. INIT:tcaumag, FD:tmagaz, BeforeClose>
      * <TOTEM:END>
           CLOSE tmagaz
           .

       CLOSE-MAS.
      * <TOTEM:EPT. INIT:tcaumag, FD:MAS, BeforeClose>
      * <TOTEM:END>
           CLOSE MAS
           .

       CLOSE-TCODPAG.
      * <TOTEM:EPT. INIT:tcaumag, FD:TCODPAG, BeforeClose>
      * <TOTEM:END>
           CLOSE TCODPAG
           .

       tcaumag-k-mag-MERGE-SPLITBUF.
           INITIALIZE tcaumag-k-mag-SPLITBUF
           MOVE tca-cod-magaz(1:3) TO tcaumag-k-mag-SPLITBUF(1:3)
           MOVE tca-ord-forn(1:1) TO tcaumag-k-mag-SPLITBUF(4:1)
           .

       DataSet1-tcaumag-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tcaumag-KEY1-Asc
                 MOVE Low-Value TO tca-chiave
              ELSE
                 MOVE High-Value TO tca-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tcaumag-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tcaumag-KEY1-Asc
                 MOVE High-Value TO tca-chiave
              ELSE
                 MOVE Low-Value TO tca-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-tcaumag-KEY1-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-tcaumag-KEY1-ORDER
           END-EVALUATE
           .

      * tcaumag
       DataSet1-tcaumag-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tcaumag-KEY1-Asc
                 START tcaumag KEY >= tca-chiave
              ELSE
                 START tcaumag KEY <= tca-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tcaumag-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tcaumag-KEY1-Asc
                 START tcaumag KEY <= tca-chiave
              ELSE
                 START tcaumag KEY >= tca-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tcaumag-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tcaumag-KEY1-Asc
                 START tcaumag KEY > tca-chiave
              ELSE
                 START tcaumag KEY < tca-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tcaumag-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tcaumag-KEY1-Asc
                 START tcaumag KEY < tca-chiave
              ELSE
                 START tcaumag KEY > tca-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tcaumag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag WITH LOCK 
                 KEY tca-chiave
              ELSE
                 READ tcaumag WITH NO LOCK 
                 KEY tca-chiave
              END-IF
           END-EVALUATE
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT 
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tcaumag-KEY1-Asc
                 IF DataSet1-tcaumag-LOCK
                    READ tcaumag NEXT WITH LOCK
                 ELSE
                    READ tcaumag NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-tcaumag-LOCK
                    READ tcaumag PREVIOUS WITH LOCK
                 ELSE
                    READ tcaumag PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tcaumag-KEY1-Asc
                 IF DataSet1-tcaumag-LOCK
                    READ tcaumag PREVIOUS WITH LOCK
                 ELSE
                    READ tcaumag PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-tcaumag-LOCK
                    READ tcaumag NEXT WITH LOCK
                 ELSE
                    READ tcaumag NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeWrite>
      * <TOTEM:END>
           WRITE tca-rec OF tcaumag.
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRewrite>
      * <TOTEM:END>
           REWRITE tca-rec OF tcaumag.
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeDelete>
      * <TOTEM:END>
           DELETE tcaumag.
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-INITSTART.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE Low-Value TO mag-chiave
           ELSE
              MOVE High-Value TO mag-chiave
           END-IF
           .

       DataSet1-tmagaz-INITEND.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE High-Value TO mag-chiave
           ELSE
              MOVE Low-Value TO mag-chiave
           END-IF
           .

      * tmagaz
       DataSet1-tmagaz-START.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY >= mag-chiave
           ELSE
              START tmagaz KEY <= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-NOTGREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY <= mag-chiave
           ELSE
              START tmagaz KEY >= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-GREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY > mag-chiave
           ELSE
              START tmagaz KEY < mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-LESS.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY < mag-chiave
           ELSE
              START tmagaz KEY > mag-chiave
           END-IF
           .

       DataSet1-tmagaz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmagaz-LOCK
              READ tmagaz WITH LOCK 
              KEY mag-chiave
           ELSE
              READ tmagaz WITH NO LOCK 
              KEY mag-chiave
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT 
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterDelete>
      * <TOTEM:END>
           .

       MAS-MAS-CODICE1-MERGE-SPLITBUF.
           INITIALIZE MAS-MAS-CODICE1-SPLITBUF
           MOVE MAS-CODICE-ALTERNATIVO(1:30) TO 
           MAS-MAS-CODICE1-SPLITBUF(1:30)
           MOVE MAS-CODICE(1:8) TO MAS-MAS-CODICE1-SPLITBUF(31:8)
           .

       MAS-MAS-CODICE2-MERGE-SPLITBUF.
           INITIALIZE MAS-MAS-CODICE2-SPLITBUF
           MOVE MAS-DESCRIZIONE1(1:30) TO MAS-MAS-CODICE2-SPLITBUF(1:30)
           MOVE MAS-CODICE(1:8) TO MAS-MAS-CODICE2-SPLITBUF(31:8)
           .

       DataSet1-MAS-INITSTART.
           IF DataSet1-MAS-KEY-Asc
              MOVE Low-Value TO MAS-CODICE
           ELSE
              MOVE High-Value TO MAS-CODICE
           END-IF
           .

       DataSet1-MAS-INITEND.
           IF DataSet1-MAS-KEY-Asc
              MOVE High-Value TO MAS-CODICE
           ELSE
              MOVE Low-Value TO MAS-CODICE
           END-IF
           .

      * MAS
       DataSet1-MAS-START.
           IF DataSet1-MAS-KEY-Asc
              START MAS KEY >= MAS-CODICE
           ELSE
              START MAS KEY <= MAS-CODICE
           END-IF
           .

       DataSet1-MAS-START-NOTGREATER.
           IF DataSet1-MAS-KEY-Asc
              START MAS KEY <= MAS-CODICE
           ELSE
              START MAS KEY >= MAS-CODICE
           END-IF
           .

       DataSet1-MAS-START-GREATER.
           IF DataSet1-MAS-KEY-Asc
              START MAS KEY > MAS-CODICE
           ELSE
              START MAS KEY < MAS-CODICE
           END-IF
           .

       DataSet1-MAS-START-LESS.
           IF DataSet1-MAS-KEY-Asc
              START MAS KEY < MAS-CODICE
           ELSE
              START MAS KEY > MAS-CODICE
           END-IF
           .

       DataSet1-MAS-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-MAS-LOCK
              READ MAS WITH LOCK 
              KEY MAS-CODICE
           ELSE
              READ MAS WITH NO LOCK 
              KEY MAS-CODICE
           END-IF
           PERFORM MAS-MAS-CODICE1-MERGE-SPLITBUF
           PERFORM MAS-MAS-CODICE2-MERGE-SPLITBUF
           MOVE STATUS-MAS TO TOTEM-ERR-STAT 
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-MAS-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-MAS-KEY-Asc
              IF DataSet1-MAS-LOCK
                 READ MAS NEXT WITH LOCK
              ELSE
                 READ MAS NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-MAS-LOCK
                 READ MAS PREVIOUS WITH LOCK
              ELSE
                 READ MAS PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM MAS-MAS-CODICE1-MERGE-SPLITBUF
           PERFORM MAS-MAS-CODICE2-MERGE-SPLITBUF
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-MAS-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-MAS-KEY-Asc
              IF DataSet1-MAS-LOCK
                 READ MAS PREVIOUS WITH LOCK
              ELSE
                 READ MAS PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-MAS-LOCK
                 READ MAS NEXT WITH LOCK
              ELSE
                 READ MAS NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM MAS-MAS-CODICE1-MERGE-SPLITBUF
           PERFORM MAS-MAS-CODICE2-MERGE-SPLITBUF
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-MAS-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-MAS-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-MAS-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterDelete>
      * <TOTEM:END>
           .

       TCODPAG-TBL-CODICE-01-MERGE-SPLITBUF.
           INITIALIZE TCODPAG-TBL-CODICE-01-SPLITBUF
           MOVE TBLPA-CODICE1(1:2) TO 
           TCODPAG-TBL-CODICE-01-SPLITBUF(1:2)
           MOVE TBLPA-DESCRIZIONE1(1:30) TO 
           TCODPAG-TBL-CODICE-01-SPLITBUF(3:30)
           MOVE TBLPA-CODICE2(1:20) TO 
           TCODPAG-TBL-CODICE-01-SPLITBUF(33:20)
           .

       DataSet1-TCODPAG-INITSTART.
           IF DataSet1-TCODPAG-KEY-Asc
              MOVE Low-Value TO TBLPA-CODICE
           ELSE
              MOVE High-Value TO TBLPA-CODICE
           END-IF
           .

       DataSet1-TCODPAG-INITEND.
           IF DataSet1-TCODPAG-KEY-Asc
              MOVE High-Value TO TBLPA-CODICE
           ELSE
              MOVE Low-Value TO TBLPA-CODICE
           END-IF
           .

      * TCODPAG
       DataSet1-TCODPAG-START.
           IF DataSet1-TCODPAG-KEY-Asc
              START TCODPAG KEY >= TBLPA-CODICE
           ELSE
              START TCODPAG KEY <= TBLPA-CODICE
           END-IF
           .

       DataSet1-TCODPAG-START-NOTGREATER.
           IF DataSet1-TCODPAG-KEY-Asc
              START TCODPAG KEY <= TBLPA-CODICE
           ELSE
              START TCODPAG KEY >= TBLPA-CODICE
           END-IF
           .

       DataSet1-TCODPAG-START-GREATER.
           IF DataSet1-TCODPAG-KEY-Asc
              START TCODPAG KEY > TBLPA-CODICE
           ELSE
              START TCODPAG KEY < TBLPA-CODICE
           END-IF
           .

       DataSet1-TCODPAG-START-LESS.
           IF DataSet1-TCODPAG-KEY-Asc
              START TCODPAG KEY < TBLPA-CODICE
           ELSE
              START TCODPAG KEY > TBLPA-CODICE
           END-IF
           .

       DataSet1-TCODPAG-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-TCODPAG-LOCK
              READ TCODPAG WITH LOCK 
              KEY TBLPA-CODICE
           ELSE
              READ TCODPAG WITH NO LOCK 
              KEY TBLPA-CODICE
           END-IF
           PERFORM TCODPAG-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT 
           MOVE "TCODPAG" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-TCODPAG-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-TCODPAG-KEY-Asc
              IF DataSet1-TCODPAG-LOCK
                 READ TCODPAG NEXT WITH LOCK
              ELSE
                 READ TCODPAG NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-TCODPAG-LOCK
                 READ TCODPAG PREVIOUS WITH LOCK
              ELSE
                 READ TCODPAG PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM TCODPAG-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "TCODPAG" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-TCODPAG-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-TCODPAG-KEY-Asc
              IF DataSet1-TCODPAG-LOCK
                 READ TCODPAG PREVIOUS WITH LOCK
              ELSE
                 READ TCODPAG PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-TCODPAG-LOCK
                 READ TCODPAG NEXT WITH LOCK
              ELSE
                 READ TCODPAG NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM TCODPAG-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "TCODPAG" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-TCODPAG-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, BeforeWrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "TCODPAG" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-TCODPAG-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, BeforeRewrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "TCODPAG" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-TCODPAG-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, BeforeDelete>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "TCODPAG" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:TCODPAG, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE tca-rec OF tcaumag
           INITIALIZE mag-rec OF tmagaz
           INITIALIZE RECORD-MAS OF MAS
           INITIALIZE record-tblpa OF TCODPAG
           .


      * COMBO-BOX
       cbo-nota-Content.
           .

      * FD's Initialize Paragraph
       DataSet1-tcaumag-INITREC.
           INITIALIZE tca-rec OF tcaumag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmagaz-INITREC.
           INITIALIZE mag-rec OF tmagaz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-MAS-INITREC.
           INITIALIZE RECORD-MAS OF MAS
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-TCODPAG-INITREC.
           INITIALIZE record-tblpa OF TCODPAG
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           EVALUATE TOTEM-Form-Index ALSO TOTEM-Frame-Index
              WHEN 1 ALSO 0
                  PERFORM Form1-Buf-To-Fld
           END-EVALUATE
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              LINES 51,85,
              SIZE 119,17,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Small-Font,
              LABEL-OFFSET 23,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Screen1-Event-Proc,
              HANDLE IS form1-Handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              GRIP,
              PANEL-WIDTHS (75, 23, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON form1-Handle
      * DISPLAY-COLUMNS settings
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           perform INIT.
           perform ABILITA-TOOLBAR.
           perform ABILITAZIONI.
           perform STATUS-BAR-MSG.

           modify cbo-nota, reset-list = 1.
           modify cbo-nota, item-to-add = "Abbuono Generico".
           modify cbo-nota, item-to-add = "Reso Merce".
           modify cbo-nota, item-to-add = "Differenza Prezzo".

           modify cbo-nota, value = "Abbuono Generico".
           
      *     perform PRIMO.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY form1-Handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
           evaluate key-status
           when 5 |MODIFICA
                inquire tool-modifica, enabled in e-modifica
                if e-modifica = 1
                   if mod = zero 
                      move 1    to mod
                   else          
                      move zero to mod
                   end-if
                   modify tool-modifica, value = mod
                   perform MODIFICA
                end-if
      *****     when 10 |ORDINAMENTO ALFABETICO 
      *****          if OrderBy = zero 
      *****             move 1       to OrderBy
      *****          else              
      *****             move zero    to OrderBy
      *****          end-if
      *****          modify TOOL-ORD, value OrderBy
      *****          perform ORDINAMENTO
           end-evaluate.

           .
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
              WHEN Key-Status = 1000
                 PERFORM chk-giac-pos-LinkTo
              WHEN Key-Status = 1003
                 PERFORM chk-giac-neg-LinkTo
              WHEN Key-Status = 1004
                 PERFORM chk-imp-pos-LinkTo
              WHEN Key-Status = 1005
                 PERFORM chk-imp-neg-LinkTo
              WHEN Key-Status = 1007
                 PERFORM chk-ord-pos-LinkTo
              WHEN Key-Status = 1008
                 PERFORM chk-ord-neg-LinkTo
              WHEN Key-Status = 1009
                 PERFORM chk-iniz-pos-LinkTo
              WHEN Key-Status = 1010
                 PERFORM chk-iniz-neg-LinkTo
              WHEN Key-Status = 1011
                 PERFORM chk-acq-pos-LinkTo
              WHEN Key-Status = 1012
                 PERFORM chk-acq-neg-LinkTo
              WHEN Key-Status = 1013
                 PERFORM chk-ven-pos-LinkTo
              WHEN Key-Status = 1014
                 PERFORM chk-ven-neg-LinkTo
              WHEN Key-Status = 1015
                 PERFORM chk-var-pos-LinkTo
              WHEN Key-Status = 1016
                 PERFORM chk-var-neg-LinkTo
              WHEN Key-Status = 1017
                 PERFORM chk-resi-for-pos-LinkTo
              WHEN Key-Status = 1018
                 PERFORM chk-resi-for-neg-LinkTo
              WHEN Key-Status = 1019
                 PERFORM chk-resi-cli-pos-LinkTo
              WHEN Key-Status = 1020
                 PERFORM chk-resi-cli-neg-LinkTo
              WHEN Key-Status = 1026
                 PERFORM chk-giac-per-pos-LinkTo
              WHEN Key-Status = 1022
                 PERFORM chk-giac-per-neg-LinkTo
              WHEN Key-Status = 1027
                 PERFORM chk-el-pos-LinkTo
              WHEN Key-Status = 1028
                 PERFORM chk-el-neg-LinkTo
              WHEN Key-Status = 1021
                 PERFORM chk-ul-pos-LinkTo
              WHEN Key-Status = 1029
                 PERFORM chk-ul-neg-LinkTo
              WHEN Key-Status = 1023
                 PERFORM chk-el-pos2-LinkTo
              WHEN Key-Status = 1024
                 PERFORM chk-el-neg2-LinkTo
              WHEN Key-Status = 1025
                 PERFORM chk-ul-pos2-LinkTo
              WHEN Key-Status = 1030
                 PERFORM chk-ul-neg2-LinkTo
              WHEN Key-Status = 1031
                 PERFORM chk-bloc-pos-LinkTo
              WHEN Key-Status = 1032
                 PERFORM chk-bloc-neg-LinkTo
              WHEN Key-Status = 1033
                 PERFORM chk-nota-LinkTo
              WHEN Key-Status = 1033
                 PERFORM chk-nota-LinkTo
              WHEN Key-Status = 1033
                 PERFORM chk-nota-LinkTo
              WHEN Key-Status = 2
                 PERFORM NUOVO-LinkTo
              WHEN Key-Status = 4
                 PERFORM CANCELLA-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
              WHEN Key-Status = 9
                 PERFORM TOOL-SELEZIONA-LinkTo
              WHEN Key-Status = 1002
                 PERFORM TOOL-PRIMO
              WHEN Key-Status = 67
                 PERFORM TOOL-PRECEDENTE
              WHEN Key-Status = 68
                 PERFORM TOOL-SUCCESSIVO
              WHEN Key-Status = 1006
                 PERFORM TOOL-ULTIMO
              WHEN Key-Status = 1001
                 PERFORM TOOL-ORD-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON form1-Handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
           perform SALV-MOD.

           if errori
              move 26 to key-status
              exit paragraph
           end-if.

           .
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * COMBO-BOX
           PERFORM cbo-nota-Content
           .

       Form1-DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-tcaumag-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-tcaumag-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Update-Key.
           MOVE tca-rec OF tcaumag TO
                     Form1-MULKEY-TMPBUF
           PERFORM Form1-CLEAR
           PERFORM Form1-INIT-DATA
           MOVE Form1-MULKEY-TMPBUF TO
                     tca-rec OF tcaumag
           PERFORM DataSet1-tcaumag-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
           .

       Form1-DUPLICATE-MOVEKEY.
           .

       Form1-First.
           PERFORM Form1-DUMMY-FIRST
           PERFORM DataSet1-tcaumag-INITSTART
           PERFORM DataSet1-tcaumag-START
           IF NOT Valid-STATUS-tcaumag
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFirst>
      * <TOTEM:END>
           PERFORM DataSet1-tcaumag-Read-Next
           IF NOT Valid-STATUS-tcaumag
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFirst>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Previous.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-tcaumag-START-LESS
           IF NOT Valid-STATUS-tcaumag
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforePrevious>
      * <TOTEM:END>
           PERFORM DataSet1-tcaumag-Read-Prev
           IF NOT Valid-STATUS-tcaumag
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterPrevious>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-PREVIOUS
           PERFORM Form1-IUD-Display
           .

       Form1-Next.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-tcaumag-START-GREATER
           IF NOT Valid-STATUS-tcaumag
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeNext>
      * <TOTEM:END>
           PERFORM DataSet1-tcaumag-Read-Next
           IF NOT Valid-STATUS-tcaumag
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterNext>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-NEXT
           PERFORM Form1-IUD-Display
           .
      
       Form1-Last.
           PERFORM Form1-DUMMY-LAST
           PERFORM DataSet1-tcaumag-INITEND
           PERFORM DataSet1-tcaumag-START-NOTGREATER
           IF NOT Valid-STATUS-tcaumag
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeLast>
      * <TOTEM:END>
           PERFORM DataSet1-tcaumag-Read-Prev
           IF NOT Valid-STATUS-tcaumag
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterLast>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Curr.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeCurrent>
      * <TOTEM:END>
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-tcaumag-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCurrent>
      * <TOTEM:END>
           .

       Form1-IUD-Display.
           IF Valid-STATUS-tcaumag
              PERFORM Form1-ALLGRID-RESET
              PERFORM Form1-Fld-To-Buf
              PERFORM Form1-NAVI-FOR-MASTERGRID
              PERFORM Form1-DISPLAY
           ELSE
              IF Form1-FLAG-REFRESH
                 CONTINUE
              ELSE
                 PERFORM Form1-Extended-File-Status
              END-IF
           END-IF
           .

       Form1-Add.
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-ADD
           PERFORM DataSet1-tcaumag-INITREC
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAdd>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-tcaumag-Rec-Write
           IF Valid-STATUS-tcaumag
              PERFORM Form1-RESUMMARY-INS
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "301" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAdd>
      * <TOTEM:END>
           .
     
       Form1-Update.
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-tcaumag-START              
           IF NOT Valid-STATUS-tcaumag
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
           PERFORM DataSet1-tcaumag-Read
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-UPDATE
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeUpdate>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-tcaumag-Rec-Rewrite
           IF Valid-STATUS-tcaumag
              PERFORM Form1-RESUMMARY-DEL
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "302" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterUpdate>
      * <TOTEM:END>
           .

       Form1-Delete.
           MOVE "203" TO TOTEM-MSG-ID
           PERFORM MESSAGE-BOX-DISPLAY
           IF TOTEM-MSG-RETURN-VALUE NOT = 1
              INITIALIZE TOTEM-MSG-TEXT
              EXIT PARAGRAPH 
           END-IF
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDelete>
      * <TOTEM:END>
           PERFORM Form1-DUMMY-DELETE
      * delete
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-tcaumag-Rec-Delete
           IF Valid-STATUS-tcaumag
              PERFORM Form1-CLEAR
              PERFORM Form1-DUMMY-DELETE-INIT
              MOVE "303" TO TOTEM-MSG-ID
              MOVE "00" to STATUS-tcaumag
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDelete>
      * <TOTEM:END>
           PERFORM Form1-ERR-CHECKING
           .

       Form1-NAVI-FOR-MASTERGRID.
           .

       Form1-ERR-CHECKING.
           IF Valid-STATUS-tcaumag
              PERFORM Form1-SHOW-MSG-ROUTINE
           ELSE
              PERFORM Form1-Extended-File-Status
           END-IF
           .

       Form1-RESUMMARY-INS.
           .

       Form1-RESUMMARY-DEL.
           .


       Form1-DUMMY-FIRST.
           .

       Form1-DUMMY-PREVIOUS.
           .

       Form1-DUMMY-NEXT.
           .

       Form1-DUMMY-LAST.
           .

       Form1-DUMMY-CURR.
           .

       Form1-DUMMY-ADD.
           .

       Form1-DUMMY-UPDATE.
           .

       Form1-DUMMY-UPDATE-INIT.
           .

       Form1-DUMMY-DELETE.
           .

       Form1-DUMMY-DELETE-INIT.
           .

       Form1-Init-Value.
           MOVE titolo TO TOTEM-MSG-TITLE
           INITIALIZE Form1-BUF
      * FORM : Form1
           PERFORM DataSet1-INIT-RECORD
      * DB_RADIO-BUTTON
              MOVE 1 TO tca-tipo
      * DB_CHECK BOX
              MOVE "N" TO tca-agg-ultimo
      * DB_RADIO-BUTTON
              MOVE 1 TO tca-imponibile
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-giacenza
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-giacenza
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-impegnato
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-impegnato
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-ordinato
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-ordinato
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-iniz
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-iniz
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-acquisti
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-acquisti
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-vendite
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-vendite
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-var-inv
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-var-inv
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-resi-for
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-resi-for
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-resi-da-cli
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-resi-da-cli
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-giac-periodo
      * DB_CHECK BOX
              MOVE SPACE TO tca-movim-giac-periodo
      * DB_CHECK BOX
              MOVE SPACE TO tca-entrate-lav
      * DB_CHECK BOX
              MOVE SPACE TO tca-entrate-lav
      * DB_CHECK BOX
              MOVE SPACE TO tca-uscite-lav
      * DB_CHECK BOX
              MOVE SPACE TO tca-uscite-lav
      * DB_CHECK BOX
              MOVE SPACE TO tca-entrate-lav2
      * DB_CHECK BOX
              MOVE SPACE TO tca-entrate-lav2
      * DB_CHECK BOX
              MOVE SPACE TO tca-uscite-lav2
      * DB_CHECK BOX
              MOVE SPACE TO tca-uscite-lav2
      * DB_CHECK BOX
              MOVE SPACE TO tca-giac-bloc
      * DB_CHECK BOX
              MOVE SPACE TO tca-giac-bloc
      * DB_CHECK BOX
              MOVE "N" TO tca-movim-magaz
      * DB_CHECK BOX
              MOVE "N" TO tca-stampa-bolla
      * DB_CHECK BOX
              MOVE "N" TO tca-emi-fat
      * DB_CHECK BOX
              MOVE "N" TO tca-gest-utf
      * DB_CHECK BOX
              MOVE "N" TO tca-mov-zero
      * DB_CHECK BOX
              MOVE "N" TO tca-trasporto
      * DB_CHECK BOX
              MOVE "N" TO tca-statistiche
      * DB_CHECK BOX
              MOVE 0 TO tca-ord-forn
      * DB_CHECK BOX
              MOVE 0 TO tca-prezzo-reso
      * DB_CHECK BOX
              MOVE 0 TO tca-cap-obbligatorio
      * DB_CHECK BOX
              MOVE "N" TO tca-riordino
      * DB_CHECK BOX
              MOVE "N" TO tca-movim-speciale
      * DB_CHECK BOX
              MOVE 0 TO tca-nota-credito
      * DB_CHECK BOX
              MOVE "N" TO tca-blocco-modeva
      * DB_CHECK BOX
              MOVE "N" TO tca-invio-utf-estero
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
      * ef-codice's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codice-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5001 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-descr's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-descr-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5002 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-tras's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-tras-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5036 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-contropartita's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-contropartita-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5037 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-codmag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codmag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5038 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-codpag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codpag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5039 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cod-edi's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cod-edi-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5040 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
           .

       ef-codice-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codice, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codice-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codice, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codice's Validation
       ef-codice-VALIDATION.
           PERFORM ef-codice-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codice-AFTER-VALIDATION
           .

       ef-descr-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-descr, BeforeValidation>
      * <TOTEM:END>
           .

       ef-descr-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-descr, AfterValidation>
      * <TOTEM:END>
           .

      * ef-descr's Validation
       ef-descr-VALIDATION.
           PERFORM ef-descr-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-descr-AFTER-VALIDATION
           .

       ef-tras-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tras, BeforeValidation>
      * <TOTEM:END>
           .

       ef-tras-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tras, AfterValidation>
      * <TOTEM:END>
           .

      * ef-tras's Validation
       ef-tras-VALIDATION.
           PERFORM ef-tras-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-tras-AFTER-VALIDATION
           .

       ef-contropartita-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-contropartita, BeforeValidation>
      * <TOTEM:END>
           .

       ef-contropartita-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-contropartita, AfterValidation>
      * <TOTEM:END>
           .

      * ef-contropartita's Validation
       ef-contropartita-VALIDATION.
           PERFORM ef-contropartita-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-contropartita-AFTER-VALIDATION
           .

       ef-codmag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codmag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codmag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codmag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codmag's Validation
       ef-codmag-VALIDATION.
           PERFORM ef-codmag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codmag-AFTER-VALIDATION
           .

       ef-codpag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codpag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codpag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codpag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codpag's Validation
       ef-codpag-VALIDATION.
           PERFORM ef-codpag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codpag-AFTER-VALIDATION
           .

       ef-cod-edi-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-edi, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cod-edi-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-edi, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cod-edi's Validation
       ef-cod-edi-VALIDATION.
           PERFORM ef-cod-edi-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cod-edi-AFTER-VALIDATION
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * DB_Entry-Field : ef-codice
           MOVE ef-codice-BUF TO tca-codice
      * DB_Entry-Field : ef-descr
           MOVE ef-descr-BUF TO tca-descrizione
      * DB_RADIOBOX : rb-cli, rb-for, 
           EVALUATE Form1-RADIO-1-BUF
           WHEN 1
              MOVE "C" TO tca-tipo
           WHEN 2
              MOVE "F" TO tca-tipo
           WHEN OTHER
              MOVE SPACE TO tca-tipo
           END-EVALUATE
      * DB_CHECK BOX : chk-aggiorna
              IF chk-aggiorna-BUF = 1
                 MOVE "S" TO tca-agg-ultimo
              ELSE
                 MOVE "N" TO tca-agg-ultimo
              END-IF
      * DB_RADIOBOX : rb-si-imp, rb-no-imp, 
           EVALUATE Form1-RADIO-2-BUF
           WHEN 1
              MOVE "+" TO tca-imponibile
           WHEN 2
              MOVE "-" TO tca-imponibile
           WHEN OTHER
              MOVE SPACE TO tca-imponibile
           END-EVALUATE
      * DB_CHECK BOX : chk-giac-pos
              IF chk-giac-pos-BUF = 1
                 MOVE "+" TO tca-movim-giacenza
              ELSE
                 MOVE SPACE TO tca-movim-giacenza
              END-IF
      * DB_CHECK BOX : chk-giac-neg
              IF chk-giac-neg-BUF = 1
                 MOVE "-" TO tca-movim-giacenza
              ELSE
                 MOVE SPACE TO tca-movim-giacenza
              END-IF
      * DB_CHECK BOX : chk-imp-pos
              IF chk-imp-pos-BUF = 1
                 MOVE "+" TO tca-movim-impegnato
              ELSE
                 MOVE SPACE TO tca-movim-impegnato
              END-IF
      * DB_CHECK BOX : chk-imp-neg
              IF chk-imp-neg-BUF = 1
                 MOVE "-" TO tca-movim-impegnato
              ELSE
                 MOVE SPACE TO tca-movim-impegnato
              END-IF
      * DB_CHECK BOX : chk-ord-pos
              IF chk-ord-pos-BUF = 1
                 MOVE "+" TO tca-movim-ordinato
              ELSE
                 MOVE SPACE TO tca-movim-ordinato
              END-IF
      * DB_CHECK BOX : chk-ord-neg
              IF chk-ord-neg-BUF = 1
                 MOVE "-" TO tca-movim-ordinato
              ELSE
                 MOVE SPACE TO tca-movim-ordinato
              END-IF
      * DB_CHECK BOX : chk-iniz-pos
              IF chk-iniz-pos-BUF = 1
                 MOVE "+" TO tca-movim-iniz
              ELSE
                 MOVE SPACE TO tca-movim-iniz
              END-IF
      * DB_CHECK BOX : chk-iniz-neg
              IF chk-iniz-neg-BUF = 1
                 MOVE "-" TO tca-movim-iniz
              ELSE
                 MOVE SPACE TO tca-movim-iniz
              END-IF
      * DB_CHECK BOX : chk-acq-pos
              IF chk-acq-pos-BUF = 1
                 MOVE "+" TO tca-movim-acquisti
              ELSE
                 MOVE SPACE TO tca-movim-acquisti
              END-IF
      * DB_CHECK BOX : chk-acq-neg
              IF chk-acq-neg-BUF = 1
                 MOVE "-" TO tca-movim-acquisti
              ELSE
                 MOVE SPACE TO tca-movim-acquisti
              END-IF
      * DB_CHECK BOX : chk-ven-pos
              IF chk-ven-pos-BUF = 1
                 MOVE "+" TO tca-movim-vendite
              ELSE
                 MOVE SPACE TO tca-movim-vendite
              END-IF
      * DB_CHECK BOX : chk-ven-neg
              IF chk-ven-neg-BUF = 1
                 MOVE "-" TO tca-movim-vendite
              ELSE
                 MOVE SPACE TO tca-movim-vendite
              END-IF
      * DB_CHECK BOX : chk-var-pos
              IF chk-var-pos-BUF = 1
                 MOVE "+" TO tca-movim-var-inv
              ELSE
                 MOVE SPACE TO tca-movim-var-inv
              END-IF
      * DB_CHECK BOX : chk-var-neg
              IF chk-var-neg-BUF = 1
                 MOVE "-" TO tca-movim-var-inv
              ELSE
                 MOVE SPACE TO tca-movim-var-inv
              END-IF
      * DB_CHECK BOX : chk-resi-for-pos
              IF chk-resi-for-pos-BUF = 1
                 MOVE "+" TO tca-movim-resi-for
              ELSE
                 MOVE SPACE TO tca-movim-resi-for
              END-IF
      * DB_CHECK BOX : chk-resi-for-neg
              IF chk-resi-for-neg-BUF = 1
                 MOVE "-" TO tca-movim-resi-for
              ELSE
                 MOVE SPACE TO tca-movim-resi-for
              END-IF
      * DB_CHECK BOX : chk-resi-cli-pos
              IF chk-resi-cli-pos-BUF = 1
                 MOVE "+" TO tca-movim-resi-da-cli
              ELSE
                 MOVE SPACE TO tca-movim-resi-da-cli
              END-IF
      * DB_CHECK BOX : chk-resi-cli-neg
              IF chk-resi-cli-neg-BUF = 1
                 MOVE "-" TO tca-movim-resi-da-cli
              ELSE
                 MOVE SPACE TO tca-movim-resi-da-cli
              END-IF
      * DB_CHECK BOX : chk-giac-per-pos
              IF chk-giac-per-pos-BUF = 1
                 MOVE "+" TO tca-movim-giac-periodo
              ELSE
                 MOVE SPACE TO tca-movim-giac-periodo
              END-IF
      * DB_CHECK BOX : chk-giac-per-neg
              IF chk-giac-per-neg-BUF = 1
                 MOVE "-" TO tca-movim-giac-periodo
              ELSE
                 MOVE SPACE TO tca-movim-giac-periodo
              END-IF
      * DB_CHECK BOX : chk-el-pos
              IF chk-el-pos-BUF = 1
                 MOVE "+" TO tca-entrate-lav
              ELSE
                 MOVE SPACE TO tca-entrate-lav
              END-IF
      * DB_CHECK BOX : chk-el-neg
              IF chk-el-neg-BUF = 1
                 MOVE "-" TO tca-entrate-lav
              ELSE
                 MOVE SPACE TO tca-entrate-lav
              END-IF
      * DB_CHECK BOX : chk-ul-pos
              IF chk-ul-pos-BUF = 1
                 MOVE "+" TO tca-uscite-lav
              ELSE
                 MOVE SPACE TO tca-uscite-lav
              END-IF
      * DB_CHECK BOX : chk-ul-neg
              IF chk-ul-neg-BUF = 1
                 MOVE "-" TO tca-uscite-lav
              ELSE
                 MOVE SPACE TO tca-uscite-lav
              END-IF
      * DB_CHECK BOX : chk-el-pos2
              IF chk-el-pos2-BUF = 1
                 MOVE "+" TO tca-entrate-lav2
              ELSE
                 MOVE SPACE TO tca-entrate-lav2
              END-IF
      * DB_CHECK BOX : chk-el-neg2
              IF chk-el-neg2-BUF = 1
                 MOVE "-" TO tca-entrate-lav2
              ELSE
                 MOVE SPACE TO tca-entrate-lav2
              END-IF
      * DB_CHECK BOX : chk-ul-pos2
              IF chk-ul-pos2-BUF = 1
                 MOVE "+" TO tca-uscite-lav2
              ELSE
                 MOVE SPACE TO tca-uscite-lav2
              END-IF
      * DB_CHECK BOX : chk-ul-neg2
              IF chk-ul-neg2-BUF = 1
                 MOVE "-" TO tca-uscite-lav2
              ELSE
                 MOVE SPACE TO tca-uscite-lav2
              END-IF
      * DB_CHECK BOX : chk-bloc-pos
              IF chk-bloc-pos-BUF = 1
                 MOVE "+" TO tca-giac-bloc
              ELSE
                 MOVE SPACE TO tca-giac-bloc
              END-IF
      * DB_CHECK BOX : chk-bloc-neg
              IF chk-bloc-neg-BUF = 1
                 MOVE "-" TO tca-giac-bloc
              ELSE
                 MOVE SPACE TO tca-giac-bloc
              END-IF
      * DB_Entry-Field : ef-tras
           MOVE ef-tras-BUF TO tca-caus-trasporto
      * DB_Entry-Field : ef-contropartita
           MOVE ef-contropartita-BUF TO tca-contropartita
      * DB_Entry-Field : ef-codmag
           MOVE ef-codmag-BUF TO tca-cod-magaz
      * DB_Entry-Field : ef-codpag
           MOVE ef-codpag-BUF TO tca-cod-pagamento
      * DB_Entry-Field : ef-cod-edi
           MOVE ef-cod-edi-BUF TO tca-causale-EDI
      * DB_CHECK BOX : chk-movim
              IF chk-movim-BUF = 1
                 MOVE "S" TO tca-movim-magaz
              ELSE
                 MOVE "N" TO tca-movim-magaz
              END-IF
      * DB_CHECK BOX : chk-stbolla
              IF chk-stbolla-BUF = 1
                 MOVE "S" TO tca-stampa-bolla
              ELSE
                 MOVE "N" TO tca-stampa-bolla
              END-IF
      * DB_CHECK BOX : chk-emifat
              IF chk-emifat-BUF = 1
                 MOVE "S" TO tca-emi-fat
              ELSE
                 MOVE "N" TO tca-emi-fat
              END-IF
      * DB_CHECK BOX : chk-utf
              IF chk-utf-BUF = 1
                 MOVE "S" TO tca-gest-utf
              ELSE
                 MOVE "N" TO tca-gest-utf
              END-IF
      * DB_CHECK BOX : chk-autofat
              IF chk-autofat-BUF = 1
                 MOVE "S" TO tca-mov-zero
              ELSE
                 MOVE "N" TO tca-mov-zero
              END-IF
      * DB_CHECK BOX : chk-trasporto
              IF chk-trasporto-BUF = 1
                 MOVE "S" TO tca-trasporto
              ELSE
                 MOVE "N" TO tca-trasporto
              END-IF
      * DB_CHECK BOX : chk-statistiche
              IF chk-statistiche-BUF = 1
                 MOVE "S" TO tca-statistiche
              ELSE
                 MOVE "N" TO tca-statistiche
              END-IF
      * DB_CHECK BOX : chk-ord-forn
              IF chk-ord-forn-BUF = 1
                 MOVE 1 TO tca-ord-forn
              ELSE
                 MOVE 0 TO tca-ord-forn
              END-IF
      * DB_CHECK BOX : chk-reso
              IF chk-reso-BUF = 1
                 MOVE 1 TO tca-prezzo-reso
              ELSE
                 MOVE 0 TO tca-prezzo-reso
              END-IF
      * DB_CHECK BOX : chk-cap
              IF chk-cap-BUF = 1
                 MOVE 1 TO tca-cap-obbligatorio
              ELSE
                 MOVE 0 TO tca-cap-obbligatorio
              END-IF
      * DB_CHECK BOX : chk-riordino
              IF chk-riordino-BUF = 1
                 MOVE "S" TO tca-riordino
              ELSE
                 MOVE "N" TO tca-riordino
              END-IF
      * DB_CHECK BOX : chk-allerta
              IF chk-allerta-BUF = 1
                 MOVE "S" TO tca-movim-speciale
              ELSE
                 MOVE "N" TO tca-movim-speciale
              END-IF
      * DB_CHECK BOX : chk-nota
              IF chk-nota-BUF = 1
                 MOVE 1 TO tca-nota-credito
              ELSE
                 MOVE 0 TO tca-nota-credito
              END-IF
      * DB_CHECK BOX : chk-blocco
              IF chk-blocco-BUF = 1
                 MOVE "S" TO tca-blocco-modeva
              ELSE
                 MOVE "N" TO tca-blocco-modeva
              END-IF
      * DB_CHECK BOX : chk-utf-estero
              IF chk-utf-estero-BUF = 1
                 MOVE "S" TO tca-invio-utf-estero
              ELSE
                 MOVE "N" TO tca-invio-utf-estero
              END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
           move ef-codice-buf to tca-codice.

      * CONTROLLA I CHECK-BOX (DA VIDEO A FILE)                                         
           evaluate true
           when chk-giac-pos-buf = 1
                set tca-movim-giac-pos to true
           when chk-giac-neg-buf = 1 
                set tca-movim-giac-neg to true
           when other
                set tca-no-movim-giac  to true
           end-evaluate.

           evaluate true
           when chk-imp-pos-buf = 1
                set tca-movim-imp-pos to true
           when chk-imp-neg-buf = 1 
                set tca-movim-imp-neg to true
           when other
                set tca-no-movim-imp  to true
           end-evaluate.

           evaluate true
           when chk-ord-pos-buf = 1
                set tca-movim-ord-pos to true
           when chk-ord-neg-buf = 1 
                set tca-movim-ord-neg to true
           when other
                set tca-no-movim-ord  to true
           end-evaluate.

           evaluate true
           when chk-iniz-pos-buf = 1
                set tca-movim-iniz-pos to true
           when chk-iniz-neg-buf = 1 
                set tca-movim-iniz-neg to true
           when other
                set tca-no-movim-iniz  to true
           end-evaluate.

           evaluate true
           when chk-acq-pos-buf = 1
                set tca-movim-acq-pos to true
           when chk-acq-neg-buf = 1 
                set tca-movim-acq-neg to true
           when other
                set tca-no-movim-acq  to true
           end-evaluate.

           evaluate true
           when chk-ven-pos-buf = 1
                set tca-movim-ven-pos to true
           when chk-ven-neg-buf = 1 
                set tca-movim-ven-neg to true
           when other
                set tca-no-movim-ven  to true
           end-evaluate.

           evaluate true
           when chk-var-pos-buf = 1
                set tca-movim-var-inv-pos to true
           when chk-var-neg-buf = 1 
                set tca-movim-var-inv-neg to true
           when other
                set tca-no-movim-var-inv  to true
           end-evaluate.

           evaluate true
           when chk-resi-for-pos-buf = 1
                set tca-movim-resi-for-pos to true
           when chk-resi-for-neg-buf = 1 
                set tca-movim-resi-for-neg to true
           when other
                set tca-no-movim-resi-for  to true
           end-evaluate.

           evaluate true
           when chk-resi-cli-pos-buf = 1
                set tca-movim-resi-cli-pos to true
           when chk-resi-cli-neg-buf = 1 
                set tca-movim-resi-cli-neg to true
           when other
                set tca-no-movim-resi-cli  to true
           end-evaluate.

           evaluate true
           when chk-giac-per-pos-buf = 1
                set tca-movim-giac-periodo-pos to true
           when chk-giac-per-neg-buf = 1 
                set tca-movim-giac-periodo-neg to true
           when other
                set tca-no-movim-giac-periodo  to true
           end-evaluate.

           evaluate true
           when chk-el-pos-buf = 1
                set tca-entrate-lav-pos to true
           when chk-el-neg-buf = 1 
                set tca-entrate-lav-neg to true
           when other
                set tca-no-entrate-lav  to true
           end-evaluate.

           evaluate true
           when chk-ul-pos-buf = 1
                set tca-uscite-lav-pos to true
           when chk-ul-neg-buf = 1 
                set tca-uscite-lav-neg to true
           when other
                set tca-no-uscite-lav  to true
           end-evaluate.

           evaluate true
           when chk-el-pos2-buf = 1
                set tca-entrate-lav2-pos to true
           when chk-el-neg2-buf = 1 
                set tca-entrate-lav2-neg to true
           when other
                set tca-no-entrate-lav2  to true
           end-evaluate.

           evaluate true
           when chk-ul-pos2-buf = 1
                set tca-uscite-lav2-pos to true
           when chk-ul-neg2-buf = 1 
                set tca-uscite-lav2-neg to true
           when other
                set tca-no-uscite-lav2  to true
           end-evaluate.

           evaluate true
           when chk-bloc-pos-buf = 1
                set tca-giac-bloc-pos to true
           when chk-bloc-neg-buf = 1 
                set tca-giac-bloc-neg to true
           when other
                set tca-no-giac-bloc  to true
           end-evaluate.

           if v-nota = 1
              evaluate cbo-nota-buf
              when "Abbuono Generico"  move 3 to tca-tipo-nota
              when "Reso Merce"        move 1 to tca-tipo-nota
              when "Differenza Prezzo" move 2 to tca-tipo-nota
              end-evaluate
           else
              move 0 to v-nota
           end-if.

           .
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * <TOTEM:END>
      * DB_Entry-Field : ef-codice
           MOVE tca-codice TO ef-codice-BUF
      * DB_Entry-Field : ef-descr
           MOVE tca-descrizione TO ef-descr-BUF
      * DB_RADIOBOX : rb-cli, rb-for, 
           EVALUATE tca-tipo
           WHEN "C"
              MOVE 1 TO Form1-RADIO-1-BUF
           WHEN "F"
              MOVE 2 TO Form1-RADIO-1-BUF
           WHEN OTHER
              MOVE ZERO TO Form1-RADIO-1-BUF
           END-EVALUATE
      * DB_CHECK BOX : chk-aggiorna
              IF tca-agg-ultimo = "S"
                 MOVE 1 TO chk-aggiorna-BUF
              ELSE
                 MOVE 0 TO chk-aggiorna-BUF
              END-IF
      * DB_RADIOBOX : rb-si-imp, rb-no-imp, 
           EVALUATE tca-imponibile
           WHEN "+"
              MOVE 1 TO Form1-RADIO-2-BUF
           WHEN "-"
              MOVE 2 TO Form1-RADIO-2-BUF
           WHEN OTHER
              MOVE ZERO TO Form1-RADIO-2-BUF
           END-EVALUATE
      * DB_CHECK BOX : chk-giac-pos
              IF tca-movim-giacenza = "+"
                 MOVE 1 TO chk-giac-pos-BUF
              ELSE
                 MOVE 0 TO chk-giac-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-giac-neg
              IF tca-movim-giacenza = "-"
                 MOVE 1 TO chk-giac-neg-BUF
              ELSE
                 MOVE 0 TO chk-giac-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-imp-pos
              IF tca-movim-impegnato = "+"
                 MOVE 1 TO chk-imp-pos-BUF
              ELSE
                 MOVE 0 TO chk-imp-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-imp-neg
              IF tca-movim-impegnato = "-"
                 MOVE 1 TO chk-imp-neg-BUF
              ELSE
                 MOVE 0 TO chk-imp-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-ord-pos
              IF tca-movim-ordinato = "+"
                 MOVE 1 TO chk-ord-pos-BUF
              ELSE
                 MOVE 0 TO chk-ord-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-ord-neg
              IF tca-movim-ordinato = "-"
                 MOVE 1 TO chk-ord-neg-BUF
              ELSE
                 MOVE 0 TO chk-ord-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-iniz-pos
              IF tca-movim-iniz = "+"
                 MOVE 1 TO chk-iniz-pos-BUF
              ELSE
                 MOVE 0 TO chk-iniz-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-iniz-neg
              IF tca-movim-iniz = "-"
                 MOVE 1 TO chk-iniz-neg-BUF
              ELSE
                 MOVE 0 TO chk-iniz-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-acq-pos
              IF tca-movim-acquisti = "+"
                 MOVE 1 TO chk-acq-pos-BUF
              ELSE
                 MOVE 0 TO chk-acq-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-acq-neg
              IF tca-movim-acquisti = "-"
                 MOVE 1 TO chk-acq-neg-BUF
              ELSE
                 MOVE 0 TO chk-acq-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-ven-pos
              IF tca-movim-vendite = "+"
                 MOVE 1 TO chk-ven-pos-BUF
              ELSE
                 MOVE 0 TO chk-ven-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-ven-neg
              IF tca-movim-vendite = "-"
                 MOVE 1 TO chk-ven-neg-BUF
              ELSE
                 MOVE 0 TO chk-ven-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-var-pos
              IF tca-movim-var-inv = "+"
                 MOVE 1 TO chk-var-pos-BUF
              ELSE
                 MOVE 0 TO chk-var-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-var-neg
              IF tca-movim-var-inv = "-"
                 MOVE 1 TO chk-var-neg-BUF
              ELSE
                 MOVE 0 TO chk-var-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-resi-for-pos
              IF tca-movim-resi-for = "+"
                 MOVE 1 TO chk-resi-for-pos-BUF
              ELSE
                 MOVE 0 TO chk-resi-for-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-resi-for-neg
              IF tca-movim-resi-for = "-"
                 MOVE 1 TO chk-resi-for-neg-BUF
              ELSE
                 MOVE 0 TO chk-resi-for-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-resi-cli-pos
              IF tca-movim-resi-da-cli = "+"
                 MOVE 1 TO chk-resi-cli-pos-BUF
              ELSE
                 MOVE 0 TO chk-resi-cli-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-resi-cli-neg
              IF tca-movim-resi-da-cli = "-"
                 MOVE 1 TO chk-resi-cli-neg-BUF
              ELSE
                 MOVE 0 TO chk-resi-cli-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-giac-per-pos
              IF tca-movim-giac-periodo = "+"
                 MOVE 1 TO chk-giac-per-pos-BUF
              ELSE
                 MOVE 0 TO chk-giac-per-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-giac-per-neg
              IF tca-movim-giac-periodo = "-"
                 MOVE 1 TO chk-giac-per-neg-BUF
              ELSE
                 MOVE 0 TO chk-giac-per-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-el-pos
              IF tca-entrate-lav = "+"
                 MOVE 1 TO chk-el-pos-BUF
              ELSE
                 MOVE 0 TO chk-el-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-el-neg
              IF tca-entrate-lav = "-"
                 MOVE 1 TO chk-el-neg-BUF
              ELSE
                 MOVE 0 TO chk-el-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-ul-pos
              IF tca-uscite-lav = "+"
                 MOVE 1 TO chk-ul-pos-BUF
              ELSE
                 MOVE 0 TO chk-ul-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-ul-neg
              IF tca-uscite-lav = "-"
                 MOVE 1 TO chk-ul-neg-BUF
              ELSE
                 MOVE 0 TO chk-ul-neg-BUF
              END-IF
      * DB_CHECK BOX : chk-el-pos2
              IF tca-entrate-lav2 = "+"
                 MOVE 1 TO chk-el-pos2-BUF
              ELSE
                 MOVE 0 TO chk-el-pos2-BUF
              END-IF
      * DB_CHECK BOX : chk-el-neg2
              IF tca-entrate-lav2 = "-"
                 MOVE 1 TO chk-el-neg2-BUF
              ELSE
                 MOVE 0 TO chk-el-neg2-BUF
              END-IF
      * DB_CHECK BOX : chk-ul-pos2
              IF tca-uscite-lav2 = "+"
                 MOVE 1 TO chk-ul-pos2-BUF
              ELSE
                 MOVE 0 TO chk-ul-pos2-BUF
              END-IF
      * DB_CHECK BOX : chk-ul-neg2
              IF tca-uscite-lav2 = "-"
                 MOVE 1 TO chk-ul-neg2-BUF
              ELSE
                 MOVE 0 TO chk-ul-neg2-BUF
              END-IF
      * DB_CHECK BOX : chk-bloc-pos
              IF tca-giac-bloc = "+"
                 MOVE 1 TO chk-bloc-pos-BUF
              ELSE
                 MOVE 0 TO chk-bloc-pos-BUF
              END-IF
      * DB_CHECK BOX : chk-bloc-neg
              IF tca-giac-bloc = "-"
                 MOVE 1 TO chk-bloc-neg-BUF
              ELSE
                 MOVE 0 TO chk-bloc-neg-BUF
              END-IF
      * DB_Entry-Field : ef-tras
           MOVE tca-caus-trasporto TO ef-tras-BUF
      * DB_Entry-Field : ef-contropartita
           MOVE tca-contropartita TO ef-contropartita-BUF
      * DB_Entry-Field : ef-codmag
           MOVE tca-cod-magaz TO ef-codmag-BUF
      * DB_Entry-Field : ef-codpag
           MOVE tca-cod-pagamento TO ef-codpag-BUF
      * DB_Entry-Field : ef-cod-edi
           MOVE tca-causale-EDI TO ef-cod-edi-BUF
      * DB_CHECK BOX : chk-movim
              IF tca-movim-magaz = "S"
                 MOVE 1 TO chk-movim-BUF
              ELSE
                 MOVE 0 TO chk-movim-BUF
              END-IF
      * DB_CHECK BOX : chk-stbolla
              IF tca-stampa-bolla = "S"
                 MOVE 1 TO chk-stbolla-BUF
              ELSE
                 MOVE 0 TO chk-stbolla-BUF
              END-IF
      * DB_CHECK BOX : chk-emifat
              IF tca-emi-fat = "S"
                 MOVE 1 TO chk-emifat-BUF
              ELSE
                 MOVE 0 TO chk-emifat-BUF
              END-IF
      * DB_CHECK BOX : chk-utf
              IF tca-gest-utf = "S"
                 MOVE 1 TO chk-utf-BUF
              ELSE
                 MOVE 0 TO chk-utf-BUF
              END-IF
      * DB_CHECK BOX : chk-autofat
              IF tca-mov-zero = "S"
                 MOVE 1 TO chk-autofat-BUF
              ELSE
                 MOVE 0 TO chk-autofat-BUF
              END-IF
      * DB_CHECK BOX : chk-trasporto
              IF tca-trasporto = "S"
                 MOVE 1 TO chk-trasporto-BUF
              ELSE
                 MOVE 0 TO chk-trasporto-BUF
              END-IF
      * DB_CHECK BOX : chk-statistiche
              IF tca-statistiche = "S"
                 MOVE 1 TO chk-statistiche-BUF
              ELSE
                 MOVE 0 TO chk-statistiche-BUF
              END-IF
      * DB_CHECK BOX : chk-ord-forn
              IF tca-ord-forn = 1
                 MOVE 1 TO chk-ord-forn-BUF
              ELSE
                 MOVE 0 TO chk-ord-forn-BUF
              END-IF
      * DB_CHECK BOX : chk-reso
              IF tca-prezzo-reso = 1
                 MOVE 1 TO chk-reso-BUF
              ELSE
                 MOVE 0 TO chk-reso-BUF
              END-IF
      * DB_CHECK BOX : chk-cap
              IF tca-cap-obbligatorio = 1
                 MOVE 1 TO chk-cap-BUF
              ELSE
                 MOVE 0 TO chk-cap-BUF
              END-IF
      * DB_CHECK BOX : chk-riordino
              IF tca-riordino = "S"
                 MOVE 1 TO chk-riordino-BUF
              ELSE
                 MOVE 0 TO chk-riordino-BUF
              END-IF
      * DB_CHECK BOX : chk-allerta
              IF tca-movim-speciale = "S"
                 MOVE 1 TO chk-allerta-BUF
              ELSE
                 MOVE 0 TO chk-allerta-BUF
              END-IF
      * DB_CHECK BOX : chk-nota
              IF tca-nota-credito = 1
                 MOVE 1 TO chk-nota-BUF
              ELSE
                 MOVE 0 TO chk-nota-BUF
              END-IF
      * DB_CHECK BOX : chk-blocco
              IF tca-blocco-modeva = "S"
                 MOVE 1 TO chk-blocco-BUF
              ELSE
                 MOVE 0 TO chk-blocco-BUF
              END-IF
      * DB_CHECK BOX : chk-utf-estero
              IF tca-invio-utf-estero = "S"
                 MOVE 1 TO chk-utf-estero-BUF
              ELSE
                 MOVE 0 TO chk-utf-estero-BUF
              END-IF
      * DB_LABEL : lab-mag-des
              MOVE mag-descrizione  TO lab-mag-des-BUF
      * DB_LABEL : lab-pag-des
              MOVE tblpa-descrizione1  TO lab-pag-des-BUF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
           perform ABILITAZIONI.

      * CONTROLLA I CEECK-BOX (DA FILE A VIDEO)
           evaluate true
           when tca-movim-giac-pos
                move 1 to chk-giac-pos-buf
           when tca-movim-giac-neg 
                move 1 to chk-giac-neg-buf
           when other
                move 0 to chk-giac-pos-buf, chk-giac-neg-buf
           end-evaluate.

           evaluate true
           when tca-movim-imp-pos
                move 1 to chk-imp-pos-buf
           when tca-movim-imp-neg 
                move 1 to chk-imp-neg-buf
           when other
                move 0 to chk-imp-pos-buf, chk-imp-neg-buf
           end-evaluate.

           evaluate true
           when tca-movim-ord-pos
                move 1 to chk-ord-pos-buf
           when tca-movim-ord-neg 
                move 1 to chk-ord-neg-buf
           when other
                move 0 to chk-ord-pos-buf, chk-ord-neg-buf
           end-evaluate.

           evaluate true
           when tca-movim-iniz-pos
                move 1 to chk-iniz-pos-buf
           when tca-movim-iniz-neg 
                move 1 to chk-iniz-neg-buf
           when other
                move 0 to chk-iniz-pos-buf, chk-iniz-neg-buf
           end-evaluate.

           evaluate true
           when tca-movim-acq-pos
                move 1 to chk-acq-pos-buf
           when tca-movim-acq-neg 
                move 1 to chk-acq-neg-buf
           when other
                move 0 to chk-acq-pos-buf, chk-acq-neg-buf
           end-evaluate.

           evaluate true
           when tca-movim-ven-pos
                move 1 to chk-ven-pos-buf
           when tca-movim-ven-neg 
                move 1 to chk-ven-neg-buf
           when other
                move 0 to chk-ven-pos-buf, chk-ven-neg-buf
           end-evaluate.

           evaluate true
           when tca-movim-var-inv-pos
                move 1 to chk-var-pos-buf
           when tca-movim-var-inv-neg 
                move 1 to chk-var-neg-buf
           when other
                move 0 to chk-var-pos-buf, chk-var-neg-buf
           end-evaluate.

           evaluate true
           when tca-movim-resi-for-pos
                move 1 to chk-resi-for-pos-buf
           when tca-movim-resi-for-neg 
                move 1 to chk-resi-for-neg-buf
           when other
                move 0 to chk-resi-for-pos-buf, chk-resi-for-neg-buf
           end-evaluate.

           evaluate true
           when tca-movim-resi-cli-pos
                move 1 to chk-resi-cli-pos-buf
           when tca-movim-resi-cli-neg 
                move 1 to chk-resi-cli-neg-buf
           when other
                move 0 to chk-resi-cli-pos-buf, chk-resi-cli-neg-buf
           end-evaluate.

           evaluate true
           when tca-movim-giac-periodo-pos
                move 1 to chk-giac-per-pos-buf
           when tca-movim-giac-periodo-neg 
                move 1 to chk-giac-per-neg-buf
           when other
                move 0 to chk-giac-per-pos-buf, 
                          chk-giac-per-neg-buf
           end-evaluate.

           evaluate true
           when tca-entrate-lav-pos
                move 1 to chk-el-pos-buf
           when tca-entrate-lav-neg
                move 1 to chk-el-neg-buf
           when tca-no-entrate-lav
                move 0 to chk-el-pos-buf
                move 0 to chk-el-neg-buf
           end-evaluate.

           evaluate true
           when tca-uscite-lav-pos
                move 1 to chk-ul-pos-buf
           when tca-uscite-lav-neg
                move 1 to chk-ul-neg-buf
           when tca-no-uscite-lav
                move 0 to chk-ul-pos-buf
                move 0 to chk-ul-neg-buf
           end-evaluate.

           evaluate true
           when tca-entrate-lav2-pos
                move 1 to chk-el-pos2-buf
           when tca-entrate-lav2-neg
                move 1 to chk-el-neg2-buf
           when tca-no-entrate-lav2
                move 0 to chk-el-pos2-buf
                move 0 to chk-el-neg2-buf
           end-evaluate.

           evaluate true
           when tca-uscite-lav2-pos
                move 1 to chk-ul-pos2-buf
           when tca-uscite-lav2-neg
                move 1 to chk-ul-neg2-buf
           when tca-no-uscite-lav2
                move 0 to chk-ul-pos2-buf
                move 0 to chk-ul-neg2-buf
           end-evaluate.

           evaluate true
           when tca-giac-bloc-pos
                move 1 to chk-bloc-pos-buf
           when tca-giac-bloc-neg
                move 1 to chk-bloc-neg-buf
           when tca-no-giac-bloc
                move 0 to chk-bloc-pos-buf
                move 0 to chk-bloc-neg-buf
           end-evaluate.

           move tca-cod-magaz to mag-codice.
           move spaces        to mag-descrizione.
           read tmagaz no lock invalid continue end-read.
           move mag-descrizione to lab-mag-des-buf.

           move "PA"              to tblpa-codice1.
           move tca-cod-pagamento to tblpa-codice2.
           move spaces            to tblpa-descrizione1.
           read tcodpag no lock invalid continue end-read.
           move tblpa-descrizione1 to lab-pag-des-buf.

           perform VALORIZZA-OLD.

           initialize record-mas.
           move tca-contropartita to mas-codice.
           read mas invalid continue end-read.
           perform MOVE-DESCR-PIANO.           

           if tca-nota-credito-si
              evaluate tca-tipo-nota
              when 3 move "Abbuono Generico"  to cbo-nota-buf
              when 1 move "Reso Merce"        to cbo-nota-buf
              when 2 move "Differenza Prezzo" to cbo-nota-buf
              end-evaluate
              move 1 to v-nota
           else
              move 0 to v-nota
           end-if.

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           if tca-descrizione not = old-tca-descrizione
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-descr è l'ID del campo ef-descr
              move 78-ID-ef-descr to store-id 
           end-if

           if tca-tipo not = old-tca-tipo
              and SiSalvato
              set NoSalvato to true
              |78-ID-rb-cli è l'ID del campo rb-cli
              move 78-ID-rb-cli to store-id 
           end-if

           if tca-tipo not = old-tca-tipo
              and SiSalvato
              set NoSalvato to true
              |78-ID-rb-for è l'ID del campo rb-for
              move 78-ID-rb-for to store-id 
           end-if

           if tca-agg-ultimo not = old-tca-agg-ultimo
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-aggiorna è l'ID del campo chk-aggiorna
              move 78-ID-chk-aggiorna to store-id 
           end-if

           if tca-imponibile not = old-tca-imponibile
              and SiSalvato
              set NoSalvato to true
              |78-ID-rb-si-imp è l'ID del campo rb-si-imp
              move 78-ID-rb-si-imp to store-id 
           end-if

           if tca-imponibile not = old-tca-imponibile
              and SiSalvato
              set NoSalvato to true
              |78-ID-rb-no-imp è l'ID del campo rb-no-imp
              move 78-ID-rb-no-imp to store-id 
           end-if

           if tca-movim-giacenza not = old-tca-movim-giacenza
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-giac-pos è l'ID del campo chk-giac-pos
              move 78-ID-chk-giac-pos to store-id 
           end-if

           if tca-movim-giacenza not = old-tca-movim-giacenza
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-giac-neg è l'ID del campo chk-giac-neg
              move 78-ID-chk-giac-neg to store-id 
           end-if

           if tca-movim-impegnato not = old-tca-movim-impegnato
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-imp-pos è l'ID del campo chk-imp-pos
              move 78-ID-chk-imp-pos to store-id 
           end-if

           if tca-movim-impegnato not = old-tca-movim-impegnato
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-imp-neg è l'ID del campo chk-imp-neg
              move 78-ID-chk-imp-neg to store-id 
           end-if

           if tca-movim-ordinato not = old-tca-movim-ordinato
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ord-pos è l'ID del campo chk-ord-pos
              move 78-ID-chk-ord-pos to store-id 
           end-if

           if tca-movim-ordinato not = old-tca-movim-ordinato
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ord-neg è l'ID del campo chk-ord-neg
              move 78-ID-chk-ord-neg to store-id 
           end-if

           if tca-movim-iniz not = old-tca-movim-iniz
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-iniz-pos è l'ID del campo chk-iniz-pos
              move 78-ID-chk-iniz-pos to store-id 
           end-if

           if tca-movim-iniz not = old-tca-movim-iniz
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-iniz-neg è l'ID del campo chk-iniz-neg
              move 78-ID-chk-iniz-neg to store-id 
           end-if

           if tca-movim-acquisti not = old-tca-movim-acquisti
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-acq-pos è l'ID del campo chk-acq-pos
              move 78-ID-chk-acq-pos to store-id 
           end-if

           if tca-movim-acquisti not = old-tca-movim-acquisti
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-acq-neg è l'ID del campo chk-acq-neg
              move 78-ID-chk-acq-neg to store-id 
           end-if

           if tca-movim-vendite not = old-tca-movim-vendite
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ven-pos è l'ID del campo chk-ven-pos
              move 78-ID-chk-ven-pos to store-id 
           end-if

           if tca-movim-vendite not = old-tca-movim-vendite
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ven-neg è l'ID del campo chk-ven-neg
              move 78-ID-chk-ven-neg to store-id 
           end-if

           if tca-movim-var-inv not = old-tca-movim-var-inv
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-var-pos è l'ID del campo chk-var-pos
              move 78-ID-chk-var-pos to store-id 
           end-if

           if tca-movim-var-inv not = old-tca-movim-var-inv
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-var-neg è l'ID del campo chk-var-neg
              move 78-ID-chk-var-neg to store-id 
           end-if

           if tca-movim-resi-for not = old-tca-movim-resi-for
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-resi-for-pos è l'ID del campo chk-resi-for-pos
              move 78-ID-chk-resi-for-pos to store-id 
           end-if

           if tca-movim-resi-for not = old-tca-movim-resi-for
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-resi-for-neg è l'ID del campo chk-resi-for-neg
              move 78-ID-chk-resi-for-neg to store-id 
           end-if

           if tca-movim-resi-da-cli not = old-tca-movim-resi-da-cli
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-resi-cli-pos è l'ID del campo chk-resi-cli-pos
              move 78-ID-chk-resi-cli-pos to store-id 
           end-if

           if tca-movim-resi-da-cli not = old-tca-movim-resi-da-cli
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-resi-cli-neg è l'ID del campo chk-resi-cli-neg
              move 78-ID-chk-resi-cli-neg to store-id 
           end-if

           if tca-movim-giac-periodo not = old-tca-movim-giac-periodo
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-giac-per-pos è l'ID del campo chk-giac-per-pos
              move 78-ID-chk-giac-per-pos to store-id 
           end-if

           if tca-movim-giac-periodo not = old-tca-movim-giac-periodo
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-giac-per-neg è l'ID del campo chk-giac-per-neg
              move 78-ID-chk-giac-per-neg to store-id 
           end-if

           if tca-entrate-lav not = old-tca-entrate-lav
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-el-pos è l'ID del campo chk-el-pos
              move 78-ID-chk-el-pos to store-id 
           end-if

           if tca-entrate-lav not = old-tca-entrate-lav
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-el-neg è l'ID del campo chk-el-neg
              move 78-ID-chk-el-neg to store-id 
           end-if

           if tca-uscite-lav not = old-tca-uscite-lav
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ul-pos è l'ID del campo chk-ul-pos
              move 78-ID-chk-ul-pos to store-id 
           end-if

           if tca-uscite-lav not = old-tca-uscite-lav
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ul-neg è l'ID del campo chk-ul-neg
              move 78-ID-chk-ul-neg to store-id 
           end-if

           if tca-entrate-lav2 not = old-tca-entrate-lav2
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-el-pos2 è l'ID del campo chk-el-pos2
              move 78-ID-chk-el-pos2 to store-id 
           end-if

           if tca-entrate-lav2 not = old-tca-entrate-lav2
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-el-neg2 è l'ID del campo chk-el-neg2
              move 78-ID-chk-el-neg2 to store-id 
           end-if

           if tca-uscite-lav2 not = old-tca-uscite-lav2
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ul-pos2 è l'ID del campo chk-ul-pos2
              move 78-ID-chk-ul-pos2 to store-id 
           end-if

           if tca-uscite-lav2 not = old-tca-uscite-lav2
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-ul-neg2 è l'ID del campo chk-ul-neg2
              move 78-ID-chk-ul-neg2 to store-id 
           end-if

           if tca-giac-bloc not = old-tca-giac-bloc
              and SiSalvato
              set NoSalvato to true
              |36 è l'ID del campo chk-bloc-pos
              move 36 to store-id
           end-if

           if tca-giac-bloc not = old-tca-giac-bloc
              and SiSalvato
              set NoSalvato to true
              |37 è l'ID del campo chk-bloc-neg
              move 37 to store-id
           end-if

           if tca-caus-trasporto not = old-tca-caus-trasporto
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-tras è l'ID del campo ef-tras
              move 78-ID-ef-tras to store-id 
           end-if

           if tca-contropartita not = old-tca-contropartita
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-contropartita è l'ID del campo ef-contropartita
              move 78-ID-ef-contropartita to store-id 
           end-if

           if tca-cod-magaz not = old-tca-cod-magaz
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-codmag è l'ID del campo ef-codmag
              move 78-ID-ef-codmag to store-id 
           end-if

           if tca-cod-pagamento not = old-tca-cod-pagamento
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-codpag è l'ID del campo ef-codpag
              move 78-ID-ef-codpag to store-id 
           end-if

           if tca-causale-EDI not = old-tca-causale-EDI
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cod-edi è l'ID del campo ef-cod-edi
              move 78-ID-ef-cod-edi to store-id 
           end-if

           if tca-movim-magaz not = old-tca-movim-magaz
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-movim è l'ID del campo chk-movim
              move 78-ID-chk-movim to store-id 
           end-if

           if tca-stampa-bolla not = old-tca-stampa-bolla
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-stbolla è l'ID del campo chk-stbolla
              move 78-ID-chk-stbolla to store-id 
           end-if

           if tca-emi-fat not = old-tca-emi-fat
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-emifat è l'ID del campo chk-emifat
              move 78-ID-chk-emifat to store-id 
           end-if

           if tca-gest-utf not = old-tca-gest-utf
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-utf è l'ID del campo chk-utf
              move 78-ID-chk-utf to store-id 
           end-if

           if tca-mov-zero not = old-tca-mov-zero
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-autofat è l'ID del campo chk-autofat
              move 78-ID-chk-autofat to store-id 
           end-if

           if tca-trasporto not = old-tca-trasporto
              and SiSalvato
              set NoSalvato to true
              |48 è l'ID del campo chk-trasporto
              move 48 to store-id
           end-if

           if tca-statistiche not = old-tca-statistiche
              and SiSalvato
              set NoSalvato to true
              |49 è l'ID del campo chk-statistiche
              move 49 to store-id
           end-if

           if tca-ord-forn not = old-tca-ord-forn
              and SiSalvato
              set NoSalvato to true
              |50 è l'ID del campo chk-ord-forn
              move 50 to store-id
           end-if

           if tca-prezzo-reso not = old-tca-prezzo-reso
              and SiSalvato
              set NoSalvato to true
              |51 è l'ID del campo chk-reso
              move 51 to store-id
           end-if

           if tca-cap-obbligatorio not = old-tca-cap-obbligatorio
              and SiSalvato
              set NoSalvato to true
              |52 è l'ID del campo chk-cap
              move 52 to store-id
           end-if

           if tca-riordino not = old-tca-riordino
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-riordino è l'ID del campo chk-riordino
              move 78-ID-chk-riordino to store-id 
           end-if

           if tca-movim-speciale not = old-tca-movim-speciale
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-allerta è l'ID del campo chk-allerta
              move 78-ID-chk-allerta to store-id 
           end-if

           if tca-nota-credito not = old-tca-nota-credito
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-nota è l'ID del campo chk-nota
              move 78-ID-chk-nota to store-id 
           end-if

           if tca-blocco-modeva not = old-tca-blocco-modeva
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-blocco è l'ID del campo chk-blocco
              move 78-ID-chk-blocco to store-id 
           end-if

           if tca-invio-utf-estero not = old-tca-invio-utf-estero
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-utf-estero è l'ID del campo chk-utf-estero
              move 78-ID-chk-utf-estero to store-id 
           end-if

           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           MOVE DataSet1-tcaumag-KEY1-ORDER TO TMP-Form1-KEY1-ORDER
           MOVE DataSet1-KEYIS TO TMP-Form1-KEYIS
           MOVE tca-rec OF tcaumag TO 
              TMP-Form1-tcaumag-RESTOREBUF
           .             

       Form1-Restore-Status.
           MOVE TMP-Form1-KEY1-ORDER TO DataSet1-tcaumag-KEY1-ORDER
           MOVE TMP-Form1-KEYIS TO DataSet1-KEYIS
           MOVE TMP-Form1-tcaumag-RESTOREBUF TO
              tca-rec OF tcaumag
           PERFORM DataSet1-tcaumag-START
           IF Valid-STATUS-tcaumag
              PERFORM DataSet1-tcaumag-Read-Next
           ELSE
              PERFORM DataSet1-tcaumag-INITREC
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-tcaumag OR
              (Valid-STATUS-tcaumag AND
                 tca-rec OF tcaumag = 
                   TMP-Form1-tcaumag-RESTOREBUF)
              PERFORM DataSet1-tcaumag-Read-Next
           END-PERFORM
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-contropartita è l'ID del campo ef-contropartita
           when 78-ID-ef-contropartita
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-codmag è l'ID del campo ef-codmag
           when 78-ID-ef-codmag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-codpag è l'ID del campo ef-codpag
           when 78-ID-ef-codpag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cod-edi è l'ID del campo ef-cod-edi
           when 78-ID-ef-cod-edi
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-contropartita è l'ID del campo ef-contropartita
           when 78-ID-ef-contropartita
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-codmag è l'ID del campo ef-codmag
           when 78-ID-ef-codmag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-codpag è l'ID del campo ef-codpag
           when 78-ID-ef-codpag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cod-edi è l'ID del campo ef-cod-edi
           when 78-ID-ef-cod-edi
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |78-ID-ef-codice è l'ID del campo ef-codice
           when 78-ID-ef-codice
                perform CONTROLLO
           |78-ID-ef-descr è l'ID del campo ef-descr
           when 78-ID-ef-descr
                perform CONTROLLO
           |78-ID-ef-tras è l'ID del campo ef-tras
           when 78-ID-ef-tras
                perform CONTROLLO
           |78-ID-ef-contropartita è l'ID del campo ef-contropartita
           when 78-ID-ef-contropartita
                perform CONTROLLO
           |78-ID-ef-codmag è l'ID del campo ef-codmag
           when 78-ID-ef-codmag
                perform CONTROLLO
           |78-ID-ef-codpag è l'ID del campo ef-codpag
           when 78-ID-ef-codpag
                perform CONTROLLO
           |78-ID-ef-cod-edi è l'ID del campo ef-cod-edi
           when 78-ID-ef-cod-edi
                perform CONTROLLO
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.



       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "Digitare il Codice" to TOTEM-HINT-TEXT
           WHEN 5002 MOVE "Digitare la Descrizione per la Causale" to 
           TOTEM-HINT-TEXT
           WHEN 5003 MOVE "Selezionare se Tipo Cliente" to 
           TOTEM-HINT-TEXT
           WHEN 5004 MOVE "Selezionare se Tipo Fornitore" to 
           TOTEM-HINT-TEXT
           WHEN 5005 MOVE "Aggiornamento Costo Ultimo" to 
           TOTEM-HINT-TEXT
           WHEN 5008 MOVE "Movimentazione positiva per Giacenza" to 
           TOTEM-HINT-TEXT
           WHEN 5009 MOVE "Movimentazione negativa per Giacenza" to 
           TOTEM-HINT-TEXT
           WHEN 5010 MOVE "Movimentazione positiva per Impegnato" to 
           TOTEM-HINT-TEXT
           WHEN 5011 MOVE "Movimentazione negativa per Impegnato" to 
           TOTEM-HINT-TEXT
           WHEN 5012 MOVE "Movimentazione positiva per Ordinato" to 
           TOTEM-HINT-TEXT
           WHEN 5013 MOVE "Movimentazione negativa per Ordinato" to 
           TOTEM-HINT-TEXT
           WHEN 5014 MOVE "Movimentazione positiva per Iniziale" to 
           TOTEM-HINT-TEXT
           WHEN 5015 MOVE "Movimentazione negativa per Iniziale" to 
           TOTEM-HINT-TEXT
           WHEN 5016 MOVE "Movimentazione positiva per Acquisti" to 
           TOTEM-HINT-TEXT
           WHEN 5017 MOVE "Movimentazione negativa per Acquisti" to 
           TOTEM-HINT-TEXT
           WHEN 5018 MOVE "Movimentazione positiva per Vendite" to 
           TOTEM-HINT-TEXT
           WHEN 5019 MOVE "Movimentazione negativa per Vendite" to 
           TOTEM-HINT-TEXT
           WHEN 5020 MOVE "Movimentazione positiva per Variaz. inventari
      -    "ali" to TOTEM-HINT-TEXT
           WHEN 5021 MOVE "Movimentazione negativa per Variaz. inventari
      -    "ali" to TOTEM-HINT-TEXT
           WHEN 5022 MOVE "Movimentazione positiva per Resi da fornitori
      -    "" to TOTEM-HINT-TEXT
           WHEN 5023 MOVE "Movimentazione negativa per Resi da fornitori
      -    "" to TOTEM-HINT-TEXT
           WHEN 5024 MOVE "Movimentazione positiva per Resi da Clienti" 
           to TOTEM-HINT-TEXT
           WHEN 5025 MOVE "Movimentazione negativa per Resi da Clienti" 
           to TOTEM-HINT-TEXT
           WHEN 5026 MOVE "Movimentazione positiva per Giacenza periodo"
            to TOTEM-HINT-TEXT
           WHEN 5027 MOVE "Movimentazione negativa per Giacenza periodo"
            to TOTEM-HINT-TEXT
           WHEN 5028 MOVE "Movimentazione positiva per le entrate di lav
      -    "orazione" to TOTEM-HINT-TEXT
           WHEN 5029 MOVE "Movimentazione negativa per le entrate di lav
      -    "orazione" to TOTEM-HINT-TEXT
           WHEN 5030 MOVE "Movimentazione positiva per le uscite di lavo
      -    "razione" to TOTEM-HINT-TEXT
           WHEN 5031 MOVE "Movimentazione negativa per le uscite di lavo
      -    "razione" to TOTEM-HINT-TEXT
           WHEN 5032 MOVE "Movimentazione positiva per le entrate di lav
      -    "orazione" to TOTEM-HINT-TEXT
           WHEN 5033 MOVE "Movimentazione negativa per le entrate di lav
      -    "orazione" to TOTEM-HINT-TEXT
           WHEN 5034 MOVE "Movimentazione positiva per le uscite di lavo
      -    "razione" to TOTEM-HINT-TEXT
           WHEN 5035 MOVE "Movimentazione negativa per le uscite di lavo
      -    "razione" to TOTEM-HINT-TEXT
           WHEN 36 MOVE "Movimentazione positiva per Giacenza Bloccata" 
           to TOTEM-HINT-TEXT
           WHEN 37 MOVE "Movimentazione negativa per Giacenza Bloccata" 
           to TOTEM-HINT-TEXT
           WHEN 5036 MOVE "Digitare la causale di trasporto" to 
           TOTEM-HINT-TEXT
           WHEN 5037 MOVE "Digitare la contropartita contabile" to 
           TOTEM-HINT-TEXT
           WHEN 5038 MOVE "Digitare il codice del magazzino" to 
           TOTEM-HINT-TEXT
           WHEN 5039 MOVE "Digitare il codice del pagamento" to 
           TOTEM-HINT-TEXT
           WHEN 5040 MOVE "Digitare la codice EDI per la causale" to 
           TOTEM-HINT-TEXT
           WHEN 5041 MOVE "Delibera la movimentazione del magazzino" to 
           TOTEM-HINT-TEXT
           WHEN 5042 MOVE "Delibera la stampa della bolla" to 
           TOTEM-HINT-TEXT
           WHEN 5043 MOVE "Delibera l'emissione della fattura" to 
           TOTEM-HINT-TEXT
           WHEN 5044 MOVE "Delibera la gestione UTF" to TOTEM-HINT-TEXT
           WHEN 5045 MOVE "Delibera il tipo di importo sui documenti" 
           to TOTEM-HINT-TEXT
           WHEN 48 MOVE "Delibera la gestione UTF" to TOTEM-HINT-TEXT
           WHEN 49 MOVE "Delibera il tipo di importo sui documenti" to 
           TOTEM-HINT-TEXT
           WHEN 50 MOVE "Delibera se è una causale ordine fornitore" to 
           TOTEM-HINT-TEXT
           WHEN 51 MOVE "Se settato il prezzo sarà il + alto tra i movma
      -    "g per quel fornitore degli ultimi 2 anni (EVASIONE)" to 
           TOTEM-HINT-TEXT
           WHEN 52 MOVE "Se settato blocca ordini con destini sprovvisti
      -    " di CAP (MASTER)" to TOTEM-HINT-TEXT
           WHEN 5046 MOVE "Se settato rientra nel riordino (consolidamen
      -    "to e ricalcolo totale)" to TOTEM-HINT-TEXT
           WHEN 5047 MOVE "Delibera il tipo di importo sui documenti" 
           to TOTEM-HINT-TEXT
           WHEN 5048 MOVE "Se settato indica che la causale è per nota c
      -    "redito" to TOTEM-HINT-TEXT
           WHEN 5049 MOVE "Se settato indica che le evasioni potranno es
      -    "sere modificate con password" to TOTEM-HINT-TEXT
           WHEN 5050 MOVE "Se settato conisdera i movimenti di magazzino
      -    " con fornitore estero  per l'invio telematico" to 
           TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5002 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5003 PERFORM Screen1-DaRb-1-BeforeProcedure
           When 5004 PERFORM Screen1-DaRb-1-BeforeProcedure
           When 5005 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5008 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5009 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5010 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5011 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5012 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5013 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5014 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5015 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5016 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5017 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5018 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5019 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5020 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5021 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5022 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5023 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5024 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5025 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5026 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5027 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5028 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5029 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5030 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5031 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5032 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5033 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5034 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5035 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 36 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 37 PERFORM Screen1-DaCb-1-BeforeProcedure
           When 5036 PERFORM ef-tras-BeforeProcedure
           When 5037 PERFORM ef-tras-BeforeProcedure
           When 5038 PERFORM ef-codmag-BeforeProcedure
           When 5039 PERFORM ef-codmag-BeforeProcedure
           When 5040 PERFORM ef-tras-BeforeProcedure
           When 5041 PERFORM chk-movim-BeforeProcedure
           When 5042 PERFORM chk-stbolla-BeforeProcedure
           When 5043 PERFORM chk-emifat-BeforeProcedure
           When 5044 PERFORM chk-utf-BeforeProcedure
           When 5045 PERFORM chk-autofat-BeforeProcedure
           When 48 PERFORM chk-trasporto-BeforeProcedure
           When 49 PERFORM chk-statistiche-BeforeProcedure
           When 50 PERFORM chk-statistiche-BeforeProcedure
           When 51 PERFORM chk-statistiche-BeforeProcedure
           When 52 PERFORM chk-statistiche-BeforeProcedure
           When 5046 PERFORM chk-statistiche-BeforeProcedure
           When 5047 PERFORM chk-statistiche-BeforeProcedure
           When 5048 PERFORM chk-statistiche-BeforeProcedure
           When 5049 PERFORM chk-statistiche-BeforeProcedure
           When 5050 PERFORM chk-statistiche-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Form1-AfterProcedure.
           EVALUATE Control-Id
           When 5001 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5002 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5003 PERFORM Screen1-DaRb-1-AfterProcedure
           When 5004 PERFORM Screen1-DaRb-1-AfterProcedure
           When 5005 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5006 PERFORM Screen1-DaRb-1-AfterProcedure
           When 5007 PERFORM Screen1-DaRb-2-AfterProcedure
           When 5008 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5009 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5010 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5011 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5012 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5013 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5014 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5015 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5016 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5017 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5018 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5019 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5020 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5021 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5022 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5023 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5024 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5025 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5026 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5027 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5028 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5029 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5030 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5031 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5032 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5033 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5034 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5035 PERFORM Screen1-DaCb-1-AfterProcedure
           When 36 PERFORM Screen1-DaCb-1-AfterProcedure
           When 37 PERFORM Screen1-DaCb-1-AfterProcedure
           When 5036 PERFORM ef-tras-AfterProcedure
           When 5037 PERFORM ef-tras-AfterProcedure
           When 5038 PERFORM ef-codmag-AfterProcedure
           When 5039 PERFORM ef-codmag-AfterProcedure
           When 5040 PERFORM ef-tras-AfterProcedure
           When 5041 PERFORM chk-movim-AfterProcedure
           When 5042 PERFORM chk-stbolla-AfterProcedure
           When 5043 PERFORM chk-emifat-AfterProcedure
           When 5044 PERFORM chk-utf-AfterProcedure
           When 5045 PERFORM chk-autofat-AfterProcedure
           When 48 PERFORM chk-trasporto-AfterProcedure
           When 49 PERFORM chk-statistiche-AfterProcedure
           When 50 PERFORM chk-statistiche-AfterProcedure
           When 51 PERFORM chk-statistiche-AfterProcedure
           When 52 PERFORM chk-statistiche-AfterProcedure
           When 5046 PERFORM chk-statistiche-AfterProcedure
           When 5047 PERFORM chk-statistiche-AfterProcedure
           When 5048 PERFORM chk-statistiche-AfterProcedure
           When 5049 PERFORM chk-statistiche-AfterProcedure
           When 5050 PERFORM chk-statistiche-AfterProcedure
           END-EVALUATE
           perform Form1-AFTER-SCREEN
           .

       Screen1-Event-Proc.
           .

      * USER DEFINE PARAGRAPH
       ABILITAZIONI.
      * <TOTEM:PARA. ABILITAZIONI>
           if mod = 1              
              move BitmapDeleteEnabled to BitmapNumDelete
              move BitmapSaveEnabled   to BitmapNumSave
              move 1 to e-salva e-cancella
           else           
              move BitmapDeleteDisabled to BitmapNumDelete
              move BitmapSaveDisabled   to BitmapNumSave
              move ZERO to e-salva e-cancella
           end-if.      

      * ISACCO (CORREZIONE SU LIVELLO ABILITAZIONE 2) - 10/11/2003
      * (CANCELLAZIONE NON PERMESSA)
           if livello-abil = 2 
              move ZERO to e-cancella
              move BitmapDeleteDisabled to BitmapNumDelete
           end-if.
      * FINE

           modify tool-cancella, enabled = e-cancella.
           modify tool-salva,    enabled = e-salva.
       
      * ISACCO (SERVE SEMPRE PER LA MODIFICA PRCEDENTE E PER RIPRISTINARE
      * LE BITMAP DISABILITATE. - 10/11/2003
      *     perform FORM1-DISPLAY.
           display tool-nuovo, tool-salva, tool-cancella, tool-modifica.
      * FINE 
           .
      * <TOTEM:END>

       ANTEPRIMA.
      * <TOTEM:PARA. ANTEPRIMA>
           continue 
           .
      * <TOTEM:END>

       CANCELLA.
      * <TOTEM:PARA. CANCELLA>
           if mod = ZERO
              exit paragraph 
           end-if.
      *
           display message box MSg-Cancellare-il-record-corrente
                   title   titolo
                   type    MB-YES-NO 
                   default MB-NO
                   giving  scelta

           if scelta = MB-YES
              perform RIEMPI-CHIAVE
              delete tcaumag record 
                 invalid 
                    continue 
              end-delete     
              move zero to mod
              move 1    to mod-k
              perform FORM1-CLEAR

              set vecchio to true
              
              perform CANCELLA-COLORE
              perform INIT-OLD-REC
              
              display message box 
           MSG-Cancellazione-avvenuta-con-successo
                      title titolo                         

              unlock tcaumag all records

              perform PRIMO 
              move 78-ID-ef-codice to  CONTROL-ID     
              move 4               to  ACCEPT-CONTROL 

              set Statusvisua to true
              perform STATUS-BAR-MSG
              modify TOOL-MODIFICA value mod
           end-if 
           .
      * <TOTEM:END>

       CERCA.
      * <TOTEM:PARA. CERCA>
           evaluate CONTROL-ID
           when 78-ID-EF-codice
                perform RIEMPI-CHIAVE
                move "tcaumag"      to Como-File
                call   "zoom-gt" using como-file, tca-rec
                                giving stato-zoom
                cancel "zoom-gt"
                if stato-zoom = ZERO
                   modify ef-codice, value tca-codice
                   move 4 to ACCEPT-CONTROL
                end-if
      
           when 78-ID-ef-codmag
                move "tmagaz"   to como-file         
                inquire ef-codmag, value in mag-codice
                call "zoom-gt"  using como-file, mag-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0 
                   modify ef-codmag, value mag-codice
                   move 4 to accept-control
                end-if
      
           when 78-ID-ef-codpag
                move "PA"        to tblpa-codice1
                move "tcodpag"   to como-file         
                inquire ef-codpag, value in tblpa-codice2
                call "zoom-gt"  using como-file, record-tblpa
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0 
                   modify ef-codpag, value tblpa-codice2
                   move 4 to accept-control
                end-if
      
           when 78-ID-ef-contropartita
                move "MAS"   to como-file         
                inquire ef-contropartita, value in mas-codice
                call "zoom-gt"  using como-file, record-mas
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0 
                   perform MOVE-DESCR-PIANO
                   modify ef-contropartita, value mas-codice
                   move 4 to accept-control
                   display lab-piano
                end-if

           end-evaluate  
           .
      * <TOTEM:END>

       CLEAR-SCREEN.
      * <TOTEM:PARA. CLEAR-SCREEN>
           move tca-chiave to old-tca-chiave.

           initialize tca-dati replacing numeric data by ZEROES
                                    alphanumeric data by SPACES.
                         
           perform FORM1-FLD-TO-BUF. 

           perform INIT-OLD-REC.
                                          
           display form1. 
  
           unlock tcaumag all records 
           .
      * <TOTEM:END>

       CHECK-INSERIMENTO.
      * <TOTEM:PARA. CHECK-INSERIMENTO>
      * MODIFICA LA STATUS-BAR
      * CONTROLLO SE DA INSERIMENTO SCORRO. ALLORA DEVO SEGNALARE CHE
      * SONO TORNATO IN MODIFICA.
           inquire tool-modifica, value in mod.

           evaluate mod
           when 1   set StatusModifica to true
           when 0   set StatusVisua    to true   
           end-evaluate.
      
           perform STATUS-BAR-MSG.

           evaluate control-id
           when 78-ID-rb-cli
           when 78-ID-rb-for
                evaluate true
                when tca-cliente   move 78-ID-rb-cli to control-id
                when tca-fornitore move 78-ID-rb-for to control-id
                end-evaluate
           when 78-ID-rb-si-imp
           when 78-ID-rb-no-imp
                evaluate true
                when tca-imponibile-pos move 78-ID-rb-si-imp to 
           control-id
                when tca-imponibile-neg move 78-ID-rb-si-imp to 
           control-id
                end-evaluate
           end-evaluate 
           .
      * <TOTEM:END>

       CONTROLLO.
      * <TOTEM:PARA. CONTROLLO>
           set tutto-ok to true.

           evaluate CONTROL-ID
           when 78-ID-ef-codice
                inquire ef-codice,   value ef-codice-buf
                if ef-codice-buf = SPACES
                   set errori to true
                   display message box MSG-Codice-obbligatorio
                           title tit-err
                           icon  MB-WARNING-ICON
                else
      * LETTURA DEL RECORD SE TUTTI I CONTROLLI SONO PASSATI OK
                   if tutto-ok
                         read tcaumag
                            invalid 
                               if vecchio
                                  display message  
           MSG-record-inesistente
                                         title = tit-err
                                         icon mb-warning-icon
                                  perform CLEAR-SCREEN
                                  set errori to true
                               end-if
                            not invalid      
                               if old-tca-chiave not = tca-chiave
                                  perform CURRENT-RECORD 
                                  set errori to true
                               end-if
                         end-read
                   end-if
               end-if

           when 78-ID-ef-descr
                inquire ef-descr value ef-descr-buf

                if ef-descr-buf = spaces
                   set errori to true
                   display message "Descrizione Obbligatoria!"
                          title = tit-err
                          icon mb-warning-icon
                end-if

           when 78-ID-ef-tras 
                inquire ef-tras value ef-tras-buf

                if ef-tras-buf = spaces
                   set errori to true
                   display message "Descrizione trasporto obbligatoria"
                          title = tit-err
                          icon mb-warning-icon
                end-if

           when 78-ID-ef-contropartita
                inquire ef-contropartita value ef-contropartita-buf
                inquire chk-emifat value chk-emifat-buf

                if ef-contropartita-buf = spaces
                   move spaces to lab-piano-buf
                   if chk-emifat-buf = 1
                      set errori to true
                      display message "Contropartita obbligatoria"
                             title = tit-err
                             icon mb-warning-icon
                   end-if
                else
                   move ef-contropartita-buf to mas-codice
                   read MAS no lock
                         invalid
                         set errori to true
                         display message "Contropartita NON valida!"
                                 title = tit-err
                                 icon mb-warning-icon
                         initialize record-mas
                   end-read
                   perform MOVE-DESCR-PIANO
                end-if
                display lab-piano
           
           when 78-ID-ef-codmag     
                inquire ef-codmag value ef-codmag-buf
                evaluate ef-codmag-buf 
                when spaces 
                     set errori to true
                     display message "Codice Magazzino Obbligatorio!"
                             title = tit-err
                             icon mb-warning-icon
                     move spaces to lab-mag-des-buf
                     display lab-mag-des
                when other
                     move spaces to mag-descrizione
                     move ef-codmag-buf to mag-codice
                     read tmagaz no lock
                          invalid
                             set errori to true
                             display message "Codice Magazzino NON valid
      -    "o!"
                                     title = tit-err
                                     icon mb-warning-icon
                     end-read
                     move mag-descrizione to lab-mag-des-buf
                     display lab-mag-des

                end-evaluate   
           
           when 78-ID-ef-codpag     
                inquire ef-codpag value ef-codpag-buf
                evaluate ef-codpag-buf 
                when spaces 
                     move spaces to lab-pag-des-buf
                     display lab-pag-des
                when other
                     move spaces to tblpa-descrizione1
                     move "PA"          to tblpa-codice1
                     move ef-codpag-buf to tblpa-codice2
                     read tcodpag no lock
                          invalid
                             set errori to true
                             display message "Codice Pagamento NON valid
      -    "o!"
                                     title = tit-err
                                     icon mb-warning-icon
                     end-read
                     move tblpa-descrizione1 to lab-pag-des-buf
                     display lab-pag-des

                end-evaluate

           end-evaluate.
      
           if errori
              perform CANCELLA-COLORE
              move CONTROL-ID to store-id
              move 4          to ACCEPT-CONTROL
           end-if 
           .
      * <TOTEM:END>

       CURRENT-RECORD.
      * <TOTEM:PARA. CURRENT-RECORD>
           perform RIEMPI-CHIAVE.
           set tutto-ok  to true.
           set ReadSecca to true.

           if mod = 1
              read tcaumag    lock invalid 
                 set errori to true 
              end-read
           else
              read tcaumag no lock invalid 
                 set errori to true 
              end-read
           end-if.                    

           set ReadSecca to false.

           if RecLocked
              set RecLocked to false
           else
              if tutto-ok    
                 if nuovo
                    move ZERO      to mod
                    move 1         to mod-k
                    move 78-ID-ef-codice to CONTROL-ID
                    move 4         to ACCEPT-CONTROL
                 end-if   
                 perform FORM1-IUD-DISPLAY
                 set vecchio to true
                 if mod = 1
                    set StatusModifica to true
                 else                         
                    set StatusVisua    to true
                 end-if
                 perform STATUS-BAR-MSG
                 perform VALORIZZA-OLD
              else
                 move ZERO to mod
                 move 1    to mod-k
                 if vecchio
                    perform CLEAR-SCREEN
                    if YesMessage
                       move 78-ID-ef-codice to CONTROL-ID
                       move 4         to ACCEPT-CONTROL
                       display message box MSG-Record-inesistente
                               title = tit-err
                               icon MB-WARNING-ICON
                    end-if
                 end-if
              end-if
           end-if 
           .
      * <TOTEM:END>

       INIT.
      * <TOTEM:PARA. INIT>
           move ZERO to StatusHelp.
           move 1    to mod-k.
           set StatusVisua to true.     
           set errore-des  to false.

           move 1 to Form1-RADIO-1-BUF.
           display   rb-cli 
           .
      * <TOTEM:END>

       INIT-OLD-REC.
      * <TOTEM:PARA. INIT-OLD-REC>
           initialize old-tca-rec replacing numeric data by zeroes
                                       alphanumeric data by spaces.

           set old-tca-cliente        to true.
           set old-tca-imponibile-pos to true.

           set old-tca-no-aggiorna    to true.

           set OLD-tca-no-movim       to true.
           set OLD-tca-no-stampa      to true.
           set OLD-tca-no-emissione   to true.
           set OLD-tca-no-utf         to true.
           set OLD-tca-no-zero        to true.
           set OLD-tca-no-tras        to true.
           set OLD-tca-no-stat        to true.
           set OLD-tca-no-speciale    to true.
      * FINE
           .
      * <TOTEM:END>

       MODIFICA.
      * <TOTEM:PARA. MODIFICA>
           move 5 to key-status.
           inquire tool-modifica, value in mod.
           set tutto-ok to true.

           if nuovo
              move 1 to mod                  
              modify tool-modifica, value mod
           else
      *  SE L'UTENTE E' ABILITATO PUO' MODIFICARE UN RECORD
              if mod = 1
                 set YesMessage to true
                 perform CURRENT-RECORD
                 if tutto-ok
                    if CONTROL-ID < 78-ID-ef-descr
                       move 78-ID-ef-descr to CONTROL-ID
                    end-if
                    move ZERO to mod-k
                    move 1    to mod
                    set StatusModifica to true
                    perform STATUS-BAR-MSG
                 end-if
              else
                 move 1    to mod
                 perform SALV-MOD            
                 move ZERO to mod
                 move 1    to mod-k
                 if errori
                    move 1    to mod
                    move ZERO to mod-k
                 else
                    move 78-ID-ef-codice to CONTROL-ID
                    set NoMessage to true
                    perform CURRENT-RECORD
                    set StatusVisua to true
                    perform STATUS-BAR-MSG 
                    unlock tcaumag all records
                 end-if
              end-if
                        
              display form1

              modify tool-modifica,  value mod
              perform CANCELLA-COLORE 

              move 4 to ACCEPT-CONTROL
           end-if 
           .
      * <TOTEM:END>

       MOVE-DESCR-PIANO.
      * <TOTEM:PARA. MOVE-DESCR-PIANO>
           initialize lab-piano-buf.
           inspect mas-descrizione1 replacing trailing spaces 
                                                    by low-value.
           string mas-descrizione1 delimited by low-value
                  " "              delimited by size
                  mas-descrizione2 delimited by size
                  into lab-piano-buf
           end-string 
           .
      * <TOTEM:END>

       NUOVO.
      * <TOTEM:PARA. NUOVO>
           perform SALV-MOD.

           if tutto-ok  
              move 78-ID-ef-codice to CONTROL-ID       
              move 4         to ACCEPT-CONTROL   
              move 1         to mod, mod-k
              modify tool-modifica,  value = mod
              perform CANCELLA-COLORE                  
              perform VALORIZZA-NUOVO
              perform INIT-OLD-REC       
              set StatusIns to true
              perform STATUS-BAR-MSG  
              set nuovo to true       
              unlock tcaumag all records
           end-if 
           .
      * <TOTEM:END>

       ORDINAMENTO.
      * <TOTEM:PARA. ORDINAMENTO>
      *     inquire tool-ord, value in OrderBy.
      *
      *     if OrderBy = zero
      *        perform DataSet1-CHANGETO-KEY1
      *     else
      *        perform DataSet1-CHANGETO-KEY2
      *     end-if.
      *
      *     perform CURRENT-RECORD 
           .
      * <TOTEM:END>

       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "abilita-toolbar.cpy".
           copy "color-custom.cpy".
           copy "status.cpy" 
           .
      * <TOTEM:END>

       PRECEDENTE.
      * <TOTEM:PARA. PRECEDENTE>
           perform SALV-MOD.           
           if tutto-ok

              unlock tcaumag all records

              if mod = 1
                 move ZERO to mod-k
                 set dataset1-tcaumag-lock to true
              else              
                 move 1    to mod-k     
                 initialize dataset1-tcaumag-lock-flag
              end-if
                    
              perform CANCELLA-COLORE
              perform FORM1-PREVIOUS

              if RecLocked
                 set RecLocked to false             
                 initialize dataset1-tcaumag-lock-flag
                 move 1 to mod-k
                 perform FORM1-PREVIOUS
              end-if
              perform CHECK-INSERIMENTO
           end-if 
           .
      * <TOTEM:END>

       PRIMO.
      * <TOTEM:PARA. PRIMO>
           perform SALV-MOD.           
           if tutto-ok    
                     
              unlock tcaumag all records

              if mod = 1
                 move ZERO to mod-k
                 set dataset1-tcaumag-lock to true
              else              
                 move 1    to mod-k     
                 initialize dataset1-tcaumag-lock-flag
              end-if
                                  
              perform CANCELLA-COLORE
              perform FORM1-FIRST

              if RecLocked
                 set RecLocked to false             
                 initialize dataset1-tcaumag-lock-flag
                 move 1 to mod-k
                 perform FORM1-FIRST
              end-if
              perform CHECK-INSERIMENTO
           end-if 

           .
      * <TOTEM:END>

       RIEMPI-CHIAVE.
      * <TOTEM:PARA. RIEMPI-CHIAVE>
           inquire ef-codice, value in ef-codice-buf.
           move ef-codice-buf       to tca-codice 
           .
      * <TOTEM:END>

       SALVA.
      * <TOTEM:PARA. SALVA>
           if mod = ZERO 
              exit paragraph 
           end-if.

           set tutto-ok to true.

           perform varying CONTROL-ID from 78-ID-ef-codice by 1
                     until CONTROL-ID > 78-ID-ef-codmag
              perform CONTROLLO
              if errori 
                 exit perform 
              end-if
           end-perform.

           if errori
              perform ABILITAZIONI
              move store-id to CONTROL-ID       
              move 4        to ACCEPT-CONTROL   
           else                       
              perform FORM1-BUF-TO-FLD
              perform VALORIZZA-DATI-COMUNI
              perform CANCELLA-COLORE 

              write tca-rec 
                 invalid 
                    rewrite tca-rec
              end-write
      
              set vecchio to true       
              perform TORNA-IN-VISUA
           end-if.   
                 
           display form1 
           .
      * <TOTEM:END>

       SALV-MOD.
      * <TOTEM:PARA. SALV-MOD>
           set tutto-ok to true.
           perform FORM1-CONTROLLO-OLD.

           if NoSalvato
              display message box MSG-Salvare-le-modifiche
                            title titolo
                            type MB-YES-NO-CANCEL 
                            giving scelta       
       
              evaluate scelta
              when MB-YES perform SALVA
              when MB-NO  continue
              when other                
                   perform CANCELLA-COLORE
                   set errori to true
                   evaluate store-id
                   when 78-ID-rb-cli
                        if form1-radio-1-buf = 2
                           move 78-ID-rb-for to store-id
                        end-if
                   when 78-ID-rb-si-imp
                        if form1-radio-2-buf = 2
                           move 78-ID-rb-no-imp to store-id
                        end-if
                   end-evaluate
                   move store-id to CONTROL-ID       
                   move 4        to ACCEPT-CONTROL   
              end-evaluate
           end-if 
           .
      * <TOTEM:END>

       SELEZIONA.
      * <TOTEM:PARA. SELEZIONA>
           perform RIEMPI-CHIAVE.

           move "tcaumag" to    como-file.
           call "zoom-gt" using como-file, tca-rec
                          giving stato-zoom.
           cancel "zoom-gt".
           if stato-zoom = ZERO
              if old-tca-chiave not = tca-chiave
                 move tca-chiave to save-key
                 perform SALV-MOD
                 if tutto-ok
                    move save-key to tca-chiave
                    set ReadSecca to true
                    modify ef-codice, value tca-codice
                    perform CURRENT-RECORD
                    perform CANCELLA-COLORE
                    move 78-ID-ef-descr to CONTROL-ID       
                    move 4              to ACCEPT-CONTROL   
                 end-if                                  
              end-if
           end-if 
           .
      * <TOTEM:END>

       SUCCESSIVO.
      * <TOTEM:PARA. SUCCESSIVO>
           perform SALV-MOD.
           if tutto-ok

              unlock tcaumag all records

              if mod = 1
                 move ZERO to mod-k
                 set dataset1-tcaumag-lock to true
              else              
                 move 1    to mod-k     
                 initialize dataset1-tcaumag-lock-flag
              end-if
                                     
              perform CANCELLA-COLORE
              perform FORM1-NEXT
 
              if RecLocked
                 set RecLocked to false             
                 initialize dataset1-tcaumag-lock-flag
                 move 1 to mod-k
                 perform FORM1-NEXT
              end-if
              perform CHECK-INSERIMENTO
           end-if 
           .
      * <TOTEM:END>

       STAMPA.
      * <TOTEM:PARA. STAMPA>
           continue 
           .
      * <TOTEM:END>

       TORNA-IN-VISUA.
      * <TOTEM:PARA. TORNA-IN-VISUA>
           move 0 to mod.
           move 1 to mod-k.
           move 78-ID-ef-codice to CONTROL-ID.
           set NoMessage to true.
           perform ABILITAZIONI.
           set StatusVisua to true.
           perform STATUS-BAR-MSG.
           unlock tcaumag all records.
                        
           modify tool-modifica,  value mod.
           perform CANCELLA-COLORE.
           move 4 to ACCEPT-CONTROL 
           .
      * <TOTEM:END>

       ULTIMO.
      * <TOTEM:PARA. ULTIMO>
           perform SALV-MOD.
           if tutto-ok

              unlock tcaumag all records 

              if mod = 1
                 move ZERO to mod-k
                 set dataset1-tcaumag-lock to true
              else              
                 move 1    to mod-k     
                 initialize dataset1-tcaumag-lock-flag
              end-if
                               
              perform CANCELLA-COLORE
              perform FORM1-LAST 
 
              if RecLocked
                 set RecLocked to false             
                 initialize dataset1-tcaumag-lock-flag
                 move 1 to mod-k
                 perform FORM1-LAST
              end-if 
              perform CHECK-INSERIMENTO
           end-if 
           .
      * <TOTEM:END>

       VALORIZZA-OLD.
      * <TOTEM:PARA. VALORIZZA-OLD>
           move tca-rec to old-tca-rec.
           set vecchio to true.

           move ZERO to StatusHelp
           perform STATUS-HELP 
           .
      * <TOTEM:END>

       VALORIZZA-NUOVO.
      * <TOTEM:PARA. VALORIZZA-NUOVO>
           move "00"    to status-tcaumag.

           initialize tca-rec  replacing numeric data by zeroes
                                    alphanumeric data by spaces.
                                       
           perform FORM1-IUD-DISPLAY.

           move 1 to Form1-RADIO-1-BUF Form1-RADIO-2-BUF.
           display   rb-cli rb-si-imp 
           .
      * <TOTEM:END>

       VALORIZZA-DATI-COMUNI.
      * <TOTEM:PARA. VALORIZZA-DATI-COMUNI>
      * SE NON HO VALORIZZATO I CAMPI DI CREAZIONE LI VALORIZZO
           if tca-data-creazione   = zero
              accept tca-data-creazione from century-date
           end-if.
           if tca-ora-creazione    = zero
              accept tca-ora-creazione  from time
           end-if.
           if tca-utente-creazione = space
              move user-codi to tca-utente-creazione
           end-if.

           accept tca-data-ultima-modifica from century-date.
           accept tca-ora-ultima-modifica  from time.
           move user-codi    to tca-utente-ultima-modifica 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       NUOVO-LinkTo.
      * <TOTEM:PARA. NUOVO-LinkTo>
           INQUIRE TOOL-NUOVO, ENABLED IN E-NUOVO.

           IF E-NUOVO = 1
              PERFORM NUOVO
           END-IF                    
           .
      * <TOTEM:END>
       CANCELLA-LinkTo.
      * <TOTEM:PARA. CANCELLA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD.
                              
           INQUIRE TOOL-CANCELLA, ENABLED IN E-CANCELLA
           IF E-CANCELLA = 1
              PERFORM CANCELLA
           END-IF                                                
           .
      * <TOTEM:END>
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD           

           INQUIRE TOOL-SALVA, ENABLED IN E-SALVA
           IF E-SALVA = 1
              PERFORM SALVA
           END-IF           
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
           INQUIRE TOOL-ANTEPRIMA, ENABLED IN E-ANTEPRIMA.
           IF E-ANTEPRIMA = 1
                PERFORM ANTEPRIMA
           END-IF 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
           INQUIRE TOOL-MODIFICA, ENABLED IN E-MODIFICA.

           IF E-MODIFICA = 1
              PERFORM MODIFICA
           END-IF 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
           INQUIRE TOOL-STAMPA, ENABLED IN E-STAMPA
           IF E-STAMPA = 1
                PERFORM STAMPA
           END-IF 
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca
           if e-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       TOOL-SELEZIONA-LinkTo.
      * <TOTEM:PARA. TOOL-SELEZIONA-LinkTo>
           inquire tool-seleziona, enabled in e-seleziona
           if e-seleziona = 1
              perform SELEZIONA
           end-if 
           .
      * <TOTEM:END>
       TOOL-PRIMO.
      * <TOTEM:PARA. TOOL-PRIMO>
           PERFORM PRIMO 
           .
      * <TOTEM:END>
       TOOL-PRECEDENTE.
      * <TOTEM:PARA. TOOL-PRECEDENTE>
           if nuovo             
              perform PRIMO
           else
              perform PRECEDENTE
           end-if 
           .
      * <TOTEM:END>
       TOOL-SUCCESSIVO.
      * <TOTEM:PARA. TOOL-SUCCESSIVO>
           if nuovo             
              perform ULTIMO
           else
              perform SUCCESSIVO
           end-if 
           .
      * <TOTEM:END>
       TOOL-ULTIMO.
      * <TOTEM:PARA. TOOL-ULTIMO>
           PERFORM ULTIMO 
           .
      * <TOTEM:END>
       ginqui-Ev-Before-Program.
      * <TOTEM:PARA. ginqui-Ev-Before-Program>
           move LK-BL-PROG-ID    TO COMO-PROG-ID 
           .
      * <TOTEM:END>
       ginqui-Ev-After-Program.
      * <TOTEM:PARA. ginqui-Ev-After-Program>
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM 
           .
      * <TOTEM:END>
       TOOL-ORD-LinkTo.
      * <TOTEM:PARA. TOOL-ORD-LinkTo>
           perform ORDINAMENTO 
           .
      * <TOTEM:END>
       TOOL-ORD-BeforeProcedure.
      * <TOTEM:PARA. TOOL-ORD-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-ORD-AfterProcedure.
      * <TOTEM:PARA. TOOL-ORD-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       Screen1-DaRb-1-AfterProcedure.
      * <TOTEM:PARA. Screen1-DaRb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       Screen1-DaRb-1-BeforeProcedure.
      * <TOTEM:PARA. Screen1-DaRb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Screen1-DaEf-1-BeforeProcedure.
      * <TOTEM:PARA. Screen1-DaEf-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Screen1-DaEf-1-AfterProcedure.
      * <TOTEM:PARA. Screen1-DaEf-1-AfterProcedure>
              INQUIRE ef-codice, VALUE IN tca-codice
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codice-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-descr, VALUE IN tca-descrizione
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-descr-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Screen1-DaCb-1-BeforeProcedure.
      * <TOTEM:PARA. Screen1-DaCb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Screen1-DaCb-1-AfterProcedure.
      * <TOTEM:PARA. Screen1-DaCb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-giac-pos-LinkTo.
      * <TOTEM:PARA. chk-giac-pos-LinkTo>
           inquire chk-giac-pos,
                   value chk-giac-pos-buf.

           if chk-giac-pos-buf = 1
              move ZERO to chk-giac-neg-buf
              perform CANCELLA-COLORE
              display chk-giac-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-giac-neg-LinkTo.
      * <TOTEM:PARA. chk-giac-neg-LinkTo>
           inquire chk-giac-neg,
                   value chk-giac-neg-buf.

           if chk-giac-neg-buf = 1
              move ZERO to chk-giac-pos-buf
              perform CANCELLA-COLORE
              display chk-giac-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-imp-pos-LinkTo.
      * <TOTEM:PARA. chk-imp-pos-LinkTo>
           inquire chk-imp-pos,
                   value chk-imp-pos-buf.

           if chk-imp-pos-buf = 1
              move ZERO to chk-imp-neg-buf
              perform CANCELLA-COLORE
              display chk-imp-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-imp-neg-LinkTo.
      * <TOTEM:PARA. chk-imp-neg-LinkTo>
           inquire chk-imp-neg,
                   value chk-imp-neg-buf.

           if chk-imp-neg-buf = 1
              move ZERO to chk-imp-pos-buf
              perform CANCELLA-COLORE
              display chk-imp-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-ord-pos-LinkTo.
      * <TOTEM:PARA. chk-ord-pos-LinkTo>
           inquire chk-ord-pos,
                   value chk-ord-pos-buf.

           if chk-ord-pos-buf = 1
              move ZERO to chk-ord-neg-buf
              perform CANCELLA-COLORE
              display chk-ord-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-ord-neg-LinkTo.
      * <TOTEM:PARA. chk-ord-neg-LinkTo>
           inquire chk-ord-neg,
                   value chk-ord-neg-buf.

           if chk-ord-neg-buf = 1
              move ZERO to chk-ord-pos-buf
              perform CANCELLA-COLORE
              display chk-ord-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-iniz-pos-LinkTo.
      * <TOTEM:PARA. chk-iniz-pos-LinkTo>
           inquire chk-iniz-pos,
                   value chk-iniz-pos-buf.

           if chk-iniz-pos-buf = 1
              move ZERO to chk-iniz-neg-buf
              perform CANCELLA-COLORE
              display chk-iniz-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-iniz-neg-LinkTo.
      * <TOTEM:PARA. chk-iniz-neg-LinkTo>
           inquire chk-iniz-neg,
                   value chk-iniz-neg-buf.

           if chk-iniz-neg-buf = 1
              move ZERO to chk-iniz-pos-buf
              perform CANCELLA-COLORE
              display chk-iniz-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-acq-pos-LinkTo.
      * <TOTEM:PARA. chk-acq-pos-LinkTo>
           inquire chk-acq-pos,
                   value chk-acq-pos-buf.

           if chk-acq-pos-buf = 1
              move ZERO to chk-acq-neg-buf
              perform CANCELLA-COLORE
              display chk-acq-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-acq-neg-LinkTo.
      * <TOTEM:PARA. chk-acq-neg-LinkTo>
           inquire chk-acq-neg,
                   value chk-acq-neg-buf.

           if chk-acq-neg-buf = 1
              move ZERO to chk-acq-pos-buf
              perform CANCELLA-COLORE
              display chk-acq-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-ven-pos-LinkTo.
      * <TOTEM:PARA. chk-ven-pos-LinkTo>
           inquire chk-ven-pos,
                   value chk-ven-pos-buf.

           if chk-ven-pos-buf = 1
              move ZERO to chk-ven-neg-buf
              perform CANCELLA-COLORE
              display chk-ven-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-ven-neg-LinkTo.
      * <TOTEM:PARA. chk-ven-neg-LinkTo>
           inquire chk-ven-neg,
                   value chk-ven-neg-buf.

           if chk-ven-neg-buf = 1
              move ZERO to chk-ven-pos-buf
              perform CANCELLA-COLORE
              display chk-ven-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-var-pos-LinkTo.
      * <TOTEM:PARA. chk-var-pos-LinkTo>
           inquire chk-var-pos,
                   value chk-var-pos-buf.

           if chk-var-pos-buf = 1
              move ZERO to chk-var-neg-buf
              perform CANCELLA-COLORE
              display chk-var-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-var-neg-LinkTo.
      * <TOTEM:PARA. chk-var-neg-LinkTo>
           inquire chk-var-neg,
                   value chk-var-neg-buf.

           if chk-var-neg-buf = 1
              move ZERO to chk-var-pos-buf

              perform CANCELLA-COLORE
              display chk-var-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-resi-for-pos-LinkTo.
      * <TOTEM:PARA. chk-resi-for-pos-LinkTo>
           inquire chk-resi-for-pos,
                   value chk-resi-for-pos-buf.

           if chk-resi-for-pos-buf = 1
              move ZERO to chk-resi-for-neg-buf
              perform CANCELLA-COLORE
              display chk-resi-for-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-resi-for-neg-LinkTo.
      * <TOTEM:PARA. chk-resi-for-neg-LinkTo>
           inquire chk-resi-for-neg,
                   value chk-resi-for-neg-buf.

           if chk-resi-for-neg-buf = 1
              move ZERO to chk-resi-for-pos-buf
              perform CANCELLA-COLORE
              display chk-resi-for-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-resi-cli-pos-LinkTo.
      * <TOTEM:PARA. chk-resi-cli-pos-LinkTo>
           inquire chk-resi-cli-pos,
                   value chk-resi-cli-pos-buf.

           if chk-resi-cli-pos-buf = 1
              move ZERO to chk-resi-cli-neg-buf
              perform CANCELLA-COLORE
              display chk-resi-cli-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-resi-cli-neg-LinkTo.
      * <TOTEM:PARA. chk-resi-cli-neg-LinkTo>
           inquire chk-resi-cli-neg,
                   value chk-resi-cli-neg-buf.

           if chk-resi-cli-neg-buf = 1
              move ZERO to chk-resi-cli-pos-buf
              perform CANCELLA-COLORE
              display chk-resi-cli-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-giac-per-pos-LinkTo.
      * <TOTEM:PARA. chk-giac-per-pos-LinkTo>
           inquire chk-giac-per-pos,
                   value chk-giac-per-pos-buf.

           if chk-giac-per-pos-buf = 1
              move 0 to chk-giac-per-neg-buf
              perform CANCELLA-COLORE
              display chk-giac-per-neg
           end-if 
             
             
           .
      * <TOTEM:END>
       chk-giac-per-neg-LinkTo.
      * <TOTEM:PARA. chk-giac-per-neg-LinkTo>
           inquire chk-giac-per-neg,
                   value chk-giac-per-neg-buf.

           if chk-giac-per-neg-buf = 1
              move 0 to chk-giac-per-pos-buf
              perform CANCELLA-COLORE
              display chk-giac-per-pos
           end-if 
             
           .
      * <TOTEM:END>
       Screen1-DaRb-2-BeforeProcedure.
      * <TOTEM:PARA. Screen1-DaRb-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Screen1-DaRb-2-AfterProcedure.
      * <TOTEM:PARA. Screen1-DaRb-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-tras-BeforeProcedure.
      * <TOTEM:PARA. ef-tras-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-codmag-BeforeProcedure.
      * <TOTEM:PARA. ef-codmag-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-tras-AfterProcedure.
      * <TOTEM:PARA. ef-tras-AfterProcedure>
              INQUIRE ef-tras, VALUE IN tca-caus-trasporto
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-tras-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-contropartita, VALUE IN tca-contropartita
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-contropartita-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cod-edi, VALUE IN tca-causale-EDI
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cod-edi-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-codmag-AfterProcedure.
      * <TOTEM:PARA. ef-codmag-AfterProcedure>
              INQUIRE ef-codmag, VALUE IN tca-cod-magaz
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codmag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-codpag, VALUE IN tca-cod-pagamento
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codpag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       chk-movim-BeforeProcedure.
      * <TOTEM:PARA. chk-movim-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-stbolla-BeforeProcedure.
      * <TOTEM:PARA. chk-stbolla-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-emifat-BeforeProcedure.
      * <TOTEM:PARA. chk-emifat-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-utf-BeforeProcedure.
      * <TOTEM:PARA. chk-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-autofat-BeforeProcedure.
      * <TOTEM:PARA. chk-autofat-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-movim-AfterProcedure.
      * <TOTEM:PARA. chk-movim-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-stbolla-AfterProcedure.
      * <TOTEM:PARA. chk-stbolla-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-emifat-AfterProcedure.
      * <TOTEM:PARA. chk-emifat-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-utf-AfterProcedure.
      * <TOTEM:PARA. chk-utf-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-autofat-AfterProcedure.
      * <TOTEM:PARA. chk-autofat-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-trasporto-BeforeProcedure.
      * <TOTEM:PARA. chk-trasporto-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-statistiche-BeforeProcedure.
      * <TOTEM:PARA. chk-statistiche-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-trasporto-AfterProcedure.
      * <TOTEM:PARA. chk-trasporto-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-statistiche-AfterProcedure.
      * <TOTEM:PARA. chk-statistiche-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-ul-pos2-LinkTo.
      * <TOTEM:PARA. chk-ul-pos2-LinkTo>
           inquire chk-ul-pos2,
                   value chk-ul-pos2-buf.

           if chk-ul-pos2-buf = 1
              move 0 to chk-ul-neg2-buf
              perform CANCELLA-COLORE
              display chk-ul-neg2
           end-if 
           .
      * <TOTEM:END>
       chk-el-pos-LinkTo.
      * <TOTEM:PARA. chk-el-pos-LinkTo>
           inquire chk-el-pos,
                   value chk-el-pos-buf.

           if chk-el-pos-buf = 1
              move 0 to chk-el-neg-buf
              perform CANCELLA-COLORE
              display chk-el-neg
           end-if 
           .
      * <TOTEM:END>
       chk-el-neg-LinkTo.
      * <TOTEM:PARA. chk-el-neg-LinkTo>
           inquire chk-el-neg, value chk-el-neg-buf.

           if chk-el-neg-buf = 1
              move 0 to chk-el-pos-buf
              perform CANCELLA-COLORE
              display chk-el-pos
           end-if 
             
           .
      * <TOTEM:END>
       chk-ul-pos-LinkTo.
      * <TOTEM:PARA. chk-ul-pos-LinkTo>
           inquire chk-ul-pos,
                   value chk-ul-pos-buf.

           if chk-ul-pos-buf = 1
              move 0 to chk-ul-neg-buf
              perform CANCELLA-COLORE
              display chk-ul-neg
           end-if 
           .
      * <TOTEM:END>
       chk-ul-neg-LinkTo.
      * <TOTEM:PARA. chk-ul-neg-LinkTo>
           inquire chk-ul-neg,
                   value chk-ul-neg-buf.

           if chk-ul-neg-buf = 1
              move 0 to chk-ul-pos-buf
              perform CANCELLA-COLORE
              display chk-ul-pos
           end-if 
           .
      * <TOTEM:END>
       chk-el-neg2-LinkTo.
      * <TOTEM:PARA. chk-el-neg2-LinkTo>
           inquire chk-el-neg2,
                   value chk-el-neg2-buf.

           if chk-el-neg2-buf = 1
              move 0 to chk-el-pos2-buf
              perform CANCELLA-COLORE
              display chk-el-pos2
           end-if 
           .
      * <TOTEM:END>
       chk-el-pos2-LinkTo.
      * <TOTEM:PARA. chk-el-pos2-LinkTo>
           inquire chk-el-pos2,
                   value chk-el-pos2-buf.

           if chk-el-pos2-buf = 1
              move 0 to chk-el-neg2-buf
              perform CANCELLA-COLORE
              display chk-el-neg2
           end-if 
           .
      * <TOTEM:END>
       chk-ul-neg2-LinkTo.
      * <TOTEM:PARA. chk-ul-neg2-LinkTo>
           inquire chk-ul-neg2,
                   value chk-ul-neg2-buf.

           if chk-ul-neg2-buf = 1
              move 0 to chk-ul-pos2-buf
              perform CANCELLA-COLORE
              display chk-ul-pos2
           end-if 
           .
      * <TOTEM:END>
       chk-bloc-pos-LinkTo.
      * <TOTEM:PARA. chk-bloc-pos-LinkTo>
           inquire chk-bloc-pos,
                   value chk-bloc-pos-buf.

           if chk-bloc-pos-buf = 1
              move 0 to chk-bloc-neg-buf
              perform CANCELLA-COLORE
              display chk-bloc-neg
           end-if 
             
           .
      * <TOTEM:END>
       chk-bloc-neg-LinkTo.
      * <TOTEM:PARA. chk-bloc-neg-LinkTo>
           inquire chk-bloc-neg,
                   value chk-bloc-neg-buf.

           if chk-bloc-neg-buf = 1
              move 0 to chk-bloc-pos-buf
              perform CANCELLA-COLORE
              display chk-bloc-pos
           end-if 
           .
      * <TOTEM:END>
       Screen1-Cm-1-BeforeProcedure.
      * <TOTEM:PARA. Screen1-Cm-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Screen1-Cm-1-AfterProcedure.
      * <TOTEM:PARA. Screen1-Cm-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-nota-LinkTo.
      * <TOTEM:PARA. chk-nota-LinkTo>
           move chk-nota-buf to v-nota.
           display cbo-nota 
           .
      * <TOTEM:END>

      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

