      *{TOTEM}PRG-COMMENT
      * insarticoli.Cbl
      * insarticoli.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          insarticoli.
       AUTHOR.              ANDREA EVENTI.
       DATE-WRITTEN.        lunedì 2 dicembre 2013 18:23:00.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:insarticoli, INIT:insarticoli, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "TIVAESE.sl".
           COPY "tmarche.sl".
           COPY "timballi.sl".
           COPY "progmag.sl".
           COPY "tnomen.sl".
           COPY "tcla1art.sl".
           COPY "tsetmerc.sl".
           COPY "articoli.sl".
           COPY "tudm.sl".
           COPY "tparamge.sl".
           COPY "timbalqta.sl".
           COPY "clienti.sl".
           COPY "tmagaz.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "TIVAESE.fd".
           COPY "tmarche.fd".
           COPY "timballi.fd".
           COPY "progmag.fd".
           COPY "tnomen.fd".
           COPY "tcla1art.fd".
           COPY "tsetmerc.fd".
           COPY "articoli.fd".
           COPY "tudm.fd".
           COPY "tparamge.fd".
           COPY "timbalqta.fd".
           COPY "clienti.fd".
           COPY "tmagaz.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "crtvars.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "comune.def".
               COPY "utydata.def".
               COPY "custom.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
      * Properties & User defined Working Stoarge
           COPY  "LINK-WPROGMAG.DEF".
           COPY  "COMBO-COBAT.DEF".
           COPY  "COMBO-UTF.DEF".
           COPY  "LINK-BROWSER.DEF".
       77 StatusPass       PIC  9.
           88 StatusOk VALUE IS 1    WHEN SET TO FALSE  0. 
       77 codice-ed        PIC  z(6).
       77 Form1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 CodiceIvaStd     PIC  x(3).
       77 codice-x         PIC  x(6).
       77 qta-x            PIC  z(4).
       77 nome-file        PIC  x(10).
       77 old-peso         PIC  9(10)v999.
       77 peso PIC  9(10)v999.
       77 countchar        PIC  9(3).
       77 pagina           PIC  9
                  VALUE IS 1.
       01 save-art-k1.
           05 save-descrizione-K1          PIC  x(50).
       78 MAX-PAGE VALUE IS 3. 
       01 TabID
                  OCCURS MAX-PAGE TIMES.
           05 min-id           PIC  9(9).
           05 max-id           PIC  9(9).
       77 OPENSAVE-STATUS  PIC  S9(2)
                  VALUE IS 0.
       77 result
                  USAGE IS SIGNED-SHORT.
       77 counter          PIC  9(3).
       77 Form1-Tb-1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 COMO-RECORD      PIC  X(32000).
       01 FLAG-MOD         PIC  9
                  VALUE IS 0.
       01 CONTROL-COMO     PIC  9(2)
                  VALUE IS 0.
       77 E-ESCI           PIC  9
                  VALUE IS 1.
       77 E-SALVA          PIC  9
                  VALUE IS 1.
       77 E-MODIFICA       PIC  9
                  VALUE IS 0.
       77 E-CERCA          PIC  9
                  VALUE IS 0.
       77 Form1-St-1-Handle
                  USAGE IS HANDLE OF STATUS-BAR.
       77 Status-cod       PIC  9.
       77 data-oggi        PIC  9(8).
       77 E-SELEZIONA      PIC  9
                  VALUE IS 1.
       77 toolbar-bmp
                  USAGE IS HANDLE OF BITMAP
                  VALUE IS 0.
       77 Screen1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 Default-Font
                  USAGE IS HANDLE OF FONT DEFAULT-FONT.
       77 Small-Font
                  USAGE IS HANDLE OF FONT SMALL-FONT.
       78 primo-id-dati VALUE IS 5002. 
       77 Form2-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 Form1-Pg-1-Visible           PIC  9
                  VALUE IS 0.
       77 Default-bmp      PIC  S9(6)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 Form1-Pg-2-Visible           PIC  9
                  VALUE IS 0.
       78 TITOLO VALUE IS "Geslux - Inserimento Articolo da Distinta Bas
      -    "e". 
       77 mod-campi        PIC  9
                  VALUE IS 1.
       01 save-chiave.
           10 save-art-codice  PIC  9(6).
       77 AUTO-ID          PIC  9(6)
                  VALUE IS 0,00.
       77 STATUS-tcodpag   PIC  X(2).
           88 Valid-STATUS-tcodpag VALUE IS "00" THRU "09". 
       77 STATUS-tivaese   PIC  X(2).
           88 Valid-STATUS-tivaese VALUE IS "00" THRU "09". 
       77 STATUS-articoli  PIC  X(2).
           88 Valid-STATUS-articoli VALUE IS "00" THRU "09". 
       77 STATUS-tcla1art  PIC  X(2).
           88 Valid-STATUS-tcla1art VALUE IS "00" THRU "09". 
       77 STATUS-tnomen    PIC  X(2).
           88 Valid-STATUS-tnomen VALUE IS "00" THRU "09". 
       77 STATUS-tudm      PIC  X(2).
           88 Valid-STATUS-tudm VALUE IS "00" THRU "09". 
       77 STATUS-tmarche   PIC  X(2).
           88 Valid-STATUS-tmarche VALUE IS "00" THRU "09". 
       77 STATUS-tsetmerc  PIC  X(2).
           88 Valid-STATUS-tsetmerc VALUE IS "00" THRU "09". 
       77 STATUS-progmag   PIC  X(2).
           88 Valid-STATUS-progmag VALUE IS "00" THRU "09". 
       77 STATUS-timballi  PIC  X(2).
           88 Valid-STATUS-timballi VALUE IS "00" THRU "09". 
       77 mod-imposte      PIC  9
                  VALUE IS 1.
       77 mod-cobat        PIC  9
                  VALUE IS 1.
       77 cbo-utf-buf      PIC  X(12).
       77 cbo-cobat-buf    PIC  x(4).
       77 cbo-stato-buf    PIC  X(9).
       77 STATUS-tparamge  PIC  X(2).
           88 Valid-STATUS-tparamge VALUE IS "00" THRU "09". 
       77 STATUS-timbalqta PIC  X(2).
           88 Valid-STATUS-timbalqta VALUE IS "00" THRU "09". 
       77 lab-iva-buf      PIC  x(100).
       77 lab-imballo-buf  PIC  x(100).
       77 STATUS-clienti   PIC  X(2).
           88 Valid-STATUS-clienti VALUE IS "00" THRU "09". 
       77 STATUS-tmagaz    PIC  X(2).
           88 Valid-STATUS-tmagaz VALUE IS "00" THRU "09". 
       77 lab-mag-buf      PIC  x(50).
       77 mod-peso         PIC  9.
       77 mod-peso-utf     PIC  9
                  VALUE IS 1.
       77 mod-peso-non-utf PIC  9
                  VALUE IS 0.

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 Screen1-Ta-1-TAB-VALUE  PIC  99  VALUE 1.
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
      * DATA CONTROL BUFFER
       01 Form1-BUF.
      * Data.Entry-Field
              05 ef-codice-BUF PIC x(6).
      * Page
              05 PAGE-1-BUF.
      * Data.Entry-Field
              10 ef-des-BUF PIC X(50).
              10 ef-des-VALUEBUF PIC X(50).
      * Data.Entry-Field
              10 ef-mag-BUF PIC x(3).
      * Data.Entry-Field
              10 ef-setmerc-BUF PIC zzz9.
      * Data.Entry-Field
              10 ef-iva-BUF PIC x(3).
      * Data.Entry-Field
              10 ef-marca-BUF PIC zzz9.
      * Data.Entry-Field
              10 ef-classe-1-BUF PIC zzz9.
      * Data.Entry-Field
              10 ef-classe-2-BUF PIC zz9.
      * Data.Entry-Field
              10 ef-classe-3-BUF PIC zz9.
      * Data.Entry-Field
              10 ef-clase-4-BUF PIC zz9.
      * Data.Entry-Field
              10 ef-udm-BUF PIC X(2).
      * Data.Entry-Field
              10 ef-imballo-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-udm-imballo-BUF PIC X(5).
      * Data.Entry-Field
              10 ef-dogana-BUF PIC 9(8).
      * Data.Entry-Field
              10 ef-peso-utf-BUF PIC zz9,999.
      * Data.Entry-Field
              10 ef-peso-non-utf-BUF PIC zz9,999.
      * Data.Check-Box
              10 chk-imposte-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-perce-imposte-BUF PIC zz9,999.
      * Data.Entry-Field
              10 ef-perce-cou-BUF PIC zz9,9(3).
      * Data.Check-Box
              10 chk-cobat-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-amperaggio-BUF PIC zz9.
      * Data.Entry-Field
              10 ef-prezzo-vendita-BUF PIC zzz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-sconto-acquisto-BUF PIC z9,99.
      * Data.Entry-Field
              10 ef-prezzo-acquisto-BUF PIC zzz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-sconto-agente-BUF PIC z9,99.
      * Data.Entry-Field
              10 ef-note-BUF PIC X(30).
      * Data.Entry-Field
              10 ef-ean-1-BUF PIC z(12)9.
              10 ef-ean-1-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-ean-2-BUF PIC z(12)9.
              10 ef-ean-2-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-ean-3-BUF PIC z(12)9.
              10 ef-ean-3-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-ean-4-BUF PIC z(12)9.
              10 ef-ean-4-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-ean-5-BUF PIC z(12)9.
              10 ef-ean-5-VALUEBUF PIC 9(13).
      * Data.Entry-Field
              10 ef-forn-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-foto-BUF PIC X(512).
      * Data.Entry-Field
              10 ef-scheda-BUF PIC X(512).
      * Data.Label
              10 lab-setmerc-BUF PIC X(30).
      * Data.Label
              10 lab-marca-BUF PIC X(30).
      * Data.Label
              10 lab-classe-BUF PIC X(30).
      * Data.Label
              10 lab-udm-BUF PIC X(30).
      * Data.Label
              10 lab-dogana-BUF PIC X(50).
      * Data.Label
              10 lab-forn-BUF PIC X(40).
      * Data.Label
              05 lab-des-BUF PIC X(50).

       77 TMP-Form1-KEY1-ORDER  PIC X VALUE "A".
       77 TMP-Form1-KEY2-ORDER  PIC X VALUE "A".
       77 TMP-Form1-articoli-RESTOREBUF  PIC X(3660).
       77 TMP-Form1-KEYIS  PIC 9(3) VALUE 1.
       77 Form1-MULKEY-TMPBUF   PIC X(3660).
       77 Form1-KEYISTMP2   PIC X(50).
      * Form1 : PKEY & AKEY'S TEMP BUFFER
       77 Form1-PKEYTMP   PIC X(6).
       77 TMP-DataSet1-tivaese-BUF     PIC X(129).
       77 TMP-DataSet1-tmarche-BUF     PIC X(112).
       77 TMP-DataSet1-timballi-BUF     PIC X(210).
       77 TMP-DataSet1-progmag-BUF     PIC X(495).
       77 TMP-DataSet1-tnomen-BUF     PIC X(228).
       77 TMP-DataSet1-tcla1art-BUF     PIC X(191).
       77 TMP-DataSet1-tsetmerc-BUF     PIC X(191).
       77 TMP-DataSet1-articoli-BUF     PIC X(3660).
       77 TMP-DataSet1-tudm-BUF     PIC X(189).
       77 TMP-DataSet1-tparamge-BUF     PIC X(815).
       77 TMP-DataSet1-timbalqta-BUF     PIC X(167).
       77 TMP-DataSet1-clienti-BUF     PIC X(1356).
       77 TMP-DataSet1-tmagaz-BUF     PIC X(212).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-tivaese-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tivaese-LOCK  VALUE "Y".
       77 DataSet1-tivaese-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tivaese-KEY-Asc  VALUE "A".
          88 DataSet1-tivaese-KEY-Desc VALUE "D".
       77 DataSet1-tmarche-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmarche-LOCK  VALUE "Y".
       77 DataSet1-tmarche-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmarche-KEY-Asc  VALUE "A".
          88 DataSet1-tmarche-KEY-Desc VALUE "D".
       77 DataSet1-timballi-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timballi-LOCK  VALUE "Y".
       77 DataSet1-timballi-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timballi-KEY-Asc  VALUE "A".
          88 DataSet1-timballi-KEY-Desc VALUE "D".
       77 DataSet1-progmag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-progmag-LOCK  VALUE "Y".
       77 DataSet1-progmag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-progmag-KEY-Asc  VALUE "A".
          88 DataSet1-progmag-KEY-Desc VALUE "D".
       77 DataSet1-tnomen-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tnomen-LOCK  VALUE "Y".
       77 DataSet1-tnomen-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tnomen-KEY-Asc  VALUE "A".
          88 DataSet1-tnomen-KEY-Desc VALUE "D".
       77 DataSet1-tcla1art-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcla1art-LOCK  VALUE "Y".
       77 DataSet1-tcla1art-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcla1art-KEY-Asc  VALUE "A".
          88 DataSet1-tcla1art-KEY-Desc VALUE "D".
       77 DataSet1-tsetmerc-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tsetmerc-LOCK  VALUE "Y".
       77 DataSet1-tsetmerc-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tsetmerc-KEY-Asc  VALUE "A".
          88 DataSet1-tsetmerc-KEY-Desc VALUE "D".
       77 DataSet1-articoli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-articoli-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-articoli-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-articoli-KEY1-Asc  VALUE "A".
          88 DataSet1-articoli-KEY1-Desc VALUE "D".
       77 DataSet1-articoli-KEY2-ORDER  PIC X VALUE "A".
          88 DataSet1-articoli-KEY2-Asc  VALUE "A".
          88 DataSet1-articoli-KEY2-Desc VALUE "D".
       77 DataSet1-tudm-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tudm-LOCK  VALUE "Y".
       77 DataSet1-tudm-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tudm-KEY-Asc  VALUE "A".
          88 DataSet1-tudm-KEY-Desc VALUE "D".
       77 DataSet1-tparamge-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tparamge-LOCK  VALUE "Y".
       77 DataSet1-tparamge-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tparamge-KEY-Asc  VALUE "A".
          88 DataSet1-tparamge-KEY-Desc VALUE "D".
       77 DataSet1-timbalqta-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timbalqta-LOCK  VALUE "Y".
       77 DataSet1-timbalqta-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timbalqta-KEY-Asc  VALUE "A".
          88 DataSet1-timbalqta-KEY-Desc VALUE "D".
       77 DataSet1-clienti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-clienti-LOCK  VALUE "Y".
       77 DataSet1-clienti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti-KEY-Asc  VALUE "A".
          88 DataSet1-clienti-KEY-Desc VALUE "D".
       77 DataSet1-tmagaz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmagaz-LOCK  VALUE "Y".
       77 DataSet1-tmagaz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmagaz-KEY-Asc  VALUE "A".
          88 DataSet1-tmagaz-KEY-Desc VALUE "D".

       77 tivaese-key01-SPLITBUF  PIC X(53).
       77 progmag-key01-SPLITBUF  PIC X(19).
       77 articoli-art-k1-SPLITBUF  PIC X(51).
       77 clienti-cli-K1-SPLITBUF  PIC X(47).
       77 clienti-cli-K3-SPLITBUF  PIC X(12).
       77 clienti-cli-K4-SPLITBUF  PIC X(8).
      * FOR SPLIT KEY BUFFER
       77 DataSet1-articoli-SPLIT-BUF2   PIC X(51).


      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-ef-codice VALUE 5001.
       78  78-ID-ef-des VALUE 5002.
       78  78-ID-ef-mag VALUE 5003.
       78  78-ID-ef-setmerc VALUE 5004.
       78  78-ID-ef-iva VALUE 5005.
       78  78-ID-ef-marca VALUE 5006.
       78  78-ID-ef-classe-1 VALUE 5007.
       78  78-ID-ef-classe-2 VALUE 5008.
       78  78-ID-ef-classe-3 VALUE 5009.
       78  78-ID-ef-clase-4 VALUE 5010.
       78  78-ID-ef-udm VALUE 5011.
       78  78-ID-ef-imballo VALUE 5012.
       78  78-ID-ef-udm-imballo VALUE 5013.
       78  78-ID-ef-dogana VALUE 5014.
       78  78-ID-cbo-utf VALUE 5015.
       78  78-ID-ef-peso-utf VALUE 5016.
       78  78-ID-ef-peso-non-utf VALUE 5017.
       78  78-ID-chk-imposte VALUE 5018.
       78  78-ID-ef-perce-imposte VALUE 5019.
       78  78-ID-ef-perce-cou VALUE 5020.
       78  78-ID-chk-cobat VALUE 5021.
       78  78-ID-ef-amperaggio VALUE 5022.
       78  78-ID-cbo-cobat VALUE 5023.
       78  78-ID-ef-prezzo-vendita VALUE 5024.
       78  78-ID-ef-sconto-acquisto VALUE 5025.
       78  78-ID-ef-prezzo-acquisto VALUE 5026.
       78  78-ID-ef-sconto-agente VALUE 5027.
       78  78-ID-ef-note VALUE 5028.
       78  78-ID-ef-ean-1 VALUE 5029.
       78  78-ID-ef-ean-2 VALUE 5030.
       78  78-ID-ef-ean-3 VALUE 5031.
       78  78-ID-ef-ean-4 VALUE 5032.
       78  78-ID-ef-ean-5 VALUE 5033.
       78  78-ID-ef-forn VALUE 5034.
       78  78-ID-ef-foto VALUE 5035.
       78  78-ID-ef-scheda VALUE 5036.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "LINK-INSARTICOLI.DEF".

      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           AFTER PROCEDURE Form1-AfterProcedure,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           .

      * ENTRY FIELD
       05
           ef-codice, 
           Entry-Field, 
           COL 16,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-k,
           ID IS 78-ID-ef-codice,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 6,
           READ-ONLY,
           VALUE ef-codice-BUF,
           .

      * TAB
       05
           Screen1-Ta-1, 
           Tab-Control, 
           COL 1,83, 
           LINE 5,08,
           LINES 34,85 ,
           SIZE 166,00 ,
           ID IS 5000,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           .

      * PAGE
       05
           PAGE-1, 
           VISIBLE Form1-Pg-1-Visible,
           COL 3, 
           LINE 7,
           .

      * ENTRY FIELD
       10
           ef-des, 
           Entry-Field, 
           COL 21,50, 
           LINE 8,77,
           LINES 1,31 ,
           SIZE 75,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-des-BUF,
           .

      * ENTRY FIELD
       10
           ef-mag, 
           Entry-Field, 
           COL 109,50, 
           LINE 8,77,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           FONT IS Small-Font,
           ID IS 78-ID-ef-mag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-mag-BUF,
           .

      * ENTRY FIELD
       10
           ef-setmerc, 
           Entry-Field, 
           COL 21,50, 
           LINE 10,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-setmerc,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           VALUE ef-setmerc-BUF,
           .

      * ENTRY FIELD
       10
           ef-iva, 
           Entry-Field, 
           COL 88,50, 
           LINE 10,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-iva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-iva-BUF,
           .

      * ENTRY FIELD
       10
           ef-marca, 
           Entry-Field, 
           COL 21,50, 
           LINE 12,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-marca,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           VALUE ef-marca-BUF,
           .

      * ENTRY FIELD
       10
           ef-classe-1, 
           Entry-Field, 
           COL 21,50, 
           LINE 14,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-classe-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           VALUE ef-classe-1-BUF,
           .

      * ENTRY FIELD
       10
           ef-classe-2, 
           Entry-Field, 
           COL 88,50, 
           LINE 14,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-classe-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-classe-2-BUF,
           .
      * ENTRY FIELD
       10
           ef-classe-3, 
           Entry-Field, 
           COL 124,50, 
           LINE 14,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-classe-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-classe-3-BUF,
           .
      * ENTRY FIELD
       10
           ef-clase-4, 
           Entry-Field, 
           COL 156,83, 
           LINE 14,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-clase-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-clase-4-BUF,
           .
      * ENTRY FIELD
       10
           ef-udm, 
           Entry-Field, 
           COL 21,50, 
           LINE 16,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-udm,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 2,
           VALUE ef-udm-BUF,
           .

      * ENTRY FIELD
       10
           ef-imballo, 
           Entry-Field, 
           COL 88,50, 
           LINE 16,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-imballo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-imballo-BUF,
           .

      * ENTRY FIELD
       10
           ef-udm-imballo, 
           Entry-Field, 
           COL 156,83, 
           LINE 16,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-udm-imballo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 5,
           VALUE ef-udm-imballo-BUF,
           .

      * ENTRY FIELD
       10
           ef-dogana, 
           Entry-Field, 
           COL 21,50, 
           LINE 18,77,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED 0,
           FONT IS Small-Font,
           ID IS 78-ID-ef-dogana,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-dogana-BUF,
           .

      * COMBO-BOX
       10
           cbo-utf, 
           Combo-Box, 
           COL 88,50, 
           LINE 18,77,
           LINES 5,00 ,
           SIZE 16,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED 0,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-utf-buf,
           AFTER PROCEDURE cbo-utf-AfterProcedure, 
           EVENT PROCEDURE cbo-utf-Event-Proc,
           .
      * ENTRY FIELD
       10
           ef-peso-utf, 
           Entry-Field, 
           COL 124,50, 
           LINE 18,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED 0,
           FONT IS Small-Font,
           ID IS 78-ID-ef-peso-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           VALUE ef-peso-utf-BUF,
           .

      * ENTRY FIELD
       10
           ef-peso-non-utf, 
           Entry-Field, 
           COL 156,83, 
           LINE 18,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED 0,
           FONT IS Small-Font,
           ID IS 78-ID-ef-peso-non-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           VALUE ef-peso-non-utf-BUF,
           .

      * CHECK BOX
       10
           chk-imposte, 
           Check-Box, 
           COL 21,50, 
           LINE 20,77,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1000
           FLAT,
           ID IS 78-ID-chk-imposte,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-imposte",
           VALUE chk-imposte-BUF,
            .
      * ENTRY FIELD
       10
           ef-perce-imposte, 
           Entry-Field, 
           COL 88,50, 
           LINE 20,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-imposte,
           FONT IS Small-Font,
           ID IS 78-ID-ef-perce-imposte,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           VALUE ef-perce-imposte-BUF,
           .

      * ENTRY FIELD
       10
           ef-perce-cou, 
           Entry-Field, 
           COL 124,50, 
           LINE 20,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-imposte,
           FONT IS Small-Font,
           ID IS 78-ID-ef-perce-cou,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           VALUE ef-perce-cou-BUF,
           .

      * CHECK BOX
       10
           chk-cobat, 
           Check-Box, 
           COL 21,50, 
           LINE 22,77,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1001
           FLAT,
           ID IS 78-ID-chk-cobat,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "art-soggetto-cobat",
           VALUE chk-cobat-BUF,
            .
      * ENTRY FIELD
       10
           ef-amperaggio, 
           Entry-Field, 
           COL 88,50, 
           LINE 22,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-cobat,
           FONT IS Small-Font,
           ID IS 78-ID-ef-amperaggio,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-amperaggio-BUF,
           .

      * COMBO-BOX
       10
           cbo-cobat, 
           Combo-Box, 
           COL 124,50, 
           LINE 22,77,
           LINES 4,00 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-cobat,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-cobat,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-cobat-buf,
           AFTER PROCEDURE Form1-Cm-1-AfterProcedure, 
           .

      * ENTRY FIELD
       10
           ef-prezzo-vendita, 
           Entry-Field, 
           COL 21,50, 
           LINE 24,77,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prezzo-vendita,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           VALUE ef-prezzo-vendita-BUF,
           .

      * ENTRY FIELD
       10
           ef-sconto-acquisto, 
           Entry-Field, 
           COL 88,50, 
           LINE 24,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto-acquisto,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-sconto-acquisto-BUF,
           .

      * ENTRY FIELD
       10
           ef-prezzo-acquisto, 
           Entry-Field, 
           COL 124,50, 
           LINE 24,77,
           LINES 1,31 ,
           SIZE 14,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prezzo-acquisto,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           VALUE ef-prezzo-acquisto-BUF,
           .

      * ENTRY FIELD
       10
           ef-sconto-agente, 
           Entry-Field, 
           COL 156,83, 
           LINE 24,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto-agente,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-sconto-agente-BUF,
           .

      * ENTRY FIELD
       10
           ef-note, 
           Entry-Field, 
           COL 21,50, 
           LINE 26,77,
           LINES 1,31 ,
           SIZE 117,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-note-BUF,
           .
      * ENTRY FIELD
       10
           ef-ean-1, 
           Entry-Field, 
           COL 21,50, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-1-BUF,
           .
      * ENTRY FIELD
       10
           ef-ean-2, 
           Entry-Field, 
           COL 120,50, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-2-BUF,
           .
      * ENTRY FIELD
       10
           ef-ean-3, 
           Entry-Field, 
           COL 21,50, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-3-BUF,
           .
      * ENTRY FIELD
       10
           ef-ean-4, 
           Entry-Field, 
           COL 120,50, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-4-BUF,
           .
      * ENTRY FIELD
       10
           ef-ean-5, 
           Entry-Field, 
           COL 21,50, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 18,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ean-5,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 13,
           VALUE ef-ean-5-BUF,
           .
      * ENTRY FIELD
       10
           ef-forn, 
           Entry-Field, 
           COL 120,50, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-forn,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-forn-BUF,
           .

      * ENTRY FIELD
       10
           ef-foto, 
           Entry-Field, 
           COL 21,50, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 61,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-foto,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-foto-BUF,
           .
      * PUSH BUTTON
       10
           pb-foto, 
           Push-Button, 
           COL 82,50, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 3,00 ,
           EXCEPTION-VALUE 1003,
           FONT IS Small-Font,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       10
           ef-scheda, 
           Entry-Field, 
           COL 21,50, 
           LINE 36,77,
           LINES 1,31 ,
           SIZE 61,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-scheda,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 256,
           VALUE ef-scheda-BUF,
           .
      * PUSH BUTTON
       10
           pb-scheda, 
           Push-Button, 
           COL 82,50, 
           LINE 36,77,
           LINES 1,31 ,
           SIZE 3,00 ,
           EXCEPTION-VALUE 1004,
           FONT IS Small-Font,
           ID IS 73,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * LABEL
       10
           Form1-La-1, 
           Label, 
           COL 4,50, 
           LINE 8,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Descrizione",
           .

      * LABEL
       10
           Form1-La-2, 
           Label, 
           COL 4,50, 
           LINE 10,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sett. merceologico",
           .

      * LABEL
       10
           Form1-La-3, 
           Label, 
           COL 4,50, 
           LINE 12,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 7,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Marca",
           .

      * LABEL
       10
           Form1-La-4, 
           Label, 
           COL 4,50, 
           LINE 14,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 9,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Classe 1",
           .

      * LABEL
       10
           Form1-La-6, 
           Label, 
           COL 73,50, 
           LINE 14,77,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 11,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Classe 2",
           .

      * LABEL
       10
           Form1-La-7, 
           Label, 
           COL 110,50, 
           LINE 14,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 13,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Classe 3",
           .

      * LABEL
       10
           Form1-La-8, 
           Label, 
           COL 140,50, 
           LINE 14,77,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Classe 4",
           .

      * LABEL
       10
           Form1-La-9, 
           Label, 
           COL 4,50, 
           LINE 16,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Unità di misura",
           .

      * LABEL
       10
           Form1-La-10, 
           Label, 
           COL 106,50, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. Fornitore",
           .

      * LABEL
       10
           Form1-La-12, 
           Label, 
           COL 110,50, 
           LINE 18,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           ENABLED 1,
           FONT IS Small-Font,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Peso UTF",
           .

      * LABEL
       10
           Form1-La-13, 
           Label, 
           COL 140,50, 
           LINE 18,77,
           LINES 1,31 ,
           SIZE 13,17 ,
           ENABLED 1,
           FONT IS Small-Font,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Peso non UTF",
           .

      * LABEL
       10
           Form1-La-14, 
           Label, 
           COL 73,50, 
           LINE 16,77,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imballo standard",
           .

      * LABEL
       10
           Form1-La-16, 
           Label, 
           COL 4,50, 
           LINE 24,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 29,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prezzo acquisto",
           .

      * LABEL
       10
           Form1-La-17, 
           Label, 
           COL 140,50, 
           LINE 24,77,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 31,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "% Sc. agente",
           .

      * LABEL
       10
           Form1-La-18, 
           Label, 
           COL 110,50, 
           LINE 24,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 33,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prezzo vendita",
           .

      * LABEL
       10
           Form1-La-19, 
           Label, 
           COL 73,50, 
           LINE 24,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 35,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "% Sc. acquisto",
           .

      * LABEL
       10
           Form1-La-21, 
           Label, 
           COL 4,50, 
           LINE 18,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 37,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. doganale",
           .

      * LABEL
       10
           Form1-La-22, 
           Label, 
           COL 73,50, 
           LINE 20,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 39,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "% Imposte",
           .

      * LABEL
       10
           Form1-La-11, 
           Label, 
           COL 73,50, 
           LINE 22,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 43,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Amperaggio",
           .

      * LABEL
       10
           Form1-La-23, 
           Label, 
           COL 4,17, 
           LINE 26,77,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note",
           .

      * LABEL
       10
           Form1-La-24, 
           Label, 
           COL 4,17, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 28,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN 1",
           .

      * LABEL
       10
           Form1-La-25, 
           Label, 
           COL 106,50, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN 2",
           .

      * LABEL
       10
           Form1-La-26, 
           Label, 
           COL 4,17, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 47,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN 3",
           .

      * LABEL
       10
           Form1-La-27, 
           Label, 
           COL 106,50, 
           LINE 30,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 49,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN 4",
           .

      * LABEL
       10
           Form1-La-28, 
           Label, 
           COL 4,17, 
           LINE 32,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 51,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice EAN 5",
           .

      * LABEL
       10
           Form1-La-29, 
           Label, 
           COL 4,17, 
           LINE 34,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 53,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Foto",
           .

      * LABEL
       10
           Form1-La-30, 
           Label, 
           COL 4,17, 
           LINE 36,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 55,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Scheda tecnica",
           .

      * DB_LABEL
       10
           lab-setmerc, 
           Label, 
           COL 31,50, 
           LINE 10,77,
           LINES 1,54 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 62,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-setmerc-BUF,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-marca, 
           Label, 
           COL 31,50, 
           LINE 12,77,
           LINES 1,54 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 63,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-marca-BUF,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-31, 
           Label, 
           COL 82,50, 
           LINE 18,77,
           LINES 1,31 ,
           SIZE 4,00 ,
           ENABLED 1,
           FONT IS Small-Font,
           ID IS 64,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "UTF",
           .

      * LABEL
       10
           Form1-La-32, 
           Label, 
           COL 4,50, 
           LINE 20,77,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 59,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sogg. imposte",
           .

      * LABEL
       10
           Form1-La-33, 
           Label, 
           COL 4,50, 
           LINE 22,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 65,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sogg. COBAT",
           .

      * LABEL
       10
           Form1-La-34, 
           Label, 
           COL 110,50, 
           LINE 23,00,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 67,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Tipo COBAT",
           .

      * DB_LABEL
       10
           lab-classe, 
           Label, 
           COL 31,50, 
           LINE 14,77,
           LINES 1,54 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 68,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-classe-BUF,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-udm, 
           Label, 
           COL 31,50, 
           LINE 16,77,
           LINES 1,54 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 69,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-udm-BUF,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-dogana, 
           Label, 
           COL 40,50, 
           LINE 18,77,
           LINES 1,31 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 72,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-dogana-BUF,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-8a, 
           Label, 
           COL 140,50, 
           LINE 16,77,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 76,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "U.d.m. per imballo",
           .

      * LABEL
       10
           Form1-La-22a, 
           Label, 
           COL 110,50, 
           LINE 20,77,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 77,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "% C.O.U.",
           .

      * LABEL
       10
           lab-iva, 
           Label, 
           COL 97,50, 
           LINE 10,77,
           LINES 2,00 ,
           SIZE 67,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 78,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-iva-buf,
           .

      * LABEL
       10
           lab-imballo, 
           Label, 
           COL 97,50, 
           LINE 16,54,
           LINES 1,54 ,
           SIZE 42,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 70,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-imballo-buf,
           .

      * DB_LABEL
       10
           lab-forn, 
           Label, 
           COL 129,50, 
           LINE 32,77,
           LINES 2,00 ,
           SIZE 36,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 74,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-forn-BUF,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-2a, 
           Label, 
           COL 73,50, 
           LINE 10,77,
           LINES 1,31 ,
           SIZE 13,17 ,
           FONT IS Small-Font,
           ID IS 75,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice IVA",
           .

      * LABEL
       10
           Form1-La-15, 
           Label, 
           COL 99,50, 
           LINE 8,77,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 81,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Magazzino",
           .

      * LABEL
       10
           lab-mag, 
           Label, 
           COL 116,50, 
           LINE 8,77,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 83,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-mag-buf,
           .

      * BAR
       05
           Form1-Br-2, 
           Bar,
           COL 1,00, 
           LINE 3,69,
           SIZE 168,33 ,
           ID IS 133,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       05
           Form1-La-5, 
           Label, 
           COL 2,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 9,67 ,
           ID IS 5003,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Codice",
           .

      * LABEL
       05
           Form1-Custom1-1, 
           Label, 
           COL 67,67, 
           LINE 4,00,
           LINES 0,62 ,
           SIZE 12,33 ,
           FONT IS Default-Font,
           ID IS 666,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * DB_LABEL
       05
           lab-des, 
           Label, 
           COL 26,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 112,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 86,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-des-BUF,
           TRANSPARENT,
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 5005,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 6,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 5008,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 11,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 22,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 5010,
           SELF-ACT,
           TITLE "Modifica (F5)",
           VALUE MOD,
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 16,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 79,
           SELF-ACT,
           TITLE "Cerca (F8)",
           BITMAP-NUMBER BitmapNumZoom
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING insarticoli-linkage.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:insarticoli, INIT:insarticoli, BeforeDeclarative>
       ARTICOLI-ERR SECTION.
           use after error procedure on articoli.
           set RecLocked to false.
           evaluate status-articoli
           when "35"
                display message "File [ARTICOLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [ARTICOLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[ARTICOLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "99" 
           when "93" 
                set RecLocked to true
                set errori    to true
                move 0 to mod        
                move 1 to mod-k
                modify tool-modifica, value = mod
                display form1
                set StatusVisua to true
                perform STATUS-BAR-MSG
                move "00" to status-articoli
                if ReadSecca
                   read articoli no lock 
                        invalid      continue
                        not invalid  perform FORM1-IUD-DISPLAY
                   end-read
                end-if
                display message box MSG-Record-gia-in-uso
                        title = tit-err
                        icon is mb-error-icon
           when "23"
                move 1 to mod-k
                move 0 to mod
                modify tool-modifica, value = mod
                set StatusVisua to true
                perform STATUS-BAR-MSG 
                if nuovo              
                   initialize art-dati replacing numeric data by zeroes
                                            alphanumeric data by spaces
                   perform FORM1-FLD-TO-BUF
                   display form1-tb-1
                   set vecchio to true
                end-if
                perform ABILITAZIONI
                display form1
                |risetto il valore a "23" perche dentro al par. CLEAR-SCREEN
                |con l'operazione unlock viene risettato a zero cosicchè 
                |quando torna dentro ai par. di scorrimento di Totem si 
                |trova in una situazione corretta e prosegue con la read
                |uscendo con un messaggio di errore di tipo "46"
                move "23" to status-articoli
           end-evaluate.
 
      ***---
       TIVAESE-ERR SECTION.
           use after error procedure on tivaese.
           set tutto-ok  to true.
           evaluate status-tivaese
           when "35"
                display message "File [TIVAESE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIVAESE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIVAESE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMARCHE-ERR SECTION.
           use after error procedure on tmarche.
           set tutto-ok  to true.
           evaluate status-tmarche
           when "35"
                display message "File [TMARCHE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMARCHE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMARCHE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALLI-ERR SECTION.
           use after error procedure on timballi.
           set tutto-ok  to true.
           evaluate status-timballi
           when "35"
                display message "File [TIMBALLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       PROGMAG-ERR SECTION.
           use after error procedure on progmag.
           set tutto-ok  to true.
           evaluate status-progmag
           when "35"
                display message "File [PROGMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [PROGMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[PROGMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TNOMEN-ERR SECTION.
           use after error procedure on tnomen.
           set tutto-ok  to true.
           evaluate status-tnomen
           when "35"
                display message "File [TNOMEN] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TNOMEN] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TNOMEN] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TCLA1ART-ERR SECTION.
           use after error procedure on tcla1art.
           set tutto-ok  to true.
           evaluate status-tcla1art
           when "35"
                display message "File [TCLA1ART] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCLA1ART] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCLA1ART] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TSETMERC-ERR SECTION.
           use after error procedure on tsetmerc.
           set tutto-ok  to true.
           evaluate status-tsetmerc
           when "35"
                display message "File [TSETMERC] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TSETMERC] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TSETMERC] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.           
 
      ***---
       TUDM-ERR SECTION.
           use after error procedure on tudm.
           set tutto-ok  to true.
           evaluate status-tudm
           when "35"
                display message "File [TUDM] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TUDM] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TUDM] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TPARAMGE-ERR SECTION.
           use after error procedure on tparamge.
           set tutto-ok  to true.
           evaluate status-tparamge
           when "35"
                display message "File [TPARAMGE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TPARAMGE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TPARAMGE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALQTA-ERR SECTION.
           use after error procedure on timbalqta.
           set tutto-ok  to true.
           evaluate status-timbalqta
           when "35"
                display message "File [TIMBALQTA] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALQTA] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALQTA] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       CLIENTI-ERR SECTION.
           use after error procedure on clienti.
           set tutto-ok  to true.
           evaluate status-clienti
           when "35"
                display message "File [CLIENTI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [CLIENTI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[CLIENTI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMAGAZ-ERR SECTION.
           use after error procedure on tmagaz.
           set tutto-ok  to true.
           evaluate status-tmagaz
           when "35"
                display message "File [TMAGAZ] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMAGAZ] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMAGAZ] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM anagr01-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:insarticoli, INIT:insarticoli, BeforeDestroyResource>
      * <TOTEM:END>
           CALL "w$bitmap" USING WBITMAP-DESTROY, toolbar-bmp
      *    After-Program
           set environment "KEYSTROKE" to "DATA=46   46".
           set environment "KEYSTROKE" to "DATA=44   44".
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
           .

       INIT-BMP.
      * TOOL-ESCI
           COPY RESOURCE "toolbar.bmp".
           CALL "w$bitmap" USING WBITMAP-LOAD "toolbar.bmp", 
                   GIVING toolbar-bmp.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-tivaese
           PERFORM OPEN-tmarche
           PERFORM OPEN-timballi
           PERFORM OPEN-progmag
           PERFORM OPEN-tnomen
           PERFORM OPEN-tcla1art
           PERFORM OPEN-tsetmerc
           PERFORM OPEN-articoli
           PERFORM OPEN-tudm
           PERFORM OPEN-tparamge
           PERFORM OPEN-timbalqta
           PERFORM OPEN-clienti
           PERFORM OPEN-tmagaz
      *    After Open
           .

       OPEN-tivaese.
      * <TOTEM:EPT. INIT:insarticoli, FD:tivaese, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tivaese
           IF NOT Valid-STATUS-tivaese
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:tivaese, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmarche.
      * <TOTEM:EPT. INIT:insarticoli, FD:tmarche, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmarche
           IF NOT Valid-STATUS-tmarche
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:tmarche, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timballi.
      * <TOTEM:EPT. INIT:insarticoli, FD:timballi, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timballi
           IF NOT Valid-STATUS-timballi
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:timballi, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-progmag.
      * <TOTEM:EPT. INIT:insarticoli, FD:progmag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT progmag
           IF NOT Valid-STATUS-progmag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:progmag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tnomen.
      * <TOTEM:EPT. INIT:insarticoli, FD:tnomen, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tnomen
           IF NOT Valid-STATUS-tnomen
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:tnomen, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcla1art.
      * <TOTEM:EPT. INIT:insarticoli, FD:tcla1art, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcla1art
           IF NOT Valid-STATUS-tcla1art
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:tcla1art, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tsetmerc.
      * <TOTEM:EPT. INIT:insarticoli, FD:tsetmerc, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tsetmerc
           IF NOT Valid-STATUS-tsetmerc
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:tsetmerc, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-articoli.
      * <TOTEM:EPT. INIT:insarticoli, FD:articoli, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O articoli
           IF STATUS-articoli = "35"
              OPEN OUTPUT articoli
                IF Valid-STATUS-articoli
                   CLOSE articoli
                   OPEN I-O articoli
                END-IF
           END-IF
           IF NOT Valid-STATUS-articoli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:articoli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tudm.
      * <TOTEM:EPT. INIT:insarticoli, FD:tudm, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tudm
           IF NOT Valid-STATUS-tudm
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:tudm, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tparamge.
      * <TOTEM:EPT. INIT:insarticoli, FD:tparamge, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tparamge
           IF NOT Valid-STATUS-tparamge
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:tparamge, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timbalqta.
      * <TOTEM:EPT. INIT:insarticoli, FD:timbalqta, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timbalqta
           IF NOT Valid-STATUS-timbalqta
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:timbalqta, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-clienti.
      * <TOTEM:EPT. INIT:insarticoli, FD:clienti, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT clienti
           IF NOT Valid-STATUS-clienti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:clienti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmagaz.
      * <TOTEM:EPT. INIT:insarticoli, FD:tmagaz, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmagaz
           IF NOT Valid-STATUS-tmagaz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:insarticoli, FD:tmagaz, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-tivaese
           PERFORM CLOSE-tmarche
           PERFORM CLOSE-timballi
           PERFORM CLOSE-progmag
           PERFORM CLOSE-tnomen
           PERFORM CLOSE-tcla1art
           PERFORM CLOSE-tsetmerc
           PERFORM CLOSE-articoli
           PERFORM CLOSE-tudm
           PERFORM CLOSE-tparamge
           PERFORM CLOSE-timbalqta
           PERFORM CLOSE-clienti
           PERFORM CLOSE-tmagaz
      *    After Close
           .

       CLOSE-tivaese.
      * <TOTEM:EPT. INIT:insarticoli, FD:tivaese, BeforeClose>
      * <TOTEM:END>
           CLOSE tivaese
           .

       CLOSE-tmarche.
      * <TOTEM:EPT. INIT:insarticoli, FD:tmarche, BeforeClose>
      * <TOTEM:END>
           CLOSE tmarche
           .

       CLOSE-timballi.
      * <TOTEM:EPT. INIT:insarticoli, FD:timballi, BeforeClose>
      * <TOTEM:END>
           CLOSE timballi
           .

       CLOSE-progmag.
      * <TOTEM:EPT. INIT:insarticoli, FD:progmag, BeforeClose>
      * <TOTEM:END>
           CLOSE progmag
           .

       CLOSE-tnomen.
      * <TOTEM:EPT. INIT:insarticoli, FD:tnomen, BeforeClose>
      * <TOTEM:END>
           CLOSE tnomen
           .

       CLOSE-tcla1art.
      * <TOTEM:EPT. INIT:insarticoli, FD:tcla1art, BeforeClose>
      * <TOTEM:END>
           CLOSE tcla1art
           .

       CLOSE-tsetmerc.
      * <TOTEM:EPT. INIT:insarticoli, FD:tsetmerc, BeforeClose>
      * <TOTEM:END>
           CLOSE tsetmerc
           .

       CLOSE-articoli.
      * <TOTEM:EPT. INIT:insarticoli, FD:articoli, BeforeClose>
      * <TOTEM:END>
           CLOSE articoli
           .

       CLOSE-tudm.
      * <TOTEM:EPT. INIT:insarticoli, FD:tudm, BeforeClose>
      * <TOTEM:END>
           CLOSE tudm
           .

       CLOSE-tparamge.
      * <TOTEM:EPT. INIT:insarticoli, FD:tparamge, BeforeClose>
      * <TOTEM:END>
           CLOSE tparamge
           .

       CLOSE-timbalqta.
      * <TOTEM:EPT. INIT:insarticoli, FD:timbalqta, BeforeClose>
      * <TOTEM:END>
           CLOSE timbalqta
           .

       CLOSE-clienti.
      * <TOTEM:EPT. INIT:insarticoli, FD:clienti, BeforeClose>
      * <TOTEM:END>
           CLOSE clienti
           .

       CLOSE-tmagaz.
      * <TOTEM:EPT. INIT:insarticoli, FD:tmagaz, BeforeClose>
      * <TOTEM:END>
           CLOSE tmagaz
           .

       tivaese-key01-MERGE-SPLITBUF.
           INITIALIZE tivaese-key01-SPLITBUF
           MOVE TBLIV-CODICE1(1:2) TO tivaese-key01-SPLITBUF(1:2)
           MOVE TBLIV-DESCRIZIONE1(1:30) TO tivaese-key01-SPLITBUF(3:30)
           MOVE TBLIV-CODICE2(1:20) TO tivaese-key01-SPLITBUF(33:20)
           .

       DataSet1-tivaese-INITSTART.
           IF DataSet1-tivaese-KEY-Asc
              MOVE Low-Value TO TBLIV-CODICE
           ELSE
              MOVE High-Value TO TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-INITEND.
           IF DataSet1-tivaese-KEY-Asc
              MOVE High-Value TO TBLIV-CODICE
           ELSE
              MOVE Low-Value TO TBLIV-CODICE
           END-IF
           .

      * tivaese
       DataSet1-tivaese-START.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY >= TBLIV-CODICE
           ELSE
              START tivaese KEY <= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-NOTGREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY <= TBLIV-CODICE
           ELSE
              START tivaese KEY >= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-GREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY > TBLIV-CODICE
           ELSE
              START tivaese KEY < TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-LESS.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY < TBLIV-CODICE
           ELSE
              START tivaese KEY > TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tivaese-LOCK
              READ tivaese WITH LOCK 
              KEY TBLIV-CODICE
           ELSE
              READ tivaese WITH NO LOCK 
              KEY TBLIV-CODICE
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT 
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmarche-INITSTART.
           IF DataSet1-tmarche-KEY-Asc
              MOVE Low-Value TO mar-chiave
           ELSE
              MOVE High-Value TO mar-chiave
           END-IF
           .

       DataSet1-tmarche-INITEND.
           IF DataSet1-tmarche-KEY-Asc
              MOVE High-Value TO mar-chiave
           ELSE
              MOVE Low-Value TO mar-chiave
           END-IF
           .

      * tmarche
       DataSet1-tmarche-START.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY >= mar-chiave
           ELSE
              START tmarche KEY <= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-NOTGREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY <= mar-chiave
           ELSE
              START tmarche KEY >= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-GREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY > mar-chiave
           ELSE
              START tmarche KEY < mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-LESS.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY < mar-chiave
           ELSE
              START tmarche KEY > mar-chiave
           END-IF
           .

       DataSet1-tmarche-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmarche-LOCK
              READ tmarche WITH LOCK 
              KEY mar-chiave
           ELSE
              READ tmarche WITH NO LOCK 
              KEY mar-chiave
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT 
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timballi-INITSTART.
           IF DataSet1-timballi-KEY-Asc
              MOVE Low-Value TO imb-chiave
           ELSE
              MOVE High-Value TO imb-chiave
           END-IF
           .

       DataSet1-timballi-INITEND.
           IF DataSet1-timballi-KEY-Asc
              MOVE High-Value TO imb-chiave
           ELSE
              MOVE Low-Value TO imb-chiave
           END-IF
           .

      * timballi
       DataSet1-timballi-START.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY >= imb-chiave
           ELSE
              START timballi KEY <= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-NOTGREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY <= imb-chiave
           ELSE
              START timballi KEY >= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-GREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY > imb-chiave
           ELSE
              START timballi KEY < imb-chiave
           END-IF
           .

       DataSet1-timballi-START-LESS.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY < imb-chiave
           ELSE
              START timballi KEY > imb-chiave
           END-IF
           .

       DataSet1-timballi-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timballi-LOCK
              READ timballi WITH LOCK 
              KEY imb-chiave
           ELSE
              READ timballi WITH NO LOCK 
              KEY imb-chiave
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT 
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterDelete>
      * <TOTEM:END>
           .

       progmag-key01-MERGE-SPLITBUF.
           INITIALIZE progmag-key01-SPLITBUF
           MOVE prg-cod-magazzino OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(1:3)
           MOVE prg-cod-articolo OF progmag(1:6) TO 
           progmag-key01-SPLITBUF(4:6)
           MOVE prg-tipo-imballo OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(10:3)
           MOVE prg-peso OF progmag(1:6) TO progmag-key01-SPLITBUF(13:6)
           .

       DataSet1-progmag-INITSTART.
           IF DataSet1-progmag-KEY-Asc
              MOVE Low-Value TO prg-chiave OF progmag
           ELSE
              MOVE High-Value TO prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-INITEND.
           IF DataSet1-progmag-KEY-Asc
              MOVE High-Value TO prg-chiave OF progmag
           ELSE
              MOVE Low-Value TO prg-chiave OF progmag
           END-IF
           .

      * progmag
       DataSet1-progmag-START.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY >= prg-chiave OF progmag
           ELSE
              START progmag KEY <= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-NOTGREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY <= prg-chiave OF progmag
           ELSE
              START progmag KEY >= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-GREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY > prg-chiave OF progmag
           ELSE
              START progmag KEY < prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-LESS.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY < prg-chiave OF progmag
           ELSE
              START progmag KEY > prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-progmag-LOCK
              READ progmag WITH LOCK 
              KEY prg-chiave OF progmag
           ELSE
              READ progmag WITH NO LOCK 
              KEY prg-chiave OF progmag
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT 
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tnomen-INITSTART.
           IF DataSet1-tnomen-KEY-Asc
              MOVE Low-Value TO nom-chiave
           ELSE
              MOVE High-Value TO nom-chiave
           END-IF
           .

       DataSet1-tnomen-INITEND.
           IF DataSet1-tnomen-KEY-Asc
              MOVE High-Value TO nom-chiave
           ELSE
              MOVE Low-Value TO nom-chiave
           END-IF
           .

      * tnomen
       DataSet1-tnomen-START.
           IF DataSet1-tnomen-KEY-Asc
              START tnomen KEY >= nom-chiave
           ELSE
              START tnomen KEY <= nom-chiave
           END-IF
           .

       DataSet1-tnomen-START-NOTGREATER.
           IF DataSet1-tnomen-KEY-Asc
              START tnomen KEY <= nom-chiave
           ELSE
              START tnomen KEY >= nom-chiave
           END-IF
           .

       DataSet1-tnomen-START-GREATER.
           IF DataSet1-tnomen-KEY-Asc
              START tnomen KEY > nom-chiave
           ELSE
              START tnomen KEY < nom-chiave
           END-IF
           .

       DataSet1-tnomen-START-LESS.
           IF DataSet1-tnomen-KEY-Asc
              START tnomen KEY < nom-chiave
           ELSE
              START tnomen KEY > nom-chiave
           END-IF
           .

       DataSet1-tnomen-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tnomen-LOCK
              READ tnomen WITH LOCK 
              KEY nom-chiave
           ELSE
              READ tnomen WITH NO LOCK 
              KEY nom-chiave
           END-IF
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT 
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tnomen-KEY-Asc
              IF DataSet1-tnomen-LOCK
                 READ tnomen NEXT WITH LOCK
              ELSE
                 READ tnomen NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnomen-LOCK
                 READ tnomen PREVIOUS WITH LOCK
              ELSE
                 READ tnomen PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tnomen-KEY-Asc
              IF DataSet1-tnomen-LOCK
                 READ tnomen PREVIOUS WITH LOCK
              ELSE
                 READ tnomen PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnomen-LOCK
                 READ tnomen NEXT WITH LOCK
              ELSE
                 READ tnomen NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tnomen-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tnomen TO TOTEM-ERR-STAT
           MOVE "tnomen" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnomen, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-INITSTART.
           IF DataSet1-tcla1art-KEY-Asc
              MOVE Low-Value TO cl1-chiave
           ELSE
              MOVE High-Value TO cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-INITEND.
           IF DataSet1-tcla1art-KEY-Asc
              MOVE High-Value TO cl1-chiave
           ELSE
              MOVE Low-Value TO cl1-chiave
           END-IF
           .

      * tcla1art
       DataSet1-tcla1art-START.
           IF DataSet1-tcla1art-KEY-Asc
              START tcla1art KEY >= cl1-chiave
           ELSE
              START tcla1art KEY <= cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-START-NOTGREATER.
           IF DataSet1-tcla1art-KEY-Asc
              START tcla1art KEY <= cl1-chiave
           ELSE
              START tcla1art KEY >= cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-START-GREATER.
           IF DataSet1-tcla1art-KEY-Asc
              START tcla1art KEY > cl1-chiave
           ELSE
              START tcla1art KEY < cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-START-LESS.
           IF DataSet1-tcla1art-KEY-Asc
              START tcla1art KEY < cl1-chiave
           ELSE
              START tcla1art KEY > cl1-chiave
           END-IF
           .

       DataSet1-tcla1art-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcla1art-LOCK
              READ tcla1art WITH LOCK 
              KEY cl1-chiave
           ELSE
              READ tcla1art WITH NO LOCK 
              KEY cl1-chiave
           END-IF
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT 
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcla1art-KEY-Asc
              IF DataSet1-tcla1art-LOCK
                 READ tcla1art NEXT WITH LOCK
              ELSE
                 READ tcla1art NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcla1art-LOCK
                 READ tcla1art PREVIOUS WITH LOCK
              ELSE
                 READ tcla1art PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcla1art-KEY-Asc
              IF DataSet1-tcla1art-LOCK
                 READ tcla1art PREVIOUS WITH LOCK
              ELSE
                 READ tcla1art PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcla1art-LOCK
                 READ tcla1art NEXT WITH LOCK
              ELSE
                 READ tcla1art NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcla1art-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tcla1art TO TOTEM-ERR-STAT
           MOVE "tcla1art" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcla1art, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-INITSTART.
           IF DataSet1-tsetmerc-KEY-Asc
              MOVE Low-Value TO sme-chiave
           ELSE
              MOVE High-Value TO sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-INITEND.
           IF DataSet1-tsetmerc-KEY-Asc
              MOVE High-Value TO sme-chiave
           ELSE
              MOVE Low-Value TO sme-chiave
           END-IF
           .

      * tsetmerc
       DataSet1-tsetmerc-START.
           IF DataSet1-tsetmerc-KEY-Asc
              START tsetmerc KEY >= sme-chiave
           ELSE
              START tsetmerc KEY <= sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-START-NOTGREATER.
           IF DataSet1-tsetmerc-KEY-Asc
              START tsetmerc KEY <= sme-chiave
           ELSE
              START tsetmerc KEY >= sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-START-GREATER.
           IF DataSet1-tsetmerc-KEY-Asc
              START tsetmerc KEY > sme-chiave
           ELSE
              START tsetmerc KEY < sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-START-LESS.
           IF DataSet1-tsetmerc-KEY-Asc
              START tsetmerc KEY < sme-chiave
           ELSE
              START tsetmerc KEY > sme-chiave
           END-IF
           .

       DataSet1-tsetmerc-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tsetmerc-LOCK
              READ tsetmerc WITH LOCK 
              KEY sme-chiave
           ELSE
              READ tsetmerc WITH NO LOCK 
              KEY sme-chiave
           END-IF
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT 
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tsetmerc-KEY-Asc
              IF DataSet1-tsetmerc-LOCK
                 READ tsetmerc NEXT WITH LOCK
              ELSE
                 READ tsetmerc NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tsetmerc-LOCK
                 READ tsetmerc PREVIOUS WITH LOCK
              ELSE
                 READ tsetmerc PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tsetmerc-KEY-Asc
              IF DataSet1-tsetmerc-LOCK
                 READ tsetmerc PREVIOUS WITH LOCK
              ELSE
                 READ tsetmerc PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tsetmerc-LOCK
                 READ tsetmerc NEXT WITH LOCK
              ELSE
                 READ tsetmerc NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tsetmerc-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tsetmerc TO TOTEM-ERR-STAT
           MOVE "tsetmerc" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tsetmerc, AfterDelete>
      * <TOTEM:END>
           .

       articoli-art-k1-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k1-SPLITBUF
           MOVE art-descrizione OF articoli(1:50) TO 
           articoli-art-k1-SPLITBUF(1:50)
           .

       DataSet1-articoli-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 MOVE Low-Value TO art-chiave OF articoli
              ELSE
                 MOVE High-Value TO art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 MOVE Low-Value TO art-descrizione OF articoli
              ELSE
                 MOVE High-Value TO art-descrizione OF articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 MOVE High-Value TO art-chiave OF articoli
              ELSE
                 MOVE Low-Value TO art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 MOVE High-Value to art-descrizione OF articoli
              ELSE          
                 MOVE Low-Value to art-descrizione OF articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-TMPBUF-TO-FLD.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              MOVE DataSet1-articoli-SPLIT-BUF2(1:50) TO
                   art-descrizione OF articoli(1:50)
           END-EVALUATE
           .

       DataSet1-articoli-FLD-TO-TMPBUF.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              MOVE art-descrizione OF articoli(1:50) TO
                   DataSet1-articoli-SPLIT-BUF2(1:50)
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-CHANGETO-KEY2.
           MOVE 2 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-articoli-KEY1-ORDER
           WHEN 2
              MOVE "A" TO DataSet1-articoli-KEY2-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-articoli-KEY1-ORDER
           WHEN 2
              MOVE "D" TO DataSet1-articoli-KEY2-ORDER
           END-EVALUATE
           .

      * articoli
       DataSet1-articoli-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 START articoli KEY >= art-chiave OF articoli
              ELSE
                 START articoli KEY <= art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 START articoli KEY >= art-k1 of articoli
              ELSE
                 START articoli KEY <= art-k1 of articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 START articoli KEY <= art-chiave OF articoli
              ELSE
                 START articoli KEY >= art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 START articoli KEY <= art-k1 of articoli
              ELSE
                 START articoli KEY >= art-k1 of articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 START articoli KEY > art-chiave OF articoli
              ELSE
                 START articoli KEY < art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 START articoli KEY > art-k1 of articoli
              ELSE
                 START articoli KEY < art-k1 of articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 START articoli KEY < art-chiave OF articoli
              ELSE
                 START articoli KEY > art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 START articoli KEY < art-k1 of articoli
              ELSE
                 START articoli KEY > art-k1 of articoli
              END-IF
           END-EVALUATE
           .

       DataSet1-articoli-START-EQUAL.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              START articoli KEY = art-k1 of articoli
           END-EVALUATE
           .

       DataSet1-articoli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-LOCK
                 READ articoli WITH LOCK 
                 KEY art-chiave OF articoli
              ELSE
                 READ articoli WITH NO LOCK 
                 KEY art-chiave OF articoli
              END-IF
           WHEN 2
              IF DataSet1-articoli-LOCK
                 READ articoli WITH LOCK 
                 KEY art-k1 of articoli
              ELSE
                 READ articoli WITH NO LOCK 
                 KEY art-k1 of articoli
              END-IF
           END-EVALUATE
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT 
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 IF DataSet1-articoli-LOCK
                    READ articoli NEXT WITH LOCK
                 ELSE
                    READ articoli NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-articoli-LOCK
                    READ articoli PREVIOUS WITH LOCK
                 ELSE
                    READ articoli PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 IF DataSet1-articoli-LOCK
                    READ articoli NEXT WITH LOCK
                 ELSE
                    READ articoli NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-articoli-LOCK
                    READ articoli PREVIOUS WITH LOCK
                 ELSE
                    READ articoli PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-articoli-KEY1-Asc
                 IF DataSet1-articoli-LOCK
                    READ articoli PREVIOUS WITH LOCK
                 ELSE
                    READ articoli PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-articoli-LOCK
                    READ articoli NEXT WITH LOCK
                 ELSE
                    READ articoli NEXT WITH NO LOCK
                 END-IF
              END-IF
           WHEN 2
              IF DataSet1-articoli-KEY2-Asc
                 IF DataSet1-articoli-LOCK
                    READ articoli PREVIOUS WITH LOCK
                 ELSE
                    READ articoli PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-articoli-LOCK
                    READ articoli NEXT WITH LOCK
                 ELSE
                    READ articoli NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeWrite>
      * <TOTEM:END>
           WRITE art-rec OF articoli.
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRewrite>
      * <TOTEM:END>
           REWRITE art-rec OF articoli.
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeDelete>
      * <TOTEM:END>
           DELETE articoli.
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tudm-INITSTART.
           IF DataSet1-tudm-KEY-Asc
              MOVE Low-Value TO udm-chiave
           ELSE
              MOVE High-Value TO udm-chiave
           END-IF
           .

       DataSet1-tudm-INITEND.
           IF DataSet1-tudm-KEY-Asc
              MOVE High-Value TO udm-chiave
           ELSE
              MOVE Low-Value TO udm-chiave
           END-IF
           .

      * tudm
       DataSet1-tudm-START.
           IF DataSet1-tudm-KEY-Asc
              START tudm KEY >= udm-chiave
           ELSE
              START tudm KEY <= udm-chiave
           END-IF
           .

       DataSet1-tudm-START-NOTGREATER.
           IF DataSet1-tudm-KEY-Asc
              START tudm KEY <= udm-chiave
           ELSE
              START tudm KEY >= udm-chiave
           END-IF
           .

       DataSet1-tudm-START-GREATER.
           IF DataSet1-tudm-KEY-Asc
              START tudm KEY > udm-chiave
           ELSE
              START tudm KEY < udm-chiave
           END-IF
           .

       DataSet1-tudm-START-LESS.
           IF DataSet1-tudm-KEY-Asc
              START tudm KEY < udm-chiave
           ELSE
              START tudm KEY > udm-chiave
           END-IF
           .

       DataSet1-tudm-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tudm-LOCK
              READ tudm WITH LOCK 
              KEY udm-chiave
           ELSE
              READ tudm WITH NO LOCK 
              KEY udm-chiave
           END-IF
           MOVE STATUS-tudm TO TOTEM-ERR-STAT 
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tudm-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tudm-KEY-Asc
              IF DataSet1-tudm-LOCK
                 READ tudm NEXT WITH LOCK
              ELSE
                 READ tudm NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tudm-LOCK
                 READ tudm PREVIOUS WITH LOCK
              ELSE
                 READ tudm PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tudm-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tudm-KEY-Asc
              IF DataSet1-tudm-LOCK
                 READ tudm PREVIOUS WITH LOCK
              ELSE
                 READ tudm PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tudm-LOCK
                 READ tudm NEXT WITH LOCK
              ELSE
                 READ tudm NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tudm-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tudm-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tudm-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tudm TO TOTEM-ERR-STAT
           MOVE "tudm" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tudm, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tparamge-INITSTART.
           IF DataSet1-tparamge-KEY-Asc
              MOVE Low-Value TO tge-chiave
           ELSE
              MOVE High-Value TO tge-chiave
           END-IF
           .

       DataSet1-tparamge-INITEND.
           IF DataSet1-tparamge-KEY-Asc
              MOVE High-Value TO tge-chiave
           ELSE
              MOVE Low-Value TO tge-chiave
           END-IF
           .

      * tparamge
       DataSet1-tparamge-START.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY >= tge-chiave
           ELSE
              START tparamge KEY <= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-NOTGREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY <= tge-chiave
           ELSE
              START tparamge KEY >= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-GREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY > tge-chiave
           ELSE
              START tparamge KEY < tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-LESS.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY < tge-chiave
           ELSE
              START tparamge KEY > tge-chiave
           END-IF
           .

       DataSet1-tparamge-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tparamge-LOCK
              READ tparamge WITH LOCK 
              KEY tge-chiave
           ELSE
              READ tparamge WITH NO LOCK 
              KEY tge-chiave
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT 
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-INITSTART.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE Low-Value TO imq-chiave
           ELSE
              MOVE High-Value TO imq-chiave
           END-IF
           .

       DataSet1-timbalqta-INITEND.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE High-Value TO imq-chiave
           ELSE
              MOVE Low-Value TO imq-chiave
           END-IF
           .

      * timbalqta
       DataSet1-timbalqta-START.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY >= imq-chiave
           ELSE
              START timbalqta KEY <= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-NOTGREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY <= imq-chiave
           ELSE
              START timbalqta KEY >= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-GREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY > imq-chiave
           ELSE
              START timbalqta KEY < imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-LESS.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY < imq-chiave
           ELSE
              START timbalqta KEY > imq-chiave
           END-IF
           .

       DataSet1-timbalqta-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timbalqta-LOCK
              READ timbalqta WITH LOCK 
              KEY imq-chiave
           ELSE
              READ timbalqta WITH NO LOCK 
              KEY imq-chiave
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT 
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterDelete>
      * <TOTEM:END>
           .

       clienti-cli-K1-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K1-SPLITBUF
           MOVE cli-tipo-CF OF clienti(1:1) TO 
           clienti-cli-K1-SPLITBUF(1:1)
           MOVE cli-ragsoc-1 OF clienti(1:40) TO 
           clienti-cli-K1-SPLITBUF(2:40)
           MOVE cli-codice OF clienti(1:5) TO 
           clienti-cli-K1-SPLITBUF(42:5)
           .

       clienti-cli-K3-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K3-SPLITBUF
           MOVE cli-gdo OF clienti(1:5) TO clienti-cli-K3-SPLITBUF(1:5)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K3-SPLITBUF(6:6)
           .

       clienti-cli-K4-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K4-SPLITBUF
           MOVE cli-utf OF clienti(1:1) TO clienti-cli-K4-SPLITBUF(1:1)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K4-SPLITBUF(2:6)
           .

       DataSet1-clienti-INITSTART.
           IF DataSet1-clienti-KEY-Asc
              MOVE Low-Value TO cli-chiave OF clienti
           ELSE
              MOVE High-Value TO cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-INITEND.
           IF DataSet1-clienti-KEY-Asc
              MOVE High-Value TO cli-chiave OF clienti
           ELSE
              MOVE Low-Value TO cli-chiave OF clienti
           END-IF
           .

      * clienti
       DataSet1-clienti-START.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY >= cli-chiave OF clienti
           ELSE
              START clienti KEY <= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-NOTGREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY <= cli-chiave OF clienti
           ELSE
              START clienti KEY >= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-GREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY > cli-chiave OF clienti
           ELSE
              START clienti KEY < cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-LESS.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY < cli-chiave OF clienti
           ELSE
              START clienti KEY > cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-clienti-LOCK
              READ clienti WITH LOCK 
              KEY cli-chiave OF clienti
           ELSE
              READ clienti WITH NO LOCK 
              KEY cli-chiave OF clienti
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT 
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-INITSTART.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE Low-Value TO mag-chiave
           ELSE
              MOVE High-Value TO mag-chiave
           END-IF
           .

       DataSet1-tmagaz-INITEND.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE High-Value TO mag-chiave
           ELSE
              MOVE Low-Value TO mag-chiave
           END-IF
           .

      * tmagaz
       DataSet1-tmagaz-START.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY >= mag-chiave
           ELSE
              START tmagaz KEY <= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-NOTGREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY <= mag-chiave
           ELSE
              START tmagaz KEY >= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-GREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY > mag-chiave
           ELSE
              START tmagaz KEY < mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-LESS.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY < mag-chiave
           ELSE
              START tmagaz KEY > mag-chiave
           END-IF
           .

       DataSet1-tmagaz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmagaz-LOCK
              READ tmagaz WITH LOCK 
              KEY mag-chiave
           ELSE
              READ tmagaz WITH NO LOCK 
              KEY mag-chiave
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT 
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE record-tbliv OF tivaese
           INITIALIZE mar-rec OF tmarche
           INITIALIZE imb-rec OF timballi
           INITIALIZE prg-rec OF progmag
           INITIALIZE nom-rec OF tnomen
           INITIALIZE cl1-rec OF tcla1art
           INITIALIZE sme-rec OF tsetmerc
           INITIALIZE art-rec OF articoli
           INITIALIZE udm-rec OF tudm
           INITIALIZE tge-rec OF tparamge
           INITIALIZE imq-rec OF timbalqta
           INITIALIZE cli-rec OF clienti
           INITIALIZE mag-rec OF tmagaz
           .


      * COMBO-BOX
       cbo-utf-Content.
           .

      * COMBO-BOX
       cbo-cobat-Content.
           .

      * FD's Initialize Paragraph
       DataSet1-tivaese-INITREC.
           INITIALIZE record-tbliv OF tivaese
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmarche-INITREC.
           INITIALIZE mar-rec OF tmarche
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timballi-INITREC.
           INITIALIZE imb-rec OF timballi
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-progmag-INITREC.
           INITIALIZE prg-rec OF progmag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tnomen-INITREC.
           INITIALIZE nom-rec OF tnomen
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcla1art-INITREC.
           INITIALIZE cl1-rec OF tcla1art
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tsetmerc-INITREC.
           INITIALIZE sme-rec OF tsetmerc
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-articoli-INITREC.
           INITIALIZE art-rec OF articoli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tudm-INITREC.
           INITIALIZE udm-rec OF tudm
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tparamge-INITREC.
           INITIALIZE tge-rec OF tparamge
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timbalqta-INITREC.
           INITIALIZE imq-rec OF timbalqta
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-clienti-INITREC.
           INITIALIZE cli-rec OF clienti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmagaz-INITREC.
           INITIALIZE mag-rec OF tmagaz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           EVALUATE TOTEM-Form-Index ALSO TOTEM-Frame-Index
              WHEN 1 ALSO 0
                  PERFORM Form1-Buf-To-Fld
           END-EVALUATE
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Floating GRAPHICAL WINDOW
              SCREEN LINE 1,
              SCREEN COLUMN 0,
              LINES 40,69,
              SIZE 168,33,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Small-Font,
              LABEL-OFFSET 23,
              LINK TO THREAD,
              NO SCROLL,
              TITLE-BAR,
              TITLE TITOLO,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              HANDLE IS Form1-Handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              GRIP,
              PANEL-WIDTHS (90, 35, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON Form1-Handle
      * DISPLAY-COLUMNS settings
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           perform INIT.
           perform ABILITAZIONI.
           set StatusVisua to true.
           perform STATUS-BAR-MSG.

           move "tparamge" to nome-file.
           perform RELAZIONI-ARTICOLI.
                         
           accept data-oggi from century-date.

           perform NUOVO.

           move link-insart-cod-doganale to ef-dogana-buf nom-codice.
           move link-insart-utf          to ef-peso-utf-buf.
           move link-insart-non-utf      to ef-peso-non-utf-buf.
           display ef-dogana.
           display ef-peso-utf.
           display ef-peso-non-utf.

           read tnomen no lock 
                invalid continue 
            not invalid
                evaluate true
                when nom-si-utf 
                     if mod-peso-utf = 0 |ho cambiato lo stato
                        modify cbo-utf, reset-list = 1
                        perform RIEMPI-COMBO-UTF
                        if link-insart-non-utf = 0 
                           set soggetto to true
                           move 0 to mod-peso-non-utf
                        else                       
                           set misto    to true
                           move 1 to mod-peso-non-utf
                        end-if
                        perform CARICA-COMBO-UTF 
                     end-if
                     move 1 to mod-peso-utf
                when nom-no-utf 
                     if mod-peso-utf = 1 |ho cambiato lo stato
                        modify cbo-utf, reset-list = 1
                        perform RIEMPI-COMBO-NON-UTF
                        set non-soggetto to true
                        perform CARICA-COMBO-UTF
                     end-if
                     move 0 to mod-peso-utf
                     move 1 to mod-peso-non-utf
                end-evaluate

                evaluate true
                when nom-si-cobat move 1 to mod-cobat
                when nom-no-cobat move 0 to mod-cobat
                                  move 0 to ef-amperaggio-buf
                end-evaluate 

                evaluate true
                when nom-si-ic-cou move 1 to mod-imposte
                when nom-no-ic-cou move 0 to mod-imposte
                end-evaluate

                if mod-peso-utf = 0
                   move 0 to ef-peso-utf-buf
                end-if
                if mod-peso-non-utf = 0
                   move 0 to ef-peso-non-utf-buf
                end-if

                if mod-imposte = 1
                   inquire ef-perce-imposte, value art-perce-imposte
                   if art-perce-imposte = 0
                      move 100 to ef-perce-imposte-buf
                   end-if         
                   inquire ef-perce-cou,     value art-perce-cou
                   if art-perce-cou = 0
                      move 100 to ef-perce-cou-buf
                   end-if
                else
                   move 0 to ef-perce-imposte-buf
                             ef-perce-cou-buf
                end-if

                display ef-peso-utf      ef-peso-non-utf
                        ef-perce-imposte ef-perce-cou
                        ef-amperaggio    cbo-cobat

                 move nom-descrizione to lab-dogana-buf
                 display lab-dogana
           end-read.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY Form1-Handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
                 IF Event-Type = Cmd-Tabchanged AND 
                                 Event-Control-Id = 5000
                    MOVE EVENT-DATA-1 TO Screen1-Ta-1-TAB-VALUE
                    PERFORM Screen1-Ta-1-TABCHANGE
                 END-IF

              WHEN Key-Status = 1000
                 PERFORM chk-imposte-LinkTo
              WHEN Key-Status = 1001
                 PERFORM chk-cobat-LinkTo
              WHEN Key-Status = 1003
                 PERFORM pb-foto-LinkTo
              WHEN Key-Status = 1004
                 PERFORM pb-scheda-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON Form1-Handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * TAB
              MODIFY Screen1-Ta-1, RESET-TABS = 1
              MODIFY Screen1-Ta-1, 
           TAB-TO-ADD = (
                 "&Anagrafica",
                        )
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
           MOVE 1 TO Form1-Pg-1-Visible
           PERFORM Screen1-Ta-1-TABCHANGE
      * COMBO-BOX
           PERFORM cbo-utf-Content
      * COMBO-BOX
           PERFORM cbo-cobat-Content
           .

       Form1-DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-CHANGETO-KEY2.
           MOVE 2 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-articoli-KEY1-ORDER
           WHEN 2
              MOVE "A" TO DataSet1-articoli-KEY2-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-articoli-KEY1-ORDER
           WHEN 2
              MOVE "D" TO DataSet1-articoli-KEY2-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Update-Key.
           MOVE art-rec OF articoli TO
                     Form1-MULKEY-TMPBUF
           PERFORM Form1-CLEAR
           PERFORM Form1-INIT-DATA
           MOVE Form1-MULKEY-TMPBUF TO
                     art-rec OF articoli
           PERFORM DataSet1-articoli-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
           .

       Form1-DUPLICATE-PREV.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              PERFORM articoli-art-k1-MERGE-SPLITBUF
              IF articoli-art-k1-SPLITBUF = Form1-KEYISTMP2
                 MOVE DataSet1-articoli-KEY2-ORDER TO 
           TMP-Form1-KEY2-ORDER
                 MOVE "A" TO DataSet1-articoli-KEY2-ORDER
                 PERFORM DataSet1-articoli-START-EQUAL
                 IF Valid-STATUS-articoli
                    PERFORM DataSet1-articoli-Read-Next
                    PERFORM UNTIL NOT Valid-STATUS-articoli OR 
                         art-chiave OF articoli = Form1-PKEYTMP OR
                         articoli-art-k1-SPLITBUF NOT = Form1-KEYISTMP2
                       PERFORM DataSet1-articoli-Read-Next
                    END-PERFORM
                 END-IF
                 MOVE TMP-Form1-KEY2-ORDER TO 
           DataSet1-articoli-KEY2-ORDER
              ELSE
                 PERFORM DataSet1-articoli-START-LESS
              END-IF
           WHEN OTHER
              PERFORM DataSet1-articoli-START-LESS
           END-EVALUATE
           .

       Form1-DUPLICATE-NEXT.
           EVALUATE DataSet1-KEYIS
           WHEN 2
              PERFORM articoli-art-k1-MERGE-SPLITBUF
              IF articoli-art-k1-SPLITBUF = Form1-KEYISTMP2
                 MOVE DataSet1-articoli-KEY2-ORDER TO 
           TMP-Form1-KEY2-ORDER
                 MOVE "A" TO DataSet1-articoli-KEY2-ORDER
                 PERFORM DataSet1-articoli-START
                 IF Valid-STATUS-articoli
                    PERFORM DataSet1-articoli-Read-Next
                    PERFORM UNTIL NOT Valid-STATUS-articoli OR 
                         art-chiave OF articoli = Form1-PKEYTMP OR
                         articoli-art-k1-SPLITBUF NOT = Form1-KEYISTMP2
                       PERFORM DataSet1-articoli-Read-Next
                    END-PERFORM
                 END-IF
                 MOVE TMP-Form1-KEY2-ORDER TO 
           DataSet1-articoli-KEY2-ORDER
              ELSE
                 PERFORM DataSet1-articoli-START-GREATER
              END-IF
           WHEN OTHER
              PERFORM DataSet1-articoli-START-GREATER
           END-EVALUATE
           .

       Form1-DUPLICATE-MOVEKEY.
           MOVE art-chiave OF articoli TO Form1-PKEYTMP
           EVALUATE DataSet1-KEYIS
           WHEN 2
              MOVE articoli-art-k1-SPLITBUF TO
                   Form1-KEYISTMP2
           END-EVALUATE
           .

       Form1-First.
           PERFORM Form1-DUMMY-FIRST
           PERFORM DataSet1-articoli-INITSTART
           PERFORM DataSet1-articoli-START
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFirst>
      * <TOTEM:END>
           PERFORM DataSet1-articoli-Read-Next
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFirst>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Previous.
              PERFORM Form1-Buf-To-Fld
              PERFORM Form1-DUPLICATE-PREV
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforePrevious>
      * <TOTEM:END>
           PERFORM DataSet1-articoli-Read-Prev
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterPrevious>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-PREVIOUS
           PERFORM Form1-IUD-Display
           .

       Form1-Next.
              PERFORM Form1-Buf-To-Fld
              PERFORM Form1-DUPLICATE-NEXT
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeNext>
      * <TOTEM:END>
           PERFORM DataSet1-articoli-Read-Next
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterNext>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-NEXT
           PERFORM Form1-IUD-Display
           .
      
       Form1-Last.
           PERFORM Form1-DUMMY-LAST
           PERFORM DataSet1-articoli-INITEND
           PERFORM DataSet1-articoli-START-NOTGREATER
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeLast>
      * <TOTEM:END>
           PERFORM DataSet1-articoli-Read-Prev
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterLast>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Curr.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeCurrent>
      * <TOTEM:END>
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-articoli-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCurrent>
      * <TOTEM:END>
           .

       Form1-IUD-Display.
           IF Valid-STATUS-articoli
              PERFORM Form1-ALLGRID-RESET
              PERFORM Form1-Fld-To-Buf
              PERFORM Form1-NAVI-FOR-MASTERGRID
              PERFORM Form1-DISPLAY
           ELSE
              IF Form1-FLAG-REFRESH
                 CONTINUE
              ELSE
                 PERFORM Form1-Extended-File-Status
              END-IF
           END-IF
           .

       Form1-Add.
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-ADD
           PERFORM DataSet1-articoli-INITREC
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAdd>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-articoli-Rec-Write
           IF Valid-STATUS-articoli
              PERFORM Form1-RESUMMARY-INS
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "301" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAdd>
      * <TOTEM:END>
           .
     
       Form1-Update.
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-articoli-START              
           IF NOT Valid-STATUS-articoli
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
           PERFORM DataSet1-articoli-Read
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-UPDATE
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeUpdate>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-articoli-Rec-Rewrite
           IF Valid-STATUS-articoli
              PERFORM Form1-RESUMMARY-DEL
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "302" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterUpdate>
      * <TOTEM:END>
           .

       Form1-Delete.
           MOVE "203" TO TOTEM-MSG-ID
           PERFORM MESSAGE-BOX-DISPLAY
           IF TOTEM-MSG-RETURN-VALUE NOT = 1
              INITIALIZE TOTEM-MSG-TEXT
              EXIT PARAGRAPH 
           END-IF
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDelete>
      * <TOTEM:END>
           PERFORM Form1-DUMMY-DELETE
      * delete
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-articoli-Rec-Delete
           IF Valid-STATUS-articoli
              PERFORM Form1-CLEAR
              PERFORM Form1-DUMMY-DELETE-INIT
              MOVE "303" TO TOTEM-MSG-ID
              MOVE "00" to STATUS-articoli
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDelete>
      * <TOTEM:END>
           PERFORM Form1-ERR-CHECKING
           .

       Form1-NAVI-FOR-MASTERGRID.
           .

       Form1-ERR-CHECKING.
           IF Valid-STATUS-articoli
              PERFORM Form1-SHOW-MSG-ROUTINE
           ELSE
              PERFORM Form1-Extended-File-Status
           END-IF
           .

       Form1-RESUMMARY-INS.
           .

       Form1-RESUMMARY-DEL.
           .


       Form1-DUMMY-FIRST.
           .

       Form1-DUMMY-PREVIOUS.
           .

       Form1-DUMMY-NEXT.
           .

       Form1-DUMMY-LAST.
           .

       Form1-DUMMY-CURR.
           .

       Form1-DUMMY-ADD.
           .

       Form1-DUMMY-UPDATE.
           .

       Form1-DUMMY-UPDATE-INIT.
           .

       Form1-DUMMY-DELETE.
           .

       Form1-DUMMY-DELETE-INIT.
           .

       Form1-Init-Value.
           MOVE TITOLO TO TOTEM-MSG-TITLE
           INITIALIZE Form1-BUF
      * FORM : Form1
           PERFORM DataSet1-INIT-RECORD
      * DB_CHECK BOX
              MOVE "N" TO art-soggetto-imposte
      * DB_CHECK BOX
              MOVE "N" TO art-soggetto-cobat
           MOVE ALL X'9' TO Form1-KEYISTMP2
           MOVE ALL X'9' TO Form1-PKEYTMP
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
      * ef-codice's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codice-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5001 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5002 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5003 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-setmerc's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-setmerc-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5004 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-iva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-iva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5005 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-marca's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-marca-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5006 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-classe-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-classe-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5007 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-classe-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-classe-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5008 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-classe-3's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-classe-3-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5009 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-clase-4's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-clase-4-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5010 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-udm's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-udm-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5011 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-imballo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-imballo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5012 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-udm-imballo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-udm-imballo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5013 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-dogana's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-dogana-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5014 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-peso-utf's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-peso-utf-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5016 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-peso-non-utf's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-peso-non-utf-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5017 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-perce-imposte's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-perce-imposte-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5019 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-perce-cou's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-perce-cou-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5020 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-amperaggio's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-amperaggio-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5022 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prezzo-vendita's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prezzo-vendita-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5024 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto-acquisto's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-acquisto-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5025 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prezzo-acquisto's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prezzo-acquisto-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5026 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto-agente's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-agente-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5027 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5028 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5029 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5030 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-3's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-3-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5031 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-4's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-4-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5032 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ean-5's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ean-5-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5033 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-forn's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-forn-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5034 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-foto's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-foto-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5035 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-scheda's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-scheda-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5036 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
           .

       ef-codice-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codice, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codice-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codice, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codice's Validation
       ef-codice-VALIDATION.
           PERFORM ef-codice-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codice-AFTER-VALIDATION
           .

       ef-des-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des's Validation
       ef-des-VALIDATION.
           PERFORM ef-des-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des-AFTER-VALIDATION
           .

       ef-mag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mag's Validation
       ef-mag-VALIDATION.
           PERFORM ef-mag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mag-AFTER-VALIDATION
           .

       ef-setmerc-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-setmerc, BeforeValidation>
      * <TOTEM:END>
           .

       ef-setmerc-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-setmerc, AfterValidation>
      * <TOTEM:END>
           .

      * ef-setmerc's Validation
       ef-setmerc-VALIDATION.
           PERFORM ef-setmerc-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-setmerc-AFTER-VALIDATION
           .

       ef-iva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-iva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-iva's Validation
       ef-iva-VALIDATION.
           PERFORM ef-iva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-iva-AFTER-VALIDATION
           .

       ef-marca-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-marca, BeforeValidation>
      * <TOTEM:END>
           .

       ef-marca-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-marca, AfterValidation>
      * <TOTEM:END>
           .

      * ef-marca's Validation
       ef-marca-VALIDATION.
           PERFORM ef-marca-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-marca-AFTER-VALIDATION
           .

       ef-classe-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-classe-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-classe-1's Validation
       ef-classe-1-VALIDATION.
           PERFORM ef-classe-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-classe-1-AFTER-VALIDATION
           .

       ef-classe-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-classe-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-classe-2's Validation
       ef-classe-2-VALIDATION.
           PERFORM ef-classe-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-classe-2-AFTER-VALIDATION
           .

       ef-classe-3-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-3, BeforeValidation>
      * <TOTEM:END>
           .

       ef-classe-3-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-classe-3, AfterValidation>
      * <TOTEM:END>
           .

      * ef-classe-3's Validation
       ef-classe-3-VALIDATION.
           PERFORM ef-classe-3-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-classe-3-AFTER-VALIDATION
           .

       ef-clase-4-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-clase-4, BeforeValidation>
      * <TOTEM:END>
           .

       ef-clase-4-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-clase-4, AfterValidation>
      * <TOTEM:END>
           .

      * ef-clase-4's Validation
       ef-clase-4-VALIDATION.
           PERFORM ef-clase-4-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-clase-4-AFTER-VALIDATION
           .

       ef-udm-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-udm, BeforeValidation>
      * <TOTEM:END>
           .

       ef-udm-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-udm, AfterValidation>
      * <TOTEM:END>
           .

      * ef-udm's Validation
       ef-udm-VALIDATION.
           PERFORM ef-udm-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-udm-AFTER-VALIDATION
           .

       ef-imballo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imballo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-imballo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imballo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-imballo's Validation
       ef-imballo-VALIDATION.
           PERFORM ef-imballo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-imballo-AFTER-VALIDATION
           .

       ef-udm-imballo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-udm-imballo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-udm-imballo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-udm-imballo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-udm-imballo's Validation
       ef-udm-imballo-VALIDATION.
           PERFORM ef-udm-imballo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-udm-imballo-AFTER-VALIDATION
           .

       ef-dogana-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dogana, BeforeValidation>
      * <TOTEM:END>
           .

       ef-dogana-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dogana, AfterValidation>
      * <TOTEM:END>
           .

      * ef-dogana's Validation
       ef-dogana-VALIDATION.
           PERFORM ef-dogana-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-dogana-AFTER-VALIDATION
           .

       ef-peso-utf-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-utf, BeforeValidation>
      * <TOTEM:END>
           .

       ef-peso-utf-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-utf, AfterValidation>
      * <TOTEM:END>
           .

      * ef-peso-utf's Validation
       ef-peso-utf-VALIDATION.
           PERFORM ef-peso-utf-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-peso-utf-AFTER-VALIDATION
           .

       ef-peso-non-utf-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-non-utf, BeforeValidation>
      * <TOTEM:END>
           .

       ef-peso-non-utf-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-peso-non-utf, AfterValidation>
      * <TOTEM:END>
           .

      * ef-peso-non-utf's Validation
       ef-peso-non-utf-VALIDATION.
           PERFORM ef-peso-non-utf-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-peso-non-utf-AFTER-VALIDATION
           .

       ef-perce-imposte-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-imposte, BeforeValidation>
      * <TOTEM:END>
           .

       ef-perce-imposte-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-imposte, AfterValidation>
      * <TOTEM:END>
           .

      * ef-perce-imposte's Validation
       ef-perce-imposte-VALIDATION.
           PERFORM ef-perce-imposte-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-perce-imposte-AFTER-VALIDATION
           .

       ef-perce-cou-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-cou, BeforeValidation>
      * <TOTEM:END>
           .

       ef-perce-cou-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-cou, AfterValidation>
      * <TOTEM:END>
           .

      * ef-perce-cou's Validation
       ef-perce-cou-VALIDATION.
           PERFORM ef-perce-cou-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-perce-cou-AFTER-VALIDATION
           .

       ef-amperaggio-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-amperaggio, BeforeValidation>
      * <TOTEM:END>
           .

       ef-amperaggio-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-amperaggio, AfterValidation>
      * <TOTEM:END>
           .

      * ef-amperaggio's Validation
       ef-amperaggio-VALIDATION.
           PERFORM ef-amperaggio-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-amperaggio-AFTER-VALIDATION
           .

       ef-prezzo-vendita-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prezzo-vendita, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prezzo-vendita-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prezzo-vendita, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prezzo-vendita's Validation
       ef-prezzo-vendita-VALIDATION.
           PERFORM ef-prezzo-vendita-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prezzo-vendita-AFTER-VALIDATION
           .

       ef-sconto-acquisto-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-acquisto, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-acquisto-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-acquisto, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto-acquisto's Validation
       ef-sconto-acquisto-VALIDATION.
           PERFORM ef-sconto-acquisto-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-acquisto-AFTER-VALIDATION
           .

       ef-prezzo-acquisto-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prezzo-acquisto, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prezzo-acquisto-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prezzo-acquisto, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prezzo-acquisto's Validation
       ef-prezzo-acquisto-VALIDATION.
           PERFORM ef-prezzo-acquisto-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prezzo-acquisto-AFTER-VALIDATION
           .

       ef-sconto-agente-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-agente, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-agente-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-agente, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto-agente's Validation
       ef-sconto-agente-VALIDATION.
           PERFORM ef-sconto-agente-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-agente-AFTER-VALIDATION
           .

       ef-note-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note's Validation
       ef-note-VALIDATION.
           PERFORM ef-note-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-AFTER-VALIDATION
           .

       ef-ean-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-1's Validation
       ef-ean-1-VALIDATION.
           PERFORM ef-ean-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-1-AFTER-VALIDATION
           .

       ef-ean-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-2's Validation
       ef-ean-2-VALIDATION.
           PERFORM ef-ean-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-2-AFTER-VALIDATION
           .

       ef-ean-3-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-3, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-3-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-3, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-3's Validation
       ef-ean-3-VALIDATION.
           PERFORM ef-ean-3-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-3-AFTER-VALIDATION
           .

       ef-ean-4-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-4, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-4-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-4, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-4's Validation
       ef-ean-4-VALIDATION.
           PERFORM ef-ean-4-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-4-AFTER-VALIDATION
           .

       ef-ean-5-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-5, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ean-5-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ean-5, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ean-5's Validation
       ef-ean-5-VALIDATION.
           PERFORM ef-ean-5-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ean-5-AFTER-VALIDATION
           .

       ef-forn-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-forn, BeforeValidation>
      * <TOTEM:END>
           .

       ef-forn-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-forn, AfterValidation>
      * <TOTEM:END>
           .

      * ef-forn's Validation
       ef-forn-VALIDATION.
           PERFORM ef-forn-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-forn-AFTER-VALIDATION
           .

       ef-foto-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-foto, BeforeValidation>
      * <TOTEM:END>
           .

       ef-foto-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-foto, AfterValidation>
      * <TOTEM:END>
           .

      * ef-foto's Validation
       ef-foto-VALIDATION.
           PERFORM ef-foto-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-foto-AFTER-VALIDATION
           .

       ef-scheda-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-scheda, BeforeValidation>
      * <TOTEM:END>
           .

       ef-scheda-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-scheda, AfterValidation>
      * <TOTEM:END>
           .

      * ef-scheda's Validation
       ef-scheda-VALIDATION.
           PERFORM ef-scheda-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-scheda-AFTER-VALIDATION
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * DB_Entry-Field : ef-codice
           MOVE ef-codice-BUF TO art-codice
      * DB_Entry-Field : ef-des
           MOVE ef-des-BUF TO art-descrizione
      * DB_Entry-Field : ef-mag
           MOVE ef-mag-BUF TO link-insart-mag
      * DB_Entry-Field : ef-setmerc
           MOVE ef-setmerc-BUF TO art-settore-merceologico
      * DB_Entry-Field : ef-iva
           MOVE ef-iva-BUF TO art-codice-iva
      * DB_Entry-Field : ef-marca
           MOVE ef-marca-BUF TO art-marca-prodotto
      * DB_Entry-Field : ef-classe-1
           MOVE ef-classe-1-BUF TO art-classe-1
      * DB_Entry-Field : ef-classe-2
           MOVE ef-classe-2-BUF TO art-classe-2
      * DB_Entry-Field : ef-classe-3
           MOVE ef-classe-3-BUF TO art-classe-3
      * DB_Entry-Field : ef-clase-4
           MOVE ef-clase-4-BUF TO art-classe-4
      * DB_Entry-Field : ef-udm
           MOVE ef-udm-BUF TO art-unita-di-misura
      * DB_Entry-Field : ef-imballo
           MOVE ef-imballo-BUF TO art-imballo-standard
      * DB_Entry-Field : ef-udm-imballo
           MOVE ef-udm-imballo-BUF TO art-udm-imballo
      * DB_Entry-Field : ef-dogana
           MOVE ef-dogana-BUF TO art-cod-doganale
      * DB_Entry-Field : ef-peso-utf
           MOVE ef-peso-utf-BUF TO art-peso-utf
      * DB_Entry-Field : ef-peso-non-utf
           MOVE ef-peso-non-utf-BUF TO art-peso-non-utf
      * DB_CHECK BOX : chk-imposte
              IF chk-imposte-BUF = 1
                 MOVE "S" TO art-soggetto-imposte
              ELSE
                 MOVE "N" TO art-soggetto-imposte
              END-IF
      * DB_Entry-Field : ef-perce-imposte
           MOVE ef-perce-imposte-BUF TO art-perce-imposte
      * DB_Entry-Field : ef-perce-cou
           MOVE ef-perce-cou-BUF TO art-perce-cou
      * DB_CHECK BOX : chk-cobat
              IF chk-cobat-BUF = 1
                 MOVE "S" TO art-soggetto-cobat
              ELSE
                 MOVE "N" TO art-soggetto-cobat
              END-IF
      * DB_Entry-Field : ef-amperaggio
           MOVE ef-amperaggio-BUF TO art-amperaggio
      * DB_Entry-Field : ef-prezzo-vendita
           MOVE ef-prezzo-vendita-BUF TO art-prezzo-acquisto
      * DB_Entry-Field : ef-sconto-acquisto
           MOVE ef-sconto-acquisto-BUF TO art-perce-sconto-acquisto
      * DB_Entry-Field : ef-prezzo-acquisto
           MOVE ef-prezzo-acquisto-BUF TO art-prezzo-vendita
      * DB_Entry-Field : ef-sconto-agente
           MOVE ef-sconto-agente-BUF TO art-perce-sconto-agente
      * DB_Entry-Field : ef-note
           MOVE ef-note-BUF TO art-note
      * DB_Entry-Field : ef-ean-1
           MOVE ef-ean-1-BUF TO art-codice-ean-1
      * DB_Entry-Field : ef-ean-2
           MOVE ef-ean-2-BUF TO art-codice-ean-2
      * DB_Entry-Field : ef-ean-3
           MOVE ef-ean-3-BUF TO art-codice-ean-3
      * DB_Entry-Field : ef-ean-4
           MOVE ef-ean-4-BUF TO art-codice-ean-4
      * DB_Entry-Field : ef-ean-5
           MOVE ef-ean-5-BUF TO art-codice-ean-5
      * DB_Entry-Field : ef-forn
           MOVE ef-forn-BUF TO art-cod-fornitore
      * DB_Entry-Field : ef-foto
           MOVE ef-foto-BUF TO art-foto
      * DB_Entry-Field : ef-scheda
           MOVE ef-scheda-BUF TO art-scheda-tecnica
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
           perform SCARICA-COMBO-UTF.  
           move gestione-utf        to art-gestione-utf.
                    
           perform SCARICA-COMBO-COBAT.
           move cobat to art-auto-moto-per-cobat.

           move ef-codice-buf to art-codice convert.

           .
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * CLIENTI-PROGRESSIVI
           initialize prg-rec replacing alphanumeric data by spaces
                                             numeric data by zeroes.
           
           move art-codice to prg-cod-articolo.
           read progmag no lock invalid continue end-read.

           .
      * <TOTEM:END>
      * DB_Entry-Field : ef-codice
           MOVE art-codice TO ef-codice-BUF
      * DB_Entry-Field : ef-des
           MOVE art-descrizione TO ef-des-BUF
      * DB_Entry-Field : ef-mag
           MOVE link-insart-mag TO ef-mag-BUF
      * DB_Entry-Field : ef-setmerc
           MOVE art-settore-merceologico TO ef-setmerc-BUF
      * DB_Entry-Field : ef-iva
           MOVE art-codice-iva TO ef-iva-BUF
      * DB_Entry-Field : ef-marca
           MOVE art-marca-prodotto TO ef-marca-BUF
      * DB_Entry-Field : ef-classe-1
           MOVE art-classe-1 TO ef-classe-1-BUF
      * DB_Entry-Field : ef-classe-2
           MOVE art-classe-2 TO ef-classe-2-BUF
      * DB_Entry-Field : ef-classe-3
           MOVE art-classe-3 TO ef-classe-3-BUF
      * DB_Entry-Field : ef-clase-4
           MOVE art-classe-4 TO ef-clase-4-BUF
      * DB_Entry-Field : ef-udm
           MOVE art-unita-di-misura TO ef-udm-BUF
      * DB_Entry-Field : ef-imballo
           MOVE art-imballo-standard TO ef-imballo-BUF
      * DB_Entry-Field : ef-udm-imballo
           MOVE art-udm-imballo TO ef-udm-imballo-BUF
      * DB_Entry-Field : ef-dogana
           MOVE art-cod-doganale TO ef-dogana-BUF
      * DB_Entry-Field : ef-peso-utf
           MOVE art-peso-utf TO ef-peso-utf-BUF
      * DB_Entry-Field : ef-peso-non-utf
           MOVE art-peso-non-utf TO ef-peso-non-utf-BUF
      * DB_CHECK BOX : chk-imposte
              IF art-soggetto-imposte = "S"
                 MOVE 1 TO chk-imposte-BUF
              ELSE
                 MOVE 0 TO chk-imposte-BUF
              END-IF
      * DB_Entry-Field : ef-perce-imposte
           MOVE art-perce-imposte TO ef-perce-imposte-BUF
      * DB_Entry-Field : ef-perce-cou
           MOVE art-perce-cou TO ef-perce-cou-BUF
      * DB_CHECK BOX : chk-cobat
              IF art-soggetto-cobat = "S"
                 MOVE 1 TO chk-cobat-BUF
              ELSE
                 MOVE 0 TO chk-cobat-BUF
              END-IF
      * DB_Entry-Field : ef-amperaggio
           MOVE art-amperaggio TO ef-amperaggio-BUF
      * DB_Entry-Field : ef-prezzo-vendita
           MOVE art-prezzo-acquisto TO ef-prezzo-vendita-BUF
      * DB_Entry-Field : ef-sconto-acquisto
           MOVE art-perce-sconto-acquisto TO ef-sconto-acquisto-BUF
      * DB_Entry-Field : ef-prezzo-acquisto
           MOVE art-prezzo-vendita TO ef-prezzo-acquisto-BUF
      * DB_Entry-Field : ef-sconto-agente
           MOVE art-perce-sconto-agente TO ef-sconto-agente-BUF
      * DB_Entry-Field : ef-note
           MOVE art-note TO ef-note-BUF
      * DB_Entry-Field : ef-ean-1
           MOVE art-codice-ean-1 TO ef-ean-1-BUF
      * DB_Entry-Field : ef-ean-2
           MOVE art-codice-ean-2 TO ef-ean-2-BUF
      * DB_Entry-Field : ef-ean-3
           MOVE art-codice-ean-3 TO ef-ean-3-BUF
      * DB_Entry-Field : ef-ean-4
           MOVE art-codice-ean-4 TO ef-ean-4-BUF
      * DB_Entry-Field : ef-ean-5
           MOVE art-codice-ean-5 TO ef-ean-5-BUF
      * DB_Entry-Field : ef-forn
           MOVE art-cod-fornitore TO ef-forn-BUF
      * DB_Entry-Field : ef-foto
           MOVE art-foto TO ef-foto-BUF
      * DB_Entry-Field : ef-scheda
           MOVE art-scheda-tecnica TO ef-scheda-BUF
      * DB_LABEL : lab-setmerc
              MOVE sme-descrizione  TO lab-setmerc-BUF
      * DB_LABEL : lab-marca
              MOVE mar-descrizione  TO lab-marca-BUF
      * DB_LABEL : lab-classe
              MOVE cl1-descrizione  TO lab-classe-BUF
      * DB_LABEL : lab-udm
              MOVE udm-descrizione  TO lab-udm-BUF
      * DB_LABEL : lab-dogana
              MOVE nom-descrizione  TO lab-dogana-BUF
      * DB_LABEL : lab-forn
              MOVE cli-ragsoc-1  TO lab-forn-BUF
      * DB_LABEL : lab-des
              MOVE art-descrizione  TO lab-des-BUF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
           move art-gestione-utf        to gestione-utf.
           perform CARICA-COMBO-UTF.
           
           move art-auto-moto-per-cobat        to cobat.
           perform CARICA-COMBO-COBAT.
                                  
           move art-codice    to  codice-ed.
           move codice-ed     to  ef-codice-buf.   
           call "C$JUSTIFY" using ef-codice-buf, "L".
           display ef-codice.       
           
      * ARTICOLI-SETTORE MERCEOLOGICO
           move "tsetmerc" to nome-file.
           perform RELAZIONI-ARTICOLI.   
           
      * CLIENTI-CODICE IVA
           move "tivaese" to nome-file.
           perform RELAZIONI-ARTICOLI.
           
      * ARTICOLI-MARCHE
           move "tmarche" to nome-file.
           perform RELAZIONI-ARTICOLI.
           
      * ARTICOLI-CLASSE
           move "tcla1art" to nome-file.
           perform RELAZIONI-ARTICOLI.
           
      * ARTICOLI-DOGANA
           move "tnomen" to nome-file.
           perform RELAZIONI-ARTICOLI.  
           if trovato                       
              modify cbo-utf, reset-list = 1
              evaluate true
              when nom-si-utf               
                   perform RIEMPI-COMBO-UTF
                   perform CARICA-COMBO-UTF
              when nom-no-utf
                   perform RIEMPI-COMBO-NON-UTF
              end-evaluate
           end-if.
           
      * ARTICOLI-UNITA DI MISURA
           move "tudm" to nome-file.
           perform RELAZIONI-ARTICOLI.

      * ARTICOLI-IMBALLI
           move "timbalqta" to nome-file.
           perform RELAZIONI-ARTICOLI.

      * ARTICOLI-FORNITORI
           move "fornitori" to nome-file.
           perform RELAZIONI-ARTICOLI.
                                
           perform ABILITAZIONI.

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           MOVE DataSet1-articoli-KEY1-ORDER TO TMP-Form1-KEY1-ORDER
           MOVE DataSet1-articoli-KEY2-ORDER TO TMP-Form1-KEY2-ORDER
           MOVE DataSet1-KEYIS TO TMP-Form1-KEYIS
           MOVE art-rec OF articoli TO 
              TMP-Form1-articoli-RESTOREBUF
           .             

       Form1-Restore-Status.
           MOVE TMP-Form1-KEY1-ORDER TO DataSet1-articoli-KEY1-ORDER
           MOVE TMP-Form1-KEY2-ORDER TO DataSet1-articoli-KEY2-ORDER
           MOVE TMP-Form1-KEYIS TO DataSet1-KEYIS
           MOVE TMP-Form1-articoli-RESTOREBUF TO
              art-rec OF articoli
           PERFORM DataSet1-articoli-START
           IF Valid-STATUS-articoli
              PERFORM DataSet1-articoli-Read-Next
           ELSE
              PERFORM DataSet1-articoli-INITREC
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-articoli OR
              (Valid-STATUS-articoli AND
                 art-rec OF articoli = 
                   TMP-Form1-articoli-RESTOREBUF)
              PERFORM DataSet1-articoli-Read-Next
           END-PERFORM
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-mag è l'ID del campo ef-mag
           when 78-ID-ef-mag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-setmerc è l'ID del campo ef-setmerc
           when 78-ID-ef-setmerc
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-marca è l'ID del campo ef-marca
           when 78-ID-ef-marca
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-classe-1 è l'ID del campo ef-classe-1
           when 78-ID-ef-classe-1
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-udm è l'ID del campo ef-udm
           when 78-ID-ef-udm
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-imballo è l'ID del campo ef-imballo
           when 78-ID-ef-imballo
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-dogana è l'ID del campo ef-dogana
           when 78-ID-ef-dogana
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |78-ID-ef-peso-utf è l'ID del campo ef-peso-utf
           when 78-ID-ef-peso-utf
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-peso-non-utf è l'ID del campo ef-peso-non-utf
           when 78-ID-ef-peso-non-utf
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-perce-imposte è l'ID del campo ef-perce-imposte
           when 78-ID-ef-perce-imposte
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-perce-cou è l'ID del campo ef-perce-cou
           when 78-ID-ef-perce-cou
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-prezzo-vendita è l'ID del campo ef-prezzo-vendita
           when 78-ID-ef-prezzo-vendita
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto-acquisto è l'ID del campo ef-sconto-acquisto
           when 78-ID-ef-sconto-acquisto
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-prezzo-acquisto è l'ID del campo ef-prezzo-acquisto
           when 78-ID-ef-prezzo-acquisto
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto-agente è l'ID del campo ef-sconto-agente
           when 78-ID-ef-sconto-agente
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-mag è l'ID del campo ef-mag
           when 78-ID-ef-mag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-setmerc è l'ID del campo ef-setmerc
           when 78-ID-ef-setmerc
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-marca è l'ID del campo ef-marca
           when 78-ID-ef-marca
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-classe-1 è l'ID del campo ef-classe-1
           when 78-ID-ef-classe-1
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-udm è l'ID del campo ef-udm
           when 78-ID-ef-udm
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-imballo è l'ID del campo ef-imballo
           when 78-ID-ef-imballo
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-dogana è l'ID del campo ef-dogana
           when 78-ID-ef-dogana
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |78-ID-ef-peso-utf è l'ID del campo ef-peso-utf
           when 78-ID-ef-peso-utf
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-peso-non-utf è l'ID del campo ef-peso-non-utf
           when 78-ID-ef-peso-non-utf
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-perce-imposte è l'ID del campo ef-perce-imposte
           when 78-ID-ef-perce-imposte
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-perce-cou è l'ID del campo ef-perce-cou
           when 78-ID-ef-perce-cou
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-prezzo-vendita è l'ID del campo ef-prezzo-vendita
           when 78-ID-ef-prezzo-vendita
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto-acquisto è l'ID del campo ef-sconto-acquisto
           when 78-ID-ef-sconto-acquisto
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-prezzo-acquisto è l'ID del campo ef-prezzo-acquisto
           when 78-ID-ef-prezzo-acquisto
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto-agente è l'ID del campo ef-sconto-agente
           when 78-ID-ef-sconto-agente
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |78-ID-ef-codice è l'ID del campo ef-codice
           when 78-ID-ef-codice
                perform CONTROLLO
           |78-ID-ef-des è l'ID del campo ef-des
           when 78-ID-ef-des
                perform CONTROLLO
           |78-ID-ef-mag è l'ID del campo ef-mag
           when 78-ID-ef-mag
                perform CONTROLLO
           |78-ID-ef-setmerc è l'ID del campo ef-setmerc
           when 78-ID-ef-setmerc
                perform CONTROLLO
           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                perform CONTROLLO
           |78-ID-ef-marca è l'ID del campo ef-marca
           when 78-ID-ef-marca
                perform CONTROLLO
           |78-ID-ef-classe-1 è l'ID del campo ef-classe-1
           when 78-ID-ef-classe-1
                perform CONTROLLO
           |78-ID-ef-udm è l'ID del campo ef-udm
           when 78-ID-ef-udm
                perform CONTROLLO
           |78-ID-ef-imballo è l'ID del campo ef-imballo
           when 78-ID-ef-imballo
                perform CONTROLLO
           |78-ID-ef-udm-imballo è l'ID del campo ef-udm-imballo
           when 78-ID-ef-udm-imballo
                perform CONTROLLO
           |78-ID-ef-dogana è l'ID del campo ef-dogana
           when 78-ID-ef-dogana
                perform CONTROLLO
           |78-ID-ef-peso-utf è l'ID del campo ef-peso-utf
           when 78-ID-ef-peso-utf
                perform CONTROLLO
           |78-ID-ef-peso-non-utf è l'ID del campo ef-peso-non-utf
           when 78-ID-ef-peso-non-utf
                perform CONTROLLO
           |78-ID-ef-perce-imposte è l'ID del campo ef-perce-imposte
           when 78-ID-ef-perce-imposte
                perform CONTROLLO
           |78-ID-ef-perce-cou è l'ID del campo ef-perce-cou
           when 78-ID-ef-perce-cou
                perform CONTROLLO
           |78-ID-ef-amperaggio è l'ID del campo ef-amperaggio
           when 78-ID-ef-amperaggio
                perform CONTROLLO
           |78-ID-cbo-cobat è l'ID del campo cbo-cobat
           when 78-ID-cbo-cobat
                perform CONTROLLO
           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                perform CONTROLLO
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.



       Screen1-Ta-1-TABCHANGE.
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
           EVALUATE Screen1-Ta-1-TAB-VALUE
           WHEN 1
                  MOVE 1 TO Form1-Pg-1-Visible
                  MODIFY Screen1-Ta-1, VALUE = 1
           END-EVALUATE
           MOVE 5000 TO CONTROL-ID
           DISPLAY Form1
           .

       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "Immettere codice dell'immobile" to 
           TOTEM-HINT-TEXT
           WHEN 5002 MOVE "Digitare la descrizione dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5003 MOVE "Digitare il codice del magazzino" to 
           TOTEM-HINT-TEXT
           WHEN 5004 MOVE "Digitare il settore merceologico d'appartenen
      -    "za" to TOTEM-HINT-TEXT
           WHEN 5005 MOVE "Digitare il codice IVA" to TOTEM-HINT-TEXT
           WHEN 5006 MOVE "Digitare la marca" to TOTEM-HINT-TEXT
           WHEN 5007 MOVE "Digitare la prima classe d'appartenenza" to 
           TOTEM-HINT-TEXT
           WHEN 5008 MOVE "Digitare la seconda classe d'appartenenza" 
           to TOTEM-HINT-TEXT
           WHEN 5009 MOVE "Digitare la terza classe d'appartenenza" to 
           TOTEM-HINT-TEXT
           WHEN 5010 MOVE "Digitare la quarta classe d'appartenenza" to 
           TOTEM-HINT-TEXT
           WHEN 5011 MOVE "Digitare l'unità di misura" to 
           TOTEM-HINT-TEXT
           WHEN 5012 MOVE "Digitare il codice d'imballo standard" to 
           TOTEM-HINT-TEXT
           WHEN 5013 MOVE "Digitare la quarta classe d'appartenenza" to 
           TOTEM-HINT-TEXT
           WHEN 5014 MOVE "Digitare il codice doganale" to 
           TOTEM-HINT-TEXT
           WHEN 5015 MOVE "Selezionare il tipo d'assoggettamento UTF" 
           to TOTEM-HINT-TEXT
           WHEN 5016 MOVE "Digitare il peso UTF" to TOTEM-HINT-TEXT
           WHEN 5017 MOVE "Digitare il peso non UTF" to TOTEM-HINT-TEXT
           WHEN 5018 MOVE "Soggetto/Non soggetto all'imposte" to 
           TOTEM-HINT-TEXT
           WHEN 5019 MOVE "Digitare la percentuale delle imposte" to 
           TOTEM-HINT-TEXT
           WHEN 5020 MOVE "Digitare la percentuale delle imposte" to 
           TOTEM-HINT-TEXT
           WHEN 5021 MOVE "Soggetto/Non soggetto COBAT" to 
           TOTEM-HINT-TEXT
           WHEN 5022 MOVE "Digitare l'amperaggio" to TOTEM-HINT-TEXT
           WHEN 5023 MOVE "Selezionare il tipo di COBAT" to 
           TOTEM-HINT-TEXT
           WHEN 5024 MOVE "Digitare il prezzo di vendita" to 
           TOTEM-HINT-TEXT
           WHEN 5025 MOVE "Digitare la percentuale di sconto sull'acquis
      -    "to" to TOTEM-HINT-TEXT
           WHEN 5026 MOVE "Digitare il prezzo d'acquisto" to 
           TOTEM-HINT-TEXT
           WHEN 5027 MOVE "Digitare la percentuale di sconto per l'agent
      -    "e" to TOTEM-HINT-TEXT
           WHEN 5028 MOVE "Digitare le note" to TOTEM-HINT-TEXT
           WHEN 5029 MOVE "Digitare il codice EAN 1" to TOTEM-HINT-TEXT
           WHEN 5030 MOVE "Digitare il codice EAN 2" to TOTEM-HINT-TEXT
           WHEN 5031 MOVE "Digitare il codice EAN 3" to TOTEM-HINT-TEXT
           WHEN 5032 MOVE "Digitare il codice EAN 4" to TOTEM-HINT-TEXT
           WHEN 5033 MOVE "Digitare il codice EAN 5" to TOTEM-HINT-TEXT
           WHEN 5034 MOVE "Digitare il codice del fornitore" to 
           TOTEM-HINT-TEXT
           WHEN 5035 MOVE "Digitare il percorso della foto" to 
           TOTEM-HINT-TEXT
           WHEN 5036 MOVE "Digitare il percorso della scheda tecnica" 
           to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-codice-BeforeProcedure
           When 5002 PERFORM ef-des-BeforeProcedure
           When 5003 PERFORM Form1-DaEf-1-BeforeProcedure
           When 5004 PERFORM ef-setmerc-BeforeProcedure
           When 5005 PERFORM ef-setmerc-BeforeProcedure
           When 5006 PERFORM ef-marca-BeforeProcedure
           When 5007 PERFORM ef-classe-1-BeforeProcedure
           When 5008 PERFORM ef-classe-2-BeforeProcedure
           When 5009 PERFORM ef-classe-3-BeforeProcedure
           When 5010 PERFORM ef-clase-4-BeforeProcedure
           When 5011 PERFORM ef-udm-BeforeProcedure
           When 5012 PERFORM ef-imballo-BeforeProcedure
           When 5013 PERFORM ef-clase-4-BeforeProcedure
           When 5014 PERFORM ef-dogana-BeforeProcedure
           When 5015 PERFORM cbo-utf-BeforeProcedure
           When 5016 PERFORM ef-peso-utf-BeforeProcedure
           When 5017 PERFORM ef-peso-non-utf-BeforeProcedure
           When 5018 PERFORM chk-utf-BeforeProcedure
           When 5019 PERFORM ef-perce-imposte-BeforeProcedure
           When 5020 PERFORM ef-perce-imposte-BeforeProcedure
           When 5021 PERFORM chk-cobat-BeforeProcedure
           When 5022 PERFORM ef-amperaggio-BeforeProcedure
           When 5023 PERFORM Form1-Cm-1-BeforeProcedure
           When 5024 PERFORM ef-prezzo-vendita-BeforeProcedure
           When 5025 PERFORM ef-sconto-acquisto-BeforeProcedure
           When 5026 PERFORM ef-prezzo-acquisto-BeforeProcedure
           When 5027 PERFORM ef-sconto-agente-BeforeProcedure
           When 5028 PERFORM ef-note-BeforeProcedure
           When 5029 PERFORM ef-ean-1-BeforeProcedure
           When 5030 PERFORM ef-ean-2-BeforeProcedure
           When 5031 PERFORM ef-ean-3-BeforeProcedure
           When 5032 PERFORM ef-ean-4-BeforeProcedure
           When 5033 PERFORM ef-ean-5-BeforeProcedure
           When 5034 PERFORM ef-forn-BeforeProcedure
           When 5035 PERFORM ef-foto-BeforeProcedure
           When 5036 PERFORM ef-scheda-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Form1-AfterProcedure.
           EVALUATE Control-Id
           When 5001 PERFORM ef-codice-AfterProcedure
           When 5002 PERFORM ef-des-AfterProcedure
           When 5003 PERFORM Form1-DaEf-1-AfterProcedure
           When 5004 PERFORM ef-setmerc-AfterProcedure
           When 5005 PERFORM ef-setmerc-AfterProcedure
           When 5006 PERFORM ef-marca-AfterProcedure
           When 5007 PERFORM ef-classe-1-AfterProcedure
           When 5008 PERFORM ef-classe-2-AfterProcedure
           When 5009 PERFORM ef-classe-3-AfterProcedure
           When 5010 PERFORM ef-clase-4-AfterProcedure
           When 5011 PERFORM ef-udm-AfterProcedure
           When 5012 PERFORM ef-imballo-AfterProcedure
           When 5013 PERFORM ef-clase-4-AfterProcedure
           When 5014 PERFORM ef-dogana-AfterProcedure
           When 5016 PERFORM ef-peso-utf-AfterProcedure
           When 5017 PERFORM ef-peso-non-utf-AfterProcedure
           When 5018 PERFORM chk-utf-AfterProcedure
           When 5019 PERFORM ef-perce-imposte-AfterProcedure
           When 5020 PERFORM ef-perce-imposte-AfterProcedure
           When 5021 PERFORM chk-cobat-AfterProcedure
           When 5022 PERFORM ef-amperaggio-AfterProcedure
           When 5024 PERFORM ef-prezzo-vendita-AfterProcedure
           When 5025 PERFORM ef-sconto-acquisto-AfterProcedure
           When 5026 PERFORM ef-prezzo-acquisto-AfterProcedure
           When 5027 PERFORM ef-sconto-agente-AfterProcedure
           When 5028 PERFORM ef-note-AfterProcedure
           When 5029 PERFORM ef-ean-1-AfterProcedure
           When 5030 PERFORM ef-ean-2-AfterProcedure
           When 5031 PERFORM ef-ean-3-AfterProcedure
           When 5032 PERFORM ef-ean-4-AfterProcedure
           When 5033 PERFORM ef-ean-5-AfterProcedure
           When 5034 PERFORM ef-forn-AfterProcedure
           When 5035 PERFORM ef-foto-AfterProcedure
           When 5036 PERFORM ef-scheda-AfterProcedure
           END-EVALUATE
           perform Form1-AFTER-SCREEN
           .

       cbo-utf-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Ntf-Selchange ALSO 5015 ALSO
                    Form1-Handle
              PERFORM cbo-utf-Ev-Ntf-Selchange
           END-EVALUATE
           .

      * USER DEFINE PARAGRAPH
       ABILITAZIONI.
      * <TOTEM:PARA. ABILITAZIONI>
           if mod = 1                  
              move BitmapDeleteEnabled to BitmapNumDelete
              move BitmapSaveEnabled   to BitmapNumSave
              move 1 to e-salva
                                 
              move 0 to mod-campi 
                        mod-imposte 
                        mod-cobat

              move 1 to mod-campi

              if chk-imposte-buf = 1
                 move 1 to mod-imposte
              end-if

              if chk-cobat-buf = 1
                 move 1 to mod-cobat
              end-if  

           else         

              move BitmapDeleteDisabled to BitmapNumDelete
              move BitmapSaveDisabled   to BitmapNumSave
              move 0 to e-salva
              move 0 to mod-campi 
                        mod-imposte 
                        mod-cobat 
           end-if.            

      * ISACCO (CORREZIONE SU LIVELLO ABILITAZIONE 2) - 10/11/2003
      * (CANCELLAZIONE NON PERMESSA)
           if link-insart-abil = 2 
              move BitmapDeleteDisabled to BitmapNumDelete
           end-if.
      * FINE

           modify tool-salva,    enabled = e-salva.
       
      * ISACCO (SERVE SEMPRE PER LA MODIFICA PRCEDENTE E PER RIPRISTINARE
      * LE BITMAP DISABILITATE. - 10/11/2003
      *     perform FORM1-DISPLAY.
           display tool-salva, tool-modifica.
      * FINE 
           .
      * <TOTEM:END>

       ANTEPRIMA.
      * <TOTEM:PARA. ANTEPRIMA>
           SET ANTEPRIMA     TO TRUE 
           .
      * <TOTEM:END>

       CERCA.
      * <TOTEM:PARA. CERCA>
           evaluate control-id
      
           when 78-ID-ef-mag
                move "tmagaz"       to como-file         
                inquire ef-mag,  value in mag-codice
                call "zoom-gt"   using como-file, mag-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move mag-codice      to ef-mag-buf
                   move mag-descrizione to lab-mag-buf
                   display ef-mag lab-mag
                end-if        
      
           when 78-ID-ef-marca
                move "tmarche"     to como-file         
                inquire ef-marca,    value in mar-codice
                call "zoom-gt"   using como-file, mar-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move mar-codice to ef-marca-buf
                   move mar-descrizione to lab-marca-buf
                   display ef-marca lab-marca
                end-if          
      
           when 78-ID-ef-iva                
                move "tivaese-non"  to como-file
                move "IV"           to tbliv-codice1
                inquire ef-iva,  value tbliv-codice2
                call "zoom-gt"   using como-file, record-tbliv
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move tbliv-codice2   to ef-iva-buf
                   initialize lab-iva-buf
                   inspect tbliv-descrizione1 replacing trailing 
                                                 spaces by low-value
                   string  tbliv-descrizione1 delimited by low-value
                           " "                delimited by size
                           tbliv-descrizione2 delimited by size
                           into lab-iva-buf
                   end-string
                   display ef-iva lab-iva
                end-if
      
           when 78-ID-ef-classe-1
                move "tcla1art"  to como-file         
                inquire ef-classe-1, value in cl1-codice
                call "zoom-gt"   using como-file, cl1-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move cl1-codice      to ef-classe-1-buf
                   move cl1-descrizione to lab-classe-buf
                   display ef-classe-1 lab-classe
                end-if
      
           when 78-ID-ef-udm
                move "tudm"  to como-file         
                inquire ef-udm,    value in udm-codice
                call "zoom-gt"   using como-file, udm-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move udm-codice      to ef-udm-buf
                   move udm-descrizione to lab-udm-buf
                   display ef-udm lab-udm
                end-if
      
           when 78-ID-ef-setmerc
                move "tsetmerc"  to como-file         
                inquire ef-setmerc, value in sme-codice
                call "zoom-gt"   using como-file, sme-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move sme-codice      to ef-setmerc-buf
                   move sme-descrizione to lab-setmerc-buf
                   display ef-setmerc lab-setmerc
                end-if  
      
           when 78-ID-ef-imballo
                move "timbalqta"  to como-file         
                inquire ef-imballo, value in imq-codice
                call "zoom-gt"   using como-file, imq-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move imq-codice       to ef-imballo-buf
                   move imq-tipo         to imb-codice
                   read timballi no lock invalid continue end-read
                   perform DESCRIZIONE-IMBALLO
                   display ef-imballo lab-imballo
                end-if                           
      
           when 78-ID-ef-forn
                set cli-tipo-F to true
                inquire ef-forn, value in cli-codice
                move "clienti-CF-all"   to como-file
                call "zoom-gt"   using como-file, cli-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move cli-codice   to ef-forn-buf
                   move cli-ragsoc-1 to lab-forn-buf
                   display ef-forn lab-forn
                end-if
      
           when 78-ID-ef-dogana
                move "tnomen"  to como-file         
                inquire ef-dogana, value in nom-codice
                call "zoom-gt"   using como-file, nom-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move nom-codice      to ef-dogana-buf
                   move nom-descrizione to lab-dogana-buf
                   display ef-dogana lab-dogana
                end-if
      
           end-evaluate  
           .
      * <TOTEM:END>

       CHECK-INSERIMENTO.
      * <TOTEM:PARA. CHECK-INSERIMENTO>
      * modifica la status-bar
      * controllo se da inserimento scorro. allora devo segnalare che
      * sono tornato in modifica.
           inquire tool-modifica, value in mod.

           evaluate mod
           when 1
                set StatusModifica to true
           when 0
                set StatusVisua to true   
           end-evaluate.
      
           perform STATUS-BAR-MSG 
           .
      * <TOTEM:END>

       CONTROLLO.
      * <TOTEM:PARA. CONTROLLO>
           set tutto-ok to true.

      * Paragrafo per la struttura dei controlli sulla screen Form1
           evaluate CONTROL-ID
           |78-ID-ef-codice è l'ID del control ef-codice
           when 78-ID-ef-codice
                perform RIEMPI-CHIAVE
                if ef-codice-buf not = spaces
                   inspect ef-codice-buf replacing trailing spaces 
                                                         by low-values
                   initialize CountChar
                   inspect ef-codice-buf tallying CountChar 
                                         for characters before low-value
                   inspect ef-codice-buf replacing trailing low-values 
                                                         by spaces
                else
                   set errori to true  
                   move 78-ID-ef-codice to CONTROL-ID
                   display message box "Inserimento codice mancante"
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if

           |78-ID-ef-des è l'ID del control ef-des
           when 78-ID-ef-des
                inquire ef-des, value in ef-des-buf
                if ef-des-buf = spaces
                   set errori to true
                   move 78-ID-ef-des to CONTROL-ID
                   display message box "Inserimento descrizione mancante
      -    ""
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if
                move ef-des-buf to lab-des-buf
                display lab-des

           |78-ID-ef-mag è l'ID del control ef-mag
           when 78-ID-ef-mag
                inquire ef-mag, value in ef-mag-buf
                move ef-mag-buf to mag-codice
                read tmagaz no lock
                     invalid
                     set errori to true
                     display message "Codice Magazzino Non valido"
                               title tit-err
                                icon 2
                     move 78-ID-ef-mag to control-id
                     move spaces to lab-mag-buf
                end-read
                move mag-descrizione to lab-mag-buf
                display lab-mag

           |78-ID-ef-setmerc è l'ID del control ef-setmerc
           when 78-ID-ef-setmerc
                inquire ef-setmerc, value in ef-setmerc-buf        
                move ef-setmerc-buf to art-settore-merceologico
                move "tsetmerc" to nome-file
                perform RELAZIONI-ARTICOLI
                if not trovato
      *             if art-settore-merceologico not = 0
                      set errori to true
                      move 78-ID-ef-setmerc to control-id
                      display message box "Settore merceologico NON vali
      -    "do"
                              title = tit-err
                              icon MB-WARNING-ICON
      *             end-if
                end-if

           |78-ID-ef-marca è l'ID del control ef-marca
           when 78-ID-ef-marca
                inquire ef-marca, value in ef-marca-buf        
                move "tmarche" to nome-file
                perform RELAZIONI-ARTICOLI
                if not trovato
                   set errori to true
                   move 78-ID-ef-marca to CONTROL-ID
                   display message box "Codice marca NON valido"
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if

           |78-ID-ef-iva è l'ID del control ef-iva
           when 78-ID-ef-iva
                inquire ef-iva, value in ef-iva-buf
                move "tivaese" to nome-file
                perform RELAZIONI-ARTICOLI
                if not trovato
                   set errori to true
                   move 78-ID-ef-iva to CONTROL-ID
                   display message box "Codice IVA NON valido"
                           title = tit-err
                           icon MB-WARNING-ICON
                else
                   if tbliv-percentuale = 0    
                      set errori to true
                      move 78-ID-ef-iva to CONTROL-ID
                      display message box "Codice IVA NON valido in"
                                          " quanto senza aliquota"
                              title = tit-err
                              icon MB-WARNING-ICON
                   else   
                      if ef-iva-buf not = CodiceIvaStd
                         display message "Confermi il codice IVA inserit
      -    "o?"
                                  x"0d0a""Codice Standard: ", 
           CodiceIvaStd
                                 title titolo
                                  type mb-yes-no
                                giving scelta
                         if scelta = mb-no
                            set errori to true
                            move 78-ID-ef-iva to control-id
                         end-if
                      end-if
                   end-if
                end-if

           |78-ID-ef-classe-1 è l'ID del control ef-classe-1
           when 78-ID-ef-classe-1
                inquire ef-classe-1, value in ef-classe-1-buf        
                move "tcla1art" to nome-file
                perform RELAZIONI-ARTICOLI
                if not trovato
                   set errori to true
                   move 78-ID-ef-classe-1 to CONTROL-ID
                   display message box "Classe NON valida"
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if

           |78-ID-ef-udm è l'ID del control ef-udm
           when 78-ID-ef-udm
                inquire ef-udm, value in ef-udm-buf        
                move "tudm" to nome-file
                perform RELAZIONI-ARTICOLI
                if not trovato
                   set errori to true
                   move 78-ID-ef-udm to CONTROL-ID
                   display message box "Unità di misura NON valida"
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if  

           |78-ID-ef-imballo è l'ID del control ef-imballo
           when 78-ID-ef-imballo
                inquire ef-imballo, value in ef-imballo-buf
                move ef-imballo-buf       to art-imballo-standard
                move "timbalqta"          to nome-file
                perform RELAZIONI-ARTICOLI
                if not trovato
                   set errori to true
                   move 78-ID-ef-imballo to control-id
                   display message box "Codice d'imballo NON valido"
                           title = tit-err
                           icon mb-warning-icon
                end-if 

           |78-ID-ef-udm-imballo è l'ID del control ef-udm-imballo
           when 78-ID-ef-udm-imballo
                inquire ef-udm-imballo, value in ef-udm-imballo-buf
                if ef-udm-imballo-buf = spaces
                   set errori to true
                   move 78-ID-ef-udm-imballo to CONTROL-ID
                   display message "U.d.m. per imballo obbligatoria"
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if

           |78-ID-ef-dogana è l'ID del control ef-dogana
           when 78-ID-ef-dogana
                inquire ef-dogana, value in ef-dogana-buf        
                move ef-dogana-buf to art-cod-doganale
                move "tnomen" to nome-file
                perform RELAZIONI-ARTICOLI
                if not trovato
                   set errori to true
                   move 78-ID-ef-dogana to CONTROL-ID
                   display message box "Codice doganale NON valido"
                           title = tit-err
                           icon MB-WARNING-ICON
                else
                   evaluate true
                   when nom-si-utf 
                        if mod-peso-utf = 0 |ho cambiato lo stato
                           modify cbo-utf, reset-list = 1
                           perform RIEMPI-COMBO-UTF
                           set soggetto to true
                           perform CARICA-COMBO-UTF 
                           move 0 to mod-peso-non-utf
                        end-if
                        move 1 to mod-peso-utf
                   when nom-no-utf 
                        if mod-peso-utf = 1 |ho cambiato lo stato
                           modify cbo-utf, reset-list = 1
                           perform RIEMPI-COMBO-NON-UTF
                           set non-soggetto to true
                           perform CARICA-COMBO-UTF
                        end-if
                        move 0 to mod-peso-utf
                        move 1 to mod-peso-non-utf
                   end-evaluate

                   evaluate true
                   when nom-si-cobat move 1 to mod-cobat
                   when nom-no-cobat move 0 to mod-cobat
                                     move 0 to ef-amperaggio-buf
                   end-evaluate 

                   evaluate true
                   when nom-si-ic-cou move 1 to mod-imposte
                   when nom-no-ic-cou move 0 to mod-imposte
                   end-evaluate

                   if mod-peso-utf = 0
                      move 0 to ef-peso-utf-buf
                   end-if
                   if mod-peso-non-utf = 0
                      move 0 to ef-peso-non-utf-buf
                   end-if

                   if mod-imposte = 1
                      inquire ef-perce-imposte, value art-perce-imposte
                      if art-perce-imposte = 0
                         move 100 to ef-perce-imposte-buf
                      end-if         
                      inquire ef-perce-cou,     value art-perce-cou
                      if art-perce-cou = 0
                         move 100 to ef-perce-cou-buf
                      end-if
                   else
                      move 0 to ef-perce-imposte-buf
                                ef-perce-cou-buf
                   end-if

                   display ef-peso-utf      ef-peso-non-utf
                           ef-perce-imposte ef-perce-cou
                           ef-amperaggio    cbo-cobat
                end-if

           |78-ID-cbo-utf è l'ID del control ef-peso-utf
           when 78-ID-cbo-utf
                perform SCARICA-COMBO-UTF
                evaluate true
                when soggetto     move 1 to mod-peso-utf
                                  move 0 to mod-peso-non-utf
                                  move 0 to ef-peso-non-utf-buf
                when misto        move 1 to mod-peso-utf
                                  move 1 to mod-peso-non-utf
                when non-soggetto move 0 to mod-peso-utf
                                  move 1 to mod-peso-non-utf   
                                  move 0 to ef-peso-utf-buf
                end-evaluate
                display ef-peso-utf ef-peso-non-utf

           |78-ID-ef-peso-utf è l'ID del control ef-peso-utf
           when 78-ID-ef-peso-utf
                inquire ef-peso-utf, value in ef-peso-utf-buf
                move ef-peso-utf-buf to art-peso-utf
                if art-peso-utf = 0 and mod-peso-utf = 1
                   set errori to true
                   move 78-ID-ef-peso-utf to CONTROL-ID
                   display message box "Inserimento peso UTF mancante"
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if

           |78-ID-ef-peso-non-utf è l'ID del control ef-peso-non-utf
           when 78-ID-ef-peso-non-utf
                inquire ef-peso-non-utf, value in ef-peso-non-utf-buf
                move ef-peso-non-utf-buf to art-peso-non-utf
                if art-peso-non-utf = 0 and mod-peso-non-utf = 1
                   set errori to true
                   move 78-ID-ef-peso-non-utf to CONTROL-ID
                   display message box "Inserimento peso non UTF mancant
      -    "e"
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if

           |78-ID-ef-perce-imposte è l'ID del control ef-perce-imposte
           when 78-ID-ef-perce-imposte
                inquire ef-perce-imposte, value in ef-perce-imposte-buf
                move ef-perce-imposte-buf to art-perce-imposte
                if art-perce-imposte = 0 and mod-imposte = 1
                   set errori to true
                   move 78-ID-ef-perce-imposte to CONTROL-ID
                   display message box "Inserimento percentuale imposte 
      -    "mancante"
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if 
                                  
           when 78-ID-ef-perce-cou
                inquire ef-perce-cou, value in ef-perce-cou-buf
                move ef-perce-cou-buf to art-perce-cou
                if art-perce-cou = 0 and mod-imposte = 1       
                   set errori to true
                   move 78-ID-ef-perce-cou to control-id
                   display message box "Inserimento percentuale COU manc
      -    "ante"
                           title = tit-err
                           icon mb-warning-icon
                end-if

           |78-ID-ef-amperaggio è l'ID del control ef-amperaggio
           when 78-ID-ef-amperaggio
                inquire ef-amperaggio, value in ef-amperaggio-buf
                move ef-amperaggio-buf to art-amperaggio
                if art-amperaggio = 0 and mod-cobat = 1       
                   set errori to true
                   move 78-ID-ef-amperaggio to CONTROL-ID
                   display message box "Inserimento amperaggio mancante"
                           title = tit-err
                           icon MB-WARNING-ICON
                end-if

           |78-ID-ef-forn è l'ID del control ef-forn
           when 78-ID-ef-forn
                inquire ef-forn, value in ef-forn-buf
                move ef-forn-buf to cli-codice
                move spaces      to lab-forn-buf
                if cli-codice not = 0
                   move "fornitori" to nome-file
                   perform RELAZIONI-ARTICOLI
                   if not trovato
                      set errori to true
                      move 78-ID-ef-forn to CONTROL-ID
                      display message box "Fornitore NON valido"
                              title = tit-err
                              icon MB-WARNING-ICON
                   end-if
                end-if

           end-evaluate.


           if errori
              perform CANCELLA-COLORE
              move CONTROL-ID to store-id
              move 4          to ACCEPT-CONTROL
           end-if 
           .
      * <TOTEM:END>

       DESCRIZIONE-IMBALLO.
      * <TOTEM:PARA. DESCRIZIONE-IMBALLO>
           initialize lab-imballo-buf.
           inspect imb-descrizione replacing trailing spaces 
                                   by low-value.
           move imq-qta-imb to qta-x.
           inspect qta-x replacing leading x"30" by x"20".
           call "C$JUSTIFY" using qta-x, "L".
           inspect qta-x replacing trailing spaces by low-value.
           string imb-descrizione delimited by low-value
                  " da "          delimited by size
                  qta-x           delimited by low-value
                  into lab-imballo-buf
           end-string 
           .
      * <TOTEM:END>

       INIT.
      * <TOTEM:PARA. INIT>
           move 0 to StatusHelp. 
           move 1 to mod-k.
           set StatusVisua to true.

           |Riempio il tabellino contenente i riferimenti agli ID
           |relativi ad ogni pagina del tab-control
           |specifico per i pgm. aventi Tab-Control
           move 78-ID-ef-des            to min-id(1).
           move 78-ID-ef-scheda         to max-id(1).
      *     move 78-ID-form1-gd-1        to min-id(2).
      *     move 78-ID-ef-note-4         to max-id(2).
           |*******

           Perform RIEMPI-COMBO-UTF.
           Perform RIEMPI-COMBO-COBAT.

           move "Soggetto" to cbo-utf-buf.
           Modify  cbo-utf,   value cbo-utf-buf.

           move "Auto" to cbo-cobat-buf.
           Modify  cbo-cobat,   value cbo-cobat-buf 
           .
      * <TOTEM:END>

       NUOVO.
      * <TOTEM:PARA. NUOVO>
           |specifico per i pgm. aventi Tab-Control
           move 1 to Screen1-Ta-1-TAB-VALUE.
           perform SCREEN1-TA-1-TABCHANGE.
           |******          
           move 78-ID-ef-codice to CONTROL-ID.
           move 4 to ACCEPT-CONTROL .
           move 1 to mod, mod-k.
           modify tool-modifica,  value = mod.
           perform CANCELLA-COLORE.
           perform FORM1-CLEAR.

           perform VALORIZZA-NUOVO.
           
           set non-soggetto to true.
           perform CARICA-COMBO-UTF.

           set auto-w to true.
           perform CARICA-COMBO-COBAT.

           move 1 to mod-campi,   mod-peso-non-utf.
           move 0 to mod-imposte, mod-cobat, mod-peso-utf.

           display form1.

           set StatusIns to true.
           perform STATUS-BAR-MSG.
           unlock articoli all records 
           .
      * <TOTEM:END>

       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "riempi-combo-utf.cpy".
           copy "riempi-combo-cobat.cpy".
           copy "color-custom.cpy".
           copy "status.cpy" 
           .
      * <TOTEM:END>

       RELATIONS.
      * <TOTEM:PARA. RELATIONS>
           set trovato to true.

           evaluate nome-file
           when "tsetmerc"   perform READ-TSETMERC
           when "tmarche"    perform READ-TMARCHE
           when "tcla1art"   perform READ-TCLA1ART
           when "tivaese"    perform READ-TIVAESE
           when "tnomen"     perform READ-TNOMEN
           when "tudm"       perform READ-TUDM  
           when "timbalqta"  perform READ-TIMBALQTA
           when "fornitori"  perform READ-FORNITORI
           end-evaluate.

      ***---
       READ-TSETMERC.
           read tsetmerc no lock
                invalid move spaces to sme-descrizione
                        set trovato to false
           end-read.
       
      ***---
       READ-TMARCHE. 
           read tmarche no lock
                invalid move spaces to mar-descrizione
                        set trovato to false
           end-read.
       
      ***---
       READ-TCLA1ART.
           read tcla1art no lock
                invalid move spaces to cl1-descrizione
                        set trovato to false
           end-read.
       
      ***---
       READ-TIVAESE.
           read tivaese no lock
                invalid move spaces to tbliv-descrizione1
                        set trovato to false
           end-read.
       
      ***---
       READ-TNOMEN.  
           read tnomen no lock
                invalid move spaces to nom-descrizione
                        set trovato to false
           end-read.
       
      ***---
       READ-TUDM.    
           read tudm no lock
                invalid move spaces to udm-descrizione
                        set trovato to false
           end-read.
       
      ***---
       READ-FORNITORI.    
           read clienti no lock
                invalid move spaces to cli-ragsoc-1
                        set trovato to false
           end-read.

      ***---
       READ-TIMBALQTA.    
           read timbalqta no lock
                invalid 
                initialize imb-descrizione
                set trovato to false
            not invalid
                move imq-tipo  to imb-codice
                read timballi
                     invalid initialize imb-descrizione
                 not invalid perform DESCRIZIONE-IMBALLO
                end-read
           end-read 
           .
      * <TOTEM:END>

       RELAZIONI-ARTICOLI.
      * <TOTEM:PARA. RELAZIONI-ARTICOLI>
           set trovato to false.
      
           evaluate nome-file
           when "tsetmerc"  
                move spaces to lab-setmerc-buf
                move ef-setmerc-buf to sme-codice
                perform RELATIONS
                move sme-descrizione to lab-setmerc-buf
                display lab-setmerc
           when "tmarche"
                move spaces to lab-marca-buf
                move ef-marca-buf to mar-codice
                if mar-codice not = 0
                   perform RELATIONS
                   move mar-descrizione to lab-marca-buf
                end-if
                display lab-marca
           when "tcla1art"                
                move spaces to lab-classe-buf
                move ef-classe-1-buf to cl1-codice
                if cl1-codice not = 0
                   perform RELATIONS
                   move cl1-descrizione to lab-classe-buf
                end-if
                display lab-classe
           when "tivaese"
                initialize lab-iva-buf
                move "IV"       to tbliv-codice1
                move ef-iva-buf to tbliv-codice2
                perform RELATIONS
                if trovato
                   inspect tbliv-descrizione1 replacing   trailing
                                                spaces by low-value
                   string tbliv-descrizione1 delimited by low-value
                          " "                delimited by size
                          tbliv-descrizione2 delimited by size
                          into lab-iva-buf
                   end-string
                end-if
                display lab-iva
           when "tnomen"
                move spaces to lab-dogana-buf
                move ef-dogana-buf to nom-codice
                perform RELATIONS
                move nom-descrizione to lab-dogana-buf

                evaluate true
                when nom-si-ic-cou 
                     set art-si-imposte to true
                     move 1    to chk-imposte-buf
                when nom-no-ic-cou 
                     set art-no-imposte to true
                     move 0 to chk-imposte-buf
                end-evaluate

                evaluate true
                when nom-si-cobat 
                     set art-si-cobat   to true
                     move 1    to chk-cobat-buf
                when nom-no-cobat 
                     set art-no-cobat   to true
                     move 0 to chk-cobat-buf
                end-evaluate

                if mod = 1
                   if chk-imposte-buf = 1
                      move 1 to mod-imposte
                   else
                      move 0 to mod-imposte                    
                   end-if
                   if chk-cobat-buf = 1
                      move 1 to mod-cobat
                   else
                      move 0 to mod-cobat
                   end-if
                end-if
                display lab-dogana, chk-imposte, chk-cobat, ef-perce-cou
                        ef-amperaggio, ef-perce-imposte, cbo-cobat

           when "tudm"
                move spaces to lab-udm-buf
                move ef-udm-buf to udm-codice
                if udm-codice not = space
                   perform RELATIONS
                   move udm-descrizione to lab-udm-buf
                end-if
                display lab-udm                                   

           when "fornitori"
                move spaces      to lab-forn-buf
                set cli-tipo-F   to true
                move ef-forn-buf to cli-codice
                if cli-codice not = 0
                   perform RELATIONS
                   move cli-ragsoc-1 to lab-forn-buf
                end-if
                display lab-forn
   
           when "timbalqta"
                move ef-imballo-buf to imq-codice
                if imq-codice not = space
                   perform RELATIONS
                   if trovato perform DESCRIZIONE-IMBALLO
                   else       initialize lab-imballo-buf
                   end-if
                end-if
                display lab-imballo
           when "tparamge"
                move spaces to tge-codice
                read tparamge no lock  
                   invalid
                      continue
                   not invalid  
                      move tge-cod-iva-std to CodiceIvaStd
                end-read
           end-evaluate 
           .
      * <TOTEM:END>

       RIEMPI-CHIAVE.
      * <TOTEM:PARA. RIEMPI-CHIAVE>
           move ef-codice-buf to art-codice with convert 
           .
      * <TOTEM:END>

       SALVA.
      * <TOTEM:PARA. SALVA>
           if MOD = zero exit paragraph end-if.

           set tutto-ok to true.

           perform varying control-id from 78-ID-ef-codice by 1
                     until control-id > 78-ID-ef-scheda
              perform CONTROLLO
              if errori 
                 exit perform 
              end-if
           end-perform.

           if errori
              perform CANCELLA-COLORE
              |controllo che l'errore sia sulla pagina corrente
              |specifico per i pgm. aventi Tab-Control
              inquire Screen1-Ta-1, value in pagina
              if store-id > min-id(pagina) and
                 store-id < max-id(pagina)
                 move store-id to CONTROL-ID
              end-if
              |******
              move 4 to accept-control
           else
              perform FORM1-BUF-TO-FLD
              perform CANCELLA-COLORE

              accept como-ora from time
              if nuovo
                 move data-oggi to art-data-creazione
                 move como-ora  to art-ora-creazione
                 move link-insart-user to art-utente-creazione   
              else
                 move data-oggi to art-data-ultima-modifica
                 move como-ora  to art-ora-ultima-modifica
                 move link-insart-user to art-utente-ultima-modifica
              end-if          
                                      
              evaluate true
              when soggetto     
                   move 0 to art-peso-non-utf ef-peso-non-utf-buf
              when non-soggetto 
                   move 0 to art-peso-utf     ef-peso-utf-buf
              end-evaluate            
              add art-peso-utf to art-peso-non-utf 
                           giving art-peso-standard

              set link-batch to true
              perform SCRIVI-PROGMAG

              if art-no-imposte 
                 move 0 to art-perce-imposte ef-perce-imposte-buf
              end-if

              if art-no-cobat
                 move 0   to art-amperaggio ef-amperaggio-buf
                 if art-moto-cobat
                    set art-auto-cobat to true
                    set auto-w         to true
                    perform CARICA-COMBO-COBAT
                 end-if
              end-if
              set art-attivo to true
              write art-rec invalid rewrite art-rec end-write

              move ef-mag-buf           to link-insart-mag
              move art-imballo-standard to link-insart-imballo
              move art-codice           to link-insart-codice

              set vecchio to true
              move  0 to link-insart-status
              move 27 to key-status
           end-if.
                    
           display form1 
           .
      * <TOTEM:END>

       SCRIVI-PROGMAG.
      * <TOTEM:PARA. SCRIVI-PROGMAG>
           inquire ef-codice,      value in link-articolo.
           move lab-des-buf to link-des-articolo.
           inquire ef-imballo,     value in link-imballo
           inquire ef-mag,         value in link-magazzino.
           inquire ef-peso-utf     value in link-utf.
           inquire ef-peso-non-utf value in link-non-utf.
           add link-utf to link-non-utf giving link-peso.
           move link-insart-user to link-user of link-wprogmag.
           call   "wprogmag" using link-wprogmag.
           cancel "wprogmag" 
           .
      * <TOTEM:END>

       VALORIZZA-NUOVO.
      * <TOTEM:PARA. VALORIZZA-NUOVO>
           move high-value to art-codice.
           start articoli key <= art-codice
              invalid     move 1 to art-codice
              not invalid
                 read articoli previous with no lock
                      at end   move 1 to art-codice
                  not at end   add  1 to art-codice
                 end-read
           end-start.
           move "00" to status-articoli.  

           initialize art-dati replacing numeric data by zeroes
                                    alphanumeric data by spaces.
                                    
           move CodiceIvaStd to art-codice-iva

           perform FORM1-FLD-TO-BUF.

           set nuovo to true.  

           modify cbo-utf, reset-list = 1.
           perform RIEMPI-COMBO-NON-UTF.

           initialize lab-imballo-buf.

           perform FORM1-DISPLAY 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       anagr01-Ev-Before-Program.
      * <TOTEM:PARA. anagr01-Ev-Before-Program>
           |SOLO AL SALVATAGGIO DIVENTA ZERO CIOE' OK
           move -1 to link-insart-status 
           .
      * <TOTEM:END>
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD           

           INQUIRE TOOL-SALVA, ENABLED IN E-SALVA
           IF E-SALVA = 1
              PERFORM SALVA
           END-IF           
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
           INQUIRE TOOL-MODIFICA, ENABLED IN E-MODIFICA 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca
           if e-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       ef-codice-BeforeProcedure.
      * <TOTEM:PARA. ef-codice-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU

           .
      * <TOTEM:END>

       ef-codice-AfterProcedure.
      * <TOTEM:PARA. ef-codice-AfterProcedure>
              INQUIRE ef-codice, VALUE IN art-codice
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codice-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-des-BeforeProcedure.
      * <TOTEM:PARA. ef-des-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-setmerc-BeforeProcedure.
      * <TOTEM:PARA. ef-setmerc-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-marca-BeforeProcedure.
      * <TOTEM:PARA. ef-marca-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-classe-1-BeforeProcedure.
      * <TOTEM:PARA. ef-classe-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-classe-2-BeforeProcedure.
      * <TOTEM:PARA. ef-classe-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-classe-3-BeforeProcedure.
      * <TOTEM:PARA. ef-classe-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-clase-4-BeforeProcedure.
      * <TOTEM:PARA. ef-clase-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-udm-BeforeProcedure.
      * <TOTEM:PARA. ef-udm-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-forn-BeforeProcedure.
      * <TOTEM:PARA. ef-forn-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-peso-utf-BeforeProcedure.
      * <TOTEM:PARA. ef-peso-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-peso-non-utf-BeforeProcedure.
      * <TOTEM:PARA. ef-peso-non-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-imballo-BeforeProcedure.
      * <TOTEM:PARA. ef-imballo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-prezzo-vendita-BeforeProcedure.
      * <TOTEM:PARA. ef-prezzo-vendita-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-sconto-agente-BeforeProcedure.
      * <TOTEM:PARA. ef-sconto-agente-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-prezzo-acquisto-BeforeProcedure.
      * <TOTEM:PARA. ef-prezzo-acquisto-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-sconto-acquisto-BeforeProcedure.
      * <TOTEM:PARA. ef-sconto-acquisto-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-dogana-BeforeProcedure.
      * <TOTEM:PARA. ef-dogana-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-perce-imposte-BeforeProcedure.
      * <TOTEM:PARA. ef-perce-imposte-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-amperaggio-BeforeProcedure.
      * <TOTEM:PARA. ef-amperaggio-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-BeforeProcedure.
      * <TOTEM:PARA. ef-note-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-1-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-2-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-3-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-4-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ean-5-BeforeProcedure.
      * <TOTEM:PARA. ef-ean-5-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-foto-BeforeProcedure.
      * <TOTEM:PARA. ef-foto-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-scheda-BeforeProcedure.
      * <TOTEM:PARA. ef-scheda-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-des-AfterProcedure.
      * <TOTEM:PARA. ef-des-AfterProcedure>
              INQUIRE ef-des, VALUE IN art-descrizione
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-setmerc-AfterProcedure.
      * <TOTEM:PARA. ef-setmerc-AfterProcedure>
              INQUIRE ef-setmerc, VALUE IN art-settore-merceologico
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-setmerc-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-iva, VALUE IN art-codice-iva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-iva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-marca-AfterProcedure.
      * <TOTEM:PARA. ef-marca-AfterProcedure>
              INQUIRE ef-marca, VALUE IN art-marca-prodotto
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-marca-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-classe-1-AfterProcedure.
      * <TOTEM:PARA. ef-classe-1-AfterProcedure>
              INQUIRE ef-classe-1, VALUE IN art-classe-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-classe-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-classe-2-AfterProcedure.
      * <TOTEM:PARA. ef-classe-2-AfterProcedure>
              INQUIRE ef-classe-2, VALUE IN art-classe-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-classe-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-classe-3-AfterProcedure.
      * <TOTEM:PARA. ef-classe-3-AfterProcedure>
              INQUIRE ef-classe-3, VALUE IN art-classe-3
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-classe-3-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-clase-4-AfterProcedure.
      * <TOTEM:PARA. ef-clase-4-AfterProcedure>
              INQUIRE ef-clase-4, VALUE IN art-classe-4
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-clase-4-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-udm-imballo, VALUE IN art-udm-imballo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-udm-imballo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-udm-AfterProcedure.
      * <TOTEM:PARA. ef-udm-AfterProcedure>
              INQUIRE ef-udm, VALUE IN art-unita-di-misura
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-udm-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-forn-AfterProcedure.
      * <TOTEM:PARA. ef-forn-AfterProcedure>
              INQUIRE ef-forn, VALUE IN art-cod-fornitore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-forn-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-peso-utf-AfterProcedure.
      * <TOTEM:PARA. ef-peso-utf-AfterProcedure>
              INQUIRE ef-peso-utf, VALUE IN art-peso-utf
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-peso-utf-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-peso-non-utf-AfterProcedure.
      * <TOTEM:PARA. ef-peso-non-utf-AfterProcedure>
              INQUIRE ef-peso-non-utf, VALUE IN art-peso-non-utf
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-peso-non-utf-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-imballo-AfterProcedure.
      * <TOTEM:PARA. ef-imballo-AfterProcedure>
              INQUIRE ef-imballo, VALUE IN art-imballo-standard
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-imballo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-prezzo-vendita-AfterProcedure.
      * <TOTEM:PARA. ef-prezzo-vendita-AfterProcedure>
              INQUIRE ef-prezzo-vendita, VALUE IN art-prezzo-acquisto
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prezzo-vendita-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sconto-agente-AfterProcedure.
      * <TOTEM:PARA. ef-sconto-agente-AfterProcedure>
              INQUIRE ef-sconto-agente, VALUE IN art-perce-sconto-agente
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-agente-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-prezzo-acquisto-AfterProcedure.
      * <TOTEM:PARA. ef-prezzo-acquisto-AfterProcedure>
              INQUIRE ef-prezzo-acquisto, VALUE IN art-prezzo-vendita
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prezzo-acquisto-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sconto-acquisto-AfterProcedure.
      * <TOTEM:PARA. ef-sconto-acquisto-AfterProcedure>
              INQUIRE ef-sconto-acquisto, VALUE IN 
           art-perce-sconto-acquisto
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-acquisto-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-dogana-AfterProcedure.
      * <TOTEM:PARA. ef-dogana-AfterProcedure>
              INQUIRE ef-dogana, VALUE IN art-cod-doganale
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-dogana-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-perce-imposte-AfterProcedure.
      * <TOTEM:PARA. ef-perce-imposte-AfterProcedure>
              INQUIRE ef-perce-imposte, VALUE IN art-perce-imposte
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-perce-imposte-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-perce-cou, VALUE IN art-perce-cou
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-perce-cou-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-amperaggio-AfterProcedure.
      * <TOTEM:PARA. ef-amperaggio-AfterProcedure>
              INQUIRE ef-amperaggio, VALUE IN art-amperaggio
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-amperaggio-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-AfterProcedure.
      * <TOTEM:PARA. ef-note-AfterProcedure>
              INQUIRE ef-note, VALUE IN art-note
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-1-AfterProcedure.
      * <TOTEM:PARA. ef-ean-1-AfterProcedure>
              INQUIRE ef-ean-1, VALUE IN art-codice-ean-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-2-AfterProcedure.
      * <TOTEM:PARA. ef-ean-2-AfterProcedure>
              INQUIRE ef-ean-2, VALUE IN art-codice-ean-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-3-AfterProcedure.
      * <TOTEM:PARA. ef-ean-3-AfterProcedure>
              INQUIRE ef-ean-3, VALUE IN art-codice-ean-3
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-3-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-4-AfterProcedure.
      * <TOTEM:PARA. ef-ean-4-AfterProcedure>
              INQUIRE ef-ean-4, VALUE IN art-codice-ean-4
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-4-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-ean-5-AfterProcedure.
      * <TOTEM:PARA. ef-ean-5-AfterProcedure>
              INQUIRE ef-ean-5, VALUE IN art-codice-ean-5
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ean-5-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-foto-AfterProcedure.
      * <TOTEM:PARA. ef-foto-AfterProcedure>
              INQUIRE ef-foto, VALUE IN art-foto
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-foto-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-scheda-AfterProcedure.
      * <TOTEM:PARA. ef-scheda-AfterProcedure>
              INQUIRE ef-scheda, VALUE IN art-scheda-tecnica
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-scheda-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       cbo-utf-BeforeProcedure.
      * <TOTEM:PARA. cbo-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cbo-utf-AfterProcedure.
      * <TOTEM:PARA. cbo-utf-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-utf-BeforeProcedure.
      * <TOTEM:PARA. chk-utf-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-utf-AfterProcedure.
      * <TOTEM:PARA. chk-utf-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       Form1-Cm-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-Cm-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-Cm-1-AfterProcedure.
      * <TOTEM:PARA. Form1-Cm-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-cobat-BeforeProcedure.
      * <TOTEM:PARA. chk-cobat-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-cobat-AfterProcedure.
      * <TOTEM:PARA. chk-cobat-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-imposte-LinkTo.
      * <TOTEM:PARA. chk-imposte-LinkTo>
      *     move chk-imposte-buf to mod-imposte.
      *     display ef-perce-imposte.

           inquire chk-imposte, value chk-imposte-buf.

           if chk-imposte-buf = 1
              move ZERO to chk-cobat-buf, mod-cobat
              perform CANCELLA-COLORE
              display chk-cobat, ef-amperaggio, cbo-cobat
              move 1    to mod-imposte
              move 100  to art-perce-imposte, ef-perce-imposte-buf
              display ef-perce-imposte
           else
              move ZERO to mod-imposte
              perform CANCELLA-COLORE
              display ef-perce-imposte
           end-if 
             
           .
      * <TOTEM:END>
       chk-cobat-LinkTo.
      * <TOTEM:PARA. chk-cobat-LinkTo>
      *     move chk-cobat-buf to mod-cobat.
      *     display ef-amperaggio
      *             cbo-cobat.

           inquire chk-cobat, value chk-cobat-buf.

           if chk-cobat-buf = 1
              move ZERO to chk-imposte-buf, mod-imposte
              perform CANCELLA-COLORE
              display chk-imposte, ef-perce-imposte
              move 1    to mod-cobat
              display ef-amperaggio, cbo-cobat
           else
              move ZERO to mod-cobat
              perform CANCELLA-COLORE
              display ef-amperaggio, cbo-cobat
           end-if 
           .
      * <TOTEM:END>
       cbo-utf-Ev-Ntf-Selchange.
      * <TOTEM:PARA. cbo-utf-Ev-Ntf-Selchange>
           perform SCARICA-COMBO-UTF.
           evaluate true
           when soggetto     move 1 to mod-peso-utf
                             move 0 to mod-peso-non-utf
                             move 0 to ef-peso-non-utf-buf
           when misto        move 1 to mod-peso-utf
                             move 1 to mod-peso-non-utf
           when non-soggetto move 0 to mod-peso-utf
                             move 1 to mod-peso-non-utf   
                             move 0 to ef-peso-utf-buf
           end-evaluate.

           display ef-peso-utf ef-peso-non-utf 
           .
      * <TOTEM:END>
       pb-foto-LinkTo.
      * <TOTEM:PARA. pb-foto-LinkTo>
           inquire ef-foto, value in LinkImage.
           move mod to LinkAbil.
           call   "browser" using LinkBrowser.
           cancel "browser".
           move LinkImage to ef-foto-buf.
           display ef-foto 
           .
      * <TOTEM:END>
       pb-scheda-LinkTo.
      * <TOTEM:PARA. pb-scheda-LinkTo>
           inquire ef-scheda, value in LinkImage.
           move mod to LinkAbil.
           call   "browser" using LinkBrowser.
           cancel "browser".
           move LinkImage to ef-scheda-buf.
           display ef-scheda 
           .
      * <TOTEM:END>
       Form1-DaEf-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-AfterProcedure>
              INQUIRE ef-mag, VALUE IN link-insart-mag
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>


      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

