      *{TOTEM}PRG-COMMENT
      * bnotavar.Cbl
      * bnotavar.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          bnotavar.
       AUTHOR.              andre.
       DATE-WRITTEN.        martedì 15 dicembre 2020 10:23:27.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:bnotavar, INIT:bnotavar, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "btnotacr.sl".
           COPY "tparamge.sl".
           COPY "brnotacr.sl".
           COPY "destini.sl".
           COPY "tivaese.sl".
           COPY "tcodpag.sl".
           COPY "clienti.sl".
           COPY "articoli.sl".
           COPY "progmag.sl".
           COPY "MAS.sl".
           COPY "tpiombo.sl".
           COPY "tmp-fatturati.sl".
           COPY "timballi.sl".
           COPY "timbalqta.sl".
           COPY "ttipocli.sl".
           COPY "timposte.sl".
           COPY "tvettori.sl".
           COPY "tmarche.sl".
           COPY "tmp-progmag-zoom.sl".
           COPY "rordini.sl".
           COPY "tordini.sl".
           COPY "tcaumag.sl".
           COPY "tnotacr.sl".
           COPY "param.sl".
           COPY "tcontat.sl".
           COPY "tnazioni.sl".
           COPY "tmagaz.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "btnotacr.fd".
           COPY "tparamge.fd".
           COPY "brnotacr.fd".
           COPY "destini.fd".
           COPY "tivaese.fd".
           COPY "tcodpag.fd".
           COPY "clienti.fd".
           COPY "articoli.fd".
           COPY "progmag.fd".
           COPY "MAS.fd".
           COPY "tpiombo.fd".
           COPY "tmp-fatturati.fd".
           COPY "timballi.fd".
           COPY "timbalqta.fd".
           COPY "ttipocli.fd".
           COPY "timposte.fd".
           COPY "tvettori.fd".
           COPY "tmarche.fd".
           COPY "tmp-progmag-zoom.fd".
           COPY "rordini.fd".
           COPY "tordini.fd".
           COPY "tcaumag.fd".
           COPY "tnotacr.fd".
           COPY "param.fd".
           COPY "tcontat.fd".
           COPY "tnazioni.fd".
           COPY "tmagaz.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "fonts.def".
               COPY "crtvars.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "standard.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
          88 Screen-Time-Out VALUE 99.
      * Properties & User defined Working Stoarge
           COPY  "BOZZE-WS.DEF".

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 Screen1-Ta-1-TAB-VALUE  PIC  99  VALUE 1.
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
      * DATA CONTROL BUFFER
       01 Form1-BUF.
      * Page
              05 Screen1-Pg-1-BUF.
      * Data.Entry-Field
              10 ef-cli-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-des-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-pag-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-vet-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-num-bolla-BUF PIC x(20).
      * Data.Entry-Field
              10 ef-data-bolla-BUF PIC 99/99/9999 blank zero.
      * Data.Entry-Field
              10 ef-num-reso-BUF PIC z(8).
      * Data.Entry-Field
              10 ef-data-ingresso-BUF PIC 99/99/9999 blank zero.
      * Data.Entry-Field
              10 ef-motivo-BUF PIC X(200).
      * Data.Entry-Field
              10 ef-note-BUF PIC X(300).
      * Data.Radio-Button
              10 Form1-RADIO-1-BUF PIC 99 VALUE ZERO.
      * Data.Entry-Field
              10 ef-cli-fm-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-des-fm-BUF PIC z(5).
      * Page
              05 Screen1-Pg-2-BUF.
      * Data.Entry-Field
              10 ef-art-BUF PIC z(6).
      * Data.Entry-Field
              10 ef-qta-BUF PIC zz.zzz.zz9.
      * Data.Entry-Field
              10 ef-prz-BUF PIC zzz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-consumo-BUF PIC z.zz9,99.
      * Data.Entry-Field
              10 ef-coubat-BUF PIC z.zz9,99.
      * Data.Entry-Field
              10 ef-add-BUF PIC z.zz9,99.
      * Data.Entry-Field
              10 ef-imp-BUF PIC zzz.zzz.zz9,99.
      * Data.Entry-Field
              10 ef-iva-BUF PIC X(3).
      * Data.Label
              10 lab-art-BUF PIC X(100).

       77 TMP-DataSet1-btnotacr-BUF     PIC X(912).
       77 TMP-DataSet1-tparamge-BUF     PIC X(815).
       77 TMP-DataSet1-brnotacr-BUF     PIC X(424).
       77 TMP-DataSet1-destini-BUF     PIC X(3676).
       77 TMP-DataSet1-tivaese-BUF     PIC X(1380).
       77 TMP-DataSet1-tcodpag-BUF     PIC X(1380).
       77 TMP-DataSet1-clienti-BUF     PIC X(1910).
       77 TMP-DataSet1-articoli-BUF     PIC X(3669).
       77 TMP-DataSet1-progmag-BUF     PIC X(1090).
       77 TMP-DataSet1-MAS-BUF     PIC X(512).
       77 TMP-DataSet1-tpiombo-BUF     PIC X(739).
       77 TMP-DataSet1-tmp-fatturati-BUF     PIC X(64).
       77 TMP-DataSet1-timballi-BUF     PIC X(210).
       77 TMP-DataSet1-timbalqta-BUF     PIC X(167).
       77 TMP-DataSet1-ttipocli-BUF     PIC X(889).
       77 TMP-DataSet1-timposte-BUF     PIC X(717).
       77 TMP-DataSet1-tvettori-BUF     PIC X(1847).
       77 TMP-DataSet1-tmarche-BUF     PIC X(217).
       77 TMP-DataSet1-tmp-progmag-zoom-BUF     PIC X(195).
       77 TMP-DataSet1-rordini-BUF     PIC X(667).
       77 TMP-DataSet1-tordini-BUF     PIC X(3898).
       77 TMP-DataSet1-tcaumag-BUF     PIC X(254).
       77 TMP-DataSet1-tnotacr-BUF     PIC X(752).
       77 TMP-DataSet1-param-BUF     PIC X(980).
       77 TMP-DataSet1-tcontat-BUF     PIC X(3270).
       77 TMP-DataSet1-tnazioni-BUF     PIC X(190).
       77 TMP-DataSet1-tmagaz-BUF     PIC X(212).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-btnotacr-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-btnotacr-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-btnotacr-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-btnotacr-KEY1-Asc  VALUE "A".
          88 DataSet1-btnotacr-KEY1-Desc VALUE "D".
       77 DataSet1-tparamge-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tparamge-LOCK  VALUE "Y".
       77 DataSet1-tparamge-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tparamge-KEY-Asc  VALUE "A".
          88 DataSet1-tparamge-KEY-Desc VALUE "D".
       77 DataSet1-brnotacr-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-brnotacr-LOCK  VALUE "Y".
       77 DataSet1-brnotacr-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-brnotacr-KEY-Asc  VALUE "A".
          88 DataSet1-brnotacr-KEY-Desc VALUE "D".
       77 DataSet1-destini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-destini-LOCK  VALUE "Y".
       77 DataSet1-destini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-destini-KEY-Asc  VALUE "A".
          88 DataSet1-destini-KEY-Desc VALUE "D".
       77 DataSet1-tivaese-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tivaese-LOCK  VALUE "Y".
       77 DataSet1-tivaese-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tivaese-KEY-Asc  VALUE "A".
          88 DataSet1-tivaese-KEY-Desc VALUE "D".
       77 DataSet1-tcodpag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcodpag-LOCK  VALUE "Y".
       77 DataSet1-tcodpag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcodpag-KEY-Asc  VALUE "A".
          88 DataSet1-tcodpag-KEY-Desc VALUE "D".
       77 DataSet1-clienti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-clienti-LOCK  VALUE "Y".
       77 DataSet1-clienti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti-KEY-Asc  VALUE "A".
          88 DataSet1-clienti-KEY-Desc VALUE "D".
       77 DataSet1-articoli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-articoli-LOCK  VALUE "Y".
       77 DataSet1-articoli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-articoli-KEY-Asc  VALUE "A".
          88 DataSet1-articoli-KEY-Desc VALUE "D".
       77 DataSet1-progmag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-progmag-LOCK  VALUE "Y".
       77 DataSet1-progmag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-progmag-KEY-Asc  VALUE "A".
          88 DataSet1-progmag-KEY-Desc VALUE "D".
       77 DataSet1-MAS-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-MAS-LOCK  VALUE "Y".
       77 DataSet1-MAS-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-MAS-KEY-Asc  VALUE "A".
          88 DataSet1-MAS-KEY-Desc VALUE "D".
       77 DataSet1-tpiombo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tpiombo-LOCK  VALUE "Y".
       77 DataSet1-tpiombo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tpiombo-KEY-Asc  VALUE "A".
          88 DataSet1-tpiombo-KEY-Desc VALUE "D".
       77 DataSet1-tmp-fatturati-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-fatturati-LOCK  VALUE "Y".
       77 DataSet1-tmp-fatturati-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-fatturati-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-fatturati-KEY-Desc VALUE "D".
       77 DataSet1-timballi-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timballi-LOCK  VALUE "Y".
       77 DataSet1-timballi-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timballi-KEY-Asc  VALUE "A".
          88 DataSet1-timballi-KEY-Desc VALUE "D".
       77 DataSet1-timbalqta-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timbalqta-LOCK  VALUE "Y".
       77 DataSet1-timbalqta-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timbalqta-KEY-Asc  VALUE "A".
          88 DataSet1-timbalqta-KEY-Desc VALUE "D".
       77 DataSet1-ttipocli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-ttipocli-LOCK  VALUE "Y".
       77 DataSet1-ttipocli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-ttipocli-KEY-Asc  VALUE "A".
          88 DataSet1-ttipocli-KEY-Desc VALUE "D".
       77 DataSet1-timposte-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timposte-LOCK  VALUE "Y".
       77 DataSet1-timposte-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timposte-KEY-Asc  VALUE "A".
          88 DataSet1-timposte-KEY-Desc VALUE "D".
       77 DataSet1-tvettori-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tvettori-LOCK  VALUE "Y".
       77 DataSet1-tvettori-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tvettori-KEY-Asc  VALUE "A".
          88 DataSet1-tvettori-KEY-Desc VALUE "D".
       77 DataSet1-tmarche-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmarche-LOCK  VALUE "Y".
       77 DataSet1-tmarche-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmarche-KEY-Asc  VALUE "A".
          88 DataSet1-tmarche-KEY-Desc VALUE "D".
       77 DataSet1-tmp-progmag-zoom-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-progmag-zoom-LOCK  VALUE "Y".
       77 DataSet1-tmp-progmag-zoom-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-progmag-zoom-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-progmag-zoom-KEY-Desc VALUE "D".
       77 DataSet1-rordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rordini-LOCK  VALUE "Y".
       77 DataSet1-rordini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rordini-KEY-Asc  VALUE "A".
          88 DataSet1-rordini-KEY-Desc VALUE "D".
       77 DataSet1-tordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tordini-LOCK  VALUE "Y".
       77 DataSet1-tordini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tordini-KEY-Asc  VALUE "A".
          88 DataSet1-tordini-KEY-Desc VALUE "D".
       77 DataSet1-tcaumag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcaumag-LOCK  VALUE "Y".
       77 DataSet1-tcaumag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcaumag-KEY-Asc  VALUE "A".
          88 DataSet1-tcaumag-KEY-Desc VALUE "D".
       77 DataSet1-tnotacr-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tnotacr-LOCK  VALUE "Y".
       77 DataSet1-tnotacr-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tnotacr-KEY-Asc  VALUE "A".
          88 DataSet1-tnotacr-KEY-Desc VALUE "D".
       77 DataSet1-param-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-param-LOCK  VALUE "Y".
       77 DataSet1-param-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-param-KEY-Asc  VALUE "A".
          88 DataSet1-param-KEY-Desc VALUE "D".
       77 DataSet1-tcontat-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcontat-LOCK  VALUE "Y".
       77 DataSet1-tcontat-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcontat-KEY-Asc  VALUE "A".
          88 DataSet1-tcontat-KEY-Desc VALUE "D".
       77 DataSet1-tnazioni-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tnazioni-LOCK  VALUE "Y".
       77 DataSet1-tnazioni-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tnazioni-KEY-Asc  VALUE "A".
          88 DataSet1-tnazioni-KEY-Desc VALUE "D".
       77 DataSet1-tmagaz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmagaz-LOCK  VALUE "Y".
       77 DataSet1-tmagaz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmagaz-KEY-Asc  VALUE "A".
          88 DataSet1-tmagaz-KEY-Desc VALUE "D".

       77 btnotacr-k1-SPLITBUF  PIC X(23).
       77 btnotacr-k-data-SPLITBUF  PIC X(17).
       77 btnotacr-k-fattura-SPLITBUF  PIC X(13).
       77 btnotacr-k-reso-SPLITBUF  PIC X(13).
       77 btnotacr-k-bolla-SPLITBUF  PIC X(25).
       77 btnotacr-k-vettore-SPLITBUF  PIC X(18).
       77 btnotacr-k-nota-SPLITBUF  PIC X(13).
       77 btnotacr-k-fatman-SPLITBUF  PIC X(13).
       77 brnotacr-brno-k-articolo-SPLITBUF  PIC X(25).
       77 destini-K1-SPLITBUF  PIC X(111).
       77 destini-k-localita-SPLITBUF  PIC X(36).
       77 tivaese-key01-SPLITBUF  PIC X(53).
       77 tcodpag-TBL-CODICE-01-SPLITBUF  PIC X(53).
       77 clienti-cli-K1-SPLITBUF  PIC X(47).
       77 clienti-cli-K3-SPLITBUF  PIC X(12).
       77 clienti-cli-K4-SPLITBUF  PIC X(8).
       77 articoli-art-k1-SPLITBUF  PIC X(51).
       77 articoli-art-k-frn-SPLITBUF  PIC X(16).
       77 progmag-key01-SPLITBUF  PIC X(21).
       77 MAS-MAS-CODICE1-SPLITBUF  PIC X(39).
       77 MAS-MAS-CODICE2-SPLITBUF  PIC X(39).
       77 tmp-fatturati-k-ord-SPLITBUF  PIC X(17).
       77 tvettori-k-des-SPLITBUF  PIC X(41).
       77 tmp-progmag-zoom-key-des-SPLITBUF  PIC X(64).
       77 tmp-progmag-zoom-key-art-SPLITBUF  PIC X(7).
       77 rordini-ror-k-promo-SPLITBUF  PIC X(16).
       77 rordini-ror-k-articolo-SPLITBUF  PIC X(24).
       77 rordini-ror-k-master-SPLITBUF  PIC X(35).
       77 rordini-ror-k-stbolle-SPLITBUF  PIC X(30).
       77 rordini-ror-k-ord-art-SPLITBUF  PIC X(19).
       77 tordini-k-causale-SPLITBUF  PIC X(17).
       77 tordini-k1-SPLITBUF  PIC X(23).
       77 tordini-k2-SPLITBUF  PIC X(21).
       77 tordini-k-bolla-SPLITBUF  PIC X(13).
       77 tordini-k3-SPLITBUF  PIC X(22).
       77 tordini-k-fattura-SPLITBUF  PIC X(13).
       77 tordini-k4-SPLITBUF  PIC X(30).
       77 tordini-k-contab-SPLITBUF  PIC X(14).
       77 tordini-k-tipo-SPLITBUF  PIC X(14).
       77 tordini-k-data-SPLITBUF  PIC X(17).
       77 tordini-k-agfatt-SPLITBUF  PIC X(42).
       77 tordini-k-stbolle-SPLITBUF  PIC X(34).
       77 tordini-k-andamento-data-SPLITBUF  PIC X(10).
       77 tordini-k-andamento-cliente-SPLITBUF  PIC X(15).
       77 tordini-k-andamento-clides-SPLITBUF  PIC X(20).
       77 tordini-k-promo-SPLITBUF  PIC X(29).
       77 tordini-k-or-SPLITBUF  PIC X(21).
       77 tordini-k-tor-inviare-SPLITBUF  PIC X(14).
       77 tordini-k-tor-tipocli-SPLITBUF  PIC X(25).
       77 tordini-k-tor-gdo-SPLITBUF  PIC X(28).
       77 tcaumag-k-mag-SPLITBUF  PIC X(5).
       77 tnotacr-k-causale-SPLITBUF  PIC X(17).
       77 tnotacr-k1-SPLITBUF  PIC X(23).
       77 tnotacr-k2-SPLITBUF  PIC X(21).
       77 tnotacr-k-fattura-SPLITBUF  PIC X(13).
       77 tnotacr-k4-SPLITBUF  PIC X(30).
       77 tnotacr-k-contab-SPLITBUF  PIC X(14).
       77 tnotacr-k-data-SPLITBUF  PIC X(17).
       77 tnotacr-k-agfatt-SPLITBUF  PIC X(42).
       77 tnotacr-k-andamento-data-SPLITBUF  PIC X(10).
       77 tnotacr-k-andamento-cliente-SPLITBUF  PIC X(15).
       77 tnotacr-k-andamento-clides-SPLITBUF  PIC X(20).
      * FOR SPLIT KEY BUFFER
       77 DataSet1-tmp-progmag-zoom-SPLIT-BUF1   PIC X(64).


      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-ef-cli VALUE 5001.
       78  78-ID-ef-des VALUE 5002.
       78  78-ID-ef-pag VALUE 5003.
       78  78-ID-ef-vet VALUE 5004.
       78  78-ID-ef-num-bolla VALUE 5005.
       78  78-ID-ef-data-bolla VALUE 5006.
       78  78-ID-ef-num-reso VALUE 5007.
       78  78-ID-ef-data-ingresso VALUE 5008.
       78  78-ID-ef-motivo VALUE 5009.
       78  78-ID-cbo-colpa VALUE 5010.
       78  78-ID-ef-note VALUE 5011.
       78  78-ID-rb-cli VALUE 5012.
       78  78-ID-rb-vet VALUE 5013.
       78  78-ID-ef-cli-fm VALUE 5014.
       78  78-ID-ef-des-fm VALUE 5015.
       78  78-ID-form1-gd-1 VALUE 5016.
       78  78-ID-ef-art VALUE 5017.
       78  78-ID-ef-qta VALUE 5018.
       78  78-ID-ef-prz VALUE 5019.
       78  78-ID-ef-consumo VALUE 5020.
       78  78-ID-ef-coubat VALUE 5021.
       78  78-ID-ef-add VALUE 5022.
       78  78-ID-ef-imp VALUE 5023.
       78  78-ID-ef-iva VALUE 5024.
       78  78-ID-gd-pag2 VALUE 5025.
       78  78-ID-form1-gd-2 VALUE 5026.
       78  78-ID-gd-pag3 VALUE 5027.
       78  78-ID-form1-gd-3 VALUE 5028.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "COMMON-LINKAGE.DEF".
           COPY  "LINK-NOTACR.DEF".
      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           AFTER PROCEDURE Form1-AfterProcedure,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           .

      * TAB
       05
           Screen1-Ta-1, 
           Tab-Control, 
           COL 1,14, 
           LINE 2,38,
           LINES 44,54 ,
           SIZE 157,00 ,
           FONT IS Small-Font,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           EVENT PROCEDURE Screen1-Ta-1-Event-Proc,
           .

      * PAGE
       05
           Screen1-Pg-1, 
           VISIBLE Screen1-Pg-1-Visible,
           COL 2, 
           LINE 5,
           .

      * ENTRY FIELD
       10
           ef-cli, 
           Entry-Field, 
           COL 22,81, 
           LINE 8,22,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-cli-BUF,
           .

      * ENTRY FIELD
       10
           ef-des, 
           Entry-Field, 
           COL 22,81, 
           LINE 10,22,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-des-BUF,
           .

      * ENTRY FIELD
       10
           ef-pag, 
           Entry-Field, 
           COL 22,81, 
           LINE 12,22,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-pag-BUF,
           .

      * ENTRY FIELD
       10
           ef-vet, 
           Entry-Field, 
           COL 22,81, 
           LINE 14,22,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vet,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-vet-BUF,
           .

      * ENTRY FIELD
       10
           ef-num-bolla, 
           Entry-Field, 
           COL 22,81, 
           LINE 16,22,
           LINES 1,31 ,
           SIZE 25,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-num-bolla,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 20,
           VALUE ef-num-bolla-BUF,
           .

      * ENTRY FIELD
       10
           ef-data-bolla, 
           Entry-Field, 
           COL 61,14, 
           LINE 16,22,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data-bolla,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-data-bolla-BUF,
           .

      * ENTRY FIELD
       10
           ef-num-reso, 
           Entry-Field, 
           COL 86,14, 
           LINE 16,22,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-num-reso,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-num-reso-BUF,
           .

      * ENTRY FIELD
       10
           ef-data-ingresso, 
           Entry-Field, 
           COL 119,81, 
           LINE 16,22,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data-ingresso,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-data-ingresso-BUF,
           .

      * ENTRY FIELD
       10
           ef-motivo, 
           Entry-Field, 
           COL 22,81, 
           LINE 18,22,
           LINES 7,31 ,
           SIZE 108,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Courier-New20-Occidentale,
           ID IS 78-ID-ef-motivo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 200,
           NOTIFY-CHANGE,
           MULTILINE,
           USE-RETURN,
           VALUE ef-motivo-BUF,
           .

      * COMBO-BOX
       10
           cbo-colpa, 
           Combo-Box, 
           COL 22,81, 
           LINE 26,38,
           LINES 5,92 ,
           SIZE 25,00 ,
           3-D,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-cbo-colpa,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cbo-colpa-buf,
           AFTER PROCEDURE cbo-stato-AfterProcedure, 
           .

      * ENTRY FIELD
       10
           ef-note, 
           Entry-Field, 
           COL 22,81, 
           LINE 28,92,
           LINES 7,31 ,
           SIZE 108,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Courier-New20-Occidentale,
           ID IS 78-ID-ef-note,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 300,
           NOTIFY-CHANGE,
           MULTILINE,
           USE-RETURN,
           VALUE ef-note-BUF,
           .

      * RADIO BUTTON
       10
           rb-cli, 
           Radio-Button, 
           COL 22,81, 
           LINE 39,45,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1000
           FLAT,
           GROUP 1,
           GROUP-VALUE 1,
           ID IS 78-ID-rb-cli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Radio Button",
           VALUE Form1-RADIO-1-BUF,
            .
      * RADIO BUTTON
       10
           rb-vet, 
           Radio-Button, 
           COL 35,81, 
           LINE 39,45,
           LINES 1,31 ,
           SIZE 2,50 ,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1002
           FLAT,
           GROUP 1,
           GROUP-VALUE 2,
           ID IS 78-ID-rb-vet,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Radio Button",
           VALUE Form1-RADIO-1-BUF,
            .
      * ENTRY FIELD
       10
           ef-cli-fm, 
           Entry-Field, 
           COL 22,81, 
           LINE 41,61,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cli-fm,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           NOTIFY-CHANGE,
           VALUE ef-cli-fm-BUF,
           .

      * ENTRY FIELD
       10
           ef-des-fm, 
           Entry-Field, 
           COL 22,81, 
           LINE 43,84,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des-fm,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           NOTIFY-CHANGE,
           VALUE ef-des-fm-BUF,
           .

      * LABEL
       10
           Screen1-La-1, 
           Label, 
           COL 3,81, 
           LINE 8,22,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 81,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Cliente",
           .

      * LABEL
       10
           Screen1-La-2, 
           Label, 
           COL 3,81, 
           LINE 10,22,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 83,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Progressivo Destino",
           .

      * LABEL
       10
           Screen1-La-7, 
           Label, 
           COL 3,81, 
           LINE 28,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 95,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Altre annotazioni",
           .

      * LABEL
       10
           lab-cli, 
           Label, 
           COL 30,81, 
           LINE 8,22,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 100,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cli-buf,
           .

      * LABEL
       10
           lab-ind, 
           Label, 
           COL 72,81, 
           LINE 8,22,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 101,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-ind-buf,
           .

      * LABEL
       10
           lab-loca, 
           Label, 
           COL 114,81, 
           LINE 8,22,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 102,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-loca-buf,
           .

      * LABEL
       10
           lab-des, 
           Label, 
           COL 30,81, 
           LINE 10,22,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 103,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-des-buf,
           .

      * LABEL
       10
           lab-ind-d, 
           Label, 
           COL 72,81, 
           LINE 10,22,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 104,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-ind-d-buf,
           .

      * LABEL
       10
           lab-loca-d, 
           Label, 
           COL 114,81, 
           LINE 10,22,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 105,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-loca-d-buf,
           .

      * LABEL
       10
           Screen1-Custom1-3, 
           Label, 
           COL 147,31, 
           LINE 4,76,
           LINES 0,69 ,
           SIZE 4,83 ,
           FONT IS Default-Font,
           ID IS 62,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * FRAME
       10
           Screen1-Fr-1, 
           Frame, 
           COL 24,48, 
           LINE 4,61,
           LINES 2,77 ,
           SIZE 110,33 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 63,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Riferimenti documento creati",
           TITLE-POSITION 2,
           VISIBLE v-fatt,
           .

      * LABEL
       10
           Screen1-La-9, 
           Label, 
           COL 109,81, 
           LINE 5,61,
           LINES 1,31 ,
           SIZE 3,83 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 64,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "del",
           VISIBLE v-fatt,
           .

      * LABEL
       10
           Screen1-La-10, 
           Label, 
           COL 80,98, 
           LINE 5,61,
           LINES 1,31 ,
           SIZE 12,67 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 65,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Fattura n.",
           VISIBLE v-fatt,
           .

      * LABEL
       10
           lab-data-fm, 
           Label, 
           COL 117,15, 
           LINE 5,61,
           LINES 1,31 ,
           SIZE 16,00 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 66,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE lab-data-fm-buf,
           VISIBLE v-fatt,
           .

      * LABEL
       10
           lab-num-fm, 
           Label, 
           COL 95,31, 
           LINE 5,61,
           LINES 1,31 ,
           SIZE 12,00 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 67,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-num-fm-buf,
           VISIBLE v-fatt,
           .

      * LABEL
       10
           Screen1-La-10a, 
           Label, 
           COL 25,98, 
           LINE 5,61,
           LINES 1,31 ,
           SIZE 10,17 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 68,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Nota Cr. n.",
           VISIBLE v-fatt,
           .

      * LABEL
       10
           lab-num-nc, 
           Label, 
           COL 37,65, 
           LINE 5,61,
           LINES 1,31 ,
           SIZE 12,00 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 69,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-num-nc-buf,
           VISIBLE v-fatt,
           .

      * LABEL
       10
           Screen1-La-9a, 
           Label, 
           COL 51,48, 
           LINE 5,61,
           LINES 1,31 ,
           SIZE 4,67 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 70,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "del",
           VISIBLE v-fatt,
           .

      * LABEL
       10
           lab-data-nc, 
           Label, 
           COL 58,81, 
           LINE 5,61,
           LINES 1,31 ,
           SIZE 16,00 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 71,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE lab-data-nc-buf,
           VISIBLE v-fatt,
           .

      * LABEL
       10
           Screen1-La-5a, 
           Label, 
           COL 3,81, 
           LINE 14,22,
           LINES 1,30 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 72,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Vettore",
           .

      * LABEL
       10
           lab-vet, 
           Label, 
           COL 30,81, 
           LINE 14,22,
           LINES 1,31 ,
           SIZE 77,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 73,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-buf,
           .

      * LABEL
       10
           Screen1-La-8aa, 
           Label, 
           COL 3,81, 
           LINE 16,22,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 74,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Nr. Bolla",
           .

      * LABEL
       10
           Screen1-La-8aaa, 
           Label, 
           COL 50,48, 
           LINE 16,22,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 75,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data Bolla",
           .

      * LABEL
       10
           Screen1-La-7a, 
           Label, 
           COL 3,81, 
           LINE 18,22,
           LINES 2,08 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Motivo contestazione",
           .

      * LABEL
       10
           Screen1-La-7aa, 
           Label, 
           COL 3,81, 
           LINE 26,38,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 13,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Errore Colpa",
           .

      * LABEL
       10
           Screen1-La-1a, 
           Label, 
           COL 3,81, 
           LINE 41,61,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Cliente",
           .

      * LABEL
       10
           Screen1-La-2a, 
           Label, 
           COL 3,81, 
           LINE 43,84,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Progressivo Destino",
           .

      * LABEL
       10
           lab-cli-fm, 
           Label, 
           COL 30,81, 
           LINE 41,61,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 18,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cli-fm-buf,
           .

      * LABEL
       10
           lab-ind-fm, 
           Label, 
           COL 72,81, 
           LINE 41,61,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-ind-fm-buf,
           .

      * LABEL
       10
           lab-des-fm, 
           Label, 
           COL 30,81, 
           LINE 43,84,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 20,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-des-fm-buf,
           .

      * LABEL
       10
           lab-ind-d-fm, 
           Label, 
           COL 72,81, 
           LINE 43,84,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-ind-d-fm-buf,
           .

      * BAR
       10
           Screen1-Br-2, 
           Bar,
           COL 2,98, 
           LINE 37,76,
           SIZE 63,17 ,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           Screen1-La-3a, 
           Label, 
           COL 67,14, 
           LINE 37,22,
           LINES 1,31 ,
           SIZE 24,83 ,
           FONT IS Small-Font,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Dati per intestazione addebito",
           .

      * BAR
       10
           Screen1-Br-2a, 
           Bar,
           COL 93,64, 
           LINE 37,76,
           SIZE 63,17 ,
           ID IS 11,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       10
           lab-loca-fm, 
           Label, 
           COL 114,81, 
           LINE 41,61,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 22,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-loca-fm-buf,
           .

      * LABEL
       10
           lab-loca-d-fm, 
           Label, 
           COL 114,81, 
           LINE 43,84,
           LINES 2,00 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-loca-d-fm-buf,
           .

      * LABEL
       10
           Screen1-La-5, 
           Label, 
           COL 3,81, 
           LINE 39,15,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 24,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Intestatario",
           .

      * LABEL
       10
           Screen1-La-6, 
           Label, 
           COL 26,64, 
           LINE 39,45,
           LINES 1,31 ,
           SIZE 8,17 ,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cliente",
           .

      * LABEL
       10
           Screen1-La-6a, 
           Label, 
           COL 39,98, 
           LINE 39,45,
           LINES 1,31 ,
           SIZE 8,17 ,
           FONT IS Small-Font,
           ID IS 26,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore",
           .

      * LABEL
       10
           Screen1-La-5b, 
           Label, 
           COL 3,81, 
           LINE 12,22,
           LINES 1,30 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 89,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Pagamento",
           .

      * LABEL
       10
           lab-pag, 
           Label, 
           COL 30,81, 
           LINE 12,22,
           LINES 1,31 ,
           SIZE 77,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 98,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-pag-buf,
           .

      * LABEL
       10
           Screen1-La-8aaaa, 
           Label, 
           COL 75,48, 
           LINE 16,22,
           LINES 1,31 ,
           SIZE 9,00 ,
           FONT IS Small-Font,
           ID IS 99,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Nr. Reso",
           .

      * LABEL
       10
           Screen1-La-8aaab, 
           Label, 
           COL 102,14, 
           LINE 16,22,
           LINES 1,31 ,
           SIZE 16,67 ,
           FONT IS Small-Font,
           ID IS 106,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data ingresso merce",
           .

      * PAGE
       05
           Screen1-Pg-2, 
           VISIBLE Screen1-Pg-2-Visible,
           COL 2, 
           LINE 5,
           .

      * GRID
       10
           form1-gd-1, 
           Grid, 
           COL 3,81, 
           LINE 6,07,
           LINES 31,00 ,
           SIZE 151,00 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           CENTERED-HEADINGS,
           COLOR IS 516,
           DATA-COLUMNS (1, 6, 12, 162, 170, 184, 198, 212, 226, 234),
           ALIGNMENT ("R", "R", "U", "R", "R", "R", "R", "R", "R", "C"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("9(5)", "9(6)", "X", "9(8)", "9(12)", "X", "9(12)
      -    "", "9(12)", "X", "x(3)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-form1-gd-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ROW-HEADINGS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 147,
           VISIBLE Screen1-Pg-2-Visible,
           VPADDING 50,
           VSCROLL,
           BEFORE PROCEDURE form1-gd-1-BeforeProcedure, 
           EVENT PROCEDURE form1-gd-1-Event-Proc,
           .

      * ENTRY FIELD
       10
           ef-art, 
           Entry-Field, 
           COL 20,81, 
           LINE 40,15,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-art,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-art-BUF,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * ENTRY FIELD
       10
           ef-qta, 
           Entry-Field, 
           COL 101,81, 
           LINE 40,15,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-qta,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-qta-BUF,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * ENTRY FIELD
       10
           ef-prz, 
           Entry-Field, 
           COL 20,81, 
           LINE 42,53,
           LINES 1,31 ,
           SIZE 14,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-prz,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           VALUE ef-prz-BUF,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * ENTRY FIELD
       10
           ef-consumo, 
           Entry-Field, 
           COL 52,14, 
           LINE 42,53,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-consumo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           READ-ONLY,
           VALUE ef-consumo-BUF,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * ENTRY FIELD
       10
           ef-coubat, 
           Entry-Field, 
           COL 75,14, 
           LINE 42,53,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-coubat,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           READ-ONLY,
           VALUE ef-coubat-BUF,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * ENTRY FIELD
       10
           ef-add, 
           Entry-Field, 
           COL 101,81, 
           LINE 42,53,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-add,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           READ-ONLY,
           VALUE ef-add-BUF,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * ENTRY FIELD
       10
           ef-imp, 
           Entry-Field, 
           COL 20,81, 
           LINE 44,53,
           LINES 1,31 ,
           SIZE 14,00 ,
           BOXED,
           COLOR IS 33281,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           READ-ONLY,
           VALUE ef-imp-BUF,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * ENTRY FIELD
       10
           ef-iva, 
           Entry-Field, 
           COL 52,14, 
           LINE 44,53,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-iva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-iva-BUF,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * LABEL
       10
           Form1-La-19, 
           Label, 
           COL 3,81, 
           LINE 40,15,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 41,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Articolo",
           VISIBLE Screen1-Pg-2-Visible,
           .

      * LABEL
       10
           Form1-La-20, 
           Label, 
           COL 88,81, 
           LINE 40,15,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 42,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Quantità",
           VISIBLE Screen1-Pg-2-Visible,
           .

      * LABEL
       10
           Form1-La-21, 
           Label, 
           COL 3,81, 
           LINE 42,53,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 43,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prezzo Unitario",
           VISIBLE Screen1-Pg-2-Visible,
           .

      * LABEL
       10
           Form1-La-22, 
           Label, 
           COL 37,14, 
           LINE 42,53,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 44,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imposta Consumo",
           VISIBLE Screen1-Pg-2-Visible,
           .

      * LABEL
       10
           lab-imposta, 
           Label, 
           COL 62,14, 
           LINE 42,53,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "C.O.U./COBAT",
           VISIBLE Screen1-Pg-2-Visible,
           .

      * LABEL
       10
           Form1-La-24, 
           Label, 
           COL 3,81, 
           LINE 44,53,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imponibile Merce",
           VISIBLE Screen1-Pg-2-Visible,
           .

      * LABEL
       10
           Form1-La-26, 
           Label, 
           COL 37,14, 
           LINE 44,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 39,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice I.V.A.",
           VISIBLE Screen1-Pg-2-Visible,
           .

      * DB_LABEL
       10
           lab-art, 
           Label, 
           COL 29,81, 
           LINE 40,15,
           LINES 2,00 ,
           SIZE 55,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-art-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * LABEL
       10
           lab-iva, 
           Label, 
           COL 61,14, 
           LINE 44,53,
           LINES 1,54 ,
           SIZE 88,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-KEY-LETTER,
           TRANSPARENT,
           TITLE lab-iva-buf,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * LABEL
       10
           lab-impostaa, 
           Label, 
           COL 88,81, 
           LINE 42,53,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 76,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Addiz. piombo",
           VISIBLE Screen1-Pg-2-Visible,
           .

      * PUSH BUTTON
       10
           pb-nuovo, 
           Push-Button, 
           COL 127,81, 
           LINE 39,45,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           UNFRAMED,
           SQUARE,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1001,
           FLAT,
           FONT IS Small-Font,
           ID IS 1010,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Aggi&unge una riga all'ordine",
           VISIBLE Screen1-Pg-2-Visible,
           BITMAP-NUMBER=NumBitmapNuovoGrid
           AFTER PROCEDURE pb-nuovo-AfterProcedure, 
           BEFORE PROCEDURE pb-nuovo-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-elimina, 
           Push-Button, 
           COL 140,81, 
           LINE 39,45,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           UNFRAMED,
           SQUARE,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1004,
           FLAT,
           FONT IS Small-Font,
           ID IS 2020,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "&Elimina la riga selezionata",
           VISIBLE Screen1-Pg-2-Visible,
           BITMAP-NUMBER=NumBitmapEliminaGrid
           AFTER PROCEDURE pb-elimina-AfterProcedure, 
           BEFORE PROCEDURE pb-elimina-BeforeProcedure, 
           .

      * BAR
       10
           Screen1-Br-1, 
           Bar,
           COL 3,81, 
           LINE 38,99,
           SIZE 151,00 ,
           ID IS 1002,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           VISIBLE Screen1-Pg-2-Visible,
           .

      * PUSH BUTTON
       10
           pb-genera, 
           Push-Button, 
           COL 149,31, 
           LINE 37,69,
           LINES 0,69 ,
           SIZE 3,00 ,
           FONT IS Small-Font,
           ID IS 55,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Push Button",
           VISIBLE 0,
           .

      * PAGE
       05
           Screen1-Pg-3, 
           VISIBLE Screen1-Pg-3-Visible,
           COL 2, 
           LINE 5,
           .

      * GRID
       10
           gd-pag2, 
           Grid, 
           COL 3,81, 
           LINE 4,92,
           LINES 18,62 ,
           SIZE 151,00 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           CENTERED-HEADINGS,
           COLOR IS 516,
           DATA-COLUMNS (1, 6, 12, 162, 170, 184, 198, 212, 226, 234),
           ALIGNMENT ("R", "R", "U", "R", "R", "R", "R", "R", "R", "C"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("9(5)", "9(6)", "X", "9(8)", "9(12)", "X", "9(12)
      -    "", "9(12)", "X", "x(3)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-pag2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ROW-HEADINGS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 147,
           VISIBLE Screen1-Pg-3-Visible,
           VPADDING 50,
           VSCROLL,
           EVENT PROCEDURE gd-pag2-Event-Proc,
           .

      * PUSH BUTTON
       10
           pb-sel-tutto-n, 
           Push-Button, 
           COL 3,14, 
           LINE 23,99,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE SEL-TUTTO-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1005,
           FLAT,
           ID IS 56,
           SELF-ACT,
           TITLE "Seleziona tutto",
           VISIBLE Screen1-Pg-3-Visible,
           AFTER PROCEDURE pb-sel-tutto-n-AfterProcedure, 
           BEFORE PROCEDURE pb-sel-tutto-n-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-genera2, 
           Push-Button, 
           COL 72,81, 
           LINE 23,99,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE GENERA-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1006,
           FLAT,
           ID IS 57,
           SELF-ACT,
           TITLE "Genera",
           VISIBLE Screen1-Pg-3-Visible,
           AFTER PROCEDURE pb-genera2-AfterProcedure, 
           BEFORE PROCEDURE pb-genera2-BeforeProcedure, 
           .

      * GRID
       10
           form1-gd-2, 
           Grid, 
           COL 3,81, 
           LINE 27,15,
           LINES 18,62 ,
           SIZE 151,00 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           CENTERED-HEADINGS,
           COLOR IS 516,
           DATA-COLUMNS (1, 6, 12, 162, 170, 184, 198, 212, 226, 234),
           ALIGNMENT ("R", "R", "U", "R", "R", "R", "R", "R", "R", "C"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("9(5)", "9(6)", "X", "9(8)", "9(12)", "X", "9(12)
      -    "", "9(12)", "X", "x(3)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-COLOR 481
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-form1-gd-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ROW-HEADINGS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 147,
           VISIBLE Screen1-Pg-3-Visible,
           VPADDING 50,
           VSCROLL,
           EVENT PROCEDURE form1-gd-1-Event-Proc,
           .

      * PAGE
       05
           Screen1-Pg-4, 
           VISIBLE Screen1-Pg-4-Visible,
           COL 2, 
           LINE 5,
           .

      * GRID
       10
           gd-pag3, 
           Grid, 
           COL 3,81, 
           LINE 4,92,
           LINES 18,62 ,
           SIZE 151,00 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           CENTERED-HEADINGS,
           COLOR IS 516,
           DATA-COLUMNS (1, 6, 12, 162, 170, 184, 198, 212, 226, 234),
           ALIGNMENT ("R", "R", "U", "R", "R", "R", "R", "R", "R", "C"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("9(5)", "9(6)", "X", "9(8)", "9(12)", "X", "9(12)
      -    "", "9(12)", "X", "x(3)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-pag3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ROW-HEADINGS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 147,
           VISIBLE Screen1-Pg-4-Visible,
           VPADDING 50,
           VSCROLL,
           EVENT PROCEDURE gd-pag3-Event-Proc,
           .

      * PUSH BUTTON
       10
           pb-sel-tutto-r, 
           Push-Button, 
           COL 3,14, 
           LINE 23,99,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE SEL-TUTTO-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1003,
           FLAT,
           ID IS 77,
           SELF-ACT,
           TITLE "Seleziona tutto",
           VISIBLE Screen1-Pg-4-Visible,
           AFTER PROCEDURE pb-sel-tutto-r-AfterProcedure, 
           BEFORE PROCEDURE pb-sel-tutto-r-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-genera-r, 
           Push-Button, 
           COL 72,81, 
           LINE 23,99,
           LINES 29,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE GENERA-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1007,
           FLAT,
           ID IS 78,
           SELF-ACT,
           TITLE "Genera",
           VISIBLE Screen1-Pg-4-Visible,
           AFTER PROCEDURE pb-genera-r-AfterProcedure, 
           BEFORE PROCEDURE pb-genera-r-BeforeProcedure, 
           .

      * GRID
       10
           form1-gd-3, 
           Grid, 
           COL 3,81, 
           LINE 27,15,
           LINES 18,62 ,
           SIZE 151,00 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           CENTERED-HEADINGS,
           COLOR IS 516,
           DATA-COLUMNS (1, 6, 12, 162, 170, 184, 198, 212, 226, 234),
           ALIGNMENT ("R", "R", "U", "R", "R", "R", "R", "R", "R", "C"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("9(5)", "9(6)", "X", "9(8)", "9(12)", "X", "9(12)
      -    "", "9(12)", "X", "x(3)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-COLOR 481
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-form1-gd-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ROW-HEADINGS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 147,
           VISIBLE Screen1-Pg-4-Visible,
           VPADDING 50,
           VSCROLL,
           EVENT PROCEDURE form1-gd-1-Event-Proc,
           .

      * LABEL
       05
           lab-anno, 
           Label, 
           COL 84,00, 
           LINE 1,62,
           LINES 1,54 ,
           SIZE 24,00 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 119,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE lab-anno-buf,
           .

      * LABEL
       05
           Screen1-La-3, 
           Label, 
           COL 109,50, 
           LINE 1,62,
           LINES 1,54 ,
           SIZE 7,50 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 4041,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Bozza",
           .

      * LABEL
       05
           lab-numero, 
           Label, 
           COL 117,50, 
           LINE 1,62,
           LINES 1,54 ,
           SIZE 10,50 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 4042,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE numero-bozza,
           .

      * LABEL
       05
           lab-tipo, 
           Label, 
           COL 150,00, 
           LINE 1,62,
           LINES 1,54 ,
           SIZE 7,00 ,
           COLOR IS 5,
           FONT IS Verdana10B-Occidentale,
           ID IS 122,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE btno-causale,
           .

      * PUSH BUTTON
       05
           pb-notacr, 
           Push-Button, 
           COL 59,83, 
           LINE 1,15,
           LINES 29,00 ,
           SIZE 114,00 ,
           BITMAP-HANDLE NOTACR-BMP,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1027,
           FLAT,
           FONT IS Small-Font,
           ID IS 889,
           SELF-ACT,
           VISIBLE v-nota,
           BITMAP-NUMBER=NumBitmapPb
           AFTER PROCEDURE pb-notacr-AfterProcedure, 
           BEFORE PROCEDURE pb-notacr-BeforeProcedure, 
           .

      * LABEL
       05
           Screen1-La-3b, 
           Label, 
           COL 128,83, 
           LINE 1,62,
           LINES 1,54 ,
           SIZE 4,50 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 890,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "del",
           .

      * LABEL
       05
           lab-data, 
           Label, 
           COL 133,33, 
           LINE 1,62,
           LINES 1,54 ,
           SIZE 15,00 ,
           COLOR IS 2,
           FONT IS Verdana10B-Occidentale,
           ID IS 891,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-data-buf,
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 4043,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 6,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 23,
           FRAMED,
           SQUARE,
           ENABLED E-NUOVO,
           FLAT,
           ID IS 121,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 16,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CANCELLA,
           EXCEPTION-VALUE 4,
           FLAT,
           ID IS 123,
           SELF-ACT,
           TITLE "Cancella (F4)",
           BITMAP-NUMBER BitmapNumDelete
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 11,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 124,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 26,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 17,
           FRAMED,
           SQUARE,
           ENABLED E-ANTEPRIMA,
           EXCEPTION-VALUE 6,
           FLAT,
           ID IS 125,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 21,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 5,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 126,
           SELF-ACT,
           TITLE "Modifica (F5)",
           VALUE mod,
           BITMAP-NUMBER BitmapNumEdit
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 31,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 18,
           FRAMED,
           SQUARE,
           ENABLED E-STAMPA,
           EXCEPTION-VALUE 7,
           FLAT,
           ID IS 127,
           SELF-ACT,
           TITLE "Stampa (F7)",
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 36,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 128,
           SELF-ACT,
           TITLE "Cerca (F8)",
           BITMAP-NUMBER=BitmapNumZoom
           .

      * PUSH BUTTON
       05
           TOOL-SELEZIONA, 
           Push-Button, 
           COL 41,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-SELEZIONA,
           FLAT,
           ID IS 129,
           SELF-ACT,
           TITLE "Seleziona (F9)",
           BITMAP-NUMBER BitmapNumSelect
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, USER-CODI, LIVELLO-ABIL, 
           notacr-linkage.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:bnotavar, INIT:bnotavar, BeforeDeclarative>
      ***---
       TPARAMGE-ERR SECTION.
           use after error procedure on tparamge.
           set tutto-ok  to true.
           evaluate status-tparamge
           when "35"
                display message "File [TPARAMGE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TPARAMGE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TPARAMGE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       BRNOTACR-ERR SECTION.
           use after error procedure on brnotacr.
           set tutto-ok  to true.
           evaluate status-brnotacr
           when "35"
                display message "File [BRNOTACR] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [BRNOTACR] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[BRNOTACR] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       DESTINI-ERR SECTION.
           use after error procedure on destini.
           set tutto-ok  to true.
           evaluate status-destini
           when "35"
                display message "File [DESTINI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [DESTINI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[DESTINI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIVAESE-ERR SECTION.
           use after error procedure on tivaese.
           set tutto-ok  to true.
           evaluate status-tivaese
           when "35"
                display message "File [TIVAESE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIVAESE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIVAESE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TCODPAG-ERR SECTION.
           use after error procedure on tcodpag.
           set tutto-ok  to true.
           evaluate status-tcodpag
           when "35"
                display message "File [TCODPAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCODPAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCODPAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       CLIENTI-ERR SECTION.
           use after error procedure on clienti.
           set tutto-ok  to true.
           evaluate status-clienti
           when "35"
                display message "File [CLIENTI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [CLIENTI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[CLIENTI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       ARTICOLI-ERR SECTION.
           use after error procedure on articoli.
           set tutto-ok  to true.
           evaluate status-articoli
           when "35"
                display message "File [ARTICOLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [ARTICOLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[ARTICOLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.  
 
      ***---
       PROGMAG-ERR SECTION.
           use after error procedure on progmag.
           set tutto-ok  to true.
           evaluate status-progmag
           when "35"
                display message "File [PROGMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [PROGMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[PROGMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       MAS-ERR SECTION.
           use after error procedure on MAS.
           set tutto-ok  to true.
           evaluate status-MAS
           when "35"
                display message "File [MAS] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [MAS] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[MAS] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMP-PROGMAG-ZOOM-ERR SECTION.
           use after error procedure on tmp-progmag-zoom.
           set tutto-ok  to true.
           evaluate status-tmp-progmag-zoom
           when "35"
                display message "File [TMP-PROGMAG-ZOOM] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMP-PROGMAG-ZOOM] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMP-PROGMAG-ZOOM] Indexed file corrupt
      -    "!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALLI-ERR SECTION.
           use after error procedure on timballi.
           set tutto-ok  to true.
           evaluate status-timballi
           when "35"
                display message "File [TIMBALLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALQTA-ERR SECTION.
           use after error procedure on timbalqta.
           set tutto-ok  to true.
           evaluate status-timbalqta
           when "35"
                display message "File [TIMBALQTA] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALQTA] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALQTA] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM notacr-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:bnotavar, INIT:bnotavar, BeforeDestroyResource>
      * <TOTEM:END>
           DESTROY Courier-New20-Occidentale
           DESTROY Verdana10B-Occidentale
           CALL "w$bitmap" USING WBITMAP-DESTROY, 
           STRIP_GRID_GCLIENTI-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, SEL-TUTTO-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, GENERA-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, NOTACR-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, TOOLBAR-BMP
      *    After-Program
           PERFORM notacr-Ev-After-Program
           set environment "KEYSTROKE" to "DATA=46   46".
           set environment "KEYSTROKE" to "DATA=44   44".
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
      * Courier-New20-Occidentale
           INITIALIZE WFONT-DATA Courier-New20-Occidentale
           MOVE 20 TO WFONT-SIZE
           MOVE "Courier New" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO FALSE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Courier-New20-Occidentale, WFONT-DATA
      * Verdana10B-Occidentale
           INITIALIZE WFONT-DATA Verdana10B-Occidentale
           MOVE 10 TO WFONT-SIZE
           MOVE "Verdana" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO TRUE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Verdana10B-Occidentale, WFONT-DATA
           .

       INIT-BMP.
      * pb-nuovo
           COPY RESOURCE "STRIP_GRID_GCLIENTI.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "STRIP_GRID_GCLIENTI.BMP"
           , 
                   GIVING STRIP_GRID_GCLIENTI-BMP.
      * pb-sel-tutto-n
           COPY RESOURCE "SEL-TUTTO.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "SEL-TUTTO.BMP", 
                   GIVING SEL-TUTTO-BMP.
      * pb-genera2
           COPY RESOURCE "GENERA.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "GENERA.BMP", 
                   GIVING GENERA-BMP.
      * pb-notacr
           COPY RESOURCE "NOTACR.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "NOTACR.BMP", 
                   GIVING NOTACR-BMP.
      * TOOL-ESCI
           COPY RESOURCE "TOOLBAR.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "TOOLBAR.BMP", 
                   GIVING TOOLBAR-BMP.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-btnotacr
           PERFORM OPEN-tparamge
           PERFORM OPEN-brnotacr
           PERFORM OPEN-destini
           PERFORM OPEN-tivaese
           PERFORM OPEN-tcodpag
           PERFORM OPEN-clienti
           PERFORM OPEN-articoli
           PERFORM OPEN-progmag
           PERFORM OPEN-MAS
           PERFORM OPEN-tpiombo
      *    tmp-fatturati OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-fatturati
           PERFORM OPEN-timballi
           PERFORM OPEN-timbalqta
           PERFORM OPEN-ttipocli
           PERFORM OPEN-timposte
           PERFORM OPEN-tvettori
           PERFORM OPEN-tmarche
      *    tmp-progmag-zoom OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-progmag-zoom
           PERFORM OPEN-rordini
           PERFORM OPEN-tordini
           PERFORM OPEN-tcaumag
           PERFORM OPEN-tnotacr
           PERFORM OPEN-param
           PERFORM OPEN-tcontat
           PERFORM OPEN-tnazioni
           PERFORM OPEN-tmagaz
      *    After Open
           .

       OPEN-btnotacr.
      * <TOTEM:EPT. INIT:bnotavar, FD:btnotacr, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O btnotacr
           IF STATUS-btnotacr = "35"
              OPEN OUTPUT btnotacr
                IF Valid-STATUS-btnotacr
                   CLOSE btnotacr
                   OPEN I-O btnotacr
                END-IF
           END-IF
           IF NOT Valid-STATUS-btnotacr
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:btnotacr, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tparamge.
      * <TOTEM:EPT. INIT:bnotavar, FD:tparamge, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tparamge
           IF NOT Valid-STATUS-tparamge
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tparamge, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-brnotacr.
      * <TOTEM:EPT. INIT:bnotavar, FD:brnotacr, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O brnotacr
           IF STATUS-brnotacr = "35"
              OPEN OUTPUT brnotacr
                IF Valid-STATUS-brnotacr
                   CLOSE brnotacr
                   OPEN I-O brnotacr
                END-IF
           END-IF
           IF NOT Valid-STATUS-brnotacr
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:brnotacr, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-destini.
      * <TOTEM:EPT. INIT:bnotavar, FD:destini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT destini
           IF NOT Valid-STATUS-destini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:destini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tivaese.
      * <TOTEM:EPT. INIT:bnotavar, FD:tivaese, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tivaese
           IF NOT Valid-STATUS-tivaese
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tivaese, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcodpag.
      * <TOTEM:EPT. INIT:bnotavar, FD:tcodpag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcodpag
           IF NOT Valid-status-tcodpag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tcodpag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-clienti.
      * <TOTEM:EPT. INIT:bnotavar, FD:clienti, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT clienti
           IF NOT Valid-STATUS-clienti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:clienti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-articoli.
      * <TOTEM:EPT. INIT:bnotavar, FD:articoli, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT articoli
           IF NOT Valid-STATUS-articoli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:articoli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-progmag.
      * <TOTEM:EPT. INIT:bnotavar, FD:progmag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT progmag
           IF NOT Valid-STATUS-progmag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:progmag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-MAS.
      * <TOTEM:EPT. INIT:bnotavar, FD:MAS, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT MAS
           IF NOT Valid-status-mas
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:MAS, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tpiombo.
      * <TOTEM:EPT. INIT:bnotavar, FD:tpiombo, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tpiombo
           IF NOT Valid-STATUS-tpiombo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tpiombo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-fatturati.
      * <TOTEM:EPT. INIT:bnotavar, FD:tmp-fatturati, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmp-fatturati
           IF NOT Valid-STATUS-tmp-fatturati
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tmp-fatturati, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timballi.
      * <TOTEM:EPT. INIT:bnotavar, FD:timballi, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timballi
           IF NOT Valid-STATUS-timballi
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:timballi, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timbalqta.
      * <TOTEM:EPT. INIT:bnotavar, FD:timbalqta, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timbalqta
           IF NOT Valid-STATUS-timbalqta
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:timbalqta, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-ttipocli.
      * <TOTEM:EPT. INIT:bnotavar, FD:ttipocli, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT ttipocli
           IF NOT Valid-STATUS-ttipocli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:ttipocli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timposte.
      * <TOTEM:EPT. INIT:bnotavar, FD:timposte, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timposte
           IF NOT Valid-STATUS-timposte
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:timposte, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tvettori.
      * <TOTEM:EPT. INIT:bnotavar, FD:tvettori, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tvettori
           IF NOT Valid-STATUS-tvettori
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tvettori, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmarche.
      * <TOTEM:EPT. INIT:bnotavar, FD:tmarche, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmarche
           IF NOT Valid-STATUS-tmarche
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tmarche, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-progmag-zoom.
      * <TOTEM:EPT. INIT:bnotavar, FD:tmp-progmag-zoom, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-progmag-zoom
           IF NOT Valid-STATUS-tmp-progmag-zoom
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tmp-progmag-zoom, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rordini.
      * <TOTEM:EPT. INIT:bnotavar, FD:rordini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rordini
           IF NOT Valid-STATUS-rordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:rordini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tordini.
      * <TOTEM:EPT. INIT:bnotavar, FD:tordini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tordini
           IF NOT Valid-STATUS-tordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tordini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcaumag.
      * <TOTEM:EPT. INIT:bnotavar, FD:tcaumag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcaumag
           IF NOT Valid-STATUS-tcaumag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tcaumag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tnotacr.
      * <TOTEM:EPT. INIT:bnotavar, FD:tnotacr, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tnotacr
           IF NOT Valid-STATUS-tnotacr
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tnotacr, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-param.
      * <TOTEM:EPT. INIT:bnotavar, FD:param, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT param
           IF NOT Valid-STATUS-param
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:param, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcontat.
      * <TOTEM:EPT. INIT:bnotavar, FD:tcontat, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcontat
           IF NOT Valid-STATUS-tcontat
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tcontat, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tnazioni.
      * <TOTEM:EPT. INIT:bnotavar, FD:tnazioni, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tnazioni
           IF NOT Valid-STATUS-tnazioni
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tnazioni, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmagaz.
      * <TOTEM:EPT. INIT:bnotavar, FD:tmagaz, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmagaz
           IF NOT Valid-STATUS-tmagaz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:bnotavar, FD:tmagaz, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-btnotacr
           PERFORM CLOSE-tparamge
           PERFORM CLOSE-brnotacr
           PERFORM CLOSE-destini
           PERFORM CLOSE-tivaese
           PERFORM CLOSE-tcodpag
           PERFORM CLOSE-clienti
           PERFORM CLOSE-articoli
           PERFORM CLOSE-progmag
           PERFORM CLOSE-MAS
           PERFORM CLOSE-tpiombo
      *    tmp-fatturati CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-fatturati
           PERFORM CLOSE-timballi
           PERFORM CLOSE-timbalqta
           PERFORM CLOSE-ttipocli
           PERFORM CLOSE-timposte
           PERFORM CLOSE-tvettori
           PERFORM CLOSE-tmarche
      *    tmp-progmag-zoom CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-progmag-zoom
           PERFORM CLOSE-rordini
           PERFORM CLOSE-tordini
           PERFORM CLOSE-tcaumag
           PERFORM CLOSE-tnotacr
           PERFORM CLOSE-param
           PERFORM CLOSE-tcontat
           PERFORM CLOSE-tnazioni
           PERFORM CLOSE-tmagaz
      *    After Close
           .

       CLOSE-btnotacr.
      * <TOTEM:EPT. INIT:bnotavar, FD:btnotacr, BeforeClose>
      * <TOTEM:END>
           CLOSE btnotacr
           .

       CLOSE-tparamge.
      * <TOTEM:EPT. INIT:bnotavar, FD:tparamge, BeforeClose>
      * <TOTEM:END>
           CLOSE tparamge
           .

       CLOSE-brnotacr.
      * <TOTEM:EPT. INIT:bnotavar, FD:brnotacr, BeforeClose>
      * <TOTEM:END>
           CLOSE brnotacr
           .

       CLOSE-destini.
      * <TOTEM:EPT. INIT:bnotavar, FD:destini, BeforeClose>
      * <TOTEM:END>
           CLOSE destini
           .

       CLOSE-tivaese.
      * <TOTEM:EPT. INIT:bnotavar, FD:tivaese, BeforeClose>
      * <TOTEM:END>
           CLOSE tivaese
           .

       CLOSE-tcodpag.
      * <TOTEM:EPT. INIT:bnotavar, FD:tcodpag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcodpag
           .

       CLOSE-clienti.
      * <TOTEM:EPT. INIT:bnotavar, FD:clienti, BeforeClose>
      * <TOTEM:END>
           CLOSE clienti
           .

       CLOSE-articoli.
      * <TOTEM:EPT. INIT:bnotavar, FD:articoli, BeforeClose>
      * <TOTEM:END>
           CLOSE articoli
           .

       CLOSE-progmag.
      * <TOTEM:EPT. INIT:bnotavar, FD:progmag, BeforeClose>
      * <TOTEM:END>
           CLOSE progmag
           .

       CLOSE-MAS.
      * <TOTEM:EPT. INIT:bnotavar, FD:MAS, BeforeClose>
      * <TOTEM:END>
           CLOSE MAS
           .

       CLOSE-tpiombo.
      * <TOTEM:EPT. INIT:bnotavar, FD:tpiombo, BeforeClose>
      * <TOTEM:END>
           CLOSE tpiombo
           .

       CLOSE-tmp-fatturati.
      * <TOTEM:EPT. INIT:bnotavar, FD:tmp-fatturati, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-timballi.
      * <TOTEM:EPT. INIT:bnotavar, FD:timballi, BeforeClose>
      * <TOTEM:END>
           CLOSE timballi
           .

       CLOSE-timbalqta.
      * <TOTEM:EPT. INIT:bnotavar, FD:timbalqta, BeforeClose>
      * <TOTEM:END>
           CLOSE timbalqta
           .

       CLOSE-ttipocli.
      * <TOTEM:EPT. INIT:bnotavar, FD:ttipocli, BeforeClose>
      * <TOTEM:END>
           CLOSE ttipocli
           .

       CLOSE-timposte.
      * <TOTEM:EPT. INIT:bnotavar, FD:timposte, BeforeClose>
      * <TOTEM:END>
           CLOSE timposte
           .

       CLOSE-tvettori.
      * <TOTEM:EPT. INIT:bnotavar, FD:tvettori, BeforeClose>
      * <TOTEM:END>
           CLOSE tvettori
           .

       CLOSE-tmarche.
      * <TOTEM:EPT. INIT:bnotavar, FD:tmarche, BeforeClose>
      * <TOTEM:END>
           CLOSE tmarche
           .

       CLOSE-tmp-progmag-zoom.
      * <TOTEM:EPT. INIT:bnotavar, FD:tmp-progmag-zoom, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-rordini.
      * <TOTEM:EPT. INIT:bnotavar, FD:rordini, BeforeClose>
      * <TOTEM:END>
           CLOSE rordini
           .

       CLOSE-tordini.
      * <TOTEM:EPT. INIT:bnotavar, FD:tordini, BeforeClose>
      * <TOTEM:END>
           CLOSE tordini
           .

       CLOSE-tcaumag.
      * <TOTEM:EPT. INIT:bnotavar, FD:tcaumag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcaumag
           .

       CLOSE-tnotacr.
      * <TOTEM:EPT. INIT:bnotavar, FD:tnotacr, BeforeClose>
      * <TOTEM:END>
           CLOSE tnotacr
           .

       CLOSE-param.
      * <TOTEM:EPT. INIT:bnotavar, FD:param, BeforeClose>
      * <TOTEM:END>
           CLOSE param
           .

       CLOSE-tcontat.
      * <TOTEM:EPT. INIT:bnotavar, FD:tcontat, BeforeClose>
      * <TOTEM:END>
           CLOSE tcontat
           .

       CLOSE-tnazioni.
      * <TOTEM:EPT. INIT:bnotavar, FD:tnazioni, BeforeClose>
      * <TOTEM:END>
           CLOSE tnazioni
           .

       CLOSE-tmagaz.
      * <TOTEM:EPT. INIT:bnotavar, FD:tmagaz, BeforeClose>
      * <TOTEM:END>
           CLOSE tmagaz
           .

       btnotacr-k1-MERGE-SPLITBUF.
           INITIALIZE btnotacr-k1-SPLITBUF
           MOVE btno-cod-cli(1:5) TO btnotacr-k1-SPLITBUF(1:5)
           MOVE btno-prg-destino(1:5) TO btnotacr-k1-SPLITBUF(6:5)
           MOVE btno-anno(1:4) TO btnotacr-k1-SPLITBUF(11:4)
           MOVE btno-numero(1:8) TO btnotacr-k1-SPLITBUF(15:8)
           .

       btnotacr-k-data-MERGE-SPLITBUF.
           INITIALIZE btnotacr-k-data-SPLITBUF
           MOVE btno-data(1:8) TO btnotacr-k-data-SPLITBUF(1:8)
           MOVE btno-numero(1:8) TO btnotacr-k-data-SPLITBUF(9:8)
           .

       btnotacr-k-fattura-MERGE-SPLITBUF.
           INITIALIZE btnotacr-k-fattura-SPLITBUF
           MOVE btno-anno-fatt(1:4) TO btnotacr-k-fattura-SPLITBUF(1:4)
           MOVE btno-num-fatt(1:8) TO btnotacr-k-fattura-SPLITBUF(5:8)
           .

       btnotacr-k-reso-MERGE-SPLITBUF.
           INITIALIZE btnotacr-k-reso-SPLITBUF
           MOVE btno-anno(1:4) TO btnotacr-k-reso-SPLITBUF(1:4)
           MOVE btno-num-reso(1:8) TO btnotacr-k-reso-SPLITBUF(5:8)
           .

       btnotacr-k-bolla-MERGE-SPLITBUF.
           INITIALIZE btnotacr-k-bolla-SPLITBUF
           MOVE btno-anno-bolla(1:4) TO btnotacr-k-bolla-SPLITBUF(1:4)
           MOVE btno-num-bolla(1:20) TO btnotacr-k-bolla-SPLITBUF(5:20)
           .

       btnotacr-k-vettore-MERGE-SPLITBUF.
           INITIALIZE btnotacr-k-vettore-SPLITBUF
           MOVE btno-vettore(1:5) TO btnotacr-k-vettore-SPLITBUF(1:5)
           MOVE btno-anno(1:4) TO btnotacr-k-vettore-SPLITBUF(6:4)
           MOVE btno-numero(1:8) TO btnotacr-k-vettore-SPLITBUF(10:8)
           .

       btnotacr-k-nota-MERGE-SPLITBUF.
           INITIALIZE btnotacr-k-nota-SPLITBUF
           MOVE btno-anno-nc(1:4) TO btnotacr-k-nota-SPLITBUF(1:4)
           MOVE btno-num-nc(1:8) TO btnotacr-k-nota-SPLITBUF(5:8)
           .

       btnotacr-k-fatman-MERGE-SPLITBUF.
           INITIALIZE btnotacr-k-fatman-SPLITBUF
           MOVE btno-anno-fm(1:4) TO btnotacr-k-fatman-SPLITBUF(1:4)
           MOVE btno-num-fm(1:8) TO btnotacr-k-fatman-SPLITBUF(5:8)
           .

       DataSet1-btnotacr-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-btnotacr-KEY1-Asc
                 MOVE Low-Value TO btno-chiave
              ELSE
                 MOVE High-Value TO btno-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-btnotacr-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-btnotacr-KEY1-Asc
                 MOVE High-Value TO btno-chiave
              ELSE
                 MOVE Low-Value TO btno-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-btnotacr-KEY1-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-btnotacr-KEY1-ORDER
           END-EVALUATE
           .

      * btnotacr
       DataSet1-btnotacr-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-btnotacr-KEY1-Asc
                 START btnotacr KEY >= btno-chiave
              ELSE
                 START btnotacr KEY <= btno-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-btnotacr-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-btnotacr-KEY1-Asc
                 START btnotacr KEY <= btno-chiave
              ELSE
                 START btnotacr KEY >= btno-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-btnotacr-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-btnotacr-KEY1-Asc
                 START btnotacr KEY > btno-chiave
              ELSE
                 START btnotacr KEY < btno-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-btnotacr-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-btnotacr-KEY1-Asc
                 START btnotacr KEY < btno-chiave
              ELSE
                 START btnotacr KEY > btno-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-btnotacr-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-btnotacr-LOCK
                 READ btnotacr WITH LOCK 
                 KEY btno-chiave
              ELSE
                 READ btnotacr WITH NO LOCK 
                 KEY btno-chiave
              END-IF
           END-EVALUATE
           PERFORM btnotacr-k1-MERGE-SPLITBUF
           PERFORM btnotacr-k-data-MERGE-SPLITBUF
           PERFORM btnotacr-k-fattura-MERGE-SPLITBUF
           PERFORM btnotacr-k-reso-MERGE-SPLITBUF
           PERFORM btnotacr-k-bolla-MERGE-SPLITBUF
           PERFORM btnotacr-k-vettore-MERGE-SPLITBUF
           PERFORM btnotacr-k-nota-MERGE-SPLITBUF
           PERFORM btnotacr-k-fatman-MERGE-SPLITBUF
           MOVE STATUS-btnotacr TO TOTEM-ERR-STAT 
           MOVE "btnotacr" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-btnotacr-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-btnotacr-KEY1-Asc
                 IF DataSet1-btnotacr-LOCK
                    READ btnotacr NEXT WITH LOCK
                 ELSE
                    READ btnotacr NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-btnotacr-LOCK
                    READ btnotacr PREVIOUS WITH LOCK
                 ELSE
                    READ btnotacr PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM btnotacr-k1-MERGE-SPLITBUF
           PERFORM btnotacr-k-data-MERGE-SPLITBUF
           PERFORM btnotacr-k-fattura-MERGE-SPLITBUF
           PERFORM btnotacr-k-reso-MERGE-SPLITBUF
           PERFORM btnotacr-k-bolla-MERGE-SPLITBUF
           PERFORM btnotacr-k-vettore-MERGE-SPLITBUF
           PERFORM btnotacr-k-nota-MERGE-SPLITBUF
           PERFORM btnotacr-k-fatman-MERGE-SPLITBUF
           MOVE STATUS-btnotacr TO TOTEM-ERR-STAT
           MOVE "btnotacr" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-btnotacr-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-btnotacr-KEY1-Asc
                 IF DataSet1-btnotacr-LOCK
                    READ btnotacr PREVIOUS WITH LOCK
                 ELSE
                    READ btnotacr PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-btnotacr-LOCK
                    READ btnotacr NEXT WITH LOCK
                 ELSE
                    READ btnotacr NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM btnotacr-k1-MERGE-SPLITBUF
           PERFORM btnotacr-k-data-MERGE-SPLITBUF
           PERFORM btnotacr-k-fattura-MERGE-SPLITBUF
           PERFORM btnotacr-k-reso-MERGE-SPLITBUF
           PERFORM btnotacr-k-bolla-MERGE-SPLITBUF
           PERFORM btnotacr-k-vettore-MERGE-SPLITBUF
           PERFORM btnotacr-k-nota-MERGE-SPLITBUF
           PERFORM btnotacr-k-fatman-MERGE-SPLITBUF
           MOVE STATUS-btnotacr TO TOTEM-ERR-STAT
           MOVE "btnotacr" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-btnotacr-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, BeforeWrite>
      * <TOTEM:END>
           WRITE btno-rec OF btnotacr.
           MOVE STATUS-btnotacr TO TOTEM-ERR-STAT
           MOVE "btnotacr" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-btnotacr-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, BeforeRewrite>
      * <TOTEM:END>
           REWRITE btno-rec OF btnotacr.
           MOVE STATUS-btnotacr TO TOTEM-ERR-STAT
           MOVE "btnotacr" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-btnotacr-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, BeforeDelete>
      * <TOTEM:END>
           DELETE btnotacr.
           MOVE STATUS-btnotacr TO TOTEM-ERR-STAT
           MOVE "btnotacr" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:btnotacr, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tparamge-INITSTART.
           IF DataSet1-tparamge-KEY-Asc
              MOVE Low-Value TO tge-chiave
           ELSE
              MOVE High-Value TO tge-chiave
           END-IF
           .

       DataSet1-tparamge-INITEND.
           IF DataSet1-tparamge-KEY-Asc
              MOVE High-Value TO tge-chiave
           ELSE
              MOVE Low-Value TO tge-chiave
           END-IF
           .

      * tparamge
       DataSet1-tparamge-START.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY >= tge-chiave
           ELSE
              START tparamge KEY <= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-NOTGREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY <= tge-chiave
           ELSE
              START tparamge KEY >= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-GREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY > tge-chiave
           ELSE
              START tparamge KEY < tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-LESS.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY < tge-chiave
           ELSE
              START tparamge KEY > tge-chiave
           END-IF
           .

       DataSet1-tparamge-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tparamge-LOCK
              READ tparamge WITH LOCK 
              KEY tge-chiave
           ELSE
              READ tparamge WITH NO LOCK 
              KEY tge-chiave
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT 
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterDelete>
      * <TOTEM:END>
           .

       brnotacr-brno-k-articolo-MERGE-SPLITBUF.
           INITIALIZE brnotacr-brno-k-articolo-SPLITBUF
           MOVE brno-cod-articolo(1:6) TO 
           brnotacr-brno-k-articolo-SPLITBUF(1:6)
           MOVE brno-chiave(1:18) TO 
           brnotacr-brno-k-articolo-SPLITBUF(7:18)
           .

       DataSet1-brnotacr-INITSTART.
           IF DataSet1-brnotacr-KEY-Asc
              MOVE Low-Value TO brno-chiave
           ELSE
              MOVE High-Value TO brno-chiave
           END-IF
           .

       DataSet1-brnotacr-INITEND.
           IF DataSet1-brnotacr-KEY-Asc
              MOVE High-Value TO brno-chiave
           ELSE
              MOVE Low-Value TO brno-chiave
           END-IF
           .

      * brnotacr
       DataSet1-brnotacr-START.
           IF DataSet1-brnotacr-KEY-Asc
              START brnotacr KEY >= brno-chiave
           ELSE
              START brnotacr KEY <= brno-chiave
           END-IF
           .

       DataSet1-brnotacr-START-NOTGREATER.
           IF DataSet1-brnotacr-KEY-Asc
              START brnotacr KEY <= brno-chiave
           ELSE
              START brnotacr KEY >= brno-chiave
           END-IF
           .

       DataSet1-brnotacr-START-GREATER.
           IF DataSet1-brnotacr-KEY-Asc
              START brnotacr KEY > brno-chiave
           ELSE
              START brnotacr KEY < brno-chiave
           END-IF
           .

       DataSet1-brnotacr-START-LESS.
           IF DataSet1-brnotacr-KEY-Asc
              START brnotacr KEY < brno-chiave
           ELSE
              START brnotacr KEY > brno-chiave
           END-IF
           .

       DataSet1-brnotacr-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-brnotacr-LOCK
              READ brnotacr WITH LOCK 
              KEY brno-chiave
           ELSE
              READ brnotacr WITH NO LOCK 
              KEY brno-chiave
           END-IF
           PERFORM brnotacr-brno-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT 
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-brnotacr-KEY-Asc
              IF DataSet1-brnotacr-LOCK
                 READ brnotacr NEXT WITH LOCK
              ELSE
                 READ brnotacr NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-brnotacr-LOCK
                 READ brnotacr PREVIOUS WITH LOCK
              ELSE
                 READ brnotacr PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM brnotacr-brno-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-brnotacr-KEY-Asc
              IF DataSet1-brnotacr-LOCK
                 READ brnotacr PREVIOUS WITH LOCK
              ELSE
                 READ brnotacr PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-brnotacr-LOCK
                 READ brnotacr NEXT WITH LOCK
              ELSE
                 READ brnotacr NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM brnotacr-brno-k-articolo-MERGE-SPLITBUF
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeWrite>
      * <TOTEM:END>
           WRITE brno-rec OF brnotacr.
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeRewrite>
      * <TOTEM:END>
           REWRITE brno-rec OF brnotacr.
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-brnotacr-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, BeforeDelete>
      * <TOTEM:END>
           DELETE brnotacr.
           MOVE STATUS-brnotacr TO TOTEM-ERR-STAT
           MOVE "brnotacr" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:brnotacr, AfterDelete>
      * <TOTEM:END>
           .

       destini-K1-MERGE-SPLITBUF.
           INITIALIZE destini-K1-SPLITBUF
           MOVE des-ragsoc-1(1:100) TO destini-K1-SPLITBUF(1:100)
           MOVE des-codice(1:5) TO destini-K1-SPLITBUF(101:5)
           MOVE des-prog(1:5) TO destini-K1-SPLITBUF(106:5)
           .

       destini-k-localita-MERGE-SPLITBUF.
           INITIALIZE destini-k-localita-SPLITBUF
           MOVE des-localita(1:35) TO destini-k-localita-SPLITBUF(1:35)
           .

       DataSet1-destini-INITSTART.
           IF DataSet1-destini-KEY-Asc
              MOVE Low-Value TO des-chiave
           ELSE
              MOVE High-Value TO des-chiave
           END-IF
           .

       DataSet1-destini-INITEND.
           IF DataSet1-destini-KEY-Asc
              MOVE High-Value TO des-chiave
           ELSE
              MOVE Low-Value TO des-chiave
           END-IF
           .

      * destini
       DataSet1-destini-START.
           IF DataSet1-destini-KEY-Asc
              START destini KEY >= des-chiave
           ELSE
              START destini KEY <= des-chiave
           END-IF
           .

       DataSet1-destini-START-NOTGREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY <= des-chiave
           ELSE
              START destini KEY >= des-chiave
           END-IF
           .

       DataSet1-destini-START-GREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY > des-chiave
           ELSE
              START destini KEY < des-chiave
           END-IF
           .

       DataSet1-destini-START-LESS.
           IF DataSet1-destini-KEY-Asc
              START destini KEY < des-chiave
           ELSE
              START destini KEY > des-chiave
           END-IF
           .

       DataSet1-destini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-destini-LOCK
              READ destini WITH LOCK 
              KEY des-chiave
           ELSE
              READ destini WITH NO LOCK 
              KEY des-chiave
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT 
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterDelete>
      * <TOTEM:END>
           .

       tivaese-key01-MERGE-SPLITBUF.
           INITIALIZE tivaese-key01-SPLITBUF
           MOVE TBLIV-CODICE1(1:2) TO tivaese-key01-SPLITBUF(1:2)
           MOVE TBLIV-DESCRIZIONE1(1:30) TO tivaese-key01-SPLITBUF(3:30)
           MOVE TBLIV-CODICE2(1:20) TO tivaese-key01-SPLITBUF(33:20)
           .

       DataSet1-tivaese-INITSTART.
           IF DataSet1-tivaese-KEY-Asc
              MOVE Low-Value TO TBLIV-CODICE
           ELSE
              MOVE High-Value TO TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-INITEND.
           IF DataSet1-tivaese-KEY-Asc
              MOVE High-Value TO TBLIV-CODICE
           ELSE
              MOVE Low-Value TO TBLIV-CODICE
           END-IF
           .

      * tivaese
       DataSet1-tivaese-START.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY >= TBLIV-CODICE
           ELSE
              START tivaese KEY <= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-NOTGREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY <= TBLIV-CODICE
           ELSE
              START tivaese KEY >= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-GREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY > TBLIV-CODICE
           ELSE
              START tivaese KEY < TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-LESS.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY < TBLIV-CODICE
           ELSE
              START tivaese KEY > TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tivaese-LOCK
              READ tivaese WITH LOCK 
              KEY TBLIV-CODICE
           ELSE
              READ tivaese WITH NO LOCK 
              KEY TBLIV-CODICE
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT 
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterDelete>
      * <TOTEM:END>
           .

       tcodpag-TBL-CODICE-01-MERGE-SPLITBUF.
           INITIALIZE tcodpag-TBL-CODICE-01-SPLITBUF
           MOVE TBLPA-CODICE1(1:2) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(1:2)
           MOVE TBLPA-DESCRIZIONE1(1:30) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(3:30)
           MOVE TBLPA-CODICE2(1:20) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(33:20)
           .

       DataSet1-tcodpag-INITSTART.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE Low-Value TO TBLPA-CODICE
           ELSE
              MOVE High-Value TO TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-INITEND.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE High-Value TO TBLPA-CODICE
           ELSE
              MOVE Low-Value TO TBLPA-CODICE
           END-IF
           .

      * tcodpag
       DataSet1-tcodpag-START.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY >= TBLPA-CODICE
           ELSE
              START tcodpag KEY <= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-NOTGREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY <= TBLPA-CODICE
           ELSE
              START tcodpag KEY >= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-GREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY > TBLPA-CODICE
           ELSE
              START tcodpag KEY < TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-LESS.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY < TBLPA-CODICE
           ELSE
              START tcodpag KEY > TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcodpag-LOCK
              READ tcodpag WITH LOCK 
              KEY TBLPA-CODICE
           ELSE
              READ tcodpag WITH NO LOCK 
              KEY TBLPA-CODICE
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT 
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeWrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRewrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeDelete>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterDelete>
      * <TOTEM:END>
           .

       clienti-cli-K1-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K1-SPLITBUF
           MOVE cli-tipo-CF OF clienti(1:1) TO 
           clienti-cli-K1-SPLITBUF(1:1)
           MOVE cli-ragsoc-1 OF clienti(1:40) TO 
           clienti-cli-K1-SPLITBUF(2:40)
           MOVE cli-codice OF clienti(1:5) TO 
           clienti-cli-K1-SPLITBUF(42:5)
           .

       clienti-cli-K3-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K3-SPLITBUF
           MOVE cli-gdo OF clienti(1:5) TO clienti-cli-K3-SPLITBUF(1:5)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K3-SPLITBUF(6:6)
           .

       clienti-cli-K4-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K4-SPLITBUF
           MOVE cli-utf OF clienti(1:1) TO clienti-cli-K4-SPLITBUF(1:1)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K4-SPLITBUF(2:6)
           .

       DataSet1-clienti-INITSTART.
           IF DataSet1-clienti-KEY-Asc
              MOVE Low-Value TO cli-chiave OF clienti
           ELSE
              MOVE High-Value TO cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-INITEND.
           IF DataSet1-clienti-KEY-Asc
              MOVE High-Value TO cli-chiave OF clienti
           ELSE
              MOVE Low-Value TO cli-chiave OF clienti
           END-IF
           .

      * clienti
       DataSet1-clienti-START.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY >= cli-chiave OF clienti
           ELSE
              START clienti KEY <= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-NOTGREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY <= cli-chiave OF clienti
           ELSE
              START clienti KEY >= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-GREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY > cli-chiave OF clienti
           ELSE
              START clienti KEY < cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-LESS.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY < cli-chiave OF clienti
           ELSE
              START clienti KEY > cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-clienti-LOCK
              READ clienti WITH LOCK 
              KEY cli-chiave OF clienti
           ELSE
              READ clienti WITH NO LOCK 
              KEY cli-chiave OF clienti
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT 
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterDelete>
      * <TOTEM:END>
           .

       articoli-art-k1-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k1-SPLITBUF
           MOVE art-descrizione OF articoli(1:50) TO 
           articoli-art-k1-SPLITBUF(1:50)
           .

       articoli-art-k-frn-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k-frn-SPLITBUF
           MOVE art-cod-art-frn OF articoli(1:15) TO 
           articoli-art-k-frn-SPLITBUF(1:15)
           .

       DataSet1-articoli-INITSTART.
           IF DataSet1-articoli-KEY-Asc
              MOVE Low-Value TO art-chiave OF articoli
           ELSE
              MOVE High-Value TO art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-INITEND.
           IF DataSet1-articoli-KEY-Asc
              MOVE High-Value TO art-chiave OF articoli
           ELSE
              MOVE Low-Value TO art-chiave OF articoli
           END-IF
           .

      * articoli
       DataSet1-articoli-START.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY >= art-chiave OF articoli
           ELSE
              START articoli KEY <= art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-NOTGREATER.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY <= art-chiave OF articoli
           ELSE
              START articoli KEY >= art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-GREATER.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY > art-chiave OF articoli
           ELSE
              START articoli KEY < art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-LESS.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY < art-chiave OF articoli
           ELSE
              START articoli KEY > art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-articoli-LOCK
              READ articoli WITH LOCK 
              KEY art-chiave OF articoli
           ELSE
              READ articoli WITH NO LOCK 
              KEY art-chiave OF articoli
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT 
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-articoli-KEY-Asc
              IF DataSet1-articoli-LOCK
                 READ articoli NEXT WITH LOCK
              ELSE
                 READ articoli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli-LOCK
                 READ articoli PREVIOUS WITH LOCK
              ELSE
                 READ articoli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-articoli-KEY-Asc
              IF DataSet1-articoli-LOCK
                 READ articoli PREVIOUS WITH LOCK
              ELSE
                 READ articoli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli-LOCK
                 READ articoli NEXT WITH LOCK
              ELSE
                 READ articoli NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterDelete>
      * <TOTEM:END>
           .

       progmag-key01-MERGE-SPLITBUF.
           INITIALIZE progmag-key01-SPLITBUF
           MOVE prg-cod-magazzino OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(1:3)
           MOVE prg-cod-articolo OF progmag(1:6) TO 
           progmag-key01-SPLITBUF(4:6)
           MOVE prg-tipo-imballo OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(10:3)
           MOVE prg-peso OF progmag(1:8) TO progmag-key01-SPLITBUF(13:8)
           .

       DataSet1-progmag-INITSTART.
           IF DataSet1-progmag-KEY-Asc
              MOVE Low-Value TO prg-chiave OF progmag
           ELSE
              MOVE High-Value TO prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-INITEND.
           IF DataSet1-progmag-KEY-Asc
              MOVE High-Value TO prg-chiave OF progmag
           ELSE
              MOVE Low-Value TO prg-chiave OF progmag
           END-IF
           .

      * progmag
       DataSet1-progmag-START.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY >= prg-chiave OF progmag
           ELSE
              START progmag KEY <= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-NOTGREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY <= prg-chiave OF progmag
           ELSE
              START progmag KEY >= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-GREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY > prg-chiave OF progmag
           ELSE
              START progmag KEY < prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-LESS.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY < prg-chiave OF progmag
           ELSE
              START progmag KEY > prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-progmag-LOCK
              READ progmag WITH LOCK 
              KEY prg-chiave OF progmag
           ELSE
              READ progmag WITH NO LOCK 
              KEY prg-chiave OF progmag
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT 
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterDelete>
      * <TOTEM:END>
           .

       MAS-MAS-CODICE1-MERGE-SPLITBUF.
           INITIALIZE MAS-MAS-CODICE1-SPLITBUF
           MOVE MAS-CODICE-ALTERNATIVO(1:30) TO 
           MAS-MAS-CODICE1-SPLITBUF(1:30)
           MOVE MAS-CODICE(1:8) TO MAS-MAS-CODICE1-SPLITBUF(31:8)
           .

       MAS-MAS-CODICE2-MERGE-SPLITBUF.
           INITIALIZE MAS-MAS-CODICE2-SPLITBUF
           MOVE MAS-DESCRIZIONE1(1:30) TO MAS-MAS-CODICE2-SPLITBUF(1:30)
           MOVE MAS-CODICE(1:8) TO MAS-MAS-CODICE2-SPLITBUF(31:8)
           .

       DataSet1-MAS-INITSTART.
           IF DataSet1-MAS-KEY-Asc
              MOVE Low-Value TO MAS-CODICE
           ELSE
              MOVE High-Value TO MAS-CODICE
           END-IF
           .

       DataSet1-MAS-INITEND.
           IF DataSet1-MAS-KEY-Asc
              MOVE High-Value TO MAS-CODICE
           ELSE
              MOVE Low-Value TO MAS-CODICE
           END-IF
           .

      * MAS
       DataSet1-MAS-START.
           IF DataSet1-MAS-KEY-Asc
              START MAS KEY >= MAS-CODICE
           ELSE
              START MAS KEY <= MAS-CODICE
           END-IF
           .

       DataSet1-MAS-START-NOTGREATER.
           IF DataSet1-MAS-KEY-Asc
              START MAS KEY <= MAS-CODICE
           ELSE
              START MAS KEY >= MAS-CODICE
           END-IF
           .

       DataSet1-MAS-START-GREATER.
           IF DataSet1-MAS-KEY-Asc
              START MAS KEY > MAS-CODICE
           ELSE
              START MAS KEY < MAS-CODICE
           END-IF
           .

       DataSet1-MAS-START-LESS.
           IF DataSet1-MAS-KEY-Asc
              START MAS KEY < MAS-CODICE
           ELSE
              START MAS KEY > MAS-CODICE
           END-IF
           .

       DataSet1-MAS-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-MAS-LOCK
              READ MAS WITH LOCK 
              KEY MAS-CODICE
           ELSE
              READ MAS WITH NO LOCK 
              KEY MAS-CODICE
           END-IF
           PERFORM MAS-MAS-CODICE1-MERGE-SPLITBUF
           PERFORM MAS-MAS-CODICE2-MERGE-SPLITBUF
           MOVE STATUS-MAS TO TOTEM-ERR-STAT 
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-MAS-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-MAS-KEY-Asc
              IF DataSet1-MAS-LOCK
                 READ MAS NEXT WITH LOCK
              ELSE
                 READ MAS NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-MAS-LOCK
                 READ MAS PREVIOUS WITH LOCK
              ELSE
                 READ MAS PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM MAS-MAS-CODICE1-MERGE-SPLITBUF
           PERFORM MAS-MAS-CODICE2-MERGE-SPLITBUF
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-MAS-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-MAS-KEY-Asc
              IF DataSet1-MAS-LOCK
                 READ MAS PREVIOUS WITH LOCK
              ELSE
                 READ MAS PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-MAS-LOCK
                 READ MAS NEXT WITH LOCK
              ELSE
                 READ MAS NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM MAS-MAS-CODICE1-MERGE-SPLITBUF
           PERFORM MAS-MAS-CODICE2-MERGE-SPLITBUF
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-MAS-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-MAS-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-MAS-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-MAS TO TOTEM-ERR-STAT
           MOVE "MAS" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:MAS, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-INITSTART.
           IF DataSet1-tpiombo-KEY-Asc
              MOVE Low-Value TO tpb-chiave
           ELSE
              MOVE High-Value TO tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-INITEND.
           IF DataSet1-tpiombo-KEY-Asc
              MOVE High-Value TO tpb-chiave
           ELSE
              MOVE Low-Value TO tpb-chiave
           END-IF
           .

      * tpiombo
       DataSet1-tpiombo-START.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY >= tpb-chiave
           ELSE
              START tpiombo KEY <= tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-NOTGREATER.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY <= tpb-chiave
           ELSE
              START tpiombo KEY >= tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-GREATER.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY > tpb-chiave
           ELSE
              START tpiombo KEY < tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-LESS.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY < tpb-chiave
           ELSE
              START tpiombo KEY > tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tpiombo-LOCK
              READ tpiombo WITH LOCK 
              KEY tpb-chiave
           ELSE
              READ tpiombo WITH NO LOCK 
              KEY tpb-chiave
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT 
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tpiombo-KEY-Asc
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo NEXT WITH LOCK
              ELSE
                 READ tpiombo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo PREVIOUS WITH LOCK
              ELSE
                 READ tpiombo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tpiombo-KEY-Asc
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo PREVIOUS WITH LOCK
              ELSE
                 READ tpiombo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo NEXT WITH LOCK
              ELSE
                 READ tpiombo NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterDelete>
      * <TOTEM:END>
           .

       tmp-fatturati-k-ord-MERGE-SPLITBUF.
           INITIALIZE tmp-fatturati-k-ord-SPLITBUF
           MOVE tmp-f-data(1:8) TO tmp-fatturati-k-ord-SPLITBUF(1:8)
           MOVE tmp-f-num(1:8) TO tmp-fatturati-k-ord-SPLITBUF(9:8)
           .

       DataSet1-tmp-fatturati-INITSTART.
           IF DataSet1-tmp-fatturati-KEY-Asc
              MOVE Low-Value TO tmp-f-chiave
           ELSE
              MOVE High-Value TO tmp-f-chiave
           END-IF
           .

       DataSet1-tmp-fatturati-INITEND.
           IF DataSet1-tmp-fatturati-KEY-Asc
              MOVE High-Value TO tmp-f-chiave
           ELSE
              MOVE Low-Value TO tmp-f-chiave
           END-IF
           .

      * tmp-fatturati
       DataSet1-tmp-fatturati-START.
           IF DataSet1-tmp-fatturati-KEY-Asc
              START tmp-fatturati KEY >= tmp-f-chiave
           ELSE
              START tmp-fatturati KEY <= tmp-f-chiave
           END-IF
           .

       DataSet1-tmp-fatturati-START-NOTGREATER.
           IF DataSet1-tmp-fatturati-KEY-Asc
              START tmp-fatturati KEY <= tmp-f-chiave
           ELSE
              START tmp-fatturati KEY >= tmp-f-chiave
           END-IF
           .

       DataSet1-tmp-fatturati-START-GREATER.
           IF DataSet1-tmp-fatturati-KEY-Asc
              START tmp-fatturati KEY > tmp-f-chiave
           ELSE
              START tmp-fatturati KEY < tmp-f-chiave
           END-IF
           .

       DataSet1-tmp-fatturati-START-LESS.
           IF DataSet1-tmp-fatturati-KEY-Asc
              START tmp-fatturati KEY < tmp-f-chiave
           ELSE
              START tmp-fatturati KEY > tmp-f-chiave
           END-IF
           .

       DataSet1-tmp-fatturati-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmp-fatturati-LOCK
              READ tmp-fatturati WITH LOCK 
              KEY tmp-f-chiave
           ELSE
              READ tmp-fatturati WITH NO LOCK 
              KEY tmp-f-chiave
           END-IF
           PERFORM tmp-fatturati-k-ord-MERGE-SPLITBUF
           MOVE STATUS-tmp-fatturati TO TOTEM-ERR-STAT 
           MOVE "tmp-fatturati" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-fatturati-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmp-fatturati-KEY-Asc
              IF DataSet1-tmp-fatturati-LOCK
                 READ tmp-fatturati NEXT WITH LOCK
              ELSE
                 READ tmp-fatturati NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmp-fatturati-LOCK
                 READ tmp-fatturati PREVIOUS WITH LOCK
              ELSE
                 READ tmp-fatturati PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tmp-fatturati-k-ord-MERGE-SPLITBUF
           MOVE STATUS-tmp-fatturati TO TOTEM-ERR-STAT
           MOVE "tmp-fatturati" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-fatturati-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmp-fatturati-KEY-Asc
              IF DataSet1-tmp-fatturati-LOCK
                 READ tmp-fatturati PREVIOUS WITH LOCK
              ELSE
                 READ tmp-fatturati PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmp-fatturati-LOCK
                 READ tmp-fatturati NEXT WITH LOCK
              ELSE
                 READ tmp-fatturati NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tmp-fatturati-k-ord-MERGE-SPLITBUF
           MOVE STATUS-tmp-fatturati TO TOTEM-ERR-STAT
           MOVE "tmp-fatturati" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-fatturati-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-fatturati TO TOTEM-ERR-STAT
           MOVE "tmp-fatturati" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-fatturati-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-fatturati TO TOTEM-ERR-STAT
           MOVE "tmp-fatturati" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-fatturati-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-fatturati TO TOTEM-ERR-STAT
           MOVE "tmp-fatturati" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-fatturati, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timballi-INITSTART.
           IF DataSet1-timballi-KEY-Asc
              MOVE Low-Value TO imb-chiave
           ELSE
              MOVE High-Value TO imb-chiave
           END-IF
           .

       DataSet1-timballi-INITEND.
           IF DataSet1-timballi-KEY-Asc
              MOVE High-Value TO imb-chiave
           ELSE
              MOVE Low-Value TO imb-chiave
           END-IF
           .

      * timballi
       DataSet1-timballi-START.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY >= imb-chiave
           ELSE
              START timballi KEY <= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-NOTGREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY <= imb-chiave
           ELSE
              START timballi KEY >= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-GREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY > imb-chiave
           ELSE
              START timballi KEY < imb-chiave
           END-IF
           .

       DataSet1-timballi-START-LESS.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY < imb-chiave
           ELSE
              START timballi KEY > imb-chiave
           END-IF
           .

       DataSet1-timballi-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timballi-LOCK
              READ timballi WITH LOCK 
              KEY imb-chiave
           ELSE
              READ timballi WITH NO LOCK 
              KEY imb-chiave
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT 
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-INITSTART.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE Low-Value TO imq-chiave
           ELSE
              MOVE High-Value TO imq-chiave
           END-IF
           .

       DataSet1-timbalqta-INITEND.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE High-Value TO imq-chiave
           ELSE
              MOVE Low-Value TO imq-chiave
           END-IF
           .

      * timbalqta
       DataSet1-timbalqta-START.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY >= imq-chiave
           ELSE
              START timbalqta KEY <= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-NOTGREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY <= imq-chiave
           ELSE
              START timbalqta KEY >= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-GREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY > imq-chiave
           ELSE
              START timbalqta KEY < imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-LESS.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY < imq-chiave
           ELSE
              START timbalqta KEY > imq-chiave
           END-IF
           .

       DataSet1-timbalqta-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timbalqta-LOCK
              READ timbalqta WITH LOCK 
              KEY imq-chiave
           ELSE
              READ timbalqta WITH NO LOCK 
              KEY imq-chiave
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT 
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-INITSTART.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE Low-Value TO tcl-chiave
           ELSE
              MOVE High-Value TO tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-INITEND.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE High-Value TO tcl-chiave
           ELSE
              MOVE Low-Value TO tcl-chiave
           END-IF
           .

      * ttipocli
       DataSet1-ttipocli-START.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY >= tcl-chiave
           ELSE
              START ttipocli KEY <= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-NOTGREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY <= tcl-chiave
           ELSE
              START ttipocli KEY >= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-GREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY > tcl-chiave
           ELSE
              START ttipocli KEY < tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-LESS.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY < tcl-chiave
           ELSE
              START ttipocli KEY > tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-ttipocli-LOCK
              READ ttipocli WITH LOCK 
              KEY tcl-chiave
           ELSE
              READ ttipocli WITH NO LOCK 
              KEY tcl-chiave
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT 
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timposte-INITSTART.
           IF DataSet1-timposte-KEY-Asc
              MOVE Low-Value TO imp-chiave
           ELSE
              MOVE High-Value TO imp-chiave
           END-IF
           .

       DataSet1-timposte-INITEND.
           IF DataSet1-timposte-KEY-Asc
              MOVE High-Value TO imp-chiave
           ELSE
              MOVE Low-Value TO imp-chiave
           END-IF
           .

      * timposte
       DataSet1-timposte-START.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY >= imp-chiave
           ELSE
              START timposte KEY <= imp-chiave
           END-IF
           .

       DataSet1-timposte-START-NOTGREATER.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY <= imp-chiave
           ELSE
              START timposte KEY >= imp-chiave
           END-IF
           .

       DataSet1-timposte-START-GREATER.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY > imp-chiave
           ELSE
              START timposte KEY < imp-chiave
           END-IF
           .

       DataSet1-timposte-START-LESS.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY < imp-chiave
           ELSE
              START timposte KEY > imp-chiave
           END-IF
           .

       DataSet1-timposte-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timposte-LOCK
              READ timposte WITH LOCK 
              KEY imp-chiave
           ELSE
              READ timposte WITH NO LOCK 
              KEY imp-chiave
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT 
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timposte-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timposte-KEY-Asc
              IF DataSet1-timposte-LOCK
                 READ timposte NEXT WITH LOCK
              ELSE
                 READ timposte NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timposte-LOCK
                 READ timposte PREVIOUS WITH LOCK
              ELSE
                 READ timposte PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timposte-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timposte-KEY-Asc
              IF DataSet1-timposte-LOCK
                 READ timposte PREVIOUS WITH LOCK
              ELSE
                 READ timposte PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timposte-LOCK
                 READ timposte NEXT WITH LOCK
              ELSE
                 READ timposte NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterDelete>
      * <TOTEM:END>
           .

       tvettori-k-des-MERGE-SPLITBUF.
           INITIALIZE tvettori-k-des-SPLITBUF
           MOVE vet-descrizione(1:40) TO tvettori-k-des-SPLITBUF(1:40)
           .

       DataSet1-tvettori-INITSTART.
           IF DataSet1-tvettori-KEY-Asc
              MOVE Low-Value TO vet-chiave
           ELSE
              MOVE High-Value TO vet-chiave
           END-IF
           .

       DataSet1-tvettori-INITEND.
           IF DataSet1-tvettori-KEY-Asc
              MOVE High-Value TO vet-chiave
           ELSE
              MOVE Low-Value TO vet-chiave
           END-IF
           .

      * tvettori
       DataSet1-tvettori-START.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY >= vet-chiave
           ELSE
              START tvettori KEY <= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-NOTGREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY <= vet-chiave
           ELSE
              START tvettori KEY >= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-GREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY > vet-chiave
           ELSE
              START tvettori KEY < vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-LESS.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY < vet-chiave
           ELSE
              START tvettori KEY > vet-chiave
           END-IF
           .

       DataSet1-tvettori-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tvettori-LOCK
              READ tvettori WITH LOCK 
              KEY vet-chiave
           ELSE
              READ tvettori WITH NO LOCK 
              KEY vet-chiave
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT 
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmarche-INITSTART.
           IF DataSet1-tmarche-KEY-Asc
              MOVE Low-Value TO mar-chiave
           ELSE
              MOVE High-Value TO mar-chiave
           END-IF
           .

       DataSet1-tmarche-INITEND.
           IF DataSet1-tmarche-KEY-Asc
              MOVE High-Value TO mar-chiave
           ELSE
              MOVE Low-Value TO mar-chiave
           END-IF
           .

      * tmarche
       DataSet1-tmarche-START.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY >= mar-chiave
           ELSE
              START tmarche KEY <= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-NOTGREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY <= mar-chiave
           ELSE
              START tmarche KEY >= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-GREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY > mar-chiave
           ELSE
              START tmarche KEY < mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-LESS.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY < mar-chiave
           ELSE
              START tmarche KEY > mar-chiave
           END-IF
           .

       DataSet1-tmarche-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmarche-LOCK
              READ tmarche WITH LOCK 
              KEY mar-chiave
           ELSE
              READ tmarche WITH NO LOCK 
              KEY mar-chiave
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT 
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterDelete>
      * <TOTEM:END>
           .

       tmp-progmag-zoom-key-des-MERGE-SPLITBUF.
           INITIALIZE tmp-progmag-zoom-key-des-SPLITBUF
           MOVE tmp-prg-z-art-des(1:40) TO 
           tmp-progmag-zoom-key-des-SPLITBUF(1:40)
           MOVE tmp-prg-z-chiave(1:23) TO 
           tmp-progmag-zoom-key-des-SPLITBUF(41:23)
           .

       tmp-progmag-zoom-key-des-SPLITBUF-TOFLD.
           MOVE tmp-progmag-zoom-key-des-SPLITBUF(1:40) TO 
           tmp-prg-z-art-des(1:40)
           MOVE tmp-progmag-zoom-key-des-SPLITBUF(41:23) TO 
           tmp-prg-z-chiave(1:23)
           .

       tmp-progmag-zoom-key-art-MERGE-SPLITBUF.
           INITIALIZE tmp-progmag-zoom-key-art-SPLITBUF
           MOVE tmp-prg-z-cod-articolo(1:6) TO 
           tmp-progmag-zoom-key-art-SPLITBUF(1:6)
           .

       DataSet1-tmp-progmag-zoom-INITSTART.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE Low-Value TO tmp-prg-z-art-des
           ELSE
              MOVE High-Value TO tmp-prg-z-art-des
           END-IF
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE Low-Value TO tmp-prg-z-chiave
           ELSE
              MOVE High-Value TO tmp-prg-z-chiave
           END-IF
           .

       DataSet1-tmp-progmag-zoom-INITEND.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE High-Value to tmp-prg-z-art-des
           ELSE
              MOVE Low-Value to tmp-prg-z-art-des
           END-IF
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE High-Value to tmp-prg-z-chiave
           ELSE
              MOVE Low-Value to tmp-prg-z-chiave
           END-IF
           .

       DataSet1-tmp-progmag-zoom-TMPBUF-TO-FLD.
           MOVE DataSet1-tmp-progmag-zoom-SPLIT-BUF1(1:40) TO
                tmp-prg-z-art-des(1:40)
           MOVE DataSet1-tmp-progmag-zoom-SPLIT-BUF1(41:23) TO
                tmp-prg-z-chiave(1:23)
           .

       DataSet1-tmp-progmag-zoom-FLD-TO-TMPBUF.
           MOVE tmp-prg-z-art-des(1:40) TO
                DataSet1-tmp-progmag-zoom-SPLIT-BUF1(1:40)
           MOVE tmp-prg-z-chiave(1:23) TO
                DataSet1-tmp-progmag-zoom-SPLIT-BUF1(41:23)
           .

      * tmp-progmag-zoom
       DataSet1-tmp-progmag-zoom-START.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY >= key-des
           ELSE
              START tmp-progmag-zoom KEY <= key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-START-NOTGREATER.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY <= key-des
           ELSE
              START tmp-progmag-zoom KEY >= key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-START-GREATER.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY > key-des
           ELSE
              START tmp-progmag-zoom KEY < key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-START-LESS.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY < key-des
           ELSE
              START tmp-progmag-zoom KEY > key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeWrite>
      * <TOTEM:END>
           WRITE tmp-prg-z-rec OF tmp-progmag-zoom.
           MOVE STATUS-tmp-progmag-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-progmag-zoom" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-progmag-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-progmag-zoom" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-progmag-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-progmag-zoom" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterDelete>
      * <TOTEM:END>
           .

       rordini-ror-k-promo-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-promo-SPLITBUF
           MOVE ror-promo OF rordini(1:15) TO 
           rordini-ror-k-promo-SPLITBUF(1:15)
           .

       rordini-ror-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-articolo-SPLITBUF
           MOVE ror-cod-articolo OF rordini(1:6) TO 
           rordini-ror-k-articolo-SPLITBUF(1:6)
           MOVE ror-chiave OF rordini(1:17) TO 
           rordini-ror-k-articolo-SPLITBUF(7:17)
           .

       rordini-ror-k-master-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-master-SPLITBUF
           MOVE ror-chiave-ordine OF rordini(1:17) TO 
           rordini-ror-k-master-SPLITBUF(1:17)
           MOVE ror-chiave OF rordini(1:17) TO 
           rordini-ror-k-master-SPLITBUF(18:17)
           .

       rordini-ror-k-stbolle-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-stbolle-SPLITBUF
           MOVE ror-anno OF rordini(1:4) TO 
           rordini-ror-k-stbolle-SPLITBUF(1:4)
           MOVE ror-num-ordine OF rordini(1:8) TO 
           rordini-ror-k-stbolle-SPLITBUF(5:8)
           MOVE ror-chiave-ordine OF rordini(1:17) TO 
           rordini-ror-k-stbolle-SPLITBUF(13:17)
           .

       rordini-ror-k-ord-art-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-ord-art-SPLITBUF
           MOVE ror-anno OF rordini(1:4) TO 
           rordini-ror-k-ord-art-SPLITBUF(1:4)
           MOVE ror-num-ordine OF rordini(1:8) TO 
           rordini-ror-k-ord-art-SPLITBUF(5:8)
           MOVE ror-cod-articolo OF rordini(1:6) TO 
           rordini-ror-k-ord-art-SPLITBUF(13:6)
           .

       DataSet1-rordini-INITSTART.
           IF DataSet1-rordini-KEY-Asc
              MOVE Low-Value TO ror-chiave of rordini
           ELSE
              MOVE High-Value TO ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-INITEND.
           IF DataSet1-rordini-KEY-Asc
              MOVE High-Value TO ror-chiave of rordini
           ELSE
              MOVE Low-Value TO ror-chiave of rordini
           END-IF
           .

      * rordini
       DataSet1-rordini-START.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY >= ror-chiave of rordini
           ELSE
              START rordini KEY <= ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-START-NOTGREATER.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY <= ror-chiave of rordini
           ELSE
              START rordini KEY >= ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-START-GREATER.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY > ror-chiave of rordini
           ELSE
              START rordini KEY < ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-START-LESS.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY < ror-chiave of rordini
           ELSE
              START rordini KEY > ror-chiave of rordini
           END-IF
           .

       DataSet1-rordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rordini-LOCK
              READ rordini WITH LOCK 
              KEY ror-chiave of rordini
           ELSE
              READ rordini WITH NO LOCK 
              KEY ror-chiave of rordini
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           PERFORM rordini-ror-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT 
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rordini-KEY-Asc
              IF DataSet1-rordini-LOCK
                 READ rordini NEXT WITH LOCK
              ELSE
                 READ rordini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordini-LOCK
                 READ rordini PREVIOUS WITH LOCK
              ELSE
                 READ rordini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           PERFORM rordini-ror-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rordini-KEY-Asc
              IF DataSet1-rordini-LOCK
                 READ rordini PREVIOUS WITH LOCK
              ELSE
                 READ rordini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordini-LOCK
                 READ rordini NEXT WITH LOCK
              ELSE
                 READ rordini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           PERFORM rordini-ror-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterDelete>
      * <TOTEM:END>
           .

       tordini-k-causale-MERGE-SPLITBUF.
           INITIALIZE tordini-k-causale-SPLITBUF
           MOVE tor-causale(1:4) TO tordini-k-causale-SPLITBUF(1:4)
           MOVE tor-anno(1:4) TO tordini-k-causale-SPLITBUF(5:4)
           MOVE tor-numero(1:8) TO tordini-k-causale-SPLITBUF(9:8)
           .

       tordini-k1-MERGE-SPLITBUF.
           INITIALIZE tordini-k1-SPLITBUF
           MOVE tor-cod-cli(1:5) TO tordini-k1-SPLITBUF(1:5)
           MOVE tor-prg-destino(1:5) TO tordini-k1-SPLITBUF(6:5)
           MOVE tor-anno(1:4) TO tordini-k1-SPLITBUF(11:4)
           MOVE tor-numero(1:8) TO tordini-k1-SPLITBUF(15:8)
           .

       tordini-k2-MERGE-SPLITBUF.
           INITIALIZE tordini-k2-SPLITBUF
           MOVE tor-data-passaggio-ordine(1:8) TO 
           tordini-k2-SPLITBUF(1:8)
           MOVE tor-anno(1:4) TO tordini-k2-SPLITBUF(9:4)
           MOVE tor-numero(1:8) TO tordini-k2-SPLITBUF(13:8)
           .

       tordini-k-bolla-MERGE-SPLITBUF.
           INITIALIZE tordini-k-bolla-SPLITBUF
           MOVE tor-anno-bolla(1:4) TO tordini-k-bolla-SPLITBUF(1:4)
           MOVE tor-num-bolla(1:8) TO tordini-k-bolla-SPLITBUF(5:8)
           .

       tordini-k3-MERGE-SPLITBUF.
           INITIALIZE tordini-k3-SPLITBUF
           MOVE tor-anno-bolla(1:4) TO tordini-k3-SPLITBUF(1:4)
           MOVE tor-data-bolla(1:8) TO tordini-k3-SPLITBUF(5:8)
           MOVE tor-num-bolla(1:8) TO tordini-k3-SPLITBUF(13:8)
           MOVE tor-bolla-prenotata(1:1) TO tordini-k3-SPLITBUF(21:1)
           .

       tordini-k-fattura-MERGE-SPLITBUF.
           INITIALIZE tordini-k-fattura-SPLITBUF
           MOVE tor-anno-fattura(1:4) TO tordini-k-fattura-SPLITBUF(1:4)
           MOVE tor-num-fattura(1:8) TO tordini-k-fattura-SPLITBUF(5:8)
           .

       tordini-k4-MERGE-SPLITBUF.
           INITIALIZE tordini-k4-SPLITBUF
           MOVE tor-anno-fattura(1:4) TO tordini-k4-SPLITBUF(1:4)
           MOVE tor-data-fattura(1:8) TO tordini-k4-SPLITBUF(5:8)
           MOVE tor-num-fattura(1:8) TO tordini-k4-SPLITBUF(13:8)
           MOVE tor-num-prenot(1:8) TO tordini-k4-SPLITBUF(21:8)
           MOVE tor-fatt-prenotata(1:1) TO tordini-k4-SPLITBUF(29:1)
           .

       tordini-k-contab-MERGE-SPLITBUF.
           INITIALIZE tordini-k-contab-SPLITBUF
           MOVE tor-agg-contab(1:1) TO tordini-k-contab-SPLITBUF(1:1)
           MOVE tor-anno-fattura(1:4) TO tordini-k-contab-SPLITBUF(2:4)
           MOVE tor-num-fattura(1:8) TO tordini-k-contab-SPLITBUF(6:8)
           .

       tordini-k-tipo-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tipo-SPLITBUF
           MOVE tor-tipo(1:1) TO tordini-k-tipo-SPLITBUF(1:1)
           MOVE tor-chiave(1:12) TO tordini-k-tipo-SPLITBUF(2:12)
           .

       tordini-k-data-MERGE-SPLITBUF.
           INITIALIZE tordini-k-data-SPLITBUF
           MOVE tor-data-creazione(1:8) TO tordini-k-data-SPLITBUF(1:8)
           MOVE tor-numero(1:8) TO tordini-k-data-SPLITBUF(9:8)
           .

       tordini-k-agfatt-MERGE-SPLITBUF.
           INITIALIZE tordini-k-agfatt-SPLITBUF
           MOVE tor-anno-fattura(1:4) TO tordini-k-agfatt-SPLITBUF(1:4)
           MOVE tor-data-fattura(1:8) TO tordini-k-agfatt-SPLITBUF(5:8)
           MOVE tor-num-fattura(1:8) TO tordini-k-agfatt-SPLITBUF(13:8)
           MOVE tor-num-prenot(1:8) TO tordini-k-agfatt-SPLITBUF(21:8)
           MOVE tor-fatt-prenotata(1:1) TO 
           tordini-k-agfatt-SPLITBUF(29:1)
           MOVE tor-chiave(1:12) TO tordini-k-agfatt-SPLITBUF(30:12)
           .

       tordini-k-stbolle-MERGE-SPLITBUF.
           INITIALIZE tordini-k-stbolle-SPLITBUF
           MOVE tor-anno-bolla(1:4) TO tordini-k-stbolle-SPLITBUF(1:4)
           MOVE tor-data-bolla(1:8) TO tordini-k-stbolle-SPLITBUF(5:8)
           MOVE tor-num-bolla(1:8) TO tordini-k-stbolle-SPLITBUF(13:8)
           MOVE tor-bolla-prenotata(1:1) TO 
           tordini-k-stbolle-SPLITBUF(21:1)
           MOVE tor-chiave(1:12) TO tordini-k-stbolle-SPLITBUF(22:12)
           .

       tordini-k-andamento-data-MERGE-SPLITBUF.
           INITIALIZE tordini-k-andamento-data-SPLITBUF
           MOVE tor-agg-contab(1:1) TO 
           tordini-k-andamento-data-SPLITBUF(1:1)
           MOVE tor-data-fattura(1:8) TO 
           tordini-k-andamento-data-SPLITBUF(2:8)
           .

       tordini-k-andamento-cliente-MERGE-SPLITBUF.
           INITIALIZE tordini-k-andamento-cliente-SPLITBUF
           MOVE tor-cod-cli(1:5) TO 
           tordini-k-andamento-cliente-SPLITBUF(1:5)
           MOVE tor-agg-contab(1:1) TO 
           tordini-k-andamento-cliente-SPLITBUF(6:1)
           MOVE tor-data-fattura(1:8) TO 
           tordini-k-andamento-cliente-SPLITBUF(7:8)
           .

       tordini-k-andamento-clides-MERGE-SPLITBUF.
           INITIALIZE tordini-k-andamento-clides-SPLITBUF
           MOVE tor-cod-cli(1:5) TO 
           tordini-k-andamento-clides-SPLITBUF(1:5)
           MOVE tor-prg-destino(1:5) TO 
           tordini-k-andamento-clides-SPLITBUF(6:5)
           MOVE tor-agg-contab(1:1) TO 
           tordini-k-andamento-clides-SPLITBUF(11:1)
           MOVE tor-data-fattura(1:8) TO 
           tordini-k-andamento-clides-SPLITBUF(12:8)
           .

       tordini-k-promo-MERGE-SPLITBUF.
           INITIALIZE tordini-k-promo-SPLITBUF
           MOVE tor-stato(1:1) TO tordini-k-promo-SPLITBUF(1:1)
           MOVE tor-promo(1:1) TO tordini-k-promo-SPLITBUF(2:1)
           MOVE tor-data-ordine(1:8) TO tordini-k-promo-SPLITBUF(3:8)
           MOVE tor-numero(1:8) TO tordini-k-promo-SPLITBUF(11:8)
           MOVE tor-cod-cli(1:5) TO tordini-k-promo-SPLITBUF(19:5)
           MOVE tor-prg-destino(1:5) TO tordini-k-promo-SPLITBUF(24:5)
           .

       tordini-k-or-MERGE-SPLITBUF.
           INITIALIZE tordini-k-or-SPLITBUF
           MOVE tor-cod-cli(1:5) TO tordini-k-or-SPLITBUF(1:5)
           MOVE tor-prg-destino(1:5) TO tordini-k-or-SPLITBUF(6:5)
           MOVE tor-num-ord-cli(1:10) TO tordini-k-or-SPLITBUF(11:10)
           .

       tordini-k-tor-inviare-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tor-inviare-SPLITBUF
           MOVE tor-da-inviare OF tordini(1:1) TO 
           tordini-k-tor-inviare-SPLITBUF(1:1)
           MOVE tor-chiave OF tordini(1:12) TO 
           tordini-k-tor-inviare-SPLITBUF(2:12)
           .

       tordini-k-tor-tipocli-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tor-tipocli-SPLITBUF
           MOVE tor-tipocli OF tordini(1:2) TO 
           tordini-k-tor-tipocli-SPLITBUF(1:2)
           MOVE tor-cod-cli OF tordini(1:5) TO 
           tordini-k-tor-tipocli-SPLITBUF(3:5)
           MOVE tor-prg-destino OF tordini(1:5) TO 
           tordini-k-tor-tipocli-SPLITBUF(8:5)
           MOVE tor-chiave OF tordini(1:12) TO 
           tordini-k-tor-tipocli-SPLITBUF(13:12)
           .

       tordini-k-tor-gdo-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tor-gdo-SPLITBUF
           MOVE tor-gdo OF tordini(1:5) TO 
           tordini-k-tor-gdo-SPLITBUF(1:5)
           MOVE tor-cod-cli OF tordini(1:5) TO 
           tordini-k-tor-gdo-SPLITBUF(6:5)
           MOVE tor-prg-destino OF tordini(1:5) TO 
           tordini-k-tor-gdo-SPLITBUF(11:5)
           MOVE tor-chiave OF tordini(1:12) TO 
           tordini-k-tor-gdo-SPLITBUF(16:12)
           .

       DataSet1-tordini-INITSTART.
           IF DataSet1-tordini-KEY-Asc
              MOVE Low-Value TO tor-chiave
           ELSE
              MOVE High-Value TO tor-chiave
           END-IF
           .

       DataSet1-tordini-INITEND.
           IF DataSet1-tordini-KEY-Asc
              MOVE High-Value TO tor-chiave
           ELSE
              MOVE Low-Value TO tor-chiave
           END-IF
           .

      * tordini
       DataSet1-tordini-START.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY >= tor-chiave
           ELSE
              START tordini KEY <= tor-chiave
           END-IF
           .

       DataSet1-tordini-START-NOTGREATER.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY <= tor-chiave
           ELSE
              START tordini KEY >= tor-chiave
           END-IF
           .

       DataSet1-tordini-START-GREATER.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY > tor-chiave
           ELSE
              START tordini KEY < tor-chiave
           END-IF
           .

       DataSet1-tordini-START-LESS.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY < tor-chiave
           ELSE
              START tordini KEY > tor-chiave
           END-IF
           .

       DataSet1-tordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tordini-LOCK
              READ tordini WITH LOCK 
              KEY tor-chiave
           ELSE
              READ tordini WITH NO LOCK 
              KEY tor-chiave
           END-IF
           PERFORM tordini-k-causale-MERGE-SPLITBUF
           PERFORM tordini-k1-MERGE-SPLITBUF
           PERFORM tordini-k2-MERGE-SPLITBUF
           PERFORM tordini-k-bolla-MERGE-SPLITBUF
           PERFORM tordini-k3-MERGE-SPLITBUF
           PERFORM tordini-k-fattura-MERGE-SPLITBUF
           PERFORM tordini-k4-MERGE-SPLITBUF
           PERFORM tordini-k-contab-MERGE-SPLITBUF
           PERFORM tordini-k-tipo-MERGE-SPLITBUF
           PERFORM tordini-k-data-MERGE-SPLITBUF
           PERFORM tordini-k-agfatt-MERGE-SPLITBUF
           PERFORM tordini-k-stbolle-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-data-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-clides-MERGE-SPLITBUF
           PERFORM tordini-k-promo-MERGE-SPLITBUF
           PERFORM tordini-k-or-MERGE-SPLITBUF
           PERFORM tordini-k-tor-inviare-MERGE-SPLITBUF
           PERFORM tordini-k-tor-tipocli-MERGE-SPLITBUF
           PERFORM tordini-k-tor-gdo-MERGE-SPLITBUF
           MOVE STATUS-tordini TO TOTEM-ERR-STAT 
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tordini-KEY-Asc
              IF DataSet1-tordini-LOCK
                 READ tordini NEXT WITH LOCK
              ELSE
                 READ tordini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tordini-LOCK
                 READ tordini PREVIOUS WITH LOCK
              ELSE
                 READ tordini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tordini-k-causale-MERGE-SPLITBUF
           PERFORM tordini-k1-MERGE-SPLITBUF
           PERFORM tordini-k2-MERGE-SPLITBUF
           PERFORM tordini-k-bolla-MERGE-SPLITBUF
           PERFORM tordini-k3-MERGE-SPLITBUF
           PERFORM tordini-k-fattura-MERGE-SPLITBUF
           PERFORM tordini-k4-MERGE-SPLITBUF
           PERFORM tordini-k-contab-MERGE-SPLITBUF
           PERFORM tordini-k-tipo-MERGE-SPLITBUF
           PERFORM tordini-k-data-MERGE-SPLITBUF
           PERFORM tordini-k-agfatt-MERGE-SPLITBUF
           PERFORM tordini-k-stbolle-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-data-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-clides-MERGE-SPLITBUF
           PERFORM tordini-k-promo-MERGE-SPLITBUF
           PERFORM tordini-k-or-MERGE-SPLITBUF
           PERFORM tordini-k-tor-inviare-MERGE-SPLITBUF
           PERFORM tordini-k-tor-tipocli-MERGE-SPLITBUF
           PERFORM tordini-k-tor-gdo-MERGE-SPLITBUF
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tordini-KEY-Asc
              IF DataSet1-tordini-LOCK
                 READ tordini PREVIOUS WITH LOCK
              ELSE
                 READ tordini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tordini-LOCK
                 READ tordini NEXT WITH LOCK
              ELSE
                 READ tordini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tordini-k-causale-MERGE-SPLITBUF
           PERFORM tordini-k1-MERGE-SPLITBUF
           PERFORM tordini-k2-MERGE-SPLITBUF
           PERFORM tordini-k-bolla-MERGE-SPLITBUF
           PERFORM tordini-k3-MERGE-SPLITBUF
           PERFORM tordini-k-fattura-MERGE-SPLITBUF
           PERFORM tordini-k4-MERGE-SPLITBUF
           PERFORM tordini-k-contab-MERGE-SPLITBUF
           PERFORM tordini-k-tipo-MERGE-SPLITBUF
           PERFORM tordini-k-data-MERGE-SPLITBUF
           PERFORM tordini-k-agfatt-MERGE-SPLITBUF
           PERFORM tordini-k-stbolle-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-data-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-clides-MERGE-SPLITBUF
           PERFORM tordini-k-promo-MERGE-SPLITBUF
           PERFORM tordini-k-or-MERGE-SPLITBUF
           PERFORM tordini-k-tor-inviare-MERGE-SPLITBUF
           PERFORM tordini-k-tor-tipocli-MERGE-SPLITBUF
           PERFORM tordini-k-tor-gdo-MERGE-SPLITBUF
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterDelete>
      * <TOTEM:END>
           .

       tcaumag-k-mag-MERGE-SPLITBUF.
           INITIALIZE tcaumag-k-mag-SPLITBUF
           MOVE tca-cod-magaz(1:3) TO tcaumag-k-mag-SPLITBUF(1:3)
           MOVE tca-ord-forn(1:1) TO tcaumag-k-mag-SPLITBUF(4:1)
           .

       DataSet1-tcaumag-INITSTART.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE Low-Value TO tca-chiave
           ELSE
              MOVE High-Value TO tca-chiave
           END-IF
           .

       DataSet1-tcaumag-INITEND.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE High-Value TO tca-chiave
           ELSE
              MOVE Low-Value TO tca-chiave
           END-IF
           .

      * tcaumag
       DataSet1-tcaumag-START.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY >= tca-chiave
           ELSE
              START tcaumag KEY <= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-NOTGREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY <= tca-chiave
           ELSE
              START tcaumag KEY >= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-GREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY > tca-chiave
           ELSE
              START tcaumag KEY < tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-LESS.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY < tca-chiave
           ELSE
              START tcaumag KEY > tca-chiave
           END-IF
           .

       DataSet1-tcaumag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcaumag-LOCK
              READ tcaumag WITH LOCK 
              KEY tca-chiave
           ELSE
              READ tcaumag WITH NO LOCK 
              KEY tca-chiave
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT 
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterDelete>
      * <TOTEM:END>
           .

       tnotacr-k-causale-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k-causale-SPLITBUF
           MOVE tno-causale(1:4) TO tnotacr-k-causale-SPLITBUF(1:4)
           MOVE tno-anno(1:4) TO tnotacr-k-causale-SPLITBUF(5:4)
           MOVE tno-numero(1:8) TO tnotacr-k-causale-SPLITBUF(9:8)
           .

       tnotacr-k1-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k1-SPLITBUF
           MOVE tno-cod-cli(1:5) TO tnotacr-k1-SPLITBUF(1:5)
           MOVE tno-prg-destino(1:5) TO tnotacr-k1-SPLITBUF(6:5)
           MOVE tno-anno(1:4) TO tnotacr-k1-SPLITBUF(11:4)
           MOVE tno-numero(1:8) TO tnotacr-k1-SPLITBUF(15:8)
           .

       tnotacr-k2-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k2-SPLITBUF
           MOVE tno-data-passaggio-ordine(1:8) TO 
           tnotacr-k2-SPLITBUF(1:8)
           MOVE tno-anno(1:4) TO tnotacr-k2-SPLITBUF(9:4)
           MOVE tno-numero(1:8) TO tnotacr-k2-SPLITBUF(13:8)
           .

       tnotacr-k-fattura-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k-fattura-SPLITBUF
           MOVE tno-anno-fattura(1:4) TO tnotacr-k-fattura-SPLITBUF(1:4)
           MOVE tno-num-fattura(1:8) TO tnotacr-k-fattura-SPLITBUF(5:8)
           .

       tnotacr-k4-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k4-SPLITBUF
           MOVE tno-anno-fattura(1:4) TO tnotacr-k4-SPLITBUF(1:4)
           MOVE tno-data-fattura(1:8) TO tnotacr-k4-SPLITBUF(5:8)
           MOVE tno-num-fattura(1:8) TO tnotacr-k4-SPLITBUF(13:8)
           MOVE tno-num-prenot(1:8) TO tnotacr-k4-SPLITBUF(21:8)
           MOVE tno-fatt-prenotata(1:1) TO tnotacr-k4-SPLITBUF(29:1)
           .

       tnotacr-k-contab-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k-contab-SPLITBUF
           MOVE tno-agg-contab(1:1) TO tnotacr-k-contab-SPLITBUF(1:1)
           MOVE tno-anno-fattura(1:4) TO tnotacr-k-contab-SPLITBUF(2:4)
           MOVE tno-num-fattura(1:8) TO tnotacr-k-contab-SPLITBUF(6:8)
           .

       tnotacr-k-data-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k-data-SPLITBUF
           MOVE tno-data(1:8) TO tnotacr-k-data-SPLITBUF(1:8)
           MOVE tno-numero(1:8) TO tnotacr-k-data-SPLITBUF(9:8)
           .

       tnotacr-k-agfatt-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k-agfatt-SPLITBUF
           MOVE tno-anno-fattura(1:4) TO tnotacr-k-agfatt-SPLITBUF(1:4)
           MOVE tno-data-fattura(1:8) TO tnotacr-k-agfatt-SPLITBUF(5:8)
           MOVE tno-num-fattura(1:8) TO tnotacr-k-agfatt-SPLITBUF(13:8)
           MOVE tno-num-prenot(1:8) TO tnotacr-k-agfatt-SPLITBUF(21:8)
           MOVE tno-fatt-prenotata(1:1) TO 
           tnotacr-k-agfatt-SPLITBUF(29:1)
           MOVE tno-chiave(1:12) TO tnotacr-k-agfatt-SPLITBUF(30:12)
           .

       tnotacr-k-andamento-data-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k-andamento-data-SPLITBUF
           MOVE tno-agg-contab(1:1) TO 
           tnotacr-k-andamento-data-SPLITBUF(1:1)
           MOVE tno-data-fattura(1:8) TO 
           tnotacr-k-andamento-data-SPLITBUF(2:8)
           .

       tnotacr-k-andamento-cliente-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k-andamento-cliente-SPLITBUF
           MOVE tno-cod-cli(1:5) TO 
           tnotacr-k-andamento-cliente-SPLITBUF(1:5)
           MOVE tno-agg-contab(1:1) TO 
           tnotacr-k-andamento-cliente-SPLITBUF(6:1)
           MOVE tno-data-fattura(1:8) TO 
           tnotacr-k-andamento-cliente-SPLITBUF(7:8)
           .

       tnotacr-k-andamento-clides-MERGE-SPLITBUF.
           INITIALIZE tnotacr-k-andamento-clides-SPLITBUF
           MOVE tno-cod-cli(1:5) TO 
           tnotacr-k-andamento-clides-SPLITBUF(1:5)
           MOVE tno-prg-destino(1:5) TO 
           tnotacr-k-andamento-clides-SPLITBUF(6:5)
           MOVE tno-agg-contab(1:1) TO 
           tnotacr-k-andamento-clides-SPLITBUF(11:1)
           MOVE tno-data-fattura(1:8) TO 
           tnotacr-k-andamento-clides-SPLITBUF(12:8)
           .

       DataSet1-tnotacr-INITSTART.
           IF DataSet1-tnotacr-KEY-Asc
              MOVE Low-Value TO tno-chiave
           ELSE
              MOVE High-Value TO tno-chiave
           END-IF
           .

       DataSet1-tnotacr-INITEND.
           IF DataSet1-tnotacr-KEY-Asc
              MOVE High-Value TO tno-chiave
           ELSE
              MOVE Low-Value TO tno-chiave
           END-IF
           .

      * tnotacr
       DataSet1-tnotacr-START.
           IF DataSet1-tnotacr-KEY-Asc
              START tnotacr KEY >= tno-chiave
           ELSE
              START tnotacr KEY <= tno-chiave
           END-IF
           .

       DataSet1-tnotacr-START-NOTGREATER.
           IF DataSet1-tnotacr-KEY-Asc
              START tnotacr KEY <= tno-chiave
           ELSE
              START tnotacr KEY >= tno-chiave
           END-IF
           .

       DataSet1-tnotacr-START-GREATER.
           IF DataSet1-tnotacr-KEY-Asc
              START tnotacr KEY > tno-chiave
           ELSE
              START tnotacr KEY < tno-chiave
           END-IF
           .

       DataSet1-tnotacr-START-LESS.
           IF DataSet1-tnotacr-KEY-Asc
              START tnotacr KEY < tno-chiave
           ELSE
              START tnotacr KEY > tno-chiave
           END-IF
           .

       DataSet1-tnotacr-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tnotacr-LOCK
              READ tnotacr WITH LOCK 
              KEY tno-chiave
           ELSE
              READ tnotacr WITH NO LOCK 
              KEY tno-chiave
           END-IF
           PERFORM tnotacr-k-causale-MERGE-SPLITBUF
           PERFORM tnotacr-k1-MERGE-SPLITBUF
           PERFORM tnotacr-k2-MERGE-SPLITBUF
           PERFORM tnotacr-k-fattura-MERGE-SPLITBUF
           PERFORM tnotacr-k4-MERGE-SPLITBUF
           PERFORM tnotacr-k-contab-MERGE-SPLITBUF
           PERFORM tnotacr-k-data-MERGE-SPLITBUF
           PERFORM tnotacr-k-agfatt-MERGE-SPLITBUF
           PERFORM tnotacr-k-andamento-data-MERGE-SPLITBUF
           PERFORM tnotacr-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tnotacr-k-andamento-clides-MERGE-SPLITBUF
           MOVE STATUS-tnotacr TO TOTEM-ERR-STAT 
           MOVE "tnotacr" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tnotacr-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tnotacr-KEY-Asc
              IF DataSet1-tnotacr-LOCK
                 READ tnotacr NEXT WITH LOCK
              ELSE
                 READ tnotacr NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnotacr-LOCK
                 READ tnotacr PREVIOUS WITH LOCK
              ELSE
                 READ tnotacr PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tnotacr-k-causale-MERGE-SPLITBUF
           PERFORM tnotacr-k1-MERGE-SPLITBUF
           PERFORM tnotacr-k2-MERGE-SPLITBUF
           PERFORM tnotacr-k-fattura-MERGE-SPLITBUF
           PERFORM tnotacr-k4-MERGE-SPLITBUF
           PERFORM tnotacr-k-contab-MERGE-SPLITBUF
           PERFORM tnotacr-k-data-MERGE-SPLITBUF
           PERFORM tnotacr-k-agfatt-MERGE-SPLITBUF
           PERFORM tnotacr-k-andamento-data-MERGE-SPLITBUF
           PERFORM tnotacr-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tnotacr-k-andamento-clides-MERGE-SPLITBUF
           MOVE STATUS-tnotacr TO TOTEM-ERR-STAT
           MOVE "tnotacr" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tnotacr-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tnotacr-KEY-Asc
              IF DataSet1-tnotacr-LOCK
                 READ tnotacr PREVIOUS WITH LOCK
              ELSE
                 READ tnotacr PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnotacr-LOCK
                 READ tnotacr NEXT WITH LOCK
              ELSE
                 READ tnotacr NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tnotacr-k-causale-MERGE-SPLITBUF
           PERFORM tnotacr-k1-MERGE-SPLITBUF
           PERFORM tnotacr-k2-MERGE-SPLITBUF
           PERFORM tnotacr-k-fattura-MERGE-SPLITBUF
           PERFORM tnotacr-k4-MERGE-SPLITBUF
           PERFORM tnotacr-k-contab-MERGE-SPLITBUF
           PERFORM tnotacr-k-data-MERGE-SPLITBUF
           PERFORM tnotacr-k-agfatt-MERGE-SPLITBUF
           PERFORM tnotacr-k-andamento-data-MERGE-SPLITBUF
           PERFORM tnotacr-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tnotacr-k-andamento-clides-MERGE-SPLITBUF
           MOVE STATUS-tnotacr TO TOTEM-ERR-STAT
           MOVE "tnotacr" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tnotacr-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tnotacr TO TOTEM-ERR-STAT
           MOVE "tnotacr" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tnotacr-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tnotacr TO TOTEM-ERR-STAT
           MOVE "tnotacr" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tnotacr-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tnotacr TO TOTEM-ERR-STAT
           MOVE "tnotacr" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnotacr, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-param-INITSTART.
           IF DataSet1-param-KEY-Asc
              MOVE Low-Value TO prm-chiave OF param
           ELSE
              MOVE High-Value TO prm-chiave OF param
           END-IF
           .

       DataSet1-param-INITEND.
           IF DataSet1-param-KEY-Asc
              MOVE High-Value TO prm-chiave OF param
           ELSE
              MOVE Low-Value TO prm-chiave OF param
           END-IF
           .

      * param
       DataSet1-param-START.
           IF DataSet1-param-KEY-Asc
              START param KEY >= prm-chiave OF param
           ELSE
              START param KEY <= prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-NOTGREATER.
           IF DataSet1-param-KEY-Asc
              START param KEY <= prm-chiave OF param
           ELSE
              START param KEY >= prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-GREATER.
           IF DataSet1-param-KEY-Asc
              START param KEY > prm-chiave OF param
           ELSE
              START param KEY < prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-LESS.
           IF DataSet1-param-KEY-Asc
              START param KEY < prm-chiave OF param
           ELSE
              START param KEY > prm-chiave OF param
           END-IF
           .

       DataSet1-param-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-param-LOCK
              READ param WITH LOCK 
              KEY prm-chiave OF param
           ELSE
              READ param WITH NO LOCK 
              KEY prm-chiave OF param
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT 
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-param-KEY-Asc
              IF DataSet1-param-LOCK
                 READ param NEXT WITH LOCK
              ELSE
                 READ param NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param-LOCK
                 READ param PREVIOUS WITH LOCK
              ELSE
                 READ param PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-param-KEY-Asc
              IF DataSet1-param-LOCK
                 READ param PREVIOUS WITH LOCK
              ELSE
                 READ param PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param-LOCK
                 READ param NEXT WITH LOCK
              ELSE
                 READ param NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tcontat-INITSTART.
           IF DataSet1-tcontat-KEY-Asc
              MOVE Low-Value TO con-chiave
           ELSE
              MOVE High-Value TO con-chiave
           END-IF
           .

       DataSet1-tcontat-INITEND.
           IF DataSet1-tcontat-KEY-Asc
              MOVE High-Value TO con-chiave
           ELSE
              MOVE Low-Value TO con-chiave
           END-IF
           .

      * tcontat
       DataSet1-tcontat-START.
           IF DataSet1-tcontat-KEY-Asc
              START tcontat KEY >= con-chiave
           ELSE
              START tcontat KEY <= con-chiave
           END-IF
           .

       DataSet1-tcontat-START-NOTGREATER.
           IF DataSet1-tcontat-KEY-Asc
              START tcontat KEY <= con-chiave
           ELSE
              START tcontat KEY >= con-chiave
           END-IF
           .

       DataSet1-tcontat-START-GREATER.
           IF DataSet1-tcontat-KEY-Asc
              START tcontat KEY > con-chiave
           ELSE
              START tcontat KEY < con-chiave
           END-IF
           .

       DataSet1-tcontat-START-LESS.
           IF DataSet1-tcontat-KEY-Asc
              START tcontat KEY < con-chiave
           ELSE
              START tcontat KEY > con-chiave
           END-IF
           .

       DataSet1-tcontat-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcontat-LOCK
              READ tcontat WITH LOCK 
              KEY con-chiave
           ELSE
              READ tcontat WITH NO LOCK 
              KEY con-chiave
           END-IF
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT 
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcontat-KEY-Asc
              IF DataSet1-tcontat-LOCK
                 READ tcontat NEXT WITH LOCK
              ELSE
                 READ tcontat NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcontat-LOCK
                 READ tcontat PREVIOUS WITH LOCK
              ELSE
                 READ tcontat PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcontat-KEY-Asc
              IF DataSet1-tcontat-LOCK
                 READ tcontat PREVIOUS WITH LOCK
              ELSE
                 READ tcontat PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcontat-LOCK
                 READ tcontat NEXT WITH LOCK
              ELSE
                 READ tcontat NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcontat-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tcontat TO TOTEM-ERR-STAT
           MOVE "tcontat" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcontat, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-INITSTART.
           IF DataSet1-tnazioni-KEY-Asc
              MOVE Low-Value TO naz-chiave
           ELSE
              MOVE High-Value TO naz-chiave
           END-IF
           .

       DataSet1-tnazioni-INITEND.
           IF DataSet1-tnazioni-KEY-Asc
              MOVE High-Value TO naz-chiave
           ELSE
              MOVE Low-Value TO naz-chiave
           END-IF
           .

      * tnazioni
       DataSet1-tnazioni-START.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY >= naz-chiave
           ELSE
              START tnazioni KEY <= naz-chiave
           END-IF
           .

       DataSet1-tnazioni-START-NOTGREATER.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY <= naz-chiave
           ELSE
              START tnazioni KEY >= naz-chiave
           END-IF
           .

       DataSet1-tnazioni-START-GREATER.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY > naz-chiave
           ELSE
              START tnazioni KEY < naz-chiave
           END-IF
           .

       DataSet1-tnazioni-START-LESS.
           IF DataSet1-tnazioni-KEY-Asc
              START tnazioni KEY < naz-chiave
           ELSE
              START tnazioni KEY > naz-chiave
           END-IF
           .

       DataSet1-tnazioni-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tnazioni-LOCK
              READ tnazioni WITH LOCK 
              KEY naz-chiave
           ELSE
              READ tnazioni WITH NO LOCK 
              KEY naz-chiave
           END-IF
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT 
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tnazioni-KEY-Asc
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni NEXT WITH LOCK
              ELSE
                 READ tnazioni NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni PREVIOUS WITH LOCK
              ELSE
                 READ tnazioni PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tnazioni-KEY-Asc
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni PREVIOUS WITH LOCK
              ELSE
                 READ tnazioni PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tnazioni-LOCK
                 READ tnazioni NEXT WITH LOCK
              ELSE
                 READ tnazioni NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tnazioni-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tnazioni TO TOTEM-ERR-STAT
           MOVE "tnazioni" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tnazioni, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-INITSTART.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE Low-Value TO mag-chiave
           ELSE
              MOVE High-Value TO mag-chiave
           END-IF
           .

       DataSet1-tmagaz-INITEND.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE High-Value TO mag-chiave
           ELSE
              MOVE Low-Value TO mag-chiave
           END-IF
           .

      * tmagaz
       DataSet1-tmagaz-START.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY >= mag-chiave
           ELSE
              START tmagaz KEY <= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-NOTGREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY <= mag-chiave
           ELSE
              START tmagaz KEY >= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-GREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY > mag-chiave
           ELSE
              START tmagaz KEY < mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-LESS.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY < mag-chiave
           ELSE
              START tmagaz KEY > mag-chiave
           END-IF
           .

       DataSet1-tmagaz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmagaz-LOCK
              READ tmagaz WITH LOCK 
              KEY mag-chiave
           ELSE
              READ tmagaz WITH NO LOCK 
              KEY mag-chiave
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT 
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE btno-rec OF btnotacr
           INITIALIZE tge-rec OF tparamge
           INITIALIZE brno-rec OF brnotacr
           INITIALIZE des-rec OF destini
           INITIALIZE record-tbliv OF tivaese
           INITIALIZE record-tblpa OF tcodpag
           INITIALIZE cli-rec OF clienti
           INITIALIZE art-rec OF articoli
           INITIALIZE prg-rec OF progmag
           INITIALIZE RECORD-MAS OF MAS
           INITIALIZE tpb-rec OF tpiombo
           INITIALIZE tmp-f-rec OF tmp-fatturati
           INITIALIZE imb-rec OF timballi
           INITIALIZE imq-rec OF timbalqta
           INITIALIZE tcl-rec OF ttipocli
           INITIALIZE imp-rec OF timposte
           INITIALIZE vet-rec OF tvettori
           INITIALIZE mar-rec OF tmarche
           INITIALIZE tmp-prg-z-rec OF tmp-progmag-zoom
           INITIALIZE ror-rec OF rordini
           INITIALIZE tor-rec OF tordini
           INITIALIZE tca-rec OF tcaumag
           INITIALIZE tno-rec OF tnotacr
           INITIALIZE prm-rec OF param
           INITIALIZE con-rec OF tcontat
           INITIALIZE naz-rec OF tnazioni
           INITIALIZE mag-rec OF tmagaz
           .


      * COMBO-BOX
       cbo-colpa-Content.
           .

      * GRID
       form1-gd-1-Content.
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 2, Y = 1,
                CELL-DATA = "Articolo",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 3, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 4, Y = 1,
                CELL-DATA = "Q.tà",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 5, Y = 1,
                CELL-DATA = "Prz. Uni.",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 6, Y = 1,
                CELL-DATA = "Imp. Merce",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 7, Y = 1,
                CELL-DATA = "Consumo",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 8, Y = 1,
                CELL-DATA = "Cou/Cobat",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 9, Y = 1,
                CELL-DATA = "Add. Piombo",
      * CELLS' SETTING
              MODIFY form1-gd-1, X = 10, Y = 1,
                CELL-DATA = "Cod. IVA",
           .

      * GRID
       gd-pag2-Content.
      * CELLS' SETTING
              MODIFY gd-pag2, X = 2, Y = 1,
                CELL-DATA = "Articolo",
      * CELLS' SETTING
              MODIFY gd-pag2, X = 3, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-pag2, X = 4, Y = 1,
                CELL-DATA = "Q.tà",
      * CELLS' SETTING
              MODIFY gd-pag2, X = 5, Y = 1,
                CELL-DATA = "Prz. Uni.",
      * CELLS' SETTING
              MODIFY gd-pag2, X = 6, Y = 1,
                CELL-DATA = "Imp. Merce",
      * CELLS' SETTING
              MODIFY gd-pag2, X = 7, Y = 1,
                CELL-DATA = "Consumo",
      * CELLS' SETTING
              MODIFY gd-pag2, X = 8, Y = 1,
                CELL-DATA = "Cou/Cobat",
      * CELLS' SETTING
              MODIFY gd-pag2, X = 9, Y = 1,
                CELL-DATA = "Add. Piombo",
      * CELLS' SETTING
              MODIFY gd-pag2, X = 10, Y = 1,
                CELL-DATA = "Cod. IVA",
           .

      * GRID
       form1-gd-2-Content.
      * CELLS' SETTING
              MODIFY form1-gd-2, X = 2, Y = 1,
                CELL-DATA = "Articolo",
      * CELLS' SETTING
              MODIFY form1-gd-2, X = 3, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY form1-gd-2, X = 4, Y = 1,
                CELL-DATA = "Q.tà",
      * CELLS' SETTING
              MODIFY form1-gd-2, X = 5, Y = 1,
                CELL-DATA = "Prz. Uni.",
      * CELLS' SETTING
              MODIFY form1-gd-2, X = 6, Y = 1,
                CELL-DATA = "Imp. Merce",
      * CELLS' SETTING
              MODIFY form1-gd-2, X = 7, Y = 1,
                CELL-DATA = "Consumo",
      * CELLS' SETTING
              MODIFY form1-gd-2, X = 8, Y = 1,
                CELL-DATA = "Cou/Cobat",
      * CELLS' SETTING
              MODIFY form1-gd-2, X = 9, Y = 1,
                CELL-DATA = "Add. Piombo",
      * CELLS' SETTING
              MODIFY form1-gd-2, X = 10, Y = 1,
                CELL-DATA = "Cod. IVA",
           .

      * GRID
       gd-pag3-Content.
      * CELLS' SETTING
              MODIFY gd-pag3, X = 2, Y = 1,
                CELL-DATA = "Articolo",
      * CELLS' SETTING
              MODIFY gd-pag3, X = 3, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-pag3, X = 4, Y = 1,
                CELL-DATA = "Q.tà",
      * CELLS' SETTING
              MODIFY gd-pag3, X = 5, Y = 1,
                CELL-DATA = "Prz. Uni.",
      * CELLS' SETTING
              MODIFY gd-pag3, X = 6, Y = 1,
                CELL-DATA = "Imp. Merce",
      * CELLS' SETTING
              MODIFY gd-pag3, X = 7, Y = 1,
                CELL-DATA = "Consumo",
      * CELLS' SETTING
              MODIFY gd-pag3, X = 8, Y = 1,
                CELL-DATA = "Cou/Cobat",
      * CELLS' SETTING
              MODIFY gd-pag3, X = 9, Y = 1,
                CELL-DATA = "Add. Piombo",
      * CELLS' SETTING
              MODIFY gd-pag3, X = 10, Y = 1,
                CELL-DATA = "Cod. IVA",
           .

      * GRID
       form1-gd-3-Content.
      * CELLS' SETTING
              MODIFY form1-gd-3, X = 2, Y = 1,
                CELL-DATA = "Articolo",
      * CELLS' SETTING
              MODIFY form1-gd-3, X = 3, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY form1-gd-3, X = 4, Y = 1,
                CELL-DATA = "Q.tà",
      * CELLS' SETTING
              MODIFY form1-gd-3, X = 5, Y = 1,
                CELL-DATA = "Prz. Uni.",
      * CELLS' SETTING
              MODIFY form1-gd-3, X = 6, Y = 1,
                CELL-DATA = "Imp. Merce",
      * CELLS' SETTING
              MODIFY form1-gd-3, X = 7, Y = 1,
                CELL-DATA = "Consumo",
      * CELLS' SETTING
              MODIFY form1-gd-3, X = 8, Y = 1,
                CELL-DATA = "Cou/Cobat",
      * CELLS' SETTING
              MODIFY form1-gd-3, X = 9, Y = 1,
                CELL-DATA = "Add. Piombo",
      * CELLS' SETTING
              MODIFY form1-gd-3, X = 10, Y = 1,
                CELL-DATA = "Cod. IVA",
           .

      * FD's Initialize Paragraph
       DataSet1-btnotacr-INITREC.
           INITIALIZE btno-rec OF btnotacr
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tparamge-INITREC.
           INITIALIZE tge-rec OF tparamge
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-brnotacr-INITREC.
           INITIALIZE brno-rec OF brnotacr
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-destini-INITREC.
           INITIALIZE des-rec OF destini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tivaese-INITREC.
           INITIALIZE record-tbliv OF tivaese
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcodpag-INITREC.
           INITIALIZE record-tblpa OF tcodpag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-clienti-INITREC.
           INITIALIZE cli-rec OF clienti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-articoli-INITREC.
           INITIALIZE art-rec OF articoli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-progmag-INITREC.
           INITIALIZE prg-rec OF progmag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-MAS-INITREC.
           INITIALIZE RECORD-MAS OF MAS
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tpiombo-INITREC.
           INITIALIZE tpb-rec OF tpiombo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-fatturati-INITREC.
           INITIALIZE tmp-f-rec OF tmp-fatturati
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timballi-INITREC.
           INITIALIZE imb-rec OF timballi
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timbalqta-INITREC.
           INITIALIZE imq-rec OF timbalqta
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-ttipocli-INITREC.
           INITIALIZE tcl-rec OF ttipocli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timposte-INITREC.
           INITIALIZE imp-rec OF timposte
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tvettori-INITREC.
           INITIALIZE vet-rec OF tvettori
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmarche-INITREC.
           INITIALIZE mar-rec OF tmarche
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-progmag-zoom-INITREC.
           INITIALIZE tmp-prg-z-rec OF tmp-progmag-zoom
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rordini-INITREC.
           INITIALIZE ror-rec OF rordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tordini-INITREC.
           INITIALIZE tor-rec OF tordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcaumag-INITREC.
           INITIALIZE tca-rec OF tcaumag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tnotacr-INITREC.
           INITIALIZE tno-rec OF tnotacr
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-param-INITREC.
           INITIALIZE prm-rec OF param
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcontat-INITREC.
           INITIALIZE con-rec OF tcontat
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tnazioni-INITREC.
           INITIALIZE naz-rec OF tnazioni
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmagaz-INITREC.
           INITIALIZE mag-rec OF tmagaz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              LINES 47,92,
              SIZE 158,00,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Small-Font,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
           VISIBLE 1,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Screen1-Event-Proc,
              HANDLE IS Form1-handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              GRIP,
              PANEL-WIDTHS (100, 35, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON Form1-handle
      * DISPLAY-COLUMNS settings
              MODIFY form1-gd-1, DISPLAY-COLUMNS (1, 6, 14, 73, 81, 92, 
           103, 115, 127, 139)
              MODIFY gd-pag2, DISPLAY-COLUMNS (1, 6, 14, 73, 81, 92, 
           103, 115, 127, 139)
              MODIFY form1-gd-2, DISPLAY-COLUMNS (1, 6, 14, 73, 81, 92, 
           103, 115, 127, 139)
              MODIFY gd-pag3, DISPLAY-COLUMNS (1, 6, 14, 73, 81, 92, 
           103, 115, 127, 139)
              MODIFY form1-gd-3, DISPLAY-COLUMNS (1, 6, 14, 73, 81, 92, 
           103, 115, 127, 139)
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           perform BEFORE-ACCEPT.
           if lk-bl-prog-id = "selnota"
              move 1 to v-nota
              move 1 to NumBitmapPb
              modify pb-notacr, bitmap-number = 1, visible 1
           end-if.

           if lk-bl-prog-id = "selfat"
              move 1 to v-nota
              move 5 to NumBitmapPb
              modify pb-notacr, bitmap-number = 5, visible 1
           end-if.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
           perform AFTER-ENDACCEPT

      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY Form1-handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
           evaluate key-status
           when 5 |modifica
                inquire tool-modifica, enabled in e-modifica
                if e-modifica = 1
                   if mod = zero move 1 to mod
                   else          move zero to mod
                   end-if
                   modify tool-modifica, value = mod
                   perform MODIFICA
                end-if
           end-evaluate.

           .
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
                 IF Event-Type = Cmd-Tabchanged AND 
                                 Event-Control-Id = 1
                    MOVE EVENT-DATA-1 TO Screen1-Ta-1-TAB-VALUE
                    PERFORM Screen1-Ta-1-TABCHANGE
                 END-IF

              WHEN Key-Status = 1000
                 PERFORM rb-cli-LinkTo
              WHEN Key-Status = 1002
                 PERFORM rb-vet-LinkTo
              WHEN Key-Status = 1001
                 PERFORM pb-nuovo-LinkTo
              WHEN Key-Status = 1004
                 PERFORM pb-elimina-LinkTo
              WHEN Key-Status = 1005
                 PERFORM pb-sel-tutto-n-LinkTo
              WHEN Key-Status = 1006
                 PERFORM pb-genera2-LinkTo
              WHEN Key-Status = 1003
                 PERFORM pb-sel-tutto-r-LinkTo
              WHEN Key-Status = 1007
                 PERFORM pb-genera-r-LinkTo
              WHEN Key-Status = 1027
                 PERFORM pb-notacr-LinkTo
              WHEN Key-Status = 4
                 PERFORM TOOL-CANCELLA-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON Form1-handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
           if mod-campi = 1
              perform SALV-MOD
           end-if.

           if errori
              move 26 to key-status
              exit paragraph
           end-if.

           set environment "KEYSTROKE" to "DATA=44   44".
           set environment "KEYSTROKE" to "DATA=46   46".

           .
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * TAB
              MODIFY Screen1-Ta-1, RESET-TABS = 1
              MODIFY Screen1-Ta-1, 
           TAB-TO-ADD = (
                 "Dati di &Testata",
                 "&Nota Credito",
                 "Nota &Addebito",
                 "&Merce Rotta",
                        )
           MOVE 0 TO 
                   Screen1-Pg-1-Visible,
                   Screen1-Pg-2-Visible,
                   Screen1-Pg-3-Visible,
                   Screen1-Pg-4-Visible,
           MOVE 1 TO Screen1-Pg-1-Visible
           PERFORM Screen1-Ta-1-TABCHANGE
      * COMBO-BOX
           PERFORM cbo-colpa-Content
      * GRID
           PERFORM form1-gd-1-Content
      * GRID
           PERFORM gd-pag2-Content
      * GRID
           PERFORM form1-gd-2-Content
      * GRID
           PERFORM gd-pag3-Content
      * GRID
           PERFORM form1-gd-3-Content
           .

       Form1-Init-Value.
           MOVE titolo TO TOTEM-MSG-TITLE
           INITIALIZE Form1-BUF
      * DB_RADIO-BUTTON
              MOVE 1 TO btno-fm-tipo
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
      * ef-cli's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cli-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5001 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5002 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5003 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vet's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vet-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5004 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-num-bolla's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-num-bolla-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5005 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data-bolla's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-bolla-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5006 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-num-reso's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-num-reso-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5007 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data-ingresso's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-ingresso-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5008 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-motivo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-motivo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5009 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5011 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cli-fm's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cli-fm-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5014 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des-fm's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des-fm-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5015 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-art's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-art-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5017 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-qta's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-qta-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5018 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-prz's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-prz-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5019 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-consumo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-consumo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5020 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-coubat's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-coubat-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5021 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-add's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-add-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5022 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5023 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-iva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-iva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5024 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
           .

       ef-cli-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cli-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cli's Validation
       ef-cli-VALIDATION.
           PERFORM ef-cli-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cli-AFTER-VALIDATION
           .

       ef-des-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des's Validation
       ef-des-VALIDATION.
           PERFORM ef-des-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des-AFTER-VALIDATION
           .

       ef-pag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pag's Validation
       ef-pag-VALIDATION.
           PERFORM ef-pag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pag-AFTER-VALIDATION
           .

       ef-vet-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vet, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vet-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vet, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vet's Validation
       ef-vet-VALIDATION.
           PERFORM ef-vet-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vet-AFTER-VALIDATION
           .

       ef-num-bolla-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-num-bolla, BeforeValidation>
      * <TOTEM:END>
           .

       ef-num-bolla-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-num-bolla, AfterValidation>
      * <TOTEM:END>
           .

      * ef-num-bolla's Validation
       ef-num-bolla-VALIDATION.
           PERFORM ef-num-bolla-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-num-bolla-AFTER-VALIDATION
           .

       ef-data-bolla-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-bolla, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-bolla-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-bolla, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data-bolla's Validation
       ef-data-bolla-VALIDATION.
           PERFORM ef-data-bolla-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-bolla-AFTER-VALIDATION
           .

       ef-num-reso-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-num-reso, BeforeValidation>
      * <TOTEM:END>
           .

       ef-num-reso-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-num-reso, AfterValidation>
      * <TOTEM:END>
           .

      * ef-num-reso's Validation
       ef-num-reso-VALIDATION.
           PERFORM ef-num-reso-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-num-reso-AFTER-VALIDATION
           .

       ef-data-ingresso-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-ingresso, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-ingresso-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-ingresso, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data-ingresso's Validation
       ef-data-ingresso-VALIDATION.
           PERFORM ef-data-ingresso-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-ingresso-AFTER-VALIDATION
           .

       ef-motivo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-motivo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-motivo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-motivo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-motivo's Validation
       ef-motivo-VALIDATION.
           PERFORM ef-motivo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-motivo-AFTER-VALIDATION
           .

       ef-note-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note's Validation
       ef-note-VALIDATION.
           PERFORM ef-note-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-AFTER-VALIDATION
           .

       ef-cli-fm-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli-fm, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cli-fm-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli-fm, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cli-fm's Validation
       ef-cli-fm-VALIDATION.
           PERFORM ef-cli-fm-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cli-fm-AFTER-VALIDATION
           .

       ef-des-fm-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-fm, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des-fm-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-fm, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des-fm's Validation
       ef-des-fm-VALIDATION.
           PERFORM ef-des-fm-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des-fm-AFTER-VALIDATION
           .

       ef-art-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-art, BeforeValidation>
      * <TOTEM:END>
           .

       ef-art-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-art, AfterValidation>
      * <TOTEM:END>
           .

      * ef-art's Validation
       ef-art-VALIDATION.
           PERFORM ef-art-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-art-AFTER-VALIDATION
           .

       ef-qta-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta, BeforeValidation>
      * <TOTEM:END>
           .

       ef-qta-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta, AfterValidation>
      * <TOTEM:END>
           .

      * ef-qta's Validation
       ef-qta-VALIDATION.
           PERFORM ef-qta-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-qta-AFTER-VALIDATION
           .

       ef-prz-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prz, BeforeValidation>
      * <TOTEM:END>
           .

       ef-prz-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-prz, AfterValidation>
      * <TOTEM:END>
           .

      * ef-prz's Validation
       ef-prz-VALIDATION.
           PERFORM ef-prz-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-prz-AFTER-VALIDATION
           .

       ef-consumo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-consumo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-consumo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-consumo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-consumo's Validation
       ef-consumo-VALIDATION.
           PERFORM ef-consumo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-consumo-AFTER-VALIDATION
           .

       ef-coubat-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-coubat, BeforeValidation>
      * <TOTEM:END>
           .

       ef-coubat-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-coubat, AfterValidation>
      * <TOTEM:END>
           .

      * ef-coubat's Validation
       ef-coubat-VALIDATION.
           PERFORM ef-coubat-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-coubat-AFTER-VALIDATION
           .

       ef-add-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-add, BeforeValidation>
      * <TOTEM:END>
           .

       ef-add-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-add, AfterValidation>
      * <TOTEM:END>
           .

      * ef-add's Validation
       ef-add-VALIDATION.
           PERFORM ef-add-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-add-AFTER-VALIDATION
           .

       ef-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-imp's Validation
       ef-imp-VALIDATION.
           PERFORM ef-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-imp-AFTER-VALIDATION
           .

       ef-iva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-iva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-iva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-iva's Validation
       ef-iva-VALIDATION.
           PERFORM ef-iva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-iva-AFTER-VALIDATION
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * DB_Entry-Field : ef-cli
           MOVE ef-cli-BUF TO btno-cod-cli
      * DB_Entry-Field : ef-des
           MOVE ef-des-BUF TO btno-prg-destino
      * DB_Entry-Field : ef-pag
           MOVE ef-pag-BUF TO btno-cod-pag
      * DB_Entry-Field : ef-vet
           MOVE ef-vet-BUF TO btno-vettore
      * DB_Entry-Field : ef-num-bolla
           MOVE ef-num-bolla-BUF TO btno-num-bolla
      * DB_Entry-Field : ef-data-bolla
           MOVE ef-data-bolla-BUF TO btno-data-bolla
      * DB_Entry-Field : ef-num-reso
           MOVE ef-num-reso-BUF TO btno-num-reso
      * DB_Entry-Field : ef-data-ingresso
           MOVE ef-data-ingresso-BUF TO btno-data-ingresso
      * DB_Entry-Field : ef-motivo
           MOVE ef-motivo-BUF TO btno-motivo-cont
      * DB_Entry-Field : ef-note
           MOVE ef-note-BUF TO btno-note
      * DB_RADIOBOX : rb-cli, rb-vet, 
           EVALUATE Form1-RADIO-1-BUF
           WHEN 1
              MOVE "C" TO btno-fm-tipo
           WHEN 2
              MOVE "V" TO btno-fm-tipo
           WHEN OTHER
              MOVE SPACE TO btno-fm-tipo
           END-EVALUATE
      * DB_Entry-Field : ef-cli-fm
           MOVE ef-cli-fm-BUF TO btno-cod-cli-fm
      * DB_Entry-Field : ef-des-fm
           MOVE ef-des-fm-BUF TO btno-prg-destino-fm
      * DB_Entry-Field : ef-art
           MOVE ef-art-BUF TO ror-cod-articolo
      * DB_Entry-Field : ef-qta
           MOVE ef-qta-BUF TO ror-qta
      * DB_Entry-Field : ef-prz
           MOVE ef-prz-BUF TO ror-prz-unitario
      * DB_Entry-Field : ef-consumo
           MOVE ef-consumo-BUF TO ror-imp-consumo
      * DB_Entry-Field : ef-coubat
           MOVE ef-coubat-BUF TO ror-imp-cou-cobat
      * DB_Entry-Field : ef-add
           MOVE ef-add-BUF TO ror-add-piombo
      * DB_Entry-Field : ef-imp
           MOVE ef-imp-BUF TO ror-imponib-merce
      * DB_Entry-Field : ef-iva
           MOVE ef-iva-BUF TO ror-cod-iva
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
           perform AFTER-BUF-TO-FLD.

           .
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * <TOTEM:END>
      * DB_Entry-Field : ef-cli
           MOVE btno-cod-cli TO ef-cli-BUF
      * DB_Entry-Field : ef-des
           MOVE btno-prg-destino TO ef-des-BUF
      * DB_Entry-Field : ef-pag
           MOVE btno-cod-pag TO ef-pag-BUF
      * DB_Entry-Field : ef-vet
           MOVE btno-vettore TO ef-vet-BUF
      * DB_Entry-Field : ef-num-bolla
           MOVE btno-num-bolla TO ef-num-bolla-BUF
      * DB_Entry-Field : ef-data-bolla
           MOVE btno-data-bolla TO ef-data-bolla-BUF
      * DB_Entry-Field : ef-num-reso
           MOVE btno-num-reso TO ef-num-reso-BUF
      * DB_Entry-Field : ef-data-ingresso
           MOVE btno-data-ingresso TO ef-data-ingresso-BUF
      * DB_Entry-Field : ef-motivo
           MOVE btno-motivo-cont TO ef-motivo-BUF
      * DB_Entry-Field : ef-note
           MOVE btno-note TO ef-note-BUF
      * DB_RADIOBOX : rb-cli, rb-vet, 
           EVALUATE btno-fm-tipo
           WHEN "C"
              MOVE 1 TO Form1-RADIO-1-BUF
           WHEN "V"
              MOVE 2 TO Form1-RADIO-1-BUF
           WHEN OTHER
              MOVE ZERO TO Form1-RADIO-1-BUF
           END-EVALUATE
      * DB_Entry-Field : ef-cli-fm
           MOVE btno-cod-cli-fm TO ef-cli-fm-BUF
      * DB_Entry-Field : ef-des-fm
           MOVE btno-prg-destino-fm TO ef-des-fm-BUF
      * DB_Entry-Field : ef-art
           MOVE ror-cod-articolo TO ef-art-BUF
      * DB_Entry-Field : ef-qta
           MOVE ror-qta TO ef-qta-BUF
      * DB_Entry-Field : ef-prz
           MOVE ror-prz-unitario TO ef-prz-BUF
      * DB_Entry-Field : ef-consumo
           MOVE ror-imp-consumo TO ef-consumo-BUF
      * DB_Entry-Field : ef-coubat
           MOVE ror-imp-cou-cobat TO ef-coubat-BUF
      * DB_Entry-Field : ef-add
           MOVE ror-add-piombo TO ef-add-BUF
      * DB_Entry-Field : ef-imp
           MOVE ror-imponib-merce TO ef-imp-BUF
      * DB_Entry-Field : ef-iva
           MOVE ror-cod-iva TO ef-iva-BUF
      * DB_LABEL : lab-art
              MOVE art-descrizione  TO lab-art-BUF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
           perform AFTER-FLD-TO-BUF.

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           if btno-vettore not = old-btno-vettore
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-vet è l'ID del campo ef-vet
              move 78-ID-ef-vet to store-id 
           end-if

           if btno-num-bolla not = old-btno-num-bolla
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-num-bolla è l'ID del campo ef-num-bolla
              move 78-ID-ef-num-bolla to store-id 
           end-if

           if btno-data-bolla not = old-btno-data-bolla
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data-bolla è l'ID del campo ef-data-bolla
              move 78-ID-ef-data-bolla to store-id 
           end-if

           if btno-num-reso not = old-btno-num-reso
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-num-reso è l'ID del campo ef-num-reso
              move 78-ID-ef-num-reso to store-id 
           end-if

           if btno-data-ingresso not = old-btno-data-ingresso
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data-ingresso è l'ID del campo ef-data-ingresso
              move 78-ID-ef-data-ingresso to store-id 
           end-if

           if btno-motivo-cont not = old-btno-motivo-cont
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-motivo è l'ID del campo ef-motivo
              move 78-ID-ef-motivo to store-id 
           end-if

           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           .             

       Form1-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-des è l'ID del campo ef-des
           when 78-ID-ef-des
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-vet è l'ID del campo ef-vet
           when 78-ID-ef-vet
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cli-fm è l'ID del campo ef-cli-fm
           when 78-ID-ef-cli-fm
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-des-fm è l'ID del campo ef-des-fm
           when 78-ID-ef-des-fm
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-art è l'ID del campo ef-art
           when 78-ID-ef-art
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |78-ID-ef-prz è l'ID del campo ef-prz
           when 78-ID-ef-prz
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-consumo è l'ID del campo ef-consumo
           when 78-ID-ef-consumo
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-coubat è l'ID del campo ef-coubat
           when 78-ID-ef-coubat
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-add è l'ID del campo ef-add
           when 78-ID-ef-add
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-imp è l'ID del campo ef-imp
           when 78-ID-ef-imp
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-des è l'ID del campo ef-des
           when 78-ID-ef-des
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-vet è l'ID del campo ef-vet
           when 78-ID-ef-vet
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cli-fm è l'ID del campo ef-cli-fm
           when 78-ID-ef-cli-fm
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-des-fm è l'ID del campo ef-des-fm
           when 78-ID-ef-des-fm
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-art è l'ID del campo ef-art
           when 78-ID-ef-art
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |78-ID-ef-prz è l'ID del campo ef-prz
           when 78-ID-ef-prz
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-consumo è l'ID del campo ef-consumo
           when 78-ID-ef-consumo
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-coubat è l'ID del campo ef-coubat
           when 78-ID-ef-coubat
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-add è l'ID del campo ef-add
           when 78-ID-ef-add
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-imp è l'ID del campo ef-imp
           when 78-ID-ef-imp
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                perform CONTROLLO
           |78-ID-ef-des è l'ID del campo ef-des
           when 78-ID-ef-des
                perform CONTROLLO
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                perform CONTROLLO
           |78-ID-ef-vet è l'ID del campo ef-vet
           when 78-ID-ef-vet
                perform CONTROLLO
           |78-ID-ef-data-bolla è l'ID del campo ef-data-bolla
           when 78-ID-ef-data-bolla
                perform CONTROLLO
           |78-ID-ef-num-reso è l'ID del campo ef-num-reso
           when 78-ID-ef-num-reso
                perform CONTROLLO
           |78-ID-ef-data-ingresso è l'ID del campo ef-data-ingresso
           when 78-ID-ef-data-ingresso
                perform CONTROLLO
           |78-ID-cbo-colpa è l'ID del campo cbo-colpa
           when 78-ID-cbo-colpa
                perform CONTROLLO
           |78-ID-ef-note è l'ID del campo ef-note
           when 78-ID-ef-note
                perform CONTROLLO
           |78-ID-ef-cli-fm è l'ID del campo ef-cli-fm
           when 78-ID-ef-cli-fm
                perform CONTROLLO
           |78-ID-ef-des-fm è l'ID del campo ef-des-fm
           when 78-ID-ef-des-fm
                perform CONTROLLO
           |78-ID-ef-art è l'ID del campo ef-art
           when 78-ID-ef-art
                perform CONTROLLO
           |78-ID-ef-qta è l'ID del campo ef-qta
           when 78-ID-ef-qta
                perform CONTROLLO
           |78-ID-ef-prz è l'ID del campo ef-prz
           when 78-ID-ef-prz
                perform CONTROLLO
           |78-ID-ef-consumo è l'ID del campo ef-consumo
           when 78-ID-ef-consumo
                perform CONTROLLO
           |78-ID-ef-coubat è l'ID del campo ef-coubat
           when 78-ID-ef-coubat
                perform CONTROLLO
           |78-ID-ef-add è l'ID del campo ef-add
           when 78-ID-ef-add
                perform CONTROLLO
           |78-ID-ef-imp è l'ID del campo ef-imp
           when 78-ID-ef-imp
                perform CONTROLLO
           |78-ID-ef-iva è l'ID del campo ef-iva
           when 78-ID-ef-iva
                perform CONTROLLO
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.



       Screen1-Ta-1-TABCHANGE.
           MOVE 0 TO 
                   Screen1-Pg-1-Visible,
                   Screen1-Pg-2-Visible,
                   Screen1-Pg-3-Visible,
                   Screen1-Pg-4-Visible,
           EVALUATE Screen1-Ta-1-TAB-VALUE
           WHEN 1
                  MOVE 1 TO Screen1-Pg-1-Visible
                  MODIFY Screen1-Ta-1, VALUE = 1
           WHEN 2
                  MOVE 1 TO Screen1-Pg-2-Visible
                  MODIFY Screen1-Ta-1, VALUE = 2
           WHEN 3
                  MOVE 1 TO Screen1-Pg-3-Visible
                  MODIFY Screen1-Ta-1, VALUE = 3
           WHEN 4
                  MOVE 1 TO Screen1-Pg-4-Visible
                  MODIFY Screen1-Ta-1, VALUE = 4
           END-EVALUATE
           MOVE 1 TO CONTROL-ID
           DISPLAY Form1
           .

       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "Digitare il codice cliente" to 
           TOTEM-HINT-TEXT
           WHEN 5002 MOVE "Digitare il progressivo per il destino" to 
           TOTEM-HINT-TEXT
           WHEN 5003 MOVE "Digitare il Codice Pagamento" to 
           TOTEM-HINT-TEXT
           WHEN 5004 MOVE "Digitare il Codice del Corriere" to 
           TOTEM-HINT-TEXT
           WHEN 5005 MOVE "Digitare il numero di bolla" to 
           TOTEM-HINT-TEXT
           WHEN 5006 MOVE "Digitare la data bolla" to TOTEM-HINT-TEXT
           WHEN 5007 MOVE "Digitare il numero di reso" to 
           TOTEM-HINT-TEXT
           WHEN 5008 MOVE "Digitare la data d'ingresso merce" to 
           TOTEM-HINT-TEXT
           WHEN 5009 MOVE "Digitare il motivo della contestazione" to 
           TOTEM-HINT-TEXT
           WHEN 5010 MOVE "Selezionare la responsabilit" to 
           TOTEM-HINT-TEXT
           WHEN 5011 MOVE "Digitare le note" to TOTEM-HINT-TEXT
           WHEN 5012 MOVE "Indica a che fa riferimento la nota per addeb
      -    "ito" to TOTEM-HINT-TEXT
           WHEN 5013 MOVE "Indica a che fa riferimento la nota per addeb
      -    "ito" to TOTEM-HINT-TEXT
           WHEN 5014 MOVE "Digitare il codice cliente per addebito" to 
           TOTEM-HINT-TEXT
           WHEN 5015 MOVE "Digitare il progressivo per il destino per ad
      -    "debito" to TOTEM-HINT-TEXT
           WHEN 5017 MOVE "Digitare il codice dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5018 MOVE "Digitare la quantit" to TOTEM-HINT-TEXT
           WHEN 5019 MOVE "Digitare il prezzo unitario" to 
           TOTEM-HINT-TEXT
           WHEN 5020 MOVE "Valore imposta sul consumo" to 
           TOTEM-HINT-TEXT
           WHEN 5021 MOVE "Valore imposta COU/COBAT" to TOTEM-HINT-TEXT
           WHEN 5022 MOVE "Valore addizionale piombo" to TOTEM-HINT-TEXT
           WHEN 5023 MOVE "Valore imponibile della merce" to 
           TOTEM-HINT-TEXT
           WHEN 5024 MOVE "Codice I.V.A." to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-cli-BeforeProcedure
           When 5002 PERFORM ef-des-BeforeProcedure
           When 5003 PERFORM ef-pag-BeforeProcedure
           When 5004 PERFORM ef-pag-BeforeProcedure
           When 5005 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5006 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5007 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5008 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5009 PERFORM ef-note-BeforeProcedure
           When 5010 PERFORM cbo-stato-BeforeProcedure
           When 5011 PERFORM ef-note-BeforeProcedure
           When 5012 PERFORM Screen1-DaRb-1-BeforeProcedure
           When 5013 PERFORM Screen1-DaRb-1-BeforeProcedure
           When 5014 PERFORM ef-cli-BeforeProcedure
           When 5015 PERFORM ef-des-BeforeProcedure
           When 5017 PERFORM ef-art-BeforeProcedure
           When 5018 PERFORM ef-qta-BeforeProcedure
           When 5019 PERFORM ef-uni-BeforeProcedure
           When 5020 PERFORM ef-cons-BeforeProcedure
           When 5021 PERFORM ef-cou-BeforeProcedure
           When 5022 PERFORM ef-add-BeforeProcedure
           When 5023 PERFORM ef-imp-BeforeProcedure
           When 5024 PERFORM ef-iva-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Form1-AfterProcedure.
           EVALUATE Control-Id
           When 5001 PERFORM ef-cli-AfterProcedure
           When 5002 PERFORM ef-des-AfterProcedure
           When 5003 PERFORM ef-pag-AfterProcedure
           When 5004 PERFORM ef-pag-AfterProcedure
           When 5005 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5006 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5007 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5008 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5009 PERFORM ef-note-AfterProcedure
           When 5011 PERFORM ef-note-AfterProcedure
           When 5012 PERFORM Screen1-DaRb-1-AfterProcedure
           When 5013 PERFORM Screen1-DaRb-1-AfterProcedure
           When 5014 PERFORM ef-cli-AfterProcedure
           When 5015 PERFORM ef-des-AfterProcedure
           When 5017 PERFORM ef-art-AfterProcedure
           When 5018 PERFORM ef-qta-AfterProcedure
           When 5019 PERFORM ef-uni-AfterProcedure
           When 5020 PERFORM ef-cons-AfterProcedure
           When 5021 PERFORM ef-cou-AfterProcedure
           When 5022 PERFORM ef-cou-AfterProcedure
           When 5023 PERFORM ef-imp-AfterProcedure
           When 5024 PERFORM ef-iva-AfterProcedure
           END-EVALUATE
           perform Form1-AFTER-SCREEN
           .

       Screen1-Event-Proc.
           .

       Screen1-Ta-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Cmd-Tabchanged ALSO 1 ALSO
                    Form1-handle
              PERFORM Screen1-Ta-1-Ev-Cmd-Tabchanged
           END-EVALUATE
           .

       form1-gd-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 5016 ALSO
                    Form1-handle 
              PERFORM form1-gd-1-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5016 ALSO
                    Form1-handle 
              PERFORM form1-gd-1-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5016 ALSO
                    Form1-handle 
              PERFORM form1-gd-1-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5016 ALSO
                    Form1-handle 
              PERFORM form1-gd-1-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5016 ALSO
                    Form1-handle 
              PERFORM form1-gd-1-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5016 ALSO
                    Form1-handle 
              PERFORM form1-gd-1-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5026 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5026 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Begin-Entry
           WHEN Msg-Cancel-Entry ALSO 5026 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Cancel-Entry
           WHEN Msg-End-Drag ALSO 5026 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-End-Drag
           WHEN Msg-Finish-Entry ALSO 5026 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Finish-Entry
           WHEN Msg-Goto-Cell ALSO 5026 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5026 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5026 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5028 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5028 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Begin-Entry
           WHEN Msg-Cancel-Entry ALSO 5028 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Cancel-Entry
           WHEN Msg-End-Drag ALSO 5028 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-End-Drag
           WHEN Msg-Finish-Entry ALSO 5028 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Finish-Entry
           WHEN Msg-Goto-Cell ALSO 5028 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5028 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5028 ALSO
                    Form1-handle 
              PERFORM form1-gd-2-Ev-Msg-Goto-Cell-Mouse
           END-EVALUATE
           .

       gd-pag2-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 5025 ALSO
                    Form1-handle 
              PERFORM gd-pag2-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5025 ALSO
                    Form1-handle 
              PERFORM gd-pag2-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5025 ALSO
                    Form1-handle 
              PERFORM gd-pag2-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5025 ALSO
                    Form1-handle 
              PERFORM gd-pag2-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5025 ALSO
                    Form1-handle 
              PERFORM gd-pag2-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5025 ALSO
                    Form1-handle 
              PERFORM gd-pag2-Ev-Msg-Goto-Cell-Mouse
           END-EVALUATE
           .

       gd-pag3-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 5027 ALSO
                    Form1-handle 
              PERFORM gd-pag3-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5027 ALSO
                    Form1-handle 
              PERFORM gd-pag3-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5027 ALSO
                    Form1-handle 
              PERFORM gd-pag3-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5027 ALSO
                    Form1-handle 
              PERFORM gd-pag3-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5027 ALSO
                    Form1-handle 
              PERFORM gd-pag3-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5027 ALSO
                    Form1-handle 
              PERFORM gd-pag3-Ev-Msg-Goto-Cell-Mouse
           END-EVALUATE
           .

      * USER DEFINE PARAGRAPH
       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "abilita-toolbar.cpy".
           copy "utydata.cpy".
           copy "color-custom.cpy".
           copy "riempi-combo-colpa.cpy".
           copy "zoom-su-tmp-progmag.cpy".
           copy "addizionale-piombo.cpy".
           copy "bozze-procedure.cpy".
           copy "bnotavar-procedure.cpy".  
           copy "trova-parametro.cpy" 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           perform SALVA 
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
           INQUIRE TOOL-MODIFICA, ENABLED IN E-MODIFICA.
      
           IF E-MODIFICA = 1
              PERFORM MODIFICA
           END-IF 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca.
           if e-cerca = 1      perform CERCA end-if 
           .
      * <TOTEM:END>
       Screen1-Ta-1-Ev-Cmd-Tabchanged.
      * <TOTEM:PARA. Screen1-Ta-1-Ev-Cmd-Tabchanged>
           perform CHANGE-TAB.
           if lk-bl-prog-id = "selnota"
              move 1 to v-nota
              modify pb-notacr, bitmap-number = 1, visible 1
           end-if.

           if lk-bl-prog-id = "selfat"
              move 1 to v-nota
              modify pb-notacr, bitmap-number = 5, visible 1
           end-if 
           .
      * <TOTEM:END>
       notacr-Ev-Before-Program.
      * <TOTEM:PARA. notacr-Ev-Before-Program>
           copy resource "conferma.bmp".
           call "W$BITMAP" using wbitmap-load "conferma.bmp",
                          giving conferma-bmp.

           initialize tab-id.
           move 78-ID-ef-cli     to min-id(1).
           move 78-ID-ef-des-fm  to max-id(1).
           move 78-ID-form1-gd-1 to min-id(2).
           move 78-ID-ef-iva     to max-id(2).

           move NotaChiave       to LinkChiave.

           accept esercizio-g2 from environment "ESERCIZIO_G2".
           accept esercizio-x  from environment "ESERCIZIO".
           move   esercizio-x  to esercizio.
           set modifica to true.

           move "Modifica Bozza per Nota Credito/Addebito" to titolo 
           .
      * <TOTEM:END>
       notacr-Ev-After-Program.
      * <TOTEM:PARA. notacr-Ev-After-Program>
           call "W$BITMAP" using wbitmap-destroy, conferma-bmp.
           if KeyboardSaved
              set KeyboardReleased to true
              set environment "KEYSTROKE" to "DATA=44 44"
              set environment "KEYSTROKE" to "DATA=46 46"
           end-if 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-End-Drag.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-End-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       form1-gd-1-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. form1-gd-1-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       ef-art-BeforeProcedure.
      * <TOTEM:PARA. ef-art-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-ARTICOLO.
           modify ef-art,     color colore-nu.
           modify ef-qta,     color colore-or.
           modify ef-prz,     color colore-or.
           modify ef-consumo, color colore-or.
           modify ef-coubat,  color colore-or.
           modify ef-add,     color colore-or.
           modify ef-iva,     color colore-or 
           .
      * <TOTEM:END>
       ef-qta-BeforeProcedure.
      * <TOTEM:PARA. ef-qta-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           set ControllaCampi to true.
           if FromSpostamento
              perform CANCELLA-COLORE
              move 78-ID-ef-art    to control-id
              move 4               to accept-control
              set FromSpostamento  to false
              set ArticoloSetFocus to true
           end-if 
           .
      * <TOTEM:END>
       ef-art-AfterProcedure.
      * <TOTEM:PARA. ef-art-AfterProcedure>
              INQUIRE ef-art, VALUE IN ror-cod-articolo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-art-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-qta-AfterProcedure.
      * <TOTEM:PARA. ef-qta-AfterProcedure>
              INQUIRE ef-qta, VALUE IN ror-qta
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-qta-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-uni-BeforeProcedure.
      * <TOTEM:PARA. ef-uni-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-PREZZO 
           .
      * <TOTEM:END>
       ef-uni-AfterProcedure.
      * <TOTEM:PARA. ef-uni-AfterProcedure>
           
              INQUIRE ef-prz, VALUE IN ror-prz-unitario
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-prz-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cons-BeforeProcedure.
      * <TOTEM:PARA. ef-cons-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           modify ef-consumo, color = colore-nu.
           perform BEFORE-CAMPI-IMPOSTE 
           .
      * <TOTEM:END>
       ef-cons-AfterProcedure.
      * <TOTEM:PARA. ef-cons-AfterProcedure>
              INQUIRE ef-consumo, VALUE IN ror-imp-consumo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-consumo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cou-BeforeProcedure.
      * <TOTEM:PARA. ef-cou-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           modify ef-coubat, color = colore-nu.
           perform BEFORE-CAMPI-IMPOSTE 
           .
      * <TOTEM:END>
       ef-cou-AfterProcedure.
      * <TOTEM:PARA. ef-cou-AfterProcedure>
              INQUIRE ef-coubat, VALUE IN ror-imp-cou-cobat
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-coubat-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-add, VALUE IN ror-add-piombo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-add-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-imp-AfterProcedure.
      * <TOTEM:PARA. ef-imp-AfterProcedure>
              INQUIRE ef-imp, VALUE IN ror-imponib-merce
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-nuovo-BeforeProcedure.
      * <TOTEM:PARA. pb-nuovo-BeforeProcedure>
           modify pb-nuovo, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-nuovo-AfterProcedure.
      * <TOTEM:PARA. pb-nuovo-AfterProcedure>
           modify pb-nuovo, bitmap-number = 5 
           .
      * <TOTEM:END>
       pb-elimina-BeforeProcedure.
      * <TOTEM:PARA. pb-elimina-BeforeProcedure>
           modify pb-elimina, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-elimina-AfterProcedure.
      * <TOTEM:PARA. pb-elimina-AfterProcedure>
           modify pb-elimina, bitmap-number = 4 
           .
      * <TOTEM:END>
       pb-nuovo-LinkTo.
      * <TOTEM:PARA. pb-nuovo-LinkTo>
           perform PB-NUOVO-PRESSED 
           .
      * <TOTEM:END>
       pb-elimina-LinkTo.
      * <TOTEM:PARA. pb-elimina-LinkTo>
           if mod-campi = 1
              perform CANCELLA-RIGA
           end-if 
           .
      * <TOTEM:END>
       form1-gd-1-BeforeProcedure.
      * <TOTEM:PARA. form1-gd-1-BeforeProcedure>
           if mod-campi = 1
              move 78-ID-ef-art to control-id
              move 4            to accept-control
           end-if 
           .
      * <TOTEM:END>
       ef-iva-BeforeProcedure.
      * <TOTEM:PARA. ef-iva-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           if FromSpostamento
              perform CANCELLA-COLORE
              set ArticoloSetFocus to false
              move 78-ID-ef-art to control-id
              move 4            to accept-control
           end-if 
           .
      * <TOTEM:END>
       ef-iva-AfterProcedure.
      * <TOTEM:PARA. ef-iva-AfterProcedure>
              INQUIRE ef-iva, VALUE IN ror-cod-iva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-iva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       TOOL-CANCELLA-LinkTo.
      * <TOTEM:PARA. TOOL-CANCELLA-LinkTo>
           inquire tool-cancella, enabled in e-cancella.
           if e-cancella = 1 perform CANCELLA end-if 
           .
      * <TOTEM:END>
       ef-cli-BeforeProcedure.
      * <TOTEM:PARA. ef-cli-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPO-CLIENTE 
           .
      * <TOTEM:END>
       ef-cli-AfterProcedure.
      * <TOTEM:PARA. ef-cli-AfterProcedure>
              INQUIRE ef-cli, VALUE IN btno-cod-cli
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cli-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cli-fm, VALUE IN btno-cod-cli-fm
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cli-fm-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-des-BeforeProcedure.
      * <TOTEM:PARA. ef-des-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-des-AfterProcedure.
      * <TOTEM:PARA. ef-des-AfterProcedure>
              INQUIRE ef-des, VALUE IN btno-prg-destino
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-des-fm, VALUE IN btno-prg-destino-fm
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des-fm-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-pag-BeforeProcedure.
      * <TOTEM:PARA. ef-pag-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-pag-AfterProcedure.
      * <TOTEM:PARA. ef-pag-AfterProcedure>
              INQUIRE ef-pag, VALUE IN btno-cod-pag
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-vet, VALUE IN btno-vettore
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vet-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Screen1-DaEf-1-BeforeProcedure.
      * <TOTEM:PARA. Screen1-DaEf-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Screen1-DaEf-1-AfterProcedure.
      * <TOTEM:PARA. Screen1-DaEf-1-AfterProcedure>
              INQUIRE ef-num-bolla, VALUE IN btno-num-bolla
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-num-bolla-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-data-bolla, VALUE IN btno-data-bolla
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-bolla-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-num-reso, VALUE IN btno-num-reso
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-num-reso-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-data-ingresso, VALUE IN btno-data-ingresso
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-ingresso-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-BeforeProcedure.
      * <TOTEM:PARA. ef-note-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-AfterProcedure.
      * <TOTEM:PARA. ef-note-AfterProcedure>
              INQUIRE ef-motivo, VALUE IN btno-motivo-cont
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-motivo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-note, VALUE IN btno-note
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       cbo-stato-BeforeProcedure.
      * <TOTEM:PARA. cbo-stato-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cbo-stato-AfterProcedure.
      * <TOTEM:PARA. cbo-stato-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       Screen1-DaRb-1-BeforeProcedure.
      * <TOTEM:PARA. Screen1-DaRb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Screen1-DaRb-1-AfterProcedure.
      * <TOTEM:PARA. Screen1-DaRb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       gd-pag2-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-pag2-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-GD-PAG-2 
           .
      * <TOTEM:END>
       gd-pag2-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-pag2-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       gd-pag2-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-pag2-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-GD-PAG-2 
           .
      * <TOTEM:END>
       gd-pag2-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-pag2-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-GD-PAG-2 
           .
      * <TOTEM:END>
       gd-pag2-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-pag2-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-GD-PAG-2 
           .
      * <TOTEM:END>
       gd-pag2-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-pag2-Ev-Msg-Goto-Cell-Mouse>
           if mod-campi = 1
              perform SELEZIONA-RIGA-PAG-2
           else
              perform SPOSTAMENTO-GD-PAG-2
           end-if 
           .
      * <TOTEM:END>
       pb-sel-tutto-n-BeforeProcedure.
      * <TOTEM:PARA. pb-sel-tutto-n-BeforeProcedure>
           modify pb-sel-tutto-n, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-sel-tutto-n-AfterProcedure.
      * <TOTEM:PARA. pb-sel-tutto-n-AfterProcedure>
           modify pb-sel-tutto-n, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-sel-tutto-n-LinkTo.
      * <TOTEM:PARA. pb-sel-tutto-n-LinkTo>
           if mod-campi = 1
              perform PB-SEL-TUTTO-N-PRESSED
           end-if 
           .
      * <TOTEM:END>
       pb-genera2-BeforeProcedure.
      * <TOTEM:PARA. pb-genera2-BeforeProcedure>
           modify pb-genera2, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-genera2-AfterProcedure.
      * <TOTEM:PARA. pb-genera2-AfterProcedure>
           modify pb-genera2, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-genera2-LinkTo.
      * <TOTEM:PARA. pb-genera2-LinkTo>
           if mod-campi = 1
              perform PB-GENERA2-PRESSED
           end-if 
           .
      * <TOTEM:END>
       form1-gd-2-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. form1-gd-2-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO2 
           .
      * <TOTEM:END>
       form1-gd-2-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. form1-gd-2-Ev-Msg-Begin-Entry>
           if mod-campi = 1
              perform FORM1-GD-2-BEGIN-ENTRY
           else
              set event-action to event-action-fail
           end-if 
           .
      * <TOTEM:END>
       form1-gd-2-Ev-Msg-End-Drag.
      * <TOTEM:PARA. form1-gd-2-Ev-Msg-End-Drag>
           perform SPOSTAMENTO2 
           .
      * <TOTEM:END>
       form1-gd-2-Ev-Msg-Finish-Entry.
      * <TOTEM:PARA. form1-gd-2-Ev-Msg-Finish-Entry>
           perform FORM1-GD-2-FINISH-ENTRY 
           .
      * <TOTEM:END>
       form1-gd-2-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. form1-gd-2-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO2 
           .
      * <TOTEM:END>
       form1-gd-2-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. form1-gd-2-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO2 
           .
      * <TOTEM:END>
       form1-gd-2-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. form1-gd-2-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO2 
           .
      * <TOTEM:END>
       pb-notacr-BeforeProcedure.
      * <TOTEM:PARA. pb-notacr-BeforeProcedure>
           if lk-bl-prog-id = "selnota"
              move 2 to NumBitmapPb
              modify pb-notacr, bitmap-number = 2
           end-if.

           if lk-bl-prog-id = "selfat"
              move 6 to NumBitmapPb
              modify pb-notacr, bitmap-number = 6
           end-if 
           .
      * <TOTEM:END>
       pb-notacr-AfterProcedure.
      * <TOTEM:PARA. pb-notacr-AfterProcedure>
           if lk-bl-prog-id = "selnota"
              move 1 to NumBitmapPb
              modify pb-notacr, bitmap-number = 1
           end-if.

           if lk-bl-prog-id = "selfat"
              move 5 to NumBitmapPb
              modify pb-notacr, bitmap-number = 5
           end-if 
           .
      * <TOTEM:END>
       pb-notacr-LinkTo.
      * <TOTEM:PARA. pb-notacr-LinkTo>
           move  1 to LinkStatusNota.
           move 27 to key-status 
           .
      * <TOTEM:END>
       ef-add-BeforeProcedure.
      * <TOTEM:PARA. ef-add-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           modify ef-add, color = colore-nu.
           perform BEFORE-CAMPI-IMPOSTE 
           .
      * <TOTEM:END>
       rb-cli-LinkTo.
      * <TOTEM:PARA. rb-cli-LinkTo>
           move 1 to form1-radio-1-buf 
           .
      * <TOTEM:END>
       rb-vet-LinkTo.
      * <TOTEM:PARA. rb-vet-LinkTo>
           move 2 to form1-radio-1-buf 
           .
      * <TOTEM:END>
       form1-gd-2-Ev-Msg-Cancel-Entry.
      * <TOTEM:PARA. form1-gd-2-Ev-Msg-Cancel-Entry>
           perform RESETTA-VIRGOLA 
           .
      * <TOTEM:END>
       pb-sel-tutto-r-LinkTo.
      * <TOTEM:PARA. pb-sel-tutto-r-LinkTo>
           if mod-campi = 1
              perform PB-SEL-TUTTO-R-PRESSED
           end-if 
           .
      * <TOTEM:END>
       pb-sel-tutto-r-BeforeProcedure.
      * <TOTEM:PARA. pb-sel-tutto-r-BeforeProcedure>
           modify pb-sel-tutto-r, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-sel-tutto-r-AfterProcedure.
      * <TOTEM:PARA. pb-sel-tutto-r-AfterProcedure>
           modify pb-sel-tutto-r, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-genera-r-BeforeProcedure.
      * <TOTEM:PARA. pb-genera-r-BeforeProcedure>
           modify pb-genera-r, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-genera-r-AfterProcedure.
      * <TOTEM:PARA. pb-genera-r-AfterProcedure>
           modify pb-genera-r, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-genera-r-LinkTo.
      * <TOTEM:PARA. pb-genera-r-LinkTo>
           if mod-campi = 1
              perform PB-GENERA-R-PRESSED
           end-if 
           .
      * <TOTEM:END>
       gd-pag3-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-pag3-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-GD-PAG-3 
           .
      * <TOTEM:END>
       gd-pag3-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-pag3-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       gd-pag3-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-pag3-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-GD-PAG-3 
           .
      * <TOTEM:END>
       gd-pag3-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-pag3-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-GD-PAG-3 
           .
      * <TOTEM:END>
       gd-pag3-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-pag3-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-GD-PAG-3 
           .
      * <TOTEM:END>
       gd-pag3-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-pag3-Ev-Msg-Goto-Cell-Mouse>
           if mod-campi = 1
              perform SELEZIONA-RIGA-PAG-3
           else
              perform SPOSTAMENTO-GD-PAG-3
           end-if 
           .
      * <TOTEM:END>

      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

