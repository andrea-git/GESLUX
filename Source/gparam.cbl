      *{TOTEM}PRG-COMMENT
      * gparam.Cbl
      * gparam.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          gparam.
       AUTHOR.              andre.
       DATE-WRITTEN.        mercoledì 24 giugno 2020 10:15:00.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:gparam, INIT:gparam, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "ttipocli.sl".
           COPY "tgrupgdo.sl".
           COPY "clienti.sl".
           COPY "destini.sl".
           COPY "tvettori.sl".
           COPY "tmagaz.sl".
           COPY "param.sl".
           COPY "param.sl"
                REPLACING ==param== BY ==param1==,
                          ==STATUS-param== BY ==STATUS-param1==
                .
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "ttipocli.fd".
           COPY "tgrupgdo.fd".
           COPY "clienti.fd".
           COPY "destini.fd".
           COPY "tvettori.fd".
           COPY "tmagaz.fd".
           COPY "param.fd".
           COPY "param.fd"
                REPLACING ==param== BY ==param1==,
                          ==STATUS-param== BY ==STATUS-param1==
                .
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "crtvars.def".
               COPY "opensave.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "standard.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
      * Properties & User defined Working Stoarge
       77 Screen1-SF-HANDLE
                  USAGE IS HANDLE OF WINDOW.
           COPY  "APRI-NOTE.DEF".
           COPY  "SELPRINT.LKS".
           COPY  "LINK-GESLOCK.DEF".
       77 Screen1-MN-1-HANDLE
                  USAGE IS HANDLE OF MENU.
       78 titolo VALUE IS "GESLUX - Gestione parametri". 
       77 Form1-Tb-1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 TOOLBAR-BMP      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 E-ESCI           PIC  9
                  VALUE IS 1.
       77 opensave-status  PIC  s99.
       77 E-CANCELLA       PIC  9
                  VALUE IS 1.
       77 E-SALVA          PIC  9
                  VALUE IS 1.
       77 E-ANTEPRIMA      PIC  9
                  VALUE IS 1.
       77 E-MODIFICA       PIC  9
                  VALUE IS 1.
       77 E-CERCA          PIC  9
                  VALUE IS 1.
       77 E-SELEZIONA      PIC  9
                  VALUE IS 1.
       77 path-logo        PIC  x(200).
       77 old-mag-codice   PIC  x(3).
       77 save-tipocli     PIC  x(2).
       77 save-gdo         PIC  x(5).
       77 save-cliente     PIC  9(5).
       77 save-destino     PIC  9(5).
       77 como-min-kg1     PIC  9(5)v999.
       77 como-min-kg2     PIC  9(5)v999.
       78 78-ini VALUE IS "Giorni isolamento merce da inizio volantino"
           . 
       78 78-parziale VALUE IS "Giorni evasione parziale prima della dat
      -    "a di consegna". 
       78 78-per-cons VALUE IS "DATA CONSEGNA DEFAULT: Oggi + evasione p
      -    "arziale + questo valore". 
       78 78-val VALUE IS "VALIDITA' PROMO: la promo è ancora valida se 
      -    "questo valore + data di fine volantino > oggi". 
       78 78-max VALUE IS "Giorni inizio evasione dalla data di consegna
      -    "". 
       78 78-vet-max VALUE IS "EVASIONE MASTER: Le Evasioni di peso >= a
      -    "l campo precedente avranno di default questo vettore". 
       78 78-kg-max VALUE IS "EVASIONE MASTER: Le Evasioni di peso >= a 
      -    "questo avranno il vettore indicato al campo successivo, se n
      -    "on indicato quello del master". 
       78 78-vet-min2 VALUE IS "EVASIONE MASTER: Le Evasioni di peso <= 
      -    "al campo precedente avranno di default questo vettore (scagl
      -    "ione 2)". 
       78 78-vet-min1 VALUE IS "EVASIONE MASTER: Le Evasioni di peso <= 
      -    "al campo precedente avranno di default questo vettore (scagl
      -    "ione 1)". 
       78 78-kg-min1 VALUE IS "EVASIONE MASTER: Peso MINIMO spedizione p
      -    "er vettore (scaglione 1)". 
       78 78-kg-min2 VALUE IS "EVASIONE MASTER: Peso MINIMO spedizione p
      -    "er vettore (scaglione 2)". 
       78 78-blocco VALUE IS "EVASIONE MASTER: Le Evasioni di peso < a q
      -    "uesto valore non veranno generate". 
       78 78-promo VALUE IS "EVASIONE MASTER: Imposta sul master TENERE 
      -    "SALDI PROMO; Il master non verrà chiuso in presenza di promo
      -    " attive non evase completamente". 
       78 78-banco VALUE IS "EVASIONE MASTER: Imposta sul master TENERE 
      -    "SALDI BANCO; Il master non verrà chiuso in presenza di righe
      -    " banco non evase completamente". 
       78 78-imb-minimo VALUE IS "AGGIORNAMENTO MASTER: Un registrato ch
      -    "e è minore di un imballo minimo devo evadere l'imballo aumen
      -    "tandone la quantità". 
       78 78-cod-art-forn VALUE IS "STAMPA BOLLA: stampa il codice artic
      -    "olo fornitore dall'anagrafica clienti al posto di quello da 
      -    "listino". 
       78 78-escludi VALUE IS "EVASIONE MASTER: Non considera la selezio
      -    "ne EVADI TUTTO iniziale dell'utente". 
       78 78-accorpa VALUE IS "EVASIONE MASTER: Accorpa in un'unica evas
      -    "ione i master appartenenti allo stesso cliente/destino". 
       78 78-mag VALUE IS "EVASIONE MASTER: Magazzini su cui effettuare 
      -    "l'evasione". 
       78 78-totale VALUE IS "EVASIONE MASTER: il master verrà evaso sol
      -    "o totalmente (ex magazzino)". 
       78 78-prenot VALUE IS "PRENOTAZIONE QTA". 
       78 78-pb-perce VALUE IS "CALCOLO  ADDIZIONALE PIOMBO: Utilizza la
      -    " percentuale indicata nella tabella imposte". 
       78 78-pb-amp VALUE IS "CALCOLO  ADDIZIONALE PIOMBO: Utilizza il v
      -    "alore (x ampère) indicato in anagrafica". 
       78 78-pb-amp-bosch VALUE IS "CALCOLO  ADDIZIONALE PIOMBO: Utilizz
      -    "a gli scaglioni  indicati in anagrafica". 
       78 78-logo-pers VALUE IS "In stampa bolla utilizza il logo indica
      -    "to sotto (verrà controllata la presenza di entrambi)". 
       78 78-sost-batt VALUE IS "Attiva la sostituzione delle batterie (
      -    "all'interno della catena) in gestione master". 
       78 78-path-logo VALUE IS "Path del logo da mostrare in intestazio
      -    "ne bolla (verrà controllata la presenza di entrambi)". 
       77 STATUS-clienti   PIC  X(2).
           88 Valid-STATUS-clienti VALUE IS "00" THRU "09". 
       77 STATUS-destini   PIC  X(2).
           88 Valid-STATUS-destini VALUE IS "00" THRU "09". 
       77 STATUS-param     PIC  X(2).
           88 Valid-STATUS-param VALUE IS "00" THRU "09". 
       77 STATUS-tgrupgdo  PIC  X(2).
           88 Valid-STATUS-tgrupgdo VALUE IS "00" THRU "09". 
       77 STATUS-ttipocli  PIC  X(2).
           88 Valid-STATUS-ttipocli VALUE IS "00" THRU "09". 
       01 gd-tipocli-rec.
           05 col-tipocli-codice           PIC  xx.
           05 col-tipocli-descrizione      PIC  x(50).
       01 gd-gdo-rec.
           05 col-gdo-codice   PIC  x(5).
           05 col-gdo-descrizione          PIC  x(50).
       01 gd-clienti-rec.
           05 col-cli-codice   PIC  9(5).
           05 col-cli-ragsoc   PIC  x(100).
       01 gd-destini-rec.
           05 col-des-codice   PIC  9(5).
           05 col-des-localita PIC  x(100).
       01 gd-mag-rec.
           05 col-mag-codice   PIC  x(3).
           05 col-mag-descrizione          PIC  x(100).
           05 col-mag-intera   PIC  x.
       01 gd-mag-rec-1.
           05 col-mag-codice-1 PIC  x(3).
           05 col-mag-descrizione-1        PIC  x(100).
           05 col-mag-intera-1 PIC  x.
       01 gd-mag-rec-2.
           05 col-mag-codice-2 PIC  x(3).
           05 col-mag-descrizione-2        PIC  x(100).
           05 col-mag-intera-2 PIC  x.
       01 gd-mag-rec-3.
           05 col-mag-codice-3 PIC  x(3).
           05 col-mag-descrizione-3        PIC  x(100).
           05 col-mag-intera-3 PIC  x.
       01 gd-mag-rec-4.
           05 col-mag-codice-4 PIC  x(3).
           05 col-mag-descrizione-4        PIC  x(100).
           05 col-mag-intera-4 PIC  x.
       77 Small-Font
                  USAGE IS HANDLE OF FONT SMALL-FONT.
       77 Verdana10-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 Screen1-St-1-Handle
                  USAGE IS HANDLE OF STATUS-BAR.
       77 e-1  PIC  9
                  VALUE IS 0.
       77 ef-ini-vol-buf   PIC  zz9.
       77 ef-parz-buf      PIC  9(3).
       77 ef-gg-cons-buf   PIC  999.
       77 ef-val-buf       PIC  999.
       77 ef-cons-max-buf  PIC  zz9.
       77 ef-max-kg-buf    PIC  zz.zz9,999.
       77 ef-max-kg-2-buf  PIC  zz.zz9,999.
       77 ef-max-kg-4-buf  PIC  zz.zz9,999.
       77 ef-max-vet-buf   PIC  zzzz9.
       77 ef-max-vet-3-buf PIC  zzzz9.
       77 lab-vet-max-buf  PIC  x(20).
       77 chk-accorpa-buf  PIC  9.
       77 chk-prenot-buf   PIC  9.
       77 chk-promo-buf    PIC  9.
       77 chk-banco-buf    PIC  9.
       77 chk-imb-min-buf  PIC  9
                  VALUE IS 0.
       77 ef-blocco-kg-buf PIC  zz.zz9,999.
       77 ef-ini-vol-1-buf PIC  zz9.
       77 ef-parz-1-buf    PIC  zz9.
       77 ef-gg-cons-1-buf PIC  zz9.
       77 ef-val-1-buf     PIC  zz9.
       77 ef-cons-max-1-buf            PIC  zz9.
       77 ef-blocco-kg-1-buf           PIC  zz.zz9,999.
       77 ef-max-kg-1-buf  PIC  zz.zz9,999.
       77 ef-max-kg-2buf   PIC  zz.zz9,999.
       77 ef-max-vet-1-buf PIC  zzzz9.
       77 e-2  PIC  9
                  VALUE IS 0.
       77 ef-ini-vol-2-buf PIC  zz9.
       77 ef-parz-2-buf    PIC  zz9.
       77 ef-gg-cons-2-buf PIC  zz9.
       77 ef-val-2-buf     PIC  zz9.
       77 ef-cons-max-2-buf            PIC  zz9.
       77 ef-blocco-kg-2-buf           PIC  zz.zz9,999.
       77 lab-vet-max-1-buf            PIC  x(20).
       77 chk-accorpa-1-buf            PIC  9
                  VALUE IS 0.
       77 chk-promo-1-buf  PIC  9
                  VALUE IS 0.
       77 chk-banco-1-buf  PIC  9
                  VALUE IS 0.
       77 chk-prenot-1-buf PIC  9
                  VALUE IS 0.
       77 chk-imb-min-1-buf            PIC  9
                  VALUE IS 0.
       77 ef-max-vet-2-buf PIC  zzzz9.
       77 chk-accorpa-2-buf            PIC  9
                  VALUE IS 0.
       77 chk-prenot-2-buf PIC  9
                  VALUE IS 0.
       77 chk-banco-2-buf  PIC  9
                  VALUE IS 0.
       77 chk-promo-2-buf  PIC  9
                  VALUE IS 0.
       77 chk-imb-min-2-buf            PIC  9
                  VALUE IS 0.
       77 ef-ini-vol-3-buf PIC  zz9.
       77 ef-parz-3-buf    PIC  zz9.
       77 ef-gg-cons-3-buf PIC  zz9.
       77 ef-val-3-buf     PIC  zz9.
       77 ef-cons-max-3-buf            PIC  zz9.
       77 ef-blocco-kg-3-buf           PIC  zz.zz9,999.
       77 ef-max-kg-3-buf  PIC  zz.zz9,999.
       77 ef-min-vet-3-buf PIC  zzzz9.
       77 lab-vet-max-2-buf            PIC  X(30).
       77 lab-vet-max-3-buf            PIC  x(20).
       77 chk-promo-3-buf  PIC  9
                  VALUE IS 0.
       77 chk-banco-3-buf  PIC  9
                  VALUE IS 0.
       77 chk-prenot-3-buf PIC  9
                  VALUE IS 0.
       77 chk-imb-min-3-buf            PIC  9
                  VALUE IS 0.
       77 chk-accorpa-3-buf            PIC  9
                  VALUE IS 0.
       77 e-3  PIC  9
                  VALUE IS 0.
       77 ef-ini-vol-4-buf PIC  zz9.
       77 ef-parz-4-buf    PIC  zz9.
       77 ef-gg-cons-4-buf PIC  zz9.
       77 ef-val-4-buf     PIC  zz9.
       77 ef-cons-max-4-buf            PIC  zz9.
       77 ef-blocco-kg-4-buf           PIC  zz.zz9,999.
       77 ef-min-vet-4-buf PIC  zzzz9.
       77 ef-max-vet-4-buf PIC  zzzz9.
       77 lab-vet-max-4-buf            PIC  x(20).
       77 chk-accorpa-4-buf            PIC  9
                  VALUE IS 0.
       77 chk-promo-4-buf  PIC  9
                  VALUE IS 0.
       77 chk-prenot-4-buf PIC  9
                  VALUE IS 0.
       77 chk-banco-4-buf  PIC  9
                  VALUE IS 0.
       77 chk-imb-min-4-buf            PIC  9
                  VALUE IS 0.
       77 e-4  PIC  9
                  VALUE IS 0.
       77 Default-Font
                  USAGE IS HANDLE OF FONT DEFAULT-FONT.
       77 form1-handle
                  USAGE IS HANDLE OF WINDOW.
       77 E-NUOVO          PIC  9
                  VALUE IS 0.
       77 E-STAMPA         PIC  9
                  VALUE IS 0.
       77 AUTO-ID          PIC  9(6)
                  VALUE IS 7.
       77 como-numero      PIC  9(15)v999.
       77 STATUS-tvettori  PIC  X(2).
           88 Valid-STATUS-tvettori VALUE IS "00" THRU "09". 
       77 form1-St-1-Handle
                  USAGE IS HANDLE OF STATUS-BAR.
       77 STATUS-tmagaz    PIC  X(2).
           88 Valid-STATUS-tmagaz VALUE IS "00" THRU "09". 
       77 chk-gestisci-1-buf           PIC  9
                  VALUE IS 0.
       77 chk-gestisci-2-buf           PIC  9
                  VALUE IS 0.
       77 chk-gestisci-3-buf           PIC  9
                  VALUE IS 0.
       77 chk-gestisci-4-buf           PIC  9
                  VALUE IS 0.
       77 Screen1-Bt-1-Handle          PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 logo-st-bmp      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 lubex-colori-bmp PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 sfondo-bmp       PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 logo-gparam-bmp  PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 applica-bmp      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 lubex-gif        PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 lubex-png        PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 anteprima-evaart-bmp         PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 e-tipocli        PIC  9
                  VALUE IS 0.
       77 e-gdo            PIC  9
                  VALUE IS 0.
       77 e-clienti        PIC  9
                  VALUE IS 0.
       77 e-destini        PIC  9
                  VALUE IS 0.
       77 v-gdo            PIC  9
                  VALUE IS 0.
       77 chk-escludi-buf  PIC  9
                  VALUE IS 0.
       77 chk-escludi-1-buf            PIC  9
                  VALUE IS 0.
       77 chk-escludi-2-buf            PIC  9
                  VALUE IS 0.
       77 chk-escludi-3-buf            PIC  9
                  VALUE IS 0.
       77 chk-escludi-4-buf            PIC  9
                  VALUE IS 0.
       77 Large-Font
                  USAGE IS HANDLE OF FONT LARGE-FONT.
       77 STATUS-param1    PIC  X(2).
           88 VALID-STATUS-param1 VALUE IS "00" THRU "09". 
       77 STATUS-param2    PIC  X(2).
           88 VALID-STATUS-param2 VALUE IS "00" THRU "09". 
       77 e-tipocli-dati   PIC  9
                  VALUE IS 1.
       77 e-gdo-dati       PIC  9
                  VALUE IS 1.
       77 e-clienti-dati   PIC  9
                  VALUE IS 1.
       77 e-destini-dati   PIC  9
                  VALUE IS 1.
       77 chk-intera-buf   PIC  9
                  VALUE IS 0.
       77 chk-intera-2-buf PIC  9
                  VALUE IS 0.
       77 chk-intera-3-buf PIC  9
                  VALUE IS 0.
       77 chk-art-forn-buf PIC  9
                  VALUE IS 0.
       77 chk-art-forn-1-buf           PIC  9
                  VALUE IS 0.
       77 chk-art-forn-2-buf           PIC  9
                  VALUE IS 0.
       77 chk-art-forn-3-buf           PIC  9
                  VALUE IS 0.
       77 chk-art-forn-4-buf           PIC  9
                  VALUE IS 0.
       77 chk-pb-perce-buf PIC  9
                  VALUE IS 0.
       77 chk-pb-amp-buf   PIC  9
                  VALUE IS 0.
       77 chk-pb-perce-1-buf           PIC  9
                  VALUE IS 0.
       77 chk-pb-amp-1-buf PIC  9
                  VALUE IS 0.
       77 chk-pb-perce-2-buf           PIC  9
                  VALUE IS 0.
       77 chk-pb-amp-2-buf PIC  9
                  VALUE IS 0.
       77 chk-pb-perce-3-buf           PIC  9
                  VALUE IS 0.
       77 chk-pb-amp-4-buf PIC  9
                  VALUE IS 0.
       77 chk-pb-perce-4-buf           PIC  9
                  VALUE IS 0.
       77 chk-pb-amp-3-buf PIC  9
                  VALUE IS 0.
       77 chk-pb-bosch-buf PIC  9
                  VALUE IS 0.
       77 chk-pb-bosch-1-buf           PIC  9
                  VALUE IS 0.
       77 chk-pb-bosch-3-buf           PIC  9
                  VALUE IS 0.
       77 chk-pb-bosch-4-buf           PIC  9
                  VALUE IS 0.
       77 chk-pb-bosch-2-buf           PIC  9
                  VALUE IS 0.
       77 ef-stampante-buf PIC  x(100).
       77 ef-stampante-1-buf           PIC  x(100).
       77 ef-stampante-2-buf           PIC  x(100).
       77 ef-stampante-3-buf           PIC  x(100).
       77 ef-stampante-4-buf           PIC  x(100).
       77 ef-min-kg1-buf   PIC  zz.zz9,999.
       77 ef-min-vet1-buf  PIC  9(5).
       77 ef-min-kg2-1-buf PIC  zz.zz9,999.
       77 ef-min-vet2-1-buf            PIC  9(5).
       77 ef-min-kg2-2-buf PIC  zz.zz9,999.
       77 ef-min-vet2-2-buf            PIC  9(5).
       77 ef-min-kg2-3-buf PIC  zz.zz9,999.
       77 ef-min-vet2-3-buf            PIC  9(5).
       77 ef-min-kg2-4-buf PIC  zz.zz9,999.
       77 ef-min-vet2-4-buf            PIC  9(5).
       77 ef-min-kg2-buf   PIC  zz.zz9,999.
       77 ef-min-vet2-buf  PIC  9(5).
       77 ef-min-vet1-1-buf            PIC  9(5).
       77 ef-min-kg1-1-buf PIC  zz.zz9,999.
       77 ef-min-vet1-2-buf            PIC  9(5).
       77 ef-min-kg1-2-buf PIC  zz.zz9,999.
       77 ef-min-kg1-3-buf PIC  zz.zz9,999.
       77 ef-min-vet1-3-buf            PIC  9(5).
       77 ef-min-kg1-4-buf PIC  zz.zz9,999.
       77 ef-min-vet1-4-buf            PIC  9(5).
       77 lab-vet-min2-buf PIC  x(20).
       77 lab-vet-min2-1-buf           PIC  x(20).
       77 lab-vet-min2-2-buf           PIC  x(20).
       77 lab-vet-min2-3-buf           PIC  x(20).
       77 lab-vet-min2-4-buf           PIC  x(20).
       77 lab-vet-min1-4-buf           PIC  x(20).
       77 lab-vet-min1-3-buf           PIC  x(20).
       77 lab-vet-min1-2-buf           PIC  x(20).
       77 lab-vet-min1-buf PIC  x(20).
       77 lab-vet-min1-1-buf           PIC  x(20).
       77 chk-logo-pers-buf            PIC  9
                  VALUE IS 0.
       77 ef-logo-path-buf PIC  x(100).
       77 chk-layout-pers-buf          PIC  9
                  VALUE IS 0.
       77 ef-path-logo-buf PIC  x(200).
       77 chk-layout-pers-1-buf        PIC  9
                  VALUE IS 0.
       77 ef-path-logo-1-buf           PIC  x(200).
       77 chk-layout-pers-2-buf        PIC  9
                  VALUE IS 0.
       77 ef-path-logo-2-buf           PIC  x(200).
       77 ef-path-logo-3-buf           PIC  x(200).
       77 chk-layout-pers-3-buf        PIC  9
                  VALUE IS 0.
       77 chk-layout-pers-4-buf        PIC  9
                  VALUE IS 0.
       77 ef-path-logo-4-buf           PIC  x(200).
       77 chk-pb-sost-batt-buf         PIC  9
                  VALUE IS 0.
       77 78-pb-sost-batt  PIC  X(30).
       77 chk-pb-sost-batt-1-buf       PIC  9
                  VALUE IS 0.
       77 chk-pb-sost-batt-2-buf       PIC  9
                  VALUE IS 0.
       77 chk-pb-sost-batt-3-buf       PIC  9
                  VALUE IS 0.
       77 chk-pb-sost-batt-4-buf       PIC  9
                  VALUE IS 0.
       77 chk-sost-batt-buf            PIC  9
                  VALUE IS 0.
       77 chk-sost-batt-1-buf          PIC  9
                  VALUE IS 0.
       77 chk-sost-batt-2-buf          PIC  9
                  VALUE IS 0.
       77 chk-sost-batt-3-buf          PIC  9
                  VALUE IS 0.
       77 chk-sost-batt-4-buf          PIC  9
                  VALUE IS 0.

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 TMP-DataSet1-ttipocli-BUF     PIC X(889).
       77 TMP-DataSet1-tgrupgdo-BUF     PIC X(1206).
       77 TMP-DataSet1-clienti-BUF     PIC X(1910).
       77 TMP-DataSet1-destini-BUF     PIC X(3386).
       77 TMP-DataSet1-tvettori-BUF     PIC X(1847).
       77 TMP-DataSet1-tmagaz-BUF     PIC X(212).
       77 TMP-DataSet1-param-BUF     PIC X(980).
       77 TMP-DataSet1-param1-BUF     PIC X(980).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-ttipocli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-ttipocli-LOCK  VALUE "Y".
       77 DataSet1-ttipocli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-ttipocli-KEY-Asc  VALUE "A".
          88 DataSet1-ttipocli-KEY-Desc VALUE "D".
       77 DataSet1-tgrupgdo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tgrupgdo-LOCK  VALUE "Y".
       77 DataSet1-tgrupgdo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tgrupgdo-KEY-Asc  VALUE "A".
          88 DataSet1-tgrupgdo-KEY-Desc VALUE "D".
       77 DataSet1-clienti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-clienti-LOCK  VALUE "Y".
       77 DataSet1-clienti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti-KEY-Asc  VALUE "A".
          88 DataSet1-clienti-KEY-Desc VALUE "D".
       77 DataSet1-destini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-destini-LOCK  VALUE "Y".
       77 DataSet1-destini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-destini-KEY-Asc  VALUE "A".
          88 DataSet1-destini-KEY-Desc VALUE "D".
       77 DataSet1-tvettori-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tvettori-LOCK  VALUE "Y".
       77 DataSet1-tvettori-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tvettori-KEY-Asc  VALUE "A".
          88 DataSet1-tvettori-KEY-Desc VALUE "D".
       77 DataSet1-tmagaz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmagaz-LOCK  VALUE "Y".
       77 DataSet1-tmagaz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmagaz-KEY-Asc  VALUE "A".
          88 DataSet1-tmagaz-KEY-Desc VALUE "D".
       77 DataSet1-param-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-param-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-param-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-param-KEY1-Asc  VALUE "A".
          88 DataSet1-param-KEY1-Desc VALUE "D".
       77 DataSet1-param1-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-param1-LOCK  VALUE "Y".
       77 DataSet1-param1-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-param1-KEY-Asc  VALUE "A".
          88 DataSet1-param1-KEY-Desc VALUE "D".

       77 tgrupgdo-gdo-k-g2-SPLITBUF  PIC X(9).
       77 clienti-cli-K1-SPLITBUF  PIC X(47).
       77 clienti-cli-K3-SPLITBUF  PIC X(12).
       77 clienti-cli-K4-SPLITBUF  PIC X(8).
       77 destini-K1-SPLITBUF  PIC X(51).
       77 destini-k-localita-SPLITBUF  PIC X(36).
       77 tvettori-k-des-SPLITBUF  PIC X(41).

       01 old-prm-rec.
           05 old-prm-chiave.
              10 old-prm-lubex        PIC  x(2).
              10 old-prm-tipocli      PIC  x(2).
              10 old-prm-gdo          PIC  x(5).
              10 old-prm-cliente      PIC  9(5).
              10 old-prm-destino      PIC  9(5).
           05 old-prn-dati.
              10 old-prm-gestisci     PIC  9.
                 88 old-prm-gestisci-si VALUE IS 1. 
                 88 old-prm-gestisci-no VALUE IS 0. 
              10 old-prm-gg-inizio-vol            PIC  9(3).
              10 old-prm-gg-parziale  PIC  9(3).
              10 old-prm-gg-per-cons  PIC  9(3).
              10 old-prm-gg-val-vol   PIC  9(3).
              10 old-prm-gg-cons-max  PIC  9(3).
              10 old-prm-vet-maggiore-kg          PIC  9(5).
              10 old-prm-maggiore-kg  PIC  9(5)v9(3).
              10 old-prm-vet-minore-kg2            PIC  9(5).
              10 old-prm-minore-kg2    PIC  9(5)v9(3).
              10 old-prm-blocco-kg    PIC  9(5)v999.
              10 old-prm-prenotazione-qta          PIC  9.
                 88 old-prm-prenotazione-qta-si VALUE IS 1. 
                 88 old-prm-prenotazione-qta-no VALUE IS 0. 
              10 old-prm-accorpa      PIC  9.
                 88 old-prm-accorpa-si VALUE IS 1. 
                 88 old-prm-accorpa-no VALUE IS 0. 
              10 old-prm-saldi-banco  PIC  9.
                 88 old-prm-saldi-banco-si VALUE IS 1. 
                 88 old-prm-saldi-banco-no VALUE IS 0. 
              10 old-prm-saldi-promo  PIC  9.
                 88 old-prm-saldi-promo-si VALUE IS 1. 
                 88 old-prm-saldi-promo-no VALUE IS 0. 
              10 old-prm-escludi-tutto            PIC  9.
                 88 old-prm-escludi-tutto-si VALUE IS 1. 
                 88 old-prm-escludi-tutto-no VALUE IS 0. 
              10 old-prm-tab-depositi.
                 15 old-prm-mag-codice   PIC  x(3)
                              OCCURS 50 TIMES.
                   15 old-prm-mag-ev-intera            PIC  X
                              OCCURS 50 TIMES.
                       88 old-prm-mag-ev-intera-si VALUE IS "S". 
                       88 old-prm-mag-ev-intera-no VALUE IS "N" " ". 
              10 old-prm-imb-minimo            PIC  9.
                 88 old-prm-imb-minimo-si VALUE IS 0. 
                 88 old-prm-imb-minimo-no VALUE IS 1. 
              10 old-prm-cod-art-forn            PIC  9.
                 88 old-prm-cod-art-forn-si VALUE IS 0. 
                 88 old-prm-cod-art-forn-no VALUE IS 1. 
              10 old-prm-vet-minore-kg1            PIC  9(5).
              10 old-prm-minore-kg1    PIC  9(5)v9(3).     
               10 FILLER           PIC  x(85).
              10 old-prm-dati-comuni.
                 15 old-prm-data-creazione           PIC  9(8).
                 15 old-prm-ora-creazione            PIC  9(8).
                 15 old-prm-utente-creazione         PIC  x(10).
                 15 old-prm-data-modifica            PIC  9(8).
                 15 old-prm-ora-modifica PIC  9(8).
                 15 old-prm-utente-modifica          PIC  x(10).
              10 old-prm-vuoti.   
                   15 old-prm-add-piombo.
                       20 old-prm-add-piombo-perce         PIC  9.
                           88 old-prm-add-piombo-perce-si VALUE IS 1. 
                           88 old-prm-add-piombo-perce-no VALUE IS 0.  
                       20 old-prm-add-piombo-ampere        PIC  9.
                           88 old-prm-add-piombo-ampere-si VALUE IS 1. 
                           88 old-prm-add-piombo-ampere-no VALUE IS 0. 
                       20 old-prm-add-piombo-bosch        PIC  9.
                           88 old-prm-add-piombo-bosch-si VALUE IS 1. 
                           88 old-prm-add-piombo-bosch-no VALUE IS 0.
                   15 old-prm-layout-pers       PIC  9.     
                   15 old-prm-sost-batt    PIC  9.
                       88 old-prm-sost-batt-si VALUE IS 1. 
                       88 old-prm-sost-batt-no VALUE IS 0. 
                   15 old-prm-num-vuoto-2  PIC  9(13).
                   15 old-prm-num-vuoto-3  PIC  9(18).
                   15 old-prm-stampante    PIC  x(100).
                   15 old-prm-path-logo    pic  x(200).
                   15 old-prm-alfa-vuoto   PIC  x(200).
                   15 old-prm-num-vuoto-1  PIC  9(18). 
                   
       01 como-prm-rec.
           05 como-prm-chiave.
               10 como-prm-lubex        PIC  x(2).
               10 como-prm-tipocli      PIC  x(2).
               10 como-prm-gdo          PIC  x(5).
               10 como-prm-cliente      PIC  9(5).
               10 como-prm-destino      PIC  9(5).
           05 como-prm-dati.
               10 como-prm-gestisci     PIC  9.
                   88 como-prm-gestisci-si VALUE IS 1. 
                   88 como-prm-gestisci-no VALUE IS 0. 
               10 como-prm-gg-inizio-vol            PIC  9(3).
               10 como-prm-gg-parziale  PIC  9(3).
               10 como-prm-gg-per-cons  PIC  9(3).
               10 como-prm-gg-val-vol   PIC  9(3).
               10 como-prm-gg-cons-max  PIC  9(3).
               10 como-prm-vet-maggiore-kg          PIC  9(5).
               10 como-prm-maggiore-kg  PIC  9(5)v9(3).
               10 como-prm-vet-minore-kg2           PIC  9(5).
               10 como-prm-minore-kg2   PIC  9(5)v9(3).
               10 como-prm-blocco-kg    PIC  9(5)v999.
               10 como-prm-prenotazione-qta         PIC  9.
                   88 como-prm-prenotazione-qta-si VALUE IS 1. 
                   88 como-prm-prenotazione-qta-no VALUE IS 0. 
               10 como-prm-accorpa      PIC  9.
                   88 como-prm-accorpa-si VALUE IS 1. 
                   88 como-prm-accorpa-no VALUE IS 0. 
               10 como-prm-saldi-banco  PIC  9.
                   88 como-prm-saldi-banco-si VALUE IS 1. 
                   88 como-prm-saldi-banco-no VALUE IS 0. 
               10 como-prm-saldi-promo  PIC  9.
                   88 como-prm-saldi-promo-si VALUE IS 1. 
                   88 como-prm-saldi-promo-no VALUE IS 0. 
               10 como-prm-escludi-tutto            PIC  9.
                   88 como-prm-escludi-tutto-si VALUE IS 1. 
                   88 como-prm-escludi-tutto-no VALUE IS 0. 
               10 como-prm-tab-depositi.
                   15 como-prm-mag-codice   PIC  x(3)
                              OCCURS 50 TIMES.
                   15 como-prm-mag-ev-intera            PIC  x
                              OCCURS 50 TIMES.
                       88 como-prm-mag-ev-intera-si VALUE IS "S". 
                       88 como-prm-mag-ev-intera-no VALUE IS "N" " ". 
               10 como-prm-imb-minimo   PIC  9.
                   88 como-prm-imb-minimo-si VALUE IS 1. 
                   88 como-prm-imb-minimo-no VALUE IS 0. 
               10 como-prm-cod-art-forn PIC  9.
                   88 como-prm-cod-art-forn-si VALUE IS 1. 
                   88 como-prm-cod-art-forn-no VALUE IS 0. 
               10 como-prm-vet-minore-kg1           PIC  9(5).
               10 como-prm-minore-kg1   PIC  9(5)v9(3).         
               10 FILLER           PIC  x(85).
               10 como-prm-dati-comuni.
                   15 como-prm-data-creazione           PIC  9(8).
                   15 como-prm-ora-creazione            PIC  9(8).
                   15 como-prm-utente-creazione         PIC  x(10).
                   15 como-prm-data-modifica            PIC  9(8).
                   15 como-prm-ora-modifica PIC  9(8).
                   15 como-prm-utente-modifica          PIC  x(10).
               10 como-prm-vuoti.
                   15 como-prm-add-piombo.
                       20 como-prm-add-piombo-perce         PIC  9.
                           88 como-prm-add-piombo-perce-si VALUE IS 1. 
                           88 como-prm-add-piombo-perce-no VALUE IS 0. 
                       20 como-prm-add-piombo-ampere        PIC  9.
                           88 como-prm-add-piombo-ampere-si VALUE IS 1. 
                           88 como-prm-add-piombo-ampere-no VALUE IS 0. 
                       20 como-prm-add-piombo-bosch         PIC  9.
                           88 como-prm-add-piombo-bosch-si VALUE IS 1. 
                           88 como-prm-add-piombo-bosch-no VALUE IS 0. 
                   15 como-prm-layout-pers  PIC  9.
                       88 como-prm-layout-pers-si VALUE IS 1. 
                       88 como-prm-layout-pers-no VALUE IS 0.  
                   15 como-prm-sost-batt    PIC  9.
                       88 como-prm-sost-batt-si VALUE IS 1. 
                       88 como-prm-sost-batt-no VALUE IS 0. 
                   15 como-prm-num-vuoto-2  PIC  9(13).
                   15 como-prm-num-vuoto-3  PIC  9(18).
                   15 como-prm-stampante    PIC  x(100).
                   15 como-prm-path-logo    PIC  x(200).
                   15 como-prm-alfa-vuoto   PIC  x(200).
                   15 como-prm-num-vuoto-1  PIC  9(18).

       01  tipo-param     pic 9.
           88 param-lubex value 1.
           88 tipo-cli    value 2.
           88 gruppo-gdo  value 3.
           88 cliente     value 4.
           88 destino     value 5.
       01  atipo-param     pic 9.
           88 aparam-lubex value 1.
           88 atipo-cli    value 2.
           88 agruppo-gdo  value 3.
           88 acliente     value 4.
           88 adestino     value 5.

       01                 pic 9.
           88 rec-cambiato   value 1 false zero.

       01                 pic 9.
           88 gestiti   value 1 false zero.

       01                 pic 9.
           88 modificato  value 1 false zero.

       01                       pic 9.
           88 si-gg-inizio-vol  value 1 false zero.
           
       01                       pic 9.
           88 gest-disabilita  value 1 false zero.
           
       77  messaggio      pic x(200).
      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-ef-ini-vol VALUE 5001.
       78  78-ID-ef-parz VALUE 5002.
       78  78-ID-ef-gg-cons VALUE 5003.
       78  78-ID-ef-val VALUE 5004.
       78  78-ID-ef-cons-max VALUE 5005.
       78  78-ID-ef-blocco-kg VALUE 5006.
       78  78-ID-ef-min-kg1 VALUE 5007.
       78  78-ID-ef-min-vet1 VALUE 5008.
       78  78-ID-ef-min-kg2 VALUE 5009.
       78  78-ID-ef-min-vet2 VALUE 5010.
       78  78-ID-ef-max-kg VALUE 5011.
       78  78-ID-ef-max-vet VALUE 5012.
       78  78-ID-chk-accorpa VALUE 5013.
       78  78-ID-chk-promo VALUE 5014.
       78  78-ID-chk-prenot VALUE 5015.
       78  78-ID-chk-banco VALUE 5016.
       78  78-ID-chk-escludi VALUE 5017.
       78  78-ID-chk-imb-min VALUE 5018.
       78  78-ID-chk-art-forn VALUE 5019.
       78  78-ID-chk-pb-bosch VALUE 5020.
       78  78-ID-chk-pb-perce VALUE 5021.
       78  78-ID-chk-pb-amp VALUE 5022.
       78  78-ID-chk-sost-batt VALUE 5023.
       78  78-ID-gd-mag VALUE 5024.
       78  78-ID-ef-stampante VALUE 5025.
       78  78-ID-chk-layout-pers VALUE 5026.
       78  78-ID-ef-path-logo VALUE 5027.
       78  78-ID-chk-gestisci-1 VALUE 5028.
       78  78-ID-ef-ini-vol-1 VALUE 5029.
       78  78-ID-ef-parz-1 VALUE 5030.
       78  78-ID-ef-gg-cons-1 VALUE 5031.
       78  78-ID-ef-val-1 VALUE 5032.
       78  78-ID-ef-cons-max-1 VALUE 5033.
       78  78-ID-ef-blocco-kg-1 VALUE 5034.
       78  78-ID-ef-min-kg1-1 VALUE 5035.
       78  78-ID-ef-min-vet1-1 VALUE 5036.
       78  78-ID-ef-min-kg2-1 VALUE 5037.
       78  78-ID-ef-min-vet2-1 VALUE 5038.
       78  78-ID-ef-max-kg-1 VALUE 5039.
       78  78-ID-ef-max-vet-1 VALUE 5040.
       78  78-ID-chk-accorpa-1 VALUE 5041.
       78  78-ID-chk-promo-1 VALUE 5042.
       78  78-ID-chk-prenot-1 VALUE 5043.
       78  78-ID-chk-banco-1 VALUE 5044.
       78  78-ID-chk-escludi-1 VALUE 5045.
       78  78-ID-chk-imb-min-1 VALUE 5046.
       78  78-ID-chk-art-forn-1 VALUE 5047.
       78  78-ID-chk-pb-perce-1 VALUE 5048.
       78  78-ID-chk-pb-amp-1 VALUE 5049.
       78  78-ID-chk-sost-batt-1 VALUE 5050.
       78  78-ID-gd-mag-1 VALUE 5051.
       78  78-ID-ef-stampante-1 VALUE 5052.
       78  78-ID-chk-layout-pers-1 VALUE 5053.
       78  78-ID-ef-path-logo-1 VALUE 5054.
       78  78-ID-chk-gestisci-2 VALUE 5055.
       78  78-ID-ef-ini-vol-2 VALUE 5056.
       78  78-ID-ef-parz-2 VALUE 5057.
       78  78-ID-ef-gg-cons-2 VALUE 5058.
       78  78-ID-ef-val-2 VALUE 5059.
       78  78-ID-ef-cons-max-2 VALUE 5060.
       78  78-ID-ef-blocco-kg-2 VALUE 5061.
       78  78-ID-ef-min-kg1-2 VALUE 5062.
       78  78-ID-ef-min-vet1-2 VALUE 5063.
       78  78-ID-ef-min-kg2-2 VALUE 5064.
       78  78-ID-ef-min-vet2-2 VALUE 5065.
       78  78-ID-ef-max-kg-2 VALUE 5066.
       78  78-ID-ef-max-vet-2 VALUE 5067.
       78  78-ID-chk-accorpa-2 VALUE 5068.
       78  78-ID-chk-promo-2 VALUE 5069.
       78  78-ID-chk-prenot-2 VALUE 5070.
       78  78-ID-chk-banco-2 VALUE 5071.
       78  78-ID-chk-escludi-2 VALUE 5072.
       78  78-ID-chk-imb-min-2 VALUE 5073.
       78  78-ID-chk-art-forn-2 VALUE 5074.
       78  78-ID-chk-pb-perce-2 VALUE 5075.
       78  78-ID-chk-pb-amp-2 VALUE 5076.
       78  78-ID-chk-sost-batt-2 VALUE 5077.
       78  78-ID-gd-mag-2 VALUE 5078.
       78  78-ID-ef-stampante-2 VALUE 5079.
       78  78-ID-chk-gestisci-3 VALUE 5080.
       78  78-ID-ef-parz-3 VALUE 5081.
       78  78-ID-ef-gg-cons-3 VALUE 5082.
       78  78-ID-ef-val-3 VALUE 5083.
       78  78-ID-ef-cons-max-3 VALUE 5084.
       78  78-ID-ef-blocco-kg-3 VALUE 5085.
       78  78-ID-ef-min-kg1-3 VALUE 5086.
       78  78-ID-ef-min-vet1-3 VALUE 5087.
       78  78-ID-ef-min-kg2-3 VALUE 5088.
       78  78-ID-ef-min-vet2-3 VALUE 5089.
       78  78-ID-ef-max-kg-3 VALUE 5090.
       78  78-ID-ef-max-vet-3 VALUE 5091.
       78  78-ID-chk-accorpa-3 VALUE 5092.
       78  78-ID-chk-promo-3 VALUE 5093.
       78  78-ID-chk-prenot-3 VALUE 5094.
       78  78-ID-chk-banco-3 VALUE 5095.
       78  78-ID-chk-escludi-3 VALUE 5096.
       78  78-ID-chk-imb-min-3 VALUE 5097.
       78  78-ID-chk-art-forn-3 VALUE 5098.
       78  78-ID-chk-pb-perce-3 VALUE 5099.
       78  78-ID-chk-pb-amp-3 VALUE 5100.
       78  78-ID-chk-sost-batt-3 VALUE 5101.
       78  78-ID-gd-mag-3 VALUE 5102.
       78  78-ID-ef-stampante-3 VALUE 5103.
       78  78-ID-chk-layout-pers-3 VALUE 5104.
       78  78-ID-ef-path-logo-3 VALUE 5105.
       78  78-ID-chk-gestisci-4 VALUE 5106.
       78  78-ID-ef-parz-4 VALUE 5107.
       78  78-ID-ef-gg-cons-4 VALUE 5108.
       78  78-ID-ef-val-4 VALUE 5109.
       78  78-ID-ef-cons-max-4 VALUE 5110.
       78  78-ID-ef-blocco-kg-4 VALUE 5111.
       78  78-ID-ef-min-kg1-4 VALUE 5112.
       78  78-ID-ef-min-vet1-4 VALUE 5113.
       78  78-ID-ef-min-kg2-4 VALUE 5114.
       78  78-ID-ef-min-vet2-4 VALUE 5115.
       78  78-ID-ef-max-kg-4 VALUE 5116.
       78  78-ID-ef-max-vet-4 VALUE 5117.
       78  78-ID-chk-accorpa-4 VALUE 5118.
       78  78-ID-chk-promo-4 VALUE 5119.
       78  78-ID-chk-prenot-4 VALUE 5120.
       78  78-ID-chk-banco-4 VALUE 5121.
       78  78-ID-chk-escludi-4 VALUE 5122.
       78  78-ID-chk-imb-min-4 VALUE 5123.
       78  78-ID-chk-art-forn-4 VALUE 5124.
       78  78-ID-chk-pb-perce-4 VALUE 5125.
       78  78-ID-chk-pb-amp-4 VALUE 5126.
       78  78-ID-chk-sost-batt-4 VALUE 5127.
       78  78-ID-gd-mag-4 VALUE 5128.
       78  78-ID-ef-stampante-4 VALUE 5129.
       78  78-ID-chk-layout-pers-4 VALUE 5130.
       78  78-ID-ef-path-logo-4 VALUE 5131.
       78  78-ID-gd-tipocli VALUE 5132.
       78  78-ID-gd-clienti VALUE 5133.
       78  78-ID-gd-gdo VALUE 5134.
       78  78-ID-gd-destini VALUE 5135.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "COMMON-LINKAGE.DEF".
      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           HELP-ID 1,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           AFTER PROCEDURE  Form1-AFTER-SCREEN
           .

      * FRAME
       05
           frame-lbx, 
           Frame, 
           COL 2,00, 
           LINE 25,38,
           LINES 38,00 ,
           SIZE 40,33 ,
           ID IS 5,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Parametri Lubex",
           TITLE-POSITION 2,
           .

      * ENTRY FIELD
       05
           ef-ini-vol, 
           Entry-Field, 
           COL 26,83, 
           LINE 27,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ini-vol,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-ini-vol-buf,
           AFTER PROCEDURE ef-ini-vol-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-parz, 
           Entry-Field, 
           COL 26,83, 
           LINE 29,38,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-parz,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-parz-buf,
           AFTER PROCEDURE ef-parz-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg-cons, 
           Entry-Field, 
           COL 26,83, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-cons,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-gg-cons-buf,
           AFTER PROCEDURE ef-gg-cons-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-val, 
           Entry-Field, 
           COL 26,83, 
           LINE 32,38,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-val,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-val-buf,
           AFTER PROCEDURE ef-val-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-cons-max, 
           Entry-Field, 
           COL 26,83, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cons-max,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-cons-max-buf,
           AFTER PROCEDURE ef-cons-max-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-blocco-kg, 
           Entry-Field, 
           COL 20,83, 
           LINE 35,38,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-blocco-kg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-blocco-kg-buf,
           AFTER PROCEDURE ef-blocco-kg-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-kg1, 
           Entry-Field, 
           COL 15,50, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg1-buf,
           AFTER PROCEDURE ef-min-kg-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet1, 
           Entry-Field, 
           COL 25,83, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet1-buf,
           AFTER PROCEDURE ef-min-vet-30kg-AfterProcedure, 
           .


      * ENTRY FIELD
       05
           ef-min-kg2, 
           Entry-Field, 
           COL 15,50, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg2-buf,
           AFTER PROCEDURE ef-min-kg-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet2, 
           Entry-Field, 
           COL 25,83, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet2-buf,
           AFTER PROCEDURE ef-min-vet-AfterProcedure, 
           .


      * ENTRY FIELD
       05
           ef-max-kg, 
           Entry-Field, 
           COL 15,50, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-kg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-kg-buf,
           AFTER PROCEDURE ef-max-kg-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-max-vet, 
           Entry-Field, 
           COL 25,83, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-vet,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-vet-buf,
           AFTER PROCEDURE ef-max-vet-AfterProcedure, 
           .


      * CHECK BOX
       05
           chk-accorpa, 
           Check-Box, 
           COL 16,50, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-accorpa,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-accorpa-buf,
           AFTER PROCEDURE chk-accorpa-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-promo, 
           Check-Box, 
           COL 37,00, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-promo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-promo-buf,
           AFTER PROCEDURE chk-promo-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-prenot, 
           Check-Box, 
           COL 16,50, 
           LINE 42,61,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-prenot,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-prenot-buf,
           AFTER PROCEDURE chk-intera-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-banco, 
           Check-Box, 
           COL 37,00, 
           LINE 42,61,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-banco,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-banco-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-escludi, 
           Check-Box, 
           COL 16,50, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-escludi,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-escludi-buf,
           AFTER PROCEDURE chk-intera-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-imb-min, 
           Check-Box, 
           COL 37,00, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-imb-min,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-imb-min-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-art-forn, 
           Check-Box, 
           COL 16,50, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-art-forn,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-art-forn-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-bosch, 
           Check-Box, 
           COL 37,00, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1014
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-bosch,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-bosch-buf,
           AFTER PROCEDURE chk-pb-bosch-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-perce, 
           Check-Box, 
           COL 16,50, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1004
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-perce,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-perce-buf,
           AFTER PROCEDURE chk-pb-perce-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-amp, 
           Check-Box, 
           COL 37,00, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1005
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-amp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-amp-buf,
           AFTER PROCEDURE chk-pb-amp-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-sost-batt, 
           Check-Box, 
           COL 16,50, 
           LINE 48,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-sost-batt,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-sost-batt-buf,
           AFTER PROCEDURE chk-sost-batt-AfterProcedure,
           .
      * GRID
       05
           gd-mag, 
           Grid, 
           COL 3,00, 
           LINE 50,07,
           LINES 5,92 ,
           SIZE 38,17 ,
           BOXED,
           DATA-COLUMNS (1, 4, 104),
           ALIGNMENT ("U", "U", "C"),
           SEPARATION (5, 5, 5),
           DATA-TYPES ("U(3)", "X(100)", "U(1)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-mag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 35,
           VPADDING 10,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * LABEL
       05
           Screen1-La-1, 
           Label, 
           COL 3,17, 
           LINE 27,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG inizio volantino",
           .

      * LABEL
       05
           Screen1-La-1a, 
           Label, 
           COL 3,17, 
           LINE 29,38,
           LINES 1,31 ,
           SIZE 21,00 ,
           FONT IS Small-Font,
           ID IS 26,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG evas. parziale (forzata)",
           .

      * LABEL
       05
           Screen1-La-1aa, 
           Label, 
           COL 3,17, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG per consegna",
           .

      * LABEL
       05
           Screen1-La-1aaa, 
           Label, 
           COL 3,17, 
           LINE 32,38,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 28,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG validità volantino",
           .

      * LABEL
       05
           Screen1-La-1aaaa, 
           Label, 
           COL 3,17, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 29,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG consegna MAX",
           .

      * LABEL
       05
           Screen1-La-1aaaaa, 
           Label, 
           COL 3,17, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           Screen1-La-1aaaaaa, 
           Label, 
           COL 3,17, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 31,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore > Kg",
           .

      * LABEL
       05
           Screen1-La-2, 
           Label, 
           COL 3,17, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 32,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Accorpamento",
           .

      * LABEL
       05
           Screen1-La-2a, 
           Label, 
           COL 3,17, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 33,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prenotaz. qta",
           .

      * LABEL
       05
           Screen1-La-2b, 
           Label, 
           COL 22,50, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi PROMO",
           .

      * LABEL
       05
           Screen1-La-2aa, 
           Label, 
           COL 22,50, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 35,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi BANCO",
           .

      * LABEL
       05
           lab-vet-min2, 
           Label, 
           COL 32,83, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 36,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min2-buf,
           .

      * LABEL
       05
           lab-vet-max, 
           Label, 
           COL 32,83, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 37,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-max-buf,
           .

      * LABEL
       05
           Screen1-La-1aaaaaab, 
           Label, 
           COL 3,17, 
           LINE 35,38,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 38,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Blocco Kg",
           .

      * LABEL
       05
           Screen1-La-2ac, 
           Label, 
           COL 3,17, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 39,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "NO evadi tutto",
           .

      * LABEL
       05
           Screen1-La-2aab, 
           Label, 
           COL 22,50, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 44,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imb. minimo",
           .

      * LABEL
       05
           Screen1-La-2aabe, 
           Label, 
           COL 3,17, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. art forn.",
           .

      * LABEL
       05
           Screen1-La-2aabee, 
           Label, 
           COL 3,17, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. PB %",
           .

      * LABEL
       05
           Screen1-La-2aabf, 
           Label, 
           COL 22,50, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 47,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb amp.",
           .

      * LABEL
       05
           Screen1-La-2aabfb, 
           Label, 
           COL 22,50, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 48,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb BOSCH",
           .

      * LABEL
       05
           Screen1-La-2d, 
           Label, 
           COL 3,17, 
           LINE 56,15,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 49,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sampante",
           .

      * ENTRY FIELD
       05
           ef-stampante, 
           Entry-Field, 
           COL 3,00, 
           LINE 57,61,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-stampante,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-stampante-buf,
           AFTER PROCEDURE ef-max-kg-AfterProcedure, 
           BEFORE PROCEDURE ef-max-kg-BeforeProcedure, 
           .

      * CHECK BOX
       05
           chk-layout-pers, 
           Check-Box, 
           COL 21,50, 
           LINE 59,38,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-layout-pers,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-layout-pers-buf,
           AFTER PROCEDURE chk-pb-perce-AfterProcedure,
           .
      * PUSH BUTTON
       05
           pb-path-logo, 
           Push-Button, 
           COL 38,33, 
           LINE 59,76,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED mod,
           EXCEPTION-VALUE 3001,
           FONT IS Small-Font,
           ID IS AUTO-ID,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       05
           ef-path-logo, 
           Entry-Field, 
           COL 3,00, 
           LINE 61,07,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-logo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-path-logo-buf,
           AFTER PROCEDURE ef-path-logo-AfterProcedure, 
           .

      * PUSH BUTTON
       05
           pb-stampanti, 
           Push-Button, 
           COL 38,33, 
           LINE 56,38,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED mod,
           EXCEPTION-VALUE 1019,
           FONT IS Small-Font,
           ID IS 236,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * LABEL
       05
           Screen1-La-1aaaaac, 
           Label, 
           COL 3,17, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 237,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           lab-vet-min1, 
           Label, 
           COL 32,83, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 238,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min1-buf,
           .

      * LABEL
       05
           Screen1-La-2aabeeb, 
           Label, 
           COL 3,17, 
           LINE 59,38,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 239,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Logo personalizzato",
           .

      * LABEL
       05
           Screen1-La-2aabeec, 
           Label, 
           COL 3,17, 
           LINE 48,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sost. batterie",
           .

      * FRAME
       05
           frame-1, 
           Frame, 
           COL 43,17, 
           LINE 25,38,
           LINES 38,00 ,
           SIZE 40,33 ,
           ID IS 240,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE-POSITION 2,
           .

      * CHECK BOX
       05
           chk-gestisci-1, 
           Check-Box, 
           COL 66,50, 
           LINE 25,92,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-tipocli,
           EXCEPTION-VALUE 1000
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-gestisci-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-gestisci-1-buf,
           AFTER PROCEDURE chk-gestisci-1-AfterProcedure,
           BEFORE PROCEDURE chk-gestisci-1-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-ini-vol-1, 
           Entry-Field, 
           COL 68,00, 
           LINE 27,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ini-vol-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-ini-vol-1-buf,
           VISIBLE v-gdo,
           AFTER PROCEDURE ef-ini-vol-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-parz-1, 
           Entry-Field, 
           COL 68,00, 
           LINE 29,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-parz-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-parz-1-buf,
           AFTER PROCEDURE ef-parz-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg-cons-1, 
           Entry-Field, 
           COL 68,00, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-cons-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-gg-cons-1-buf,
           AFTER PROCEDURE ef-gg-cons-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-val-1, 
           Entry-Field, 
           COL 68,00, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-val-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-val-1-buf,
           AFTER PROCEDURE ef-val-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-cons-max-1, 
           Entry-Field, 
           COL 68,00, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cons-max-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-cons-max-1-buf,
           AFTER PROCEDURE ef-cons-max-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-blocco-kg-1, 
           Entry-Field, 
           COL 62,00, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-blocco-kg-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-blocco-kg-1-buf,
           AFTER PROCEDURE ef-blocco-kg-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-kg1-1, 
           Entry-Field, 
           COL 56,67, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg1-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg1-1-buf,
           AFTER PROCEDURE ef-min-kg-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet1-1, 
           Entry-Field, 
           COL 67,00, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet1-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet1-1-buf,
           AFTER PROCEDURE ef-min-vet-30kg-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-kg2-1, 
           Entry-Field, 
           COL 56,67, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg2-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg2-1-buf,
           AFTER PROCEDURE ef-min-kg-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet2-1, 
           Entry-Field, 
           COL 67,00, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet2-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet2-1-buf,
           AFTER PROCEDURE ef-min-vet-1-AfterProcedure, 
           .


      * ENTRY FIELD
       05
           ef-max-kg-1, 
           Entry-Field, 
           COL 56,67, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-kg-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-kg-1-buf,
           AFTER PROCEDURE ef-max-kg-1-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-max-vet-1, 
           Entry-Field, 
           COL 67,00, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-vet-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-vet-1-buf,
           AFTER PROCEDURE ef-max-vet-1-AfterProcedure, 
           .


      * CHECK BOX
       05
           chk-accorpa-1, 
           Check-Box, 
           COL 57,67, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-tipocli-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-accorpa-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-accorpa-1-buf,
           AFTER PROCEDURE chk-accorpa-1-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-promo-1, 
           Check-Box, 
           COL 79,84, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-tipocli-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-promo-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-promo-1-buf,
           AFTER PROCEDURE chk-promoa-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-prenot-1, 
           Check-Box, 
           COL 57,67, 
           LINE 42,61,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-tipocli-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-prenot-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-prenot-1-buf,
           AFTER PROCEDURE chk-intera-1-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-banco-1, 
           Check-Box, 
           COL 79,84, 
           LINE 42,61,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-tipocli-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-banco-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-banco-1-buf,
           AFTER PROCEDURE chk-banco-1-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-escludi-1, 
           Check-Box, 
           COL 57,67, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED e-tipocli-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-escludi-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-escludi-1-buf,
           AFTER PROCEDURE chk-intera-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-imb-min-1, 
           Check-Box, 
           COL 79,84, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-imb-min-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-imb-min-1-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-art-forn-1, 
           Check-Box, 
           COL 57,67, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-art-forn-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-art-forn-1-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-bosch-1, 
           Check-Box, 
           COL 79,84, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1015
           FLAT,
           FONT IS Small-Font,
           ID IS 80,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-bosch-1-buf,
           AFTER PROCEDURE chk-pb-bosch-1-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-perce-1, 
           Check-Box, 
           COL 57,67, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1010
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-perce-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-perce-1-buf,
           AFTER PROCEDURE chk-pb-perce-1-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-amp-1, 
           Check-Box, 
           COL 79,84, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1006
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-amp-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-amp-1-buf,
           AFTER PROCEDURE chk-pb-amp-1-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-sost-batt-1, 
           Check-Box, 
           COL 57,67, 
           LINE 48,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-sost-batt-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-sost-batt-1-buf,
           AFTER PROCEDURE chk-sost-batt-1-AfterProcedure,
           .
      * GRID
       05
           gd-mag-1, 
           Grid, 
           COL 44,17, 
           LINE 50,07,
           LINES 5,92 ,
           SIZE 38,17 ,
           BOXED,
           DATA-COLUMNS (1, 4, 104),
           ALIGNMENT ("U", "U", "C"),
           SEPARATION (5, 5, 5),
           DATA-TYPES ("U(3)", "X(100)", "U(1)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-mag-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 35,
           VPADDING 10,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * LABEL
       05
           Screen1-La-1b, 
           Label, 
           COL 44,34, 
           LINE 27,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 83,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG inizio volantino",
           VISIBLE v-gdo,
           .

      * LABEL
       05
           Screen1-La-1ab, 
           Label, 
           COL 44,34, 
           LINE 29,46,
           LINES 1,31 ,
           SIZE 21,00 ,
           FONT IS Small-Font,
           ID IS 84,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG evas. parziale (forzata)",
           .

      * LABEL
       05
           Screen1-La-1aab, 
           Label, 
           COL 44,34, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 85,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG per consegna",
           .

      * LABEL
       05
           Screen1-La-1aaab, 
           Label, 
           COL 44,34, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 86,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG validità volantino",
           .

      * LABEL
       05
           Screen1-La-1aaaab, 
           Label, 
           COL 44,34, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 87,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG consegna MAX",
           .

      * LABEL
       05
           Screen1-La-1aaaaab, 
           Label, 
           COL 44,34, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 88,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           Screen1-La-1aaaaaaa, 
           Label, 
           COL 44,34, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 89,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore > Kg",
           .

      * LABEL
       05
           Screen1-La-2c, 
           Label, 
           COL 44,34, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 67,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Accorpamento",
           .

      * LABEL
       05
           Screen1-La-2ab, 
           Label, 
           COL 44,34, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 68,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prenotaz. qta",
           .

      * LABEL
       05
           Screen1-La-2ba, 
           Label, 
           COL 63,67, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 69,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi PROMO",
           .

      * LABEL
       05
           Screen1-La-2aaa, 
           Label, 
           COL 63,67, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 70,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi BANCO",
           .

      * LABEL
       05
           lab-vet-min2-1, 
           Label, 
           COL 74,17, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 71,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min2-1-buf,
           .

      * LABEL
       05
           lab-vet-max-1, 
           Label, 
           COL 74,17, 
           LINE 40,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 72,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-max-1-buf,
           .

      * LABEL
       05
           Screen1-La-1aaaaaaba, 
           Label, 
           COL 44,34, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 73,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Blocco Kg",
           .

      * LABEL
       05
           Screen1-La-3, 
           Label, 
           COL 54,67, 
           LINE 26,23,
           LINES 1,31 ,
           SIZE 11,00 ,
           COLOR IS 5,
           FONT IS Large-Font,
           ID IS 74,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "GESTISCI",
           .

      * LABEL
       05
           Screen1-La-2aca, 
           Label, 
           COL 44,34, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 75,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "NO evadi tutto",
           .

      * LABEL
       05
           Screen1-La-2aaba, 
           Label, 
           COL 63,67, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 76,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imb. minimo",
           .

      * LABEL
       05
           Screen1-La-2aabea, 
           Label, 
           COL 44,34, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 77,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. art forn.",
           .

      * LABEL
       05
           Screen1-La-2aabfa, 
           Label, 
           COL 63,67, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 90,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb amp.",
           .

      * LABEL
       05
           Screen1-La-2aabeea, 
           Label, 
           COL 44,34, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 91,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. PB %",
           .

      * LABEL
       05
           Screen1-La-2aabfab, 
           Label, 
           COL 63,67, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 92,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb BOSCH",
           .

      * LABEL
       05
           Screen1-La-2da, 
           Label, 
           COL 44,34, 
           LINE 56,15,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 93,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sampante",
           .

      * ENTRY FIELD
       05
           ef-stampante-1, 
           Entry-Field, 
           COL 44,17, 
           LINE 57,61,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-stampante-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-stampante-1-buf,
           AFTER PROCEDURE ef-max-kg-AfterProcedure, 
           BEFORE PROCEDURE ef-max-kg-BeforeProcedure, 
           .

      * CHECK BOX
       05
           chk-layout-pers-1, 
           Check-Box, 
           COL 62,67, 
           LINE 59,38,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED e-tipocli-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-layout-pers-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-layout-pers-1-buf,
           AFTER PROCEDURE chk-pb-perce-AfterProcedure,
           .
      * PUSH BUTTON
       05
           pb-path-logo-1, 
           Push-Button, 
           COL 79,50, 
           LINE 59,76,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED e-tipocli-dati,
           EXCEPTION-VALUE 1024,
           FONT IS Small-Font,
           ID IS AUTO-ID,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       05
           ef-path-logo-1, 
           Entry-Field, 
           COL 44,17, 
           LINE 61,07,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-tipocli-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-logo-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-path-logo-1-buf,
           AFTER PROCEDURE ef-path-logoa-AfterProcedure, 
           .

      * PUSH BUTTON
       05
           pb-stampanti-1, 
           Push-Button, 
           COL 79,50, 
           LINE 56,38,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED e-tipocli-dati,
           EXCEPTION-VALUE 1020,
           FONT IS Small-Font,
           ID IS 98,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * LABEL
       05
           Screen1-La-1aaaaaca, 
           Label, 
           COL 44,34, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 99,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           lab-vet-min1-1, 
           Label, 
           COL 74,00, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 100,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min1-1-buf,
           .

      * LABEL
       05
           Screen1-La-2aabeeba, 
           Label, 
           COL 44,34, 
           LINE 59,38,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 101,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Logo personalizzato",
           .

      * LABEL
       05
           Screen1-La-2aabeeca, 
           Label, 
           COL 44,34, 
           LINE 48,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sost. batterie",
           .

      * FRAME
       05
           frame-2, 
           Frame, 
           COL 84,50, 
           LINE 25,38,
           LINES 38,00 ,
           SIZE 40,33 ,
           ID IS 102,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE-POSITION 2,
           .

      * CHECK BOX
       05
           chk-gestisci-2, 
           Check-Box, 
           COL 108,17, 
           LINE 25,92,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-gdo,
           EXCEPTION-VALUE 1001
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-gestisci-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-gestisci-2-buf,
           AFTER PROCEDURE chk-gestisci-2-AfterProcedure,
           BEFORE PROCEDURE chk-gestisci-2-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-ini-vol-2, 
           Entry-Field, 
           COL 109,33, 
           LINE 27,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ini-vol-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-ini-vol-2-buf,
           AFTER PROCEDURE ef-ini-vol-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-parz-2, 
           Entry-Field, 
           COL 109,33, 
           LINE 29,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-parz-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-parz-2-buf,
           AFTER PROCEDURE ef-parz-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg-cons-2, 
           Entry-Field, 
           COL 109,33, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-cons-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-gg-cons-2-buf,
           AFTER PROCEDURE ef-gg-cons-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-val-2, 
           Entry-Field, 
           COL 109,33, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-val-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-val-2-buf,
           AFTER PROCEDURE ef-val-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-cons-max-2, 
           Entry-Field, 
           COL 109,33, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cons-max-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-cons-max-2-buf,
           AFTER PROCEDURE ef-cons-max-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-blocco-kg-2, 
           Entry-Field, 
           COL 103,33, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-blocco-kg-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-blocco-kg-2-buf,
           AFTER PROCEDURE ef-blocco-kg-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-kg1-2, 
           Entry-Field, 
           COL 98,00, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg1-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg1-2-buf,
           AFTER PROCEDURE ef-min-kg-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet1-2, 
           Entry-Field, 
           COL 108,33, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet1-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet1-2-buf,
           AFTER PROCEDURE ef-min-vet-30kg-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-kg2-2, 
           Entry-Field, 
           COL 98,00, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg2-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg2-2-buf,
           AFTER PROCEDURE ef-min-kg-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet2-2, 
           Entry-Field, 
           COL 108,33, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet2-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet2-2-buf,
           AFTER PROCEDURE ef-min-vet-2-AfterProcedure, 
           .


      * ENTRY FIELD
       05
           ef-max-kg-2, 
           Entry-Field, 
           COL 98,00, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-kg-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-kg-2-buf,
           AFTER PROCEDURE ef-max-kg-2-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-max-vet-2, 
           Entry-Field, 
           COL 108,33, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-vet-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-vet-2-buf,
           AFTER PROCEDURE ef-max-vet-2-AfterProcedure, 
           .


      * CHECK BOX
       05
           chk-accorpa-2, 
           Check-Box, 
           COL 99,00, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-gdo-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-accorpa-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-accorpa-2-buf,
           AFTER PROCEDURE chk-accorpa-2-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-promo-2, 
           Check-Box, 
           COL 121,17, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-gdo-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-promo-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-promo-2-buf,
           AFTER PROCEDURE chk-promo-2-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-prenot-2, 
           Check-Box, 
           COL 99,00, 
           LINE 42,61,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-gdo-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-prenot-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-prenot-2-buf,
           AFTER PROCEDURE chk-intera-2-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-banco-2, 
           Check-Box, 
           COL 121,17, 
           LINE 42,61,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-gdo-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-banco-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-banco-2-buf,
           AFTER PROCEDURE chk-banco-2-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-escludi-2, 
           Check-Box, 
           COL 99,00, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED e-gdo-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-escludi-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-escludi-2-buf,
           AFTER PROCEDURE chk-intera-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-imb-min-2, 
           Check-Box, 
           COL 121,17, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-imb-min-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-imb-min-2-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-art-forn-2, 
           Check-Box, 
           COL 99,00, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-art-forn-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-art-forn-2-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-bosch-2, 
           Check-Box, 
           COL 121,17, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1016
           FLAT,
           FONT IS Small-Font,
           ID IS 123,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-bosch-2-buf,
           AFTER PROCEDURE chk-pb-bosch-2-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-perce-2, 
           Check-Box, 
           COL 99,00, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1011
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-perce-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-perce-2-buf,
           AFTER PROCEDURE chk-pb-perce-2-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-amp-2, 
           Check-Box, 
           COL 121,17, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1007
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-amp-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-amp-2-buf,
           AFTER PROCEDURE chk-pb-amp-2-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-sost-batt-2, 
           Check-Box, 
           COL 99,00, 
           LINE 48,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-sost-batt-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-sost-batt-2-buf,
           AFTER PROCEDURE chk-sost-batt-2-AfterProcedure,
           .
      * GRID
       05
           gd-mag-2, 
           Grid, 
           COL 85,50, 
           LINE 50,07,
           LINES 5,92 ,
           SIZE 38,17 ,
           BOXED,
           DATA-COLUMNS (1, 4, 104),
           ALIGNMENT ("U", "U", "C"),
           SEPARATION (5, 5, 5),
           DATA-TYPES ("U(3)", "X(100)", "U(1)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-mag-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 35,
           VPADDING 10,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * LABEL
       05
           Screen1-La-1ba, 
           Label, 
           COL 85,67, 
           LINE 27,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 126,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG inizio volantino",
           .

      * LABEL
       05
           Screen1-La-1aba, 
           Label, 
           COL 85,67, 
           LINE 29,46,
           LINES 1,31 ,
           SIZE 21,00 ,
           FONT IS Small-Font,
           ID IS 127,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG evas. parziale (forzata)",
           .

      * LABEL
       05
           Screen1-La-1aaba, 
           Label, 
           COL 85,67, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 128,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG per consegna",
           .

      * LABEL
       05
           Screen1-La-1aaaba, 
           Label, 
           COL 85,67, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 129,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG validità volantino",
           .

      * LABEL
       05
           Screen1-La-1aaaaba, 
           Label, 
           COL 85,67, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 131,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG consegna MAX",
           .

      * LABEL
       05
           Screen1-La-1aaaaaba, 
           Label, 
           COL 85,67, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 132,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           Screen1-La-1aaaaaaaa, 
           Label, 
           COL 85,67, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 133,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore > Kg",
           .

      * LABEL
       05
           Screen1-La-2ca, 
           Label, 
           COL 85,67, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 134,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Accorpamento",
           .

      * LABEL
       05
           Screen1-La-2aba, 
           Label, 
           COL 85,67, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 135,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prenotaz. qta",
           .

      * LABEL
       05
           Screen1-La-2baa, 
           Label, 
           COL 104,83, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 136,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi PROMO",
           .

      * LABEL
       05
           Screen1-La-2aaaa, 
           Label, 
           COL 105,00, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 137,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi BANCO",
           .

      * LABEL
       05
           lab-vet-min2-2, 
           Label, 
           COL 115,50, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 138,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min2-2-buf,
           .

      * LABEL
       05
           lab-vet-max-2, 
           Label, 
           COL 115,50, 
           LINE 40,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 139,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-max-2-buf,
           .

      * LABEL
       05
           Screen1-La-1aaaaaabaa, 
           Label, 
           COL 85,67, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 140,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Blocco Kg",
           .

      * LABEL
       05
           Screen1-La-3a, 
           Label, 
           COL 96,00, 
           LINE 26,23,
           LINES 1,31 ,
           SIZE 11,00 ,
           COLOR IS 5,
           FONT IS Large-Font,
           ID IS 141,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "GESTISCI",
           .

      * LABEL
       05
           Screen1-La-2acaa, 
           Label, 
           COL 85,67, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 142,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "NO evadi tutto",
           .

      * LABEL
       05
           Screen1-La-2aabb, 
           Label, 
           COL 105,00, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 143,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imb. minimo",
           .

      * LABEL
       05
           Screen1-La-2aabeb, 
           Label, 
           COL 85,67, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 144,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. art forn.",
           .

      * LABEL
       05
           Screen1-La-2aabeeaa, 
           Label, 
           COL 85,67, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 145,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. PB %",
           .

      * LABEL
       05
           Screen1-La-2aabfaa, 
           Label, 
           COL 105,00, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 146,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb amp.",
           .

      * LABEL
       05
           Screen1-La-2aabfaab, 
           Label, 
           COL 105,00, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 147,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb BOSCH",
           .

      * LABEL
       05
           Screen1-La-2db, 
           Label, 
           COL 85,67, 
           LINE 56,15,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 148,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sampante",
           .

      * ENTRY FIELD
       05
           ef-stampante-2, 
           Entry-Field, 
           COL 85,50, 
           LINE 57,61,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-stampante-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-stampante-2-buf,
           AFTER PROCEDURE ef-max-kg-AfterProcedure, 
           BEFORE PROCEDURE ef-max-kg-BeforeProcedure, 
           .

      * CHECK BOX
       05
           chk-layout-pers-2, 
           Check-Box, 
           COL 104,00, 
           LINE 59,38,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED e-gdo-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 150,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-layout-pers-2-buf,
           AFTER PROCEDURE chk-pb-perce-AfterProcedure,
           .
      * PUSH BUTTON
       05
           pb-path-logo-2, 
           Push-Button, 
           COL 120,83, 
           LINE 59,76,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED e-gdo-dati,
           EXCEPTION-VALUE 1025,
           FONT IS Small-Font,
           ID IS 151,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       05
           ef-path-logo-2, 
           Entry-Field, 
           COL 85,50, 
           LINE 61,07,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gdo-dati,
           FONT IS Small-Font,
           ID IS 152,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-path-logo-2-buf,
           AFTER PROCEDURE ef-path-logoa-AfterProcedure, 
           .

      * PUSH BUTTON
       05
           pb-stampanti-2, 
           Push-Button, 
           COL 120,83, 
           LINE 56,38,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED e-gdo-dati,
           EXCEPTION-VALUE 1021,
           FONT IS Small-Font,
           ID IS 153,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * LABEL
       05
           Screen1-La-1aaaaacb, 
           Label, 
           COL 85,67, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 154,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           lab-vet-min1-2, 
           Label, 
           COL 115,33, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 155,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min1-2-buf,
           .

      * LABEL
       05
           Screen1-La-2aabeebaa, 
           Label, 
           COL 85,67, 
           LINE 59,38,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 156,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Logo personalizzato",
           .

      * LABEL
       05
           Screen1-La-2aabeecaa, 
           Label, 
           COL 85,67, 
           LINE 48,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sost. batterie",
           .

      * FRAME
       05
           frame-3, 
           Frame, 
           COL 126,00, 
           LINE 25,38,
           LINES 38,00 ,
           SIZE 40,33 ,
           ID IS 157,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE-POSITION 2,
           .

      * CHECK BOX
       05
           chk-gestisci-3, 
           Check-Box, 
           COL 149,67, 
           LINE 25,92,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-clienti,
           EXCEPTION-VALUE 1002
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-gestisci-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-gestisci-3-buf,
           AFTER PROCEDURE chk-gestisci-3-AfterProcedure,
           BEFORE PROCEDURE chk-gestisci-3-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-parz-3, 
           Entry-Field, 
           COL 150,83, 
           LINE 29,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-parz-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-parz-3-buf,
           AFTER PROCEDURE ef-parz-3-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg-cons-3, 
           Entry-Field, 
           COL 150,83, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-cons-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-gg-cons-3-buf,
           AFTER PROCEDURE ef-gg-cons-3-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-val-3, 
           Entry-Field, 
           COL 150,83, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-val-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-val-3-buf,
           AFTER PROCEDURE ef-val-3-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-cons-max-3, 
           Entry-Field, 
           COL 150,83, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cons-max-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-cons-max-3-buf,
           AFTER PROCEDURE ef-cons-max-3-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-blocco-kg-3, 
           Entry-Field, 
           COL 144,83, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-blocco-kg-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-blocco-kg-3-buf,
           AFTER PROCEDURE ef-blocco-kg-3-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-kg1-3, 
           Entry-Field, 
           COL 139,50, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg1-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg1-3-buf,
           AFTER PROCEDURE ef-min-kg-3-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet1-3, 
           Entry-Field, 
           COL 149,83, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet1-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet1-3-buf,
           AFTER PROCEDURE ef-min-vet-30kg-3-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-kg2-3, 
           Entry-Field, 
           COL 139,50, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg2-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg2-3-buf,
           AFTER PROCEDURE ef-min-kg-3-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet2-3, 
           Entry-Field, 
           COL 149,83, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet2-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet2-3-buf,
           AFTER PROCEDURE ef-min-vet-3-AfterProcedure, 
           .


      * ENTRY FIELD
       05
           ef-max-kg-3, 
           Entry-Field, 
           COL 139,50, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-kg-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-kg-3-buf,
           AFTER PROCEDURE ef-max-kg-3-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-max-vet-3, 
           Entry-Field, 
           COL 149,83, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-vet-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-vet-3-buf,
           AFTER PROCEDURE ef-max-vet-3-AfterProcedure, 
           .


      * CHECK BOX
       05
           chk-accorpa-3, 
           Check-Box, 
           COL 140,50, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-clienti-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-accorpa-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-accorpa-3-buf,
           AFTER PROCEDURE chk-accorpa-3-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-promo-3, 
           Check-Box, 
           COL 162,67, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-clienti-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-promo-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-promo-3-buf,
           AFTER PROCEDURE chk-promo-3-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-prenot-3, 
           Check-Box, 
           COL 140,50, 
           LINE 42,61,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-clienti-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-prenot-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-prenot-3-buf,
           AFTER PROCEDURE chk-intera-3-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-banco-3, 
           Check-Box, 
           COL 162,67, 
           LINE 42,61,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-clienti-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-banco-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-banco-3-buf,
           AFTER PROCEDURE chk-banco-3-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-escludi-3, 
           Check-Box, 
           COL 140,50, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED e-clienti-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-escludi-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-escludi-3-buf,
           AFTER PROCEDURE chk-intera-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-imb-min-3, 
           Check-Box, 
           COL 162,67, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-imb-min-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-imb-min-3-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-art-forn-3, 
           Check-Box, 
           COL 140,50, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-art-forn-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-art-forn-3-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-bosch-3, 
           Check-Box, 
           COL 162,67, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1017
           FLAT,
           FONT IS Small-Font,
           ID IS 177,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-bosch-3-buf,
           AFTER PROCEDURE chk-pb-bosch-3-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-perce-3, 
           Check-Box, 
           COL 140,50, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1012
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-perce-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-perce-3-buf,
           AFTER PROCEDURE chk-pb-perce-3-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-amp-3, 
           Check-Box, 
           COL 162,67, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1008
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-amp-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-amp-3-buf,
           AFTER PROCEDURE chk-pb-amp-3-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-sost-batt-3, 
           Check-Box, 
           COL 140,50, 
           LINE 48,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-sost-batt-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-sost-batt-3-buf,
           AFTER PROCEDURE chk-sost-batt-3-AfterProcedure,
           .
      * GRID
       05
           gd-mag-3, 
           Grid, 
           COL 127,00, 
           LINE 50,07,
           LINES 5,92 ,
           SIZE 38,17 ,
           BOXED,
           DATA-COLUMNS (1, 4, 104),
           ALIGNMENT ("U", "U", "C"),
           SEPARATION (5, 5, 5),
           DATA-TYPES ("U(3)", "X(100)", "U(1)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-mag-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 35,
           VPADDING 10,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * LABEL
       05
           Screen1-La-1abaa, 
           Label, 
           COL 127,17, 
           LINE 29,46,
           LINES 1,31 ,
           SIZE 21,00 ,
           FONT IS Small-Font,
           ID IS 181,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG evas. parziale (forzata)",
           .

      * LABEL
       05
           Screen1-La-1aabaa, 
           Label, 
           COL 127,17, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 182,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG per consegna",
           .

      * LABEL
       05
           Screen1-La-1aaabaa, 
           Label, 
           COL 127,17, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 183,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG validità volantino",
           .

      * LABEL
       05
           Screen1-La-1aaaabaa, 
           Label, 
           COL 127,17, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 184,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG consegna MAX",
           .

      * LABEL
       05
           Screen1-La-1aaaaabaa, 
           Label, 
           COL 127,17, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 185,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           Screen1-La-1aaaaaaaaa, 
           Label, 
           COL 127,17, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 186,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore > Kg",
           .

      * LABEL
       05
           Screen1-La-2caa, 
           Label, 
           COL 127,17, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 187,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Accorpamento",
           .

      * LABEL
       05
           Screen1-La-2abaa, 
           Label, 
           COL 127,17, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 188,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prenotaz. qta",
           .

      * LABEL
       05
           Screen1-La-2baaa, 
           Label, 
           COL 146,50, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 189,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi PROMO",
           .

      * LABEL
       05
           Screen1-La-2aaaaa, 
           Label, 
           COL 146,50, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 190,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi BANCO",
           .

      * LABEL
       05
           lab-vet-min2-3, 
           Label, 
           COL 157,00, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 191,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min2-3-buf,
           .

      * LABEL
       05
           lab-vet-max-3, 
           Label, 
           COL 157,00, 
           LINE 40,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 192,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-max-3-buf,
           .

      * LABEL
       05
           Screen1-La-1aaaaaabaaa, 
           Label, 
           COL 127,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 193,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Blocco Kg",
           .

      * LABEL
       05
           Screen1-La-3aa, 
           Label, 
           COL 137,50, 
           LINE 26,23,
           LINES 1,31 ,
           SIZE 11,00 ,
           COLOR IS 5,
           FONT IS Large-Font,
           ID IS 194,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "GESTISCI",
           .

      * LABEL
       05
           Screen1-La-2acab, 
           Label, 
           COL 127,17, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 195,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "NO evadi tutto",
           .

      * LABEL
       05
           Screen1-La-2aabc, 
           Label, 
           COL 146,50, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 196,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imb. minimo",
           .

      * LABEL
       05
           Screen1-La-2aabec, 
           Label, 
           COL 127,17, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 197,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. art forn.",
           .

      * LABEL
       05
           Screen1-La-2aabeeaaa, 
           Label, 
           COL 127,17, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 198,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. PB %",
           .

      * LABEL
       05
           Screen1-La-2aabfaaa, 
           Label, 
           COL 146,50, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 199,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb amp.",
           .

      * LABEL
       05
           Screen1-La-2aabfaaab, 
           Label, 
           COL 146,50, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 200,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb BOSCH",
           .

      * LABEL
       05
           Screen1-La-2dc, 
           Label, 
           COL 127,17, 
           LINE 56,15,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 201,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sampante",
           .

      * ENTRY FIELD
       05
           ef-stampante-3, 
           Entry-Field, 
           COL 127,00, 
           LINE 57,61,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-stampante-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-stampante-3-buf,
           AFTER PROCEDURE ef-max-kg-AfterProcedure, 
           BEFORE PROCEDURE ef-max-kg-BeforeProcedure, 
           .

      * CHECK BOX
       05
           chk-layout-pers-3, 
           Check-Box, 
           COL 145,50, 
           LINE 59,38,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED e-clienti-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-layout-pers-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-layout-pers-3-buf,
           AFTER PROCEDURE chk-pb-perce-AfterProcedure,
           .
      * PUSH BUTTON
       05
           pb-path-logo-3, 
           Push-Button, 
           COL 162,33, 
           LINE 59,76,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED e-clienti-dati,
           EXCEPTION-VALUE 1026,
           FONT IS Small-Font,
           ID IS AUTO-ID,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       05
           ef-path-logo-3, 
           Entry-Field, 
           COL 127,00, 
           LINE 61,07,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-clienti-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-logo-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-path-logo-3-buf,
           AFTER PROCEDURE ef-path-logoa-AfterProcedure, 
           .

      * PUSH BUTTON
       05
           pb-stampanti-3, 
           Push-Button, 
           COL 162,33, 
           LINE 56,38,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED e-clienti-dati,
           EXCEPTION-VALUE 1022,
           FONT IS Small-Font,
           ID IS 206,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * LABEL
       05
           Screen1-La-1aaaaacba, 
           Label, 
           COL 127,17, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 207,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           lab-vet-min1-3, 
           Label, 
           COL 156,83, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 208,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min1-3-buf,
           .

      * LABEL
       05
           Screen1-La-2aabeebaaa, 
           Label, 
           COL 127,17, 
           LINE 59,38,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 209,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Logo personalizzato",
           .

      * LABEL
       05
           Screen1-La-2aabeecaaa, 
           Label, 
           COL 127,17, 
           LINE 48,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sost. batterie",
           .

      * FRAME
       05
           frame-4, 
           Frame, 
           COL 167,67, 
           LINE 25,38,
           LINES 38,00 ,
           SIZE 40,33 ,
           ID IS 210,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE-POSITION 2,
           .

      * CHECK BOX
       05
           chk-gestisci-4, 
           Check-Box, 
           COL 191,34, 
           LINE 25,92,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-destini,
           EXCEPTION-VALUE 1003
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-gestisci-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-gestisci-4-buf,
           AFTER PROCEDURE chk-gestisci-3a-AfterProcedure,
           BEFORE PROCEDURE chk-gestisci-3a-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-parz-4, 
           Entry-Field, 
           COL 192,50, 
           LINE 29,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-parz-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-parz-4-buf,
           AFTER PROCEDURE ef-parz-4-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg-cons-4, 
           Entry-Field, 
           COL 192,50, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-cons-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-gg-cons-4-buf,
           AFTER PROCEDURE ef-gg-cons-4-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-val-4, 
           Entry-Field, 
           COL 192,50, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-val-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-val-4-buf,
           AFTER PROCEDURE ef-val-4-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-cons-max-4, 
           Entry-Field, 
           COL 192,50, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cons-max-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-cons-max-4-buf,
           AFTER PROCEDURE ef-cons-max-4-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-blocco-kg-4, 
           Entry-Field, 
           COL 186,50, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-blocco-kg-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-blocco-kg-4-buf,
           AFTER PROCEDURE ef-blocco-kg-4-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-kg1-4, 
           Entry-Field, 
           COL 182,17, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg1-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg1-4-buf,
           AFTER PROCEDURE ef-min-kg-4-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet1-4, 
           Entry-Field, 
           COL 191,50, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet1-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet1-4-buf,
           AFTER PROCEDURE ef-min-vet-30kg-4-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-kg2-4, 
           Entry-Field, 
           COL 182,17, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-kg2-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-kg2-4-buf,
           AFTER PROCEDURE ef-min-kg-4-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-min-vet2-4, 
           Entry-Field, 
           COL 191,50, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-min-vet2-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-min-vet2-4-buf,
           AFTER PROCEDURE ef-min-vet-4-AfterProcedure, 
           .


      * ENTRY FIELD
       05
           ef-max-kg-4, 
           Entry-Field, 
           COL 182,17, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-kg-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-kg-4-buf,
           AFTER PROCEDURE ef-max-kg-4-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-max-vet-4, 
           Entry-Field, 
           COL 191,50, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-max-vet-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-max-vet-4-buf,
           AFTER PROCEDURE ef-max-vet-4-AfterProcedure, 
           .


      * CHECK BOX
       05
           chk-accorpa-4, 
           Check-Box, 
           COL 182,17, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-destini-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-accorpa-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-accorpa-4-buf,
           AFTER PROCEDURE chk-accorpa-4-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-promo-4, 
           Check-Box, 
           COL 204,34, 
           LINE 41,23,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-destini-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-promo-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-promo-4-buf,
           AFTER PROCEDURE chk-promo-4-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-prenot-4, 
           Check-Box, 
           COL 182,17, 
           LINE 42,61,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-destini-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-prenot-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-prenot-4-buf,
           AFTER PROCEDURE chk-intera-4-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-banco-4, 
           Check-Box, 
           COL 204,34, 
           LINE 42,61,
           LINES 1,50 ,
           SIZE 3,00 ,
           ENABLED e-destini-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-banco-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Check Box",
           VALUE chk-banco-4-buf,
           AFTER PROCEDURE chk-banco-4-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-escludi-4, 
           Check-Box, 
           COL 182,17, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED e-destini-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-escludi-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-escludi-4-buf,
           AFTER PROCEDURE chk-intera-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-imb-min-4, 
           Check-Box, 
           COL 204,34, 
           LINE 43,92,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-imb-min-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-imb-min-4-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-art-forn-4, 
           Check-Box, 
           COL 182,17, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-art-forn-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-art-forn-4-buf,
           AFTER PROCEDURE chk-banco-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-bosch-4, 
           Check-Box, 
           COL 204,34, 
           LINE 45,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1018
           FLAT,
           FONT IS Small-Font,
           ID IS 230,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-bosch-4-buf,
           AFTER PROCEDURE chk-pb-bosch-4-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-perce-4, 
           Check-Box, 
           COL 182,17, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1013
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-perce-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-perce-4-buf,
           AFTER PROCEDURE chk-pb-perce-4-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-pb-amp-4, 
           Check-Box, 
           COL 204,34, 
           LINE 46,76,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           EXCEPTION-VALUE 1009
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-pb-amp-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-pb-amp-4-buf,
           AFTER PROCEDURE chk-pb-amp-4-AfterProcedure,
           .
      * CHECK BOX
       05
           chk-sost-batt-4, 
           Check-Box, 
           COL 182,17, 
           LINE 48,30,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED mod,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-sost-batt-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-sost-batt-4-buf,
           AFTER PROCEDURE chk-sost-batt-4-AfterProcedure,
           .
      * GRID
       05
           gd-mag-4, 
           Grid, 
           COL 168,67, 
           LINE 50,07,
           LINES 5,92 ,
           SIZE 38,17 ,
           BOXED,
           DATA-COLUMNS (1, 4, 104),
           SEPARATION (5, 5, 5),
           DATA-TYPES ("U(3)", "X(100)", "U(1)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-mag-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 35,
           VPADDING 10,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * LABEL
       05
           Screen1-La-1abaaa, 
           Label, 
           COL 168,84, 
           LINE 29,46,
           LINES 1,31 ,
           SIZE 21,00 ,
           FONT IS Small-Font,
           ID IS 246,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG evas. parziale (forzata)",
           .

      * LABEL
       05
           Screen1-La-1aabaaa, 
           Label, 
           COL 168,84, 
           LINE 30,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 247,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG per consegna",
           .

      * LABEL
       05
           Screen1-La-1aaabaaa, 
           Label, 
           COL 168,84, 
           LINE 32,46,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 248,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG validità volantino",
           .

      * LABEL
       05
           Screen1-La-1aaaabaaa, 
           Label, 
           COL 168,84, 
           LINE 33,92,
           LINES 1,31 ,
           SIZE 18,00 ,
           FONT IS Small-Font,
           ID IS 249,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GG consegna MAX",
           .

      * LABEL
       05
           Screen1-La-1aaaaabaaa, 
           Label, 
           COL 168,84, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 250,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           Screen1-La-1aaaaaaaaaa, 
           Label, 
           COL 168,84, 
           LINE 39,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 251,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore > Kg",
           .

      * LABEL
       05
           Screen1-La-2caaa, 
           Label, 
           COL 168,84, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 252,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Accorpamento",
           .

      * LABEL
       05
           Screen1-La-2abaaa, 
           Label, 
           COL 168,84, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 253,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prenotaz. qta",
           .

      * LABEL
       05
           Screen1-La-2baaaa, 
           Label, 
           COL 188,17, 
           LINE 41,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 254,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi PROMO",
           .

      * LABEL
       05
           Screen1-La-2aaaaaa, 
           Label, 
           COL 188,17, 
           LINE 42,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 255,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Saldi BANCO",
           .

      * LABEL
       05
           lab-vet-min2-4, 
           Label, 
           COL 198,67, 
           LINE 38,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 256,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min2-4-buf,
           .

      * LABEL
       05
           lab-vet-max-4, 
           Label, 
           COL 198,67, 
           LINE 40,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 257,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-max-4-buf,
           .

      * LABEL
       05
           Screen1-La-1aaaaaabaaaa, 
           Label, 
           COL 168,84, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 258,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Blocco Kg",
           .

      * LABEL
       05
           Screen1-La-3aaa, 
           Label, 
           COL 179,17, 
           LINE 26,23,
           LINES 1,31 ,
           SIZE 11,00 ,
           COLOR IS 5,
           FONT IS Large-Font,
           ID IS 259,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "GESTISCI",
           .

      * LABEL
       05
           Screen1-La-2acac, 
           Label, 
           COL 168,84, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 260,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "NO evadi tutto",
           .

      * LABEL
       05
           Screen1-La-2aabd, 
           Label, 
           COL 188,17, 
           LINE 44,23,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 261,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imb. minimo",
           .

      * LABEL
       05
           Screen1-La-2aabed, 
           Label, 
           COL 168,84, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 262,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cod. art forn.",
           .

      * LABEL
       05
           Screen1-La-2aabfaaaa, 
           Label, 
           COL 188,17, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 263,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb amp.",
           .

      * LABEL
       05
           Screen1-La-2aabeeaaaa, 
           Label, 
           COL 168,84, 
           LINE 47,00,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 264,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. PB %",
           .

      * LABEL
       05
           Screen1-La-2aabfaaaaa, 
           Label, 
           COL 188,17, 
           LINE 45,53,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 265,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add. Pb BOSCH",
           .

      * LABEL
       05
           Screen1-La-2dd, 
           Label, 
           COL 168,84, 
           LINE 56,15,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 266,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sampante",
           .

      * ENTRY FIELD
       05
           ef-stampante-4, 
           Entry-Field, 
           COL 168,67, 
           LINE 57,61,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-stampante-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-stampante-4-buf,
           AFTER PROCEDURE ef-max-kg-AfterProcedure, 
           BEFORE PROCEDURE ef-max-kg-BeforeProcedure, 
           .

      * CHECK BOX
       05
           chk-layout-pers-4, 
           Check-Box, 
           COL 187,17, 
           LINE 59,38,
           LINES 1,54 ,
           SIZE 3,00 ,
           ENABLED e-destini-dati,
           FLAT,
           FONT IS Small-Font,
           ID IS 78-ID-chk-layout-pers-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE chk-layout-pers-4-buf,
           AFTER PROCEDURE chk-pb-perce-AfterProcedure,
           .
      * PUSH BUTTON
       05
           pb-path-logo-4, 
           Push-Button, 
           COL 204,00, 
           LINE 59,76,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED e-destini-dati,
           EXCEPTION-VALUE 1027,
           FONT IS Small-Font,
           ID IS AUTO-ID,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * ENTRY FIELD
       05
           ef-path-logo-4, 
           Entry-Field, 
           COL 168,67, 
           LINE 61,07,
           LINES 1,31 ,
           SIZE 38,17 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-destini-dati,
           FONT IS Small-Font,
           ID IS 78-ID-ef-path-logo-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           READ-ONLY,
           VALUE ef-path-logo-4-buf,
           AFTER PROCEDURE ef-path-logoa-AfterProcedure, 
           .

      * PUSH BUTTON
       05
           pb-stampanti-4, 
           Push-Button, 
           COL 204,00, 
           LINE 56,38,
           LINES 1,08 ,
           SIZE 2,83 ,
           ENABLED e-destini-dati,
           EXCEPTION-VALUE 1023,
           FONT IS Small-Font,
           ID IS 271,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "...",
           .

      * LABEL
       05
           Screen1-La-1aaaaacbaa, 
           Label, 
           COL 168,84, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 272,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Vettore < Kg",
           .

      * LABEL
       05
           lab-vet-min1-4, 
           Label, 
           COL 198,50, 
           LINE 36,92,
           LINES 1,31 ,
           SIZE 8,00 ,
           COLOR IS 2,
           FONT IS Small-Font,
           ID IS 273,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-min1-4-buf,
           .

      * LABEL
       05
           Screen1-La-2aabeebaab, 
           Label, 
           COL 168,84, 
           LINE 59,38,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 274,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Logo personalizzato",
           .

      * LABEL
       05
           Screen1-La-2aabeecaaaa, 
           Label, 
           COL 168,84, 
           LINE 48,53,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Sost. batterie",
           .

      * GRID
       05
           gd-tipocli, 
           Grid, 
           COL 43,17, 
           LINE 2,85,
           LINES 22,38 ,
           SIZE 40,17 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           DATA-COLUMNS (1, 3),
           SEPARATION (5, 5),
           DATA-TYPES ("X(2)", "X(50)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-tipocli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 37,
           VPADDING 30,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * GRID
       05
           gd-clienti, 
           Grid, 
           COL 126,00, 
           LINE 2,85,
           LINES 22,38 ,
           SIZE 40,17 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           DATA-COLUMNS (1, 6),
           ALIGNMENT ("R", "U"),
           SEPARATION (5, 5),
           DATA-TYPES ("X(5)", "X(100)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-clienti,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 37,
           VPADDING 30,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * GRID
       05
           gd-gdo, 
           Grid, 
           COL 84,50, 
           LINE 2,85,
           LINES 22,38 ,
           SIZE 40,17 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           DATA-COLUMNS (1, 6),
           SEPARATION (5, 5),
           DATA-TYPES ("X(5)", "X(50)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-gdo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 37,
           VPADDING 30,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * GRID
       05
           gd-destini, 
           Grid, 
           COL 167,67, 
           LINE 2,85,
           LINES 22,38 ,
           SIZE 40,17 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           DATA-COLUMNS (1, 6),
           ALIGNMENT ("R", "U"),
           SEPARATION (5, 5),
           DATA-TYPES ("X(5)", "X(100)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd-destini,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 37,
           VPADDING 30,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * LABEL
       05
           Screen1-blockpgm-1, 
           Label, 
           COL 2,50, 
           LINE 1,00,
           LINES 1,90 ,
           SIZE 3,90 ,
           ID IS 275,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Screen1-Custom1-1, 
           Label, 
           COL 27,10, 
           LINE 1,00,
           LINES 1,90 ,
           SIZE 5,90 ,
           FONT IS Default-Font,
           ID IS 276,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * BITMAP
       05
           Screen1-Bt-1, 
           Bitmap, 
           COL 5,50, 
           LINE 10,00,
           LINES 6,85 ,
           SIZE 33,33 ,
           TRANSPARENT-COLOR TR-COLOR,
           BITMAP-HANDLE logo-gparam-bmp,
           BITMAP-NUMBER 1,
           ID IS 277,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           .

      * LABEL
       05
           Screen1-La-4, 
           Label, 
           COL 43,17, 
           LINE 1,46,
           LINES 1,08 ,
           SIZE 40,17 ,
           COLOR IS 5,
           FONT IS Large-Font,
           ID IS 278,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "TIPOLOGIA CLIENTE",
           .

      * LABEL
       05
           Screen1-La-4a, 
           Label, 
           COL 84,50, 
           LINE 1,46,
           LINES 1,08 ,
           SIZE 40,17 ,
           COLOR IS 5,
           FONT IS Large-Font,
           ID IS 279,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "GRUPPO GDO",
           .

      * LABEL
       05
           Screen1-La-4b, 
           Label, 
           COL 126,00, 
           LINE 1,46,
           LINES 1,08 ,
           SIZE 40,17 ,
           COLOR IS 5,
           FONT IS Large-Font,
           ID IS 280,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "CLIENTE",
           .

      * LABEL
       05
           Screen1-La-4c, 
           Label, 
           COL 167,67, 
           LINE 1,46,
           LINES 1,08 ,
           SIZE 40,17 ,
           COLOR IS 5,
           FONT IS Large-Font,
           ID IS 281,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "DESTINO",
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 282,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 5,67, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED 0,
           FLAT,
           ID IS 283,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           BITMAP-NUMBER=BitmapNumNew
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 15,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CANCELLA,
           EXCEPTION-VALUE 4,
           FLAT,
           ID IS 284,
           SELF-ACT,
           TITLE "Cancella (F4)",
           BITMAP-NUMBER BitmapNumDelete
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 10,33, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 285,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 24,33, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 17,
           FRAMED,
           SQUARE,
           ENABLED E-ANTEPRIMA,
           EXCEPTION-VALUE 6,
           FLAT,
           ID IS 286,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 19,67, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 5,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 287,
           SELF-ACT,
           TITLE "Modifica (F5)",
           BITMAP-NUMBER BitmapNumEdit
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 29,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 7,
           FRAMED,
           SQUARE,
           ENABLED 1,
           EXCEPTION-VALUE 7,
           FLAT,
           ID IS 288,
           SELF-ACT,
           TITLE "Stampa (F7)",
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 33,67, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 289,
           SELF-ACT,
           TITLE "Cerca (F8)",
           BITMAP-NUMBER BitmapNumZoom
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, USER-CODI, LIVELLO-ABIL.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:gparam, INIT:gparam, BeforeDeclarative>
       PARAM-ERR SECTION.
           use after error procedure on param.
           set RecLocked to false.
           evaluate status-param
           when "35"
                display message "File [PARAM] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [PARAM] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[PARAM] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "93" 
           when "99"
                set RecLocked to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM gparam-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:gparam, INIT:gparam, BeforeDestroyResource>
      * <TOTEM:END>
           CALL "w$bitmap" USING WBITMAP-DESTROY, logo-gparam-bmp
           CALL "w$bitmap" USING WBITMAP-DESTROY, TOOLBAR-BMP
      *    After-Program
           PERFORM gparam-Ev-After-Program
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
           .

       INIT-BMP.
      * Screen1-Bt-1
           COPY RESOURCE "LOGO-GPARAM.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "LOGO-GPARAM.BMP", 
                   GIVING logo-gparam-bmp.
      * TOOL-ESCI
           COPY RESOURCE "TOOLBAR.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "TOOLBAR.BMP", 
                   GIVING TOOLBAR-BMP.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-ttipocli
           PERFORM OPEN-tgrupgdo
           PERFORM OPEN-clienti
           PERFORM OPEN-destini
           PERFORM OPEN-tvettori
           PERFORM OPEN-tmagaz
           PERFORM OPEN-param
           PERFORM OPEN-param1
      *    After Open
           .

       OPEN-ttipocli.
      * <TOTEM:EPT. INIT:gparam, FD:ttipocli, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT ttipocli
           IF NOT Valid-STATUS-ttipocli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gparam, FD:ttipocli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tgrupgdo.
      * <TOTEM:EPT. INIT:gparam, FD:tgrupgdo, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tgrupgdo
           IF NOT Valid-STATUS-tgrupgdo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gparam, FD:tgrupgdo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-clienti.
      * <TOTEM:EPT. INIT:gparam, FD:clienti, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT clienti
           IF NOT Valid-STATUS-clienti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gparam, FD:clienti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-destini.
      * <TOTEM:EPT. INIT:gparam, FD:destini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT destini
           IF NOT Valid-STATUS-destini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gparam, FD:destini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tvettori.
      * <TOTEM:EPT. INIT:gparam, FD:tvettori, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tvettori
           IF NOT Valid-STATUS-tvettori
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gparam, FD:tvettori, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmagaz.
      * <TOTEM:EPT. INIT:gparam, FD:tmagaz, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmagaz
           IF NOT Valid-STATUS-tmagaz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gparam, FD:tmagaz, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-param.
      * <TOTEM:EPT. INIT:gparam, FD:param, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT param
           IF NOT Valid-STATUS-param
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gparam, FD:param, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-param1.
      * <TOTEM:EPT. INIT:gparam, FD:param1, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT param1
           IF NOT VALID-STATUS-param1
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gparam, FD:param1, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-ttipocli
           PERFORM CLOSE-tgrupgdo
           PERFORM CLOSE-clienti
           PERFORM CLOSE-destini
           PERFORM CLOSE-tvettori
           PERFORM CLOSE-tmagaz
           PERFORM CLOSE-param
           PERFORM CLOSE-param1
      *    After Close
           .

       CLOSE-ttipocli.
      * <TOTEM:EPT. INIT:gparam, FD:ttipocli, BeforeClose>
      * <TOTEM:END>
           CLOSE ttipocli
           .

       CLOSE-tgrupgdo.
      * <TOTEM:EPT. INIT:gparam, FD:tgrupgdo, BeforeClose>
      * <TOTEM:END>
           CLOSE tgrupgdo
           .

       CLOSE-clienti.
      * <TOTEM:EPT. INIT:gparam, FD:clienti, BeforeClose>
      * <TOTEM:END>
           CLOSE clienti
           .

       CLOSE-destini.
      * <TOTEM:EPT. INIT:gparam, FD:destini, BeforeClose>
      * <TOTEM:END>
           CLOSE destini
           .

       CLOSE-tvettori.
      * <TOTEM:EPT. INIT:gparam, FD:tvettori, BeforeClose>
      * <TOTEM:END>
           CLOSE tvettori
           .

       CLOSE-tmagaz.
      * <TOTEM:EPT. INIT:gparam, FD:tmagaz, BeforeClose>
      * <TOTEM:END>
           CLOSE tmagaz
           .

       CLOSE-param.
      * <TOTEM:EPT. INIT:gparam, FD:param, BeforeClose>
      * <TOTEM:END>
           CLOSE param
           .

       CLOSE-param1.
      * <TOTEM:EPT. INIT:gparam, FD:param1, BeforeClose>
      * <TOTEM:END>
           CLOSE param1
           .

       DataSet1-ttipocli-INITSTART.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE Low-Value TO tcl-chiave
           ELSE
              MOVE High-Value TO tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-INITEND.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE High-Value TO tcl-chiave
           ELSE
              MOVE Low-Value TO tcl-chiave
           END-IF
           .

      * ttipocli
       DataSet1-ttipocli-START.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY >= tcl-chiave
           ELSE
              START ttipocli KEY <= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-NOTGREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY <= tcl-chiave
           ELSE
              START ttipocli KEY >= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-GREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY > tcl-chiave
           ELSE
              START ttipocli KEY < tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-LESS.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY < tcl-chiave
           ELSE
              START ttipocli KEY > tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-ttipocli-LOCK
              READ ttipocli WITH LOCK 
              KEY tcl-chiave
           ELSE
              READ ttipocli WITH NO LOCK 
              KEY tcl-chiave
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT 
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterDelete>
      * <TOTEM:END>
           .

       tgrupgdo-gdo-k-g2-MERGE-SPLITBUF.
           INITIALIZE tgrupgdo-gdo-k-g2-SPLITBUF
           MOVE gdo-codice-G2 OF tgrupgdo(1:3) TO 
           tgrupgdo-gdo-k-g2-SPLITBUF(1:3)
           MOVE gdo-chiave OF tgrupgdo(1:5) TO 
           tgrupgdo-gdo-k-g2-SPLITBUF(4:5)
           .

       DataSet1-tgrupgdo-INITSTART.
           IF DataSet1-tgrupgdo-KEY-Asc
              MOVE Low-Value TO gdo-chiave OF tgrupgdo
           ELSE
              MOVE High-Value TO gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-INITEND.
           IF DataSet1-tgrupgdo-KEY-Asc
              MOVE High-Value TO gdo-chiave OF tgrupgdo
           ELSE
              MOVE Low-Value TO gdo-chiave OF tgrupgdo
           END-IF
           .

      * tgrupgdo
       DataSet1-tgrupgdo-START.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY >= gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY <= gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-START-NOTGREATER.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY <= gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY >= gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-START-GREATER.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY > gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY < gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-START-LESS.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY < gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY > gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tgrupgdo-LOCK
              READ tgrupgdo WITH LOCK 
              KEY gdo-chiave OF tgrupgdo
           ELSE
              READ tgrupgdo WITH NO LOCK 
              KEY gdo-chiave OF tgrupgdo
           END-IF
           PERFORM tgrupgdo-gdo-k-g2-MERGE-SPLITBUF
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT 
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tgrupgdo-KEY-Asc
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo NEXT WITH LOCK
              ELSE
                 READ tgrupgdo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo PREVIOUS WITH LOCK
              ELSE
                 READ tgrupgdo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tgrupgdo-gdo-k-g2-MERGE-SPLITBUF
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tgrupgdo-KEY-Asc
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo PREVIOUS WITH LOCK
              ELSE
                 READ tgrupgdo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo NEXT WITH LOCK
              ELSE
                 READ tgrupgdo NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tgrupgdo-gdo-k-g2-MERGE-SPLITBUF
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterDelete>
      * <TOTEM:END>
           .

       clienti-cli-K1-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K1-SPLITBUF
           MOVE cli-tipo-CF OF clienti(1:1) TO 
           clienti-cli-K1-SPLITBUF(1:1)
           MOVE cli-ragsoc-1 OF clienti(1:40) TO 
           clienti-cli-K1-SPLITBUF(2:40)
           MOVE cli-codice OF clienti(1:5) TO 
           clienti-cli-K1-SPLITBUF(42:5)
           .

       clienti-cli-K3-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K3-SPLITBUF
           MOVE cli-gdo OF clienti(1:5) TO clienti-cli-K3-SPLITBUF(1:5)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K3-SPLITBUF(6:6)
           .

       clienti-cli-K4-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K4-SPLITBUF
           MOVE cli-utf OF clienti(1:1) TO clienti-cli-K4-SPLITBUF(1:1)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K4-SPLITBUF(2:6)
           .

       DataSet1-clienti-INITSTART.
           IF DataSet1-clienti-KEY-Asc
              MOVE Low-Value TO cli-chiave OF clienti
           ELSE
              MOVE High-Value TO cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-INITEND.
           IF DataSet1-clienti-KEY-Asc
              MOVE High-Value TO cli-chiave OF clienti
           ELSE
              MOVE Low-Value TO cli-chiave OF clienti
           END-IF
           .

      * clienti
       DataSet1-clienti-START.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY >= cli-chiave OF clienti
           ELSE
              START clienti KEY <= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-NOTGREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY <= cli-chiave OF clienti
           ELSE
              START clienti KEY >= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-GREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY > cli-chiave OF clienti
           ELSE
              START clienti KEY < cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-LESS.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY < cli-chiave OF clienti
           ELSE
              START clienti KEY > cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-clienti-LOCK
              READ clienti WITH LOCK 
              KEY cli-chiave OF clienti
           ELSE
              READ clienti WITH NO LOCK 
              KEY cli-chiave OF clienti
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT 
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterDelete>
      * <TOTEM:END>
           .

       destini-K1-MERGE-SPLITBUF.
           INITIALIZE destini-K1-SPLITBUF
           MOVE des-ragsoc-1(1:40) TO destini-K1-SPLITBUF(1:40)
           MOVE des-codice(1:5) TO destini-K1-SPLITBUF(41:5)
           MOVE des-prog(1:5) TO destini-K1-SPLITBUF(46:5)
           .

       destini-k-localita-MERGE-SPLITBUF.
           INITIALIZE destini-k-localita-SPLITBUF
           MOVE des-localita(1:35) TO destini-k-localita-SPLITBUF(1:35)
           .

       DataSet1-destini-INITSTART.
           IF DataSet1-destini-KEY-Asc
              MOVE Low-Value TO des-chiave
           ELSE
              MOVE High-Value TO des-chiave
           END-IF
           .

       DataSet1-destini-INITEND.
           IF DataSet1-destini-KEY-Asc
              MOVE High-Value TO des-chiave
           ELSE
              MOVE Low-Value TO des-chiave
           END-IF
           .

      * destini
       DataSet1-destini-START.
           IF DataSet1-destini-KEY-Asc
              START destini KEY >= des-chiave
           ELSE
              START destini KEY <= des-chiave
           END-IF
           .

       DataSet1-destini-START-NOTGREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY <= des-chiave
           ELSE
              START destini KEY >= des-chiave
           END-IF
           .

       DataSet1-destini-START-GREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY > des-chiave
           ELSE
              START destini KEY < des-chiave
           END-IF
           .

       DataSet1-destini-START-LESS.
           IF DataSet1-destini-KEY-Asc
              START destini KEY < des-chiave
           ELSE
              START destini KEY > des-chiave
           END-IF
           .

       DataSet1-destini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-destini-LOCK
              READ destini WITH LOCK 
              KEY des-chiave
           ELSE
              READ destini WITH NO LOCK 
              KEY des-chiave
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT 
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterDelete>
      * <TOTEM:END>
           .

       tvettori-k-des-MERGE-SPLITBUF.
           INITIALIZE tvettori-k-des-SPLITBUF
           MOVE vet-descrizione(1:40) TO tvettori-k-des-SPLITBUF(1:40)
           .

       DataSet1-tvettori-INITSTART.
           IF DataSet1-tvettori-KEY-Asc
              MOVE Low-Value TO vet-chiave
           ELSE
              MOVE High-Value TO vet-chiave
           END-IF
           .

       DataSet1-tvettori-INITEND.
           IF DataSet1-tvettori-KEY-Asc
              MOVE High-Value TO vet-chiave
           ELSE
              MOVE Low-Value TO vet-chiave
           END-IF
           .

      * tvettori
       DataSet1-tvettori-START.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY >= vet-chiave
           ELSE
              START tvettori KEY <= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-NOTGREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY <= vet-chiave
           ELSE
              START tvettori KEY >= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-GREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY > vet-chiave
           ELSE
              START tvettori KEY < vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-LESS.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY < vet-chiave
           ELSE
              START tvettori KEY > vet-chiave
           END-IF
           .

       DataSet1-tvettori-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tvettori-LOCK
              READ tvettori WITH LOCK 
              KEY vet-chiave
           ELSE
              READ tvettori WITH NO LOCK 
              KEY vet-chiave
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT 
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-INITSTART.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE Low-Value TO mag-chiave
           ELSE
              MOVE High-Value TO mag-chiave
           END-IF
           .

       DataSet1-tmagaz-INITEND.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE High-Value TO mag-chiave
           ELSE
              MOVE Low-Value TO mag-chiave
           END-IF
           .

      * tmagaz
       DataSet1-tmagaz-START.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY >= mag-chiave
           ELSE
              START tmagaz KEY <= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-NOTGREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY <= mag-chiave
           ELSE
              START tmagaz KEY >= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-GREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY > mag-chiave
           ELSE
              START tmagaz KEY < mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-LESS.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY < mag-chiave
           ELSE
              START tmagaz KEY > mag-chiave
           END-IF
           .

       DataSet1-tmagaz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmagaz-LOCK
              READ tmagaz WITH LOCK 
              KEY mag-chiave
           ELSE
              READ tmagaz WITH NO LOCK 
              KEY mag-chiave
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT 
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-param-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-param-KEY1-Asc
                 MOVE Low-Value TO prm-chiave OF param
              ELSE
                 MOVE High-Value TO prm-chiave OF param
              END-IF
           END-EVALUATE
           .

       DataSet1-param-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-param-KEY1-Asc
                 MOVE High-Value TO prm-chiave OF param
              ELSE
                 MOVE Low-Value TO prm-chiave OF param
              END-IF
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-param-KEY1-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-param-KEY1-ORDER
           END-EVALUATE
           .

      * param
       DataSet1-param-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-param-KEY1-Asc
                 START param KEY >= prm-chiave OF param
              ELSE
                 START param KEY <= prm-chiave OF param
              END-IF
           END-EVALUATE
           .

       DataSet1-param-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-param-KEY1-Asc
                 START param KEY <= prm-chiave OF param
              ELSE
                 START param KEY >= prm-chiave OF param
              END-IF
           END-EVALUATE
           .

       DataSet1-param-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-param-KEY1-Asc
                 START param KEY > prm-chiave OF param
              ELSE
                 START param KEY < prm-chiave OF param
              END-IF
           END-EVALUATE
           .

       DataSet1-param-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-param-KEY1-Asc
                 START param KEY < prm-chiave OF param
              ELSE
                 START param KEY > prm-chiave OF param
              END-IF
           END-EVALUATE
           .

       DataSet1-param-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-param-LOCK
                 READ param WITH LOCK 
                 KEY prm-chiave OF param
              ELSE
                 READ param WITH NO LOCK 
                 KEY prm-chiave OF param
              END-IF
           END-EVALUATE
           MOVE STATUS-param TO TOTEM-ERR-STAT 
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-param-KEY1-Asc
                 IF DataSet1-param-LOCK
                    READ param NEXT WITH LOCK
                 ELSE
                    READ param NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-param-LOCK
                    READ param PREVIOUS WITH LOCK
                 ELSE
                    READ param PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-param-KEY1-Asc
                 IF DataSet1-param-LOCK
                    READ param PREVIOUS WITH LOCK
                 ELSE
                    READ param PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-param-LOCK
                    READ param NEXT WITH LOCK
                 ELSE
                    READ param NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-param1-INITSTART.
           IF DataSet1-param1-KEY-Asc
              MOVE Low-Value TO prm-chiave OF param1
           ELSE
              MOVE High-Value TO prm-chiave OF param1
           END-IF
           .

       DataSet1-param1-INITEND.
           IF DataSet1-param1-KEY-Asc
              MOVE High-Value TO prm-chiave OF param1
           ELSE
              MOVE Low-Value TO prm-chiave OF param1
           END-IF
           .

      * param1
       DataSet1-param1-START.
           IF DataSet1-param1-KEY-Asc
              START param1 KEY >= prm-chiave OF param1
           ELSE
              START param1 KEY <= prm-chiave OF param1
           END-IF
           .

       DataSet1-param1-START-NOTGREATER.
           IF DataSet1-param1-KEY-Asc
              START param1 KEY <= prm-chiave OF param1
           ELSE
              START param1 KEY >= prm-chiave OF param1
           END-IF
           .

       DataSet1-param1-START-GREATER.
           IF DataSet1-param1-KEY-Asc
              START param1 KEY > prm-chiave OF param1
           ELSE
              START param1 KEY < prm-chiave OF param1
           END-IF
           .

       DataSet1-param1-START-LESS.
           IF DataSet1-param1-KEY-Asc
              START param1 KEY < prm-chiave OF param1
           ELSE
              START param1 KEY > prm-chiave OF param1
           END-IF
           .

       DataSet1-param1-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:param1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param1, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-param1-LOCK
              READ param1 WITH LOCK 
              KEY prm-chiave OF param1
           ELSE
              READ param1 WITH NO LOCK 
              KEY prm-chiave OF param1
           END-IF
           MOVE STATUS-param1 TO TOTEM-ERR-STAT 
           MOVE "param1" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param1, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-param1-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:param1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param1, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-param1-KEY-Asc
              IF DataSet1-param1-LOCK
                 READ param1 NEXT WITH LOCK
              ELSE
                 READ param1 NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param1-LOCK
                 READ param1 PREVIOUS WITH LOCK
              ELSE
                 READ param1 PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param1 TO TOTEM-ERR-STAT
           MOVE "param1" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param1, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-param1-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:param1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param1, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-param1-KEY-Asc
              IF DataSet1-param1-LOCK
                 READ param1 PREVIOUS WITH LOCK
              ELSE
                 READ param1 PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param1-LOCK
                 READ param1 NEXT WITH LOCK
              ELSE
                 READ param1 NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param1 TO TOTEM-ERR-STAT
           MOVE "param1" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param1, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-param1-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:param1, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-param1 TO TOTEM-ERR-STAT
           MOVE "param1" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param1, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-param1-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:param1, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-param1 TO TOTEM-ERR-STAT
           MOVE "param1" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param1, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-param1-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:param1, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-param1 TO TOTEM-ERR-STAT
           MOVE "param1" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param1, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE tcl-rec OF ttipocli
           INITIALIZE gdo-rec OF tgrupgdo
           INITIALIZE cli-rec OF clienti
           INITIALIZE des-rec OF destini
           INITIALIZE vet-rec OF tvettori
           INITIALIZE mag-rec OF tmagaz
           INITIALIZE prm-rec OF param
           INITIALIZE prm-rec OF param1
           .


      * GRID
       gd-mag-Content.
      * CELLS' SETTING
              MODIFY gd-mag, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-mag, X = 2, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-mag, X = 3, Y = 1,
                CELL-DATA = "Tot",
           .

      * GRID
       gd-mag-1-Content.
      * CELLS' SETTING
              MODIFY gd-mag-1, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-mag-1, X = 2, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-mag-1, X = 3, Y = 1,
                CELL-DATA = "Tot",
           .

      * GRID
       gd-mag-2-Content.
      * CELLS' SETTING
              MODIFY gd-mag-2, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-mag-2, X = 2, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-mag-2, X = 3, Y = 1,
                CELL-DATA = "Tot",
           .

      * GRID
       gd-mag-3-Content.
      * CELLS' SETTING
              MODIFY gd-mag-3, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-mag-3, X = 2, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-mag-3, X = 3, Y = 1,
                CELL-DATA = "Tot",
           .

      * GRID
       gd-mag-4-Content.
      * CELLS' SETTING
              MODIFY gd-mag-4, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-mag-4, X = 2, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd-mag-4, X = 3, Y = 1,
                CELL-DATA = "Tot",
           .

      * GRID
       gd-tipocli-Content.
      * CELLS' SETTING
              MODIFY gd-tipocli, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-tipocli, X = 2, Y = 1,
                CELL-DATA = "Descrizione",
           .

      * GRID
       gd-clienti-Content.
      * CELLS' SETTING
              MODIFY gd-clienti, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-clienti, X = 2, Y = 1,
                CELL-DATA = "Ragione Sociale",
           .

      * GRID
       gd-gdo-Content.
      * CELLS' SETTING
              MODIFY gd-gdo, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-gdo, X = 2, Y = 1,
                CELL-DATA = "Descrizione",
           .

      * GRID
       gd-destini-Content.
      * CELLS' SETTING
              MODIFY gd-destini, X = 1, Y = 1,
                CELL-DATA = "Cod",
      * CELLS' SETTING
              MODIFY gd-destini, X = 2, Y = 1,
                CELL-DATA = "Ragione Sociale",
           .

      * FD's Initialize Paragraph
       DataSet1-ttipocli-INITREC.
           INITIALIZE tcl-rec OF ttipocli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tgrupgdo-INITREC.
           INITIALIZE gdo-rec OF tgrupgdo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-clienti-INITREC.
           INITIALIZE cli-rec OF clienti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-destini-INITREC.
           INITIALIZE des-rec OF destini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tvettori-INITREC.
           INITIALIZE vet-rec OF tvettori
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmagaz-INITREC.
           INITIALIZE mag-rec OF tmagaz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-param-INITREC.
           INITIALIZE prm-rec OF param
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-param1-INITREC.
           INITIALIZE prm-rec OF param1
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              LINES 64,15,
              SIZE 208,33,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              ERASE,
              CONTROL FONT Small-Font,
              LABEL-OFFSET 0,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              HANDLE IS form1-handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              GRIP,
              PANEL-WIDTHS (155, 30, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS form1-St-1-Handle
           DISPLAY Form1 UPON form1-handle
      * DISPLAY-COLUMNS settings
              MODIFY gd-mag, DISPLAY-COLUMNS (1, 6, 31)
              MODIFY gd-mag-1, DISPLAY-COLUMNS (1, 6, 31)
              MODIFY gd-mag-2, DISPLAY-COLUMNS (1, 6, 31)
              MODIFY gd-mag-3, DISPLAY-COLUMNS (1, 6, 31)
              MODIFY gd-mag-4, DISPLAY-COLUMNS (1, 6, 31)
              MODIFY gd-tipocli, DISPLAY-COLUMNS (1, 6)
              MODIFY gd-clienti, DISPLAY-COLUMNS (1, 7)
              MODIFY gd-gdo, DISPLAY-COLUMNS (1, 9)
              MODIFY gd-destini, DISPLAY-COLUMNS (1, 7)
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           set StatusVisua to true.
           perform STATUS-BAR-MSG.

           perform ABILITA-TOOLBAR.

           move BitmapNewDisabled to BitmapNumNew.
           move 0 to e-nuovo.
           modify tool-nuovo, enabled e-nuovo, bitmap-number 
           BitmapNumNew.

           move BitmapDeleteDisabled to BitmapNumDelete.
           move 0 to e-cancella.
           modify tool-cancella, enabled e-cancella, bitmap-number 
           BitmapNumDelete.

           move BitmapSaveDisabled to BitmapNumSave.
           move 0 to e-salva.
           modify tool-salva, enabled e-salva, bitmap-number 
           BitmapNumSave.

           modify gd-tipocli, mass-update = 1, reset-grid = 1.
           perform GD-TIPOCLI-CONTENT.
           move low-value to tcl-rec.
           start ttipocli key >= tcl-chiave invalid continue end-start.
           move 2 to riga.
           perform until 1 = 2
              read ttipocli next at end exit perform end-read
              move tcl-codice      to col-tipocli-codice
              move tcl-descrizione to col-tipocli-descrizione          
              modify gd-tipocli(riga, 1), cell-data col-tipocli-codice
              modify gd-tipocli(riga, 2), cell-data 
           col-tipocli-descrizione
              add 1 to riga
           end-perform.
           modify gd-tipocli, mass-update = 0.

           initialize prm-rec of param replacing numeric data by zeroes
                                   alphanumeric data by spaces.
           read param no lock invalid continue end-read.
           move prm-gg-inizio-vol of param      to ef-ini-vol-buf.
           move prm-gg-parziale of param        to ef-parz-buf.
           move prm-gg-per-cons of param        to ef-gg-cons-buf.
           move prm-gg-val-vol of param         to ef-val-buf.
           move prm-gg-cons-max     of param  to ef-cons-max-buf.
           move prm-vet-maggiore-kg of param  to vet-codice 
                                                 ef-max-vet-buf.
           read tvettori no lock invalid continue end-read.
           move vet-sigla to lab-vet-max-buf.
           move prm-maggiore-kg of param        to ef-max-kg-buf.

           move prm-vet-minore-kg1 of param to vet-codice 
           ef-min-vet1-buf.
           read tvettori no lock invalid continue end-read.
           move vet-sigla to lab-vet-min1-buf.

           move prm-vet-minore-kg2 of param to vet-codice 
           ef-min-vet2-buf.
           read tvettori no lock invalid continue end-read.
           move vet-sigla to lab-vet-min2-buf.
                                                        
           move prm-minore-kg1        of param to ef-min-kg1-buf.
           move prm-minore-kg2        of param to ef-min-kg2-buf.
           move prm-blocco-kg         of param to ef-blocco-kg-buf.
           move prm-prenotazione-qta  of param to chk-prenot-buf.
           move prm-accorpa           of param to chk-accorpa-buf.
           move prm-sost-batt         of param to chk-sost-batt-buf.
           move prm-saldi-banco       of param to chk-banco-buf.  
           move prm-imb-minimo        of param to chk-imb-min-buf. 
           move prm-cod-art-forn      of param to chk-art-forn-buf.
           move prm-add-piombo-perce  of param to chk-pb-perce-buf.   
           move prm-add-piombo-ampere of param to chk-pb-amp-buf.
           move prm-sost-batt         of param to chk-pb-sost-batt-buf.
           move prm-add-piombo-bosch  of param to chk-pb-bosch-buf.
           move prm-saldi-promo       of param to chk-promo-buf.
           move prm-escludi-tutto     of param to chk-escludi-buf. 
           move prm-stampante         of param to ef-stampante-buf.
           move prm-path-logo         of param to ef-path-logo-buf.
           move prm-layout-pers       of param to chk-layout-pers-buf.

           modify gd-mag,   mass-update = 1, reset-grid = 1.
           perform GD-MAG-CONTENT.
           move 2 to riga.
           move 1 to idx.
           perform until 1 = 2
              if prm-mag-codice of param(idx) = spaces
                 exit perform
              end-if
              move prm-mag-codice of param(idx) to mag-codice
              read tmagaz no lock
              move mag-codice      to col-mag-codice
              move mag-descrizione to col-mag-descrizione
              move prm-mag-ev-intera of param(idx) to col-mag-intera
              modify gd-mag(riga, 1), cell-data col-mag-codice
              modify gd-mag(riga, 2), cell-data col-mag-descrizione
              modify gd-mag(riga, 3), cell-data col-mag-intera

              add 1 to riga idx
           end-perform.
           modify gd-mag, insert-rows = 1.
           modify gd-mag, mass-update = 0.
           move spaces to tcl-codice.
           move spaces to gdo-codice.
           move 0      to cli-codice.
           move 0      to des-prog.
           move 0      to e-tipocli.
           move 0      to e-tipocli-dati.
           move 0      to e-gdo.
           move 0      to e-gdo-dati.
           move 0      to e-clienti.
           move 0      to e-clienti-dati.
           move 0      to e-destini.
           move 0      to e-destini-dati.

           display Form1.

           perform EVIDENZIA-GESTISCI.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY form1-handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
           evaluate key-status
           when 5 |MODIFICA
                inquire tool-modifica, enabled in e-modifica
                if e-modifica = 1
                   if mod = ZERO 
                      move 1    to mod
                   else          
                      move ZERO to mod
                   end-if
                   modify tool-modifica, value = mod
                   perform MODIFICA
                end-if
           end-evaluate.

           .
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
              WHEN Key-Status = 1014
                 PERFORM chk-pb-bosch-LinkTo
              WHEN Key-Status = 1004
                 PERFORM chk-pb-perce-LinkTo
              WHEN Key-Status = 1005
                 PERFORM chk-pb-amp-LinkTo
              WHEN Key-Status = 3001
                 PERFORM pb-path-logo-LinkTo
              WHEN Key-Status = 1019
                 PERFORM pb-stampanti-LinkTo
              WHEN Key-Status = 1000
                 PERFORM chk-gestisci-1-LinkTo
              WHEN Key-Status = 1015
                 PERFORM chk-pb-bosch-1-LinkTo
              WHEN Key-Status = 1010
                 PERFORM chk-pb-perce-1-LinkTo
              WHEN Key-Status = 1006
                 PERFORM chk-pb-amp-1-LinkTo
              WHEN Key-Status = 1024
                 PERFORM pb-path-logo-1-LinkTo
              WHEN Key-Status = 1020
                 PERFORM pb-stampanti-1-LinkTo
              WHEN Key-Status = 1001
                 PERFORM chk-gestisci-2-LinkTo
              WHEN Key-Status = 1016
                 PERFORM chk-pb-bosch-2-LinkTo
              WHEN Key-Status = 1011
                 PERFORM chk-pb-perce-2-LinkTo
              WHEN Key-Status = 1007
                 PERFORM chk-pb-amp-2-LinkTo
              WHEN Key-Status = 1025
                 PERFORM pb-path-logo-2-LinkTo
              WHEN Key-Status = 1021
                 PERFORM pb-stampanti-2-LinkTo
              WHEN Key-Status = 1002
                 PERFORM chk-gestisci-3-LinkTo
              WHEN Key-Status = 1017
                 PERFORM chk-pb-bosch-3-LinkTo
              WHEN Key-Status = 1012
                 PERFORM chk-pb-perce-3-LinkTo
              WHEN Key-Status = 1008
                 PERFORM chk-pb-amp-3-LinkTo
              WHEN Key-Status = 1026
                 PERFORM pb-path-logo-3-LinkTo
              WHEN Key-Status = 1022
                 PERFORM pb-stampanti-3-LinkTo
              WHEN Key-Status = 1003
                 PERFORM chk-gestisci-4-LinkTo
              WHEN Key-Status = 1018
                 PERFORM chk-pb-bosch-4-LinkTo
              WHEN Key-Status = 1013
                 PERFORM chk-pb-perce-4-LinkTo
              WHEN Key-Status = 1009
                 PERFORM chk-pb-amp-4-LinkTo
              WHEN Key-Status = 1027
                 PERFORM pb-path-logo-4-LinkTo
              WHEN Key-Status = 1023
                 PERFORM pb-stampanti-4-LinkTo
              WHEN Key-Status = 4
                 PERFORM TOOL-CANCELLA-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON form1-handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * GRID
           PERFORM gd-mag-Content
      * GRID
           PERFORM gd-mag-1-Content
      * GRID
           PERFORM gd-mag-2-Content
      * GRID
           PERFORM gd-mag-3-Content
      * GRID
           PERFORM gd-mag-4-Content
      * GRID
           PERFORM gd-tipocli-Content
      * GRID
           PERFORM gd-clienti-Content
      * GRID
           PERFORM gd-gdo-Content
      * GRID
           PERFORM gd-destini-Content
           .

       Form1-Init-Value.
           MOVE titolo TO TOTEM-MSG-TITLE
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           .             

       Form1-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-min-vet1 è l'ID del campo ef-min-vet1
           when 78-ID-ef-min-vet1
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-min-vet2 è l'ID del campo ef-min-vet2
           when 78-ID-ef-min-vet2
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-max-vet è l'ID del campo ef-max-vet
           when 78-ID-ef-max-vet
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-min-vet2-1 è l'ID del campo ef-min-vet2-1
           when 78-ID-ef-min-vet2-1
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-max-vet-1 è l'ID del campo ef-max-vet-1
           when 78-ID-ef-max-vet-1
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-min-vet2-2 è l'ID del campo ef-min-vet2-2
           when 78-ID-ef-min-vet2-2
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-max-vet-2 è l'ID del campo ef-max-vet-2
           when 78-ID-ef-max-vet-2
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-min-vet2-3 è l'ID del campo ef-min-vet2-3
           when 78-ID-ef-min-vet2-3
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-max-vet-3 è l'ID del campo ef-max-vet-3
           when 78-ID-ef-max-vet-3
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-min-vet2-4 è l'ID del campo ef-min-vet2-4
           when 78-ID-ef-min-vet2-4
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-max-vet-4 è l'ID del campo ef-max-vet-4
           when 78-ID-ef-max-vet-4
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-min-vet1 è l'ID del campo ef-min-vet1
           when 78-ID-ef-min-vet1
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-min-vet2 è l'ID del campo ef-min-vet2
           when 78-ID-ef-min-vet2
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-max-vet è l'ID del campo ef-max-vet
           when 78-ID-ef-max-vet
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-min-vet2-1 è l'ID del campo ef-min-vet2-1
           when 78-ID-ef-min-vet2-1
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-max-vet-1 è l'ID del campo ef-max-vet-1
           when 78-ID-ef-max-vet-1
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-min-vet2-2 è l'ID del campo ef-min-vet2-2
           when 78-ID-ef-min-vet2-2
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-max-vet-2 è l'ID del campo ef-max-vet-2
           when 78-ID-ef-max-vet-2
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-min-vet2-3 è l'ID del campo ef-min-vet2-3
           when 78-ID-ef-min-vet2-3
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-max-vet-3 è l'ID del campo ef-max-vet-3
           when 78-ID-ef-max-vet-3
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-min-vet2-4 è l'ID del campo ef-min-vet2-4
           when 78-ID-ef-min-vet2-4
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-max-vet-4 è l'ID del campo ef-max-vet-4
           when 78-ID-ef-max-vet-4
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."

      * Generazione stringa perform CONTROLLO



       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE 78-ini to TOTEM-HINT-TEXT
           WHEN 5002 MOVE 78-parziale to TOTEM-HINT-TEXT
           WHEN 5003 MOVE 78-per-cons to TOTEM-HINT-TEXT
           WHEN 5004 MOVE 78-val to TOTEM-HINT-TEXT
           WHEN 5005 MOVE 78-max to TOTEM-HINT-TEXT
           WHEN 5006 MOVE 78-blocco to TOTEM-HINT-TEXT
           WHEN 5007 MOVE 78-kg-min1 to TOTEM-HINT-TEXT
           WHEN 5008 MOVE 78-vet-min1 to TOTEM-HINT-TEXT
           WHEN 5009 MOVE 78-kg-min2 to TOTEM-HINT-TEXT
           WHEN 5010 MOVE 78-vet-min2 to TOTEM-HINT-TEXT
           WHEN 5011 MOVE 78-kg-max to TOTEM-HINT-TEXT
           WHEN 5012 MOVE 78-vet-max to TOTEM-HINT-TEXT
           WHEN 5013 MOVE 78-accorpa to TOTEM-HINT-TEXT
           WHEN 5014 MOVE 78-promo to TOTEM-HINT-TEXT
           WHEN 5015 MOVE 78-prenot to TOTEM-HINT-TEXT
           WHEN 5016 MOVE 78-banco to TOTEM-HINT-TEXT
           WHEN 5017 MOVE 78-escludi to TOTEM-HINT-TEXT
           WHEN 5018 MOVE 78-imb-minimo to TOTEM-HINT-TEXT
           WHEN 5019 MOVE 78-cod-art-forn to TOTEM-HINT-TEXT
           WHEN 5020 MOVE 78-pb-amp-bosch to TOTEM-HINT-TEXT
           WHEN 5021 MOVE 78-pb-perce to TOTEM-HINT-TEXT
           WHEN 5022 MOVE 78-pb-amp to TOTEM-HINT-TEXT
           WHEN 5023 MOVE 78-pb-sost-batt to TOTEM-HINT-TEXT
           WHEN 5024 MOVE 78-mag to TOTEM-HINT-TEXT
           WHEN 5026 MOVE 78-logo-pers to TOTEM-HINT-TEXT
           WHEN 5027 MOVE 78-path-logo to TOTEM-HINT-TEXT
           WHEN 5029 MOVE 78-ini to TOTEM-HINT-TEXT
           WHEN 5030 MOVE 78-parziale to TOTEM-HINT-TEXT
           WHEN 5031 MOVE 78-per-cons to TOTEM-HINT-TEXT
           WHEN 5032 MOVE 78-val to TOTEM-HINT-TEXT
           WHEN 5033 MOVE 78-max to TOTEM-HINT-TEXT
           WHEN 5034 MOVE 78-blocco to TOTEM-HINT-TEXT
           WHEN 5035 MOVE 78-kg-min1 to TOTEM-HINT-TEXT
           WHEN 5036 MOVE 78-vet-min1 to TOTEM-HINT-TEXT
           WHEN 5037 MOVE 78-kg-min2 to TOTEM-HINT-TEXT
           WHEN 5038 MOVE 78-vet-min2 to TOTEM-HINT-TEXT
           WHEN 5039 MOVE 78-kg-max to TOTEM-HINT-TEXT
           WHEN 5040 MOVE 78-vet-max to TOTEM-HINT-TEXT
           WHEN 5041 MOVE 78-accorpa to TOTEM-HINT-TEXT
           WHEN 5042 MOVE 78-promo to TOTEM-HINT-TEXT
           WHEN 5043 MOVE 78-prenot to TOTEM-HINT-TEXT
           WHEN 5044 MOVE 78-banco to TOTEM-HINT-TEXT
           WHEN 5045 MOVE 78-escludi to TOTEM-HINT-TEXT
           WHEN 5046 MOVE 78-imb-minimo to TOTEM-HINT-TEXT
           WHEN 5047 MOVE 78-cod-art-forn to TOTEM-HINT-TEXT
           WHEN 80 MOVE 78-pb-amp to TOTEM-HINT-TEXT
           WHEN 5048 MOVE 78-pb-perce to TOTEM-HINT-TEXT
           WHEN 5049 MOVE 78-pb-amp to TOTEM-HINT-TEXT
           WHEN 5050 MOVE 78-pb-sost-batt to TOTEM-HINT-TEXT
           WHEN 5051 MOVE 78-mag to TOTEM-HINT-TEXT
           WHEN 5053 MOVE 78-logo-pers to TOTEM-HINT-TEXT
           WHEN 5054 MOVE 78-path-logo to TOTEM-HINT-TEXT
           WHEN 5056 MOVE 78-ini to TOTEM-HINT-TEXT
           WHEN 5057 MOVE 78-parziale to TOTEM-HINT-TEXT
           WHEN 5058 MOVE 78-per-cons to TOTEM-HINT-TEXT
           WHEN 5059 MOVE 78-val to TOTEM-HINT-TEXT
           WHEN 5060 MOVE 78-max to TOTEM-HINT-TEXT
           WHEN 5061 MOVE 78-blocco to TOTEM-HINT-TEXT
           WHEN 5062 MOVE 78-kg-min1 to TOTEM-HINT-TEXT
           WHEN 5063 MOVE 78-vet-min1 to TOTEM-HINT-TEXT
           WHEN 5064 MOVE 78-kg-min2 to TOTEM-HINT-TEXT
           WHEN 5065 MOVE 78-vet-min2 to TOTEM-HINT-TEXT
           WHEN 5066 MOVE 78-kg-max to TOTEM-HINT-TEXT
           WHEN 5067 MOVE 78-vet-max to TOTEM-HINT-TEXT
           WHEN 5068 MOVE 78-accorpa to TOTEM-HINT-TEXT
           WHEN 5069 MOVE 78-promo to TOTEM-HINT-TEXT
           WHEN 5070 MOVE 78-prenot to TOTEM-HINT-TEXT
           WHEN 5071 MOVE 78-banco to TOTEM-HINT-TEXT
           WHEN 5072 MOVE 78-escludi to TOTEM-HINT-TEXT
           WHEN 5073 MOVE 78-imb-minimo to TOTEM-HINT-TEXT
           WHEN 5074 MOVE 78-cod-art-forn to TOTEM-HINT-TEXT
           WHEN 123 MOVE 78-pb-amp to TOTEM-HINT-TEXT
           WHEN 5075 MOVE 78-pb-perce to TOTEM-HINT-TEXT
           WHEN 5076 MOVE 78-pb-amp to TOTEM-HINT-TEXT
           WHEN 5077 MOVE 78-pb-sost-batt to TOTEM-HINT-TEXT
           WHEN 5078 MOVE 78-mag to TOTEM-HINT-TEXT
           WHEN 150 MOVE 78-logo-pers to TOTEM-HINT-TEXT
           WHEN 152 MOVE 78-path-logo to TOTEM-HINT-TEXT
           WHEN 5081 MOVE 78-parziale to TOTEM-HINT-TEXT
           WHEN 5082 MOVE 78-per-cons to TOTEM-HINT-TEXT
           WHEN 5083 MOVE 78-val to TOTEM-HINT-TEXT
           WHEN 5084 MOVE 78-max to TOTEM-HINT-TEXT
           WHEN 5085 MOVE 78-blocco to TOTEM-HINT-TEXT
           WHEN 5086 MOVE 78-kg-min1 to TOTEM-HINT-TEXT
           WHEN 5087 MOVE 78-vet-min1 to TOTEM-HINT-TEXT
           WHEN 5088 MOVE 78-kg-min2 to TOTEM-HINT-TEXT
           WHEN 5089 MOVE 78-vet-min2 to TOTEM-HINT-TEXT
           WHEN 5090 MOVE 78-kg-max to TOTEM-HINT-TEXT
           WHEN 5091 MOVE 78-vet-max to TOTEM-HINT-TEXT
           WHEN 5092 MOVE 78-accorpa to TOTEM-HINT-TEXT
           WHEN 5093 MOVE 78-promo to TOTEM-HINT-TEXT
           WHEN 5094 MOVE 78-prenot to TOTEM-HINT-TEXT
           WHEN 5095 MOVE 78-banco to TOTEM-HINT-TEXT
           WHEN 5096 MOVE 78-escludi to TOTEM-HINT-TEXT
           WHEN 5097 MOVE 78-imb-minimo to TOTEM-HINT-TEXT
           WHEN 5098 MOVE 78-cod-art-forn to TOTEM-HINT-TEXT
           WHEN 177 MOVE 78-pb-amp to TOTEM-HINT-TEXT
           WHEN 5099 MOVE 78-pb-perce to TOTEM-HINT-TEXT
           WHEN 5100 MOVE 78-pb-amp to TOTEM-HINT-TEXT
           WHEN 5101 MOVE 78-pb-sost-batt to TOTEM-HINT-TEXT
           WHEN 5102 MOVE 78-mag to TOTEM-HINT-TEXT
           WHEN 5104 MOVE 78-logo-pers to TOTEM-HINT-TEXT
           WHEN 5105 MOVE 78-path-logo to TOTEM-HINT-TEXT
           WHEN 5107 MOVE 78-parziale to TOTEM-HINT-TEXT
           WHEN 5108 MOVE 78-per-cons to TOTEM-HINT-TEXT
           WHEN 5109 MOVE 78-val to TOTEM-HINT-TEXT
           WHEN 5110 MOVE 78-max to TOTEM-HINT-TEXT
           WHEN 5111 MOVE 78-blocco to TOTEM-HINT-TEXT
           WHEN 5112 MOVE 78-kg-min1 to TOTEM-HINT-TEXT
           WHEN 5113 MOVE 78-vet-min1 to TOTEM-HINT-TEXT
           WHEN 5114 MOVE 78-kg-min2 to TOTEM-HINT-TEXT
           WHEN 5115 MOVE 78-vet-min2 to TOTEM-HINT-TEXT
           WHEN 5116 MOVE 78-kg-max to TOTEM-HINT-TEXT
           WHEN 5117 MOVE 78-vet-max to TOTEM-HINT-TEXT
           WHEN 5118 MOVE 78-accorpa to TOTEM-HINT-TEXT
           WHEN 5119 MOVE 78-promo to TOTEM-HINT-TEXT
           WHEN 5120 MOVE 78-prenot to TOTEM-HINT-TEXT
           WHEN 5121 MOVE 78-banco to TOTEM-HINT-TEXT
           WHEN 5122 MOVE 78-escludi to TOTEM-HINT-TEXT
           WHEN 5123 MOVE 78-imb-minimo to TOTEM-HINT-TEXT
           WHEN 5124 MOVE 78-cod-art-forn to TOTEM-HINT-TEXT
           WHEN 230 MOVE 78-pb-amp to TOTEM-HINT-TEXT
           WHEN 5125 MOVE 78-pb-perce to TOTEM-HINT-TEXT
           WHEN 5126 MOVE 78-pb-amp to TOTEM-HINT-TEXT
           WHEN 5127 MOVE 78-pb-sost-batt to TOTEM-HINT-TEXT
           WHEN 5128 MOVE 78-mag to TOTEM-HINT-TEXT
           WHEN 5130 MOVE 78-logo-pers to TOTEM-HINT-TEXT
           WHEN 5131 MOVE 78-path-logo to TOTEM-HINT-TEXT
           WHEN 5132 MOVE "Tipologia Clienti" to TOTEM-HINT-TEXT
           WHEN 5133 MOVE "Clienti" to TOTEM-HINT-TEXT
           WHEN 5134 MOVE "Gruppi GDO" to TOTEM-HINT-TEXT
           WHEN 5135 MOVE "Destini" to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-ini-vol-BeforeProcedure
           When 5002 PERFORM ef-parz-BeforeProcedure
           When 5003 PERFORM ef-gg-cons-BeforeProcedure
           When 5004 PERFORM ef-val-BeforeProcedure
           When 5005 PERFORM ef-cons-max-BeforeProcedure
           When 5006 PERFORM ef-blocco-kg-BeforeProcedure
           When 5007 PERFORM ef-min-kg-BeforeProcedure
           When 5008 PERFORM ef-min-vet-30kg-BeforeProcedure
           When 5009 PERFORM ef-min-kg-BeforeProcedure
           When 5010 PERFORM ef-min-vet-BeforeProcedure
           When 5011 PERFORM ef-max-kg-BeforeProcedure
           When 5012 PERFORM ef-max-vet-BeforeProcedure
           When 5013 PERFORM chk-accorpa-BeforeProcedure
           When 5014 PERFORM chk-promo-BeforeProcedure
           When 5015 PERFORM chk-intera-BeforeProcedure
           When 5016 PERFORM chk-banco-BeforeProcedure
           When 5017 PERFORM chk-intera-BeforeProcedure
           When 5018 PERFORM chk-banco-BeforeProcedure
           When 5019 PERFORM chk-banco-BeforeProcedure
           When 5020 PERFORM chk-pb-bosch-BeforeProcedure
           When 5021 PERFORM chk-pb-perce-BeforeProcedure
           When 5022 PERFORM chk-pb-amp-BeforeProcedure
           When 5023 PERFORM chk-sost-batt-BeforeProcedure
           When 5026 PERFORM chk-pb-perce-BeforeProcedure
           When 5027 PERFORM ef-path-logo-BeforeProcedure
           When 5029 PERFORM ef-ini-vol-1-BeforeProcedure
           When 5030 PERFORM ef-parz-1-BeforeProcedure
           When 5031 PERFORM ef-gg-cons-1-BeforeProcedure
           When 5032 PERFORM ef-val-1-BeforeProcedure
           When 5033 PERFORM ef-cons-max-1-BeforeProcedure
           When 5034 PERFORM ef-blocco-kg-1-BeforeProcedure
           When 5035 PERFORM ef-min-kg-1-BeforeProcedure
           When 5036 PERFORM ef-min-vet-30kg-1-BeforeProcedure
           When 5037 PERFORM ef-min-kg-1-BeforeProcedure
           When 5038 PERFORM ef-min-vet-1-BeforeProcedure
           When 5039 PERFORM ef-max-kg-1-BeforeProcedure
           When 5040 PERFORM ef-max-vet-1-BeforeProcedure
           When 5041 PERFORM chk-accorpa-1-BeforeProcedure
           When 5042 PERFORM chk-promoa-BeforeProcedure
           When 5043 PERFORM chk-intera-1-BeforeProcedure
           When 5044 PERFORM chk-banco-1-BeforeProcedure
           When 5045 PERFORM chk-intera-BeforeProcedure
           When 5046 PERFORM chk-banco-BeforeProcedure
           When 5047 PERFORM chk-banco-BeforeProcedure
           When 80 PERFORM chk-pb-bosch-1-BeforeProcedure
           When 5048 PERFORM chk-pb-perce-1-BeforeProcedure
           When 5049 PERFORM chk-pb-amp-1-BeforeProcedure
           When 5050 PERFORM chk-sost-batt-1-BeforeProcedure
           When 5053 PERFORM chk-pb-perce-BeforeProcedure
           When 5054 PERFORM ef-path-logoa-BeforeProcedure
           When 5056 PERFORM ef-ini-vol-2-BeforeProcedure
           When 5057 PERFORM ef-parz-2-BeforeProcedure
           When 5058 PERFORM ef-gg-cons-2-BeforeProcedure
           When 5059 PERFORM ef-val-2-BeforeProcedure
           When 5060 PERFORM ef-cons-max-2-BeforeProcedure
           When 5061 PERFORM ef-blocco-kg-2-BeforeProcedure
           When 5062 PERFORM ef-min-kg-2-BeforeProcedure
           When 5063 PERFORM ef-min-vet-30kg-2-BeforeProcedure
           When 5064 PERFORM ef-min-kg-2-BeforeProcedure
           When 5065 PERFORM ef-min-vet-2-BeforeProcedure
           When 5066 PERFORM ef-max-kg-2-BeforeProcedure
           When 5067 PERFORM ef-max-vet-2-BeforeProcedure
           When 5068 PERFORM chk-accorpa-2-BeforeProcedure
           When 5069 PERFORM chk-promo-2-BeforeProcedure
           When 5070 PERFORM chk-intera-2-BeforeProcedure
           When 5071 PERFORM chk-banco-2-BeforeProcedure
           When 5072 PERFORM chk-intera-BeforeProcedure
           When 5073 PERFORM chk-banco-BeforeProcedure
           When 5074 PERFORM chk-banco-BeforeProcedure
           When 123 PERFORM chk-pb-bosch-2-BeforeProcedure
           When 5075 PERFORM chk-pb-perce-2-BeforeProcedure
           When 5076 PERFORM chk-pb-amp-2-BeforeProcedure
           When 5077 PERFORM chk-sost-batt-2-BeforeProcedure
           When 150 PERFORM chk-pb-perce-BeforeProcedure
           When 152 PERFORM ef-path-logoa-BeforeProcedure
           When 5081 PERFORM ef-parz-3-BeforeProcedure
           When 5082 PERFORM ef-gg-cons-3-BeforeProcedure
           When 5083 PERFORM ef-val-3-BeforeProcedure
           When 5084 PERFORM ef-cons-max-3-BeforeProcedure
           When 5085 PERFORM ef-blocco-kg-3-BeforeProcedure
           When 5086 PERFORM ef-min-kg-3-BeforeProcedure
           When 5087 PERFORM ef-min-vet-30kg-3-BeforeProcedure
           When 5088 PERFORM ef-min-kg-3-BeforeProcedure
           When 5089 PERFORM ef-min-vet-3-BeforeProcedure
           When 5090 PERFORM ef-max-kg-3-BeforeProcedure
           When 5091 PERFORM ef-max-vet-3-BeforeProcedure
           When 5092 PERFORM chk-accorpa-3-BeforeProcedure
           When 5093 PERFORM chk-promo-3-BeforeProcedure
           When 5094 PERFORM chk-intera-3-BeforeProcedure
           When 5095 PERFORM chk-banco-3-BeforeProcedure
           When 5096 PERFORM chk-intera-BeforeProcedure
           When 5097 PERFORM chk-banco-BeforeProcedure
           When 5098 PERFORM chk-banco-BeforeProcedure
           When 177 PERFORM chk-pb-bosch-3-BeforeProcedure
           When 5099 PERFORM chk-pb-perce-3-BeforeProcedure
           When 5100 PERFORM chk-pb-amp-3-BeforeProcedure
           When 5101 PERFORM chk-sost-batt-3-BeforeProcedure
           When 5104 PERFORM chk-pb-perce-BeforeProcedure
           When 5105 PERFORM ef-path-logoa-BeforeProcedure
           When 5107 PERFORM ef-parz-4-BeforeProcedure
           When 5108 PERFORM ef-gg-cons-4-BeforeProcedure
           When 5109 PERFORM ef-val-4-BeforeProcedure
           When 5110 PERFORM ef-cons-max-4-BeforeProcedure
           When 5111 PERFORM ef-blocco-kg-4-BeforeProcedure
           When 5112 PERFORM ef-min-kg-4-BeforeProcedure
           When 5113 PERFORM ef-min-vet-30kg-4-BeforeProcedure
           When 5114 PERFORM ef-min-kg-4-BeforeProcedure
           When 5115 PERFORM ef-min-vet-4-BeforeProcedure
           When 5116 PERFORM ef-max-kg-4-BeforeProcedure
           When 5117 PERFORM ef-max-vet-4-BeforeProcedure
           When 5118 PERFORM chk-accorpa-4-BeforeProcedure
           When 5119 PERFORM chk-promo-4-BeforeProcedure
           When 5120 PERFORM chk-intera-4-BeforeProcedure
           When 5121 PERFORM chk-banco-4-BeforeProcedure
           When 5122 PERFORM chk-intera-BeforeProcedure
           When 5123 PERFORM chk-banco-BeforeProcedure
           When 5124 PERFORM chk-banco-BeforeProcedure
           When 230 PERFORM chk-pb-bosch-4-BeforeProcedure
           When 5125 PERFORM chk-pb-perce-4-BeforeProcedure
           When 5126 PERFORM chk-pb-amp-4-BeforeProcedure
           When 5127 PERFORM chk-sost-batt-4-BeforeProcedure
           When 5130 PERFORM chk-pb-perce-BeforeProcedure
           When 5131 PERFORM ef-path-logoa-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Screen1-Gd-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 5024 ALSO
                    form1-handle 
              PERFORM gd-mag-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5024 ALSO
                    form1-handle 
              PERFORM gd-mag-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5024 ALSO
                    form1-handle 
              PERFORM gd-mag-Ev-Msg-End-Drag
           WHEN Msg-Finish-Entry ALSO 5024 ALSO
                    form1-handle 
              PERFORM gd-mag-Ev-Msg-Finish-Entry
           WHEN Msg-Goto-Cell ALSO 5024 ALSO
                    form1-handle 
              PERFORM gd-mag-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5024 ALSO
                    form1-handle 
              PERFORM gd-mag-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5024 ALSO
                    form1-handle 
              PERFORM gd-mag-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5051 ALSO
                    form1-handle 
              PERFORM gd-mag-1-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5051 ALSO
                    form1-handle 
              PERFORM gd-mag-1-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5051 ALSO
                    form1-handle 
              PERFORM gd-mag-1-Ev-Msg-End-Drag
           WHEN Msg-Finish-Entry ALSO 5051 ALSO
                    form1-handle 
              PERFORM gd-mag-1-Ev-Msg-Finish-Entry
           WHEN Msg-Goto-Cell ALSO 5051 ALSO
                    form1-handle 
              PERFORM gd-mag-1-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5051 ALSO
                    form1-handle 
              PERFORM gd-mag-1-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5051 ALSO
                    form1-handle 
              PERFORM gd-mag-1-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5078 ALSO
                    form1-handle 
              PERFORM gd-mag-2-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5078 ALSO
                    form1-handle 
              PERFORM gd-mag-2-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5078 ALSO
                    form1-handle 
              PERFORM gd-mag-2-Ev-Msg-End-Drag
           WHEN Msg-Finish-Entry ALSO 5078 ALSO
                    form1-handle 
              PERFORM gd-mag-2-Ev-Msg-Finish-Entry
           WHEN Msg-Goto-Cell ALSO 5078 ALSO
                    form1-handle 
              PERFORM gd-mag-2-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5078 ALSO
                    form1-handle 
              PERFORM gd-mag-2-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5078 ALSO
                    form1-handle 
              PERFORM gd-mag-2-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5102 ALSO
                    form1-handle 
              PERFORM gd-mag-3-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5102 ALSO
                    form1-handle 
              PERFORM gd-mag-3-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5102 ALSO
                    form1-handle 
              PERFORM gd-mag-3-Ev-Msg-End-Drag
           WHEN Msg-Finish-Entry ALSO 5102 ALSO
                    form1-handle 
              PERFORM gd-mag-3-Ev-Msg-Finish-Entry
           WHEN Msg-Goto-Cell ALSO 5102 ALSO
                    form1-handle 
              PERFORM gd-mag-3-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5102 ALSO
                    form1-handle 
              PERFORM gd-mag-3-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5102 ALSO
                    form1-handle 
              PERFORM gd-mag-3-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5128 ALSO
                    form1-handle 
              PERFORM gd-mag-4-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5128 ALSO
                    form1-handle 
              PERFORM gd-mag-4-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5128 ALSO
                    form1-handle 
              PERFORM gd-mag-4-Ev-Msg-End-Drag
           WHEN Msg-Finish-Entry ALSO 5128 ALSO
                    form1-handle 
              PERFORM gd-mag-4-Ev-Msg-Finish-Entry
           WHEN Msg-Goto-Cell ALSO 5128 ALSO
                    form1-handle 
              PERFORM gd-mag-4-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5128 ALSO
                    form1-handle 
              PERFORM gd-mag-4-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5128 ALSO
                    form1-handle 
              PERFORM gd-mag-4-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5132 ALSO
                    form1-handle 
              PERFORM gd-tipocli-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5132 ALSO
                    form1-handle 
              PERFORM gd-tipocli-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5132 ALSO
                    form1-handle 
              PERFORM gd-tipocli-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5132 ALSO
                    form1-handle 
              PERFORM gd-tipocli-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5132 ALSO
                    form1-handle 
              PERFORM gd-tipocli-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5132 ALSO
                    form1-handle 
              PERFORM gd-tipocli-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5133 ALSO
                    form1-handle 
              PERFORM gd-clienti-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5133 ALSO
                    form1-handle 
              PERFORM gd-clienti-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5133 ALSO
                    form1-handle 
              PERFORM gd-clienti-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5133 ALSO
                    form1-handle 
              PERFORM gd-clienti-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5133 ALSO
                    form1-handle 
              PERFORM gd-clienti-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5133 ALSO
                    form1-handle 
              PERFORM gd-clienti-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5134 ALSO
                    form1-handle 
              PERFORM gd-gdo-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5134 ALSO
                    form1-handle 
              PERFORM gd-gdo-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5134 ALSO
                    form1-handle 
              PERFORM gd-gdo-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5134 ALSO
                    form1-handle 
              PERFORM gd-gdo-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5134 ALSO
                    form1-handle 
              PERFORM gd-gdo-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5134 ALSO
                    form1-handle 
              PERFORM gd-gdo-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Drag ALSO 5135 ALSO
                    form1-handle 
              PERFORM gd-destini-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5135 ALSO
                    form1-handle 
              PERFORM gd-destini-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5135 ALSO
                    form1-handle 
              PERFORM gd-destini-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 5135 ALSO
                    form1-handle 
              PERFORM gd-destini-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5135 ALSO
                    form1-handle 
              PERFORM gd-destini-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5135 ALSO
                    form1-handle 
              PERFORM gd-destini-Ev-Msg-Goto-Cell-Mouse
           END-EVALUATE
           .

      * USER DEFINE PARAGRAPH
       ABILITAZIONI.
      * <TOTEM:PARA. ABILITAZIONI>
           if mod = 1
              move BitmapDeleteEnabled to BitmapNumDelete
              move BitmapSaveEnabled   to BitmapNumSave
              move 1 to e-salva
           else
              move BitmapDeleteDisabled to BitmapNumDelete
              move BitmapSaveDisabled   to BitmapNumSave
              move 0 to e-salva
           end-if.            
 
           move 0 to e-cancella.
           move BitmapDeleteDisabled to BitmapNumDelete.

           modify tool-cancella, enabled = e-cancella.
           modify tool-salva,    enabled = e-salva.
           display tool-nuovo, tool-salva, tool-cancella, tool-modifica 
           .
      * <TOTEM:END>

       CERCA.
      * <TOTEM:PARA. CERCA>
           evaluate control-id 
           when 78-ID-ef-min-vet1
                move "tvettori"        to como-file
                inquire ef-min-vet1, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet1-buf
                   move vet-sigla  to lab-vet-min1-buf
                   display ef-min-vet1 lab-vet-min1
                end-if         

           when 78-ID-ef-min-vet2
                move "tvettori"        to como-file
                inquire ef-min-vet2, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet2-buf
                   move vet-sigla  to lab-vet-min2-buf
                   display ef-min-vet2 lab-vet-min2
                end-if

           when 78-ID-ef-max-vet
                move "tvettori"        to como-file
                inquire ef-max-vet, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-max-vet-buf
                   move vet-sigla  to lab-vet-max-buf
                   display ef-max-vet lab-vet-max
                end-if                  

           when 78-ID-ef-min-vet1-1
                move "tvettori"        to como-file
                inquire ef-min-vet1-1, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet1-1-buf
                   move vet-sigla  to lab-vet-min1-1-buf
                   display ef-min-vet1-1 lab-vet-min1-1
                end-if

           when 78-ID-ef-min-vet2-1
                move "tvettori"        to como-file
                inquire ef-min-vet2-1, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet2-1-buf
                   move vet-sigla  to lab-vet-min2-1-buf
                   display ef-min-vet2-1 lab-vet-min2-1
                end-if

           when 78-ID-ef-max-vet-1
                move "tvettori"        to como-file
                inquire ef-max-vet-1, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-max-vet-1-buf
                   move vet-sigla  to lab-vet-max-1-buf
                   display ef-max-vet-1 lab-vet-max-1
                end-if                  

           when 78-ID-ef-min-vet1-2
                move "tvettori"        to como-file
                inquire ef-min-vet1-2, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet1-2-buf
                   move vet-sigla  to lab-vet-min1-2-buf
                   display ef-min-vet1-2 lab-vet-min1-2
                end-if

           when 78-ID-ef-min-vet2-2
                move "tvettori"        to como-file
                inquire ef-min-vet2-2, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet2-2-buf
                   move vet-sigla  to lab-vet-min2-2-buf
                   display ef-min-vet2-2 lab-vet-min2-2
                end-if

           when 78-ID-ef-max-vet-2
                move "tvettori"        to como-file
                inquire ef-max-vet-2, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-max-vet-2-buf
                   move vet-sigla  to lab-vet-max-2-buf
                   display ef-max-vet-2 lab-vet-max-2
                end-if                  

           when 78-ID-ef-min-vet1-3
                move "tvettori"        to como-file
                inquire ef-min-vet1-3, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet1-3-buf
                   move vet-sigla  to lab-vet-min1-3-buf
                   display ef-min-vet1-3 lab-vet-min1-3
                end-if

           when 78-ID-ef-min-vet2-3
                move "tvettori"        to como-file
                inquire ef-min-vet2-3, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet2-3-buf
                   move vet-sigla  to lab-vet-min2-3-buf
                   display ef-min-vet2-3 lab-vet-min2-3
                end-if

           when 78-ID-ef-max-vet-3
                move "tvettori"        to como-file
                inquire ef-max-vet-3, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-max-vet-3-buf
                   move vet-sigla  to lab-vet-max-3-buf
                   display ef-max-vet-3 lab-vet-max-3
                end-if                             

           when 78-ID-ef-min-vet1-4
                move "tvettori"        to como-file
                inquire ef-min-vet1-4, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet1-4-buf
                   move vet-sigla  to lab-vet-min1-4-buf
                   display ef-min-vet1-4 lab-vet-min1-4
                end-if                             

           when 78-ID-ef-min-vet2-4
                move "tvettori"        to como-file
                inquire ef-min-vet2-4, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-min-vet2-4-buf
                   move vet-sigla  to lab-vet-min2-4-buf
                   display ef-min-vet2-4 lab-vet-min2-4
                end-if                             

           when 78-ID-ef-max-vet-4
                move "tvettori"        to como-file
                inquire ef-max-vet-4, value vet-codice
                call "zoom-gt"   using como-file, vet-rec
                                giving stato-zoom
                end-call
                cancel "zoom-gt"
                if stato-zoom = 0
                   move vet-codice to ef-max-vet-4-buf
                   move vet-sigla  to lab-vet-max-4-buf
                   display ef-max-vet-4 lab-vet-max-4
                end-if
           end-evaluate 
           .
      * <TOTEM:END>

       CONTROLLA-KG.
      * <TOTEM:PARA. CONTROLLA-KG>
           if como-min-kg1 not = 0 and como-min-kg2 not = 0
              if como-min-kg1 >= como-min-kg2
                 set errori to true
                 display message "Scaglioni KG errato"
                           title tit-err
                            icon 2
              end-if
           end-if 
           .
      * <TOTEM:END>

       CONTROLLO.
      * <TOTEM:PARA. CONTROLLO>
           set tutto-ok to true.

           evaluate control-id      
           when 78-ID-ef-min-kg1
                inquire ef-min-kg1, value in como-min-kg1
                inquire ef-min-kg2, value in como-min-kg2
                perform CONTROLLA-KG

           when 78-ID-ef-min-vet1
                inquire ef-min-vet1, value in ef-min-vet1-buf
                move ef-min-vet1-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min1-buf
                display lab-vet-min1

           when 78-ID-ef-min-kg2
                inquire ef-min-kg1, value in como-min-kg1
                inquire ef-min-kg2, value in como-min-kg2
                perform CONTROLLA-KG

           when 78-ID-ef-min-vet2
                inquire ef-min-vet2, value in ef-min-vet2-buf
                move ef-min-vet2-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min2-buf
                display lab-vet-min2

           when 78-ID-ef-max-vet
                inquire ef-max-vet, value in ef-max-vet-buf
                move ef-max-vet-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-max-buf
                display lab-vet-max  

           when 78-ID-ef-stampante
                inquire ef-stampante, value in ef-stampante-buf
                if ef-stampante-buf = spaces
                   set errori to true
                   display message "Stampante obbligatoria"
                             title tit-err
                              icon 2
                end-if            

           when 78-ID-ef-min-kg1-1
                inquire ef-min-kg1-1, value in como-min-kg1
                inquire ef-min-kg2-1, value in como-min-kg2
                perform CONTROLLA-KG            

           when 78-ID-ef-min-vet1-1
                inquire ef-min-vet1-1, value in ef-min-vet1-1-buf
                move ef-min-vet1-1-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min1-1-buf
                display lab-vet-min1-1

           when 78-ID-ef-min-kg2-1
                inquire ef-min-kg2-1, value in como-min-kg1
                inquire ef-min-kg2-1, value in como-min-kg2
                perform CONTROLLA-KG

           when 78-ID-ef-min-vet2-1
                inquire ef-min-vet2-1, value in ef-min-vet2-1-buf
                move ef-min-vet2-1-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min2-1-buf
                display lab-vet-min2-1

           when 78-ID-ef-max-vet-1
                inquire ef-max-vet-1, value in ef-max-vet-1-buf
                move ef-max-vet-1-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-max-1-buf
                display lab-vet-max-1       

           when 78-ID-ef-stampante-1
                inquire ef-stampante-1, value in ef-stampante-1-buf
                if ef-stampante-1-buf = spaces and 
                   chk-gestisci-1-buf = 1
                   set errori to true
                   display message "Stampante obbligatoria"
                             title tit-err
                              icon 2
                end-if            

           when 78-ID-ef-min-kg1-2
                inquire ef-min-kg1-2, value in como-min-kg1
                inquire ef-min-kg2-2, value in como-min-kg2
                perform CONTROLLA-KG            

           when 78-ID-ef-min-vet1-2
                inquire ef-min-vet1-2, value in ef-min-vet1-2-buf
                move ef-min-vet1-2-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min1-2-buf
                display lab-vet-min1-2

           when 78-ID-ef-min-kg2-2
                inquire ef-min-kg1-2, value in como-min-kg1
                inquire ef-min-kg2-2, value in como-min-kg2
                perform CONTROLLA-KG

           when 78-ID-ef-min-vet2-2
                inquire ef-min-vet2-2, value in ef-min-vet2-2-buf
                move ef-min-vet2-2-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min2-2-buf
                display lab-vet-min2-2

           when 78-ID-ef-max-vet-2
                inquire ef-max-vet-2, value in ef-max-vet-2-buf
                move ef-max-vet-2-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-max-2-buf
                display lab-vet-max-2       

           when 78-ID-ef-stampante-2
                inquire ef-stampante-2, value in ef-stampante-2-buf
                if ef-stampante-2-buf = spaces and 
                   chk-gestisci-2-buf = 2
                   set errori to true
                   display message "Stampante obbligatoria"
                             title tit-err
                              icon 2
                end-if              

           when 78-ID-ef-min-kg1-3
                inquire ef-min-kg1-3, value in como-min-kg1
                inquire ef-min-kg2-3, value in como-min-kg2
                perform CONTROLLA-KG          

           when 78-ID-ef-min-vet1-3
                inquire ef-min-vet1-3, value in ef-min-vet1-3-buf
                move ef-min-vet1-3-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min1-3-buf
                display lab-vet-min1-3

           when 78-ID-ef-min-kg2-3
                inquire ef-min-kg1-3, value in como-min-kg1
                inquire ef-min-kg2-3, value in como-min-kg2
                perform CONTROLLA-KG

           when 78-ID-ef-min-vet2-3
                inquire ef-min-vet2-3, value in ef-min-vet2-3-buf
                move ef-min-vet2-3-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min2-3-buf
                display lab-vet-min2-3

           when 78-ID-ef-max-vet-3
                inquire ef-max-vet-3, value in ef-max-vet-3-buf
                move ef-max-vet-3-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-max-3-buf
                display lab-vet-max-3    

           when 78-ID-ef-stampante-3
                inquire ef-stampante-3, value in ef-stampante-3-buf
                if ef-stampante-3-buf = spaces and 
                   chk-gestisci-3-buf = 1
                   set errori to true
                   display message "Stampante obbligatoria"
                             title tit-err
                              icon 2
                end-if              

           when 78-ID-ef-min-kg1-4
                inquire ef-min-kg1-4, value in como-min-kg1
                inquire ef-min-kg2-4, value in como-min-kg2
                perform CONTROLLA-KG  

           when 78-ID-ef-min-vet1-4
                inquire ef-min-vet1-4, value in ef-min-vet1-4-buf
                move ef-min-vet1-4-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min1-4-buf
                display lab-vet-min1-4

           when 78-ID-ef-min-kg2-4
                inquire ef-min-kg1-4, value in como-min-kg1
                inquire ef-min-kg2-4, value in como-min-kg2
                perform CONTROLLA-KG

           when 78-ID-ef-min-vet2-4
                inquire ef-min-vet2-4, value in ef-min-vet2-4-buf
                move ef-min-vet2-4-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-min2-4-buf
                display lab-vet-min2-4

           when 78-ID-ef-max-vet-4
                inquire ef-max-vet-4, value in ef-max-vet-4-buf
                move ef-max-vet-4-buf to vet-codice
                if vet-codice = 0
                   move "DIR" to vet-sigla
                else
                   read tvettori no lock
                        invalid 
                        set errori to true
                        display message "Vettore NON valido"
                                  title tit-err
                                   icon 2
                        move spaces to vet-sigla
                   end-read
                end-if
                move vet-sigla to lab-vet-max-4-buf
                display lab-vet-max-4 

           when 78-ID-ef-stampante-4
                inquire ef-stampante-4, value in ef-stampante-4-buf
                if ef-stampante-4-buf = spaces and 
                   chk-gestisci-4-buf = 1
                   set errori to true
                   display message "Stampante obbligatoria"
                             title tit-err
                              icon 2
                end-if

           when 78-ID-chk-pb-amp
                inquire chk-pb-perce,  value in chk-pb-perce-buf
                inquire chk-pb-amp,    value in chk-pb-amp-buf
                inquire chk-pb-bosch,  value in chk-pb-bosch-buf
                if ( chk-pb-amp-buf   + 
                     chk-pb-perce-buf + 
                     chk-pb-bosch-buf ) = 0
                   set errori to true  
                   move 78-ID-chk-pb-perce to control-id
                   display message "Selezionare almeno un tipo di calcol
      -    "o addizionale"
                             title tit-err
                               icon 2
                end-if 

           when 78-ID-chk-pb-amp-1
                inquire chk-pb-perce-1, value in chk-pb-perce-1-buf
                inquire chk-pb-amp-1,   value in chk-pb-amp-1-buf
                inquire chk-pb-bosch-1, value in chk-pb-bosch-1-buf
                if ( chk-pb-amp-1-buf   + 
                     chk-pb-perce-1-buf + 
                     chk-pb-bosch-1-buf ) = 0
                   set errori to true
                   move 78-ID-chk-pb-perce-1 to control-id
                   display message "Selezionare almeno un tipo di calcol
      -    "o addizionale"
                             title tit-err
                               icon 2
                end-if

           when 78-ID-chk-pb-amp-2
                inquire chk-pb-perce-2, value in chk-pb-perce-2-buf
                inquire chk-pb-amp-2,   value in chk-pb-amp-2-buf
                inquire chk-pb-bosch-2, value in chk-pb-bosch-2-buf
                if ( chk-pb-amp-2-buf   + 
                     chk-pb-perce-2-buf + 
                     chk-pb-bosch-2-buf ) = 0
                   set errori to true   
                   move 78-ID-chk-pb-perce-2 to control-id
                   display message "Selezionare almeno un tipo di calcol
      -    "o addizionale"
                             title tit-err
                               icon 2
                end-if

           when 78-ID-chk-pb-amp-3
                inquire chk-pb-perce-3, value in chk-pb-perce-3-buf
                inquire chk-pb-amp-3,   value in chk-pb-amp-3-buf
                inquire chk-pb-bosch-3, value in chk-pb-bosch-3-buf
                if ( chk-pb-amp-3-buf   + 
                     chk-pb-perce-3-buf + 
                     chk-pb-bosch-3-buf ) = 0
                   set errori to true   
                   move 78-ID-chk-pb-perce-3 to control-id
                   display message "Selezionare almeno un tipo di calcol
      -    "o addizionale"
                             title tit-err
                               icon 2
                end-if

           when 78-ID-chk-pb-amp-4
                inquire chk-pb-perce-4, value in chk-pb-perce-4-buf
                inquire chk-pb-amp-4,   value in chk-pb-amp-4-buf
                inquire chk-pb-bosch-4, value in chk-pb-bosch-4-buf
                if ( chk-pb-amp-4-buf   + 
                     chk-pb-perce-4-buf + 
                     chk-pb-bosch-4-buf ) = 0
                   set errori to true   
                   move 78-ID-chk-pb-perce-4 to control-id
                   display message "Selezionare almeno un tipo di calcol
      -    "o addizionale"
                             title tit-err
                               icon 2
                end-if
           end-evaluate.

           if errori
              perform CANCELLA-COLORE
              move 4 to accept-control
           end-if 
           .
      * <TOTEM:END>

       EVIDENZIA-GESTISCI.
      * <TOTEM:PARA. EVIDENZIA-GESTISCI>
           modify frame-lbx, fill-color = 0, fill-percent = 0.
           modify frame-1,   fill-color = 0, fill-percent = 0.
           modify frame-2,   fill-color = 0, fill-percent = 0.
           modify frame-3,   fill-color = 0, fill-percent = 0.
           modify frame-4,   fill-color = 0, fill-percent = 0.

           inquire chk-gestisci-4, value in chk-gestisci-4-buf.
           if chk-gestisci-4-buf = 1
              modify frame-4,   fill-color = 15, fill-percent = 100
           else
              inquire chk-gestisci-3, value in chk-gestisci-3-buf
              if chk-gestisci-3-buf = 1
                 modify frame-3,   fill-color = 15, fill-percent = 100
              else
                 inquire chk-gestisci-2, value in chk-gestisci-2-buf
                 if chk-gestisci-2-buf = 1
                    modify frame-2,   fill-color = 15, fill-percent = 
           100
                 else
                    inquire chk-gestisci-2, value in chk-gestisci-2-buf
                    if chk-gestisci-2-buf = 1
                       modify frame-2,   fill-color = 15, fill-percent 
           = 100
                     else
                       inquire chk-gestisci-1, value in 
           chk-gestisci-1-buf
                       if chk-gestisci-1-buf = 1
                          modify frame-1,   fill-color = 15, 
           fill-percent = 100
                       else
                          modify frame-lbx,   fill-color = 15, 
           fill-percent = 100
                       end-if
                    end-if
                 end-if
              end-if
           end-if 
           .
      * <TOTEM:END>

       MODIFICA.
      * <TOTEM:PARA. MODIFICA>
           set tutto-ok   to true
           inquire tool-modifica, value mod.
           close param.

           if mod = 1
              perform until 1 = 2
                 set RecLocked to false
                 open i-o param allowing readers
                 if not RecLocked
                    exit perform
                 end-if
                 move 1 to geslock-v-riprova
                 move 1 to geslock-v-ignora
                 move 0 to geslock-v-termina
                 move "param" to geslock-nome-file
                 call   "geslock" using geslock-linkage
                 cancel "geslock"
                 evaluate true
                 when riprova continue
                 when ignora  
                      open input param
                      set errori to true
                      move 0 to mod
                      modify tool-modifica, value mod
                      exit perform
                 end-evaluate
              end-perform
           else
              unlock     param all records
              open input param
           end-if.

           if mod = 0
              perform CANCELLA-COLORE
              set StatusVisua    to true
              move 0 to e-tipocli
                        e-tipocli-dati
                        e-gdo 
                        e-gdo-dati
                        e-clienti 
                        e-clienti-dati
                        e-destini
                        e-destini-dati
           else       
              set StatusModifica to true
              move 78-ID-ef-ini-vol to control-id
              move 4                to accept-control
              if save-tipocli not = spaces
                 move 1 to e-tipocli
                 move chk-gestisci-1-buf to e-tipocli-dati
              end-if
              if save-gdo not = spaces
                 move 1 to e-gdo
                 move chk-gestisci-2-buf to e-gdo-dati
              end-if
              if save-cliente not = 0
                 move 1 to e-clienti
                 move chk-gestisci-3-buf to e-clienti-dati
              end-if
              if save-destino not = 0
                 move 1 to e-destini
                 move chk-gestisci-4-buf to e-destini-dati
              end-if
           end-if.
           perform ABILITAZIONI.

           perform STATUS-BAR-MSG.
           display Form1 
           .
      * <TOTEM:END>

       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "abilita-toolbar.cpy".
           copy "color-custom.cpy".
           copy "status.cpy".
           copy "calcola-colore-trasparente.cpy"     
           .
      * <TOTEM:END>

       SPOSTAMENTO-DESTINI.
      * <TOTEM:PARA. SPOSTAMENTO-DESTINI>
           inquire gd-destini, last-row in tot-righe.
           if event-data-2 < 2 or event-data-2 > tot-righe
              exit paragraph
           end-if.
           inquire gd-destini(event-data-2, 1), cell-data in des-prog.
           if des-prog = save-destino and mod = 1
              exit paragraph
           end-if.

           modify gd-destini, start-y = event-data-2, y = event-data-2 
                              start-x = 1,            x = 2,
                              region-color 481.

           move des-prog to save-destino.
           if mod = 1
              move 1 to e-destini
           end-if.
           
           initialize prm-rec of param replacing numeric data by zeroes
                                   alphanumeric data by spaces.
           move save-tipocli to prm-tipocli of param.
           move save-gdo     to prm-gdo of param.
           move save-cliente to prm-cliente of param.
           move save-destino to prm-destino of param.
           read param no lock 
                invalid continue
           end-read.
           
           move prm-gg-inizio-vol of param      to ef-ini-vol-4-buf
           move prm-gg-parziale of param        to ef-parz-4-buf   
           move prm-gg-per-cons of param        to ef-gg-cons-4-buf
           move prm-gg-val-vol of param         to ef-val-4-buf    
           move prm-gg-cons-max of param        to ef-cons-max-4-buf

           move prm-vet-maggiore-kg of param    to ef-max-vet-4-buf  
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla                to lab-vet-max-4-buf
           move prm-maggiore-kg of param to ef-max-kg-4-buf        
           
           move prm-vet-minore-kg1 of param      to ef-min-vet1-4-buf  
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla            to lab-vet-min1-4-buf  
           move prm-minore-kg1        of param  to ef-min-kg1-4-buf  

           move prm-vet-minore-kg2 of param      to ef-min-vet2-4-buf  
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla            to lab-vet-min2-4-buf  
           move prm-minore-kg2        of param  to ef-min-kg2-4-buf

           move prm-blocco-kg        of param  to ef-blocco-kg-4-buf
           move prm-prenotazione-qta of param  to chk-prenot-4-buf    
           move prm-accorpa          of param  to chk-accorpa-4-buf 
           move prm-sost-batt        of param  to chk-sost-batt-4-buf 
           move prm-saldi-banco      of param  to chk-banco-4-buf   
           move prm-imb-minimo       of param  to chk-imb-min-4-buf.
           move prm-cod-art-forn     of param  to chk-art-forn-4-buf.
           move prm-add-piombo-perce of param  to chk-pb-perce-4-buf.
           move prm-add-piombo-ampere of param  to chk-pb-amp-4-buf.
           move prm-add-piombo-bosch of param  to chk-pb-bosch-4-buf.
           move prm-escludi-tutto    of param  to chk-escludi-4-buf. 
           move prm-stampante        of param  to ef-stampante-4-buf.
           move prm-layout-pers        of param  to 
           chk-layout-pers-4-buf.
           move prm-path-logo       of param  to ef-path-logo-4-buf.

           modify gd-mag-4, reset-grid = 1.
           perform GD-MAG-4-CONTENT.
           move 2 to riga.
           perform varying idx from 1 by 1 
                     until idx > 50
              if prm-mag-codice of param(idx) = spaces exit perform 
           end-if
              move prm-mag-codice of param(idx) to mag-codice
              read tmagaz no lock
              move prm-mag-codice    of param(idx) to col-mag-codice-4
              move prm-mag-ev-intera of param(idx) to col-mag-intera-4
              move mag-descrizione     to col-mag-descrizione-4
              modify gd-mag-4(riga, 1), cell-data col-mag-codice-4
              modify gd-mag-4(riga, 2), cell-data col-mag-descrizione-4
              modify gd-mag-4(riga, 3), cell-data col-mag-intera-4
              add 1 to riga
           end-perform.
           modify gd-mag-4, insert-rows = 1.
           move prm-gestisci of param to chk-gestisci-4-buf.
      *    Luciano
           if e-destini = 1
              move chk-gestisci-4-buf to e-destini-dati
           else
              move 0      to e-destini-dati
           end-if
      *    Luciano

           display Form1.

           perform EVIDENZIA-GESTISCI 
           .
      * <TOTEM:END>

       SALVA.
      * <TOTEM:PARA. SALVA>
           initialize prm-chiave of param
                                      replacing numeric data by zeroes
                                      alphanumeric data by spaces.

           perform BUF-TO-FLD-LUBEX.

           if prm-data-creazione of param = 0
              accept prm-data-creazione of param from century-date
              accept prm-ora-creazione of param  from time
              move user-codi to prm-utente-creazione of param
           else
              accept prm-data-modifica of param from century-date
              accept prm-ora-modifica of param  from time
              move user-codi to prm-utente-modifica of param
           end-if.

      *    Luciano
           perform LEGGI-OLD.
      *    Luciano

           write prm-rec of param 
                 invalid rewrite prm-rec of param 
           end-write.
      *    luciano
           set param-lubex   to true.
           perform VERIFICA-OLD.
      *    luciano
               
           if save-tipocli = spaces
              move spaces to save-gdo
              move 0      to save-cliente
              move 0      to save-destino
           else
              if save-cliente not = 0 
                 set cli-tipo-C to true
                 move save-cliente to cli-codice
                 read clienti no lock
                 move cli-gdo to save-gdo
                 if save-tipocli = spaces
                    move cli-tipo to save-tipocli
                 end-if
              else
                 move 0 to save-destino
              end-if
           end-if.

           if save-tipocli not = spaces
              perform BUF-TO-FLD-TIPOCLI
      *    Luciano
              perform LEGGI-OLD
      *    Luciano
              write prm-rec of param
                 invalid 
                    rewrite prm-rec of param
              end-write
      *    luciano
              set tipo-cli   to true
              perform VERIFICA-OLD
      *    luciano

           end-if.

           if save-gdo not = spaces
              perform BUF-TO-FLD-GDO
      *    Luciano
              perform LEGGI-OLD
      *    Luciano
              write prm-rec of param
                 invalid 
                    rewrite prm-rec of param
              end-write
      *    luciano
              set gruppo-gdo   to true
              perform VERIFICA-OLD
      *    luciano
           end-if.
                       
           if save-cliente not = 0
              perform BUF-TO-FLD-CLIENTE
      *    Luciano
              perform LEGGI-OLD
      *    Luciano
              write prm-rec of param
                 invalid 
                    rewrite prm-rec of param
              end-write
      *    luciano
              set cliente to true
              perform VERIFICA-OLD
      *    luciano
           end-if.
                       
           if save-destino not = 0
              perform BUF-TO-FLD-DESTINO
              write prm-rec of param
                 invalid 
                    rewrite prm-rec of param 
              end-write
           end-if.

      *Luciano

      ***---
       LEGGI-OLD.
           move prm-chiave of param   to prm-chiave of param1
           read param1 no lock
              invalid
                 initialize prm-dati of param1
                                      replacing numeric data by zeroes
                                      alphanumeric data by spaces
           end-read.
           move prm-rec of param1   to old-prm-rec.

      ***---
       VERIFICA-OLD.
      *    verifico la disabilitazione del gruppo
           set gest-disabilita   to false

           evaluate true
           when tipo-cli
                if chk-gestisci-1-buf = zero and old-prm-gestisci-si
                   set gest-disabilita   to true
                end-if
           when gruppo-gdo
                if chk-gestisci-2-buf = zero and old-prm-gestisci-si
                   set gest-disabilita   to true
                end-if
           when cliente
                if chk-gestisci-3-buf = zero and old-prm-gestisci-si
                   set gest-disabilita   to true
                end-if
           when destino
                if chk-gestisci-4-buf = zero and old-prm-gestisci-si
                   set gest-disabilita   to true
                end-if
           end-evaluate
      
           if gest-disabilita
              perform GESTISCI-DISABILITA
              exit paragraph
           end-if
           set rec-cambiato  to false

           evaluate true
           when param-lubex
           when tipo-cli
                if prm-gg-inizio-vol of param 
                                            not = old-prm-gg-inizio-vol
                   set rec-cambiato  to true
                end-if
           when gruppo-gdo
                if v-gdo= 1
                   if prm-gg-inizio-vol of param 
                                            not = old-prm-gg-inizio-vol
                      set rec-cambiato  to true
                   end-if
                end-if
           end-evaluate

           if prm-gg-parziale      of param not = old-prm-gg-parziale   
              or
              prm-gg-per-cons      of param not = old-prm-gg-per-cons   
              or
              prm-gg-val-vol       of param not = old-prm-gg-val-vol    
              or
              prm-gg-cons-max      of param not = old-prm-gg-cons-max   
              or
              prm-vet-maggiore-kg  of param not = 
           old-prm-vet-maggiore-kg  or
              prm-maggiore-kg      of param not = old-prm-maggiore-kg   
              or
              prm-vet-minore-kg1    of param not = 
           old-prm-vet-minore-kg1    or
              prm-minore-kg1        of param not = old-prm-minore-kg1   
                or
              prm-vet-minore-kg2    of param not = 
           old-prm-vet-minore-kg2    or
              prm-minore-kg2        of param not = old-prm-minore-kg2   
                or
              prm-blocco-kg        of param not = old-prm-blocco-kg     
              or
              prm-prenotazione-qta of param not = 
           old-prm-prenotazione-qta or
              prm-accorpa          of param not = old-prm-accorpa       
              or
              prm-sost-batt        of param not = old-prm-sost-batt     
              or
              prm-saldi-banco      of param not = old-prm-saldi-banco   
              or
              prm-saldi-promo      of param not = old-prm-saldi-promo   
              or
              prm-escludi-tutto    of param not = old-prm-escludi-tutto 
              or
              prm-imb-minimo       of param not = old-prm-imb-minimo    
              or
              prm-cod-art-forn     of param not = old-prm-cod-art-forn  
              or
              prm-add-piombo-perce  of param not = 
           old-prm-add-piombo-perce or
              prm-add-piombo-ampere of param not = 
           old-prm-add-piombo-ampere or
              prm-tab-depositi     of param not = old-prm-tab-depositi 
           or
              prm-stampante        of param not = old-prm-stampante or
              prm-layout-pers      of param not = old-prm-layout-pers or
              prm-path-logo        of param not = old-prm-path-logo
              set rec-cambiato  to true
           end-if

           if rec-cambiato
              perform AGGIORNA-FIGLI
           end-if.

      ***---
       AGGIORNA-FIGLI.
           perform TROVA-FIGLI-ATTIVI

      *    se ho almeno un elemento gestito chiedo conferma all'utente
      *    per l'aggiornamento delle
           if gestiti
              evaluate true
              when param-lubex
                   move "Aggiornare anche i dati relativi alla TIPOLOGIA
      -    " CLIENTI/GRUPPI GDO/Clienti/Destini?"
                          to messaggio
              when tipo-cli
                   move "Aggiornare anche i dati relativi ai GRUPPI GDO/
      -    "Clienti/Destini?"
                          to messaggio
              when gruppo-gdo
                   move "Aggiornare anche i dati relativi ai Clienti/Des
      -    "tini?"
                          to messaggio
              when cliente
                   move "Aggiornare anche i dati relativi ai Destini?"
                          to messaggio
              end-evaluate
              inspect messaggio replacing trailing space by low-value
              display message box messaggio
                             title titolo
                             type mb-yes-no
                             giving scelta
              if scelta = mb-no
                 set gestiti to false
              end-if
           end-if

           if gestiti
              perform AGGIORNAMENTO-EFFETTIVO
           end-if.

      ***---
       AGGIORNAMENTO-EFFETTIVO.
      *    per prima cosa aggiorno i dati dei figli che ho a video
      *    così salverò direttamente le modifiche e ho il video aggiornato
           perform AGGIORNA-VIDEO.     

           move como-prm-chiave to prm-chiave of param

           evaluate true
           when param-lubex                
                move low-value  to prm-tipocli of param
                                   prm-gdo of param
                                   prm-cliente of param
                                   prm-destino of param
           when tipo-cli
                move low-value  to prm-gdo of param
                                   prm-cliente of param
                                   prm-destino of param
           when gruppo-gdo
                move low-value  to prm-cliente of param
                                   prm-destino of param
           when cliente
                move low-value  to prm-destino of param
           end-evaluate


           start param key not < prm-chiave of param
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read param next no lock at end exit perform end-read

                    evaluate true
                    when param-lubex
                         if como-prm-lubex   not = prm-lubex of param
                            exit perform
                         end-if
                    when tipo-cli
                         if como-prm-lubex   not = prm-lubex of param or
                            como-prm-tipocli not = prm-tipocli of param 
                            exit perform
                         end-if
                    when gruppo-gdo
                         if como-prm-lubex   not = prm-lubex of param or
                            como-prm-tipocli not = prm-tipocli of param 
           or
                            como-prm-gdo     not = prm-gdo of param
                            exit perform
                         end-if
                    when cliente
                         if como-prm-lubex   not = prm-lubex of param or
                            como-prm-tipocli not = prm-tipocli of param 
           or
                            como-prm-gdo     not = prm-gdo of param or
                            como-prm-cliente not = prm-cliente of param
                            exit perform
                         end-if
                    end-evaluate
                    if prm-gestisci-si of param
                       perform VAL-REC
                    end-if

                 end-perform
           end-start.

      ***---
       VAL-REC.
      *    prima di fare il controllo sui giorni di inizio volantino
      *    devo vedere se la tipologia di partenza lo possiede, poi
      *    verifico se la tipologia di destinazione lo possiede, se 
      *    entranbe le condizioni sono soddistatte procedo alla verifica 
      *    e all'eventuale aggiornamento del dato

           evaluate true
           when param-lubex
           when gruppo-gdo
                perform DETERMINA-GESTIONE-GG-INIZIO-VOL
           when tipo-cli
                if v-gdo= 1
                   perform DETERMINA-GESTIONE-GG-INIZIO-VOL
                else 
                   set si-gg-inizio-vol  to false
                end-if
           when other 
                set si-gg-inizio-vol     to false
           end-evaluate

      *    se entrambe le condizioni sono soddisfatte verifico l'old
           if si-gg-inizio-vol
              if como-prm-gg-inizio-vol not = old-prm-gg-inizio-vol
                 move como-prm-gg-inizio-vol to prm-gg-inizio-vol of 
           param
              end-if
           end-if

      *    poi procedo con gli altri campi sempre presenti
           if como-prm-gg-parziale not = old-prm-gg-parziale  
              move como-prm-gg-parziale  to prm-gg-parziale of param
           end-if

           if como-prm-gg-per-cons not = old-prm-gg-per-cons  
              move como-prm-gg-per-cons  to prm-gg-per-cons of param
           end-if
           if como-prm-gg-val-vol not = old-prm-gg-val-vol   
              move como-prm-gg-val-vol   to prm-gg-val-vol of param
           end-if
           if como-prm-gg-cons-max not = old-prm-gg-cons-max  
              move como-prm-gg-cons-max to prm-gg-cons-max of param
           end-if
           if como-prm-vet-maggiore-kg not = old-prm-vet-maggiore-kg
              move como-prm-vet-maggiore-kg 
                                         to prm-vet-maggiore-kg of param
           end-if
           if como-prm-maggiore-kg not = old-prm-maggiore-kg 
              move como-prm-maggiore-kg to prm-maggiore-kg of param
           end-if                     
           if como-prm-vet-minore-kg1 not = old-prm-vet-minore-kg1
              move como-prm-vet-minore-kg1  to prm-vet-minore-kg1 of 
           param
           end-if
           if como-prm-minore-kg1 not = old-prm-minore-kg1
              move como-prm-minore-kg1 to prm-minore-kg1 of param
           end-if
           if como-prm-vet-minore-kg2 not = old-prm-vet-minore-kg2
              move como-prm-vet-minore-kg2  to prm-vet-minore-kg2 of 
           param
           end-if
           if como-prm-minore-kg2 not = old-prm-minore-kg2
              move como-prm-minore-kg2 to prm-minore-kg2 of param
           end-if
           if como-prm-blocco-kg not = old-prm-blocco-kg 
              move como-prm-blocco-kg to prm-blocco-kg of param
           end-if
           if como-prm-prenotazione-qta not = old-prm-prenotazione-qta
              move como-prm-prenotazione-qta to prm-prenotazione-qta of 
           param
           end-if
           if como-prm-accorpa not = old-prm-accorpa     
              move como-prm-accorpa to prm-accorpa of param
           end-if
           if como-prm-sost-batt not = old-prm-sost-batt
              move como-prm-sost-batt to prm-sost-batt of param
           end-if
           if como-prm-saldi-banco not = old-prm-saldi-banco 
              move como-prm-saldi-banco to prm-saldi-banco of param
           end-if
           if como-prm-saldi-promo not = old-prm-saldi-promo 
              move como-prm-saldi-promo to prm-saldi-promo of param
           end-if
           if como-prm-escludi-tutto not = old-prm-escludi-tutto
              move como-prm-escludi-tutto to prm-escludi-tutto of param
           end-if

           if como-prm-tab-depositi not = old-prm-tab-depositi
              move como-prm-tab-depositi to prm-tab-depositi of param
           end-if   

           if como-prm-imb-minimo not = old-prm-imb-minimo
              move como-prm-imb-minimo to prm-imb-minimo of param
           end-if  

           if como-prm-cod-art-forn not = old-prm-cod-art-forn
              move como-prm-cod-art-forn to prm-cod-art-forn of param
           end-if   

           if como-prm-add-piombo-perce not = old-prm-add-piombo-perce
              move como-prm-add-piombo-perce to prm-add-piombo-perce of 
           param
           end-if

           if como-prm-add-piombo-bosch not = old-prm-add-piombo-bosch
              move como-prm-add-piombo-bosch to prm-add-piombo-bosch of 
           param
           end-if

           if como-prm-add-piombo-ampere not = old-prm-add-piombo-ampere
              move como-prm-add-piombo-ampere to prm-add-piombo-ampere 
           of param
           end-if               

           if como-prm-stampante not = old-prm-stampante
              move como-prm-stampante to prm-stampante of param
           end-if

           if como-prm-path-logo not = old-prm-path-logo
              move como-prm-path-logo to prm-path-logo of param
           end-if                   

           if como-prm-layout-pers not = old-prm-layout-pers
              move como-prm-layout-pers to prm-layout-pers of param
           end-if
                                                        
           accept prm-data-modifica of param from century-date
           accept prm-ora-modifica of param  from time
           move user-codi to prm-utente-modifica of param

           write prm-rec of param
                 invalid rewrite prm-rec of param
           end-write.  

      ***---
       AGGIORNA-VIDEO.
           evaluate true
           when param-lubex
                perform AGGIORNA-TIPOCLI
                perform AGGIORNA-GDO
                perform AGGIORNA-CLIENTE
                perform AGGIORNA-DESTINO
           when tipo-cli
                perform AGGIORNA-GDO
                perform AGGIORNA-CLIENTE
                perform AGGIORNA-DESTINO
           when gruppo-gdo
                perform AGGIORNA-CLIENTE
                perform AGGIORNA-DESTINO
           when cliente
                perform AGGIORNA-DESTINO
           end-evaluate.


      ***---
       DETERMINA-GESTIONE-GG-INIZIO-VOL.
           set adestino   to true

           if prm-destino of param = zero
              set acliente   to true
           end-if

           if prm-cliente of param = zero
              set agruppo-gdo   to true
           end-if

           if prm-gdo of param = space
              set atipo-cli   to true
           end-if

           if prm-tipocli of param = space
              set aparam-lubex   to true
           end-if

           evaluate true
           when aparam-lubex
           when agruppo-gdo
                set si-gg-inizio-vol  to true
           when atipo-cli
                move prm-tipocli of param   to tcl-codice

                read ttipocli no lock 
                   invalid 
                      set tcl-gdo-no  to true
                end-read

                if tcl-gdo-si
                   set si-gg-inizio-vol  to true
                else
                   set si-gg-inizio-vol  to false
                end-if
           when acliente
           when adestino
                set si-gg-inizio-vol  to false
           end-evaluate
           .
      * <TOTEM:END>

       SPOSTAMENTO-CLIENTI.
      * <TOTEM:PARA. SPOSTAMENTO-CLIENTI>
           inquire gd-clienti, last-row in tot-righe.
           if event-data-2 < 2 or event-data-2 > tot-righe
              exit paragraph
           end-if.
           inquire gd-clienti(event-data-2, 1), cell-data in cli-codice.
           if cli-codice = save-cliente and mod = 1
              exit paragraph
           end-if.
           set cli-tipo-C to true.
           read clienti no lock invalid continue end-read.
           move cli-gdo to save-gdo.

           modify gd-clienti, start-y = event-data-2, y = event-data-2 
                              start-x = 1,            x = 2,
                              region-color 481.
           inquire gd-clienti(event-data-2, 1), cell-data in cli-codice.
           modify  gd-destini, mass-update = 1, reset-grid = 1.
           perform GD-DESTINI-CONTENT.
           move low-value  to des-rec.
           move cli-codice to des-codice.
           move 2 to riga
           start destini key >= des-chiave 
                 invalid continue 
             not invalid
                 perform until 1 = 2
                    read destini next at end exit perform end-read
                    if des-codice not = cli-codice 
                       exit perform 
                    end-if
                    move des-prog     to col-des-codice
                    move des-localita to col-des-localita
                    modify gd-destini(riga, 1), cell-data col-des-codice
                    modify gd-destini(riga, 2), cell-data 
           col-des-localita
                    add 1 to riga
                 end-perform
           end-start
           modify gd-destini, mass-update = 0.

           move cli-codice to save-cliente.
           if mod = 1
              move 1 to e-clienti
           end-if.

           move 0 to e-destini.
           move 0 to e-destini-dati.
           move 0 to save-destino.

           initialize prm-rec of param replacing numeric data by zeroes
                                   alphanumeric data by spaces.
           move save-tipocli to prm-tipocli of param.
           move save-gdo     to prm-gdo of param.
           move save-cliente to prm-cliente of param.
           read param no lock 
                invalid continue
           end-read.
           
           move prm-gg-inizio-vol of param      to ef-ini-vol-3-buf
           move prm-gg-parziale of param        to ef-parz-3-buf   
           move prm-gg-per-cons of param        to ef-gg-cons-3-buf
           move prm-gg-val-vol of param         to ef-val-3-buf    
           move prm-gg-cons-max of param        to ef-cons-max-3-buf
           move prm-vet-maggiore-kg of param    to ef-max-vet-3-buf  
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla              to lab-vet-max-3-buf
           move prm-maggiore-kg of param        to ef-max-kg-3-buf    

           move prm-vet-minore-kg1 of param      to ef-min-vet1-3-buf  
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla              to lab-vet-min1-3-buf 
           move prm-minore-kg1          of param to ef-min-kg1-3-buf    

           move prm-vet-minore-kg2 of param      to ef-min-vet2-3-buf  
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla              to lab-vet-min2-3-buf 
           move prm-minore-kg2          of param to ef-min-kg2-3-buf  


           move prm-blocco-kg          of param to ef-blocco-kg-3-buf
           move prm-prenotazione-qta   of param to chk-prenot-3-buf  
           move prm-accorpa            of param to chk-accorpa-3-buf 
           move prm-sost-batt          of param to chk-sost-batt-3-buf 
           move prm-saldi-banco        of param to chk-banco-3-buf   
           move prm-imb-minimo         of param to chk-imb-min-3-buf.
           move prm-cod-art-forn       of param to chk-art-forn-3-buf. 
           move prm-add-piombo-perce of param  to chk-pb-perce-3-buf.
           move prm-add-piombo-ampere of param  to chk-pb-amp-3-buf.
           move prm-add-piombo-bosch  of param  to chk-pb-bosch-3-buf.
           move prm-saldi-promo        of param to chk-promo-3-buf   
           move prm-escludi-tutto      of param to chk-escludi-3-buf.  
           move prm-stampante        of param  to ef-stampante-3-buf.
           move prm-layout-pers      of param to chk-layout-pers-3-buf.
           move prm-path-logo of param to ef-path-logo-3-buf.

           modify gd-mag-3, reset-grid = 1.
           perform GD-MAG-3-CONTENT.
           move 2 to riga.
           perform varying idx from 1 by 1 
                     until idx > 50
              if prm-mag-codice of param(idx) = spaces exit perform 
           end-if
              move prm-mag-codice of param(idx) to mag-codice
              read tmagaz no lock
              move prm-mag-codice    of param(idx) to col-mag-codice-3
              move prm-mag-ev-intera of param(idx) to col-mag-intera-3
              move mag-descrizione     to col-mag-descrizione-3
              modify gd-mag-3(riga, 1), cell-data col-mag-codice-3
              modify gd-mag-3(riga, 2), cell-data col-mag-descrizione-3
              modify gd-mag-3(riga, 3), cell-data col-mag-intera-3
              add 1 to riga
           end-perform.    
           modify gd-mag-3, insert-rows = 1.
           move prm-gestisci of param to chk-gestisci-3-buf.
      *    Luciano
           if e-clienti = 1
              move chk-gestisci-3-buf to e-clienti-dati
           else
              move 0      to e-clienti-dati
           end-if
      *    Luciano

           modify gd-destini, cursor-y = 5000  
           modify gd-destini, start-y = 5000, y = 5000
                              start-x = 1,            x = 2,
                              region-color 481.
           move spaces to lab-vet-max-4-buf.
           move spaces to lab-vet-min1-4-buf.
           move spaces to lab-vet-min2-4-buf.
           move 0 to chk-gestisci-4-buf.
           move 0 to ef-ini-vol-4-buf.
           move 0 to ef-parz-4-buf.
           move 0 to ef-gg-cons-4-buf.
           move 0 to ef-val-4-buf.
           move 0 to ef-cons-max-4-buf.
           move 0 to ef-max-vet-4-buf.
           move 0 to ef-max-kg-4-buf.
           move 0 to ef-min-vet1-4-buf.
           move 0 to ef-min-vet2-4-buf.
           move 0 to ef-min-kg1-4-buf.
           move 0 to ef-min-kg2-4-buf.
           move 0 to ef-blocco-kg-4-buf.
           move 0 to chk-prenot-4-buf.
           move 0 to chk-accorpa-4-buf.
           move 0 to chk-sost-batt-4-buf.
           move 0 to chk-banco-4-buf.
           move 0 to chk-imb-min-4-buf.
           move 0 to chk-art-forn-4-buf.
           move 0 to chk-pb-perce-4-buf.
           move 0 to chk-pb-amp-4-buf.
           move 0 to chk-pb-bosch-4-buf.
           move 0 to chk-promo-4-buf.
           move 0 to chk-escludi-4-buf.
           modify gd-mag-4, reset-grid = 1.
           perform GD-MAG-4-CONTENT.
           modify gd-mag-4, insert-rows = 1.

           display Form1.

           perform EVIDENZIA-GESTISCI 
           .
      * <TOTEM:END>

       SPOSTAMENTO-GD-MAG.
      * <TOTEM:PARA. SPOSTAMENTO-GD-MAG>
           inquire gd-mag, last-row in tot-righe.
           if event-data-2 < 2 or event-data-2 > tot-righe
              exit paragraph
           end-if.
           modify gd-mag, start-y = event-data-2, y = event-data-2 
                          start-x = 1,            x = 3,
                          region-color 481 
           .
      * <TOTEM:END>

       SPOSTAMENTO-GD-MAG-1.
      * <TOTEM:PARA. SPOSTAMENTO-GD-MAG-1>
           inquire gd-mag-1, last-row in tot-righe.
           if event-data-2 < 2 or event-data-2 > tot-righe
              exit paragraph
           end-if.
           modify gd-mag-1, start-y = event-data-2, y = event-data-2 
                            start-x = 1,            x = 3,
                            region-color 481 
           .
      * <TOTEM:END>

       SPOSTAMENTO-GD-MAG-2.
      * <TOTEM:PARA. SPOSTAMENTO-GD-MAG-2>
           inquire gd-mag-2, last-row in tot-righe.
           if event-data-2 < 2 or event-data-2 > tot-righe
              exit paragraph
           end-if.
           modify gd-mag-2, start-y = event-data-2, y = event-data-2 
                            start-x = 1,            x = 3,
                            region-color 481 
           .
      * <TOTEM:END>

       SPOSTAMENTO-GD-MAG-3.
      * <TOTEM:PARA. SPOSTAMENTO-GD-MAG-3>
           inquire gd-mag-3, last-row in tot-righe.
           if event-data-2 < 2 or event-data-2 > tot-righe
              exit paragraph
           end-if.
           modify gd-mag-3, start-y = event-data-2, y = event-data-2 
                            start-x = 1,            x = 3,
                            region-color 481 
           .
      * <TOTEM:END>

       SPOSTAMENTO-GD-MAG-4.
      * <TOTEM:PARA. SPOSTAMENTO-GD-MAG-4>
           inquire gd-mag-4, last-row in tot-righe.
           if event-data-2 < 2 or event-data-2 > tot-righe
              exit paragraph
           end-if.
           modify gd-mag-4, start-y = event-data-2, y = event-data-2 
                            start-x = 1,            x = 3,
                            region-color 481 
           .
      * <TOTEM:END>

       SPOSTAMENTO-GDO.
      * <TOTEM:PARA. SPOSTAMENTO-GDO>
           inquire gd-gdo, last-row in tot-righe.
           if event-data-2 < 2 or event-data-2 > tot-righe
              exit paragraph
           end-if.
           inquire gd-gdo(event-data-2, 1), cell-data in gdo-codice.
           if gdo-codice = save-gdo and mod = 1
              exit paragraph
           end-if.

           modify gd-gdo, start-y = event-data-2, y = event-data-2 
                          start-x = 1,            x = 2,
                          region-color 481.

           modify gd-clienti, mass-update = 1, reset-grid = 1.
           modify gd-destini, reset-grid = 1.
           perform GD-DESTINI-CONTENT.
           perform GD-CLIENTI-CONTENT.
           set  cli-tipo-C to true.
           move low-value  to cli-codice.
           move 2 to riga
           start clienti  key >= cli-chiave 
                 invalid continue 
             not invalid
                 perform until 1 = 2
                    read clienti next at end exit perform end-read
                    if cli-tipo-F exit perform end-if
                    if cli-gdo = gdo-codice
                       move cli-codice   to col-cli-codice
                       move cli-ragsoc-1 to col-cli-ragsoc
                       modify gd-clienti(riga, 1), cell-data 
           col-cli-codice
                       modify gd-clienti(riga, 2), cell-data 
           col-cli-ragsoc
                       add 1 to riga
                    end-if
                 end-perform
           end-start
           modify gd-clienti, mass-update = 0.

           move gdo-codice to save-gdo.
           if mod = 1
              move 1 to e-gdo
           end-if.

           move 0 to e-clienti.
           move 0 to e-clienti-dati.
           move 0 to save-cliente.

           move 0 to e-destini.
           move 0 to e-destini-dati.
           move 0 to save-destino.

           initialize prm-rec of param replacing numeric data by zeroes
                                   alphanumeric data by spaces.
           move save-tipocli to prm-tipocli of param.
           move save-gdo     to prm-gdo of param.
           read param no lock 
                invalid continue
           end-read.
           
           move prm-gg-inizio-vol of param      to ef-ini-vol-2-buf
           move prm-gg-parziale of param        to ef-parz-2-buf   
           move prm-gg-per-cons of param        to ef-gg-cons-2-buf
           move prm-gg-val-vol of param         to ef-val-2-buf    
           move prm-gg-cons-max of param        to ef-cons-max-2-buf
           move prm-vet-maggiore-kg of param    to ef-max-vet-2-buf 
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla              to lab-vet-max-2-buf
           move prm-maggiore-kg of param        to ef-max-kg-2-buf    

           move prm-vet-minore-kg1 of param      to ef-min-vet1-2-buf  
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla              to lab-vet-min1-2-buf          
           move prm-minore-kg1          of param to ef-min-kg1-2-buf  

           move prm-vet-minore-kg2 of param      to ef-min-vet2-2-buf  
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla              to lab-vet-min2-2-buf          
           move prm-minore-kg2          of param to ef-min-kg2-2-buf  

           move prm-blocco-kg          of param to ef-blocco-kg-2-buf
           move prm-prenotazione-qta   of param to chk-prenot-2-buf  
           move prm-accorpa            of param to chk-accorpa-2-buf 
           move prm-sost-batt          of param to chk-sost-batt-2-buf 
           move prm-saldi-banco        of param to chk-banco-2-buf   
           move prm-imb-minimo         of param to chk-imb-min-2-buf.
           move prm-cod-art-forn       of param to chk-art-forn-2-buf. 
           move prm-add-piombo-perce of param  to chk-pb-perce-2-buf.
           move prm-add-piombo-ampere of param  to chk-pb-amp-2-buf.
           move prm-add-piombo-bosch  of param  to chk-pb-bosch-2-buf.
           move prm-saldi-promo        of param to chk-promo-2-buf   
           move prm-escludi-tutto      of param to chk-escludi-2-buf.  
           move prm-stampante        of param  to ef-stampante-2-buf.
           move prm-layout-pers      of param  to chk-layout-pers-2-buf.
           move prm-path-logo         of param to ef-path-logo-2-buf.

           modify gd-mag-2, reset-grid = 1.
           perform GD-MAG-2-CONTENT.
           move 2 to riga.
           perform varying idx from 1 by 1 
                     until idx > 50
              if prm-mag-codice of param(idx) = spaces exit perform 
           end-if
              move prm-mag-codice of param(idx) to mag-codice
              read tmagaz no lock
              move prm-mag-codice    of param(idx) to col-mag-codice-2
              move prm-mag-ev-intera of param(idx) to col-mag-intera-2
              move mag-descrizione     to col-mag-descrizione-2
              modify gd-mag-2(riga, 1), cell-data col-mag-codice-2
              modify gd-mag-2(riga, 2), cell-data col-mag-descrizione-2
              modify gd-mag-2(riga, 3), cell-data col-mag-intera-2
              add 1 to riga
           end-perform.     
           modify gd-mag-2, insert-rows = 1.
           move prm-gestisci of param to chk-gestisci-2-buf.
      *    Luciano
           if e-gdo = 1
              move chk-gestisci-2-buf to e-gdo-dati
           else
              move 0      to e-gdo-dati
           end-if
      *    Luciano

           modify gd-clienti, cursor-y = 5000  
           modify gd-clienti, start-y = 5000, y = 5000
                              start-x = 1,            x = 2,
                              region-color 481.
           move spaces to lab-vet-max-3-buf.
           move spaces to lab-vet-min1-3-buf.
           move spaces to lab-vet-min1-3-buf.
           move 0 to chk-gestisci-3-buf.
           move 0 to ef-ini-vol-3-buf.
           move 0 to ef-parz-3-buf.
           move 0 to ef-gg-cons-3-buf.
           move 0 to ef-val-3-buf.
           move 0 to ef-cons-max-3-buf.
           move 0 to ef-max-vet-3-buf.
           move 0 to ef-max-kg-3-buf.
           move 0 to ef-min-vet1-3-buf.
           move 0 to ef-min-kg1-3-buf.
           move 0 to ef-min-vet2-3-buf.
           move 0 to ef-min-kg2-3-buf.
           move 0 to ef-blocco-kg-3-buf.
           move 0 to chk-prenot-3-buf.
           move 0 to chk-accorpa-3-buf.
           move 0 to chk-sost-batt-3-buf.
           move 0 to chk-banco-3-buf.
           move 0 to chk-imb-min-3-buf.
           move 0 to chk-art-forn-3-buf.
           move 0 to chk-pb-perce-3-buf.
           move 0 to chk-pb-amp-3-buf.
           move 0 to chk-pb-bosch-3-buf.
           move 0 to chk-promo-3-buf.
           move 0 to chk-escludi-3-buf.
           modify gd-mag-3, reset-grid = 1.
           perform GD-MAG-3-CONTENT.
           modify gd-mag-3, insert-rows = 1.

           modify gd-destini, cursor-y = 5000  
           modify gd-destini, start-y = 5000, y = 5000
                              start-x = 1,            x = 2,
                              region-color 481.
           move spaces to lab-vet-max-4-buf.
           move spaces to lab-vet-min1-4-buf.
           move spaces to lab-vet-min2-4-buf.
           move 0 to chk-gestisci-4-buf.
           move 0 to ef-ini-vol-4-buf.
           move 0 to ef-parz-4-buf.
           move 0 to ef-gg-cons-4-buf.
           move 0 to ef-val-4-buf.
           move 0 to ef-cons-max-4-buf.
           move 0 to ef-max-vet-4-buf.
           move 0 to ef-max-kg-4-buf.
           move 0 to ef-min-vet1-4-buf.
           move 0 to ef-min-kg1-4-buf.
           move 0 to ef-min-vet2-4-buf.
           move 0 to ef-min-kg2-4-buf.
           move 0 to ef-blocco-kg-4-buf.
           move 0 to chk-prenot-4-buf.
           move 0 to chk-accorpa-4-buf.
           move 0 to chk-sost-batt-4-buf.
           move 0 to chk-banco-4-buf.
           move 0 to chk-imb-min-4-buf.
           move 0 to chk-art-forn-4-buf.
           move 0 to chk-promo-4-buf.
           move 0 to chk-escludi-4-buf.
           modify gd-mag-4, reset-grid = 1.
           perform GD-MAG-4-CONTENT.
           modify gd-mag-4, insert-rows = 1.

           display Form1.

           perform EVIDENZIA-GESTISCI 
           .
      * <TOTEM:END>

       SPOSTAMENTO-TIPOCLI.
      * <TOTEM:PARA. SPOSTAMENTO-TIPOCLI>
           inquire gd-tipocli, last-row in tot-righe.
           if event-data-2 < 2 or event-data-2 > tot-righe
              exit paragraph
           end-if.
           inquire gd-tipocli(event-data-2, 1), cell-data in tcl-codice.
           if tcl-codice = save-tipocli and mod = 1
              exit paragraph
           end-if.

           modify gd-tipocli, start-y = event-data-2, y = event-data-2 
                              start-x = 1,            x = 2,
                              region-color 481.
           read ttipocli no lock invalid continue end-read.
           modify gd-gdo, mass-update = 1, reset-grid = 1.
           perform GD-GDO-CONTENT.
           if tcl-gdo-si
              move 1 to v-gdo
              move low-value to gdo-rec
              move 2 to riga
              start tgrupgdo key >= gdo-chiave 
                    invalid continue 
                not invalid
                    perform until 1 = 2
                       read tgrupgdo next at end exit perform end-read
                       if gdo-tipocli = tcl-codice
                          move gdo-codice       to col-gdo-codice
                          move gdo-intestazione to col-gdo-descrizione  
                   
                          modify gd-gdo(riga, 1), cell-data 
           col-gdo-codice
                          modify gd-gdo(riga, 2), cell-data 
           col-gdo-descrizione
                          add 1 to riga
                       end-if
                    end-perform
              end-start
           else
              move 0 to v-gdo
              move 0 to ef-ini-vol-1-buf
           end-if.
           modify gd-gdo, mass-update = 0.

           modify gd-clienti, mass-update = 1, reset-grid = 1.
           perform GD-CLIENTI-CONTENT.
           set cli-tipo-C to true.
           move low-value to cli-rec.
           move 2 to riga
           start clienti key >= cli-chiave 
                 invalid continue 
             not invalid
                 perform until 1 = 2
                    read clienti next at end exit perform end-read
                    if cli-tipo-F exit perform end-if
                    if cli-tipo = tcl-codice
                       move cli-codice   to col-cli-codice
                       move cli-ragsoc-1 to col-cli-ragsoc
                       modify gd-clienti(riga, 1), cell-data 
           col-cli-codice
                       modify gd-clienti(riga, 2), cell-data 
           col-cli-ragsoc
                       add 1 to riga
                    end-if
                 end-perform
           end-start
           modify gd-clienti, mass-update = 0.

           move tcl-codice to save-tipocli. 
           if mod = 1
              move 1 to e-tipocli
           end-if.

           move 0 to e-gdo.
           move 0 to e-gdo-dati.
           move spaces to save-gdo.

           move 0 to e-clienti.
           move 0 to e-clienti-dati.
           move 0 to save-cliente.

           move 0 to e-destini.
           move 0 to e-destini-dati.
           move 0 to save-destino.

           initialize prm-rec of param replacing numeric data by zeroes
                                   alphanumeric data by spaces.
           move save-tipocli to prm-tipocli of param.
           read param no lock 
                invalid continue
           end-read.
           
           move prm-gg-inizio-vol of param      to ef-ini-vol-1-buf
           move prm-gg-parziale of param        to ef-parz-1-buf   
           move prm-gg-per-cons of param        to ef-gg-cons-1-buf
           move prm-gg-val-vol of param         to ef-val-1-buf    
           move prm-gg-cons-max of param        to ef-cons-max-1-buf
           move prm-vet-maggiore-kg of param    to ef-max-vet-1-buf 
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla              to lab-vet-max-1-buf
           move prm-maggiore-kg of param        to ef-max-kg-1-buf    

           move prm-vet-minore-kg1 of param      to ef-min-vet1-1-buf 
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla            to lab-vet-min1-1-buf
           move prm-minore-kg1        of param to ef-min-kg1-1-buf  

           move prm-vet-minore-kg2 of param      to ef-min-vet2-1-buf 
           vet-codice
           read tvettori no lock invalid move spaces to vet-sigla 
           end-read.
           move vet-sigla            to lab-vet-min2-1-buf
           move prm-minore-kg2        of param to ef-min-kg2-1-buf  

           move prm-blocco-kg         of param to ef-blocco-kg-1-buf
           move prm-prenotazione-qta  of param to chk-prenot-1-buf  
           move prm-accorpa           of param to chk-accorpa-1-buf 
           move prm-sost-batt         of param to chk-sost-batt-1-buf 
           move prm-saldi-banco       of param to chk-banco-1-buf   
           move prm-imb-minimo        of param to chk-imb-min-1-buf.
           move prm-cod-art-forn      of param to chk-art-forn-1-buf.
           move prm-add-piombo-perce  of param  to chk-pb-perce-1-buf.
           move prm-add-piombo-ampere of param  to chk-pb-amp-1-buf.
           move prm-add-piombo-bosch  of param  to chk-pb-bosch-1-buf.
           move prm-saldi-promo       of param to chk-promo-1-buf   
           move prm-escludi-tutto     of param to chk-escludi-1-buf.  
           move prm-stampante         of param  to ef-stampante-1-buf.
           move prm-layout-pers         of param  to 
           chk-layout-pers-1-buf.
           move prm-path-logo         of param  to ef-path-logo-1-buf.

           modify gd-mag-1, reset-grid = 1.
           perform GD-MAG-1-CONTENT.
           move 2 to riga.
           perform varying idx from 1 by 1 
                     until idx > 50
              if prm-mag-codice of param(idx) = spaces exit perform 
           end-if
              move prm-mag-codice of param(idx) to mag-codice
              read tmagaz no lock
              move prm-mag-codice    of param(idx) to col-mag-codice-1
              move prm-mag-ev-intera of param(idx) to col-mag-intera-1
              move mag-descrizione     to col-mag-descrizione-1
              modify gd-mag-1(riga, 1), cell-data col-mag-codice-1
              modify gd-mag-1(riga, 2), cell-data col-mag-descrizione-1
              modify gd-mag-1(riga, 3), cell-data col-mag-intera-1
              add 1 to riga
           end-perform.
           modify gd-mag-1, insert-rows = 1.
           move prm-gestisci of param to chk-gestisci-1-buf.
      *    Luciano
           if e-tipocli = 1
              move chk-gestisci-1-buf to e-tipocli-dati
           else
              move 0      to e-tipocli-dati
           end-if
      *    Luciano

           modify gd-gdo, cursor-y = 5000  
           modify gd-gdo, start-y = 5000, y = 5000
                          start-x = 1,            x = 2,
                          region-color 481.
           move spaces to lab-vet-max-2-buf.
           move spaces to lab-vet-min1-2-buf.
           move spaces to lab-vet-min2-2-buf.
           move 0 to chk-gestisci-2-buf.
           move 0 to ef-ini-vol-2-buf.
           move 0 to ef-parz-2-buf.
           move 0 to ef-gg-cons-2-buf.
           move 0 to ef-val-2-buf.
           move 0 to ef-cons-max-2-buf.
           move 0 to ef-max-vet-2-buf.
           move 0 to ef-max-kg-2-buf.
           move 0 to ef-min-vet1-2-buf
           move 0 to ef-min-kg1-2-buf.
           move 0 to ef-min-vet2-2-buf
           move 0 to ef-min-kg2-2-buf.
           move 0 to ef-blocco-kg-2-buf.
           move 0 to chk-prenot-2-buf.
           move 0 to chk-accorpa-2-buf.
           move 0 to chk-sost-batt-2-buf.
           move 0 to chk-banco-2-buf.  
           move 0 to chk-imb-min-2-buf.
           move 0 to chk-art-forn-2-buf.  
           move 0 to chk-pb-perce-2-buf.
           move 0 to chk-pb-amp-2-buf.
           move 0 to chk-pb-bosch-2-buf.
           move 0 to chk-promo-2-buf.
           move 0 to chk-escludi-2-buf.
           modify gd-mag-2, reset-grid = 1.
           perform GD-MAG-2-CONTENT.
           modify gd-mag-2, insert-rows = 1.

           modify gd-clienti, cursor-y = 5000  
           modify gd-clienti, start-y = 5000, y = 5000
                              start-x = 1,            x = 2,
                              region-color 481.
           move spaces to lab-vet-max-3-buf.
           move spaces to lab-vet-min1-3-buf.
           move spaces to lab-vet-min2-3-buf.
           move 0 to chk-gestisci-3-buf.
           move 0 to ef-ini-vol-3-buf.
           move 0 to ef-parz-3-buf.
           move 0 to ef-gg-cons-3-buf.
           move 0 to ef-val-3-buf.
           move 0 to ef-cons-max-3-buf.
           move 0 to ef-max-vet-3-buf.
           move 0 to ef-max-kg-3-buf.
           move 0 to ef-min-vet1-3-buf.
           move 0 to ef-min-kg1-3-buf.
           move 0 to ef-min-vet2-3-buf.
           move 0 to ef-min-kg2-3-buf.
           move 0 to ef-blocco-kg-3-buf.
           move 0 to chk-prenot-3-buf.
           move 0 to chk-accorpa-3-buf.
           move 0 to chk-sost-batt-3-buf.
           move 0 to chk-banco-3-buf.
           move 0 to chk-imb-min-3-buf.
           move 0 to chk-art-forn-3-buf.
           move 0 to chk-promo-3-buf.
           move 0 to chk-escludi-3-buf.
           modify gd-mag-3, reset-grid = 1.
           perform GD-MAG-3-CONTENT.
           modify gd-mag-3, insert-rows = 1.

           modify gd-destini, cursor-y = 5000  
           modify gd-destini, start-y = 5000, y = 5000
                              start-x = 1,            x = 2,
                              region-color 481.
           move spaces to lab-vet-max-4-buf.
           move spaces to lab-vet-min1-4-buf.
           move spaces to lab-vet-min2-4-buf.
           move 0 to chk-gestisci-4-buf.
           move 0 to ef-ini-vol-4-buf.
           move 0 to ef-parz-4-buf.
           move 0 to ef-gg-cons-4-buf.
           move 0 to ef-val-4-buf.
           move 0 to ef-cons-max-4-buf.
           move 0 to ef-max-vet-4-buf.
           move 0 to ef-max-kg-4-buf.
           move 0 to ef-min-vet1-4-buf.
           move 0 to ef-min-kg1-4-buf.
           move 0 to ef-min-vet2-4-buf.
           move 0 to ef-min-kg2-4-buf.
           move 0 to ef-blocco-kg-4-buf.
           move 0 to chk-prenot-4-buf.
           move 0 to chk-accorpa-4-buf.
           move 0 to chk-sost-batt-4-buf.
           move 0 to chk-banco-4-buf.
           move 0 to chk-imb-min-4-buf.
           move 0 to chk-art-forn-4-buf.
           move 0 to chk-promo-4-buf.
           move 0 to chk-escludi-4-buf.
           modify gd-mag-4, reset-grid = 1.
           perform GD-MAG-4-CONTENT.
           modify gd-mag-4, insert-rows = 1.

           display Form1.

           perform EVIDENZIA-GESTISCI 
           .
      * <TOTEM:END>

       AGGIORNA-TIPOCLI.
      * <TOTEM:PARA. AGGIORNA-TIPOCLI>
           set modificato to false
           if chk-gestisci-1-buf = zero
              exit paragraph
           end-if

           if v-gdo = 1
              if como-prm-gg-inizio-vol not = old-prm-gg-inizio-vol
                 move como-prm-gg-inizio-vol to ef-ini-vol-1-buf
                 modify ef-ini-vol-1 value ef-ini-vol-1-buf
                 set modificato to true
              end-if
           end-if

           if como-prm-gg-parziale not = old-prm-gg-parziale  
              move como-prm-gg-parziale  to ef-parz-1-buf
              modify ef-parz-1 value ef-parz-1-buf
              set modificato to true
           end-if

           if como-prm-gg-per-cons not = old-prm-gg-per-cons  
              move como-prm-gg-per-cons  to ef-gg-cons-1-buf
              modify ef-gg-cons-1 value ef-gg-cons-1-buf
              set modificato to true
           end-if
           if como-prm-gg-val-vol not = old-prm-gg-val-vol   
              move como-prm-gg-val-vol   to ef-val-1-buf
              modify ef-val-1 value ef-val-1-buf
              set modificato to true
           end-if
           if como-prm-gg-cons-max not = old-prm-gg-cons-max  
              move como-prm-gg-cons-max to ef-cons-max-1-buf
              modify ef-cons-max-1 value ef-cons-max-1-buf
              set modificato to true
           end-if
           if como-prm-vet-maggiore-kg not = old-prm-vet-maggiore-kg
              move como-prm-vet-maggiore-kg to ef-max-vet-1-buf
              modify ef-max-vet-1 value ef-max-vet-1-buf
              set modificato to true
           end-if
           if como-prm-maggiore-kg not = old-prm-maggiore-kg 
              move como-prm-maggiore-kg to ef-max-kg-1-buf
              modify ef-max-kg-1 value ef-max-kg-1-buf
              set modificato to true
           end-if                                 
           if como-prm-vet-minore-kg1 not = old-prm-vet-minore-kg1
              move como-prm-vet-minore-kg1  to ef-min-vet1-1-buf
              modify ef-min-vet1-1 value ef-min-vet1-1-buf
              set modificato to true
           end-if
           if como-prm-minore-kg1 not = old-prm-minore-kg1
              move como-prm-minore-kg1 to ef-min-kg1-1-buf
              modify ef-min-kg1-1 value ef-min-kg1-1-buf
              set modificato to true
           end-if
           if como-prm-vet-minore-kg2 not = old-prm-vet-minore-kg2
              move como-prm-vet-minore-kg2  to ef-min-vet2-1-buf
              modify ef-min-vet2-1 value ef-min-vet2-1-buf
              set modificato to true
           end-if
           if como-prm-minore-kg2 not = old-prm-minore-kg2
              move como-prm-minore-kg2 to ef-min-kg2-1-buf
              modify ef-min-kg2-1 value ef-min-kg2-1-buf
              set modificato to true
           end-if
           if como-prm-blocco-kg not = old-prm-blocco-kg 
              move como-prm-blocco-kg to ef-blocco-kg-1-buf
              modify ef-blocco-kg-1 value ef-blocco-kg-1-buf
              set modificato to true
           end-if
           if como-prm-accorpa not = old-prm-accorpa     
              move como-prm-accorpa to chk-accorpa-1-buf
              modify chk-accorpa-1 value chk-accorpa-1-buf
              set modificato to true
           end-if
           if como-prm-sost-batt not = old-prm-sost-batt
              move como-prm-sost-batt to chk-sost-batt-1-buf
              modify chk-sost-batt-1 value chk-sost-batt-1-buf
              set modificato to true
           end-if
           if como-prm-saldi-banco not = old-prm-saldi-banco 
              move como-prm-saldi-banco to chk-banco-1-buf
              modify chk-banco-1 value chk-banco-1-buf
              set modificato to true
           end-if
           if como-prm-saldi-promo not = old-prm-saldi-promo 
              move como-prm-saldi-promo to chk-promo-1-buf
              modify chk-promo-1 value chk-promo-1-buf
              set modificato to true
           end-if
           if como-prm-escludi-tutto not = old-prm-escludi-tutto
              move como-prm-escludi-tutto to chk-escludi-1-buf
              modify chk-escludi-1 value chk-escludi-1-buf
              set modificato to true
           end-if                                         
           if como-prm-imb-minimo not = old-prm-imb-minimo
              move como-prm-imb-minimo to chk-imb-min-1-buf
              modify chk-imb-min-1 value chk-imb-min-1-buf
              set modificato to true
           end-if   
           if como-prm-cod-art-forn not = old-prm-cod-art-forn
              move como-prm-cod-art-forn to chk-art-forn-1-buf
              modify chk-art-forn-1 value chk-art-forn-1-buf
              set modificato to true
           end-if  

           if como-prm-add-piombo-perce not = old-prm-add-piombo-perce
              move como-prm-add-piombo-perce to chk-pb-perce-1-buf
              modify chk-pb-perce-1 value chk-pb-perce-1-buf
              set modificato to true
           end-if

           if como-prm-add-piombo-bosch not = old-prm-add-piombo-bosch
              move como-prm-add-piombo-bosch to chk-pb-bosch-1-buf
              modify chk-pb-bosch-1 value chk-pb-bosch-1-buf
              set modificato to true
           end-if

           if como-prm-add-piombo-ampere not = old-prm-add-piombo-ampere
              move como-prm-add-piombo-ampere to chk-pb-amp-1-buf
              modify chk-pb-amp-1 value chk-pb-amp-1-buf
              set modificato to true
           end-if

           if como-prm-add-piombo-bosch not = old-prm-add-piombo-bosch
              move como-prm-add-piombo-bosch to chk-pb-bosch-1-buf
              modify chk-pb-bosch-1 value chk-pb-bosch-1-buf
              set modificato to true
           end-if

           if como-prm-stampante not = old-prm-stampante
              move como-prm-stampante to ef-stampante-1-buf
              modify ef-stampante-1 value ef-stampante-1-buf
              set modificato to true
           end-if

           if como-prm-layout-pers not = old-prm-layout-pers
              move como-prm-layout-pers to chk-layout-pers-1-buf
              modify chk-layout-pers-1 value chk-layout-pers-1-buf
              set modificato to true
           end-if

           if como-prm-path-logo not = old-prm-path-logo
              move como-prm-path-logo to ef-path-logo-1-buf
              modify ef-path-logo-1 value ef-path-logo-1-buf
              set modificato to true
           end-if

           if como-prm-tab-depositi not = old-prm-tab-depositi
      *        move como-prm-tab-depositi to prm-tab-depositi of param
              
              perform AGGIORNA-GD-MAG-1
              set modificato to true
           end-if.

           if modificato
              perform BUF-TO-FLD-TIPOCLI
              write prm-rec of param
                 invalid 
                    rewrite prm-rec of param
              end-write
           end-if.

      ***---
       AGGIORNA-GD-MAG-1.
           modify gd-mag-1, reset-grid = 1.
           perform GD-MAG-1-CONTENT.
           move 2 to riga.
           perform varying idx from 1 by 1 
                     until idx > 50
              if como-prm-mag-codice(idx) = spaces 
                 exit perform 
              end-if
              move como-prm-mag-codice(idx)    to mag-codice
              read tmagaz no lock
              move como-prm-mag-codice(idx)    to col-mag-codice-1
              move mag-descrizione             to col-mag-descrizione-1
              move como-prm-mag-ev-intera(idx) to col-mag-intera
              modify gd-mag-1(riga, 1), cell-data col-mag-codice-1
              modify gd-mag-1(riga, 2), cell-data col-mag-descrizione-1
              modify gd-mag-1(riga, 3), cell-data col-mag-intera
              add 1 to riga
           end-perform.
           modify gd-mag-1, insert-rows = 1 
           .
      * <TOTEM:END>

       AGGIORNA-GDO.
      * <TOTEM:PARA. AGGIORNA-GDO>
           set modificato to false
           if chk-gestisci-2-buf = zero
              exit paragraph
           end-if

           if como-prm-gg-inizio-vol not = old-prm-gg-inizio-vol
              move como-prm-gg-inizio-vol to ef-ini-vol-2-buf
              modify ef-ini-vol-2 value ef-ini-vol-2-buf
              set modificato to true
           end-if

           if como-prm-gg-parziale not = old-prm-gg-parziale  
              move como-prm-gg-parziale  to ef-parz-2-buf
              modify ef-parz-2 value ef-parz-2-buf
              set modificato to true
           end-if

           if como-prm-gg-per-cons not = old-prm-gg-per-cons  
              move como-prm-gg-per-cons  to ef-gg-cons-2-buf
              modify ef-gg-cons-2 value ef-gg-cons-2-buf
              set modificato to true
           end-if
           if como-prm-gg-val-vol not = old-prm-gg-val-vol   
              move como-prm-gg-val-vol   to ef-val-2-buf
              modify ef-val-2 value ef-val-2-buf
              set modificato to true
           end-if
           if como-prm-gg-cons-max not = old-prm-gg-cons-max  
              move como-prm-gg-cons-max to ef-cons-max-2-buf
              modify ef-cons-max-2 value ef-cons-max-2-buf
              set modificato to true
           end-if              
           if como-prm-vet-maggiore-kg not = old-prm-vet-maggiore-kg
              move como-prm-vet-maggiore-kg to ef-max-vet-2-buf
              modify ef-max-vet-2 value ef-max-vet-2-buf
              set modificato to true
           end-if
           if como-prm-maggiore-kg not = old-prm-maggiore-kg
              move como-prm-maggiore-kg to ef-max-kg-2-buf
              modify ef-max-kg-2 value ef-max-kg-2-buf
              set modificato to true
           end-if                                       
           if como-prm-vet-minore-kg1 not = old-prm-vet-minore-kg1
              move como-prm-vet-minore-kg1  to ef-min-vet1-2-buf
              modify ef-min-vet1-2 value ef-min-vet1-2-buf
              set modificato to true
           end-if
           if como-prm-minore-kg1 not = old-prm-minore-kg1 
              move como-prm-minore-kg1 to ef-min-kg1-2-buf
              modify ef-min-kg1-2 value ef-min-kg1-2-buf
              set modificato to true
           end-if
           if como-prm-vet-minore-kg2 not = old-prm-vet-minore-kg2
              move como-prm-vet-minore-kg2  to ef-min-vet2-2-buf
              modify ef-min-vet2-2 value ef-min-vet2-2-buf
              set modificato to true
           end-if
           if como-prm-minore-kg2 not = old-prm-minore-kg2
              move como-prm-minore-kg2 to ef-min-kg2-2-buf
              modify ef-min-kg2-2 value ef-min-kg2-2-buf
              set modificato to true
           end-if
           if como-prm-blocco-kg not = old-prm-blocco-kg 
              move como-prm-blocco-kg to ef-blocco-kg-2-buf
              modify ef-blocco-kg-2 value ef-blocco-kg-2-buf
              set modificato to true
           end-if
           if como-prm-prenotazione-qta not = old-prm-prenotazione-qta
              move como-prm-prenotazione-qta to chk-prenot-2-buf
              modify chk-prenot-2 value chk-prenot-2-buf
              set modificato to true
           end-if
           if como-prm-accorpa not = old-prm-accorpa     
              move como-prm-accorpa to chk-accorpa-2-buf
              modify chk-accorpa-2 value chk-accorpa-2-buf
              set modificato to true
           end-if             
           if como-prm-sost-batt not = old-prm-sost-batt
              move como-prm-sost-batt to chk-sost-batt-2-buf
              modify chk-sost-batt-2 value chk-sost-batt-2-buf
              set modificato to true
           end-if
           if como-prm-saldi-banco not = old-prm-saldi-banco 
              move como-prm-saldi-banco to chk-banco-2-buf
              modify chk-banco-2 value chk-banco-2-buf
              set modificato to true
           end-if
           if como-prm-saldi-promo not = old-prm-saldi-promo 
              move como-prm-saldi-promo to chk-promo-2-buf
              modify chk-promo-2 value chk-promo-2-buf
              set modificato to true
           end-if
           if como-prm-escludi-tutto not = old-prm-escludi-tutto
              move como-prm-escludi-tutto to chk-escludi-2-buf
              modify chk-escludi-2 value chk-escludi-2-buf
              set modificato to true
           end-if                
           if como-prm-imb-minimo not = old-prm-imb-minimo
              move como-prm-imb-minimo to chk-imb-min-2-buf
              modify chk-imb-min-2 value chk-imb-min-2-buf
              set modificato to true
           end-if
           if como-prm-cod-art-forn not = old-prm-cod-art-forn
              move como-prm-cod-art-forn to chk-art-forn-2-buf
              modify chk-art-forn-2 value chk-art-forn-2-buf
              set modificato to true
           end-if  

           if como-prm-add-piombo-perce not = old-prm-add-piombo-perce
              move como-prm-add-piombo-perce to chk-pb-perce-2-buf
              modify chk-pb-perce-2 value chk-pb-perce-2-buf
              set modificato to true
           end-if

           if como-prm-add-piombo-bosch not = old-prm-add-piombo-bosch
              move como-prm-add-piombo-bosch to chk-pb-bosch-2-buf
              modify chk-pb-bosch-2 value chk-pb-bosch-2-buf
              set modificato to true
           end-if

           if como-prm-add-piombo-ampere not = old-prm-add-piombo-ampere
              move como-prm-add-piombo-ampere to chk-pb-amp-2-buf
              modify chk-pb-amp-2 value chk-pb-amp-2-buf
              set modificato to true
           end-if

           if como-prm-add-piombo-bosch not = old-prm-add-piombo-bosch
              move como-prm-add-piombo-bosch to chk-pb-bosch-2-buf
              modify chk-pb-bosch-2 value chk-pb-bosch-2-buf
              set modificato to true
           end-if                     

           if como-prm-stampante not = old-prm-stampante
              move como-prm-stampante to ef-stampante-2-buf
              modify ef-stampante-2 value ef-stampante-2-buf
              set modificato to true
           end-if                                       

           if como-prm-layout-pers not = old-prm-layout-pers
              move como-prm-layout-pers to chk-layout-pers-2-buf
              modify chk-layout-pers-2 value chk-layout-pers-2-buf
              set modificato to true
           end-if

           if como-prm-path-logo not = old-prm-path-logo
              move como-prm-path-logo to ef-path-logo-2-buf
              modify ef-path-logo-2 value ef-path-logo-2-buf
              set modificato to true
           end-if

           if como-prm-tab-depositi not = old-prm-tab-depositi
      *        move como-prm-tab-depositi to prm-tab-depositi of param
              
              perform AGGIORNA-GD-MAG-2
              set modificato to true
           end-if.

           if modificato
              perform BUF-TO-FLD-GDO
              write prm-rec of param
                 invalid 
                    rewrite prm-rec of param
              end-write
           end-if.


      ***---
       AGGIORNA-GD-MAG-2.
           modify gd-mag-2, reset-grid = 1.
           perform GD-MAG-2-CONTENT.
           move 2 to riga.
           perform varying idx from 1 by 1 
                     until idx > 100
              if como-prm-mag-codice(idx) = spaces 
                 exit perform 
              end-if
              move como-prm-mag-codice(idx)    to mag-codice
              move como-prm-mag-ev-intera(idx) to col-mag-intera-2
              read tmagaz no lock
              move como-prm-mag-codice(idx)   to col-mag-codice-2
              move mag-descrizione     to col-mag-descrizione-2
              modify gd-mag-2(riga, 1), cell-data col-mag-codice-2
              modify gd-mag-2(riga, 2), cell-data col-mag-descrizione-2
              modify gd-mag-2(riga, 3), cell-data col-mag-intera-2
              add 1 to riga
           end-perform.
           modify gd-mag-2, insert-rows = 1 
           .
      * <TOTEM:END>

       AGGIORNA-CLIENTE.
      * <TOTEM:PARA. AGGIORNA-CLIENTE>
           set modificato to false
           if chk-gestisci-3-buf = zero
              exit paragraph
           end-if

           if como-prm-gg-parziale not = old-prm-gg-parziale  
              move como-prm-gg-parziale  to ef-parz-3-buf
              modify ef-parz-3 value ef-parz-3-buf
              set modificato to true
           end-if

           if como-prm-gg-per-cons not = old-prm-gg-per-cons  
              move como-prm-gg-per-cons  to ef-gg-cons-3-buf
              modify ef-gg-cons-3 value ef-gg-cons-3-buf
              set modificato to true
           end-if
           if como-prm-gg-val-vol not = old-prm-gg-val-vol   
              move como-prm-gg-val-vol   to ef-val-3-buf
              modify ef-val-3 value ef-val-3-buf
              set modificato to true
           end-if
           if como-prm-gg-cons-max not = old-prm-gg-cons-max  
              move como-prm-gg-cons-max to ef-cons-max-3-buf
              modify ef-cons-max-3 value ef-cons-max-3-buf
              set modificato to true
           end-if
           if como-prm-vet-maggiore-kg not = old-prm-vet-maggiore-kg
              move como-prm-vet-maggiore-kg to ef-max-vet-3-buf
              modify ef-max-vet-3 value ef-max-vet-3-buf
              set modificato to true
           end-if                                   
           if como-prm-maggiore-kg not = old-prm-maggiore-kg
              move como-prm-maggiore-kg to ef-max-kg-3-buf
              modify ef-max-kg-3 value ef-max-kg-3-buf
              set modificato to true
           end-if              
           if como-prm-vet-minore-kg1 not = old-prm-vet-minore-kg1
              move como-prm-vet-minore-kg1  to ef-min-vet1-3-buf
              modify ef-min-vet1-3 value ef-min-vet1-3-buf
              set modificato to true
           end-if
           if como-prm-minore-kg2 not = old-prm-minore-kg2
              move como-prm-minore-kg2 to ef-min-kg2-3-buf
              modify ef-min-kg2-3 value ef-min-kg2-3-buf
              set modificato to true
           end-if              
           if como-prm-vet-minore-kg2 not = old-prm-vet-minore-kg2
              move como-prm-vet-minore-kg2  to ef-min-vet2-3-buf
              modify ef-min-vet2-3 value ef-min-vet2-3-buf
              set modificato to true
           end-if
           if como-prm-minore-kg2 not = old-prm-minore-kg2
              move como-prm-minore-kg2 to ef-min-kg2-3-buf
              modify ef-min-kg2-3 value ef-min-kg2-3-buf
              set modificato to true
           end-if
           if como-prm-blocco-kg not = old-prm-blocco-kg 
              move como-prm-blocco-kg to ef-blocco-kg-3-buf
              modify ef-blocco-kg-3 value ef-blocco-kg-3-buf
              set modificato to true
           end-if
           if como-prm-prenotazione-qta not = old-prm-prenotazione-qta
              move como-prm-prenotazione-qta to chk-prenot-3-buf
              modify chk-prenot-3 value chk-prenot-3-buf
              set modificato to true
           end-if
           if como-prm-accorpa not = old-prm-accorpa     
              move como-prm-accorpa to chk-accorpa-3-buf
              modify chk-accorpa-3 value chk-accorpa-3-buf
              set modificato to true
           end-if                  
           if como-prm-sost-batt not = old-prm-sost-batt
              move como-prm-sost-batt to chk-sost-batt-3-buf
              modify chk-sost-batt-3 value chk-sost-batt-3-buf
              set modificato to true
           end-if
           if como-prm-saldi-banco not = old-prm-saldi-banco 
              move como-prm-saldi-banco to chk-banco-3-buf
              modify chk-banco-3 value chk-banco-3-buf
              set modificato to true
           end-if
           if como-prm-saldi-promo not = old-prm-saldi-promo 
              move como-prm-saldi-promo to chk-promo-3-buf
              modify chk-promo-3 value chk-promo-3-buf
              set modificato to true
           end-if
           if como-prm-escludi-tutto not = old-prm-escludi-tutto
              move como-prm-escludi-tutto to chk-escludi-3-buf
              modify chk-escludi-3 value chk-escludi-3-buf
              set modificato to true
           end-if                
           if como-prm-imb-minimo not = old-prm-imb-minimo
              move como-prm-imb-minimo to chk-imb-min-3-buf
              modify chk-imb-min-3 value chk-imb-min-3-buf
              set modificato to true
           end-if
           if como-prm-cod-art-forn not = old-prm-cod-art-forn
              move como-prm-cod-art-forn to chk-art-forn-3-buf
              modify chk-art-forn-3 value chk-art-forn-3-buf
              set modificato to true
           end-if 

           if como-prm-add-piombo-perce not = old-prm-add-piombo-perce
              move como-prm-add-piombo-perce to chk-pb-perce-3-buf
              modify chk-pb-perce-3 value chk-pb-perce-3-buf
              set modificato to true
           end-if

           if como-prm-add-piombo-bosch not = old-prm-add-piombo-bosch
              move como-prm-add-piombo-bosch to chk-pb-bosch-3-buf
              modify chk-pb-bosch-3 value chk-pb-bosch-3-buf
              set modificato to true
           end-if                            

           if como-prm-add-piombo-bosch not = old-prm-add-piombo-bosch
              move como-prm-add-piombo-bosch to chk-pb-bosch-3-buf
              modify chk-pb-bosch-3 value chk-pb-bosch-3-buf
              set modificato to true
           end-if                            

           if como-prm-add-piombo-ampere not = old-prm-add-piombo-ampere
              move como-prm-add-piombo-ampere to chk-pb-amp-3-buf
              modify chk-pb-amp-3 value chk-pb-amp-3-buf
              set modificato to true
           end-if               

           if como-prm-stampante not = old-prm-stampante
              move como-prm-stampante to ef-stampante-3-buf
              modify ef-stampante-3 value ef-stampante-3-buf
              set modificato to true
           end-if             

           if como-prm-layout-pers not = old-prm-layout-pers
              move como-prm-layout-pers to chk-layout-pers-3-buf
              modify chk-layout-pers-3 value chk-layout-pers-3-buf
              set modificato to true
           end-if                                           

           if como-prm-path-logo not = old-prm-path-logo
              move como-prm-path-logo to ef-path-logo-3-buf
              modify ef-path-logo-3 value ef-path-logo-3-buf
              set modificato to true
           end-if             

           if como-prm-tab-depositi not = old-prm-tab-depositi
      *        move como-prm-tab-depositi to prm-tab-depositi of param
              
              perform AGGIORNA-GD-MAG-3
              set modificato to true
           end-if.

           if modificato
              perform BUF-TO-FLD-CLIENTE
              write prm-rec of param
                 invalid 
                    rewrite prm-rec of param
              end-write
           end-if.


      ***---
       AGGIORNA-GD-MAG-3.
           modify gd-mag-3, reset-grid = 1.
           perform GD-MAG-3-CONTENT.
           move 2 to riga.
           perform varying idx from 1 by 1 
                     until idx > 50
              if como-prm-mag-codice(idx) = spaces 
                 exit perform 
              end-if
              move como-prm-mag-codice(idx) to mag-codice
              read tmagaz no lock
              move como-prm-mag-codice(idx)    to col-mag-codice-3
              move como-prm-mag-ev-intera(idx) to col-mag-intera-3
              move mag-descrizione             to col-mag-descrizione-3
              modify gd-mag-3(riga, 1), cell-data col-mag-codice-3
              modify gd-mag-3(riga, 2), cell-data col-mag-descrizione-3
              modify gd-mag-3(riga, 3), cell-data col-mag-intera-3
              add 1 to riga
           end-perform.
           modify gd-mag-3, insert-rows = 1 
           .
      * <TOTEM:END>

       AGGIORNA-DESTINO.
      * <TOTEM:PARA. AGGIORNA-DESTINO>
           set modificato to false
           if chk-gestisci-4-buf = zero
              exit paragraph
           end-if

           if como-prm-gg-parziale not = old-prm-gg-parziale  
              move como-prm-gg-parziale  to ef-parz-4-buf
              modify ef-parz-4 value ef-parz-4-buf
              set modificato to true
           end-if

           if como-prm-gg-per-cons not = old-prm-gg-per-cons  
              move como-prm-gg-per-cons  to ef-gg-cons-4-buf
              modify ef-gg-cons-4 value ef-gg-cons-4-buf
              set modificato to true
           end-if
           if como-prm-gg-val-vol not = old-prm-gg-val-vol   
              move como-prm-gg-val-vol   to ef-val-4-buf
              modify ef-val-4 value ef-val-4-buf
              set modificato to true
           end-if
           if como-prm-gg-cons-max not = old-prm-gg-cons-max  
              move como-prm-gg-cons-max to ef-cons-max-4-buf
              modify ef-cons-max-4 value ef-cons-max-4-buf
              set modificato to true
           end-if
           if como-prm-vet-maggiore-kg not = old-prm-vet-maggiore-kg
              move como-prm-vet-maggiore-kg to ef-max-vet-4-buf
              modify ef-max-vet-4 value ef-max-vet-4-buf
              set modificato to true
           end-if
           if como-prm-maggiore-kg not = old-prm-maggiore-kg
              move como-prm-maggiore-kg to ef-max-kg-4-buf
              modify ef-max-kg-4 value ef-max-kg-4-buf
              set modificato to true
           end-if                                       
           if como-prm-vet-minore-kg1 not = old-prm-vet-minore-kg1
              move como-prm-vet-minore-kg1  to ef-min-vet1-4-buf
              modify ef-min-vet1-4 value ef-min-vet1-4-buf
              set modificato to true
           end-if
           if como-prm-minore-kg1 not = old-prm-minore-kg1
              move como-prm-minore-kg1 to ef-min-kg1-4-buf
              modify ef-min-kg1-4 value ef-min-kg1-4-buf
              set modificato to true
           end-if                         
           if como-prm-vet-minore-kg2 not = old-prm-vet-minore-kg2
              move como-prm-vet-minore-kg2  to ef-min-vet2-4-buf
              modify ef-min-vet2-4 value ef-min-vet2-4-buf
              set modificato to true
           end-if
           if como-prm-minore-kg1 not = old-prm-minore-kg1
              move como-prm-minore-kg1 to ef-min-kg1-4-buf
              modify ef-min-kg1-4 value ef-min-kg1-4-buf
              set modificato to true
           end-if
           if como-prm-blocco-kg not = old-prm-blocco-kg 
              move como-prm-blocco-kg to ef-blocco-kg-4-buf
              modify ef-blocco-kg-4 value ef-blocco-kg-4-buf
              set modificato to true
           end-if
           if como-prm-prenotazione-qta not = old-prm-prenotazione-qta
              move como-prm-prenotazione-qta to chk-prenot-4-buf
              modify chk-prenot-4 value chk-prenot-4-buf
              set modificato to true
           end-if
           if como-prm-accorpa not = old-prm-accorpa     
              move como-prm-accorpa to chk-accorpa-4-buf
              modify chk-accorpa-4 value chk-accorpa-4-buf
              set modificato to true
           end-if                   
           if como-prm-sost-batt not = old-prm-sost-batt
              move como-prm-sost-batt to chk-sost-batt-4-buf
              modify chk-sost-batt-4 value chk-sost-batt-4-buf
              set modificato to true
           end-if
           if como-prm-saldi-banco not = old-prm-saldi-banco 
              move como-prm-saldi-banco to chk-banco-4-buf
              modify chk-banco-4 value chk-banco-4-buf
              set modificato to true
           end-if
           if como-prm-saldi-promo not = old-prm-saldi-promo 
              move como-prm-saldi-promo to chk-promo-4-buf
              modify chk-promo-4 value chk-promo-4-buf
              set modificato to true
           end-if
           if como-prm-escludi-tutto not = old-prm-escludi-tutto
              move como-prm-escludi-tutto to chk-escludi-4-buf
              modify chk-escludi-4 value chk-escludi-4-buf
              set modificato to true
           end-if         
           if como-prm-imb-minimo not = old-prm-imb-minimo
              move como-prm-imb-minimo to chk-imb-min-4-buf
              modify chk-imb-min-4 value chk-imb-min-4-buf
              set modificato to true
           end-if
           if como-prm-cod-art-forn not = old-prm-cod-art-forn
              move como-prm-cod-art-forn to chk-art-forn-4-buf
              modify chk-art-forn-4 value chk-art-forn-4-buf
              set modificato to true
           end-if   

           if como-prm-add-piombo-perce not = old-prm-add-piombo-perce
              move como-prm-add-piombo-perce to chk-pb-perce-4-buf
              modify chk-pb-perce-4 value chk-pb-perce-4-buf
              set modificato to true
           end-if

           if como-prm-add-piombo-bosch not = old-prm-add-piombo-bosch
              move como-prm-add-piombo-bosch to chk-pb-bosch-4-buf
              modify chk-pb-bosch-4 value chk-pb-bosch-4-buf
              set modificato to true
           end-if                       

           if como-prm-add-piombo-bosch not = old-prm-add-piombo-bosch
              move como-prm-add-piombo-bosch to chk-pb-bosch-4-buf
              modify chk-pb-bosch-4 value chk-pb-bosch-4-buf
              set modificato to true
           end-if

           if como-prm-add-piombo-ampere not = old-prm-add-piombo-ampere
              move como-prm-add-piombo-ampere to chk-pb-amp-4-buf
              modify chk-pb-amp-4 value chk-pb-amp-4-buf
              set modificato to true
           end-if                     

           if como-prm-stampante not = old-prm-stampante
              move como-prm-stampante to ef-stampante-4-buf
              modify ef-stampante-4 value ef-stampante-4-buf
              set modificato to true
           end-if

           if como-prm-layout-pers not = old-prm-layout-pers
              move como-prm-layout-pers to chk-layout-pers-4-buf
              modify chk-layout-pers-4 value chk-layout-pers-4-buf
              set modificato to true
           end-if

           if como-prm-path-logo not = old-prm-path-logo
              move como-prm-path-logo to ef-path-logo-4-buf
              modify ef-path-logo-4 value ef-path-logo-4-buf
              set modificato to true
           end-if

           if como-prm-tab-depositi not = old-prm-tab-depositi
      *        move como-prm-tab-depositi to prm-tab-depositi of param
              
              perform AGGIORNA-GD-MAG-4
              set modificato to true
           end-if.

           if modificato
              perform BUF-TO-FLD-DESTINO
              write prm-rec of param
                 invalid 
                    rewrite prm-rec of param
              end-write
           end-if.


      ***---
       AGGIORNA-GD-MAG-4.
           modify gd-mag-4, reset-grid = 1.
           perform GD-MAG-4-CONTENT.
           move 2 to riga.
           perform varying idx from 1 by 1 
                     until idx > 50
              if como-prm-mag-codice(idx) = spaces 
                 exit perform 
              end-if
              move como-prm-mag-codice(idx) to mag-codice
              read tmagaz no lock
              move como-prm-mag-codice(idx)    to col-mag-codice-4
              move como-prm-mag-ev-intera(idx) to col-mag-intera-4
              move mag-descrizione             to col-mag-descrizione-4
              modify gd-mag-4(riga, 1), cell-data col-mag-codice-4
              modify gd-mag-4(riga, 2), cell-data col-mag-descrizione-4
              add 1 to riga
           end-perform.
           modify gd-mag-4, insert-rows = 1 
           .
      * <TOTEM:END>

       GESTISCI-DISABILITA.
      * <TOTEM:PARA. GESTISCI-DISABILITA>
           perform TROVA-FIGLI-ATTIVI

      *    se ho almeno un elemento gestito chiedo conferma all'utente
      *    per l'aggiornamento delle
           if gestiti
              evaluate true
              when param-lubex
                   move "Sintende non gestire eccezioni per la TIPOLOGI
      -                 "A CLIENTI/GRUPPI GDO/Clienti/Destini relativi?"
                          to messaggio
              when tipo-cli
                   move "Sintende non gestire eccezioni per i GRUPPI GD
      -                 "O/Clienti/Destini relativi?"   to messaggio
              when gruppo-gdo
                   move "Sintende non gestire eccezioni per i Clienti/D
      -                  "estini relativi?"             to messaggio
              when cliente
                   move "Sintende non gestire eccezioni per i Destini r
      -                 "elativi?"                      to messaggio
              end-evaluate
              inspect messaggio replacing trailing space by low-value
              display message box messaggio
                             title titolo
                             type mb-yes-no
                             giving scelta
              if scelta = mb-no
                 set gestiti to false
              end-if
           end-if

           if gestiti
              perform DISABILITA-EFFETTIVA
           end-if.

      ***---
       DISABILITA-EFFETTIVA.
      *    per prima cosa aggiorno i dati dei figli che ho a video
      *    così salverò direttamente le modifiche e ho il video aggiornato
           perform AGGIORNA-VIDEO-DISABILITA.     

           move como-prm-chiave to prm-chiave of param

           evaluate true
           when param-lubex                
                move low-value  to prm-tipocli of param
                                   prm-gdo of param
                                   prm-cliente of param
                                   prm-destino of param
           when tipo-cli
                move low-value  to prm-gdo of param
                                   prm-cliente of param
                                   prm-destino of param
           when gruppo-gdo
                move low-value  to prm-cliente of param
                                   prm-destino of param
           when cliente
                move low-value  to prm-destino of param
           end-evaluate


           start param key not < prm-chiave of param
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read param next no lock at end exit perform end-read

                    evaluate true
                    when param-lubex
                         if como-prm-lubex   not = prm-lubex of param
                            exit perform
                         end-if
                    when tipo-cli
                         if como-prm-lubex   not = prm-lubex of param or
                            como-prm-tipocli not = prm-tipocli of param 
                            exit perform
                         end-if
                    when gruppo-gdo
                         if como-prm-lubex   not = prm-lubex of param or
                            como-prm-tipocli not = prm-tipocli of param 
           or
                            como-prm-gdo     not = prm-gdo of param
                            exit perform
                         end-if
                    when cliente
                         if como-prm-lubex   not = prm-lubex of param or
                            como-prm-tipocli not = prm-tipocli of param 
           or
                            como-prm-gdo     not = prm-gdo of param or
                            como-prm-cliente not = prm-cliente of param
                            exit perform
                         end-if
                    end-evaluate
                    if prm-gestisci-si of param
                       perform VAL-REC-DISABILITA
                    end-if

                 end-perform
           end-start.

      ***---
       VAL-REC-DISABILITA.

           set prm-gestisci-no of param  to true
           move zero   to prm-gg-inizio-vol   of param
                          prm-gg-parziale     of param
                          prm-gg-per-cons     of param
                          prm-gg-val-vol      of param
                          prm-gg-cons-max     of param
                          prm-vet-maggiore-kg of param
                          prm-maggiore-kg     of param
                          prm-vet-minore-kg1  of param
                          prm-minore-kg1      of param
                          prm-vet-minore-kg2  of param
                          prm-minore-kg2      of param
                          prm-blocco-kg       of param

           set prm-prenotazione-qta-no of param to true
           set prm-accorpa-no          of param to true
           set prm-sost-batt-no        of param to true
           set prm-saldi-banco-no      of param to true
           set prm-saldi-promo-no      of param to true
           set prm-escludi-tutto-no    of param to true
           set prm-imb-minimo-no       of param to true 
           set prm-cod-art-forn-no     of param to true
           set prm-add-piombo-perce-no  of param to true
           set prm-add-piombo-ampere-no of param to true
           set prm-add-piombo-bosch-no of param to true

           initialize prm-tab-depositi of param.

           accept prm-data-modifica    of param from century-date
           accept prm-ora-modifica     of param  from time
           move user-codi to prm-utente-modifica of param

           write prm-rec of param
                 invalid rewrite prm-rec of param
           end-write.

      ***---
       AGGIORNA-VIDEO-DISABILITA.
           evaluate true
           when tipo-cli
                if chk-gestisci-2-buf = 1
                   perform DISABILITA-GDO
                end-if
                if chk-gestisci-3-buf = 1
                   perform DISABILITA-CLIENTE
                end-if
                if chk-gestisci-4-buf = 1
                   perform DISABILITA-DESTINO
                end-if

           when gruppo-gdo
                if chk-gestisci-3-buf = 1
                   perform DISABILITA-CLIENTE
                end-if
                if chk-gestisci-4-buf = 1
                   perform DISABILITA-DESTINO
                end-if
           when cliente
                if chk-gestisci-4-buf = 1
                   perform DISABILITA-DESTINO
                end-if
           end-evaluate.

      ***---
       DISABILITA-GDO.
           move zero to chk-gestisci-2-buf
           modify chk-gestisci-2 value chk-gestisci-2-buf
           perform chk-gestisci-2-LinkTo.

      *     perform BUF-TO-FLD-GDO
      *     write prm-rec of param
      *        invalid 
      *           rewrite prm-rec of param
      *     end-write.

      ***---
       DISABILITA-CLIENTE.
           move zero to chk-gestisci-3-buf
           modify chk-gestisci-3 value chk-gestisci-3-buf
           perform chk-gestisci-3-LinkTo.

      *     perform BUF-TO-FLD-CLIENTE.
      *     write prm-rec of param
      *        invalid 
      *           rewrite prm-rec of param
      *     end-write.

      ***---
       DISABILITA-DESTINO.
           move zero to chk-gestisci-4-buf
           modify chk-gestisci-4 value chk-gestisci-4-buf
           perform chk-gestisci-4-LinkTo.
      *     perform BUF-TO-FLD-DESTINO.
      *     write prm-rec of param
      *        invalid 
      *           rewrite prm-rec of param
      *     end-write 
           .
      * <TOTEM:END>

       TROVA-FIGLI-ATTIVI.
      * <TOTEM:PARA. TROVA-FIGLI-ATTIVI>
           set gestiti to false
                                                   
           move prm-rec of param to como-prm-rec

      *    faccio un primo cliclo per verificare di avere dei figli gestiti
      *     move prm-chiave of param   to prm-chiave of param1

           evaluate true
           when param-lubex                
                move low-value  to prm-tipocli of param
                                   prm-gdo of param
                                   prm-cliente of param
                                   prm-destino of param
           when tipo-cli
                move low-value  to prm-gdo of param
                                   prm-cliente of param
                                   prm-destino of param
           when gruppo-gdo
                move low-value  to prm-cliente of param
                                   prm-destino of param
           when cliente
                move low-value  to prm-destino of param
           end-evaluate


           start param key not < prm-chiave of param
              invalid
                 continue
              not invalid
                 perform until 1 = 2
                    read param next no lock
                       at end
                          exit perform
                    end-read

                    evaluate true
                    when param-lubex
                         if como-prm-lubex   not = prm-lubex of param
                            exit perform
                         end-if
                    when tipo-cli
                         if como-prm-lubex   not = prm-lubex of param or
                            como-prm-tipocli not = prm-tipocli of param
                            exit perform
                         end-if
                    when gruppo-gdo
                         if como-prm-lubex   not = prm-lubex of param or
                            como-prm-tipocli not = prm-tipocli of param 
           or
                            como-prm-gdo     not = prm-gdo of param
                            exit perform
                         end-if
                    when cliente
                         if como-prm-lubex   not = prm-lubex of param or
                            como-prm-tipocli not = prm-tipocli of param 
           or
                            como-prm-gdo     not = prm-gdo of param or
                            como-prm-cliente not = prm-cliente of param
                            exit perform
                         end-if
                    end-evaluate
                    if prm-gestisci-si of param
                       set gestiti   to true
                       exit perform
                    end-if
                 end-perform
           end-start 
           .
      * <TOTEM:END>

       BUF-TO-FLD-LUBEX.
      * <TOTEM:PARA. BUF-TO-FLD-LUBEX>
           move ef-ini-vol-buf   to prm-gg-inizio-vol    of param.
           move ef-parz-buf      to prm-gg-parziale      of param.
           move ef-gg-cons-buf   to prm-gg-per-cons      of param.
           move ef-val-buf       to prm-gg-val-vol       of param.
           move ef-cons-max-buf  to prm-gg-cons-max      of param.
           move ef-max-vet-buf   to prm-vet-maggiore-kg  of param.
           move ef-max-kg-buf    to prm-maggiore-kg      of param.
           move ef-min-vet1-buf   to prm-vet-minore-kg1    of param.
           move ef-min-kg1-buf    to prm-minore-kg1        of param.
           move ef-min-vet2-buf   to prm-vet-minore-kg2    of param.
           move ef-min-kg2-buf    to prm-minore-kg2        of param.
           move ef-blocco-kg-buf to prm-blocco-kg        of param.
           move chk-prenot-buf   to prm-prenotazione-qta of param. 
           move chk-accorpa-buf  to prm-accorpa          of param.
           move chk-sost-batt-buf  to prm-sost-batt          of param.
           move chk-banco-buf    to prm-saldi-banco      of param.
           move chk-promo-buf    to prm-saldi-promo      of param.
           move chk-escludi-buf  to prm-escludi-tutto    of param.
           move chk-imb-min-buf  to prm-imb-minimo       of param.
           move chk-art-forn-buf to prm-cod-art-forn     of param.
           move chk-pb-perce-buf to prm-add-piombo-perce  of param.
           move chk-pb-amp-buf   to prm-add-piombo-ampere of param.
           move chk-pb-bosch-buf to prm-add-piombo-bosch  of param.
           move ef-stampante-buf to prm-stampante         of param.
           move chk-layout-pers-buf to prm-layout-pers      of param.
           move ef-path-logo-buf to prm-path-logo         of param.

           initialize prm-tab-depositi of param.
           inquire gd-mag, last-row in tot-righe.
           move 1 to idx.
           perform varying riga from 2 by 1 
                     until riga > tot-righe
              inquire gd-mag(riga, 1), cell-data in col-mag-codice
              move col-mag-codice to prm-mag-codice of param(idx)

              inquire gd-mag(riga, 3), cell-data in col-mag-intera
              move col-mag-intera to prm-mag-ev-intera of param(idx)
              add 1 to idx
           end-perform 

           .
      * <TOTEM:END>

       BUF-TO-FLD-TIPOCLI.
      * <TOTEM:PARA. BUF-TO-FLD-TIPOCLI>
           if v-gdo = 1
              move ef-ini-vol-1-buf   to prm-gg-inizio-vol of param
           else
              move 0                  to prm-gg-inizio-vol of param
           end-if
           move ef-parz-1-buf      to prm-gg-parziale     of param
           move ef-gg-cons-1-buf   to prm-gg-per-cons     of param
           move ef-val-1-buf       to prm-gg-val-vol      of param
           move ef-cons-max-1-buf  to prm-gg-cons-max     of param
           move ef-max-vet-1-buf   to prm-vet-maggiore-kg of param
           move ef-max-kg-1-buf    to prm-maggiore-kg     of param
           move ef-min-vet1-1-buf   to prm-vet-minore-kg1   of param
           move ef-min-kg1-1-buf    to prm-minore-kg1       of param
           move ef-min-vet2-1-buf   to prm-vet-minore-kg2   of param
           move ef-min-kg2-1-buf    to prm-minore-kg2       of param
           move ef-blocco-kg-1-buf to prm-blocco-kg       of param
           move chk-prenot-1-buf   to prm-prenotazione-qta of param
           move chk-accorpa-1-buf  to prm-accorpa         of param
           move chk-sost-batt-1-buf  to prm-sost-batt of param
           move chk-banco-1-buf    to prm-saldi-banco     of param
           move chk-promo-1-buf    to prm-saldi-promo     of param
           move chk-escludi-1-buf  to prm-escludi-tutto   of param
           move chk-imb-min-1-buf  to prm-imb-minimo      of param
           move chk-art-forn-1-buf to prm-cod-art-forn    of param. 
           move chk-pb-perce-1-buf to prm-add-piombo-perce  of param.
           move chk-pb-amp-1-buf   to prm-add-piombo-ampere of param.
           move chk-pb-bosch-1-buf to prm-add-piombo-bosch  of param.
           move ef-stampante-1-buf to prm-stampante of param.
           move chk-layout-pers-1-buf to prm-layout-pers of param.
           move ef-path-logo-1-buf to prm-path-logo of param.

           initialize prm-tab-depositi of param
           inquire gd-mag-1, last-row in tot-righe
           move 1 to idx
           perform varying riga from 2 by 1 
                     until riga > tot-righe
              inquire gd-mag-1(riga, 1), cell-data in col-mag-codice-1
              move col-mag-codice-1 to prm-mag-codice of param(idx)

              inquire gd-mag-1(riga, 3), cell-data in col-mag-intera-1
              move col-mag-intera-1 to prm-mag-ev-intera of param(idx)

              add 1 to idx
           end-perform
           initialize prm-chiave of param
                                   replacing numeric data by zeroes
                                      alphanumeric data by spaces
           move save-tipocli       to prm-tipocli of param
           move chk-gestisci-1-buf to prm-gestisci of param 

           .
      * <TOTEM:END>

       BUF-TO-FLD-GDO.
      * <TOTEM:PARA. BUF-TO-FLD-GDO>
           move ef-ini-vol-2-buf   to prm-gg-inizio-vol   of param
           move ef-parz-2-buf      to prm-gg-parziale     of param
           move ef-gg-cons-2-buf   to prm-gg-per-cons     of param
           move ef-val-2-buf       to prm-gg-val-vol      of param
           move ef-cons-max-2-buf  to prm-gg-cons-max     of param
           move ef-max-vet-2-buf   to prm-vet-maggiore-kg of param
           move ef-max-kg-2-buf    to prm-maggiore-kg     of param
           move ef-min-vet1-2-buf   to prm-vet-minore-kg1   of param
           move ef-min-kg1-2-buf    to prm-minore-kg1       of param
           move ef-min-vet2-2-buf   to prm-vet-minore-kg2   of param
           move ef-min-kg2-2-buf    to prm-minore-kg2       of param
           move ef-blocco-kg-2-buf to prm-blocco-kg       of param
           move chk-prenot-2-buf   to prm-prenotazione-qta of param
           move chk-accorpa-2-buf  to prm-accorpa         of param  
           move chk-sost-batt-2-buf  to prm-sost-batt of param
           move chk-banco-2-buf    to prm-saldi-banco     of param
           move chk-promo-2-buf    to prm-saldi-promo     of param
           move chk-escludi-2-buf  to prm-escludi-tutto   of param
           move chk-imb-min-2-buf  to prm-imb-minimo      of param
           move chk-art-forn-2-buf to prm-cod-art-forn    of param. 
           move chk-pb-perce-2-buf to prm-add-piombo-perce  of param.
           move chk-pb-amp-2-buf   to prm-add-piombo-ampere of param.
           move chk-pb-bosch-2-buf   to prm-add-piombo-bosch of param.  
           move ef-stampante-2-buf to prm-stampante of param.
           move ef-path-logo-2-buf to prm-path-logo of param.
           move chk-layout-pers-2-buf to prm-layout-pers of param.

           initialize prm-tab-depositi of param
           inquire gd-mag-2, last-row in tot-righe
           move 1 to idx
           perform varying riga from 2 by 1 
                     until riga > tot-righe
              inquire gd-mag-2(riga, 1), cell-data in col-mag-codice-2
              move col-mag-codice-2 to prm-mag-codice of param(idx)

              inquire gd-mag-2(riga, 3), cell-data in col-mag-intera-2
              move col-mag-intera-2 to prm-mag-ev-intera of param(idx)

              add 1 to idx
           end-perform
           initialize prm-chiave of param
                                   replacing numeric data by zeroes
                                      alphanumeric data by spaces
           move save-tipocli       to prm-tipocli  of param
           move save-gdo           to prm-gdo      of param
           move chk-gestisci-2-buf to prm-gestisci of param 

           .
      * <TOTEM:END>

       BUF-TO-FLD-CLIENTE.
      * <TOTEM:PARA. BUF-TO-FLD-CLIENTE>
           move ef-parz-3-buf      to prm-gg-parziale     of param
           move ef-gg-cons-3-buf   to prm-gg-per-cons     of param
           move ef-val-3-buf       to prm-gg-val-vol      of param
           move ef-cons-max-3-buf  to prm-gg-cons-max     of param
           move ef-max-vet-3-buf   to prm-vet-maggiore-kg of param
           move ef-max-kg-3-buf    to prm-maggiore-kg     of param
           move ef-min-vet1-3-buf   to prm-vet-minore-kg1   of param
           move ef-min-kg1-3-buf    to prm-minore-kg1       of param
           move ef-min-vet2-3-buf   to prm-vet-minore-kg2   of param
           move ef-min-kg2-3-buf    to prm-minore-kg2       of param
           move ef-blocco-kg-3-buf to prm-blocco-kg       of param
           move chk-prenot-3-buf   to prm-prenotazione-qta of param
           move chk-accorpa-3-buf  to prm-accorpa         of param
           move chk-sost-batt-3-buf  to prm-sost-batt of param
           move chk-banco-3-buf    to prm-saldi-banco     of param
           move chk-promo-3-buf    to prm-saldi-promo     of param
           move chk-escludi-3-buf  to prm-escludi-tutto   of param
           move chk-imb-min-3-buf  to prm-imb-minimo      of param
           move chk-art-forn-3-buf to prm-cod-art-forn    of param.
           move chk-pb-perce-3-buf to prm-add-piombo-perce  of param.
           move chk-pb-amp-3-buf   to prm-add-piombo-ampere of param.
           move chk-pb-bosch-3-buf to prm-add-piombo-bosch of param. 
           move ef-stampante-3-buf to prm-stampante of param.
           move ef-path-logo-3-buf to prm-path-logo of param.
           move chk-layout-pers-3-buf to prm-layout-pers of param.

           initialize prm-tab-depositi of param
           inquire gd-mag-3, last-row in tot-righe
           move 1 to idx
           perform varying riga from 2 by 1 
                     until riga > tot-righe
              inquire gd-mag-3(riga, 1), cell-data in col-mag-codice-3
              move col-mag-codice-3 to prm-mag-codice of param(idx)

              inquire gd-mag-3(riga, 3), cell-data in col-mag-intera-3
              move col-mag-intera-3 to prm-mag-ev-intera of param(idx)

              add 1 to idx
           end-perform
           initialize prm-chiave of param
                                   replacing numeric data by zeroes
                                      alphanumeric data by spaces
           move save-tipocli       to prm-tipocli  of param
           move save-gdo           to prm-gdo      of param
           move save-cliente       to prm-cliente  of param
           move chk-gestisci-3-buf to prm-gestisci of param 

           .
      * <TOTEM:END>

       BUF-TO-FLD-DESTINO.
      * <TOTEM:PARA. BUF-TO-FLD-DESTINO>
           move ef-parz-4-buf      to prm-gg-parziale     of param
           move ef-gg-cons-4-buf   to prm-gg-per-cons     of param
           move ef-val-4-buf       to prm-gg-val-vol      of param
           move ef-cons-max-4-buf  to prm-gg-cons-max     of param
           move ef-max-vet-4-buf   to prm-vet-maggiore-kg of param
           move ef-max-kg-4-buf    to prm-maggiore-kg     of param
           move ef-min-vet1-4-buf   to prm-vet-minore-kg1   of param
           move ef-min-kg1-4-buf    to prm-minore-kg1       of param
           move ef-min-vet2-4-buf   to prm-vet-minore-kg2   of param
           move ef-min-kg2-4-buf    to prm-minore-kg2       of param
           move ef-blocco-kg-4-buf to prm-blocco-kg       of param
           move chk-prenot-4-buf   to prm-prenotazione-qta of param
           move chk-accorpa-4-buf  to prm-accorpa         of param    
           move chk-sost-batt-4-buf  to prm-sost-batt of param
           move chk-banco-4-buf    to prm-saldi-banco     of param
           move chk-promo-4-buf    to prm-saldi-promo     of param
           move chk-escludi-4-buf  to prm-escludi-tutto   of param 
           move chk-imb-min-4-buf  to prm-imb-minimo      of param.
           move chk-art-forn-4-buf to prm-cod-art-forn    of param. 
           move chk-pb-perce-4-buf to prm-add-piombo-perce  of param.
           move chk-pb-amp-4-buf   to prm-add-piombo-ampere of param.
           move chk-pb-bosch-4-buf to prm-add-piombo-bosch of param.
           move ef-stampante-4-buf to prm-stampante of param.
           move chk-layout-pers-4-buf to prm-layout-pers of param.
           move ef-path-logo-4-buf to prm-path-logo of param.

           initialize prm-tab-depositi of param
           inquire gd-mag-4, last-row in tot-righe
           move 1 to idx
           perform varying riga from 2 by 1 
                     until riga > tot-righe
              inquire gd-mag-4(riga, 1), cell-data in col-mag-codice-4
              move col-mag-codice-4 to prm-mag-codice of param(idx)

              inquire gd-mag-4(riga, 3), cell-data in col-mag-intera-4
              move col-mag-intera-4 to prm-mag-ev-intera of param(idx)

              add 1 to idx
           end-perform
           initialize prm-chiave of param
                                   replacing numeric data by zeroes
                                      alphanumeric data by spaces
           move save-tipocli       to prm-tipocli  of param
           move save-gdo           to prm-gdo      of param
           move save-cliente       to prm-cliente  of param
           move save-destino       to prm-destino  of param
           move chk-gestisci-4-buf to prm-gestisci of param 
           .
      * <TOTEM:END>

       FILE-SELECTOR.
      * <TOTEM:PARA. FILE-SELECTOR>
           move spaces to path-logo.
           initialize opensave-data.   

           if path-logo = spaces
              move path-logo to opnsav-default-dir
              initialize opnsav-filters
              string "JPG files (*.jpg)|*.jpg"        delimited size
                     "|BMP files (*.bmp)|*.bmp"       delimited size
                     into  opnsav-filters
              end-string
              move 1 to opnsav-default-filter
              move "Geslux -  Selezione logo personalizato bolle" to 
           opnsav-title
              call "C$OPENSAVEBOX" using opensave-save-box, 
                                         opensave-data,
                                  giving opensave-status
      
              if opensave-status = 1
                 move opnsav-filename to path-logo
              end-if
           else
              initialize comando
              move path-note to opnsav-filename
              inspect path-note replacing trailing spaces by low-value
              string "START "   delimited size
                    x"22222022" delimited size
                     path-note  delimited low-value
                    x"22"       delimited size
                     into comando
              end-string
              call "C$SYSTEM" using comando, 64
                             giving ReturnCode
              if ReturnCode = -1
                 display message box "Comando fallito!"
                         title = tit-err
                         icon mb-error-icon
              end-if
           end-if 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       TOOL-CANCELLA-LinkTo.
      * <TOTEM:PARA. TOOL-CANCELLA-LinkTo>
           .
      * <TOTEM:END>
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           inquire tool-salva, enabled in e-salva.
           if e-salva = 1
              perform SALVA
           end-if 
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
           perform MODIFICA 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca.
           if e-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       gparam-Ev-Before-Program.
      * <TOTEM:PARA. gparam-Ev-Before-Program>
           move LK-BL-PROG-ID    TO COMO-PROG-ID.
           perform CALCOLA-COLORE-TRASPARENTE 
           .
      * <TOTEM:END>
       gparam-Ev-After-Program.
      * <TOTEM:PARA. gparam-Ev-After-Program>
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM 
           .
      * <TOTEM:END>
       ef-ini-vol-BeforeProcedure.
      * <TOTEM:PARA. ef-ini-vol-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-parz-BeforeProcedure.
      * <TOTEM:PARA. ef-parz-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg-cons-BeforeProcedure.
      * <TOTEM:PARA. ef-gg-cons-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cons-max-BeforeProcedure.
      * <TOTEM:PARA. ef-cons-max-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-val-BeforeProcedure.
      * <TOTEM:PARA. ef-val-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-vet-BeforeProcedure.
      * <TOTEM:PARA. ef-max-vet-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-BeforeProcedure.
      * <TOTEM:PARA. ef-min-kg-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-kg-BeforeProcedure.
      * <TOTEM:PARA. ef-max-kg-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-blocco-kg-BeforeProcedure.
      * <TOTEM:PARA. ef-blocco-kg-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ini-vol-1-BeforeProcedure.
      * <TOTEM:PARA. ef-ini-vol-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-parz-1-BeforeProcedure.
      * <TOTEM:PARA. ef-parz-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg-cons-1-BeforeProcedure.
      * <TOTEM:PARA. ef-gg-cons-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cons-max-1-BeforeProcedure.
      * <TOTEM:PARA. ef-cons-max-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-val-1-BeforeProcedure.
      * <TOTEM:PARA. ef-val-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-vet-1-BeforeProcedure.
      * <TOTEM:PARA. ef-max-vet-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-1-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-1-BeforeProcedure.
      * <TOTEM:PARA. ef-min-kg-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-kg-1-BeforeProcedure.
      * <TOTEM:PARA. ef-max-kg-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-blocco-kg-1-BeforeProcedure.
      * <TOTEM:PARA. ef-blocco-kg-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ini-vol-2-BeforeProcedure.
      * <TOTEM:PARA. ef-ini-vol-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-parz-2-BeforeProcedure.
      * <TOTEM:PARA. ef-parz-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg-cons-2-BeforeProcedure.
      * <TOTEM:PARA. ef-gg-cons-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cons-max-2-BeforeProcedure.
      * <TOTEM:PARA. ef-cons-max-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-val-2-BeforeProcedure.
      * <TOTEM:PARA. ef-val-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-vet-2-BeforeProcedure.
      * <TOTEM:PARA. ef-max-vet-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-2-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-2-BeforeProcedure.
      * <TOTEM:PARA. ef-min-kg-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-kg-2-BeforeProcedure.
      * <TOTEM:PARA. ef-max-kg-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-blocco-kg-2-BeforeProcedure.
      * <TOTEM:PARA. ef-blocco-kg-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-parz-3-BeforeProcedure.
      * <TOTEM:PARA. ef-parz-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg-cons-3-BeforeProcedure.
      * <TOTEM:PARA. ef-gg-cons-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cons-max-3-BeforeProcedure.
      * <TOTEM:PARA. ef-cons-max-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-val-3-BeforeProcedure.
      * <TOTEM:PARA. ef-val-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-vet-3-BeforeProcedure.
      * <TOTEM:PARA. ef-max-vet-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-3-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-3-BeforeProcedure.
      * <TOTEM:PARA. ef-min-kg-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-kg-3-BeforeProcedure.
      * <TOTEM:PARA. ef-max-kg-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-blocco-kg-3-BeforeProcedure.
      * <TOTEM:PARA. ef-blocco-kg-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-parz-4-BeforeProcedure.
      * <TOTEM:PARA. ef-parz-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg-cons-4-BeforeProcedure.
      * <TOTEM:PARA. ef-gg-cons-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cons-max-4-BeforeProcedure.
      * <TOTEM:PARA. ef-cons-max-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-val-4-BeforeProcedure.
      * <TOTEM:PARA. ef-val-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-vet-4-BeforeProcedure.
      * <TOTEM:PARA. ef-max-vet-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-4-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-4-BeforeProcedure.
      * <TOTEM:PARA. ef-min-kg-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-max-kg-4-BeforeProcedure.
      * <TOTEM:PARA. ef-max-kg-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-blocco-kg-4-BeforeProcedure.
      * <TOTEM:PARA. ef-blocco-kg-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-ini-vol-AfterProcedure.
      * <TOTEM:PARA. ef-ini-vol-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-parz-AfterProcedure.
      * <TOTEM:PARA. ef-parz-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-gg-cons-AfterProcedure.
      * <TOTEM:PARA. ef-gg-cons-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-cons-max-AfterProcedure.
      * <TOTEM:PARA. ef-cons-max-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-val-AfterProcedure.
      * <TOTEM:PARA. ef-val-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-max-vet-AfterProcedure.
      * <TOTEM:PARA. ef-max-vet-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-AfterProcedure.
      * <TOTEM:PARA. ef-min-kg-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       ef-max-kg-AfterProcedure.
      * <TOTEM:PARA. ef-max-kg-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-blocco-kg-AfterProcedure.
      * <TOTEM:PARA. ef-blocco-kg-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-ini-vol-1-AfterProcedure.
      * <TOTEM:PARA. ef-ini-vol-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-parz-1-AfterProcedure.
      * <TOTEM:PARA. ef-parz-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-gg-cons-1-AfterProcedure.
      * <TOTEM:PARA. ef-gg-cons-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-cons-max-1-AfterProcedure.
      * <TOTEM:PARA. ef-cons-max-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-val-1-AfterProcedure.
      * <TOTEM:PARA. ef-val-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-max-vet-1-AfterProcedure.
      * <TOTEM:PARA. ef-max-vet-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-1-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-1-AfterProcedure.
      * <TOTEM:PARA. ef-min-kg-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       ef-max-kg-1-AfterProcedure.
      * <TOTEM:PARA. ef-max-kg-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-blocco-kg-1-AfterProcedure.
      * <TOTEM:PARA. ef-blocco-kg-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-ini-vol-2-AfterProcedure.
      * <TOTEM:PARA. ef-ini-vol-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-parz-2-AfterProcedure.
      * <TOTEM:PARA. ef-parz-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-gg-cons-2-AfterProcedure.
      * <TOTEM:PARA. ef-gg-cons-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-cons-max-2-AfterProcedure.
      * <TOTEM:PARA. ef-cons-max-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-val-2-AfterProcedure.
      * <TOTEM:PARA. ef-val-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-max-vet-2-AfterProcedure.
      * <TOTEM:PARA. ef-max-vet-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-2-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-2-AfterProcedure.
      * <TOTEM:PARA. ef-min-kg-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       ef-max-kg-2-AfterProcedure.
      * <TOTEM:PARA. ef-max-kg-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-blocco-kg-2-AfterProcedure.
      * <TOTEM:PARA. ef-blocco-kg-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-parz-3-AfterProcedure.
      * <TOTEM:PARA. ef-parz-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-gg-cons-3-AfterProcedure.
      * <TOTEM:PARA. ef-gg-cons-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-cons-max-3-AfterProcedure.
      * <TOTEM:PARA. ef-cons-max-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-val-3-AfterProcedure.
      * <TOTEM:PARA. ef-val-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-max-vet-3-AfterProcedure.
      * <TOTEM:PARA. ef-max-vet-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-3-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-3-AfterProcedure.
      * <TOTEM:PARA. ef-min-kg-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       ef-max-kg-3-AfterProcedure.
      * <TOTEM:PARA. ef-max-kg-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-blocco-kg-3-AfterProcedure.
      * <TOTEM:PARA. ef-blocco-kg-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-parz-4-AfterProcedure.
      * <TOTEM:PARA. ef-parz-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-gg-cons-4-AfterProcedure.
      * <TOTEM:PARA. ef-gg-cons-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-cons-max-4-AfterProcedure.
      * <TOTEM:PARA. ef-cons-max-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-val-4-AfterProcedure.
      * <TOTEM:PARA. ef-val-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-max-vet-4-AfterProcedure.
      * <TOTEM:PARA. ef-max-vet-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-vet-4-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP 
           .
      * <TOTEM:END>
       ef-min-kg-4-AfterProcedure.
      * <TOTEM:PARA. ef-min-kg-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       ef-max-kg-4-AfterProcedure.
      * <TOTEM:PARA. ef-max-kg-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-blocco-kg-4-AfterProcedure.
      * <TOTEM:PARA. ef-blocco-kg-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-accorpa-BeforeProcedure.
      * <TOTEM:PARA. chk-accorpa-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-intera-BeforeProcedure.
      * <TOTEM:PARA. chk-intera-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-banco-BeforeProcedure.
      * <TOTEM:PARA. chk-banco-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-promo-BeforeProcedure.
      * <TOTEM:PARA. chk-promo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-accorpa-1-BeforeProcedure.
      * <TOTEM:PARA. chk-accorpa-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-intera-1-BeforeProcedure.
      * <TOTEM:PARA. chk-intera-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-banco-1-BeforeProcedure.
      * <TOTEM:PARA. chk-banco-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-promoa-BeforeProcedure.
      * <TOTEM:PARA. chk-promoa-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-accorpa-2-BeforeProcedure.
      * <TOTEM:PARA. chk-accorpa-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-intera-2-BeforeProcedure.
      * <TOTEM:PARA. chk-intera-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-banco-2-BeforeProcedure.
      * <TOTEM:PARA. chk-banco-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-promo-2-BeforeProcedure.
      * <TOTEM:PARA. chk-promo-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-accorpa-3-BeforeProcedure.
      * <TOTEM:PARA. chk-accorpa-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-intera-3-BeforeProcedure.
      * <TOTEM:PARA. chk-intera-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-banco-3-BeforeProcedure.
      * <TOTEM:PARA. chk-banco-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-promo-3-BeforeProcedure.
      * <TOTEM:PARA. chk-promo-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-accorpa-4-BeforeProcedure.
      * <TOTEM:PARA. chk-accorpa-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-intera-4-BeforeProcedure.
      * <TOTEM:PARA. chk-intera-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-banco-4-BeforeProcedure.
      * <TOTEM:PARA. chk-banco-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-promo-4-BeforeProcedure.
      * <TOTEM:PARA. chk-promo-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-accorpa-AfterProcedure.
      * <TOTEM:PARA. chk-accorpa-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-intera-AfterProcedure.
      * <TOTEM:PARA. chk-intera-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-banco-AfterProcedure.
      * <TOTEM:PARA. chk-banco-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-promo-AfterProcedure.
      * <TOTEM:PARA. chk-promo-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-accorpa-1-AfterProcedure.
      * <TOTEM:PARA. chk-accorpa-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-intera-1-AfterProcedure.
      * <TOTEM:PARA. chk-intera-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-banco-1-AfterProcedure.
      * <TOTEM:PARA. chk-banco-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-promoa-AfterProcedure.
      * <TOTEM:PARA. chk-promoa-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-accorpa-2-AfterProcedure.
      * <TOTEM:PARA. chk-accorpa-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-intera-2-AfterProcedure.
      * <TOTEM:PARA. chk-intera-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-banco-2-AfterProcedure.
      * <TOTEM:PARA. chk-banco-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-promo-2-AfterProcedure.
      * <TOTEM:PARA. chk-promo-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-accorpa-3-AfterProcedure.
      * <TOTEM:PARA. chk-accorpa-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-intera-3-AfterProcedure.
      * <TOTEM:PARA. chk-intera-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-banco-3-AfterProcedure.
      * <TOTEM:PARA. chk-banco-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-promo-3-AfterProcedure.
      * <TOTEM:PARA. chk-promo-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-accorpa-4-AfterProcedure.
      * <TOTEM:PARA. chk-accorpa-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-intera-4-AfterProcedure.
      * <TOTEM:PARA. chk-intera-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-banco-4-AfterProcedure.
      * <TOTEM:PARA. chk-banco-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-promo-4-AfterProcedure.
      * <TOTEM:PARA. chk-promo-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       gd-tipocli-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-tipocli-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       gd-gdo-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-gdo-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       gd-destini-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-destini-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       gd-clienti-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-clienti-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       gd-tipocli-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-tipocli-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-TIPOCLI 
           .
      * <TOTEM:END>
       gd-tipocli-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-tipocli-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-TIPOCLI 
           .
      * <TOTEM:END>
       gd-tipocli-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-tipocli-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-TIPOCLI 
           .
      * <TOTEM:END>
       gd-tipocli-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-tipocli-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-TIPOCLI 
           .
      * <TOTEM:END>
       gd-tipocli-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-tipocli-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-TIPOCLI 
           .
      * <TOTEM:END>
       gd-clienti-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-clienti-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-CLIENTI 
           .
      * <TOTEM:END>
       gd-clienti-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-clienti-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-CLIENTI 
           .
      * <TOTEM:END>
       gd-clienti-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-clienti-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-CLIENTI 
           .
      * <TOTEM:END>
       gd-clienti-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-clienti-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-CLIENTI 
           .
      * <TOTEM:END>
       gd-clienti-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-clienti-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-CLIENTI 
           .
      * <TOTEM:END>
       gd-destini-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-destini-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-DESTINI 
           .
      * <TOTEM:END>
       gd-destini-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-destini-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-DESTINI 
           .
      * <TOTEM:END>
       gd-destini-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-destini-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-DESTINI 
           .
      * <TOTEM:END>
       gd-destini-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-destini-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-DESTINI 
           .
      * <TOTEM:END>
       gd-destini-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-destini-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-DESTINI 
           .
      * <TOTEM:END>
       gd-gdo-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-gdo-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-GDO 
           .
      * <TOTEM:END>
       gd-gdo-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-gdo-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-GDO 
           .
      * <TOTEM:END>
       gd-gdo-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-gdo-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-GDO 
           .
      * <TOTEM:END>
       gd-gdo-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-gdo-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-GDO 
           .
      * <TOTEM:END>
       gd-gdo-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-gdo-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-GDO 
           .
      * <TOTEM:END>
       chk-gestisci-1-BeforeProcedure.
      * <TOTEM:PARA. chk-gestisci-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-gestisci-1-AfterProcedure.
      * <TOTEM:PARA. chk-gestisci-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-gestisci-2-BeforeProcedure.
      * <TOTEM:PARA. chk-gestisci-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-gestisci-2-AfterProcedure.
      * <TOTEM:PARA. chk-gestisci-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-gestisci-3-BeforeProcedure.
      * <TOTEM:PARA. chk-gestisci-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-gestisci-3-AfterProcedure.
      * <TOTEM:PARA. chk-gestisci-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-gestisci-3a-BeforeProcedure.
      * <TOTEM:PARA. chk-gestisci-3a-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-gestisci-3a-AfterProcedure.
      * <TOTEM:PARA. chk-gestisci-3a-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-gestisci-1-LinkTo.
      * <TOTEM:PARA. chk-gestisci-1-LinkTo>
           inquire chk-gestisci-1, value in chk-gestisci-1-buf.
           if chk-gestisci-1-buf = 1
              move ef-ini-vol-buf    to ef-ini-vol-1-buf   
              move ef-parz-buf       to ef-parz-1-buf      
              move ef-gg-cons-buf    to ef-gg-cons-1-buf   
              move ef-val-buf        to ef-val-1-buf       
              move ef-cons-max-buf   to ef-cons-max-1-buf  
              move ef-max-vet-buf    to ef-max-vet-1-buf   
              move lab-vet-max-buf   to lab-vet-max-1-buf  
              move ef-max-kg-buf     to ef-max-kg-1-buf    
              move ef-min-vet1-buf    to ef-min-vet1-1-buf     
              move lab-vet-min1-buf   to lab-vet-min1-1-buf   
              move ef-min-kg1-buf     to ef-min-kg1-1-buf    
              move ef-blocco-kg-buf   to ef-blocco-kg-1-buf 
              move ef-min-vet2-buf    to ef-min-vet2-1-buf     
              move lab-vet-min2-buf   to lab-vet-min2-1-buf
              move lab-vet-min2-buf   to lab-vet-min2-1-buf   
              move ef-min-kg2-buf     to ef-min-kg2-1-buf    
              move ef-blocco-kg-buf  to ef-blocco-kg-1-buf 
              move chk-prenot-buf    to chk-prenot-1-buf   
              move chk-accorpa-buf   to chk-accorpa-1-buf  
              move chk-sost-batt-buf to chk-sost-batt-1-buf  
              move chk-banco-buf     to chk-banco-1-buf    
              move chk-promo-buf     to chk-promo-1-buf    
              move chk-escludi-buf   to chk-escludi-1-buf 
              move chk-imb-min-buf   to chk-imb-min-1-buf
              move chk-art-forn-buf  to chk-art-forn-1-buf
              move chk-pb-perce-buf  to chk-pb-perce-1-buf
              move chk-pb-amp-buf    to chk-pb-amp-1-buf
              move chk-pb-bosch-buf  to chk-pb-bosch-1-buf
              move ef-stampante-buf  to ef-stampante-1-buf
              move chk-layout-pers-buf   to chk-layout-pers-1-buf
              move ef-path-logo-buf      to ef-path-logo-1-buf
              inquire gd-mag, last-row in tot-righe
              modify gd-mag-1, reset-grid = 1
              perform GD-MAG-1-CONTENT
              perform varying riga from 2 by 1 
                        until riga > tot-righe
                 inquire gd-mag(riga, 1),   cell-data col-mag-codice
                 inquire gd-mag(riga, 2),   cell-data 
           col-mag-descrizione
                 inquire gd-mag(riga, 3),   cell-data col-mag-intera
                 move col-mag-codice      to col-mag-codice-1
                 move col-mag-descrizione to col-mag-descrizione-1
                 move col-mag-intera      to col-mag-intera-1
                 modify  gd-mag-1(riga, 1), cell-data col-mag-codice-1
                 modify  gd-mag-1(riga, 2), cell-data 
           col-mag-descrizione-1
                 modify  gd-mag-1(riga, 3), cell-data col-mag-intera-1
              end-perform
              modify gd-mag-1, insert-rows = 1
      *    Luciano
              move 1   to e-tipocli-dati
      *    Luciano
           else
              move spaces to lab-vet-max-2-buf  
              move spaces to lab-vet-min1-2-buf  
              move spaces to lab-vet-min2-2-buf  
              move 0 to ef-ini-vol-2-buf   
              move 0 to ef-parz-2-buf      
              move 0 to ef-gg-cons-2-buf   
              move 0 to ef-val-2-buf       
              move 0 to ef-cons-max-2-buf  
              move 0 to ef-max-vet-2-buf   
              move 0 to ef-max-kg-2-buf    
              move 0 to ef-min-vet1-2-buf   
              move 0 to ef-min-kg1-2-buf   
              move 0 to ef-min-vet2-2-buf   
              move 0 to ef-min-kg2-2-buf    
              move 0 to ef-blocco-kg-2-buf 
              move 0 to chk-prenot-2-buf   
              move 0 to chk-accorpa-2-buf  
              move 0 to chk-sost-batt-2-buf
              move 0 to chk-banco-2-buf    
              move 0 to chk-promo-2-buf
              move 0 to chk-escludi-2-buf
              move 0 to chk-layout-pers-2-buf
              move spaces to ef-stampante-2-buf ef-path-logo-2-buf
              modify gd-mag-2, reset-grid = 1
              perform GD-MAG-2-CONTENT
              modify gd-mag-2, insert-rows = 1
      *    Luciano
              move zero   to e-tipocli-dati
      *    Luciano
           end-if.
           display Form1.

           perform EVIDENZIA-GESTISCI 
           .
      * <TOTEM:END>
       gd-mag-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-mag-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-GD-MAG 
           .
      * <TOTEM:END>
       gd-mag-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-mag-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-GD-MAG 
           .
      * <TOTEM:END>
       gd-mag-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-mag-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-GD-MAG 
           .
      * <TOTEM:END>
       gd-mag-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-mag-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-GD-MAG 
           .
      * <TOTEM:END>
       gd-mag-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-mag-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-GD-MAG 
           .
      * <TOTEM:END>
       gd-mag-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-mag-Ev-Msg-Begin-Entry>
           if mod = 0
              set event-action to event-action-fail
           else
              inquire gd-mag, cursor-x in colonna
              if colonna = 2
                 set event-action to event-action-fail
              else
                 inquire gd-mag(event-data-2, 1), cell-data in 
           old-mag-codice
              end-if
           end-if 
           .
      * <TOTEM:END>
       gd-mag-Ev-Msg-Finish-Entry.
      * <TOTEM:PARA. gd-mag-Ev-Msg-Finish-Entry>
           set tutto-ok to true.
           evaluate event-data-1
           when 1
                inquire gd-mag(event-data-2, 1), cell-data in 
           col-mag-codice
                move col-mag-codice to mag-codice
                if mag-codice = spaces
                   modify gd-mag, record-to-delete = event-data-2
                else
                   read tmagaz no lock 
                        invalid 
                        move spaces to mag-descrizione
                        set errori to true
                        set event-action to event-action-fail
                        display message "Magazzino NON valido"
                                  title tit-err
                                   icon 2
                   end-read
                   if tutto-ok
                      inquire gd-mag, last-row in tot-righe
                      perform varying riga from 2 by 1 
                                until riga > tot-righe 
                         inquire gd-mag(riga, 1), cell-data in 
           col-mag-codice
                         if col-mag-codice = mag-codice and riga not = 
           event-data-2
                            set errori to true
                            subtract 1 from riga
                            display message "Magazzino già presente a ri
      -    "ga " riga
                                      title tit-err
                                       icon 2
                            set event-action to event-action-fail
                            exit perform
                         end-if
                      end-perform
                   end-if
                   move mag-descrizione to col-mag-descrizione
                   modify gd-mag(event-data-2, 2), cell-data 
           col-mag-descrizione
                   if old-mag-codice = spaces and tutto-ok
                      modify gd-mag, insert-rows = 1
                   end-if   
                end-if
           when 3
                inquire gd-mag(event-data-2, 3), cell-data in 
           col-mag-intera
                if col-mag-intera not = "S" and not = "N"
                   set errori to true
                   set event-action to event-action-fail
                   display message "Valori ammessi S(i) o N(o)"
                             title tit-err
                              icon 2
                end-if              
           end-evaluate 
           .
      * <TOTEM:END>
       gd-mag-1-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-mag-1-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-GD-MAG-1 
           .
      * <TOTEM:END>
       gd-mag-1-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-mag-1-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-GD-MAG-1 
           .
      * <TOTEM:END>
       gd-mag-1-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-mag-1-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-GD-MAG-1 
           .
      * <TOTEM:END>
       gd-mag-1-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-mag-1-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-GD-MAG-1 
           .
      * <TOTEM:END>
       gd-mag-1-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-mag-1-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-GD-MAG-1 
           .
      * <TOTEM:END>
       gd-mag-2-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-mag-2-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-GD-MAG-2 
           .
      * <TOTEM:END>
       gd-mag-2-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-mag-2-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-GD-MAG-2 
           .
      * <TOTEM:END>
       gd-mag-2-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-mag-2-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-GD-MAG-2 
           .
      * <TOTEM:END>
       gd-mag-2-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-mag-2-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-GD-MAG-2 
           .
      * <TOTEM:END>
       gd-mag-2-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-mag-2-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-GD-MAG-2 
           .
      * <TOTEM:END>
       gd-mag-3-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-mag-3-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-GD-MAG-3 
           .
      * <TOTEM:END>
       gd-mag-3-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-mag-3-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-GD-MAG-3 
           .
      * <TOTEM:END>
       gd-mag-3-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-mag-3-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-GD-MAG-3 
           .
      * <TOTEM:END>
       gd-mag-3-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-mag-3-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-GD-MAG-3 
           .
      * <TOTEM:END>
       gd-mag-3-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-mag-3-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-GD-MAG-3 
           .
      * <TOTEM:END>
       gd-mag-4-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd-mag-4-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO-GD-MAG-4 
           .
      * <TOTEM:END>
       gd-mag-4-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd-mag-4-Ev-Msg-End-Drag>
           perform SPOSTAMENTO-GD-MAG-4 
           .
      * <TOTEM:END>
       gd-mag-4-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd-mag-4-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO-GD-MAG-4 
           .
      * <TOTEM:END>
       gd-mag-4-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd-mag-4-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO-GD-MAG-4 
           .
      * <TOTEM:END>
       gd-mag-4-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd-mag-4-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO-GD-MAG-4 
           .
      * <TOTEM:END>
       chk-gestisci-2-LinkTo.
      * <TOTEM:PARA. chk-gestisci-2-LinkTo>
           inquire chk-gestisci-2, value in chk-gestisci-2-buf.
           if chk-gestisci-2-buf = 1
              inquire chk-gestisci-1, value in chk-gestisci-1-buf
              if chk-gestisci-1-buf = 0
                 move ef-ini-vol-buf   to ef-ini-vol-2-buf   
                 move ef-parz-buf      to ef-parz-2-buf      
                 move ef-gg-cons-buf   to ef-gg-cons-2-buf   
                 move ef-val-buf       to ef-val-2-buf       
                 move ef-cons-max-buf  to ef-cons-max-2-buf  
                 move ef-max-vet-buf   to ef-max-vet-2-buf   
                 move lab-vet-max-buf  to lab-vet-max-2-buf  
                 move ef-max-kg-buf    to ef-max-kg-2-buf    
                 move ef-min-vet1-buf   to ef-min-vet1-2-buf   
                 move lab-vet-min1-buf  to lab-vet-min1-2-buf  
                 move ef-min-kg1-buf    to ef-min-kg1-2-buf  
                 move ef-min-vet2-buf   to ef-min-vet2-2-buf   
                 move lab-vet-min2-buf  to lab-vet-min2-2-buf  
                 move ef-min-kg2-buf    to ef-min-kg2-2-buf   
                 move ef-blocco-kg-buf to ef-blocco-kg-2-buf 
                 move chk-prenot-buf   to chk-prenot-2-buf   
                 move chk-accorpa-buf  to chk-accorpa-2-buf  
                 move chk-sost-batt-buf to chk-sost-batt-2-buf
                 move chk-banco-buf    to chk-banco-2-buf    
                 move chk-promo-buf    to chk-promo-2-buf    
                 move chk-escludi-buf  to chk-escludi-2-buf   
                 move chk-imb-min-buf  to chk-imb-min-2-buf
                 move chk-art-forn-buf to chk-art-forn-2-buf
                 move chk-pb-perce-buf to chk-pb-perce-2-buf
                 move chk-pb-amp-buf   to chk-pb-amp-2-buf
                 move chk-pb-bosch-buf to chk-pb-bosch-2-buf
                 move ef-stampante-buf to ef-stampante-2-buf
                 move chk-layout-pers-buf to chk-layout-pers-2-buf
                 move ef-path-logo-buf to ef-path-logo-2-buf
                 inquire gd-mag, last-row in tot-righe
                 modify gd-mag-2, reset-grid = 1
                 perform GD-MAG-2-CONTENT
                 perform varying riga from 2 by 1 
                           until riga > tot-righe
                    inquire gd-mag(riga, 1),   cell-data col-mag-codice
                    inquire gd-mag(riga, 2),   cell-data 
           col-mag-descrizione
                    inquire gd-mag(riga, 3),   cell-data col-mag-intera
                    move col-mag-codice        to col-mag-codice-2
                    move col-mag-descrizione   to col-mag-descrizione-2
                    move col-mag-intera        to col-mag-intera-2
                    modify  gd-mag-2(riga, 1), cell-data 
           col-mag-codice-2
                    modify  gd-mag-2(riga, 2), cell-data 
           col-mag-descrizione-2
                    modify  gd-mag-2(riga, 3), cell-data 
           col-mag-intera-2
                 end-perform
                 modify gd-mag-2, insert-rows = 1
              else
                 move ef-ini-vol-1-buf   to ef-ini-vol-2-buf   
                 move ef-parz-1-buf      to ef-parz-2-buf      
                 move ef-gg-cons-1-buf   to ef-gg-cons-2-buf   
                 move ef-val-1-buf       to ef-val-2-buf       
                 move ef-cons-max-1-buf  to ef-cons-max-2-buf  
                 move ef-max-vet-1-buf   to ef-max-vet-2-buf   
                 move lab-vet-max-1-buf  to lab-vet-max-2-buf  
                 move ef-max-kg-1-buf    to ef-max-kg-2-buf    
                 move ef-min-vet1-1-buf   to ef-min-vet1-1-buf   
                 move lab-vet-min1-1-buf  to lab-vet-min1-1-buf  
                 move ef-min-kg1-1-buf    to ef-min-kg1-1-buf  
                 move ef-min-vet2-1-buf   to ef-min-vet2-1-buf   
                 move lab-vet-min2-1-buf  to lab-vet-min2-1-buf  
                 move ef-min-kg2-1-buf    to ef-min-kg2-1-buf    
                 move ef-blocco-kg-1-buf to ef-blocco-kg-2-buf 
                 move chk-prenot-1-buf   to chk-prenot-2-buf   
                 move chk-accorpa-1-buf  to chk-accorpa-2-buf  
                 move chk-sost-batt-1-buf to chk-sost-batt-2-buf
                 move chk-banco-1-buf    to chk-banco-2-buf    
                 move chk-promo-1-buf    to chk-promo-2-buf    
                 move chk-escludi-1-buf  to chk-escludi-2-buf  
                 move chk-imb-min-1-buf   to chk-imb-min-2-buf
                 move chk-art-forn-1-buf  to chk-art-forn-2-buf
                 move chk-pb-perce-1-buf  to chk-pb-perce-2-buf
                 move chk-pb-amp-1-buf    to chk-pb-amp-2-buf
                 move chk-pb-bosch-1-buf  to chk-pb-bosch-2-buf
                 move ef-stampante-buf    to ef-stampante-2-buf
                 move chk-layout-pers-buf to chk-layout-pers-2-buf
                 move ef-path-logo-buf to ef-path-logo-2-buf
                 inquire gd-mag-1, last-row in tot-righe
                 modify gd-mag-2, reset-grid = 1
                 perform GD-MAG-2-CONTENT
                 perform varying riga from 2 by 1 
                           until riga > tot-righe
                    inquire gd-mag-1(riga, 1),   cell-data 
           col-mag-codice-1
                    inquire gd-mag-1(riga, 2),   cell-data 
           col-mag-descrizione-1
                    inquire gd-mag-1(riga, 3),   cell-data 
           col-mag-intera-1
                    move col-mag-codice-1      to col-mag-codice-2
                    move col-mag-descrizione-1 to col-mag-descrizione-2
                    move col-mag-intera-1      to col-mag-intera-2
                    modify  gd-mag-2(riga, 1), cell-data 
           col-mag-codice-2
                    modify  gd-mag-2(riga, 2), cell-data 
           col-mag-descrizione-2
                    modify  gd-mag-2(riga, 3), cell-data 
           col-mag-intera-2
                 end-perform
                 modify gd-mag-2, insert-rows = 1
              end-if
      *    Luciano
              move 1   to e-gdo-dati
      *    Luciano
           else
              move spaces to lab-vet-max-2-buf  
              move spaces to lab-vet-min1-2-buf  
              move spaces to lab-vet-min2-2-buf  
              move 0 to ef-ini-vol-2-buf   
              move 0 to ef-parz-2-buf      
              move 0 to ef-gg-cons-2-buf   
              move 0 to ef-val-2-buf       
              move 0 to ef-cons-max-2-buf  
              move 0 to ef-max-vet-2-buf   
              move 0 to ef-max-kg-2-buf    
              move 0 to ef-min-vet1-2-buf   
              move 0 to ef-min-kg1-2-buf   
              move 0 to ef-min-vet2-2-buf   
              move 0 to ef-min-kg2-2-buf    
              move 0 to ef-blocco-kg-2-buf 
              move 0 to chk-prenot-2-buf   
              move 0 to chk-accorpa-2-buf  
              move 0 to chk-sost-batt-2-buf
              move 0 to chk-banco-2-buf    
              move 0 to chk-promo-2-buf
              move 0 to chk-escludi-2-buf   
              move 0 to chk-imb-min-2-buf
              move 0 to chk-art-forn-2-buf
              move 0 to chk-pb-perce-2-buf
              move 0 to chk-pb-amp-2-buf
              move 0 to chk-pb-bosch-2-buf  
              move 0 to chk-layout-pers-2-buf
              move spaces to ef-stampante-2-buf ef-path-logo-2-buf
              modify gd-mag-2, reset-grid = 1
              perform GD-MAG-2-CONTENT
              modify gd-mag-2, insert-rows = 1
      *    Luciano
              move zero   to e-gdo-dati
      *    Luciano
           end-if.
           display Form1.

           perform EVIDENZIA-GESTISCI 
           .
      * <TOTEM:END>
       chk-gestisci-3-LinkTo.
      * <TOTEM:PARA. chk-gestisci-3-LinkTo>
           inquire chk-gestisci-3, value in chk-gestisci-3-buf.
           if chk-gestisci-3-buf = 1
              inquire chk-gestisci-2, value in chk-gestisci-2-buf
              if chk-gestisci-2-buf = 0
                 inquire chk-gestisci-1, value in chk-gestisci-1-buf
                 if chk-gestisci-1-buf = 0
                    move ef-ini-vol-buf   to ef-ini-vol-3-buf   
                    move ef-parz-buf      to ef-parz-3-buf      
                    move ef-gg-cons-buf   to ef-gg-cons-3-buf   
                    move ef-val-buf       to ef-val-3-buf       
                    move ef-cons-max-buf  to ef-cons-max-3-buf  
                    move ef-max-vet-buf   to ef-max-vet-3-buf   
                    move lab-vet-max-buf  to lab-vet-max-3-buf  
                    move ef-max-kg-buf    to ef-max-kg-3-buf    
                    move ef-min-vet1-buf   to ef-min-vet1-3-buf   
                    move lab-vet-min1-buf  to lab-vet-min1-3-buf  
                    move ef-min-kg1-buf    to ef-min-kg1-3-buf  
                    move ef-min-vet2-buf   to ef-min-vet2-3-buf   
                    move lab-vet-min2-buf  to lab-vet-min2-3-buf  
                    move ef-min-kg2-buf    to ef-min-kg2-3-buf    
                    move ef-blocco-kg-buf to ef-blocco-kg-3-buf 
                    move chk-prenot-buf   to chk-prenot-3-buf   
                    move chk-accorpa-buf  to chk-accorpa-3-buf  
                    move chk-sost-batt-buf  to chk-sost-batt-3-buf  
                    move chk-banco-buf    to chk-banco-3-buf    
                    move chk-promo-buf    to chk-promo-3-buf    
                    move chk-escludi-buf  to chk-escludi-3-buf 
                    move chk-imb-min-buf   to chk-imb-min-3-buf
                    move chk-art-forn-buf  to chk-art-forn-3-buf
                    move chk-pb-perce-buf  to chk-pb-perce-3-buf
                    move chk-pb-amp-buf    to chk-pb-amp-3-buf 
                    move chk-pb-bosch-buf  to chk-pb-bosch-3-buf 
                    move ef-stampante-buf  to ef-stampante-3-buf
                    move ef-path-logo-buf  to ef-path-logo-3-buf
                    move chk-layout-pers-buf to chk-layout-pers-3-buf
                    inquire gd-mag, last-row in tot-righe
                    modify gd-mag-3, reset-grid = 1
                    perform GD-MAG-3-CONTENT
                    perform varying riga from 2 by 1 
                              until riga > tot-righe
                       inquire gd-mag(riga, 1),   cell-data 
           col-mag-codice
                       inquire gd-mag(riga, 2),   cell-data 
           col-mag-descrizione
                       inquire gd-mag(riga, 3),   cell-data 
           col-mag-intera
                       move col-mag-codice        to col-mag-codice-3
                       move col-mag-descrizione   to 
           col-mag-descrizione-3
                       move col-mag-intera        to col-mag-intera-3
                       modify  gd-mag-3(riga, 1), cell-data 
           col-mag-codice-3
                       modify  gd-mag-3(riga, 2), cell-data 
           col-mag-descrizione-3
                       modify  gd-mag-3(riga, 3), cell-data 
           col-mag-intera-3
                    end-perform
                    modify gd-mag-3, insert-rows = 1
                 else
                    move ef-ini-vol-1-buf   to ef-ini-vol-3-buf   
                    move ef-parz-1-buf      to ef-parz-3-buf      
                    move ef-gg-cons-1-buf   to ef-gg-cons-3-buf   
                    move ef-val-1-buf       to ef-val-3-buf       
                    move ef-cons-max-1-buf  to ef-cons-max-3-buf  
                    move ef-max-vet-1-buf   to ef-max-vet-3-buf   
                    move lab-vet-max-1-buf  to lab-vet-max-3-buf  
                    move ef-max-kg-1-buf    to ef-max-kg-3-buf    
                    move ef-min-vet1-1-buf   to ef-min-vet1-3-buf   
                    move lab-vet-min1-1-buf  to lab-vet-min1-3-buf  
                    move ef-min-kg1-1-buf    to ef-min-kg1-3-buf  
                    move ef-min-vet2-1-buf   to ef-min-vet2-3-buf   
                    move lab-vet-min2-1-buf  to lab-vet-min2-3-buf  
                    move ef-min-kg2-1-buf    to ef-min-kg2-3-buf    
                    move ef-blocco-kg-1-buf to ef-blocco-kg-3-buf 
                    move chk-prenot-1-buf   to chk-prenot-3-buf   
                    move chk-accorpa-1-buf  to chk-accorpa-3-buf  
                    move chk-sost-batt-1-buf  to chk-sost-batt-3-buf  
                    move chk-banco-1-buf    to chk-banco-3-buf    
                    move chk-promo-1-buf    to chk-promo-3-buf    
                    move chk-escludi-1-buf  to chk-escludi-3-buf 
                    move chk-imb-min-1-buf   to chk-imb-min-3-buf
                    move chk-art-forn-1-buf  to chk-art-forn-3-buf
                    move chk-pb-perce-1-buf  to chk-pb-perce-3-buf
                    move chk-pb-amp-1-buf    to chk-pb-amp-3-buf 
                    move chk-pb-bosch-1-buf  to chk-pb-bosch-3-buf 
                    move ef-stampante-1-buf  to ef-stampante-3-buf
                    move ef-path-logo-buf  to ef-path-logo-3-buf
                    move chk-layout-pers-buf to chk-layout-pers-3-buf
                    inquire gd-mag-1, last-row in tot-righe
                    modify gd-mag-3, reset-grid = 1
                    perform GD-MAG-3-CONTENT
                    perform varying riga from 2 by 1 
                              until riga > tot-righe
                       inquire gd-mag-1(riga, 1),   cell-data 
           col-mag-codice-1
                       inquire gd-mag-1(riga, 2),   cell-data 
           col-mag-descrizione-1
                       inquire gd-mag-1(riga, 3),   cell-data 
           col-mag-intera-1
                       move col-mag-codice-1      to col-mag-codice-3
                       move col-mag-descrizione-1 to 
           col-mag-descrizione-3
                       move col-mag-intera-1      to col-mag-intera-3
                       modify  gd-mag-3(riga, 1), cell-data 
           col-mag-codice-3
                       modify  gd-mag-3(riga, 2), cell-data 
           col-mag-descrizione-3
                       modify  gd-mag-3(riga, 3), cell-data 
           col-mag-intera-3
                    end-perform
                    modify gd-mag-3, insert-rows = 1
                 end-if
              else
                 move ef-ini-vol-2-buf   to ef-ini-vol-3-buf   
                 move ef-parz-2-buf      to ef-parz-3-buf      
                 move ef-gg-cons-2-buf   to ef-gg-cons-3-buf   
                 move ef-val-2-buf       to ef-val-3-buf       
                 move ef-cons-max-2-buf  to ef-cons-max-3-buf  
                 move ef-max-vet-2-buf   to ef-max-vet-3-buf   
                 move lab-vet-max-2-buf  to lab-vet-max-3-buf  
                 move ef-max-kg-2-buf    to ef-max-kg-3-buf    
                 move ef-min-vet1-2-buf   to ef-min-vet1-3-buf   
                 move lab-vet-min1-2-buf  to lab-vet-min1-3-buf  
                 move ef-min-kg1-2-buf    to ef-min-kg1-3-buf  
                 move ef-min-vet2-2-buf   to ef-min-vet2-3-buf   
                 move lab-vet-min2-2-buf  to lab-vet-min2-3-buf  
                 move ef-min-kg2-2-buf    to ef-min-kg2-3-buf    
                 move ef-blocco-kg-2-buf to ef-blocco-kg-3-buf 
                 move chk-prenot-2-buf   to chk-prenot-3-buf   
                 move chk-accorpa-2-buf  to chk-accorpa-3-buf  
                 move chk-sost-batt-2-buf to chk-sost-batt-3-buf  
                 move chk-banco-2-buf    to chk-banco-3-buf    
                 move chk-promo-2-buf    to chk-promo-3-buf    
                 move chk-escludi-2-buf  to chk-escludi-3-buf    
                 move chk-imb-min-2-buf   to chk-imb-min-3-buf
                 move chk-art-forn-2-buf  to chk-art-forn-3-buf
                 move chk-pb-perce-2-buf  to chk-pb-perce-3-buf
                 move chk-pb-amp-2-buf    to chk-pb-amp-3-buf
                 move chk-pb-bosch-2-buf  to chk-pb-bosch-3-buf
                 move ef-stampante-2-buf  to ef-stampante-3-buf
                 move ef-path-logo-2-buf to ef-path-logo-3-buf
                 move chk-layout-pers-2-buf to chk-layout-pers-3-buf
                 inquire gd-mag-2, last-row in tot-righe
                 modify gd-mag-3, reset-grid = 1
                 perform GD-MAG-3-CONTENT
                 perform varying riga from 2 by 1 
                           until riga > tot-righe
                    inquire gd-mag-2(riga, 1),   cell-data 
           col-mag-codice-2
                    inquire gd-mag-2(riga, 2),   cell-data 
           col-mag-descrizione-2
                    inquire gd-mag-2(riga, 3),   cell-data 
           col-mag-intera-2
                    move col-mag-codice-2      to col-mag-codice-3
                    move col-mag-descrizione-2 to col-mag-descrizione-3
                    move col-mag-intera-2      to col-mag-intera-3
                    modify  gd-mag-3(riga, 1), cell-data 
           col-mag-codice-3
                    modify  gd-mag-3(riga, 2), cell-data 
           col-mag-descrizione-3
                    modify  gd-mag-3(riga, 3), cell-data 
           col-mag-intera-3
                 end-perform
                 modify gd-mag-3, insert-rows = 1
              end-if
      *    Luciano
              move 1   to e-clienti-dati
      *    Luciano
           else
              move spaces to lab-vet-max-3-buf  
              move spaces to lab-vet-min1-3-buf  
              move spaces to lab-vet-min2-3-buf  
              move 0 to ef-ini-vol-3-buf   
              move 0 to ef-parz-3-buf      
              move 0 to ef-gg-cons-3-buf   
              move 0 to ef-val-3-buf       
              move 0 to ef-cons-max-3-buf  
              move 0 to ef-max-vet-3-buf   
              move 0 to ef-max-kg-3-buf    
              move 0 to ef-min-vet1-3-buf   
              move 0 to ef-min-kg1-3-buf   
              move 0 to ef-min-vet2-3-buf   
              move 0 to ef-min-kg2-3-buf    
              move 0 to ef-blocco-kg-3-buf 
              move 0 to chk-prenot-3-buf   
              move 0 to chk-accorpa-3-buf  
              move 0 to chk-sost-batt-3-buf
              move 0 to chk-banco-3-buf    
              move 0 to chk-promo-3-buf
              move 0 to chk-escludi-3-buf   
              move 0 to chk-imb-min-3-buf
              move 0 to chk-art-forn-3-buf
              move 0 to chk-pb-perce-3-buf
              move 0 to chk-pb-amp-3-buf
              move 0 to chk-pb-bosch-3-buf    
              move 0 to chk-layout-pers-3-buf
              move spaces to ef-stampante-3-buf ef-path-logo-3-buf
              modify gd-mag-3, reset-grid = 1
              perform GD-MAG-3-CONTENT
              modify gd-mag-3, insert-rows = 1
      *    Luciano
              move zero   to e-clienti-dati
      *    Luciano
           end-if.
           display Form1.

           perform EVIDENZIA-GESTISCI 
           .
      * <TOTEM:END>
       chk-gestisci-4-LinkTo.
      * <TOTEM:PARA. chk-gestisci-4-LinkTo>
           inquire chk-gestisci-4, value in chk-gestisci-4-buf.
           if chk-gestisci-4-buf = 1
              inquire chk-gestisci-3, value in chk-gestisci-3-buf
              if chk-gestisci-3-buf = 0
                 inquire chk-gestisci-2, value in chk-gestisci-2-buf
                 if chk-gestisci-2-buf = 0
                    inquire chk-gestisci-1, value in chk-gestisci-1-buf
                    if chk-gestisci-1-buf = 0
                       move ef-ini-vol-buf   to ef-ini-vol-4-buf   
                       move ef-parz-buf      to ef-parz-4-buf      
                       move ef-gg-cons-buf   to ef-gg-cons-4-buf   
                       move ef-val-buf       to ef-val-4-buf       
                       move ef-cons-max-buf  to ef-cons-max-4-buf  
                       move ef-max-vet-buf   to ef-max-vet-4-buf   
                       move lab-vet-max-buf  to lab-vet-max-4-buf  
                       move ef-max-kg-buf    to ef-max-kg-4-buf    
                       move ef-min-vet1-buf   to ef-min-vet1-4-buf   
                       move lab-vet-min1-buf  to lab-vet-min1-4-buf  
                       move ef-min-kg1-buf    to ef-min-kg1-4-buf  
                       move ef-min-vet2-buf   to ef-min-vet2-4-buf   
                       move lab-vet-min2-buf  to lab-vet-min2-4-buf  
                       move ef-min-kg2-buf    to ef-min-kg2-4-buf    
                       move ef-blocco-kg-buf to ef-blocco-kg-4-buf 
                       move chk-prenot-buf   to chk-prenot-4-buf   
                       move chk-accorpa-buf  to chk-accorpa-4-buf  
                       move chk-sost-batt-buf   to chk-sost-batt-4-buf  
                       move chk-banco-buf    to chk-banco-4-buf    
                       move chk-promo-buf    to chk-promo-4-buf    
                       move chk-escludi-buf  to chk-escludi-4-buf   
                       move chk-imb-min-buf  to chk-imb-min-4-buf
                       move chk-art-forn-buf to chk-art-forn-4-buf
                       move chk-pb-perce-buf to chk-pb-perce-4-buf
                       move chk-pb-amp-buf   to chk-pb-amp-4-buf
                       move chk-pb-bosch-buf to chk-pb-bosch-4-buf
                       move ef-stampante-buf to ef-stampante-4-buf
                       move ef-path-logo-buf to ef-path-logo-4-buf
                       move chk-layout-pers-buf  to 
           chk-layout-pers-4-buf
                       inquire gd-mag, last-row in tot-righe
                       modify gd-mag-4, reset-grid = 1
                       perform GD-MAG-4-CONTENT
                       perform varying riga from 2 by 1 
                                 until riga > tot-righe
                          inquire gd-mag(riga, 1),   cell-data 
           col-mag-codice
                          inquire gd-mag(riga, 2),   cell-data 
           col-mag-descrizione
                          inquire gd-mag(riga, 3),   cell-data 
           col-mag-intera
                          move col-mag-codice      to col-mag-codice-4
                          move col-mag-descrizione to 
           col-mag-descrizione-4
                          move col-mag-intera      to col-mag-intera-4
                          modify  gd-mag-4(riga, 1), cell-data 
           col-mag-codice-4
                          modify  gd-mag-4(riga, 2), cell-data 
           col-mag-descrizione-4
                          modify  gd-mag-4(riga, 3), cell-data 
           col-mag-intera-4
                       end-perform
                       modify gd-mag-4, insert-rows = 1
                    else
                       move ef-ini-vol-1-buf   to ef-ini-vol-4-buf   
                       move ef-parz-1-buf      to ef-parz-4-buf      
                       move ef-gg-cons-1-buf   to ef-gg-cons-4-buf   
                       move ef-val-1-buf       to ef-val-4-buf       
                       move ef-cons-max-1-buf  to ef-cons-max-4-buf  
                       move ef-max-vet-1-buf   to ef-max-vet-4-buf   
                       move lab-vet-max-1-buf  to lab-vet-max-4-buf  
                       move ef-max-kg-1-buf    to ef-max-kg-4-buf    
                       move ef-min-vet1-1-buf   to ef-min-vet1-4-buf   
                       move lab-vet-min1-1-buf  to lab-vet-min1-4-buf  
                       move ef-min-kg1-1-buf    to ef-min-kg1-4-buf  
                       move ef-min-vet2-1-buf   to ef-min-vet2-4-buf   
                       move lab-vet-min2-1-buf  to lab-vet-min2-4-buf  
                       move ef-min-kg2-1-buf    to ef-min-kg2-4-buf    
                       move ef-blocco-kg-1-buf to ef-blocco-kg-4-buf 
                       move chk-prenot-1-buf   to chk-prenot-4-buf   
                       move chk-accorpa-1-buf  to chk-accorpa-4-buf  
                       move chk-sost-batt-1-buf  to chk-sost-batt-4-buf 
            
                       move chk-banco-1-buf    to chk-banco-4-buf    
                       move chk-promo-1-buf    to chk-promo-4-buf    
                       move chk-escludi-1-buf  to chk-escludi-4-buf 
                       move chk-imb-min-1-buf  to chk-imb-min-4-buf
                       move chk-art-forn-1-buf to chk-art-forn-4-buf
                       move chk-pb-perce-1-buf to chk-pb-perce-4-buf
                       move chk-pb-amp-1-buf   to chk-pb-amp-4-buf 
                       move chk-pb-bosch-1-buf to chk-pb-bosch-4-buf 
                       move ef-stampante-1-buf to ef-stampante-4-buf
                       move ef-path-logo-buf to ef-path-logo-4-buf
                       move chk-layout-pers-buf  to 
           chk-layout-pers-4-buf
                       inquire gd-mag-1, last-row in tot-righe
                       modify gd-mag-4, reset-grid = 1
                       perform GD-MAG-4-CONTENT
                       perform varying riga from 2 by 1 
                                 until riga > tot-righe
                          inquire gd-mag-1(riga, 1),   cell-data 
           col-mag-codice-1
                          inquire gd-mag-1(riga, 2),   cell-data 
           col-mag-descrizione-1
                          inquire gd-mag-1(riga, 3),   cell-data 
           col-mag-intera-1
                          move col-mag-codice-1      to col-mag-codice-4
                          move col-mag-descrizione-1 to 
           col-mag-descrizione-4
                          move col-mag-intera-1      to col-mag-intera-4
                          modify  gd-mag-4(riga, 1), cell-data 
           col-mag-codice-4
                          modify  gd-mag-4(riga, 2), cell-data 
           col-mag-descrizione-4
                          modify  gd-mag-4(riga, 3), cell-data 
           col-mag-intera-4
                       end-perform
                       modify gd-mag-4, insert-rows = 1
                    end-if
                 else
                    move ef-ini-vol-2-buf   to ef-ini-vol-4-buf   
                    move ef-parz-2-buf      to ef-parz-4-buf      
                    move ef-gg-cons-2-buf   to ef-gg-cons-4-buf   
                    move ef-val-2-buf       to ef-val-4-buf       
                    move ef-cons-max-2-buf  to ef-cons-max-4-buf  
                    move ef-max-vet-2-buf   to ef-max-vet-4-buf   
                    move lab-vet-max-2-buf  to lab-vet-max-4-buf  
                    move ef-max-kg-2-buf    to ef-max-kg-4-buf    
                    move ef-min-vet1-2-buf   to ef-min-vet1-4-buf   
                    move lab-vet-min1-2-buf  to lab-vet-min1-4-buf  
                    move ef-min-kg1-2-buf    to ef-min-kg1-4-buf  
                    move ef-min-vet2-2-buf   to ef-min-vet2-4-buf   
                    move lab-vet-min2-2-buf  to lab-vet-min2-4-buf  
                    move ef-min-kg2-2-buf    to ef-min-kg2-4-buf    
                    move ef-blocco-kg-2-buf to ef-blocco-kg-4-buf 
                    move chk-prenot-2-buf   to chk-prenot-4-buf   
                    move chk-accorpa-2-buf  to chk-accorpa-4-buf  
                    move chk-sost-batt-2-buf   to chk-sost-batt-4-buf  
                    move chk-banco-2-buf    to chk-banco-4-buf    
                    move chk-promo-2-buf    to chk-promo-4-buf    
                    move chk-escludi-2-buf  to chk-escludi-4-buf  
                    move chk-imb-min-2-buf  to chk-imb-min-4-buf
                    move chk-art-forn-2-buf to chk-art-forn-4-buf
                    move chk-pb-perce-2-buf to chk-pb-perce-4-buf
                    move chk-pb-amp-2-buf   to chk-pb-amp-4-buf
                    move chk-pb-bosch-2-buf to chk-pb-bosch-4-buf
                    move ef-stampante-2-buf to ef-stampante-4-buf
                    move ef-path-logo-2-buf to ef-path-logo-4-buf
                    move chk-layout-pers-2-buf to chk-layout-pers-4-buf
                    inquire gd-mag-2, last-row in tot-righe
                    modify gd-mag-4, reset-grid = 1
                    perform GD-MAG-4-CONTENT
                    perform varying riga from 2 by 1 
                              until riga > tot-righe
                       inquire gd-mag-2(riga, 1),   cell-data 
           col-mag-codice-2
                       inquire gd-mag-2(riga, 2),   cell-data 
           col-mag-descrizione-2
                       inquire gd-mag-2(riga, 3),   cell-data 
           col-mag-intera-2
                       move col-mag-codice-2      to col-mag-codice-4
                       move col-mag-descrizione-2 to 
           col-mag-descrizione-4
                       move col-mag-intera-2      to col-mag-intera-4
                       modify  gd-mag-4(riga, 1), cell-data 
           col-mag-codice-4
                       modify  gd-mag-4(riga, 2), cell-data 
           col-mag-descrizione-4
                       modify  gd-mag-4(riga, 3), cell-data 
           col-mag-intera-4
                    end-perform
                    modify gd-mag-4, insert-rows = 1
                 end-if
              else
                 move ef-ini-vol-3-buf   to ef-ini-vol-4-buf   
                 move ef-parz-3-buf      to ef-parz-4-buf      
                 move ef-gg-cons-3-buf   to ef-gg-cons-4-buf   
                 move ef-val-3-buf       to ef-val-4-buf       
                 move ef-cons-max-3-buf  to ef-cons-max-4-buf  
                 move ef-max-vet-3-buf   to ef-max-vet-4-buf   
                 move lab-vet-max-3-buf  to lab-vet-max-4-buf  
                 move ef-max-kg-3-buf    to ef-max-kg-4-buf    
                 move ef-min-vet1-3-buf   to ef-min-vet1-4-buf   
                 move lab-vet-min1-3-buf  to lab-vet-min1-4-buf  
                 move ef-min-kg1-3-buf    to ef-min-kg1-4-buf   
                 move ef-min-vet2-3-buf   to ef-min-vet2-4-buf   
                 move lab-vet-min2-3-buf  to lab-vet-min2-4-buf  
                 move ef-min-kg2-3-buf    to ef-min-kg2-4-buf   
                 move ef-blocco-kg-3-buf to ef-blocco-kg-4-buf 
                 move ef-blocco-kg-3-buf to ef-blocco-kg-4-buf 
                 move chk-prenot-3-buf   to chk-prenot-4-buf   
                 move chk-accorpa-3-buf  to chk-accorpa-4-buf  
                 move chk-sost-batt-3-buf   to chk-sost-batt-4-buf  
                 move chk-banco-3-buf    to chk-banco-4-buf    
                 move chk-promo-3-buf    to chk-promo-4-buf    
                 move chk-escludi-3-buf  to chk-escludi-4-buf    
                 move chk-imb-min-3-buf  to chk-imb-min-4-buf
                 move chk-art-forn-3-buf to chk-art-forn-4-buf
                 move chk-pb-perce-3-buf to chk-pb-perce-4-buf
                 move chk-pb-amp-3-buf   to chk-pb-amp-4-buf
                 move chk-pb-bosch-3-buf to chk-pb-bosch-4-buf
                 move ef-stampante-3-buf to ef-stampante-4-buf
                 move ef-path-logo-3-buf  to ef-path-logo-4-buf
                 move chk-layout-pers-3-buf to chk-layout-pers-4-buf
                 inquire gd-mag-3, last-row in tot-righe
                 modify gd-mag-4, reset-grid = 1
                 perform GD-MAG-4-CONTENT
                 perform varying riga from 2 by 1 
                           until riga > tot-righe
                    inquire gd-mag-3(riga, 1),   cell-data 
           col-mag-codice-3
                    inquire gd-mag-3(riga, 2),   cell-data 
           col-mag-descrizione-3
                    inquire gd-mag-3(riga, 3),   cell-data 
           col-mag-intera-3
                    move col-mag-codice-3      to col-mag-codice-4
                    move col-mag-descrizione-3 to col-mag-descrizione-4
                    move col-mag-intera-3      to col-mag-intera-4
                    modify  gd-mag-4(riga, 1), cell-data 
           col-mag-codice-4
                    modify  gd-mag-4(riga, 2), cell-data 
           col-mag-descrizione-4
                    modify  gd-mag-4(riga, 3), cell-data 
           col-mag-intera-4
                 end-perform
                 modify gd-mag-4, insert-rows = 1
              end-if
      *    Luciano
              move 1   to e-destini-dati
      *    Luciano
           else
              move spaces to lab-vet-max-4-buf  
              move spaces to lab-vet-min1-4-buf  
              move spaces to lab-vet-min2-4-buf  
              move 0 to ef-ini-vol-4-buf   
              move 0 to ef-parz-4-buf      
              move 0 to ef-gg-cons-4-buf   
              move 0 to ef-val-4-buf       
              move 0 to ef-cons-max-4-buf  
              move 0 to ef-max-vet-4-buf   
              move 0 to ef-max-kg-4-buf    
              move 0 to ef-min-vet1-4-buf   
              move 0 to ef-min-kg1-4-buf   
              move 0 to ef-min-vet2-4-buf   
              move 0 to ef-min-kg2-4-buf    
              move 0 to ef-blocco-kg-4-buf 
              move 0 to chk-prenot-4-buf   
              move 0 to chk-accorpa-4-buf  
              move 0 to chk-sost-batt-4-buf 
              move 0 to chk-banco-4-buf    
              move 0 to chk-promo-4-buf
              move 0 to chk-escludi-4-buf   
              move 0 to chk-imb-min-4-buf
              move 0 to chk-art-forn-4-buf
              move 0 to chk-pb-perce-4-buf
              move 0 to chk-pb-amp-4-buf
              move 0 to chk-pb-bosch-4-buf    
              move spaces to ef-stampante-4-buf
              modify gd-mag-4, reset-grid = 1
              perform GD-MAG-4-CONTENT
              modify gd-mag-4, insert-rows = 1
      *    Luciano
              move zero   to e-destini-dati
      *    Luciano
           end-if.
           display Form1.

           perform EVIDENZIA-GESTISCI 
           .
      * <TOTEM:END>
       gd-mag-1-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-mag-1-Ev-Msg-Begin-Entry>
      *    luciano
      *     if mod = 0
           if e-tipocli-dati = 0
      *    luciano
              set event-action to event-action-fail
           else
              inquire gd-mag-1, cursor-x in colonna
              if colonna = 2
                 set event-action to event-action-fail
              else
                 inquire gd-mag-1(event-data-2, 1), cell-data in 
           old-mag-codice
              end-if
           end-if 
           .
      * <TOTEM:END>
       gd-mag-2-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-mag-2-Ev-Msg-Begin-Entry>
      *    Luciano
      *     if mod = 0
           if e-gdo-dati = 0
      *    Luciano
              set event-action to event-action-fail
           else
              inquire gd-mag-2, cursor-x in colonna
              if colonna = 2
                 set event-action to event-action-fail
              else
                 inquire gd-mag-2(event-data-2, 1), cell-data in 
           old-mag-codice
              end-if
           end-if 
           .
      * <TOTEM:END>
       gd-mag-3-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-mag-3-Ev-Msg-Begin-Entry>
      *    Luciano
      *     if mod = 0
           if e-clienti-dati = 0
      *    Luciano
              set event-action to event-action-fail
           else
              inquire gd-mag-3, cursor-x in colonna
              if colonna = 2
                 set event-action to event-action-fail
              else
                 inquire gd-mag-3(event-data-2, 1), cell-data in 
           old-mag-codice
              end-if
           end-if 
           .
      * <TOTEM:END>
       gd-mag-4-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-mag-4-Ev-Msg-Begin-Entry>
      *    Luciano
      *     if mod = 0
           if e-destini-dati = zero
      *    Luciano
              set event-action to event-action-fail
           else
              inquire gd-mag-4, cursor-x in colonna
              if colonna = 2
                 set event-action to event-action-fail
              else
                 inquire gd-mag-4(event-data-2, 1), cell-data in 
           old-mag-codice
              end-if
           end-if 
           .
      * <TOTEM:END>
       gd-mag-1-Ev-Msg-Finish-Entry.
      * <TOTEM:PARA. gd-mag-1-Ev-Msg-Finish-Entry>
           set tutto-ok to true.
           evaluate event-data-1
           when 1
                inquire gd-mag-1(event-data-2, 1), cell-data in 
           col-mag-codice
                move col-mag-codice to mag-codice
                if mag-codice = spaces
                   modify gd-mag-1, record-to-delete = event-data-2
                else
                   read tmagaz no lock 
                        invalid 
                        move spaces to mag-descrizione
                        set errori to true
                        set event-action to event-action-fail
                        display message "Magazzino NON valido"
                                  title tit-err
                                   icon 2
                   end-read
                   if tutto-ok
                      inquire gd-mag-1, last-row in tot-righe
                      perform varying riga from 2 by 1 
                                until riga > tot-righe 
                         inquire gd-mag-1(riga, 1), cell-data in 
           col-mag-codice
                         if col-mag-codice = mag-codice and riga not = 
           event-data-2
                            set errori to true
                            subtract 1 from riga
                            display message "Magazzino già presente a ri
      -    "ga " riga
                                      title tit-err
                                       icon 2
                            set event-action to event-action-fail
                            exit perform
                         end-if
                      end-perform
                   end-if
                   move mag-descrizione to col-mag-descrizione
                   modify gd-mag-1(event-data-2, 2), cell-data 
           col-mag-descrizione
                   if old-mag-codice = spaces and tutto-ok
                      modify gd-mag-1, insert-rows = 1
                   end-if   
                end-if
           when 3
                inquire gd-mag-1(event-data-2, 3), cell-data in 
           col-mag-intera-1
                if col-mag-intera-1 not = "S" and not = "N"
                   set errori to true
                   set event-action to event-action-fail
                   display message "Valori ammessi S(i) o N(o)"
                             title tit-err
                              icon 2
                end-if              
           end-evaluate 
           .
      * <TOTEM:END>
       gd-mag-2-Ev-Msg-Finish-Entry.
      * <TOTEM:PARA. gd-mag-2-Ev-Msg-Finish-Entry>
           set tutto-ok to true.
           evaluate event-data-1
           when 1
                inquire gd-mag-2(event-data-2, 1), cell-data in 
           col-mag-codice
                move col-mag-codice to mag-codice
                if mag-codice = spaces
                   modify gd-mag-2, record-to-delete = event-data-2
                else
                   read tmagaz no lock 
                        invalid 
                        move spaces to mag-descrizione
                        set errori to true
                        set event-action to event-action-fail
                        display message "Magazzino NON valido"
                                  title tit-err
                                   icon 2
                   end-read
                   if tutto-ok
                      inquire gd-mag-2, last-row in tot-righe
                      perform varying riga from 2 by 1 
                                until riga > tot-righe 
                         inquire gd-mag-2(riga, 1), cell-data in 
           col-mag-codice
                         if col-mag-codice = mag-codice and riga not = 
           event-data-2
                            set errori to true
                            subtract 1 from riga
                            display message "Magazzino già presente a ri
      -    "ga " riga
                                      title tit-err
                                       icon 2
                            set event-action to event-action-fail
                            exit perform
                         end-if
                      end-perform
                   end-if
                   move mag-descrizione to col-mag-descrizione
                   modify gd-mag-2(event-data-2, 2), cell-data 
           col-mag-descrizione
                   if old-mag-codice = spaces and tutto-ok
                      modify gd-mag-2, insert-rows = 1
                   end-if   
                end-if
           when 3
                inquire gd-mag-2(event-data-2, 3), cell-data in 
           col-mag-intera-2
                if col-mag-intera-2 not = "S" and not = "N"
                   set errori to true
                   set event-action to event-action-fail
                   display message "Valori ammessi S(i) o N(o)"
                             title tit-err
                              icon 2
                end-if              
           end-evaluate 
           .
      * <TOTEM:END>
       gd-mag-3-Ev-Msg-Finish-Entry.
      * <TOTEM:PARA. gd-mag-3-Ev-Msg-Finish-Entry>
           set tutto-ok to true.
           evaluate event-data-1
           when 1
                inquire gd-mag-3(event-data-2, 1), cell-data in 
           col-mag-codice
                move col-mag-codice to mag-codice
                if mag-codice = spaces
                   modify gd-mag-3, record-to-delete = event-data-2
                else
                   read tmagaz no lock 
                        invalid 
                        move spaces to mag-descrizione
                        set errori to true
                        set event-action to event-action-fail
                        display message "Magazzino NON valido"
                                  title tit-err
                                   icon 2
                   end-read
                   if tutto-ok
                      inquire gd-mag-3, last-row in tot-righe
                      perform varying riga from 2 by 1 
                                until riga > tot-righe 
                         inquire gd-mag-3(riga, 1), cell-data in 
           col-mag-codice
                         if col-mag-codice = mag-codice and riga not = 
           event-data-2
                            set errori to true
                            subtract 1 from riga
                            display message "Magazzino già presente a ri
      -    "ga " riga
                                      title tit-err
                                       icon 2
                            set event-action to event-action-fail
                            exit perform
                         end-if
                      end-perform
                   end-if
                   move mag-descrizione to col-mag-descrizione
                   modify gd-mag-3(event-data-2, 2), cell-data 
           col-mag-descrizione
                   if old-mag-codice = spaces and tutto-ok
                      modify gd-mag-3, insert-rows = 1
                   end-if   
                end-if
           when 3
                inquire gd-mag-3(event-data-2, 3), cell-data in 
           col-mag-intera-3
                if col-mag-intera-3 not = "S" and not = "N"
                   set errori to true
                   set event-action to event-action-fail
                   display message "Valori ammessi S(i) o N(o)"
                             title tit-err
                              icon 2
                end-if              
           end-evaluate 
           .
      * <TOTEM:END>
       gd-mag-4-Ev-Msg-Finish-Entry.
      * <TOTEM:PARA. gd-mag-4-Ev-Msg-Finish-Entry>
           set tutto-ok to true.
           evaluate event-data-1
           when 1
                inquire gd-mag-4(event-data-2, 1), cell-data in 
           col-mag-codice
                move col-mag-codice to mag-codice
                if mag-codice = spaces
                   modify gd-mag-4, record-to-delete = event-data-2
                else
                   read tmagaz no lock 
                        invalid 
                        move spaces to mag-descrizione
                        set errori to true
                        set event-action to event-action-fail
                        display message "Magazzino NON valido"
                                  title tit-err
                                   icon 2
                   end-read
                   if tutto-ok
                      inquire gd-mag-4, last-row in tot-righe
                      perform varying riga from 2 by 1 
                                until riga > tot-righe 
                         inquire gd-mag-4(riga, 1), cell-data in 
           col-mag-codice
                         if col-mag-codice = mag-codice and riga not = 
           event-data-2
                            set errori to true
                            subtract 1 from riga
                            display message "Magazzino già presente a ri
      -    "ga " riga
                                      title tit-err
                                       icon 2
                            set event-action to event-action-fail
                            exit perform
                         end-if
                      end-perform
                   end-if
                   move mag-descrizione to col-mag-descrizione
                   modify gd-mag-4(event-data-2, 2), cell-data 
           col-mag-descrizione
                   if old-mag-codice = spaces and tutto-ok
                      modify gd-mag-4, insert-rows = 1
                   end-if   
                end-if
           when 3
                inquire gd-mag-4(event-data-2, 3), cell-data in 
           col-mag-intera-4
                if col-mag-intera-4 not = "S" and not = "N"
                   set errori to true
                   set event-action to event-action-fail
                   display message "Valori ammessi S(i) o N(o)"
                             title tit-err
                              icon 2
                end-if              
           end-evaluate 
           .
      * <TOTEM:END>
       chk-pb-perce-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-perce-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-amp-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-amp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-perce-1-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-perce-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-amp-1-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-amp-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-perce-2-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-perce-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-amp-2-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-amp-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-perce-3-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-perce-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-amp-3-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-amp-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-perce-4-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-perce-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-amp-4-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-amp-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-perce-AfterProcedure.
      * <TOTEM:PARA. chk-pb-perce-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-amp-AfterProcedure.
      * <TOTEM:PARA. chk-pb-amp-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       chk-pb-perce-1-AfterProcedure.
      * <TOTEM:PARA. chk-pb-perce-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-amp-1-AfterProcedure.
      * <TOTEM:PARA. chk-pb-amp-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       chk-pb-perce-2-AfterProcedure.
      * <TOTEM:PARA. chk-pb-perce-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-amp-2-AfterProcedure.
      * <TOTEM:PARA. chk-pb-amp-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       chk-pb-perce-3-AfterProcedure.
      * <TOTEM:PARA. chk-pb-perce-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-amp-3-AfterProcedure.
      * <TOTEM:PARA. chk-pb-amp-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       chk-pb-perce-4-AfterProcedure.
      * <TOTEM:PARA. chk-pb-perce-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-amp-4-AfterProcedure.
      * <TOTEM:PARA. chk-pb-amp-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO 
           .
      * <TOTEM:END>
       chk-pb-perce-LinkTo.
      * <TOTEM:PARA. chk-pb-perce-LinkTo>
           inquire chk-pb-amp,   value in chk-pb-amp-buf.
           inquire chk-pb-perce, value in chk-pb-perce-buf.
           inquire chk-pb-bosch, value in chk-pb-bosch-buf.

           if chk-pb-amp-buf   = 0 and 
              chk-pb-perce-buf = 0 and
              chk-pb-bosch-buf = 0
              move 1 to chk-pb-perce-buf
              modify chk-pb-perce, value chk-pb-perce-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-amp-LinkTo.
      * <TOTEM:PARA. chk-pb-amp-LinkTo>
           inquire chk-pb-amp,   value in chk-pb-amp-buf.
           inquire chk-pb-perce, value in chk-pb-perce-buf.
           inquire chk-pb-bosch, value in chk-pb-bosch-buf.

           if chk-pb-amp-buf   = 0 and 
              chk-pb-perce-buf = 0 and
              chk-pb-bosch-buf = 0
              move 1 to chk-pb-amp-buf
              modify chk-pb-amp, value chk-pb-amp-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-amp-1-LinkTo.
      * <TOTEM:PARA. chk-pb-amp-1-LinkTo>
           inquire chk-pb-amp-1,   value in chk-pb-amp-1-buf.
           inquire chk-pb-perce-1, value in chk-pb-perce-1-buf.
           inquire chk-pb-bosch-1, value in chk-pb-bosch-1-buf.

           if chk-pb-amp-1-buf   = 0 and 
              chk-pb-perce-1-buf = 0 and
              chk-pb-bosch-1-buf = 0
              move 1 to chk-pb-amp-1-buf
              modify chk-pb-amp-1, value chk-pb-amp-1-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-amp-2-LinkTo.
      * <TOTEM:PARA. chk-pb-amp-2-LinkTo>
           inquire chk-pb-amp-2,   value in chk-pb-amp-2-buf.
           inquire chk-pb-perce-2, value in chk-pb-perce-2-buf.
           inquire chk-pb-bosch-2, value in chk-pb-bosch-2-buf.

           if chk-pb-amp-2-buf   = 0 and 
              chk-pb-perce-2-buf = 0 and
              chk-pb-bosch-2-buf = 0
              move 1 to chk-pb-amp-2-buf
              modify chk-pb-amp-2, value chk-pb-amp-2-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-amp-3-LinkTo.
      * <TOTEM:PARA. chk-pb-amp-3-LinkTo>
           inquire chk-pb-amp-3,   value in chk-pb-amp-3-buf.
           inquire chk-pb-perce-3, value in chk-pb-perce-3-buf.
           inquire chk-pb-bosch-3, value in chk-pb-bosch-3-buf.

           if chk-pb-amp-3-buf   = 0 and 
              chk-pb-perce-3-buf = 0 and
              chk-pb-bosch-3-buf = 0
              move 1 to chk-pb-amp-3-buf
              modify chk-pb-amp-3, value chk-pb-amp-3-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-amp-4-LinkTo.
      * <TOTEM:PARA. chk-pb-amp-4-LinkTo>
           inquire chk-pb-amp-4,   value in chk-pb-amp-4-buf.
           inquire chk-pb-perce-4, value in chk-pb-perce-4-buf.
           inquire chk-pb-bosch-4, value in chk-pb-bosch-4-buf.

           if chk-pb-amp-4-buf   = 0 and 
              chk-pb-perce-4-buf = 0 and
              chk-pb-bosch-4-buf = 0
              move 1 to chk-pb-amp-4-buf
              modify chk-pb-amp-4, value chk-pb-amp-4-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-perce-1-LinkTo.
      * <TOTEM:PARA. chk-pb-perce-1-LinkTo>
           inquire chk-pb-amp-1,   value in chk-pb-amp-1-buf.
           inquire chk-pb-perce-1, value in chk-pb-perce-1-buf.
           inquire chk-pb-bosch-1, value in chk-pb-bosch-1-buf.

           if chk-pb-amp-1-buf   = 0 and 
              chk-pb-perce-1-buf = 0 and
              chk-pb-bosch-1-buf = 0
              move 1 to chk-pb-perce-1-buf
              modify chk-pb-perce-1, value chk-pb-perce-1-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-perce-2-LinkTo.
      * <TOTEM:PARA. chk-pb-perce-2-LinkTo>
           inquire chk-pb-amp-2,   value in chk-pb-amp-2-buf.
           inquire chk-pb-perce-2, value in chk-pb-perce-2-buf.
           inquire chk-pb-bosch-2, value in chk-pb-bosch-2-buf.

           if chk-pb-amp-2-buf   = 0 and 
              chk-pb-perce-2-buf = 0 and
              chk-pb-bosch-2-buf = 0
              move 1 to chk-pb-perce-2-buf
              modify chk-pb-perce-2, value chk-pb-perce-2-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-perce-3-LinkTo.
      * <TOTEM:PARA. chk-pb-perce-3-LinkTo>
           inquire chk-pb-amp-3,   value in chk-pb-amp-3-buf.
           inquire chk-pb-perce-3, value in chk-pb-perce-3-buf.
           inquire chk-pb-bosch-3, value in chk-pb-bosch-3-buf.

           if chk-pb-amp-3-buf   = 0 and 
              chk-pb-perce-3-buf = 0 and
              chk-pb-bosch-3-buf = 0
              move 1 to chk-pb-perce-3-buf
              modify chk-pb-perce-3, value chk-pb-perce-3-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-perce-4-LinkTo.
      * <TOTEM:PARA. chk-pb-perce-4-LinkTo>
           inquire chk-pb-amp-4,   value in chk-pb-amp-4-buf.
           inquire chk-pb-perce-4, value in chk-pb-perce-4-buf.
           inquire chk-pb-bosch-4, value in chk-pb-bosch-4-buf.

           if chk-pb-amp-4-buf   = 0 and 
              chk-pb-perce-4-buf = 0 and
              chk-pb-bosch-4-buf = 0
              move 1 to chk-pb-perce-4-buf
              modify chk-pb-perce-4, value chk-pb-perce-4-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-bosch-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-bosch-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-bosch-1-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-bosch-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-bosch-2-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-bosch-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-bosch-3-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-bosch-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-bosch-4-BeforeProcedure.
      * <TOTEM:PARA. chk-pb-bosch-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-pb-bosch-AfterProcedure.
      * <TOTEM:PARA. chk-pb-bosch-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-bosch-1-AfterProcedure.
      * <TOTEM:PARA. chk-pb-bosch-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-bosch-2-AfterProcedure.
      * <TOTEM:PARA. chk-pb-bosch-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-bosch-3-AfterProcedure.
      * <TOTEM:PARA. chk-pb-bosch-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-bosch-4-AfterProcedure.
      * <TOTEM:PARA. chk-pb-bosch-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-pb-bosch-LinkTo.
      * <TOTEM:PARA. chk-pb-bosch-LinkTo>
           inquire chk-pb-amp,   value in chk-pb-amp-buf.
           inquire chk-pb-perce, value in chk-pb-perce-buf.
           inquire chk-pb-bosch, value in chk-pb-bosch-buf.

           if chk-pb-amp-buf   = 0 and 
              chk-pb-perce-buf = 0 and
              chk-pb-bosch-buf = 0
              move 1 to chk-pb-bosch-buf
              modify chk-pb-bosch, value chk-pb-bosch-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-bosch-1-LinkTo.
      * <TOTEM:PARA. chk-pb-bosch-1-LinkTo>
           inquire chk-pb-amp-1,   value in chk-pb-amp-1-buf.
           inquire chk-pb-perce-1, value in chk-pb-perce-1-buf.
           inquire chk-pb-bosch-1, value in chk-pb-bosch-1-buf.

           if chk-pb-amp-1-buf   = 0 and 
              chk-pb-perce-1-buf = 0 and
              chk-pb-bosch-1-buf = 0
              move 1 to chk-pb-bosch-1-buf
              modify chk-pb-bosch-1, value chk-pb-bosch-1-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-bosch-2-LinkTo.
      * <TOTEM:PARA. chk-pb-bosch-2-LinkTo>
           inquire chk-pb-amp-2,   value in chk-pb-amp-2-buf.
           inquire chk-pb-perce-2, value in chk-pb-perce-2-buf.
           inquire chk-pb-bosch-2, value in chk-pb-bosch-2-buf.

           if chk-pb-amp-2-buf   = 0 and 
              chk-pb-perce-2-buf = 0 and
              chk-pb-bosch-2-buf = 0
              move 1 to chk-pb-bosch-2-buf
              modify chk-pb-bosch-2, value chk-pb-bosch-2-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-bosch-3-LinkTo.
      * <TOTEM:PARA. chk-pb-bosch-3-LinkTo>
           inquire chk-pb-amp-3,   value in chk-pb-amp-3-buf.
           inquire chk-pb-perce-3, value in chk-pb-perce-3-buf.
           inquire chk-pb-bosch-3, value in chk-pb-bosch-3-buf.

           if chk-pb-amp-3-buf   = 0 and 
              chk-pb-perce-3-buf = 0 and
              chk-pb-bosch-3-buf = 0
              move 1 to chk-pb-bosch-3-buf
              modify chk-pb-bosch-3, value chk-pb-bosch-3-buf
           end-if 
           .
      * <TOTEM:END>
       chk-pb-bosch-4-LinkTo.
      * <TOTEM:PARA. chk-pb-bosch-4-LinkTo>
           inquire chk-pb-amp-4,   value in chk-pb-amp-4-buf.
           inquire chk-pb-perce-4, value in chk-pb-perce-4-buf.
           inquire chk-pb-bosch-4, value in chk-pb-bosch-4-buf.

           if chk-pb-amp-4-buf   = 0 and 
              chk-pb-perce-4-buf = 0 and
              chk-pb-bosch-4-buf = 0
              move 1 to chk-pb-bosch-4-buf
              modify chk-pb-bosch-4, value chk-pb-bosch-4-buf
           end-if 
           .
      * <TOTEM:END>
       pb-stampanti-LinkTo.
      * <TOTEM:PARA. pb-stampanti-LinkTo>
           move ef-stampante-buf to selprint-stampante.
           call   "zoomprint" using selprint-linkage.
           cancel "zoomprint".
           move selprint-stampante to ef-stampante-buf.
           display ef-stampante 
           .
      * <TOTEM:END>
       pb-stampanti-1-LinkTo.
      * <TOTEM:PARA. pb-stampanti-1-LinkTo>
           move ef-stampante-1-buf to selprint-stampante.
           call   "zoomprint" using selprint-linkage.
           cancel "zoomprint".
           move selprint-stampante to ef-stampante-1-buf.
           display ef-stampante-1 
           .
      * <TOTEM:END>
       pb-stampanti-2-LinkTo.
      * <TOTEM:PARA. pb-stampanti-2-LinkTo>
           move ef-stampante-2-buf to selprint-stampante.
           call   "zoomprint" using selprint-linkage.
           cancel "zoomprint".
           move selprint-stampante to ef-stampante-2-buf.
           display ef-stampante-2 
           .
      * <TOTEM:END>
       pb-stampanti-3-LinkTo.
      * <TOTEM:PARA. pb-stampanti-3-LinkTo>
           move ef-stampante-3-buf to selprint-stampante.
           call   "zoomprint" using selprint-linkage.
           cancel "zoomprint".
           move selprint-stampante to ef-stampante-3-buf.
           display ef-stampante-3 
           .
      * <TOTEM:END>
       pb-stampanti-4-LinkTo.
      * <TOTEM:PARA. pb-stampanti-4-LinkTo>
           move ef-stampante-4-buf to selprint-stampante.
           call   "zoomprint" using selprint-linkage.
           cancel "zoomprint".
           move selprint-stampante to ef-stampante-4-buf.
           display ef-stampante-4 
           .
      * <TOTEM:END>
       ef-min-vet-30kg-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-BeforeProcedure>
           move 1 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-min-vet-30kg-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-AfterProcedure>

           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-min-vet-30kg-1-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-1-BeforeProcedure>
           move 1 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-min-vet-30kg-1-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-1-AfterProcedure>

           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-min-vet-30kg-2-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-2-BeforeProcedure>
           move 1 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-min-vet-30kg-2-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-2-AfterProcedure>

           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-min-vet-30kg-3-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-3-BeforeProcedure>
           move 1 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-min-vet-30kg-3-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-3-AfterProcedure>

           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       ef-min-vet-30kg-4-BeforeProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-4-BeforeProcedure>
           move 1 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-min-vet-30kg-4-AfterProcedure.
      * <TOTEM:PARA. ef-min-vet-30kg-4-AfterProcedure>

           perform CONTROLLO.
           move 0 to StatusHelp.
           perform STATUS-HELP.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-path-logo-LinkTo.
      * <TOTEM:PARA. pb-path-logo-LinkTo>
           inquire ef-path-logo, value in path-logo.
           perform FILE-SELECTOR.
           move path-logo to ef-path-logo-buf.
           display ef-path-logo 
           .
      * <TOTEM:END>
       ef-path-logoa-BeforeProcedure.
      * <TOTEM:PARA. ef-path-logoa-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-logoa-AfterProcedure.
      * <TOTEM:PARA. ef-path-logoa-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       pb-path-logo-1-LinkTo.
      * <TOTEM:PARA. pb-path-logo-1-LinkTo>
           inquire ef-path-logo-1, value in path-logo.
           perform FILE-SELECTOR.
           move path-logo to ef-path-logo-1-buf.
           display ef-path-logo-1 
           .
      * <TOTEM:END>
       pb-path-logo-2-LinkTo.
      * <TOTEM:PARA. pb-path-logo-2-LinkTo>
           inquire ef-path-logo-2, value in path-logo.
           perform FILE-SELECTOR.
           move path-logo to ef-path-logo-2-buf.
           display ef-path-logo-2 
           .
      * <TOTEM:END>
       pb-path-logo-3-LinkTo.
      * <TOTEM:PARA. pb-path-logo-3-LinkTo>
           inquire ef-path-logo-3, value in path-logo.
           perform FILE-SELECTOR.
           move path-logo to ef-path-logo-3-buf.
           display ef-path-logo-3 
           .
      * <TOTEM:END>
       pb-path-logo-4-LinkTo.
      * <TOTEM:PARA. pb-path-logo-4-LinkTo>
           inquire ef-path-logo-4, value in path-logo.
           perform FILE-SELECTOR.
           move path-logo to ef-path-logo-4-buf.
           display ef-path-logo-4 
           .
      * <TOTEM:END>
       ef-path-logo-BeforeProcedure.
      * <TOTEM:PARA. ef-path-logo-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-path-logo-AfterProcedure.
      * <TOTEM:PARA. ef-path-logo-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-sost-batt-4-BeforeProcedure.
      * <TOTEM:PARA. chk-sost-batt-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-sost-batt-4-AfterProcedure.
      * <TOTEM:PARA. chk-sost-batt-4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-sost-batt-3-BeforeProcedure.
      * <TOTEM:PARA. chk-sost-batt-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-sost-batt-3-AfterProcedure.
      * <TOTEM:PARA. chk-sost-batt-3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-sost-batt-2-BeforeProcedure.
      * <TOTEM:PARA. chk-sost-batt-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-sost-batt-2-AfterProcedure.
      * <TOTEM:PARA. chk-sost-batt-2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-sost-batt-1-BeforeProcedure.
      * <TOTEM:PARA. chk-sost-batt-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-sost-batt-1-AfterProcedure.
      * <TOTEM:PARA. chk-sost-batt-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-sost-batt-BeforeProcedure.
      * <TOTEM:PARA. chk-sost-batt-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-sost-batt-AfterProcedure.
      * <TOTEM:PARA. chk-sost-batt-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>

      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

