      *{TOTEM}PRG-COMMENT
      * gordforn.Cbl
      * gordforn.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          gordforn.
       AUTHOR.              Utente.
       DATE-WRITTEN.        lunedì 8 agosto 2022 01:36:22.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:gordforn, INIT:gordforn, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "tordforn.sl".
           COPY "tparamge.sl".
           COPY "timballi.sl".
           COPY "zoom-tcaumag.sl".
           COPY "blister.sl".
           COPY "articoli.sl".
           COPY "tcodpag.sl".
           COPY "timposte.sl".
           COPY "timbalqta.sl".
           COPY "tmarche.sl".
           COPY "progmag.sl".
           COPY "tmp-progmag-zoom.sl".
           COPY "nordforn.sl".
           COPY "tivaese.sl".
           COPY "tpiombo.sl".
           COPY "locali.sl".
           COPY "tlistini.sl".
           COPY "rlistini.sl".
           COPY "tcaumag.sl".
           COPY "tmp-nordforn.sl".
           COPY "clienti.sl".
           COPY "clienti.sl"
                REPLACING ==clienti== BY ==clienti1==,
                          ==STATUS-clienti== BY ==STATUS-clienti1==
                .
           COPY "lockfile.sl".
           COPY "art-ordforn.sl".
           COPY "destinif.sl".
           COPY "impforn.sl".
           COPY "rordforn.sl".
           COPY "destini.sl".
           COPY "tpromo.sl".
           COPY "tmp-tpromo-zoom.sl".
           COPY "tgrupgdo.sl".
           COPY "tmagaz.sl".
           COPY "distinteb.sl".
           COPY "nlistini.sl".
           COPY "nforn-dest.sl".
           COPY "param.sl".
           COPY "tscorte.sl".
           COPY "rordini.sl".
           COPY "tordini.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "tordforn.fd".
           COPY "tparamge.fd".
           COPY "timballi.fd".
           COPY "zoom-tcaumag.fd".
           COPY "blister.fd".
           COPY "articoli.fd".
           COPY "tcodpag.fd".
           COPY "timposte.fd".
           COPY "timbalqta.fd".
           COPY "tmarche.fd".
           COPY "progmag.fd".
           COPY "tmp-progmag-zoom.fd".
           COPY "nordforn.fd".
           COPY "tivaese.fd".
           COPY "tpiombo.fd".
           COPY "locali.fd".
           COPY "tlistini.fd".
           COPY "rlistini.fd".
           COPY "tcaumag.fd".
           COPY "tmp-nordforn.fd".
           COPY "clienti.fd".
           COPY "clienti.fd"
                REPLACING ==clienti== BY ==clienti1==,
                          ==STATUS-clienti== BY ==STATUS-clienti1==
                .
           COPY "lockfile.fd".
           COPY "art-ordforn.fd".
           COPY "destinif.fd".
           COPY "impforn.fd".
           COPY "rordforn.fd".
           COPY "destini.fd".
           COPY "tpromo.fd".
           COPY "tmp-tpromo-zoom.fd".
           COPY "tgrupgdo.fd".
           COPY "tmagaz.fd".
           COPY "distinteb.fd".
           COPY "nlistini.fd".
           COPY "nforn-dest.fd".
           COPY "param.fd".
           COPY "tscorte.fd".
           COPY "rordini.fd".
           COPY "tordini.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "fonts.def".
               COPY "crtvars.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "standard.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
      * Properties & User defined Working Stoarge
           COPY  "GORDFORN-WS.DEF".
           COPY  "ORDFORN-WS.DEF".
       77 STATUS-tscorte   PIC  X(2).
           88 Valid-STATUS-tscorte VALUE IS "00" THRU "09". 
       77 annulla-bmp      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 IMPORTA-DA-BMP   PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 scr-stampa-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 78-ID-ef-st-tipo PIC  9(6)
                  VALUE IS 0.
       77 ef-ricerca-piva-buf          PIC  X(11).
       77 BOTTONE-OK-BMP   PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 BOTTONE-CANCEL-BMP           PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 ef-anno-ord-buf  PIC  z(4).
       77 ef-numero-ord-buf            PIC  z(8).
       77 STATUS-tordini   PIC  X(2).
           88 Valid-STATUS-tordini VALUE IS "00" THRU "09". 

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 Screen1-Ta-1-TAB-VALUE  PIC  99  VALUE 1.
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
      * DATA CONTROL BUFFER
       01 Form1-BUF.
      * Data.Entry-Field
              05 ef-anno-BUF PIC 9(4).
      * Data.Entry-Field
              05 ef-cau-BUF PIC X(4).
              05 ef-cau-VALUEBUF PIC X(4).
      * Data.Entry-Field
              05 ef-cli-BUF PIC x(5).
              05 ef-cli-VALUEBUF PIC 9(5).
      * Data.Entry-Field
              05 ef-dest-BUF PIC x(5).
              05 ef-dest-VALUEBUF PIC 9(5).
      * Data.Label
              05 lab-cli-BUF PIC X(40).
      * Data.Label
              05 lab-ind-cli-BUF PIC X(40).
      * Data.Label
              05 lab-loc-cli-BUF PIC X(35).
      * Page
              05 PAGE-1-BUF.
      * Data.Entry-Field
              10 ef-data-BUF PIC 99/99/9999.
              10 ef-data-VALUEBUF PIC 9(8).
      * Data.Entry-Field
              10 ef-data-cons-BUF PIC 99/99/9999.
              10 ef-data-cons-VALUEBUF PIC 9(8).
      * Data.Entry-Field
              10 ef-data-listino-BUF PIC 99/99/9999.
      * Data.Check-Box
              10 chk-aperto-BUF PIC 9 VALUE ZERO.
      * Data.Check-Box
              10 chk-franco-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-promo-BUF PIC z(15).
      * Data.Check-Box
              10 chk-dati-fatt-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-cliente-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-des-cli-BUF PIC z(5).
      * Data.Entry-Field
              10 ef-evasione-BUF PIC z(6).
      * Data.Entry-Field
              10 ef-referente-BUF PIC X(40).
      * Data.Entry-Field
              10 ef-tel-BUF PIC X(20).
      * Data.Entry-Field
              10 ef-fax-BUF PIC X(20).
      * Data.Entry-Field
              10 ef-mail-BUF PIC X(100).
      * Data.Entry-Field
              10 ef-pag-BUF PIC X(3).
      * Data.Entry-Field
              10 ef-ese-iva-BUF PIC X(3).
      * Data.Radio-Button
              10 Form1-RADIO-1-BUF PIC 99 VALUE ZERO.
      * Data.Entry-Field
              10 ef-note-1-BUF PIC X(200).
      * Data.Entry-Field
              10 ef-note-2-BUF PIC X(200).
      * Data.Entry-Field
              10 ef-note-3-BUF PIC X(200).
      * Data.Entry-Field
              10 ef-note-4-BUF PIC X(200).
      * Data.Label
              10 lab-cliente-BUF PIC X(40).
      * Data.Label
              10 lab-des-cli-BUF PIC x(100).
      * Data.Label
              10 lab-des-loca-BUF PIC X(35).
      * Data.Label
              10 lab-promo-BUF PIC X(100).
      * Page
              05 PAGE-2-BUF.
      * Group-Item
              10 campi-grid-BUF.
      * Data.Entry-Field
              15 ef-art-BUF PIC z(6).
      * Data.Entry-Field
              15 ef-imb-ord-BUF PIC x(3).
      * Data.Entry-Field
              15 ef-qta-BUF PIC 9(8).
      * Data.Entry-Field
              15 ef-uni-BUF PIC zzz.zzz.zz9,9999.
      * Data.Entry-Field
              15 ef-sconto-1-BUF PIC zz9,9(2).
      * Data.Entry-Field
              15 ef-sconto-2-BUF PIC zz9,9(2).
      * Data.Entry-Field
              15 ef-sconto-3-BUF PIC zz9,9(2).
      * Data.Entry-Field
              15 ef-sconto-4-BUF PIC zz9,9(2).
      * Data.Entry-Field
              15 ef-sconto-5-BUF PIC zz9,9(2).
      * Data.Entry-Field
              15 ef-cons-BUF PIC z.zz9,9999.
      * Data.Entry-Field
              15 ef-cou-BUF PIC z.zz9,9999.
      * Data.Entry-Field
              15 ef-add-BUF PIC z.zz9,9999.
      * Data.Entry-Field
              15 ef-costi-agg-BUF PIC zzz.zzz.zz9,9999.
      * Data.Entry-Field
              15 ef-imp-BUF PIC zzz.zzz.zz9,9999.
      * Data.Entry-Field
              15 ef-cod-iva-BUF PIC X(3).
      * Data.Label
              10 lab-art-BUF PIC X(100).
      * Data.Label
              10 lab-imb-BUF PIC X(50).
      * Data.Check-Box
              10 chk-manuale-BUF PIC 9 VALUE ZERO.
      * Data.Entry-Field
              10 ef-impforn-BUF PIC z(5).
      * Data.Label
              05 lab-cau-BUF PIC X(40).
      * Data.Label
              05 lab-loc-dest-BUF PIC X(35).
      * Data.Label
              05 lab-ind-dest-BUF PIC X(40).
      * Data.Label
              05 lab-dest-BUF PIC X(40).

       77 TMP-Form1-KEY1-ORDER  PIC X VALUE "A".
       77 TMP-Form1-tordforn-RESTOREBUF  PIC X(556).
       77 TMP-Form1-KEYIS  PIC 9(3) VALUE 1.
       77 Form1-MULKEY-TMPBUF   PIC X(556).
       77 STATUS-scr-importa-FLAG-REFRESH PIC  9.
          88 scr-importa-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 TMP-DataSet1-tordforn-BUF     PIC X(556).
       77 TMP-DataSet1-tparamge-BUF     PIC X(815).
       77 TMP-DataSet1-timballi-BUF     PIC X(210).
       77 TMP-DataSet1-zoom-tcaumag-BUF     PIC X(87).
       77 TMP-DataSet1-blister-BUF     PIC X(2967).
       77 TMP-DataSet1-articoli-BUF     PIC X(3669).
       77 TMP-DataSet1-tcodpag-BUF     PIC X(1380).
       77 TMP-DataSet1-timposte-BUF     PIC X(717).
       77 TMP-DataSet1-timbalqta-BUF     PIC X(167).
       77 TMP-DataSet1-tmarche-BUF     PIC X(217).
       77 TMP-DataSet1-progmag-BUF     PIC X(1090).
       77 TMP-DataSet1-tmp-progmag-zoom-BUF     PIC X(195).
       77 TMP-DataSet1-nordforn-BUF     PIC X(381).
       77 TMP-DataSet1-tivaese-BUF     PIC X(1380).
       77 TMP-DataSet1-tpiombo-BUF     PIC X(739).
       77 TMP-DataSet1-locali-BUF     PIC X(203).
       77 TMP-DataSet1-tlistini-BUF     PIC X(257).
       77 TMP-DataSet1-rlistini-BUF     PIC X(448).
       77 TMP-DataSet1-tcaumag-BUF     PIC X(254).
       77 TMP-DataSet1-tmp-nordforn-BUF     PIC X(381).
       77 TMP-DataSet1-clienti-BUF     PIC X(3610).
       77 TMP-DataSet1-clienti1-BUF     PIC X(3610).
       77 TMP-DataSet1-lockfile-BUF     PIC X(183).
       77 TMP-DataSet1-art-ordforn-BUF     PIC X(302).
       77 TMP-DataSet1-destinif-BUF     PIC X(1322).
       77 TMP-DataSet1-impforn-BUF     PIC X(220).
       77 TMP-DataSet1-rordforn-BUF     PIC X(544).
       77 TMP-DataSet1-destini-BUF     PIC X(3676).
       77 TMP-DataSet1-tpromo-BUF     PIC X(263).
       77 TMP-DataSet1-tmp-tpromo-zoom-BUF     PIC X(86).
       77 TMP-DataSet1-tgrupgdo-BUF     PIC X(1206).
       77 TMP-DataSet1-tmagaz-BUF     PIC X(212).
       77 TMP-DataSet1-distinteb-BUF     PIC X(672).
       77 TMP-DataSet1-nlistini-BUF     PIC X(824).
       77 TMP-DataSet1-nforn-dest-BUF     PIC X(379).
       77 TMP-DataSet1-param-BUF     PIC X(980).
       77 TMP-DataSet1-tscorte-BUF     PIC X(205).
       77 TMP-DataSet1-rordini-BUF     PIC X(667).
       77 TMP-DataSet1-tordini-BUF     PIC X(3938).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-tordforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tordforn-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-tordforn-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-tordforn-KEY1-Asc  VALUE "A".
          88 DataSet1-tordforn-KEY1-Desc VALUE "D".
       77 DataSet1-tparamge-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tparamge-LOCK  VALUE "Y".
       77 DataSet1-tparamge-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tparamge-KEY-Asc  VALUE "A".
          88 DataSet1-tparamge-KEY-Desc VALUE "D".
       77 DataSet1-timballi-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timballi-LOCK  VALUE "Y".
       77 DataSet1-timballi-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timballi-KEY-Asc  VALUE "A".
          88 DataSet1-timballi-KEY-Desc VALUE "D".
       77 DataSet1-zoom-tcaumag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-zoom-tcaumag-LOCK  VALUE "Y".
       77 DataSet1-zoom-tcaumag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-zoom-tcaumag-KEY-Asc  VALUE "A".
          88 DataSet1-zoom-tcaumag-KEY-Desc VALUE "D".
       77 DataSet1-blister-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-blister-LOCK  VALUE "Y".
       77 DataSet1-blister-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-blister-KEY-Asc  VALUE "A".
          88 DataSet1-blister-KEY-Desc VALUE "D".
       77 DataSet1-articoli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-articoli-LOCK  VALUE "Y".
       77 DataSet1-articoli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-articoli-KEY-Asc  VALUE "A".
          88 DataSet1-articoli-KEY-Desc VALUE "D".
       77 DataSet1-tcodpag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcodpag-LOCK  VALUE "Y".
       77 DataSet1-tcodpag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcodpag-KEY-Asc  VALUE "A".
          88 DataSet1-tcodpag-KEY-Desc VALUE "D".
       77 DataSet1-timposte-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timposte-LOCK  VALUE "Y".
       77 DataSet1-timposte-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timposte-KEY-Asc  VALUE "A".
          88 DataSet1-timposte-KEY-Desc VALUE "D".
       77 DataSet1-timbalqta-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-timbalqta-LOCK  VALUE "Y".
       77 DataSet1-timbalqta-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-timbalqta-KEY-Asc  VALUE "A".
          88 DataSet1-timbalqta-KEY-Desc VALUE "D".
       77 DataSet1-tmarche-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmarche-LOCK  VALUE "Y".
       77 DataSet1-tmarche-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmarche-KEY-Asc  VALUE "A".
          88 DataSet1-tmarche-KEY-Desc VALUE "D".
       77 DataSet1-progmag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-progmag-LOCK  VALUE "Y".
       77 DataSet1-progmag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-progmag-KEY-Asc  VALUE "A".
          88 DataSet1-progmag-KEY-Desc VALUE "D".
       77 DataSet1-tmp-progmag-zoom-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-progmag-zoom-LOCK  VALUE "Y".
       77 DataSet1-tmp-progmag-zoom-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-progmag-zoom-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-progmag-zoom-KEY-Desc VALUE "D".
       77 DataSet1-nordforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-nordforn-LOCK  VALUE "Y".
       77 DataSet1-nordforn-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-nordforn-KEY-Asc  VALUE "A".
          88 DataSet1-nordforn-KEY-Desc VALUE "D".
       77 DataSet1-tivaese-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tivaese-LOCK  VALUE "Y".
       77 DataSet1-tivaese-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tivaese-KEY-Asc  VALUE "A".
          88 DataSet1-tivaese-KEY-Desc VALUE "D".
       77 DataSet1-tpiombo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tpiombo-LOCK  VALUE "Y".
       77 DataSet1-tpiombo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tpiombo-KEY-Asc  VALUE "A".
          88 DataSet1-tpiombo-KEY-Desc VALUE "D".
       77 DataSet1-locali-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-locali-LOCK  VALUE "Y".
       77 DataSet1-locali-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-locali-KEY-Asc  VALUE "A".
          88 DataSet1-locali-KEY-Desc VALUE "D".
       77 DataSet1-tlistini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tlistini-LOCK  VALUE "Y".
       77 DataSet1-tlistini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tlistini-KEY-Asc  VALUE "A".
          88 DataSet1-tlistini-KEY-Desc VALUE "D".
       77 DataSet1-rlistini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rlistini-LOCK  VALUE "Y".
       77 DataSet1-rlistini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rlistini-KEY-Asc  VALUE "A".
          88 DataSet1-rlistini-KEY-Desc VALUE "D".
       77 DataSet1-tcaumag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcaumag-LOCK  VALUE "Y".
       77 DataSet1-tcaumag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcaumag-KEY-Asc  VALUE "A".
          88 DataSet1-tcaumag-KEY-Desc VALUE "D".
       77 DataSet1-tmp-nordforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-nordforn-LOCK  VALUE "Y".
       77 DataSet1-tmp-nordforn-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-nordforn-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-nordforn-KEY-Desc VALUE "D".
       77 DataSet1-clienti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-clienti-LOCK  VALUE "Y".
       77 DataSet1-clienti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti-KEY-Asc  VALUE "A".
          88 DataSet1-clienti-KEY-Desc VALUE "D".
       77 DataSet1-clienti1-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-clienti1-LOCK  VALUE "Y".
       77 DataSet1-clienti1-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti1-KEY-Asc  VALUE "A".
          88 DataSet1-clienti1-KEY-Desc VALUE "D".
       77 DataSet1-lockfile-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-lockfile-LOCK  VALUE "Y".
       77 DataSet1-lockfile-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-lockfile-KEY-Asc  VALUE "A".
          88 DataSet1-lockfile-KEY-Desc VALUE "D".
       77 DataSet1-art-ordforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-art-ordforn-LOCK  VALUE "Y".
       77 DataSet1-art-ordforn-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-art-ordforn-KEY-Asc  VALUE "A".
          88 DataSet1-art-ordforn-KEY-Desc VALUE "D".
       77 DataSet1-destinif-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-destinif-LOCK  VALUE "Y".
       77 DataSet1-destinif-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-destinif-KEY-Asc  VALUE "A".
          88 DataSet1-destinif-KEY-Desc VALUE "D".
       77 DataSet1-impforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-impforn-LOCK  VALUE "Y".
       77 DataSet1-impforn-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-impforn-KEY-Asc  VALUE "A".
          88 DataSet1-impforn-KEY-Desc VALUE "D".
       77 DataSet1-rordforn-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rordforn-LOCK  VALUE "Y".
       77 DataSet1-rordforn-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rordforn-KEY-Asc  VALUE "A".
          88 DataSet1-rordforn-KEY-Desc VALUE "D".
       77 DataSet1-destini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-destini-LOCK  VALUE "Y".
       77 DataSet1-destini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-destini-KEY-Asc  VALUE "A".
          88 DataSet1-destini-KEY-Desc VALUE "D".
       77 DataSet1-tpromo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tpromo-LOCK  VALUE "Y".
       77 DataSet1-tpromo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tpromo-KEY-Asc  VALUE "A".
          88 DataSet1-tpromo-KEY-Desc VALUE "D".
       77 DataSet1-tmp-tpromo-zoom-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-tpromo-zoom-LOCK  VALUE "Y".
       77 DataSet1-tmp-tpromo-zoom-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-tpromo-zoom-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-tpromo-zoom-KEY-Desc VALUE "D".
       77 DataSet1-tgrupgdo-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tgrupgdo-LOCK  VALUE "Y".
       77 DataSet1-tgrupgdo-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tgrupgdo-KEY-Asc  VALUE "A".
          88 DataSet1-tgrupgdo-KEY-Desc VALUE "D".
       77 DataSet1-tmagaz-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmagaz-LOCK  VALUE "Y".
       77 DataSet1-tmagaz-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmagaz-KEY-Asc  VALUE "A".
          88 DataSet1-tmagaz-KEY-Desc VALUE "D".
       77 DataSet1-distinteb-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-distinteb-LOCK  VALUE "Y".
       77 DataSet1-distinteb-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-distinteb-KEY-Asc  VALUE "A".
          88 DataSet1-distinteb-KEY-Desc VALUE "D".
       77 DataSet1-nlistini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-nlistini-LOCK  VALUE "Y".
       77 DataSet1-nlistini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-nlistini-KEY-Asc  VALUE "A".
          88 DataSet1-nlistini-KEY-Desc VALUE "D".
       77 DataSet1-nforn-dest-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-nforn-dest-LOCK  VALUE "Y".
       77 DataSet1-nforn-dest-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-nforn-dest-KEY-Asc  VALUE "A".
          88 DataSet1-nforn-dest-KEY-Desc VALUE "D".
       77 DataSet1-param-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-param-LOCK  VALUE "Y".
       77 DataSet1-param-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-param-KEY-Asc  VALUE "A".
          88 DataSet1-param-KEY-Desc VALUE "D".
       77 DataSet1-tscorte-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tscorte-LOCK  VALUE "Y".
       77 DataSet1-tscorte-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tscorte-KEY-Asc  VALUE "A".
          88 DataSet1-tscorte-KEY-Desc VALUE "D".
       77 DataSet1-rordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rordini-LOCK  VALUE "Y".
       77 DataSet1-rordini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rordini-KEY-Asc  VALUE "A".
          88 DataSet1-rordini-KEY-Desc VALUE "D".
       77 DataSet1-tordini-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tordini-LOCK  VALUE "Y".
       77 DataSet1-tordini-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tordini-KEY-Asc  VALUE "A".
          88 DataSet1-tordini-KEY-Desc VALUE "D".

       77 tordforn-tof-k-causale-SPLITBUF  PIC X(17).
       77 tordforn-tof-k-stato-SPLITBUF  PIC X(14).
       77 tordforn-k-fornitore-SPLITBUF  PIC X(24).
       77 tordforn-tof-k-data-SPLITBUF  PIC X(21).
       77 tordforn-tof-k-consegna-SPLITBUF  PIC X(21).
       77 blister-k-magaz-SPLITBUF  PIC X(10).
       77 blister-k-des-SPLITBUF  PIC X(51).
       77 articoli-art-k1-SPLITBUF  PIC X(51).
       77 articoli-art-k-frn-SPLITBUF  PIC X(16).
       77 tcodpag-TBL-CODICE-01-SPLITBUF  PIC X(53).
       77 progmag-key01-SPLITBUF  PIC X(21).
       77 tmp-progmag-zoom-key-des-SPLITBUF  PIC X(64).
       77 tmp-progmag-zoom-key-art-SPLITBUF  PIC X(7).
       77 tivaese-key01-SPLITBUF  PIC X(53).
       77 locali-loc-chiave-gdo-fine-SPLITBUF  PIC X(32).
       77 locali-loc-chiave-fine-SPLITBUF  PIC X(32).
       77 locali-loc-chiave-ini-SPLITBUF  PIC X(32).
       77 rlistini-rlis-k-art-SPLITBUF  PIC X(33).
       77 rlistini-rlis-k-descr-SPLITBUF  PIC X(66).
       77 tcaumag-k-mag-SPLITBUF  PIC X(5).
       77 clienti-cli-K1-SPLITBUF  PIC X(47).
       77 clienti-cli-K3-SPLITBUF  PIC X(12).
       77 clienti-cli-K4-SPLITBUF  PIC X(8).
       77 clienti1-cli-K1-SPLITBUF  PIC X(47).
       77 clienti1-cli-K3-SPLITBUF  PIC X(12).
       77 clienti1-cli-K4-SPLITBUF  PIC X(8).
       77 destinif-K1-SPLITBUF  PIC X(51).
       77 destinif-desf-k2-SPLITBUF  PIC X(51).
       77 rordforn-rof-k-articolo-SPLITBUF  PIC X(24).
       77 rordforn-rof-k-art-mag-SPLITBUF  PIC X(27).
       77 destini-K1-SPLITBUF  PIC X(111).
       77 destini-k-localita-SPLITBUF  PIC X(36).
       77 tpromo-tpr-chiave-ricerca-SPLITBUF  PIC X(22).
       77 tpromo-tpr-chiave-gdo-fine-SPLITBUF  PIC X(22).
       77 tpromo-tpr-chiave-fine-SPLITBUF  PIC X(22).
       77 tpromo-tpr-chiave-ini-SPLITBUF  PIC X(22).
       77 tpromo-tpr-chiave-volantino-SPLITBUF  PIC X(22).
       77 tpromo-tpr-k-fine-vol-SPLITBUF  PIC X(22).
       77 tpromo-tpr-k-data-ins-SPLITBUF  PIC X(29).
       77 tmp-tpromo-zoom-tmp-tpr-z-k1-SPLITBUF  PIC X(14).
       77 tgrupgdo-gdo-k-g2-SPLITBUF  PIC X(9).
       77 distinteb-k-articolo-SPLITBUF  PIC X(12).
       77 distinteb-k-progmag-SPLITBUF  PIC X(21).
       77 rordini-ror-k-promo-SPLITBUF  PIC X(16).
       77 rordini-ror-k-articolo-SPLITBUF  PIC X(24).
       77 rordini-ror-k-master-SPLITBUF  PIC X(35).
       77 rordini-ror-k-stbolle-SPLITBUF  PIC X(30).
       77 rordini-ror-k-ord-art-SPLITBUF  PIC X(19).
       77 tordini-k-causale-SPLITBUF  PIC X(17).
       77 tordini-k1-SPLITBUF  PIC X(23).
       77 tordini-k2-SPLITBUF  PIC X(21).
       77 tordini-k-bolla-SPLITBUF  PIC X(13).
       77 tordini-k3-SPLITBUF  PIC X(22).
       77 tordini-k-fattura-SPLITBUF  PIC X(13).
       77 tordini-k4-SPLITBUF  PIC X(30).
       77 tordini-k-contab-SPLITBUF  PIC X(14).
       77 tordini-k-tipo-SPLITBUF  PIC X(14).
       77 tordini-k-data-SPLITBUF  PIC X(17).
       77 tordini-k-agfatt-SPLITBUF  PIC X(42).
       77 tordini-k-stbolle-SPLITBUF  PIC X(34).
       77 tordini-k-andamento-data-SPLITBUF  PIC X(10).
       77 tordini-k-andamento-cliente-SPLITBUF  PIC X(15).
       77 tordini-k-andamento-clides-SPLITBUF  PIC X(20).
       77 tordini-k-promo-SPLITBUF  PIC X(29).
       77 tordini-k-or-SPLITBUF  PIC X(61).
       77 tordini-k-tor-inviare-SPLITBUF  PIC X(14).
       77 tordini-k-tor-tipocli-SPLITBUF  PIC X(25).
       77 tordini-k-tor-gdo-SPLITBUF  PIC X(28).
      * FOR SPLIT KEY BUFFER
       77 DataSet1-tmp-progmag-zoom-SPLIT-BUF1   PIC X(64).


      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-ef-anno VALUE 5001.
       78  78-ID-ef-cau VALUE 5002.
       78  78-ID-ef-cli VALUE 5003.
       78  78-ID-ef-dest VALUE 5004.
       78  78-ID-ef-data VALUE 5005.
       78  78-ID-ef-data-cons VALUE 5006.
       78  78-ID-ef-data-listino VALUE 5007.
       78  78-ID-chk-aperto VALUE 5008.
       78  78-ID-chk-franco VALUE 5009.
       78  78-ID-ef-promo VALUE 5010.
       78  78-ID-chk-dati-fatt VALUE 5011.
       78  78-ID-ef-cliente VALUE 5012.
       78  78-ID-ef-des-cli VALUE 5013.
       78  78-ID-ef-evasione VALUE 5014.
       78  78-ID-ef-pag VALUE 5015.
       78  78-ID-ef-ese-iva VALUE 5016.
       78  78-ID-ef-note-1 VALUE 5017.
       78  78-ID-ef-note-2 VALUE 5018.
       78  78-ID-ef-note-3 VALUE 5019.
       78  78-ID-ef-note-4 VALUE 5020.
       78  78-ID-ef-art VALUE 5021.
       78  78-ID-ef-imb-ord VALUE 5022.
       78  78-ID-ef-qta VALUE 5023.
       78  78-ID-ef-uni VALUE 5024.
       78  78-ID-ef-sconto-1 VALUE 5025.
       78  78-ID-ef-sconto-2 VALUE 5026.
       78  78-ID-ef-sconto-3 VALUE 5027.
       78  78-ID-ef-sconto-4 VALUE 5028.
       78  78-ID-ef-sconto-5 VALUE 5029.
       78  78-ID-ef-cons VALUE 5030.
       78  78-ID-ef-cou VALUE 5031.
       78  78-ID-ef-add VALUE 5032.
       78  78-ID-ef-costi-agg VALUE 5033.
       78  78-ID-ef-imp VALUE 5034.
       78  78-ID-ef-cod-iva VALUE 5035.
       78  78-ID-chk-manuale VALUE 5036.
       78  78-ID-ef-impforn VALUE 5037.
       78  78-ID-ef-anno-ord VALUE 5001.
       78  78-ID-ef-numero-ord VALUE 5002.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "COMMON-LINKAGE.DEF".

      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           AFTER PROCEDURE Form1-AfterProcedure,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           .

      * ENTRY FIELD
       05
           ef-anno, 
           Entry-Field, 
           COL 12,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-k,
           FONT IS Small-Font,
           ID IS 78-ID-ef-anno,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           READ-ONLY,
           VALUE ef-anno-BUF,
           .

      * ENTRY FIELD
       05
           ef-cau, 
           Entry-Field, 
           COL 57,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED mod-k,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cau,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 4,
           VALUE ef-cau-BUF,
           .

      * ENTRY FIELD
       05
           ef-cli, 
           Entry-Field, 
           COL 12,00, 
           LINE 4,00,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-k,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 5,
           VALUE ef-cli-BUF,
           .

      * ENTRY FIELD
       05
           ef-dest, 
           Entry-Field, 
           COL 12,00, 
           LINE 6,00,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-k,
           FONT IS Small-Font,
           ID IS 78-ID-ef-dest,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 5,
           VALUE ef-dest-BUF,
           .

      * LABEL
       05
           CST-BLOCKPGM, 
           Label, 
           COL 144,33, 
           LINE 9,62,
           LINES 1,00 ,
           SIZE 13,86 ,
           ID IS 999,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Form1-Custom1-1, 
           Label, 
           COL 123,83, 
           LINE 9,85,
           LINES 0,62 ,
           SIZE 12,33 ,
           FONT IS Default-Font,
           ID IS 666,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Form1-La-1, 
           Label, 
           COL 3,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Anno",
           .

      * LABEL
       05
           Form1-La-2, 
           Label, 
           COL 3,00, 
           LINE 4,00,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Fornitore",
           .

      * DB_LABEL
       05
           lab-cli, 
           Label, 
           COL 20,00, 
           LINE 4,00,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 7,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-cli-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-ind-cli, 
           Label, 
           COL 66,00, 
           LINE 4,00,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 8,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-ind-cli-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-loc-cli, 
           Label, 
           COL 112,00, 
           LINE 4,00,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 9,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-loc-cli-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * TAB
       05
           Screen1-Ta-1, 
           Tab-Control, 
           COL 2,50, 
           LINE 9,00,
           LINES 37,00 ,
           SIZE 155,00 ,
           ID IS 5000,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           EVENT PROCEDURE Screen1-Ta-1-Event-Proc,
           .

      * PAGE
       05
           PAGE-1, 
           VISIBLE Form1-Pg-1-Visible,
           COL 4, 
           LINE 11,
           .

      * ENTRY FIELD
       10
           ef-data, 
           Entry-Field, 
           COL 23,17, 
           LINE 11,69,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-data-BUF,
           .

      * ENTRY FIELD
       10
           ef-data-cons, 
           Entry-Field, 
           COL 67,17, 
           LINE 11,69,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data-cons,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-data-cons-BUF,
           .

      * ENTRY FIELD
       10
           ef-data-listino, 
           Entry-Field, 
           COL 97,84, 
           LINE 11,69,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-data-listino,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE ef-data-listino-BUF,
           .

      * CHECK BOX
       10
           chk-aperto, 
           Check-Box, 
           COL 125,17, 
           LINE 11,84,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-aperto,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-aperto-BUF,
            .

      * CHECK BOX
       10
           chk-franco, 
           Check-Box, 
           COL 152,17, 
           LINE 11,84,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-franco,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-franco-BUF,
            .

      * ENTRY FIELD
       10
           ef-promo, 
           Entry-Field, 
           COL 23,17, 
           LINE 13,69,
           LINES 1,31 ,
           SIZE 16,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-promo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 15,
           VALUE ef-promo-BUF,
           .

      * CHECK BOX
       10
           chk-dati-fatt, 
           Check-Box, 
           COL 152,17, 
           LINE 13,84,
           LINES 1,31 ,
           SIZE 3,00 ,
           ENABLED mod-campi,
           FLAT,
           ID IS 78-ID-chk-dati-fatt,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           VALUE chk-dati-fatt-BUF,
           VISIBLE v-dati-fatt,
            .

      * ENTRY FIELD
       10
           ef-cliente, 
           Entry-Field, 
           COL 23,17, 
           LINE 15,69,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cliente,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-cliente-BUF,
           .

      * ENTRY FIELD
       10
           ef-des-cli, 
           Entry-Field, 
           COL 97,84, 
           LINE 15,69,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-des-cli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-des-cli-BUF,
           .

      * ENTRY FIELD
       10
           ef-evasione, 
           Entry-Field, 
           COL 23,17, 
           LINE 17,61,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-evasione,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-evasione-BUF,
           .

      * ENTRY FIELD
       10
           ef-referente, 
           Entry-Field, 
           COL 23,17, 
           LINE 21,23,
           LINES 1,31 ,
           SIZE 55,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 40,
           VALUE ef-referente-BUF,
           .

      * ENTRY FIELD
       10
           ef-tel, 
           Entry-Field, 
           COL 23,17, 
           LINE 23,07,
           LINES 1,31 ,
           SIZE 55,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 20,
           VALUE ef-tel-BUF,
           .

      * ENTRY FIELD
       10
           ef-fax, 
           Entry-Field, 
           COL 23,17, 
           LINE 25,00,
           LINES 1,31 ,
           SIZE 55,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 20,
           VALUE ef-fax-BUF,
           .

      * ENTRY FIELD
       10
           ef-mail, 
           Entry-Field, 
           COL 23,17, 
           LINE 26,92,
           LINES 1,31 ,
           SIZE 55,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 30,
           VALUE ef-mail-BUF,
           .

      * ENTRY FIELD
       10
           ef-pag, 
           Entry-Field, 
           COL 23,17, 
           LINE 28,92,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-pag-BUF,
           .

      * ENTRY FIELD
       10
           ef-ese-iva, 
           Entry-Field, 
           COL 23,17, 
           LINE 30,84,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ese-iva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-ese-iva-BUF,
           .

      * RADIO BUTTON
       10
           rb-urgente, 
           Radio-Button, 
           COL 23,17, 
           LINE 32,84,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod-campi-testa,
           EXCEPTION-VALUE 1000
           FLAT,
           GROUP 1,
           GROUP-VALUE 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           TITLE "&Urgente",
           VALUE Form1-RADIO-1-BUF,
            .

      * RADIO BUTTON
       10
           rb-normale, 
           Radio-Button, 
           COL 35,17, 
           LINE 32,84,
           LINES 1,15 ,
           SIZE 3,00 ,
           ENABLED mod-campi-testa,
           EXCEPTION-VALUE 1001
           FLAT,
           GROUP 1,
           GROUP-VALUE 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           TITLE "&Normale",
           VALUE Form1-RADIO-1-BUF,
            .

      * ENTRY FIELD
       10
           ef-note-1, 
           Entry-Field, 
           COL 23,17, 
           LINE 37,69,
           LINES 1,31 ,
           SIZE 130,00 ,
           BOXED,
           COLOR IS 33281,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-note-1-BUF,
           .

      * ENTRY FIELD
       10
           ef-note-2, 
           Entry-Field, 
           COL 23,17, 
           LINE 39,69,
           LINES 1,31 ,
           SIZE 130,00 ,
           BOXED,
           COLOR IS 33281,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-note-2-BUF,
           .

      * ENTRY FIELD
       10
           ef-note-3, 
           Entry-Field, 
           COL 23,17, 
           LINE 41,69,
           LINES 1,31 ,
           SIZE 130,00 ,
           BOXED,
           COLOR IS 33281,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-note-3-BUF,
           .

      * ENTRY FIELD
       10
           ef-note-4, 
           Entry-Field, 
           COL 23,17, 
           LINE 43,69,
           LINES 1,31 ,
           SIZE 130,00 ,
           BOXED,
           COLOR IS 33281,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-note-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 50,
           VALUE ef-note-4-BUF,
           .

      * LABEL
       10
           Form1-La-4, 
           Label, 
           COL 5,17, 
           LINE 15,69,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 13,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Cliente",
           .

      * LABEL
       10
           Form1-La-5, 
           Label, 
           COL 5,17, 
           LINE 11,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data ordine",
           .

      * LABEL
       10
           Form1-La-6, 
           Label, 
           COL 85,84, 
           LINE 11,69,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data Listino",
           .

      * LABEL
       10
           Form1-La-8, 
           Label, 
           COL 5,17, 
           LINE 28,84,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice pagamento",
           .

      * LABEL
       10
           Form1-La-11, 
           Label, 
           COL 5,17, 
           LINE 37,69,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Note",
           .

      * LABEL
       10
           Form1-La-12, 
           Label, 
           COL 52,17, 
           LINE 11,69,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 29,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Data Consegna",
           .

      * LABEL
       10
           lab-pag, 
           Label, 
           COL 32,17, 
           LINE 28,92,
           LINES 1,54 ,
           SIZE 100,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-pag-buf,
           .

      * LABEL
       10
           Form1-La-5aaaca, 
           Label, 
           COL 4,34, 
           LINE 19,23,
           LINES 1,31 ,
           SIZE 17,00 ,
           COLOR IS 80,
           ID IS 128,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TITLE "Dati Fornitore",
           .

      * BAR
       10
           Form1-Br-2aa, 
           Bar,
           COL 21,50, 
           LINE 19,92,
           SIZE 135,33 ,
           ID IS 129,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           Form1-La-4a, 
           Label, 
           COL 5,17, 
           LINE 21,15,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 130,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Referente",
           .

      * LABEL
       10
           Form1-La-4aa, 
           Label, 
           COL 5,17, 
           LINE 23,15,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 131,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Telefono diretto",
           .

      * LABEL
       10
           Form1-La-4aaa, 
           Label, 
           COL 5,17, 
           LINE 25,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 132,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Fax",
           .

      * LABEL
       10
           Form1-La-4aaaa, 
           Label, 
           COL 5,17, 
           LINE 26,92,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 133,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "E-mail",
           .

      * PUSH BUTTON
       10
           pb-note, 
           Push-Button, 
           COL 23,17, 
           LINE 34,54,
           LINES 2,62 ,
           SIZE 14,33 ,
           EXCEPTION-VALUE 1003,
           FONT IS Small-Font,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Note",
           .

      * LABEL
       10
           Form1-La-8a, 
           Label, 
           COL 5,17, 
           LINE 30,84,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Ese. IVA",
           .

      * LABEL
       10
           lab-ese-iva, 
           Label, 
           COL 32,17, 
           LINE 30,84,
           LINES 1,54 ,
           SIZE 100,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-ese-iva-buf,
           .

      * LABEL
       10
           Form1-La-16, 
           Label, 
           COL 27,17, 
           LINE 32,84,
           LINES 1,15 ,
           SIZE 8,17 ,
           FONT IS Small-Font,
           ID IS 41,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "&Urgente",
           .

      * LABEL
       10
           Form1-La-17, 
           Label, 
           COL 40,17, 
           LINE 32,84,
           LINES 1,15 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 42,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "&Normale",
           .

      * LABEL
       10
           Form1-La-4aaaaa, 
           Label, 
           COL 5,17, 
           LINE 32,84,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 43,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Scarico",
           .

      * DB_LABEL
       10
           lab-cliente, 
           Label, 
           COL 33,17, 
           LINE 15,69,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 44,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-cliente-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-4b, 
           Label, 
           COL 85,84, 
           LINE 15,69,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Small-Font,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Destino",
           .

      * DB_LABEL
       10
           lab-des-cli, 
           Label, 
           COL 106,50, 
           LINE 15,23,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 47,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-des-cli-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       10
           lab-des-loca, 
           Label, 
           COL 106,50, 
           LINE 16,46,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 48,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-des-loca-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-6a, 
           Label, 
           COL 5,17, 
           LINE 13,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           FONT IS Small-Font,
           ID IS 49,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Promo",
           .

      * DB_LABEL
       10
           lab-promo, 
           Label, 
           COL 40,17, 
           LINE 13,69,
           LINES 1,31 ,
           SIZE 86,83 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 50,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-promo-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           Form1-La-3, 
           Label, 
           COL 136,34, 
           LINE 11,69,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 103,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Franco Partenza",
           .

      * LABEL
       10
           Form1-La-3a, 
           Label, 
           COL 116,17, 
           LINE 11,69,
           LINES 1,31 ,
           SIZE 5,83 ,
           FONT IS Small-Font,
           ID IS 104,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Aperto",
           .

      * LABEL
       10
           lab-dati-fatt, 
           Label, 
           COL 129,34, 
           LINE 13,69,
           LINES 1,31 ,
           SIZE 21,00 ,
           FONT IS Small-Font,
           ID IS 105,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Stampa dati di fatturazione",
           VISIBLE v-dati-fatt,
           .

      * LABEL
       10
           Form1-La-4c, 
           Label, 
           COL 5,17, 
           LINE 17,61,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 106,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Evasione",
           .

      * PAGE
       05
           PAGE-2, 
           VISIBLE Form1-Pg-2-Visible,
           COL 4, 
           LINE 11,
           .

      * Group
       10
           campi-grid, 
           COL 95, 
           LINE 32,
           .

      * ENTRY FIELD
       15
           ef-art, 
           Entry-Field, 
           COL 20,17, 
           LINE 33,46,
           LINES 1,31 ,
           SIZE 8,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-art,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-art-BUF,
           .

      * ENTRY FIELD
       15
           ef-imb-ord, 
           Entry-Field, 
           COL 82,17, 
           LINE 33,46,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-imb-ord,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           VALUE ef-imb-ord-BUF,
           .

      * ENTRY FIELD
       15
           ef-qta, 
           Entry-Field, 
           COL 120,17, 
           LINE 33,46,
           LINES 1,31 ,
           SIZE 9,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-qta,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           VALUE ef-qta-BUF,
           .

      * ENTRY FIELD
       15
           ef-uni, 
           Entry-Field, 
           COL 20,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-uni,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           VALUE ef-uni-BUF,
           .

      * ENTRY FIELD
       15
           ef-sconto-1, 
           Entry-Field, 
           COL 70,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto-1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-sconto-1-BUF,
           .

      * ENTRY FIELD
       15
           ef-sconto-2, 
           Entry-Field, 
           COL 82,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto-2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-sconto-2-BUF,
           .

      * ENTRY FIELD
       15
           ef-sconto-3, 
           Entry-Field, 
           COL 94,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto-3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-sconto-3-BUF,
           .

      * ENTRY FIELD
       15
           ef-sconto-4, 
           Entry-Field, 
           COL 107,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto-4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-sconto-4-BUF,
           .

      * ENTRY FIELD
       15
           ef-sconto-5, 
           Entry-Field, 
           COL 120,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-sconto-5,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-sconto-5-BUF,
           .

      * ENTRY FIELD
       15
           ef-cons, 
           Entry-Field, 
           COL 20,17, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cons,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           READ-ONLY,
           VALUE ef-cons-BUF,
           .

      * ENTRY FIELD
       15
           ef-cou, 
           Entry-Field, 
           COL 70,17, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cou,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           READ-ONLY,
           VALUE ef-cou-BUF,
           .

      * ENTRY FIELD
       15
           ef-add, 
           Entry-Field, 
           COL 94,17, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-add,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           READ-ONLY,
           VALUE ef-add-BUF,
           .

      * ENTRY FIELD
       15
           ef-costi-agg, 
           Entry-Field, 
           COL 120,17, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-costi-agg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           VALUE ef-costi-agg-BUF,
           .

      * ENTRY FIELD
       15
           ef-imp, 
           Entry-Field, 
           COL 20,17, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 11,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-imp,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 12,
           READ-ONLY,
           VALUE ef-imp-BUF,
           .

      * ENTRY FIELD
       15
           ef-cod-iva, 
           Entry-Field, 
           COL 70,17, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED mod-campi,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cod-iva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           READ-ONLY,
           VALUE ef-cod-iva-BUF,
           .

      * GRID
       10
           Form1-Gd-1, 
           Grid, 
           COL 5,17, 
           LINE 11,69,
           LINES 19,23 ,
           SIZE 150,00 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           CENTERED-HEADINGS,
           COLOR IS 516,
           DATA-COLUMNS (1, 6, 12, 62, 70, 82, 87, 92, 97, 102, 107, 
           119, 131, 141, 149, 161),
           ALIGNMENT ("R", "R", "U", "R", "R", "R", "R", "R", "R", "R", 
           "R", "R", "R", "R", "R", "C"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("9(5)", "9(6)", "X", "9(8)", "9(12)", "9(5)", "9(
      -    "5)", "9(5)", "9(5)", "9(5)", "9(12)", "9(12)", "9(7)", "9(7)
      -    "", "9(12)", "x(3)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           HSCROLL,
           ID IS 2000,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ROW-HEADINGS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 147,
           VPADDING 54,
           VSCROLL,
           BEFORE PROCEDURE Form1-Gd-1-BeforeProcedure, 
           EVENT PROCEDURE Form1-Gd-1-Event-Proc,
           .

      * PUSH BUTTON
       10
           pb-importa, 
           Push-Button, 
           COL 4,00, 
           LINE 31,07,
           LINES 2,15 ,
           SIZE 16,00 ,
           BITMAP-HANDLE IMPORTA-DA-BMP,
           BITMAP-NUMBER 2,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1010,
           FLAT,
           FONT IS Small-Font,
           ID IS 64,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Aggi&unge una riga all'ordine",
           AFTER PROCEDURE pb-importa-AfterProcedure, 
           BEFORE PROCEDURE pb-importa-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-grid-nuovo, 
           Push-Button, 
           COL 129,67, 
           LINE 32,77,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 5,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1002,
           FLAT,
           FONT IS Small-Font,
           ID IS 65,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "Aggi&unge una riga all'ordine",
           AFTER PROCEDURE pb-grid-nuovo-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-nuovo-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-grid-elimina, 
           Push-Button, 
           COL 142,67, 
           LINE 32,77,
           LINES 2,15 ,
           SIZE 13,50 ,
           BITMAP-HANDLE STRIP_GRID_GCLIENTI-BMP,
           BITMAP-NUMBER 4,
           UNFRAMED,
           SQUARE,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1005,
           FLAT,
           FONT IS Small-Font,
           ID IS 1001,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "&Elimina la riga selezionata",
           AFTER PROCEDURE pb-grid-elimina-AfterProcedure, 
           BEFORE PROCEDURE pb-grid-elimina-BeforeProcedure, 
           .

      * PUSH BUTTON
       10
           pb-articoli, 
           Push-Button, 
           COL 139,50, 
           LINE 38,54,
           LINES 29,00 ,
           SIZE 83,00 ,
           BITMAP-HANDLE DA-CONF-BMP,
           UNFRAMED,
           SQUARE,
           ENABLED mod-campi,
           EXCEPTION-VALUE 1004,
           FLAT,
           FONT IS Small-Font,
           ID IS 25,
           SELF-ACT,
           TITLE "Articoli da confermare",
           BITMAP-NUMBER=NumBitmapArticoli
           AFTER PROCEDURE pb-articoli-AfterProcedure, 
           BEFORE PROCEDURE pb-articoli-BeforeProcedure, 
           .

      * LABEL
       10
           Form1-La-19, 
           Label, 
           COL 5,17, 
           LINE 33,46,
           LINES 1,31 ,
           SIZE 12,00 ,
           FONT IS Small-Font,
           ID IS 4,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Codice Articolo",
           .

      * LABEL
       10
           Form1-La-20, 
           Label, 
           COL 115,17, 
           LINE 33,46,
           LINES 1,31 ,
           SIZE 3,00 ,
           FONT IS Small-Font,
           ID IS 5,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Qtà",
           .

      * LABEL
       10
           Form1-La-21, 
           Label, 
           COL 5,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 22,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prezzo Unitario",
           .

      * LABEL
       10
           Form1-La-22, 
           Label, 
           COL 5,17, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 26,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imposta Consumo",
           .

      * LABEL
       10
           lab-imposta, 
           Label, 
           COL 55,17, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "C.O.U./COBAT",
           .

      * LABEL
       10
           Form1-La-24, 
           Label, 
           COL 5,17, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imponibile Merce",
           .

      * LABEL
       10
           Form1-La-25, 
           Label, 
           COL 61,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 35,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "% Sconti",
           .

      * LABEL
       10
           Form1-La-26, 
           Label, 
           COL 55,17, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 13,00 ,
           FONT IS Small-Font,
           ID IS 51,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Codice IVA",
           .

      * DB_LABEL
       10
           lab-art, 
           Label, 
           COL 29,17, 
           LINE 33,46,
           LINES 1,31 ,
           SIZE 40,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 52,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-art-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           lab-gia, 
           Label, 
           COL 5,17, 
           LINE 42,38,
           LINES 1,31 ,
           SIZE 16,00 ,
           COLOR IS Colorgiacenza,
           FONT IS Small-Font,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "GIACENZA",
           .

      * LABEL
       10
           lab-imp, 
           Label, 
           COL 63,17, 
           LINE 42,38,
           LINES 1,31 ,
           SIZE 19,00 ,
           COLOR IS ColorImpegnato,
           FONT IS Small-Font,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "IMPEGNATO",
           .

      * LABEL
       10
           lab-ord, 
           Label, 
           COL 121,34, 
           LINE 42,38,
           LINES 1,31 ,
           SIZE 19,00 ,
           COLOR IS ColorOrdinato,
           FONT IS Small-Font,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "ORDINATO",
           .

      * LABEL
       10
           lab-giacenza, 
           Label, 
           COL 22,17, 
           LINE 42,38,
           LINES 1,31 ,
           SIZE 10,00 ,
           COLOR IS ColorGiacenza,
           FONT IS Small-Font,
           ID IS 31,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE giacenza-ed,
           .

      * LABEL
       10
           lab-impegnato, 
           Label, 
           COL 83,00, 
           LINE 42,38,
           LINES 1,31 ,
           SIZE 10,00 ,
           COLOR IS ColorImpegnato,
           FONT IS Small-Font,
           ID IS 33,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE impegnato-ed,
           .

      * LABEL
       10
           lab-ordinato, 
           Label, 
           COL 142,00, 
           LINE 42,38,
           LINES 1,31 ,
           SIZE 10,00 ,
           COLOR IS ColorOrdinato,
           FONT IS Small-Font,
           ID IS 53,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE ordinato-ed,
           .

      * BAR
       10
           Form1-Br-1, 
           Bar,
           COL 3,17, 
           LINE 42,00,
           SIZE 153,67 ,
           ID IS 54,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8, 8),
           SHADING (-1, 1),
           WIDTH 2,
           .

      * LABEL
       10
           lab-iva, 
           Label, 
           COL 78,17, 
           LINE 39,31,
           LINES 2,00 ,
           SIZE 27,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 60,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-KEY-LETTER,
           TRANSPARENT,
           TITLE lab-iva-buf,
           .

      * LABEL
       10
           lab-impostaa, 
           Label, 
           COL 84,17, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 8,00 ,
           FONT IS Small-Font,
           ID IS 61,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Add.le Pb",
           .

      * LABEL
       10
           Form1-La-20a, 
           Label, 
           COL 75,17, 
           LINE 33,46,
           LINES 1,31 ,
           SIZE 6,00 ,
           FONT IS Small-Font,
           ID IS 75,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Imballo",
           .

      * DB_LABEL
       10
           lab-imb, 
           Label, 
           COL 88,17, 
           LINE 33,46,
           LINES 1,31 ,
           SIZE 26,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 76,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-imb-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       10
           lab-impostaaa, 
           Label, 
           COL 109,17, 
           LINE 37,31,
           LINES 1,31 ,
           SIZE 8,83 ,
           FONT IS Small-Font,
           ID IS 77,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE "Costi Agg.",
           .

      * LABEL
       10
           lab-impostaab, 
           Label, 
           COL 107,17, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 11,00 ,
           FONT IS Large-Font,
           ID IS 78,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Prz Finale",
           .

      * LABEL
       10
           lbl-prz-finale, 
           Label, 
           COL 120,17, 
           LINE 39,31,
           LINES 1,31 ,
           SIZE 13,00 ,
           COLOR IS 5,
           FONT IS Large-Font,
           ID IS 79,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE prezzo-finale,
           .

      * LABEL
       10
           lab-articoli, 
           Label, 
           COL 131,84, 
           LINE 35,61,
           LINES 2,46 ,
           SIZE 24,33 ,
           COLOR IS 5,
           FONT IS Verdana10B-Occidentale,
           ID IS 82,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "CI SONO ARTICOLI DA CONFERMARE!!!",
           VISIBLE v-articoli,
           .

      * CHECK BOX
       10
           chk-manuale, 
           Check-Box, 
           COL 70,17, 
           LINE 33,15,
           LINES 16,00 ,
           SIZE 16,00 ,
           BITMAP-HANDLE MOD_PREZZO-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1006
           FLAT,
           ID IS 78-ID-chk-manuale,                
           NO-TAB,
           SELF-ACT,
           TITLE "Modifica manuale dei prezzi",
           VALUE chk-manuale-BUF,
           BITMAP-NUMBER=ChkManualeBitmapNumber
            .
      * ENTRY FIELD
       10
           ef-impforn, 
           Entry-Field, 
           COL 32,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           FONT IS Small-Font,
           ID IS 78-ID-ef-impforn,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           VALUE ef-impforn-BUF,
           VISIBLE v-manuale,
           .

      * LABEL
       10
           lab-impforn, 
           Label, 
           COL 39,17, 
           LINE 35,46,
           LINES 1,31 ,
           SIZE 19,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 59,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-impforn-buf,
           VISIBLE v-manuale,
           .

      * LABEL
       05
           Form1-La-18, 
           Label, 
           COL 39,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 17,00 ,
           FONT IS Small-Font,
           ID IS 80,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Causale di magazzino",
           .

      * DB_LABEL
       05
           lab-cau, 
           Label, 
           COL 66,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 60,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 81,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-cau-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-loc-dest, 
           Label, 
           COL 112,00, 
           LINE 6,00,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 87,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-loc-dest-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-ind-dest, 
           Label, 
           COL 66,00, 
           LINE 6,00,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 88,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-ind-dest-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * DB_LABEL
       05
           lab-dest, 
           Label, 
           COL 20,00, 
           LINE 6,00,
           LINES 1,31 ,
           SIZE 45,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 89,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE lab-dest-BUF,
           NO-KEY-LETTER,
           TRANSPARENT,
           .

      * LABEL
       05
           Form1-La-2a, 
           Label, 
           COL 3,00, 
           LINE 6,00,
           LINES 1,31 ,
           SIZE 7,00 ,
           FONT IS Small-Font,
           ID IS 90,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Destino",
           .

      * BAR
       05
           Form1-Br-2, 
           Bar,
           COL 1,17, 
           LINE 7,92,
           SIZE 157,83 ,
           COLOR IS 5,
           ID IS 100,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * BAR
       05
           Form1-Br-3ba, 
           Bar,
           COL 1,17, 
           LINE 46,23,
           SIZE 157,83 ,
           COLOR IS 5,
           ID IS 101,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * BAR
       05
           Form1-Br-3, 
           Bar,
           COL 1,17, 
           LINE 1,00,
           LINES 45,31 ,
           COLOR IS 5,
           ID IS 55,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * BAR
       05
           Form1-Br-3b, 
           Bar,
           COL 1,17, 
           LINE 1,00,
           SIZE 157,83 ,
           COLOR IS 5,
           ID IS 56,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * BAR
       05
           Form1-Br-3a, 
           Bar,
           COL 158,50, 
           LINE 1,00,
           LINES 45,31 ,
           COLOR IS 5,
           ID IS 57,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 3,
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 110,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 6,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 23,
           FRAMED,
           SQUARE,
           ENABLED E-NUOVO,
           FLAT,
           ID IS 111,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 16,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CANCELLA,
           FLAT,
           ID IS 112,
           SELF-ACT,
           TITLE "Cancella (F4)",
           BITMAP-NUMBER BitmapNumDelete
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 11,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 113,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 26,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 17,
           FRAMED,
           SQUARE,
           ENABLED E-ANTEPRIMA,
           EXCEPTION-VALUE 6,
           FLAT,
           ID IS 114,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 21,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 5,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 115,
           SELF-ACT,
           TITLE "Modifica (F5)",
           VALUE 1,
           BITMAP-NUMBER BitmapNumEdit
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 31,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           BITMAP-NUMBER 18,
           FRAMED,
           SQUARE,
           ENABLED E-STAMPA,
           EXCEPTION-VALUE 7,
           FLAT,
           ID IS 116,
           SELF-ACT,
           TITLE "Stampa (F7)",
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 36,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 117,
           SELF-ACT,
           TITLE "Cerca (F8)",
           BITMAP-NUMBER BitmapNumZoom
           .

      * PUSH BUTTON
       05
           TOOL-SELEZIONA, 
           Push-Button, 
           COL 41,00, 
           LINE 1,08,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-SELEZIONA,
           FLAT,
           ID IS 118,
           SELF-ACT,
           TITLE "Seleziona (F9)",
           BITMAP-NUMBER BitmapNumSelect
           .

      * FORM
       01 
           scr-importa, 
           BEFORE PROCEDURE scr-importa-BeforeProcedure,
           AFTER PROCEDURE  scr-importa-AFTER-SCREEN
           .

      * ENTRY FIELD
       05
           ef-anno-ord, 
           Entry-Field, 
           COL 10,00, 
           LINE 2,11,
           LINES 1,33 ,
           SIZE 6,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-ef-anno-ord,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 11,
           VALUE ef-anno-ord-buf,
           AFTER PROCEDURE ef-anno-ord-AfterProcedure, 
           .

      * ENTRY FIELD
       05
           ef-numero-ord, 
           Entry-Field, 
           COL 10,00, 
           LINE 3,78,
           LINES 1,33 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-ef-numero-ord,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 11,
           VALUE ef-numero-ord-buf,
           AFTER PROCEDURE ef-numero-ord-AfterProcedure, 
           .

      * PUSH BUTTON
       05
           pb-ricerca-ok, 
           Push-Button, 
           COL 2,90, 
           LINE 6,22,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-OK-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 1000,
           FLAT,
           FONT IS Small-Font,
           ID IS 100,
           AFTER PROCEDURE pb-ricerca-ok-AfterProcedure, 
           BEFORE PROCEDURE pb-ricerca-ok-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-ricerca-cancel, 
           Push-Button, 
           COL 10,80, 
           LINE 6,22,
           LINES 30,00 ,
           SIZE 73,00 ,
           BITMAP-HANDLE BOTTONE-CANCEL-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           EXCEPTION-VALUE 27,
           FLAT,
           FONT IS Small-Font,
           ID IS 200,
           ESCAPE-BUTTON,
           AFTER PROCEDURE pb-ricerca-cancel-AfterProcedure, 
           BEFORE PROCEDURE pb-ricerca-cancel-BeforeProcedure, 
           .

      * BAR
       05
           Screen4-Br-1aaaa, 
           Bar,
           COL 1,00, 
           LINE 6,11,
           SIZE 19,80 ,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           COLORS (8),
           SHADING (-1),
           WIDTH 1,
           .

      * LABEL
       05
           lab1a, 
           Label, 
           COL 2,00, 
           LINE 2,11,
           LINES 1,22 ,
           SIZE 6,00 ,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Anno",
           .

      * LABEL
       05
           lab1aa, 
           Label, 
           COL 2,00, 
           LINE 3,78,
           LINES 1,22 ,
           SIZE 7,00 ,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Numero",
           .

      * LABEL
       05
           Screen1-Custom1-1, 
           Label, 
           COL 2,90, 
           LINE 5,28,
           LINES 0,44 ,
           SIZE 5,70 ,
           FONT IS Default-Font,
           ID IS 1,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, USER-CODI, LIVELLO-ABIL.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:gordforn, INIT:gordforn, BeforeDeclarative>
       PROGMAG-ERR SECTION.
           use after error procedure on progmag.
           set RecLocked to false.
           evaluate status-progmag
           when "35"
                display message "File [PROGMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [PROGMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[PROGMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "93"
           when "99" set RecLocked to true
           end-evaluate.
 
      ***---
       tordforn-ERR SECTION.
           use after error procedure on tordforn.
           set tutto-ok  to true.
           evaluate status-tordforn
           when "35"
                display message "File [tordforn] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [tordforn] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[tordforn] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ****---
      * AGENTI-ERR SECTION.
      *     use after error procedure on agenti.
      *     set tutto-ok  to true.
      *     evaluate status-agenti
      *     when "35"
      *          display message "File [AGENTI] not found!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "39"
      *          display message "File [AGENTI] Mismatch size!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "98"
      *          display message "[AGENTI] Indexed file corrupt!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     end-evaluate.
      *
      ****---
      * TVETTORI-ERR SECTION.
      *     use after error procedure on tvettori.
      *     set tutto-ok  to true.
      *     evaluate status-tvettori
      *     when "35"
      *          display message "File [TVETTORI] not found!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "39"
      *          display message "File [TVETTORI] Mismatch size!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "98"
      *          display message "[TVETTORI] Indexed file corrupt!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     end-evaluate.
 
      ***---
       TIVAESE-ERR SECTION.
           use after error procedure on tivaese.
           set tutto-ok  to true.
           evaluate status-tivaese
           when "35"
                display message "File [TIVAESE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIVAESE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIVAESE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       CLIENTI-ERR SECTION.
           use after error procedure on clienti.
           set RecLocked to false.
           evaluate status-clienti
           when "35"
                display message "File [CLIENTI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [CLIENTI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[CLEINTI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "93"
           when "99" 
                set RecLocked to true
      *          display message box "Fornitore già in uso su altro terminale!"
      *                  title = titolo
      *                  icon 3
           end-evaluate.
 
      ****---
      * DESTINI-ERR SECTION.
      *     use after error procedure on destini.
      *     set tutto-ok  to true.
      *     evaluate status-destini
      *     when "35"
      *          display message "File [DESTINI] not found!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "39"
      *          display message "File [DESTINI] Mismatch size!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "98"
      *          display message "[DESTINI] Indexed file corrupt!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     end-evaluate.
 
      ***---
       ARTICOLI-ERR SECTION.
           use after error procedure on articoli.
           set tutto-ok  to true.
           evaluate status-articoli
           when "35"
                display message "File [ARTICOLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [ARTICOLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[ARTICOLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ****---
      * NOTE-ERR SECTION.
      *     use after error procedure on note.
      *     set tutto-ok  to true.
      *     evaluate status-note
      *     when "35"
      *          display message "File [NOTE] not found!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "39"
      *          display message "File [NOTE] Mismatch size!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "98"
      *          display message "[NOTE] Indexed file corrupt!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     end-evaluate.
 
      ***---
       TCODPAG-ERR SECTION.
           use after error procedure on tcodpag.
           set tutto-ok  to true.
           evaluate status-tcodpag
           when "35"
                display message "File [TCODPAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCODPAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCODPAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ****---
      * ASSORCLI-ERR SECTION.
      *     use after error procedure on assorcli.
      *     set tutto-ok  to true.
      *     evaluate status-assorcli
      *     when "35"
      *          display message "File [ASSORCLI] not found!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "39"
      *          display message "File [ASSORCLI] Mismatch size!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "98"
      *          display message "[ASSORCLI] Indexed file corrupt!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     end-evaluate.          
 
      ***---
       TIMPOSTE-ERR SECTION.
           use after error procedure on timposte.
           set tutto-ok  to true.
           evaluate status-timposte
           when "35"
                display message "File [TIMPOSTE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMPOSTE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMPOSTE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMARCHE-ERR SECTION.
           use after error procedure on tmarche.
           set tutto-ok  to true.
           evaluate status-tmarche
           when "35"
                display message "File [TMARCHE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMARCHE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMARCHE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ****---
      * TMP-ASSORCLI-ERR SECTION.
      *     use after error procedure on tmp-assorcli.
      *     set tutto-ok  to true.
      *     evaluate status-tmp-assorcli
      *     when "35"
      *          display message "File [TMP-ASSORCLI] not found!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "39"
      *          display message "File [TMP-ASSORCLI] Mismatch size!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "98"
      *          display message "[TMP-ASSORCLI] Indexed file corrupt!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     end-evaluate.
      *
      ***---
       TPARAMGE-ERR SECTION.
           use after error procedure on tparamge.
           set tutto-ok  to true.
           evaluate status-tparamge
           when "35"
                display message "File [TPARAMGE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TPARAMGE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TPARAMGE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMAGAZ-ERR SECTION.
           use after error procedure on tmagaz.
           set tutto-ok  to true.
           evaluate status-tmagaz
           when "35"
                display message "File [TMAGAZ] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMAGAZ] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMAGAZ] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TCAUMAG-ERR SECTION.
           use after error procedure on tcaumag.
           set tutto-ok  to true.
           evaluate status-tcaumag
           when "35"
                display message "File [TCAUMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCAUMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCAUMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALQTA-ERR SECTION.
           use after error procedure on timbalqta.
           set tutto-ok  to true.
           evaluate status-timbalqta
           when "35"
                display message "File [TIMBALQTA] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALQTA] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALQTA] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TIMBALLI-ERR SECTION.
           use after error procedure on timballi.
           set tutto-ok  to true.
           evaluate status-timballi
           when "35"
                display message "File [TIMBALLI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIMBALLI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIMBALLI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ****---
      * RECAPITI-ERR SECTION.
      *     use after error procedure on recapiti.
      *     set tutto-ok  to true.
      *     evaluate status-recapiti
      *     when "35"
      *          display message "File [RECAPITI] not found!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "39"
      *          display message "File [RECAPITI] Mismatch size!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "98"
      *          display message "[RECAPITI] Indexed file corrupt!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     end-evaluate.
 
      ****---
      * RMOVMAG-ERR SECTION.
      *     use after error procedure on rmovmag.
      *     set tutto-ok  to true.
      *     evaluate status-rmovmag
      *     when "35"
      *          display message "File [RMOVMAG] not found!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "39"
      *          display message "File [RMOVMAG] Mismatch size!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "98"
      *          display message "[RMOVMAG] Indexed file corrupt!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     end-evaluate.
 
      ****---
      * TTIPOCLI-ERR SECTION.
      *     use after error procedure on ttipocli.
      *     set tutto-ok  to true.
      *     evaluate status-ttipocli
      *     when "35"
      *          display message "File [TTIPOCLI] not found!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "39"
      *          display message "File [TTIPOCLI] Mismatch size!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     when "98"
      *          display message "[TTIPOCLI] Indexed file corrupt!"
      *                     title titolo
      *                      icon 3
      *          set errori to true
      *     end-evaluate.
 
      ***---
       rordforn-ERR SECTION.
           use after error procedure on rordforn.
           set tutto-ok  to true.
           evaluate status-rordforn
           when "35"
                display message "File [rordforn] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [rordforn] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[rordforn] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TMP-PROGMAG-ZOOM-ERR SECTION.
           use after error procedure on tmp-progmag-zoom.
           set tutto-ok  to true.
           evaluate status-tmp-progmag-zoom
           when "35"
                display message "File [TMP-PROGMAG-ZOOM] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TMP-PROGMAG-ZOOM] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TMP-PROGMAG-ZOOM] Indexed file corrupt
      -    "!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM gordc-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:gordforn, INIT:gordforn, BeforeDestroyResource>
      * <TOTEM:END>
           DESTROY Verdana10B-Occidentale
           DESTROY Verdana12-Occidentale
           CALL "w$bitmap" USING WBITMAP-DESTROY, IMPORTA-DA-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, 
           STRIP_GRID_GCLIENTI-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, DA-CONF-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, MOD_PREZZO-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, TOOLBAR-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-OK-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-CANCEL-BMP
      *    After-Program
           PERFORM gordc-Ev-After-Program
           set environment "KEYSTROKE" to "DATA=46   46".
           set environment "KEYSTROKE" to "DATA=44   44".
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
      * Verdana10B-Occidentale
           INITIALIZE WFONT-DATA Verdana10B-Occidentale
           MOVE 10 TO WFONT-SIZE
           MOVE "Verdana" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO TRUE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Verdana10B-Occidentale, WFONT-DATA
      * Verdana12-Occidentale
           INITIALIZE WFONT-DATA Verdana12-Occidentale
           MOVE 12 TO WFONT-SIZE
           MOVE "Verdana" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO FALSE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Verdana12-Occidentale, WFONT-DATA
           .

       INIT-BMP.
      * pb-importa
           COPY RESOURCE "IMPORTA-DA.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "IMPORTA-DA.BMP", 
                   GIVING IMPORTA-DA-BMP.
      * pb-grid-nuovo
           COPY RESOURCE "STRIP_GRID_GCLIENTI.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "STRIP_GRID_GCLIENTI.BMP"
           , 
                   GIVING STRIP_GRID_GCLIENTI-BMP.
      * pb-articoli
           COPY RESOURCE "DA-CONF.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "DA-CONF.BMP", 
                   GIVING DA-CONF-BMP.
      * chk-manuale
           COPY RESOURCE "MOD_PREZZO.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "MOD_PREZZO.BMP", 
                   GIVING MOD_PREZZO-BMP.
      * TOOL-ESCI
           COPY RESOURCE "TOOLBAR.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "TOOLBAR.BMP", 
                   GIVING TOOLBAR-BMP.
      * pb-ricerca-ok
           COPY RESOURCE "BOTTONE-OK.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-OK.BMP", 
                   GIVING BOTTONE-OK-BMP.
      * pb-ricerca-cancel
           COPY RESOURCE "BOTTONE-CANCEL.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-CANCEL.BMP", 
                   GIVING BOTTONE-CANCEL-BMP.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-tordforn
      *    tparamge OPEN MODE IS FALSE
      *    PERFORM OPEN-tparamge
           PERFORM OPEN-timballi
      *    zoom-tcaumag OPEN MODE IS FALSE
      *    PERFORM OPEN-zoom-tcaumag
           PERFORM OPEN-blister
           PERFORM OPEN-articoli
           PERFORM OPEN-tcodpag
           PERFORM OPEN-timposte
           PERFORM OPEN-timbalqta
           PERFORM OPEN-tmarche
           PERFORM OPEN-progmag
      *    tmp-progmag-zoom OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-progmag-zoom
           PERFORM OPEN-nordforn
           PERFORM OPEN-tivaese
           PERFORM OPEN-tpiombo
           PERFORM OPEN-locali
           PERFORM OPEN-tlistini
           PERFORM OPEN-rlistini
           PERFORM OPEN-tcaumag
      *    tmp-nordforn OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-nordforn
           PERFORM OPEN-clienti
           PERFORM OPEN-clienti1
           PERFORM OPEN-lockfile
           PERFORM OPEN-art-ordforn
           PERFORM OPEN-destinif
           PERFORM OPEN-impforn
           PERFORM OPEN-rordforn
           PERFORM OPEN-destini
           PERFORM OPEN-tpromo
      *    tmp-tpromo-zoom OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-tpromo-zoom
           PERFORM OPEN-tgrupgdo
           PERFORM OPEN-tmagaz
           PERFORM OPEN-distinteb
           PERFORM OPEN-nlistini
           PERFORM OPEN-nforn-dest
           PERFORM OPEN-param
           PERFORM OPEN-tscorte
           PERFORM OPEN-rordini
           PERFORM OPEN-tordini
      *    After Open
           .

       OPEN-tordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:tordforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O tordforn
           IF STATUS-tordforn = "35"
              OPEN OUTPUT tordforn
                IF Valid-STATUS-tordforn
                   CLOSE tordforn
                   OPEN I-O tordforn
                END-IF
           END-IF
           IF NOT Valid-STATUS-tordforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tordforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tparamge.
      * <TOTEM:EPT. INIT:gordforn, FD:tparamge, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tparamge
           IF NOT Valid-STATUS-tparamge
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tparamge, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timballi.
      * <TOTEM:EPT. INIT:gordforn, FD:timballi, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timballi
           IF NOT Valid-STATUS-timballi
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:timballi, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-zoom-tcaumag.
      * <TOTEM:EPT. INIT:gordforn, FD:zoom-tcaumag, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT zoom-tcaumag
           IF NOT Valid-STATUS-zoom-tcaumag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:zoom-tcaumag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-blister.
      * <TOTEM:EPT. INIT:gordforn, FD:blister, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT blister
           IF NOT Valid-STATUS-blister
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:blister, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-articoli.
      * <TOTEM:EPT. INIT:gordforn, FD:articoli, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT articoli
           IF NOT Valid-STATUS-articoli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:articoli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcodpag.
      * <TOTEM:EPT. INIT:gordforn, FD:tcodpag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcodpag
           IF NOT Valid-STATUS-tcodpag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tcodpag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timposte.
      * <TOTEM:EPT. INIT:gordforn, FD:timposte, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timposte
           IF NOT Valid-STATUS-timposte
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:timposte, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-timbalqta.
      * <TOTEM:EPT. INIT:gordforn, FD:timbalqta, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT timbalqta
           IF NOT Valid-STATUS-timbalqta
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:timbalqta, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmarche.
      * <TOTEM:EPT. INIT:gordforn, FD:tmarche, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmarche
           IF NOT Valid-STATUS-tmarche
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tmarche, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-progmag.
      * <TOTEM:EPT. INIT:gordforn, FD:progmag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT progmag
           IF NOT Valid-STATUS-progmag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:progmag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-progmag-zoom.
      * <TOTEM:EPT. INIT:gordforn, FD:tmp-progmag-zoom, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-progmag-zoom
           IF NOT Valid-STATUS-tmp-progmag-zoom
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tmp-progmag-zoom, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-nordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:nordforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O nordforn
           IF STATUS-nordforn = "35"
              OPEN OUTPUT nordforn
                IF Valid-STATUS-nordforn
                   CLOSE nordforn
                   OPEN I-O nordforn
                END-IF
           END-IF
           IF NOT Valid-STATUS-nordforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:nordforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tivaese.
      * <TOTEM:EPT. INIT:gordforn, FD:tivaese, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tivaese
           IF NOT Valid-STATUS-tivaese
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tivaese, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tpiombo.
      * <TOTEM:EPT. INIT:gordforn, FD:tpiombo, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tpiombo
           IF NOT Valid-STATUS-tpiombo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tpiombo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-locali.
      * <TOTEM:EPT. INIT:gordforn, FD:locali, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT locali
           IF NOT Valid-STATUS-locali
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:locali, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tlistini.
      * <TOTEM:EPT. INIT:gordforn, FD:tlistini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tlistini
           IF NOT Valid-STATUS-tlistini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tlistini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rlistini.
      * <TOTEM:EPT. INIT:gordforn, FD:rlistini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rlistini
           IF NOT Valid-STATUS-rlistini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:rlistini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcaumag.
      * <TOTEM:EPT. INIT:gordforn, FD:tcaumag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcaumag
           IF NOT Valid-STATUS-tcaumag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tcaumag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-nordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:tmp-nordforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O tmp-nordforn
           IF STATUS-tmp-nordforn = "35"
              OPEN OUTPUT tmp-nordforn
                IF Valid-STATUS-tmp-nordforn
                   CLOSE tmp-nordforn
                   OPEN I-O tmp-nordforn
                END-IF
           END-IF
           IF NOT Valid-STATUS-tmp-nordforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tmp-nordforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-clienti.
      * <TOTEM:EPT. INIT:gordforn, FD:clienti, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O clienti
           IF STATUS-clienti = "35"
              OPEN OUTPUT clienti
                IF Valid-STATUS-clienti
                   CLOSE clienti
                   OPEN I-O clienti
                END-IF
           END-IF
           IF NOT Valid-STATUS-clienti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:clienti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-clienti1.
      * <TOTEM:EPT. INIT:gordforn, FD:clienti1, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT clienti1
           IF NOT VALID-STATUS-clienti1
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:clienti1, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-lockfile.
      * <TOTEM:EPT. INIT:gordforn, FD:lockfile, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O lockfile
           IF STATUS-lockfile = "35"
              OPEN OUTPUT lockfile
                IF Valid-STATUS-lockfile
                   CLOSE lockfile
                   OPEN I-O lockfile
                END-IF
           END-IF
           IF NOT Valid-STATUS-lockfile
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:lockfile, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-art-ordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:art-ordforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O art-ordforn
           IF STATUS-art-ordforn = "35"
              OPEN OUTPUT art-ordforn
                IF Valid-STATUS-art-ordforn
                   CLOSE art-ordforn
                   OPEN I-O art-ordforn
                END-IF
           END-IF
           IF NOT Valid-STATUS-art-ordforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:art-ordforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-destinif.
      * <TOTEM:EPT. INIT:gordforn, FD:destinif, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O destinif
           IF STATUS-destinif = "35"
              OPEN OUTPUT destinif
                IF Valid-STATUS-destinif
                   CLOSE destinif
                   OPEN I-O destinif
                END-IF
           END-IF
           IF NOT Valid-STATUS-destinif
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:destinif, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-impforn.
      * <TOTEM:EPT. INIT:gordforn, FD:impforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT impforn
           IF NOT Valid-STATUS-impforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:impforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:rordforn, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O rordforn
           IF STATUS-rordforn = "35"
              OPEN OUTPUT rordforn
                IF Valid-STATUS-rordforn
                   CLOSE rordforn
                   OPEN I-O rordforn
                END-IF
           END-IF
           IF NOT Valid-STATUS-rordforn
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:rordforn, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-destini.
      * <TOTEM:EPT. INIT:gordforn, FD:destini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT destini
           IF NOT Valid-STATUS-destini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:destini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tpromo.
      * <TOTEM:EPT. INIT:gordforn, FD:tpromo, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tpromo
           IF NOT Valid-STATUS-tpromo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tpromo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-tpromo-zoom.
      * <TOTEM:EPT. INIT:gordforn, FD:tmp-tpromo-zoom, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O tmp-tpromo-zoom
           IF STATUS-tmp-tpromo-zoom = "35"
              OPEN OUTPUT tmp-tpromo-zoom
                IF Valid-STATUS-tmp-tpromo-zoom
                   CLOSE tmp-tpromo-zoom
                   OPEN I-O tmp-tpromo-zoom
                END-IF
           END-IF
           IF NOT Valid-STATUS-tmp-tpromo-zoom
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tmp-tpromo-zoom, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tgrupgdo.
      * <TOTEM:EPT. INIT:gordforn, FD:tgrupgdo, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tgrupgdo
           IF NOT Valid-STATUS-tgrupgdo
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tgrupgdo, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmagaz.
      * <TOTEM:EPT. INIT:gordforn, FD:tmagaz, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tmagaz
           IF NOT Valid-STATUS-tmagaz
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tmagaz, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-distinteb.
      * <TOTEM:EPT. INIT:gordforn, FD:distinteb, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT distinteb
           IF NOT Valid-STATUS-distinteb
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:distinteb, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-nlistini.
      * <TOTEM:EPT. INIT:gordforn, FD:nlistini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT nlistini
           IF NOT Valid-STATUS-nlistini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:nlistini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-nforn-dest.
      * <TOTEM:EPT. INIT:gordforn, FD:nforn-dest, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT nforn-dest
           IF NOT Valid-STATUS-nforn-dest
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:nforn-dest, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-param.
      * <TOTEM:EPT. INIT:gordforn, FD:param, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT param
           IF NOT Valid-STATUS-param
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:param, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tscorte.
      * <TOTEM:EPT. INIT:gordforn, FD:tscorte, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tscorte
           IF NOT Valid-STATUS-tscorte
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tscorte, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rordini.
      * <TOTEM:EPT. INIT:gordforn, FD:rordini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT rordini
           IF NOT Valid-STATUS-rordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:rordini, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tordini.
      * <TOTEM:EPT. INIT:gordforn, FD:tordini, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tordini
           IF NOT Valid-STATUS-tordini
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gordforn, FD:tordini, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-tordforn
      *    tparamge CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tparamge
           PERFORM CLOSE-timballi
      *    zoom-tcaumag CLOSE MODE IS FALSE
      *    PERFORM CLOSE-zoom-tcaumag
           PERFORM CLOSE-blister
           PERFORM CLOSE-articoli
           PERFORM CLOSE-tcodpag
           PERFORM CLOSE-timposte
           PERFORM CLOSE-timbalqta
           PERFORM CLOSE-tmarche
           PERFORM CLOSE-progmag
      *    tmp-progmag-zoom CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-progmag-zoom
           PERFORM CLOSE-nordforn
           PERFORM CLOSE-tivaese
           PERFORM CLOSE-tpiombo
           PERFORM CLOSE-locali
           PERFORM CLOSE-tlistini
           PERFORM CLOSE-rlistini
           PERFORM CLOSE-tcaumag
      *    tmp-nordforn CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-nordforn
           PERFORM CLOSE-clienti
           PERFORM CLOSE-clienti1
           PERFORM CLOSE-lockfile
           PERFORM CLOSE-art-ordforn
           PERFORM CLOSE-destinif
           PERFORM CLOSE-impforn
           PERFORM CLOSE-rordforn
           PERFORM CLOSE-destini
           PERFORM CLOSE-tpromo
      *    tmp-tpromo-zoom CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-tpromo-zoom
           PERFORM CLOSE-tgrupgdo
           PERFORM CLOSE-tmagaz
           PERFORM CLOSE-distinteb
           PERFORM CLOSE-nlistini
           PERFORM CLOSE-nforn-dest
           PERFORM CLOSE-param
           PERFORM CLOSE-tscorte
           PERFORM CLOSE-rordini
           PERFORM CLOSE-tordini
      *    After Close
           .

       CLOSE-tordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:tordforn, BeforeClose>
      * <TOTEM:END>
           CLOSE tordforn
           .

       CLOSE-tparamge.
      * <TOTEM:EPT. INIT:gordforn, FD:tparamge, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-timballi.
      * <TOTEM:EPT. INIT:gordforn, FD:timballi, BeforeClose>
      * <TOTEM:END>
           CLOSE timballi
           .

       CLOSE-zoom-tcaumag.
      * <TOTEM:EPT. INIT:gordforn, FD:zoom-tcaumag, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-blister.
      * <TOTEM:EPT. INIT:gordforn, FD:blister, BeforeClose>
      * <TOTEM:END>
           CLOSE blister
           .

       CLOSE-articoli.
      * <TOTEM:EPT. INIT:gordforn, FD:articoli, BeforeClose>
      * <TOTEM:END>
           CLOSE articoli
           .

       CLOSE-tcodpag.
      * <TOTEM:EPT. INIT:gordforn, FD:tcodpag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcodpag
           .

       CLOSE-timposte.
      * <TOTEM:EPT. INIT:gordforn, FD:timposte, BeforeClose>
      * <TOTEM:END>
           CLOSE timposte
           .

       CLOSE-timbalqta.
      * <TOTEM:EPT. INIT:gordforn, FD:timbalqta, BeforeClose>
      * <TOTEM:END>
           CLOSE timbalqta
           .

       CLOSE-tmarche.
      * <TOTEM:EPT. INIT:gordforn, FD:tmarche, BeforeClose>
      * <TOTEM:END>
           CLOSE tmarche
           .

       CLOSE-progmag.
      * <TOTEM:EPT. INIT:gordforn, FD:progmag, BeforeClose>
      * <TOTEM:END>
           CLOSE progmag
           .

       CLOSE-tmp-progmag-zoom.
      * <TOTEM:EPT. INIT:gordforn, FD:tmp-progmag-zoom, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-nordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:nordforn, BeforeClose>
      * <TOTEM:END>
           CLOSE nordforn
           .

       CLOSE-tivaese.
      * <TOTEM:EPT. INIT:gordforn, FD:tivaese, BeforeClose>
      * <TOTEM:END>
           CLOSE tivaese
           .

       CLOSE-tpiombo.
      * <TOTEM:EPT. INIT:gordforn, FD:tpiombo, BeforeClose>
      * <TOTEM:END>
           CLOSE tpiombo
           .

       CLOSE-locali.
      * <TOTEM:EPT. INIT:gordforn, FD:locali, BeforeClose>
      * <TOTEM:END>
           CLOSE locali
           .

       CLOSE-tlistini.
      * <TOTEM:EPT. INIT:gordforn, FD:tlistini, BeforeClose>
      * <TOTEM:END>
           CLOSE tlistini
           .

       CLOSE-rlistini.
      * <TOTEM:EPT. INIT:gordforn, FD:rlistini, BeforeClose>
      * <TOTEM:END>
           CLOSE rlistini
           .

       CLOSE-tcaumag.
      * <TOTEM:EPT. INIT:gordforn, FD:tcaumag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcaumag
           .

       CLOSE-tmp-nordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:tmp-nordforn, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-clienti.
      * <TOTEM:EPT. INIT:gordforn, FD:clienti, BeforeClose>
      * <TOTEM:END>
           CLOSE clienti
           .

       CLOSE-clienti1.
      * <TOTEM:EPT. INIT:gordforn, FD:clienti1, BeforeClose>
      * <TOTEM:END>
           CLOSE clienti1
           .

       CLOSE-lockfile.
      * <TOTEM:EPT. INIT:gordforn, FD:lockfile, BeforeClose>
      * <TOTEM:END>
           CLOSE lockfile
           .

       CLOSE-art-ordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:art-ordforn, BeforeClose>
      * <TOTEM:END>
           CLOSE art-ordforn
           .

       CLOSE-destinif.
      * <TOTEM:EPT. INIT:gordforn, FD:destinif, BeforeClose>
      * <TOTEM:END>
           CLOSE destinif
           .

       CLOSE-impforn.
      * <TOTEM:EPT. INIT:gordforn, FD:impforn, BeforeClose>
      * <TOTEM:END>
           CLOSE impforn
           .

       CLOSE-rordforn.
      * <TOTEM:EPT. INIT:gordforn, FD:rordforn, BeforeClose>
      * <TOTEM:END>
           CLOSE rordforn
           .

       CLOSE-destini.
      * <TOTEM:EPT. INIT:gordforn, FD:destini, BeforeClose>
      * <TOTEM:END>
           CLOSE destini
           .

       CLOSE-tpromo.
      * <TOTEM:EPT. INIT:gordforn, FD:tpromo, BeforeClose>
      * <TOTEM:END>
           CLOSE tpromo
           .

       CLOSE-tmp-tpromo-zoom.
      * <TOTEM:EPT. INIT:gordforn, FD:tmp-tpromo-zoom, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-tgrupgdo.
      * <TOTEM:EPT. INIT:gordforn, FD:tgrupgdo, BeforeClose>
      * <TOTEM:END>
           CLOSE tgrupgdo
           .

       CLOSE-tmagaz.
      * <TOTEM:EPT. INIT:gordforn, FD:tmagaz, BeforeClose>
      * <TOTEM:END>
           CLOSE tmagaz
           .

       CLOSE-distinteb.
      * <TOTEM:EPT. INIT:gordforn, FD:distinteb, BeforeClose>
      * <TOTEM:END>
           CLOSE distinteb
           .

       CLOSE-nlistini.
      * <TOTEM:EPT. INIT:gordforn, FD:nlistini, BeforeClose>
      * <TOTEM:END>
           CLOSE nlistini
           .

       CLOSE-nforn-dest.
      * <TOTEM:EPT. INIT:gordforn, FD:nforn-dest, BeforeClose>
      * <TOTEM:END>
           CLOSE nforn-dest
           .

       CLOSE-param.
      * <TOTEM:EPT. INIT:gordforn, FD:param, BeforeClose>
      * <TOTEM:END>
           CLOSE param
           .

       CLOSE-tscorte.
      * <TOTEM:EPT. INIT:gordforn, FD:tscorte, BeforeClose>
      * <TOTEM:END>
           CLOSE tscorte
           .

       CLOSE-rordini.
      * <TOTEM:EPT. INIT:gordforn, FD:rordini, BeforeClose>
      * <TOTEM:END>
           CLOSE rordini
           .

       CLOSE-tordini.
      * <TOTEM:EPT. INIT:gordforn, FD:tordini, BeforeClose>
      * <TOTEM:END>
           CLOSE tordini
           .

       tordforn-tof-k-causale-MERGE-SPLITBUF.
           INITIALIZE tordforn-tof-k-causale-SPLITBUF
           MOVE tof-causale(1:4) TO tordforn-tof-k-causale-SPLITBUF(1:4)
           MOVE tof-chiave(1:12) TO 
           tordforn-tof-k-causale-SPLITBUF(5:12)
           .

       tordforn-tof-k-stato-MERGE-SPLITBUF.
           INITIALIZE tordforn-tof-k-stato-SPLITBUF
           MOVE tof-stato(1:1) TO tordforn-tof-k-stato-SPLITBUF(1:1)
           MOVE tof-chiave(1:12) TO tordforn-tof-k-stato-SPLITBUF(2:12)
           .

       tordforn-k-fornitore-MERGE-SPLITBUF.
           INITIALIZE tordforn-k-fornitore-SPLITBUF
           MOVE tof-cod-forn(1:5) TO tordforn-k-fornitore-SPLITBUF(1:5)
           MOVE tof-destino(1:5) TO tordforn-k-fornitore-SPLITBUF(6:5)
           MOVE tof-stato(1:1) TO tordforn-k-fornitore-SPLITBUF(11:1)
           MOVE tof-chiave(1:12) TO tordforn-k-fornitore-SPLITBUF(12:12)
           .

       tordforn-tof-k-data-MERGE-SPLITBUF.
           INITIALIZE tordforn-tof-k-data-SPLITBUF
           MOVE tof-data-ordine OF tordforn(1:8) TO 
           tordforn-tof-k-data-SPLITBUF(1:8)
           MOVE tof-chiave OF tordforn(1:12) TO 
           tordforn-tof-k-data-SPLITBUF(9:12)
           .

       tordforn-tof-k-consegna-MERGE-SPLITBUF.
           INITIALIZE tordforn-tof-k-consegna-SPLITBUF
           MOVE tof-data-consegna OF tordforn(1:8) TO 
           tordforn-tof-k-consegna-SPLITBUF(1:8)
           MOVE tof-chiave OF tordforn(1:12) TO 
           tordforn-tof-k-consegna-SPLITBUF(9:12)
           .

       DataSet1-tordforn-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tordforn-KEY1-Asc
                 MOVE Low-Value TO tof-chiave
              ELSE
                 MOVE High-Value TO tof-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tordforn-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tordforn-KEY1-Asc
                 MOVE High-Value TO tof-chiave
              ELSE
                 MOVE Low-Value TO tof-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-tordforn-KEY1-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-tordforn-KEY1-ORDER
           END-EVALUATE
           .

      * tordforn
       DataSet1-tordforn-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tordforn-KEY1-Asc
                 START tordforn KEY >= tof-chiave
              ELSE
                 START tordforn KEY <= tof-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tordforn-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tordforn-KEY1-Asc
                 START tordforn KEY <= tof-chiave
              ELSE
                 START tordforn KEY >= tof-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tordforn-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tordforn-KEY1-Asc
                 START tordforn KEY > tof-chiave
              ELSE
                 START tordforn KEY < tof-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tordforn-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tordforn-KEY1-Asc
                 START tordforn KEY < tof-chiave
              ELSE
                 START tordforn KEY > tof-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tordforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tordforn-LOCK
                 READ tordforn WITH LOCK 
                 KEY tof-chiave
              ELSE
                 READ tordforn WITH NO LOCK 
                 KEY tof-chiave
              END-IF
           END-EVALUATE
           PERFORM tordforn-tof-k-causale-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-stato-MERGE-SPLITBUF
           PERFORM tordforn-k-fornitore-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-data-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-consegna-MERGE-SPLITBUF
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT 
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tordforn-KEY1-Asc
                 IF DataSet1-tordforn-LOCK
                    READ tordforn NEXT WITH LOCK
                 ELSE
                    READ tordforn NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-tordforn-LOCK
                    READ tordforn PREVIOUS WITH LOCK
                 ELSE
                    READ tordforn PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM tordforn-tof-k-causale-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-stato-MERGE-SPLITBUF
           PERFORM tordforn-k-fornitore-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-data-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-consegna-MERGE-SPLITBUF
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tordforn-KEY1-Asc
                 IF DataSet1-tordforn-LOCK
                    READ tordforn PREVIOUS WITH LOCK
                 ELSE
                    READ tordforn PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-tordforn-LOCK
                    READ tordforn NEXT WITH LOCK
                 ELSE
                    READ tordforn NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM tordforn-tof-k-causale-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-stato-MERGE-SPLITBUF
           PERFORM tordforn-k-fornitore-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-data-MERGE-SPLITBUF
           PERFORM tordforn-tof-k-consegna-MERGE-SPLITBUF
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeWrite>
      * <TOTEM:END>
           WRITE tof-rec OF tordforn.
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeRewrite>
      * <TOTEM:END>
           REWRITE tof-rec OF tordforn.
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tordforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, BeforeDelete>
      * <TOTEM:END>
           DELETE tordforn.
           MOVE STATUS-tordforn TO TOTEM-ERR-STAT
           MOVE "tordforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordforn, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tparamge-INITSTART.
           IF DataSet1-tparamge-KEY-Asc
              MOVE Low-Value TO tge-chiave
           ELSE
              MOVE High-Value TO tge-chiave
           END-IF
           .

       DataSet1-tparamge-INITEND.
           IF DataSet1-tparamge-KEY-Asc
              MOVE High-Value TO tge-chiave
           ELSE
              MOVE Low-Value TO tge-chiave
           END-IF
           .

      * tparamge
       DataSet1-tparamge-START.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY >= tge-chiave
           ELSE
              START tparamge KEY <= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-NOTGREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY <= tge-chiave
           ELSE
              START tparamge KEY >= tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-GREATER.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY > tge-chiave
           ELSE
              START tparamge KEY < tge-chiave
           END-IF
           .

       DataSet1-tparamge-START-LESS.
           IF DataSet1-tparamge-KEY-Asc
              START tparamge KEY < tge-chiave
           ELSE
              START tparamge KEY > tge-chiave
           END-IF
           .

       DataSet1-tparamge-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tparamge-LOCK
              READ tparamge WITH LOCK 
              KEY tge-chiave
           ELSE
              READ tparamge WITH NO LOCK 
              KEY tge-chiave
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT 
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tparamge-KEY-Asc
              IF DataSet1-tparamge-LOCK
                 READ tparamge PREVIOUS WITH LOCK
              ELSE
                 READ tparamge PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tparamge-LOCK
                 READ tparamge NEXT WITH LOCK
              ELSE
                 READ tparamge NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timballi-INITSTART.
           IF DataSet1-timballi-KEY-Asc
              MOVE Low-Value TO imb-chiave
           ELSE
              MOVE High-Value TO imb-chiave
           END-IF
           .

       DataSet1-timballi-INITEND.
           IF DataSet1-timballi-KEY-Asc
              MOVE High-Value TO imb-chiave
           ELSE
              MOVE Low-Value TO imb-chiave
           END-IF
           .

      * timballi
       DataSet1-timballi-START.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY >= imb-chiave
           ELSE
              START timballi KEY <= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-NOTGREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY <= imb-chiave
           ELSE
              START timballi KEY >= imb-chiave
           END-IF
           .

       DataSet1-timballi-START-GREATER.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY > imb-chiave
           ELSE
              START timballi KEY < imb-chiave
           END-IF
           .

       DataSet1-timballi-START-LESS.
           IF DataSet1-timballi-KEY-Asc
              START timballi KEY < imb-chiave
           ELSE
              START timballi KEY > imb-chiave
           END-IF
           .

       DataSet1-timballi-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timballi-LOCK
              READ timballi WITH LOCK 
              KEY imb-chiave
           ELSE
              READ timballi WITH NO LOCK 
              KEY imb-chiave
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT 
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timballi-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timballi-KEY-Asc
              IF DataSet1-timballi-LOCK
                 READ timballi PREVIOUS WITH LOCK
              ELSE
                 READ timballi PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timballi-LOCK
                 READ timballi NEXT WITH LOCK
              ELSE
                 READ timballi NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timballi-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timballi TO TOTEM-ERR-STAT
           MOVE "timballi" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timballi, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-INITSTART.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              MOVE Low-Value TO zoom-tca-chiave
           ELSE
              MOVE High-Value TO zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-INITEND.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              MOVE High-Value TO zoom-tca-chiave
           ELSE
              MOVE Low-Value TO zoom-tca-chiave
           END-IF
           .

      * zoom-tcaumag
       DataSet1-zoom-tcaumag-START.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              START zoom-tcaumag KEY >= zoom-tca-chiave
           ELSE
              START zoom-tcaumag KEY <= zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-START-NOTGREATER.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              START zoom-tcaumag KEY <= zoom-tca-chiave
           ELSE
              START zoom-tcaumag KEY >= zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-START-GREATER.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              START zoom-tcaumag KEY > zoom-tca-chiave
           ELSE
              START zoom-tcaumag KEY < zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-START-LESS.
           IF DataSet1-zoom-tcaumag-KEY-Asc
              START zoom-tcaumag KEY < zoom-tca-chiave
           ELSE
              START zoom-tcaumag KEY > zoom-tca-chiave
           END-IF
           .

       DataSet1-zoom-tcaumag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeWrite>
      * <TOTEM:END>
           WRITE zoom-tca-rec OF zoom-tcaumag.
           MOVE status-zooom-tcaumag TO TOTEM-ERR-STAT
           MOVE "zoom-tcaumag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeRewrite>
      * <TOTEM:END>
           MOVE status-zooom-tcaumag TO TOTEM-ERR-STAT
           MOVE "zoom-tcaumag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-tcaumag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, BeforeDelete>
      * <TOTEM:END>
           MOVE status-zooom-tcaumag TO TOTEM-ERR-STAT
           MOVE "zoom-tcaumag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-tcaumag, AfterDelete>
      * <TOTEM:END>
           .

       blister-k-magaz-MERGE-SPLITBUF.
           INITIALIZE blister-k-magaz-SPLITBUF
           MOVE bli-magazzino(1:3) TO blister-k-magaz-SPLITBUF(1:3)
           MOVE bli-codice(1:6) TO blister-k-magaz-SPLITBUF(4:6)
           .

       blister-k-des-MERGE-SPLITBUF.
           INITIALIZE blister-k-des-SPLITBUF
           MOVE bli-descrizione(1:50) TO blister-k-des-SPLITBUF(1:50)
           .

       DataSet1-blister-INITSTART.
           IF DataSet1-blister-KEY-Asc
              MOVE Low-Value TO bli-chiave
           ELSE
              MOVE High-Value TO bli-chiave
           END-IF
           .

       DataSet1-blister-INITEND.
           IF DataSet1-blister-KEY-Asc
              MOVE High-Value TO bli-chiave
           ELSE
              MOVE Low-Value TO bli-chiave
           END-IF
           .

      * blister
       DataSet1-blister-START.
           IF DataSet1-blister-KEY-Asc
              START blister KEY >= bli-chiave
           ELSE
              START blister KEY <= bli-chiave
           END-IF
           .

       DataSet1-blister-START-NOTGREATER.
           IF DataSet1-blister-KEY-Asc
              START blister KEY <= bli-chiave
           ELSE
              START blister KEY >= bli-chiave
           END-IF
           .

       DataSet1-blister-START-GREATER.
           IF DataSet1-blister-KEY-Asc
              START blister KEY > bli-chiave
           ELSE
              START blister KEY < bli-chiave
           END-IF
           .

       DataSet1-blister-START-LESS.
           IF DataSet1-blister-KEY-Asc
              START blister KEY < bli-chiave
           ELSE
              START blister KEY > bli-chiave
           END-IF
           .

       DataSet1-blister-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-blister-LOCK
              READ blister WITH LOCK 
              KEY bli-chiave
           ELSE
              READ blister WITH NO LOCK 
              KEY bli-chiave
           END-IF
           PERFORM blister-k-magaz-MERGE-SPLITBUF
           PERFORM blister-k-des-MERGE-SPLITBUF
           MOVE STATUS-blister TO TOTEM-ERR-STAT 
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-blister-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-blister-KEY-Asc
              IF DataSet1-blister-LOCK
                 READ blister NEXT WITH LOCK
              ELSE
                 READ blister NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-blister-LOCK
                 READ blister PREVIOUS WITH LOCK
              ELSE
                 READ blister PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM blister-k-magaz-MERGE-SPLITBUF
           PERFORM blister-k-des-MERGE-SPLITBUF
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-blister-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-blister-KEY-Asc
              IF DataSet1-blister-LOCK
                 READ blister PREVIOUS WITH LOCK
              ELSE
                 READ blister PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-blister-LOCK
                 READ blister NEXT WITH LOCK
              ELSE
                 READ blister NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM blister-k-magaz-MERGE-SPLITBUF
           PERFORM blister-k-des-MERGE-SPLITBUF
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-blister-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-blister-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-blister-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:blister, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-blister TO TOTEM-ERR-STAT
           MOVE "blister" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:blister, AfterDelete>
      * <TOTEM:END>
           .

       articoli-art-k1-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k1-SPLITBUF
           MOVE art-descrizione OF articoli(1:50) TO 
           articoli-art-k1-SPLITBUF(1:50)
           .

       articoli-art-k-frn-MERGE-SPLITBUF.
           INITIALIZE articoli-art-k-frn-SPLITBUF
           MOVE art-cod-art-frn OF articoli(1:15) TO 
           articoli-art-k-frn-SPLITBUF(1:15)
           .

       DataSet1-articoli-INITSTART.
           IF DataSet1-articoli-KEY-Asc
              MOVE Low-Value TO art-chiave OF articoli
           ELSE
              MOVE High-Value TO art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-INITEND.
           IF DataSet1-articoli-KEY-Asc
              MOVE High-Value TO art-chiave OF articoli
           ELSE
              MOVE Low-Value TO art-chiave OF articoli
           END-IF
           .

      * articoli
       DataSet1-articoli-START.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY >= art-chiave OF articoli
           ELSE
              START articoli KEY <= art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-NOTGREATER.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY <= art-chiave OF articoli
           ELSE
              START articoli KEY >= art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-GREATER.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY > art-chiave OF articoli
           ELSE
              START articoli KEY < art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-START-LESS.
           IF DataSet1-articoli-KEY-Asc
              START articoli KEY < art-chiave OF articoli
           ELSE
              START articoli KEY > art-chiave OF articoli
           END-IF
           .

       DataSet1-articoli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-articoli-LOCK
              READ articoli WITH LOCK 
              KEY art-chiave OF articoli
           ELSE
              READ articoli WITH NO LOCK 
              KEY art-chiave OF articoli
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT 
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-articoli-KEY-Asc
              IF DataSet1-articoli-LOCK
                 READ articoli NEXT WITH LOCK
              ELSE
                 READ articoli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli-LOCK
                 READ articoli PREVIOUS WITH LOCK
              ELSE
                 READ articoli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-articoli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-articoli-KEY-Asc
              IF DataSet1-articoli-LOCK
                 READ articoli PREVIOUS WITH LOCK
              ELSE
                 READ articoli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-articoli-LOCK
                 READ articoli NEXT WITH LOCK
              ELSE
                 READ articoli NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM articoli-art-k1-MERGE-SPLITBUF
           PERFORM articoli-art-k-frn-MERGE-SPLITBUF
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-articoli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-articoli TO TOTEM-ERR-STAT
           MOVE "articoli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:articoli, AfterDelete>
      * <TOTEM:END>
           .

       tcodpag-TBL-CODICE-01-MERGE-SPLITBUF.
           INITIALIZE tcodpag-TBL-CODICE-01-SPLITBUF
           MOVE TBLPA-CODICE1(1:2) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(1:2)
           MOVE TBLPA-DESCRIZIONE1(1:30) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(3:30)
           MOVE TBLPA-CODICE2(1:20) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(33:20)
           .

       DataSet1-tcodpag-INITSTART.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE Low-Value TO TBLPA-CODICE
           ELSE
              MOVE High-Value TO TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-INITEND.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE High-Value TO TBLPA-CODICE
           ELSE
              MOVE Low-Value TO TBLPA-CODICE
           END-IF
           .

      * tcodpag
       DataSet1-tcodpag-START.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY >= TBLPA-CODICE
           ELSE
              START tcodpag KEY <= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-NOTGREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY <= TBLPA-CODICE
           ELSE
              START tcodpag KEY >= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-GREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY > TBLPA-CODICE
           ELSE
              START tcodpag KEY < TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-LESS.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY < TBLPA-CODICE
           ELSE
              START tcodpag KEY > TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcodpag-LOCK
              READ tcodpag WITH LOCK 
              KEY TBLPA-CODICE
           ELSE
              READ tcodpag WITH NO LOCK 
              KEY TBLPA-CODICE
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT 
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeWrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRewrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeDelete>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timposte-INITSTART.
           IF DataSet1-timposte-KEY-Asc
              MOVE Low-Value TO imp-chiave
           ELSE
              MOVE High-Value TO imp-chiave
           END-IF
           .

       DataSet1-timposte-INITEND.
           IF DataSet1-timposte-KEY-Asc
              MOVE High-Value TO imp-chiave
           ELSE
              MOVE Low-Value TO imp-chiave
           END-IF
           .

      * timposte
       DataSet1-timposte-START.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY >= imp-chiave
           ELSE
              START timposte KEY <= imp-chiave
           END-IF
           .

       DataSet1-timposte-START-NOTGREATER.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY <= imp-chiave
           ELSE
              START timposte KEY >= imp-chiave
           END-IF
           .

       DataSet1-timposte-START-GREATER.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY > imp-chiave
           ELSE
              START timposte KEY < imp-chiave
           END-IF
           .

       DataSet1-timposte-START-LESS.
           IF DataSet1-timposte-KEY-Asc
              START timposte KEY < imp-chiave
           ELSE
              START timposte KEY > imp-chiave
           END-IF
           .

       DataSet1-timposte-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timposte-LOCK
              READ timposte WITH LOCK 
              KEY imp-chiave
           ELSE
              READ timposte WITH NO LOCK 
              KEY imp-chiave
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT 
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timposte-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timposte-KEY-Asc
              IF DataSet1-timposte-LOCK
                 READ timposte NEXT WITH LOCK
              ELSE
                 READ timposte NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timposte-LOCK
                 READ timposte PREVIOUS WITH LOCK
              ELSE
                 READ timposte PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timposte-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timposte-KEY-Asc
              IF DataSet1-timposte-LOCK
                 READ timposte PREVIOUS WITH LOCK
              ELSE
                 READ timposte PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timposte-LOCK
                 READ timposte NEXT WITH LOCK
              ELSE
                 READ timposte NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timposte-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timposte TO TOTEM-ERR-STAT
           MOVE "timposte" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timposte, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-INITSTART.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE Low-Value TO imq-chiave
           ELSE
              MOVE High-Value TO imq-chiave
           END-IF
           .

       DataSet1-timbalqta-INITEND.
           IF DataSet1-timbalqta-KEY-Asc
              MOVE High-Value TO imq-chiave
           ELSE
              MOVE Low-Value TO imq-chiave
           END-IF
           .

      * timbalqta
       DataSet1-timbalqta-START.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY >= imq-chiave
           ELSE
              START timbalqta KEY <= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-NOTGREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY <= imq-chiave
           ELSE
              START timbalqta KEY >= imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-GREATER.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY > imq-chiave
           ELSE
              START timbalqta KEY < imq-chiave
           END-IF
           .

       DataSet1-timbalqta-START-LESS.
           IF DataSet1-timbalqta-KEY-Asc
              START timbalqta KEY < imq-chiave
           ELSE
              START timbalqta KEY > imq-chiave
           END-IF
           .

       DataSet1-timbalqta-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-timbalqta-LOCK
              READ timbalqta WITH LOCK 
              KEY imq-chiave
           ELSE
              READ timbalqta WITH NO LOCK 
              KEY imq-chiave
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT 
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-timbalqta-KEY-Asc
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta PREVIOUS WITH LOCK
              ELSE
                 READ timbalqta PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-timbalqta-LOCK
                 READ timbalqta NEXT WITH LOCK
              ELSE
                 READ timbalqta NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-timbalqta-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-timbalqta TO TOTEM-ERR-STAT
           MOVE "timbalqta" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:timbalqta, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmarche-INITSTART.
           IF DataSet1-tmarche-KEY-Asc
              MOVE Low-Value TO mar-chiave
           ELSE
              MOVE High-Value TO mar-chiave
           END-IF
           .

       DataSet1-tmarche-INITEND.
           IF DataSet1-tmarche-KEY-Asc
              MOVE High-Value TO mar-chiave
           ELSE
              MOVE Low-Value TO mar-chiave
           END-IF
           .

      * tmarche
       DataSet1-tmarche-START.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY >= mar-chiave
           ELSE
              START tmarche KEY <= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-NOTGREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY <= mar-chiave
           ELSE
              START tmarche KEY >= mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-GREATER.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY > mar-chiave
           ELSE
              START tmarche KEY < mar-chiave
           END-IF
           .

       DataSet1-tmarche-START-LESS.
           IF DataSet1-tmarche-KEY-Asc
              START tmarche KEY < mar-chiave
           ELSE
              START tmarche KEY > mar-chiave
           END-IF
           .

       DataSet1-tmarche-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmarche-LOCK
              READ tmarche WITH LOCK 
              KEY mar-chiave
           ELSE
              READ tmarche WITH NO LOCK 
              KEY mar-chiave
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT 
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmarche-KEY-Asc
              IF DataSet1-tmarche-LOCK
                 READ tmarche PREVIOUS WITH LOCK
              ELSE
                 READ tmarche PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmarche-LOCK
                 READ tmarche NEXT WITH LOCK
              ELSE
                 READ tmarche NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmarche-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmarche TO TOTEM-ERR-STAT
           MOVE "tmarche" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmarche, AfterDelete>
      * <TOTEM:END>
           .

       progmag-key01-MERGE-SPLITBUF.
           INITIALIZE progmag-key01-SPLITBUF
           MOVE prg-cod-magazzino OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(1:3)
           MOVE prg-cod-articolo OF progmag(1:6) TO 
           progmag-key01-SPLITBUF(4:6)
           MOVE prg-tipo-imballo OF progmag(1:3) TO 
           progmag-key01-SPLITBUF(10:3)
           MOVE prg-peso OF progmag(1:8) TO progmag-key01-SPLITBUF(13:8)
           .

       DataSet1-progmag-INITSTART.
           IF DataSet1-progmag-KEY-Asc
              MOVE Low-Value TO prg-chiave OF progmag
           ELSE
              MOVE High-Value TO prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-INITEND.
           IF DataSet1-progmag-KEY-Asc
              MOVE High-Value TO prg-chiave OF progmag
           ELSE
              MOVE Low-Value TO prg-chiave OF progmag
           END-IF
           .

      * progmag
       DataSet1-progmag-START.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY >= prg-chiave OF progmag
           ELSE
              START progmag KEY <= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-NOTGREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY <= prg-chiave OF progmag
           ELSE
              START progmag KEY >= prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-GREATER.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY > prg-chiave OF progmag
           ELSE
              START progmag KEY < prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-START-LESS.
           IF DataSet1-progmag-KEY-Asc
              START progmag KEY < prg-chiave OF progmag
           ELSE
              START progmag KEY > prg-chiave OF progmag
           END-IF
           .

       DataSet1-progmag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-progmag-LOCK
              READ progmag WITH LOCK 
              KEY prg-chiave OF progmag
           ELSE
              READ progmag WITH NO LOCK 
              KEY prg-chiave OF progmag
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT 
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-progmag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-progmag-KEY-Asc
              IF DataSet1-progmag-LOCK
                 READ progmag PREVIOUS WITH LOCK
              ELSE
                 READ progmag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-progmag-LOCK
                 READ progmag NEXT WITH LOCK
              ELSE
                 READ progmag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM progmag-key01-MERGE-SPLITBUF
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-progmag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-progmag TO TOTEM-ERR-STAT
           MOVE "progmag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:progmag, AfterDelete>
      * <TOTEM:END>
           .

       tmp-progmag-zoom-key-des-MERGE-SPLITBUF.
           INITIALIZE tmp-progmag-zoom-key-des-SPLITBUF
           MOVE tmp-prg-z-art-des(1:40) TO 
           tmp-progmag-zoom-key-des-SPLITBUF(1:40)
           MOVE tmp-prg-z-chiave(1:23) TO 
           tmp-progmag-zoom-key-des-SPLITBUF(41:23)
           .

       tmp-progmag-zoom-key-des-SPLITBUF-TOFLD.
           MOVE tmp-progmag-zoom-key-des-SPLITBUF(1:40) TO 
           tmp-prg-z-art-des(1:40)
           MOVE tmp-progmag-zoom-key-des-SPLITBUF(41:23) TO 
           tmp-prg-z-chiave(1:23)
           .

       tmp-progmag-zoom-key-art-MERGE-SPLITBUF.
           INITIALIZE tmp-progmag-zoom-key-art-SPLITBUF
           MOVE tmp-prg-z-cod-articolo(1:6) TO 
           tmp-progmag-zoom-key-art-SPLITBUF(1:6)
           .

       DataSet1-tmp-progmag-zoom-INITSTART.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE Low-Value TO tmp-prg-z-art-des
           ELSE
              MOVE High-Value TO tmp-prg-z-art-des
           END-IF
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE Low-Value TO tmp-prg-z-chiave
           ELSE
              MOVE High-Value TO tmp-prg-z-chiave
           END-IF
           .

       DataSet1-tmp-progmag-zoom-INITEND.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE High-Value to tmp-prg-z-art-des
           ELSE
              MOVE Low-Value to tmp-prg-z-art-des
           END-IF
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              MOVE High-Value to tmp-prg-z-chiave
           ELSE
              MOVE Low-Value to tmp-prg-z-chiave
           END-IF
           .

       DataSet1-tmp-progmag-zoom-TMPBUF-TO-FLD.
           MOVE DataSet1-tmp-progmag-zoom-SPLIT-BUF1(1:40) TO
                tmp-prg-z-art-des(1:40)
           MOVE DataSet1-tmp-progmag-zoom-SPLIT-BUF1(41:23) TO
                tmp-prg-z-chiave(1:23)
           .

       DataSet1-tmp-progmag-zoom-FLD-TO-TMPBUF.
           MOVE tmp-prg-z-art-des(1:40) TO
                DataSet1-tmp-progmag-zoom-SPLIT-BUF1(1:40)
           MOVE tmp-prg-z-chiave(1:23) TO
                DataSet1-tmp-progmag-zoom-SPLIT-BUF1(41:23)
           .

      * tmp-progmag-zoom
       DataSet1-tmp-progmag-zoom-START.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY >= key-des
           ELSE
              START tmp-progmag-zoom KEY <= key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-START-NOTGREATER.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY <= key-des
           ELSE
              START tmp-progmag-zoom KEY >= key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-START-GREATER.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY > key-des
           ELSE
              START tmp-progmag-zoom KEY < key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-START-LESS.
           IF DataSet1-tmp-progmag-zoom-KEY-Asc
              START tmp-progmag-zoom KEY < key-des
           ELSE
              START tmp-progmag-zoom KEY > key-des
           END-IF
           .

       DataSet1-tmp-progmag-zoom-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeWrite>
      * <TOTEM:END>
           WRITE tmp-prg-z-rec OF tmp-progmag-zoom.
           MOVE STATUS-tmp-progmag-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-progmag-zoom" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-progmag-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-progmag-zoom" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-progmag-zoom-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-progmag-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-progmag-zoom" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-progmag-zoom, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-nordforn-INITSTART.
           IF DataSet1-nordforn-KEY-Asc
              MOVE Low-Value TO nof-chiave OF nordforn
           ELSE
              MOVE High-Value TO nof-chiave OF nordforn
           END-IF
           .

       DataSet1-nordforn-INITEND.
           IF DataSet1-nordforn-KEY-Asc
              MOVE High-Value TO nof-chiave OF nordforn
           ELSE
              MOVE Low-Value TO nof-chiave OF nordforn
           END-IF
           .

      * nordforn
       DataSet1-nordforn-START.
           IF DataSet1-nordforn-KEY-Asc
              START nordforn KEY >= nof-chiave OF nordforn
           ELSE
              START nordforn KEY <= nof-chiave OF nordforn
           END-IF
           .

       DataSet1-nordforn-START-NOTGREATER.
           IF DataSet1-nordforn-KEY-Asc
              START nordforn KEY <= nof-chiave OF nordforn
           ELSE
              START nordforn KEY >= nof-chiave OF nordforn
           END-IF
           .

       DataSet1-nordforn-START-GREATER.
           IF DataSet1-nordforn-KEY-Asc
              START nordforn KEY > nof-chiave OF nordforn
           ELSE
              START nordforn KEY < nof-chiave OF nordforn
           END-IF
           .

       DataSet1-nordforn-START-LESS.
           IF DataSet1-nordforn-KEY-Asc
              START nordforn KEY < nof-chiave OF nordforn
           ELSE
              START nordforn KEY > nof-chiave OF nordforn
           END-IF
           .

       DataSet1-nordforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-nordforn-LOCK
              READ nordforn WITH LOCK 
              KEY nof-chiave OF nordforn
           ELSE
              READ nordforn WITH NO LOCK 
              KEY nof-chiave OF nordforn
           END-IF
           MOVE STATUS-nordforn TO TOTEM-ERR-STAT 
           MOVE "nordforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-nordforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-nordforn-KEY-Asc
              IF DataSet1-nordforn-LOCK
                 READ nordforn NEXT WITH LOCK
              ELSE
                 READ nordforn NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-nordforn-LOCK
                 READ nordforn PREVIOUS WITH LOCK
              ELSE
                 READ nordforn PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-nordforn TO TOTEM-ERR-STAT
           MOVE "nordforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-nordforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-nordforn-KEY-Asc
              IF DataSet1-nordforn-LOCK
                 READ nordforn PREVIOUS WITH LOCK
              ELSE
                 READ nordforn PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-nordforn-LOCK
                 READ nordforn NEXT WITH LOCK
              ELSE
                 READ nordforn NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-nordforn TO TOTEM-ERR-STAT
           MOVE "nordforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-nordforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, BeforeWrite>
      * <TOTEM:END>
           WRITE nof-rec OF nordforn.
           MOVE STATUS-nordforn TO TOTEM-ERR-STAT
           MOVE "nordforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-nordforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, BeforeRewrite>
      * <TOTEM:END>
           REWRITE nof-rec OF nordforn.
           MOVE STATUS-nordforn TO TOTEM-ERR-STAT
           MOVE "nordforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-nordforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, BeforeDelete>
      * <TOTEM:END>
           DELETE nordforn.
           MOVE STATUS-nordforn TO TOTEM-ERR-STAT
           MOVE "nordforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nordforn, AfterDelete>
      * <TOTEM:END>
           .

       tivaese-key01-MERGE-SPLITBUF.
           INITIALIZE tivaese-key01-SPLITBUF
           MOVE TBLIV-CODICE1(1:2) TO tivaese-key01-SPLITBUF(1:2)
           MOVE TBLIV-DESCRIZIONE1(1:30) TO tivaese-key01-SPLITBUF(3:30)
           MOVE TBLIV-CODICE2(1:20) TO tivaese-key01-SPLITBUF(33:20)
           .

       DataSet1-tivaese-INITSTART.
           IF DataSet1-tivaese-KEY-Asc
              MOVE Low-Value TO TBLIV-CODICE
           ELSE
              MOVE High-Value TO TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-INITEND.
           IF DataSet1-tivaese-KEY-Asc
              MOVE High-Value TO TBLIV-CODICE
           ELSE
              MOVE Low-Value TO TBLIV-CODICE
           END-IF
           .

      * tivaese
       DataSet1-tivaese-START.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY >= TBLIV-CODICE
           ELSE
              START tivaese KEY <= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-NOTGREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY <= TBLIV-CODICE
           ELSE
              START tivaese KEY >= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-GREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY > TBLIV-CODICE
           ELSE
              START tivaese KEY < TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-LESS.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY < TBLIV-CODICE
           ELSE
              START tivaese KEY > TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tivaese-LOCK
              READ tivaese WITH LOCK 
              KEY TBLIV-CODICE
           ELSE
              READ tivaese WITH NO LOCK 
              KEY TBLIV-CODICE
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT 
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-INITSTART.
           IF DataSet1-tpiombo-KEY-Asc
              MOVE Low-Value TO tpb-chiave
           ELSE
              MOVE High-Value TO tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-INITEND.
           IF DataSet1-tpiombo-KEY-Asc
              MOVE High-Value TO tpb-chiave
           ELSE
              MOVE Low-Value TO tpb-chiave
           END-IF
           .

      * tpiombo
       DataSet1-tpiombo-START.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY >= tpb-chiave
           ELSE
              START tpiombo KEY <= tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-NOTGREATER.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY <= tpb-chiave
           ELSE
              START tpiombo KEY >= tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-GREATER.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY > tpb-chiave
           ELSE
              START tpiombo KEY < tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-START-LESS.
           IF DataSet1-tpiombo-KEY-Asc
              START tpiombo KEY < tpb-chiave
           ELSE
              START tpiombo KEY > tpb-chiave
           END-IF
           .

       DataSet1-tpiombo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tpiombo-LOCK
              READ tpiombo WITH LOCK 
              KEY tpb-chiave
           ELSE
              READ tpiombo WITH NO LOCK 
              KEY tpb-chiave
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT 
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tpiombo-KEY-Asc
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo NEXT WITH LOCK
              ELSE
                 READ tpiombo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo PREVIOUS WITH LOCK
              ELSE
                 READ tpiombo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tpiombo-KEY-Asc
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo PREVIOUS WITH LOCK
              ELSE
                 READ tpiombo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpiombo-LOCK
                 READ tpiombo NEXT WITH LOCK
              ELSE
                 READ tpiombo NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tpiombo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tpiombo TO TOTEM-ERR-STAT
           MOVE "tpiombo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpiombo, AfterDelete>
      * <TOTEM:END>
           .

       locali-loc-chiave-gdo-fine-MERGE-SPLITBUF.
           INITIALIZE locali-loc-chiave-gdo-fine-SPLITBUF
           MOVE loc-gdo(1:5) TO locali-loc-chiave-gdo-fine-SPLITBUF(1:5)
           MOVE loc-cliente(1:5) TO 
           locali-loc-chiave-gdo-fine-SPLITBUF(6:5)
           MOVE loc-destino(1:5) TO 
           locali-loc-chiave-gdo-fine-SPLITBUF(11:5)
           MOVE loc-fine-dpo(1:8) TO 
           locali-loc-chiave-gdo-fine-SPLITBUF(16:8)
           MOVE loc-ini-dpo(1:8) TO 
           locali-loc-chiave-gdo-fine-SPLITBUF(24:8)
           .

       locali-loc-chiave-fine-MERGE-SPLITBUF.
           INITIALIZE locali-loc-chiave-fine-SPLITBUF
           MOVE loc-fine-dpo(1:8) TO 
           locali-loc-chiave-fine-SPLITBUF(1:8)
           MOVE loc-ini-dpo(1:8) TO locali-loc-chiave-fine-SPLITBUF(9:8)
           MOVE loc-gdo(1:5) TO locali-loc-chiave-fine-SPLITBUF(17:5)
           MOVE loc-cliente(1:5) TO 
           locali-loc-chiave-fine-SPLITBUF(22:5)
           MOVE loc-destino(1:5) TO 
           locali-loc-chiave-fine-SPLITBUF(27:5)
           .

       locali-loc-chiave-ini-MERGE-SPLITBUF.
           INITIALIZE locali-loc-chiave-ini-SPLITBUF
           MOVE loc-ini-dpo(1:8) TO locali-loc-chiave-ini-SPLITBUF(1:8)
           MOVE loc-fine-dpo(1:8) TO locali-loc-chiave-ini-SPLITBUF(9:8)
           MOVE loc-gdo(1:5) TO locali-loc-chiave-ini-SPLITBUF(17:5)
           MOVE loc-cliente(1:5) TO locali-loc-chiave-ini-SPLITBUF(22:5)
           MOVE loc-destino(1:5) TO locali-loc-chiave-ini-SPLITBUF(27:5)
           .

       DataSet1-locali-INITSTART.
           IF DataSet1-locali-KEY-Asc
              MOVE Low-Value TO loc-chiave
           ELSE
              MOVE High-Value TO loc-chiave
           END-IF
           .

       DataSet1-locali-INITEND.
           IF DataSet1-locali-KEY-Asc
              MOVE High-Value TO loc-chiave
           ELSE
              MOVE Low-Value TO loc-chiave
           END-IF
           .

      * locali
       DataSet1-locali-START.
           IF DataSet1-locali-KEY-Asc
              START locali KEY >= loc-chiave
           ELSE
              START locali KEY <= loc-chiave
           END-IF
           .

       DataSet1-locali-START-NOTGREATER.
           IF DataSet1-locali-KEY-Asc
              START locali KEY <= loc-chiave
           ELSE
              START locali KEY >= loc-chiave
           END-IF
           .

       DataSet1-locali-START-GREATER.
           IF DataSet1-locali-KEY-Asc
              START locali KEY > loc-chiave
           ELSE
              START locali KEY < loc-chiave
           END-IF
           .

       DataSet1-locali-START-LESS.
           IF DataSet1-locali-KEY-Asc
              START locali KEY < loc-chiave
           ELSE
              START locali KEY > loc-chiave
           END-IF
           .

       DataSet1-locali-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-locali-LOCK
              READ locali WITH LOCK 
              KEY loc-chiave
           ELSE
              READ locali WITH NO LOCK 
              KEY loc-chiave
           END-IF
           PERFORM locali-loc-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-ini-MERGE-SPLITBUF
           MOVE STATUS-locali TO TOTEM-ERR-STAT 
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-locali-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-locali-KEY-Asc
              IF DataSet1-locali-LOCK
                 READ locali NEXT WITH LOCK
              ELSE
                 READ locali NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-locali-LOCK
                 READ locali PREVIOUS WITH LOCK
              ELSE
                 READ locali PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM locali-loc-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-ini-MERGE-SPLITBUF
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-locali-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-locali-KEY-Asc
              IF DataSet1-locali-LOCK
                 READ locali PREVIOUS WITH LOCK
              ELSE
                 READ locali PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-locali-LOCK
                 READ locali NEXT WITH LOCK
              ELSE
                 READ locali NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM locali-loc-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-fine-MERGE-SPLITBUF
           PERFORM locali-loc-chiave-ini-MERGE-SPLITBUF
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-locali-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-locali-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-locali-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:locali, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-locali TO TOTEM-ERR-STAT
           MOVE "locali" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:locali, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tlistini-INITSTART.
           IF DataSet1-tlistini-KEY-Asc
              MOVE Low-Value TO tlis-chiave OF tlistini
           ELSE
              MOVE High-Value TO tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-INITEND.
           IF DataSet1-tlistini-KEY-Asc
              MOVE High-Value TO tlis-chiave OF tlistini
           ELSE
              MOVE Low-Value TO tlis-chiave OF tlistini
           END-IF
           .

      * tlistini
       DataSet1-tlistini-START.
           IF DataSet1-tlistini-KEY-Asc
              START tlistini KEY >= tlis-chiave OF tlistini
           ELSE
              START tlistini KEY <= tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-START-NOTGREATER.
           IF DataSet1-tlistini-KEY-Asc
              START tlistini KEY <= tlis-chiave OF tlistini
           ELSE
              START tlistini KEY >= tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-START-GREATER.
           IF DataSet1-tlistini-KEY-Asc
              START tlistini KEY > tlis-chiave OF tlistini
           ELSE
              START tlistini KEY < tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-START-LESS.
           IF DataSet1-tlistini-KEY-Asc
              START tlistini KEY < tlis-chiave OF tlistini
           ELSE
              START tlistini KEY > tlis-chiave OF tlistini
           END-IF
           .

       DataSet1-tlistini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tlistini-LOCK
              READ tlistini WITH LOCK 
              KEY tlis-chiave OF tlistini
           ELSE
              READ tlistini WITH NO LOCK 
              KEY tlis-chiave OF tlistini
           END-IF
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT 
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tlistini-KEY-Asc
              IF DataSet1-tlistini-LOCK
                 READ tlistini NEXT WITH LOCK
              ELSE
                 READ tlistini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tlistini-LOCK
                 READ tlistini PREVIOUS WITH LOCK
              ELSE
                 READ tlistini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tlistini-KEY-Asc
              IF DataSet1-tlistini-LOCK
                 READ tlistini PREVIOUS WITH LOCK
              ELSE
                 READ tlistini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tlistini-LOCK
                 READ tlistini NEXT WITH LOCK
              ELSE
                 READ tlistini NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tlistini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tlistini TO TOTEM-ERR-STAT
           MOVE "tlistini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tlistini, AfterDelete>
      * <TOTEM:END>
           .

       rlistini-rlis-k-art-MERGE-SPLITBUF.
           INITIALIZE rlistini-rlis-k-art-SPLITBUF
           MOVE rlis-articolo OF rlistini(1:6) TO 
           rlistini-rlis-k-art-SPLITBUF(1:6)
           MOVE rlis-chiave-ricerca OF rlistini(1:26) TO 
           rlistini-rlis-k-art-SPLITBUF(7:26)
           .

       rlistini-rlis-k-descr-MERGE-SPLITBUF.
           INITIALIZE rlistini-rlis-k-descr-SPLITBUF
           MOVE rlis-codice OF rlistini(1:15) TO 
           rlistini-rlis-k-descr-SPLITBUF(1:15)
           MOVE rlis-des-libera OF rlistini(1:50) TO 
           rlistini-rlis-k-descr-SPLITBUF(16:50)
           .

       DataSet1-rlistini-INITSTART.
           IF DataSet1-rlistini-KEY-Asc
              MOVE Low-Value TO rlis-chiave OF rlistini
           ELSE
              MOVE High-Value TO rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-INITEND.
           IF DataSet1-rlistini-KEY-Asc
              MOVE High-Value TO rlis-chiave OF rlistini
           ELSE
              MOVE Low-Value TO rlis-chiave OF rlistini
           END-IF
           .

      * rlistini
       DataSet1-rlistini-START.
           IF DataSet1-rlistini-KEY-Asc
              START rlistini KEY >= rlis-chiave OF rlistini
           ELSE
              START rlistini KEY <= rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-START-NOTGREATER.
           IF DataSet1-rlistini-KEY-Asc
              START rlistini KEY <= rlis-chiave OF rlistini
           ELSE
              START rlistini KEY >= rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-START-GREATER.
           IF DataSet1-rlistini-KEY-Asc
              START rlistini KEY > rlis-chiave OF rlistini
           ELSE
              START rlistini KEY < rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-START-LESS.
           IF DataSet1-rlistini-KEY-Asc
              START rlistini KEY < rlis-chiave OF rlistini
           ELSE
              START rlistini KEY > rlis-chiave OF rlistini
           END-IF
           .

       DataSet1-rlistini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rlistini-LOCK
              READ rlistini WITH LOCK 
              KEY rlis-chiave OF rlistini
           ELSE
              READ rlistini WITH NO LOCK 
              KEY rlis-chiave OF rlistini
           END-IF
           PERFORM rlistini-rlis-k-art-MERGE-SPLITBUF
           PERFORM rlistini-rlis-k-descr-MERGE-SPLITBUF
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT 
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rlistini-KEY-Asc
              IF DataSet1-rlistini-LOCK
                 READ rlistini NEXT WITH LOCK
              ELSE
                 READ rlistini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rlistini-LOCK
                 READ rlistini PREVIOUS WITH LOCK
              ELSE
                 READ rlistini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rlistini-rlis-k-art-MERGE-SPLITBUF
           PERFORM rlistini-rlis-k-descr-MERGE-SPLITBUF
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rlistini-KEY-Asc
              IF DataSet1-rlistini-LOCK
                 READ rlistini PREVIOUS WITH LOCK
              ELSE
                 READ rlistini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rlistini-LOCK
                 READ rlistini NEXT WITH LOCK
              ELSE
                 READ rlistini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rlistini-rlis-k-art-MERGE-SPLITBUF
           PERFORM rlistini-rlis-k-descr-MERGE-SPLITBUF
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rlistini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rlistini TO TOTEM-ERR-STAT
           MOVE "rlistini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rlistini, AfterDelete>
      * <TOTEM:END>
           .

       tcaumag-k-mag-MERGE-SPLITBUF.
           INITIALIZE tcaumag-k-mag-SPLITBUF
           MOVE tca-cod-magaz(1:3) TO tcaumag-k-mag-SPLITBUF(1:3)
           MOVE tca-ord-forn(1:1) TO tcaumag-k-mag-SPLITBUF(4:1)
           .

       DataSet1-tcaumag-INITSTART.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE Low-Value TO tca-chiave
           ELSE
              MOVE High-Value TO tca-chiave
           END-IF
           .

       DataSet1-tcaumag-INITEND.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE High-Value TO tca-chiave
           ELSE
              MOVE Low-Value TO tca-chiave
           END-IF
           .

      * tcaumag
       DataSet1-tcaumag-START.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY >= tca-chiave
           ELSE
              START tcaumag KEY <= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-NOTGREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY <= tca-chiave
           ELSE
              START tcaumag KEY >= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-GREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY > tca-chiave
           ELSE
              START tcaumag KEY < tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-LESS.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY < tca-chiave
           ELSE
              START tcaumag KEY > tca-chiave
           END-IF
           .

       DataSet1-tcaumag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcaumag-LOCK
              READ tcaumag WITH LOCK 
              KEY tca-chiave
           ELSE
              READ tcaumag WITH NO LOCK 
              KEY tca-chiave
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT 
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmp-nordforn-INITSTART.
           IF DataSet1-tmp-nordforn-KEY-Asc
              MOVE Low-Value TO tmp-nof-chiave OF tmp-nordforn
           ELSE
              MOVE High-Value TO tmp-nof-chiave OF tmp-nordforn
           END-IF
           .

       DataSet1-tmp-nordforn-INITEND.
           IF DataSet1-tmp-nordforn-KEY-Asc
              MOVE High-Value TO tmp-nof-chiave OF tmp-nordforn
           ELSE
              MOVE Low-Value TO tmp-nof-chiave OF tmp-nordforn
           END-IF
           .

      * tmp-nordforn
       DataSet1-tmp-nordforn-START.
           IF DataSet1-tmp-nordforn-KEY-Asc
              START tmp-nordforn KEY >= tmp-nof-chiave OF tmp-nordforn
           ELSE
              START tmp-nordforn KEY <= tmp-nof-chiave OF tmp-nordforn
           END-IF
           .

       DataSet1-tmp-nordforn-START-NOTGREATER.
           IF DataSet1-tmp-nordforn-KEY-Asc
              START tmp-nordforn KEY <= tmp-nof-chiave OF tmp-nordforn
           ELSE
              START tmp-nordforn KEY >= tmp-nof-chiave OF tmp-nordforn
           END-IF
           .

       DataSet1-tmp-nordforn-START-GREATER.
           IF DataSet1-tmp-nordforn-KEY-Asc
              START tmp-nordforn KEY > tmp-nof-chiave OF tmp-nordforn
           ELSE
              START tmp-nordforn KEY < tmp-nof-chiave OF tmp-nordforn
           END-IF
           .

       DataSet1-tmp-nordforn-START-LESS.
           IF DataSet1-tmp-nordforn-KEY-Asc
              START tmp-nordforn KEY < tmp-nof-chiave OF tmp-nordforn
           ELSE
              START tmp-nordforn KEY > tmp-nof-chiave OF tmp-nordforn
           END-IF
           .

       DataSet1-tmp-nordforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmp-nordforn-LOCK
              READ tmp-nordforn WITH LOCK 
              KEY tmp-nof-chiave OF tmp-nordforn
           ELSE
              READ tmp-nordforn WITH NO LOCK 
              KEY tmp-nof-chiave OF tmp-nordforn
           END-IF
           MOVE STATUS-tmp-nordforn TO TOTEM-ERR-STAT 
           MOVE "tmp-nordforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-nordforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmp-nordforn-KEY-Asc
              IF DataSet1-tmp-nordforn-LOCK
                 READ tmp-nordforn NEXT WITH LOCK
              ELSE
                 READ tmp-nordforn NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmp-nordforn-LOCK
                 READ tmp-nordforn PREVIOUS WITH LOCK
              ELSE
                 READ tmp-nordforn PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmp-nordforn TO TOTEM-ERR-STAT
           MOVE "tmp-nordforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-nordforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmp-nordforn-KEY-Asc
              IF DataSet1-tmp-nordforn-LOCK
                 READ tmp-nordforn PREVIOUS WITH LOCK
              ELSE
                 READ tmp-nordforn PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmp-nordforn-LOCK
                 READ tmp-nordforn NEXT WITH LOCK
              ELSE
                 READ tmp-nordforn NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmp-nordforn TO TOTEM-ERR-STAT
           MOVE "tmp-nordforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-nordforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, BeforeWrite>
      * <TOTEM:END>
           WRITE tmp-nof-rec OF tmp-nordforn.
           MOVE STATUS-tmp-nordforn TO TOTEM-ERR-STAT
           MOVE "tmp-nordforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-nordforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, BeforeRewrite>
      * <TOTEM:END>
           REWRITE tmp-nof-rec OF tmp-nordforn.
           MOVE STATUS-tmp-nordforn TO TOTEM-ERR-STAT
           MOVE "tmp-nordforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-nordforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, BeforeDelete>
      * <TOTEM:END>
           DELETE tmp-nordforn.
           MOVE STATUS-tmp-nordforn TO TOTEM-ERR-STAT
           MOVE "tmp-nordforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-nordforn, AfterDelete>
      * <TOTEM:END>
           .

       clienti-cli-K1-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K1-SPLITBUF
           MOVE cli-tipo-CF OF clienti(1:1) TO 
           clienti-cli-K1-SPLITBUF(1:1)
           MOVE cli-ragsoc-1 OF clienti(1:40) TO 
           clienti-cli-K1-SPLITBUF(2:40)
           MOVE cli-codice OF clienti(1:5) TO 
           clienti-cli-K1-SPLITBUF(42:5)
           .

       clienti-cli-K3-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K3-SPLITBUF
           MOVE cli-gdo OF clienti(1:5) TO clienti-cli-K3-SPLITBUF(1:5)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K3-SPLITBUF(6:6)
           .

       clienti-cli-K4-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K4-SPLITBUF
           MOVE cli-utf OF clienti(1:1) TO clienti-cli-K4-SPLITBUF(1:1)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K4-SPLITBUF(2:6)
           .

       DataSet1-clienti-INITSTART.
           IF DataSet1-clienti-KEY-Asc
              MOVE Low-Value TO cli-chiave OF clienti
           ELSE
              MOVE High-Value TO cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-INITEND.
           IF DataSet1-clienti-KEY-Asc
              MOVE High-Value TO cli-chiave OF clienti
           ELSE
              MOVE Low-Value TO cli-chiave OF clienti
           END-IF
           .

      * clienti
       DataSet1-clienti-START.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY >= cli-chiave OF clienti
           ELSE
              START clienti KEY <= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-NOTGREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY <= cli-chiave OF clienti
           ELSE
              START clienti KEY >= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-GREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY > cli-chiave OF clienti
           ELSE
              START clienti KEY < cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-LESS.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY < cli-chiave OF clienti
           ELSE
              START clienti KEY > cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-clienti-LOCK
              READ clienti WITH LOCK 
              KEY cli-chiave OF clienti
           ELSE
              READ clienti WITH NO LOCK 
              KEY cli-chiave OF clienti
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT 
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeWrite>
      * <TOTEM:END>
           WRITE cli-rec OF clienti.
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRewrite>
      * <TOTEM:END>
           REWRITE cli-rec OF clienti.
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeDelete>
      * <TOTEM:END>
           DELETE clienti.
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterDelete>
      * <TOTEM:END>
           .

       clienti1-cli-K1-MERGE-SPLITBUF.
           INITIALIZE clienti1-cli-K1-SPLITBUF
           MOVE cli-tipo-CF OF clienti(1:1) TO 
           clienti1-cli-K1-SPLITBUF(1:1)
           MOVE cli-ragsoc-1 OF clienti(1:40) TO 
           clienti1-cli-K1-SPLITBUF(2:40)
           MOVE cli-codice OF clienti(1:5) TO 
           clienti1-cli-K1-SPLITBUF(42:5)
           .

       clienti1-cli-K3-MERGE-SPLITBUF.
           INITIALIZE clienti1-cli-K3-SPLITBUF
           MOVE cli-gdo OF clienti(1:5) TO clienti1-cli-K3-SPLITBUF(1:5)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti1-cli-K3-SPLITBUF(6:6)
           .

       clienti1-cli-K4-MERGE-SPLITBUF.
           INITIALIZE clienti1-cli-K4-SPLITBUF
           MOVE cli-utf OF clienti(1:1) TO clienti1-cli-K4-SPLITBUF(1:1)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti1-cli-K4-SPLITBUF(2:6)
           .

       DataSet1-clienti1-INITSTART.
           IF DataSet1-clienti1-KEY-Asc
              MOVE Low-Value TO cli-chiave OF clienti1
           ELSE
              MOVE High-Value TO cli-chiave OF clienti1
           END-IF
           .

       DataSet1-clienti1-INITEND.
           IF DataSet1-clienti1-KEY-Asc
              MOVE High-Value TO cli-chiave OF clienti1
           ELSE
              MOVE Low-Value TO cli-chiave OF clienti1
           END-IF
           .

      * clienti1
       DataSet1-clienti1-START.
           IF DataSet1-clienti1-KEY-Asc
              START clienti1 KEY >= cli-chiave OF clienti1
           ELSE
              START clienti1 KEY <= cli-chiave OF clienti1
           END-IF
           .

       DataSet1-clienti1-START-NOTGREATER.
           IF DataSet1-clienti1-KEY-Asc
              START clienti1 KEY <= cli-chiave OF clienti1
           ELSE
              START clienti1 KEY >= cli-chiave OF clienti1
           END-IF
           .

       DataSet1-clienti1-START-GREATER.
           IF DataSet1-clienti1-KEY-Asc
              START clienti1 KEY > cli-chiave OF clienti1
           ELSE
              START clienti1 KEY < cli-chiave OF clienti1
           END-IF
           .

       DataSet1-clienti1-START-LESS.
           IF DataSet1-clienti1-KEY-Asc
              START clienti1 KEY < cli-chiave OF clienti1
           ELSE
              START clienti1 KEY > cli-chiave OF clienti1
           END-IF
           .

       DataSet1-clienti1-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-clienti1-LOCK
              READ clienti1 WITH LOCK 
              KEY cli-chiave OF clienti1
           ELSE
              READ clienti1 WITH NO LOCK 
              KEY cli-chiave OF clienti1
           END-IF
           PERFORM clienti1-cli-K1-MERGE-SPLITBUF
           PERFORM clienti1-cli-K3-MERGE-SPLITBUF
           PERFORM clienti1-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti1 TO TOTEM-ERR-STAT 
           MOVE "clienti1" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-clienti1-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-clienti1-KEY-Asc
              IF DataSet1-clienti1-LOCK
                 READ clienti1 NEXT WITH LOCK
              ELSE
                 READ clienti1 NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti1-LOCK
                 READ clienti1 PREVIOUS WITH LOCK
              ELSE
                 READ clienti1 PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti1-cli-K1-MERGE-SPLITBUF
           PERFORM clienti1-cli-K3-MERGE-SPLITBUF
           PERFORM clienti1-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti1 TO TOTEM-ERR-STAT
           MOVE "clienti1" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-clienti1-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-clienti1-KEY-Asc
              IF DataSet1-clienti1-LOCK
                 READ clienti1 PREVIOUS WITH LOCK
              ELSE
                 READ clienti1 PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti1-LOCK
                 READ clienti1 NEXT WITH LOCK
              ELSE
                 READ clienti1 NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti1-cli-K1-MERGE-SPLITBUF
           PERFORM clienti1-cli-K3-MERGE-SPLITBUF
           PERFORM clienti1-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti1 TO TOTEM-ERR-STAT
           MOVE "clienti1" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-clienti1-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-clienti1 TO TOTEM-ERR-STAT
           MOVE "clienti1" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-clienti1-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-clienti1 TO TOTEM-ERR-STAT
           MOVE "clienti1" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-clienti1-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-clienti1 TO TOTEM-ERR-STAT
           MOVE "clienti1" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti1, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-lockfile-INITSTART.
           IF DataSet1-lockfile-KEY-Asc
              MOVE Low-Value TO lck-chiave
           ELSE
              MOVE High-Value TO lck-chiave
           END-IF
           .

       DataSet1-lockfile-INITEND.
           IF DataSet1-lockfile-KEY-Asc
              MOVE High-Value TO lck-chiave
           ELSE
              MOVE Low-Value TO lck-chiave
           END-IF
           .

      * lockfile
       DataSet1-lockfile-START.
           IF DataSet1-lockfile-KEY-Asc
              START lockfile KEY >= lck-chiave
           ELSE
              START lockfile KEY <= lck-chiave
           END-IF
           .

       DataSet1-lockfile-START-NOTGREATER.
           IF DataSet1-lockfile-KEY-Asc
              START lockfile KEY <= lck-chiave
           ELSE
              START lockfile KEY >= lck-chiave
           END-IF
           .

       DataSet1-lockfile-START-GREATER.
           IF DataSet1-lockfile-KEY-Asc
              START lockfile KEY > lck-chiave
           ELSE
              START lockfile KEY < lck-chiave
           END-IF
           .

       DataSet1-lockfile-START-LESS.
           IF DataSet1-lockfile-KEY-Asc
              START lockfile KEY < lck-chiave
           ELSE
              START lockfile KEY > lck-chiave
           END-IF
           .

       DataSet1-lockfile-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-lockfile-LOCK
              READ lockfile WITH LOCK 
              KEY lck-chiave
           ELSE
              READ lockfile WITH NO LOCK 
              KEY lck-chiave
           END-IF
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT 
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-lockfile-KEY-Asc
              IF DataSet1-lockfile-LOCK
                 READ lockfile NEXT WITH LOCK
              ELSE
                 READ lockfile NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-lockfile-LOCK
                 READ lockfile PREVIOUS WITH LOCK
              ELSE
                 READ lockfile PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-lockfile-KEY-Asc
              IF DataSet1-lockfile-LOCK
                 READ lockfile PREVIOUS WITH LOCK
              ELSE
                 READ lockfile PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-lockfile-LOCK
                 READ lockfile NEXT WITH LOCK
              ELSE
                 READ lockfile NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeWrite>
      * <TOTEM:END>
           WRITE lck-rec OF lockfile.
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeRewrite>
      * <TOTEM:END>
           REWRITE lck-rec OF lockfile.
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-lockfile-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, BeforeDelete>
      * <TOTEM:END>
           DELETE lockfile.
           MOVE STATUS-lockfile TO TOTEM-ERR-STAT
           MOVE "lockfile" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lockfile, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-art-ordforn-INITSTART.
           IF DataSet1-art-ordforn-KEY-Asc
              MOVE Low-Value TO aor-chiave
           ELSE
              MOVE High-Value TO aor-chiave
           END-IF
           .

       DataSet1-art-ordforn-INITEND.
           IF DataSet1-art-ordforn-KEY-Asc
              MOVE High-Value TO aor-chiave
           ELSE
              MOVE Low-Value TO aor-chiave
           END-IF
           .

      * art-ordforn
       DataSet1-art-ordforn-START.
           IF DataSet1-art-ordforn-KEY-Asc
              START art-ordforn KEY >= aor-chiave
           ELSE
              START art-ordforn KEY <= aor-chiave
           END-IF
           .

       DataSet1-art-ordforn-START-NOTGREATER.
           IF DataSet1-art-ordforn-KEY-Asc
              START art-ordforn KEY <= aor-chiave
           ELSE
              START art-ordforn KEY >= aor-chiave
           END-IF
           .

       DataSet1-art-ordforn-START-GREATER.
           IF DataSet1-art-ordforn-KEY-Asc
              START art-ordforn KEY > aor-chiave
           ELSE
              START art-ordforn KEY < aor-chiave
           END-IF
           .

       DataSet1-art-ordforn-START-LESS.
           IF DataSet1-art-ordforn-KEY-Asc
              START art-ordforn KEY < aor-chiave
           ELSE
              START art-ordforn KEY > aor-chiave
           END-IF
           .

       DataSet1-art-ordforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-art-ordforn-LOCK
              READ art-ordforn WITH LOCK 
              KEY aor-chiave
           ELSE
              READ art-ordforn WITH NO LOCK 
              KEY aor-chiave
           END-IF
           MOVE STATUS-art-ordforn TO TOTEM-ERR-STAT 
           MOVE "art-ordforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-art-ordforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-art-ordforn-KEY-Asc
              IF DataSet1-art-ordforn-LOCK
                 READ art-ordforn NEXT WITH LOCK
              ELSE
                 READ art-ordforn NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-art-ordforn-LOCK
                 READ art-ordforn PREVIOUS WITH LOCK
              ELSE
                 READ art-ordforn PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-art-ordforn TO TOTEM-ERR-STAT
           MOVE "art-ordforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-art-ordforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-art-ordforn-KEY-Asc
              IF DataSet1-art-ordforn-LOCK
                 READ art-ordforn PREVIOUS WITH LOCK
              ELSE
                 READ art-ordforn PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-art-ordforn-LOCK
                 READ art-ordforn NEXT WITH LOCK
              ELSE
                 READ art-ordforn NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-art-ordforn TO TOTEM-ERR-STAT
           MOVE "art-ordforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-art-ordforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, BeforeWrite>
      * <TOTEM:END>
           WRITE aor-rec OF art-ordforn.
           MOVE STATUS-art-ordforn TO TOTEM-ERR-STAT
           MOVE "art-ordforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-art-ordforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, BeforeRewrite>
      * <TOTEM:END>
           REWRITE aor-rec OF art-ordforn.
           MOVE STATUS-art-ordforn TO TOTEM-ERR-STAT
           MOVE "art-ordforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-art-ordforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, BeforeDelete>
      * <TOTEM:END>
           DELETE art-ordforn.
           MOVE STATUS-art-ordforn TO TOTEM-ERR-STAT
           MOVE "art-ordforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:art-ordforn, AfterDelete>
      * <TOTEM:END>
           .

       destinif-K1-MERGE-SPLITBUF.
           INITIALIZE destinif-K1-SPLITBUF
           MOVE desf-ragsoc-1(1:40) TO destinif-K1-SPLITBUF(1:40)
           MOVE desf-codice(1:5) TO destinif-K1-SPLITBUF(41:5)
           MOVE desf-prog(1:5) TO destinif-K1-SPLITBUF(46:5)
           .

       destinif-desf-k2-MERGE-SPLITBUF.
           INITIALIZE destinif-desf-k2-SPLITBUF
           MOVE desf-codice(1:5) TO destinif-desf-k2-SPLITBUF(1:5)
           MOVE desf-ragsoc-1(1:40) TO destinif-desf-k2-SPLITBUF(6:40)
           MOVE desf-prog(1:5) TO destinif-desf-k2-SPLITBUF(46:5)
           .

       DataSet1-destinif-INITSTART.
           IF DataSet1-destinif-KEY-Asc
              MOVE Low-Value TO desf-chiave
           ELSE
              MOVE High-Value TO desf-chiave
           END-IF
           .

       DataSet1-destinif-INITEND.
           IF DataSet1-destinif-KEY-Asc
              MOVE High-Value TO desf-chiave
           ELSE
              MOVE Low-Value TO desf-chiave
           END-IF
           .

      * destinif
       DataSet1-destinif-START.
           IF DataSet1-destinif-KEY-Asc
              START destinif KEY >= desf-chiave
           ELSE
              START destinif KEY <= desf-chiave
           END-IF
           .

       DataSet1-destinif-START-NOTGREATER.
           IF DataSet1-destinif-KEY-Asc
              START destinif KEY <= desf-chiave
           ELSE
              START destinif KEY >= desf-chiave
           END-IF
           .

       DataSet1-destinif-START-GREATER.
           IF DataSet1-destinif-KEY-Asc
              START destinif KEY > desf-chiave
           ELSE
              START destinif KEY < desf-chiave
           END-IF
           .

       DataSet1-destinif-START-LESS.
           IF DataSet1-destinif-KEY-Asc
              START destinif KEY < desf-chiave
           ELSE
              START destinif KEY > desf-chiave
           END-IF
           .

       DataSet1-destinif-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-destinif-LOCK
              READ destinif WITH LOCK 
              KEY desf-chiave
           ELSE
              READ destinif WITH NO LOCK 
              KEY desf-chiave
           END-IF
           PERFORM destinif-K1-MERGE-SPLITBUF
           PERFORM destinif-desf-k2-MERGE-SPLITBUF
           MOVE STATUS-destinif TO TOTEM-ERR-STAT 
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-destinif-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-destinif-KEY-Asc
              IF DataSet1-destinif-LOCK
                 READ destinif NEXT WITH LOCK
              ELSE
                 READ destinif NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destinif-LOCK
                 READ destinif PREVIOUS WITH LOCK
              ELSE
                 READ destinif PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM destinif-K1-MERGE-SPLITBUF
           PERFORM destinif-desf-k2-MERGE-SPLITBUF
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-destinif-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-destinif-KEY-Asc
              IF DataSet1-destinif-LOCK
                 READ destinif PREVIOUS WITH LOCK
              ELSE
                 READ destinif PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destinif-LOCK
                 READ destinif NEXT WITH LOCK
              ELSE
                 READ destinif NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM destinif-K1-MERGE-SPLITBUF
           PERFORM destinif-desf-k2-MERGE-SPLITBUF
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-destinif-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeWrite>
      * <TOTEM:END>
           WRITE desf-rec OF destinif.
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-destinif-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeRewrite>
      * <TOTEM:END>
           REWRITE desf-rec OF destinif.
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-destinif-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, BeforeDelete>
      * <TOTEM:END>
           DELETE destinif.
           MOVE STATUS-destinif TO TOTEM-ERR-STAT
           MOVE "destinif" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destinif, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-impforn-INITSTART.
           IF DataSet1-impforn-KEY-Asc
              MOVE Low-Value TO imf-chiave OF impforn
           ELSE
              MOVE High-Value TO imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-INITEND.
           IF DataSet1-impforn-KEY-Asc
              MOVE High-Value TO imf-chiave OF impforn
           ELSE
              MOVE Low-Value TO imf-chiave OF impforn
           END-IF
           .

      * impforn
       DataSet1-impforn-START.
           IF DataSet1-impforn-KEY-Asc
              START impforn KEY >= imf-chiave OF impforn
           ELSE
              START impforn KEY <= imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-START-NOTGREATER.
           IF DataSet1-impforn-KEY-Asc
              START impforn KEY <= imf-chiave OF impforn
           ELSE
              START impforn KEY >= imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-START-GREATER.
           IF DataSet1-impforn-KEY-Asc
              START impforn KEY > imf-chiave OF impforn
           ELSE
              START impforn KEY < imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-START-LESS.
           IF DataSet1-impforn-KEY-Asc
              START impforn KEY < imf-chiave OF impforn
           ELSE
              START impforn KEY > imf-chiave OF impforn
           END-IF
           .

       DataSet1-impforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-impforn-LOCK
              READ impforn WITH LOCK 
              KEY imf-chiave OF impforn
           ELSE
              READ impforn WITH NO LOCK 
              KEY imf-chiave OF impforn
           END-IF
           MOVE STATUS-impforn TO TOTEM-ERR-STAT 
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-impforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-impforn-KEY-Asc
              IF DataSet1-impforn-LOCK
                 READ impforn NEXT WITH LOCK
              ELSE
                 READ impforn NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-impforn-LOCK
                 READ impforn PREVIOUS WITH LOCK
              ELSE
                 READ impforn PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-impforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-impforn-KEY-Asc
              IF DataSet1-impforn-LOCK
                 READ impforn PREVIOUS WITH LOCK
              ELSE
                 READ impforn PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-impforn-LOCK
                 READ impforn NEXT WITH LOCK
              ELSE
                 READ impforn NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-impforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-impforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-impforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-impforn TO TOTEM-ERR-STAT
           MOVE "impforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:impforn, AfterDelete>
      * <TOTEM:END>
           .

       rordforn-rof-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rordforn-rof-k-articolo-SPLITBUF
           MOVE rof-cod-articolo OF rordforn(1:6) TO 
           rordforn-rof-k-articolo-SPLITBUF(1:6)
           MOVE rof-chiave OF rordforn(1:17) TO 
           rordforn-rof-k-articolo-SPLITBUF(7:17)
           .

       rordforn-rof-k-art-mag-MERGE-SPLITBUF.
           INITIALIZE rordforn-rof-k-art-mag-SPLITBUF
           MOVE rof-cod-articolo OF rordforn(1:6) TO 
           rordforn-rof-k-art-mag-SPLITBUF(1:6)
           MOVE rof-cod-magazzino OF rordforn(1:3) TO 
           rordforn-rof-k-art-mag-SPLITBUF(7:3)
           MOVE rof-chiave OF rordforn(1:17) TO 
           rordforn-rof-k-art-mag-SPLITBUF(10:17)
           .

       DataSet1-rordforn-INITSTART.
           IF DataSet1-rordforn-KEY-Asc
              MOVE Low-Value TO rof-chiave of rordforn
           ELSE
              MOVE High-Value TO rof-chiave of rordforn
           END-IF
           .

       DataSet1-rordforn-INITEND.
           IF DataSet1-rordforn-KEY-Asc
              MOVE High-Value TO rof-chiave of rordforn
           ELSE
              MOVE Low-Value TO rof-chiave of rordforn
           END-IF
           .

      * rordforn
       DataSet1-rordforn-START.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY >= rof-chiave of rordforn
           ELSE
              START rordforn KEY <= rof-chiave of rordforn
           END-IF
           .

       DataSet1-rordforn-START-NOTGREATER.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY <= rof-chiave of rordforn
           ELSE
              START rordforn KEY >= rof-chiave of rordforn
           END-IF
           .

       DataSet1-rordforn-START-GREATER.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY > rof-chiave of rordforn
           ELSE
              START rordforn KEY < rof-chiave of rordforn
           END-IF
           .

       DataSet1-rordforn-START-LESS.
           IF DataSet1-rordforn-KEY-Asc
              START rordforn KEY < rof-chiave of rordforn
           ELSE
              START rordforn KEY > rof-chiave of rordforn
           END-IF
           .

       DataSet1-rordforn-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rordforn-LOCK
              READ rordforn WITH LOCK 
              KEY rof-chiave of rordforn
           ELSE
              READ rordforn WITH NO LOCK 
              KEY rof-chiave of rordforn
           END-IF
           PERFORM rordforn-rof-k-articolo-MERGE-SPLITBUF
           PERFORM rordforn-rof-k-art-mag-MERGE-SPLITBUF
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT 
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rordforn-KEY-Asc
              IF DataSet1-rordforn-LOCK
                 READ rordforn NEXT WITH LOCK
              ELSE
                 READ rordforn NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordforn-LOCK
                 READ rordforn PREVIOUS WITH LOCK
              ELSE
                 READ rordforn PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordforn-rof-k-articolo-MERGE-SPLITBUF
           PERFORM rordforn-rof-k-art-mag-MERGE-SPLITBUF
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rordforn-KEY-Asc
              IF DataSet1-rordforn-LOCK
                 READ rordforn PREVIOUS WITH LOCK
              ELSE
                 READ rordforn PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordforn-LOCK
                 READ rordforn NEXT WITH LOCK
              ELSE
                 READ rordforn NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordforn-rof-k-articolo-MERGE-SPLITBUF
           PERFORM rordforn-rof-k-art-mag-MERGE-SPLITBUF
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeWrite>
      * <TOTEM:END>
           WRITE rof-rec OF rordforn.
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeRewrite>
      * <TOTEM:END>
           REWRITE rof-rec OF rordforn.
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rordforn-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, BeforeDelete>
      * <TOTEM:END>
           DELETE rordforn.
           MOVE STATUS-rordforn TO TOTEM-ERR-STAT
           MOVE "rordforn" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordforn, AfterDelete>
      * <TOTEM:END>
           .

       destini-K1-MERGE-SPLITBUF.
           INITIALIZE destini-K1-SPLITBUF
           MOVE des-ragsoc-1(1:100) TO destini-K1-SPLITBUF(1:100)
           MOVE des-codice(1:5) TO destini-K1-SPLITBUF(101:5)
           MOVE des-prog(1:5) TO destini-K1-SPLITBUF(106:5)
           .

       destini-k-localita-MERGE-SPLITBUF.
           INITIALIZE destini-k-localita-SPLITBUF
           MOVE des-localita(1:35) TO destini-k-localita-SPLITBUF(1:35)
           .

       DataSet1-destini-INITSTART.
           IF DataSet1-destini-KEY-Asc
              MOVE Low-Value TO des-chiave
           ELSE
              MOVE High-Value TO des-chiave
           END-IF
           .

       DataSet1-destini-INITEND.
           IF DataSet1-destini-KEY-Asc
              MOVE High-Value TO des-chiave
           ELSE
              MOVE Low-Value TO des-chiave
           END-IF
           .

      * destini
       DataSet1-destini-START.
           IF DataSet1-destini-KEY-Asc
              START destini KEY >= des-chiave
           ELSE
              START destini KEY <= des-chiave
           END-IF
           .

       DataSet1-destini-START-NOTGREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY <= des-chiave
           ELSE
              START destini KEY >= des-chiave
           END-IF
           .

       DataSet1-destini-START-GREATER.
           IF DataSet1-destini-KEY-Asc
              START destini KEY > des-chiave
           ELSE
              START destini KEY < des-chiave
           END-IF
           .

       DataSet1-destini-START-LESS.
           IF DataSet1-destini-KEY-Asc
              START destini KEY < des-chiave
           ELSE
              START destini KEY > des-chiave
           END-IF
           .

       DataSet1-destini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-destini-LOCK
              READ destini WITH LOCK 
              KEY des-chiave
           ELSE
              READ destini WITH NO LOCK 
              KEY des-chiave
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT 
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-destini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-destini-KEY-Asc
              IF DataSet1-destini-LOCK
                 READ destini PREVIOUS WITH LOCK
              ELSE
                 READ destini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-destini-LOCK
                 READ destini NEXT WITH LOCK
              ELSE
                 READ destini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM destini-K1-MERGE-SPLITBUF
           PERFORM destini-k-localita-MERGE-SPLITBUF
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-destini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:destini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-destini TO TOTEM-ERR-STAT
           MOVE "destini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:destini, AfterDelete>
      * <TOTEM:END>
           .

       tpromo-tpr-chiave-ricerca-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-ricerca-SPLITBUF
           MOVE tpr-chiave-ricerca OF tpromo(1:21) TO 
           tpromo-tpr-chiave-ricerca-SPLITBUF(1:21)
           .

       tpromo-tpr-chiave-gdo-fine-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-gdo-fine-SPLITBUF
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-chiave-gdo-fine-SPLITBUF(1:5)
           MOVE tpr-fine-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-gdo-fine-SPLITBUF(6:8)
           MOVE tpr-ini-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-gdo-fine-SPLITBUF(14:8)
           .

       tpromo-tpr-chiave-fine-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-fine-SPLITBUF
           MOVE tpr-fine-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-fine-SPLITBUF(1:8)
           MOVE tpr-ini-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-fine-SPLITBUF(9:8)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-chiave-fine-SPLITBUF(17:5)
           .

       tpromo-tpr-chiave-ini-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-ini-SPLITBUF
           MOVE tpr-ini-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-ini-SPLITBUF(1:8)
           MOVE tpr-fine-dpo OF tpromo(1:8) TO 
           tpromo-tpr-chiave-ini-SPLITBUF(9:8)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-chiave-ini-SPLITBUF(17:5)
           .

       tpromo-tpr-chiave-volantino-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-chiave-volantino-SPLITBUF
           MOVE tpr-ini-volantino OF tpromo(1:8) TO 
           tpromo-tpr-chiave-volantino-SPLITBUF(1:8)
           MOVE tpr-fine-volantino OF tpromo(1:8) TO 
           tpromo-tpr-chiave-volantino-SPLITBUF(9:8)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-chiave-volantino-SPLITBUF(17:5)
           .

       tpromo-tpr-k-fine-vol-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-k-fine-vol-SPLITBUF
           MOVE tpr-fine-volantino OF tpromo(1:8) TO 
           tpromo-tpr-k-fine-vol-SPLITBUF(1:8)
           MOVE tpr-ini-volantino OF tpromo(1:8) TO 
           tpromo-tpr-k-fine-vol-SPLITBUF(9:8)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-k-fine-vol-SPLITBUF(17:5)
           .

       tpromo-tpr-k-data-ins-MERGE-SPLITBUF.
           INITIALIZE tpromo-tpr-k-data-ins-SPLITBUF
           MOVE tpr-data-creazione OF tpromo(1:8) TO 
           tpromo-tpr-k-data-ins-SPLITBUF(1:8)
           MOVE tpr-codice OF tpromo(1:15) TO 
           tpromo-tpr-k-data-ins-SPLITBUF(9:15)
           MOVE tpr-gdo OF tpromo(1:5) TO 
           tpromo-tpr-k-data-ins-SPLITBUF(24:5)
           .

       DataSet1-tpromo-INITSTART.
           IF DataSet1-tpromo-KEY-Asc
              MOVE Low-Value TO tpr-chiave OF tpromo
           ELSE
              MOVE High-Value TO tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-INITEND.
           IF DataSet1-tpromo-KEY-Asc
              MOVE High-Value TO tpr-chiave OF tpromo
           ELSE
              MOVE Low-Value TO tpr-chiave OF tpromo
           END-IF
           .

      * tpromo
       DataSet1-tpromo-START.
           IF DataSet1-tpromo-KEY-Asc
              START tpromo KEY >= tpr-chiave OF tpromo
           ELSE
              START tpromo KEY <= tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-START-NOTGREATER.
           IF DataSet1-tpromo-KEY-Asc
              START tpromo KEY <= tpr-chiave OF tpromo
           ELSE
              START tpromo KEY >= tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-START-GREATER.
           IF DataSet1-tpromo-KEY-Asc
              START tpromo KEY > tpr-chiave OF tpromo
           ELSE
              START tpromo KEY < tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-START-LESS.
           IF DataSet1-tpromo-KEY-Asc
              START tpromo KEY < tpr-chiave OF tpromo
           ELSE
              START tpromo KEY > tpr-chiave OF tpromo
           END-IF
           .

       DataSet1-tpromo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tpromo-LOCK
              READ tpromo WITH LOCK 
              KEY tpr-chiave OF tpromo
           ELSE
              READ tpromo WITH NO LOCK 
              KEY tpr-chiave OF tpromo
           END-IF
           PERFORM tpromo-tpr-chiave-ricerca-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-ini-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-volantino-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-fine-vol-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-data-ins-MERGE-SPLITBUF
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT 
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tpromo-KEY-Asc
              IF DataSet1-tpromo-LOCK
                 READ tpromo NEXT WITH LOCK
              ELSE
                 READ tpromo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpromo-LOCK
                 READ tpromo PREVIOUS WITH LOCK
              ELSE
                 READ tpromo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tpromo-tpr-chiave-ricerca-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-ini-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-volantino-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-fine-vol-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-data-ins-MERGE-SPLITBUF
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tpromo-KEY-Asc
              IF DataSet1-tpromo-LOCK
                 READ tpromo PREVIOUS WITH LOCK
              ELSE
                 READ tpromo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tpromo-LOCK
                 READ tpromo NEXT WITH LOCK
              ELSE
                 READ tpromo NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tpromo-tpr-chiave-ricerca-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-gdo-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-fine-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-ini-MERGE-SPLITBUF
           PERFORM tpromo-tpr-chiave-volantino-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-fine-vol-MERGE-SPLITBUF
           PERFORM tpromo-tpr-k-data-ins-MERGE-SPLITBUF
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tpromo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tpromo TO TOTEM-ERR-STAT
           MOVE "tpromo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tpromo, AfterDelete>
      * <TOTEM:END>
           .

       tmp-tpromo-zoom-tmp-tpr-z-k1-MERGE-SPLITBUF.
           INITIALIZE tmp-tpromo-zoom-tmp-tpr-z-k1-SPLITBUF
           MOVE tmp-tpr-z-gdo OF tmp-tpromo-zoom(1:5) TO 
           tmp-tpromo-zoom-tmp-tpr-z-k1-SPLITBUF(1:5)
           MOVE tmp-tpr-z-ini-volantino OF tmp-tpromo-zoom(1:8) TO 
           tmp-tpromo-zoom-tmp-tpr-z-k1-SPLITBUF(6:8)
           .

       DataSet1-tmp-tpromo-zoom-INITSTART.
           IF DataSet1-tmp-tpromo-zoom-KEY-Asc
              MOVE Low-Value TO tmp-tpr-chiave OF tmp-tpromo-zoom
           ELSE
              MOVE High-Value TO tmp-tpr-chiave OF tmp-tpromo-zoom
           END-IF
           .

       DataSet1-tmp-tpromo-zoom-INITEND.
           IF DataSet1-tmp-tpromo-zoom-KEY-Asc
              MOVE High-Value TO tmp-tpr-chiave OF tmp-tpromo-zoom
           ELSE
              MOVE Low-Value TO tmp-tpr-chiave OF tmp-tpromo-zoom
           END-IF
           .

      * tmp-tpromo-zoom
       DataSet1-tmp-tpromo-zoom-START.
           IF DataSet1-tmp-tpromo-zoom-KEY-Asc
              START tmp-tpromo-zoom KEY >= tmp-tpr-chiave OF 
           tmp-tpromo-zoom
           ELSE
              START tmp-tpromo-zoom KEY <= tmp-tpr-chiave OF 
           tmp-tpromo-zoom
           END-IF
           .

       DataSet1-tmp-tpromo-zoom-START-NOTGREATER.
           IF DataSet1-tmp-tpromo-zoom-KEY-Asc
              START tmp-tpromo-zoom KEY <= tmp-tpr-chiave OF 
           tmp-tpromo-zoom
           ELSE
              START tmp-tpromo-zoom KEY >= tmp-tpr-chiave OF 
           tmp-tpromo-zoom
           END-IF
           .

       DataSet1-tmp-tpromo-zoom-START-GREATER.
           IF DataSet1-tmp-tpromo-zoom-KEY-Asc
              START tmp-tpromo-zoom KEY > tmp-tpr-chiave OF 
           tmp-tpromo-zoom
           ELSE
              START tmp-tpromo-zoom KEY < tmp-tpr-chiave OF 
           tmp-tpromo-zoom
           END-IF
           .

       DataSet1-tmp-tpromo-zoom-START-LESS.
           IF DataSet1-tmp-tpromo-zoom-KEY-Asc
              START tmp-tpromo-zoom KEY < tmp-tpr-chiave OF 
           tmp-tpromo-zoom
           ELSE
              START tmp-tpromo-zoom KEY > tmp-tpr-chiave OF 
           tmp-tpromo-zoom
           END-IF
           .

       DataSet1-tmp-tpromo-zoom-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmp-tpromo-zoom-LOCK
              READ tmp-tpromo-zoom WITH LOCK 
              KEY tmp-tpr-chiave OF tmp-tpromo-zoom
           ELSE
              READ tmp-tpromo-zoom WITH NO LOCK 
              KEY tmp-tpr-chiave OF tmp-tpromo-zoom
           END-IF
           PERFORM tmp-tpromo-zoom-tmp-tpr-z-k1-MERGE-SPLITBUF
           MOVE STATUS-tmp-tpromo-zoom TO TOTEM-ERR-STAT 
           MOVE "tmp-tpromo-zoom" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-tpromo-zoom-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmp-tpromo-zoom-KEY-Asc
              IF DataSet1-tmp-tpromo-zoom-LOCK
                 READ tmp-tpromo-zoom NEXT WITH LOCK
              ELSE
                 READ tmp-tpromo-zoom NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmp-tpromo-zoom-LOCK
                 READ tmp-tpromo-zoom PREVIOUS WITH LOCK
              ELSE
                 READ tmp-tpromo-zoom PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tmp-tpromo-zoom-tmp-tpr-z-k1-MERGE-SPLITBUF
           MOVE STATUS-tmp-tpromo-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-tpromo-zoom" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-tpromo-zoom-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmp-tpromo-zoom-KEY-Asc
              IF DataSet1-tmp-tpromo-zoom-LOCK
                 READ tmp-tpromo-zoom PREVIOUS WITH LOCK
              ELSE
                 READ tmp-tpromo-zoom PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmp-tpromo-zoom-LOCK
                 READ tmp-tpromo-zoom NEXT WITH LOCK
              ELSE
                 READ tmp-tpromo-zoom NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tmp-tpromo-zoom-tmp-tpr-z-k1-MERGE-SPLITBUF
           MOVE STATUS-tmp-tpromo-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-tpromo-zoom" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-tpromo-zoom-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, BeforeWrite>
      * <TOTEM:END>
           WRITE tmp-tpr-z-rec OF tmp-tpromo-zoom.
           MOVE STATUS-tmp-tpromo-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-tpromo-zoom" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-tpromo-zoom-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, BeforeRewrite>
      * <TOTEM:END>
           REWRITE tmp-tpr-z-rec OF tmp-tpromo-zoom.
           MOVE STATUS-tmp-tpromo-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-tpromo-zoom" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-tpromo-zoom-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, BeforeDelete>
      * <TOTEM:END>
           DELETE tmp-tpromo-zoom.
           MOVE STATUS-tmp-tpromo-zoom TO TOTEM-ERR-STAT
           MOVE "tmp-tpromo-zoom" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-tpromo-zoom, AfterDelete>
      * <TOTEM:END>
           .

       tgrupgdo-gdo-k-g2-MERGE-SPLITBUF.
           INITIALIZE tgrupgdo-gdo-k-g2-SPLITBUF
           MOVE gdo-codice-G2 OF tgrupgdo(1:3) TO 
           tgrupgdo-gdo-k-g2-SPLITBUF(1:3)
           MOVE gdo-chiave OF tgrupgdo(1:5) TO 
           tgrupgdo-gdo-k-g2-SPLITBUF(4:5)
           .

       DataSet1-tgrupgdo-INITSTART.
           IF DataSet1-tgrupgdo-KEY-Asc
              MOVE Low-Value TO gdo-chiave OF tgrupgdo
           ELSE
              MOVE High-Value TO gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-INITEND.
           IF DataSet1-tgrupgdo-KEY-Asc
              MOVE High-Value TO gdo-chiave OF tgrupgdo
           ELSE
              MOVE Low-Value TO gdo-chiave OF tgrupgdo
           END-IF
           .

      * tgrupgdo
       DataSet1-tgrupgdo-START.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY >= gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY <= gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-START-NOTGREATER.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY <= gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY >= gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-START-GREATER.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY > gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY < gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-START-LESS.
           IF DataSet1-tgrupgdo-KEY-Asc
              START tgrupgdo KEY < gdo-chiave OF tgrupgdo
           ELSE
              START tgrupgdo KEY > gdo-chiave OF tgrupgdo
           END-IF
           .

       DataSet1-tgrupgdo-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tgrupgdo-LOCK
              READ tgrupgdo WITH LOCK 
              KEY gdo-chiave OF tgrupgdo
           ELSE
              READ tgrupgdo WITH NO LOCK 
              KEY gdo-chiave OF tgrupgdo
           END-IF
           PERFORM tgrupgdo-gdo-k-g2-MERGE-SPLITBUF
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT 
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tgrupgdo-KEY-Asc
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo NEXT WITH LOCK
              ELSE
                 READ tgrupgdo NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo PREVIOUS WITH LOCK
              ELSE
                 READ tgrupgdo PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tgrupgdo-gdo-k-g2-MERGE-SPLITBUF
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tgrupgdo-KEY-Asc
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo PREVIOUS WITH LOCK
              ELSE
                 READ tgrupgdo PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tgrupgdo-LOCK
                 READ tgrupgdo NEXT WITH LOCK
              ELSE
                 READ tgrupgdo NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tgrupgdo-gdo-k-g2-MERGE-SPLITBUF
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tgrupgdo-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tgrupgdo TO TOTEM-ERR-STAT
           MOVE "tgrupgdo" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tgrupgdo, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-INITSTART.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE Low-Value TO mag-chiave
           ELSE
              MOVE High-Value TO mag-chiave
           END-IF
           .

       DataSet1-tmagaz-INITEND.
           IF DataSet1-tmagaz-KEY-Asc
              MOVE High-Value TO mag-chiave
           ELSE
              MOVE Low-Value TO mag-chiave
           END-IF
           .

      * tmagaz
       DataSet1-tmagaz-START.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY >= mag-chiave
           ELSE
              START tmagaz KEY <= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-NOTGREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY <= mag-chiave
           ELSE
              START tmagaz KEY >= mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-GREATER.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY > mag-chiave
           ELSE
              START tmagaz KEY < mag-chiave
           END-IF
           .

       DataSet1-tmagaz-START-LESS.
           IF DataSet1-tmagaz-KEY-Asc
              START tmagaz KEY < mag-chiave
           ELSE
              START tmagaz KEY > mag-chiave
           END-IF
           .

       DataSet1-tmagaz-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tmagaz-LOCK
              READ tmagaz WITH LOCK 
              KEY mag-chiave
           ELSE
              READ tmagaz WITH NO LOCK 
              KEY mag-chiave
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT 
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tmagaz-KEY-Asc
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz PREVIOUS WITH LOCK
              ELSE
                 READ tmagaz PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tmagaz-LOCK
                 READ tmagaz NEXT WITH LOCK
              ELSE
                 READ tmagaz NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmagaz-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmagaz TO TOTEM-ERR-STAT
           MOVE "tmagaz" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmagaz, AfterDelete>
      * <TOTEM:END>
           .

       distinteb-k-articolo-MERGE-SPLITBUF.
           INITIALIZE distinteb-k-articolo-SPLITBUF
           MOVE dis-articolo-finale(1:6) TO 
           distinteb-k-articolo-SPLITBUF(1:6)
           MOVE dis-chiave(1:5) TO distinteb-k-articolo-SPLITBUF(7:5)
           .

       distinteb-k-progmag-MERGE-SPLITBUF.
           INITIALIZE distinteb-k-progmag-SPLITBUF
           MOVE dis-chiave-progmag(1:20) TO 
           distinteb-k-progmag-SPLITBUF(1:20)
           .

       DataSet1-distinteb-INITSTART.
           IF DataSet1-distinteb-KEY-Asc
              MOVE Low-Value TO dis-chiave
           ELSE
              MOVE High-Value TO dis-chiave
           END-IF
           .

       DataSet1-distinteb-INITEND.
           IF DataSet1-distinteb-KEY-Asc
              MOVE High-Value TO dis-chiave
           ELSE
              MOVE Low-Value TO dis-chiave
           END-IF
           .

      * distinteb
       DataSet1-distinteb-START.
           IF DataSet1-distinteb-KEY-Asc
              START distinteb KEY >= dis-chiave
           ELSE
              START distinteb KEY <= dis-chiave
           END-IF
           .

       DataSet1-distinteb-START-NOTGREATER.
           IF DataSet1-distinteb-KEY-Asc
              START distinteb KEY <= dis-chiave
           ELSE
              START distinteb KEY >= dis-chiave
           END-IF
           .

       DataSet1-distinteb-START-GREATER.
           IF DataSet1-distinteb-KEY-Asc
              START distinteb KEY > dis-chiave
           ELSE
              START distinteb KEY < dis-chiave
           END-IF
           .

       DataSet1-distinteb-START-LESS.
           IF DataSet1-distinteb-KEY-Asc
              START distinteb KEY < dis-chiave
           ELSE
              START distinteb KEY > dis-chiave
           END-IF
           .

       DataSet1-distinteb-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-distinteb-LOCK
              READ distinteb WITH LOCK 
              KEY dis-chiave
           ELSE
              READ distinteb WITH NO LOCK 
              KEY dis-chiave
           END-IF
           PERFORM distinteb-k-articolo-MERGE-SPLITBUF
           PERFORM distinteb-k-progmag-MERGE-SPLITBUF
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT 
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-distinteb-KEY-Asc
              IF DataSet1-distinteb-LOCK
                 READ distinteb NEXT WITH LOCK
              ELSE
                 READ distinteb NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-distinteb-LOCK
                 READ distinteb PREVIOUS WITH LOCK
              ELSE
                 READ distinteb PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM distinteb-k-articolo-MERGE-SPLITBUF
           PERFORM distinteb-k-progmag-MERGE-SPLITBUF
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-distinteb-KEY-Asc
              IF DataSet1-distinteb-LOCK
                 READ distinteb PREVIOUS WITH LOCK
              ELSE
                 READ distinteb PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-distinteb-LOCK
                 READ distinteb NEXT WITH LOCK
              ELSE
                 READ distinteb NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM distinteb-k-articolo-MERGE-SPLITBUF
           PERFORM distinteb-k-progmag-MERGE-SPLITBUF
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-distinteb-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-distinteb TO TOTEM-ERR-STAT
           MOVE "distinteb" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:distinteb, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-nlistini-INITSTART.
           IF DataSet1-nlistini-KEY-Asc
              MOVE Low-Value TO nlis-chiave OF nlistini
           ELSE
              MOVE High-Value TO nlis-chiave OF nlistini
           END-IF
           .

       DataSet1-nlistini-INITEND.
           IF DataSet1-nlistini-KEY-Asc
              MOVE High-Value TO nlis-chiave OF nlistini
           ELSE
              MOVE Low-Value TO nlis-chiave OF nlistini
           END-IF
           .

      * nlistini
       DataSet1-nlistini-START.
           IF DataSet1-nlistini-KEY-Asc
              START nlistini KEY >= nlis-chiave OF nlistini
           ELSE
              START nlistini KEY <= nlis-chiave OF nlistini
           END-IF
           .

       DataSet1-nlistini-START-NOTGREATER.
           IF DataSet1-nlistini-KEY-Asc
              START nlistini KEY <= nlis-chiave OF nlistini
           ELSE
              START nlistini KEY >= nlis-chiave OF nlistini
           END-IF
           .

       DataSet1-nlistini-START-GREATER.
           IF DataSet1-nlistini-KEY-Asc
              START nlistini KEY > nlis-chiave OF nlistini
           ELSE
              START nlistini KEY < nlis-chiave OF nlistini
           END-IF
           .

       DataSet1-nlistini-START-LESS.
           IF DataSet1-nlistini-KEY-Asc
              START nlistini KEY < nlis-chiave OF nlistini
           ELSE
              START nlistini KEY > nlis-chiave OF nlistini
           END-IF
           .

       DataSet1-nlistini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-nlistini-LOCK
              READ nlistini WITH LOCK 
              KEY nlis-chiave OF nlistini
           ELSE
              READ nlistini WITH NO LOCK 
              KEY nlis-chiave OF nlistini
           END-IF
           MOVE STATUS-nlistini TO TOTEM-ERR-STAT 
           MOVE "nlistini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-nlistini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-nlistini-KEY-Asc
              IF DataSet1-nlistini-LOCK
                 READ nlistini NEXT WITH LOCK
              ELSE
                 READ nlistini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-nlistini-LOCK
                 READ nlistini PREVIOUS WITH LOCK
              ELSE
                 READ nlistini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-nlistini TO TOTEM-ERR-STAT
           MOVE "nlistini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-nlistini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-nlistini-KEY-Asc
              IF DataSet1-nlistini-LOCK
                 READ nlistini PREVIOUS WITH LOCK
              ELSE
                 READ nlistini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-nlistini-LOCK
                 READ nlistini NEXT WITH LOCK
              ELSE
                 READ nlistini NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-nlistini TO TOTEM-ERR-STAT
           MOVE "nlistini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-nlistini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-nlistini TO TOTEM-ERR-STAT
           MOVE "nlistini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-nlistini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-nlistini TO TOTEM-ERR-STAT
           MOVE "nlistini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-nlistini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-nlistini TO TOTEM-ERR-STAT
           MOVE "nlistini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nlistini, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-nforn-dest-INITSTART.
           IF DataSet1-nforn-dest-KEY-Asc
              MOVE Low-Value TO nfod-chiave OF nforn-dest
           ELSE
              MOVE High-Value TO nfod-chiave OF nforn-dest
           END-IF
           .

       DataSet1-nforn-dest-INITEND.
           IF DataSet1-nforn-dest-KEY-Asc
              MOVE High-Value TO nfod-chiave OF nforn-dest
           ELSE
              MOVE Low-Value TO nfod-chiave OF nforn-dest
           END-IF
           .

      * nforn-dest
       DataSet1-nforn-dest-START.
           IF DataSet1-nforn-dest-KEY-Asc
              START nforn-dest KEY >= nfod-chiave OF nforn-dest
           ELSE
              START nforn-dest KEY <= nfod-chiave OF nforn-dest
           END-IF
           .

       DataSet1-nforn-dest-START-NOTGREATER.
           IF DataSet1-nforn-dest-KEY-Asc
              START nforn-dest KEY <= nfod-chiave OF nforn-dest
           ELSE
              START nforn-dest KEY >= nfod-chiave OF nforn-dest
           END-IF
           .

       DataSet1-nforn-dest-START-GREATER.
           IF DataSet1-nforn-dest-KEY-Asc
              START nforn-dest KEY > nfod-chiave OF nforn-dest
           ELSE
              START nforn-dest KEY < nfod-chiave OF nforn-dest
           END-IF
           .

       DataSet1-nforn-dest-START-LESS.
           IF DataSet1-nforn-dest-KEY-Asc
              START nforn-dest KEY < nfod-chiave OF nforn-dest
           ELSE
              START nforn-dest KEY > nfod-chiave OF nforn-dest
           END-IF
           .

       DataSet1-nforn-dest-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-nforn-dest-LOCK
              READ nforn-dest WITH LOCK 
              KEY nfod-chiave OF nforn-dest
           ELSE
              READ nforn-dest WITH NO LOCK 
              KEY nfod-chiave OF nforn-dest
           END-IF
           MOVE STATUS-nforn-dest TO TOTEM-ERR-STAT 
           MOVE "nforn-dest" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-nforn-dest-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-nforn-dest-KEY-Asc
              IF DataSet1-nforn-dest-LOCK
                 READ nforn-dest NEXT WITH LOCK
              ELSE
                 READ nforn-dest NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-nforn-dest-LOCK
                 READ nforn-dest PREVIOUS WITH LOCK
              ELSE
                 READ nforn-dest PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-nforn-dest TO TOTEM-ERR-STAT
           MOVE "nforn-dest" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-nforn-dest-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-nforn-dest-KEY-Asc
              IF DataSet1-nforn-dest-LOCK
                 READ nforn-dest PREVIOUS WITH LOCK
              ELSE
                 READ nforn-dest PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-nforn-dest-LOCK
                 READ nforn-dest NEXT WITH LOCK
              ELSE
                 READ nforn-dest NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-nforn-dest TO TOTEM-ERR-STAT
           MOVE "nforn-dest" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-nforn-dest-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-nforn-dest TO TOTEM-ERR-STAT
           MOVE "nforn-dest" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-nforn-dest-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-nforn-dest TO TOTEM-ERR-STAT
           MOVE "nforn-dest" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-nforn-dest-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-nforn-dest TO TOTEM-ERR-STAT
           MOVE "nforn-dest" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:nforn-dest, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-param-INITSTART.
           IF DataSet1-param-KEY-Asc
              MOVE Low-Value TO prm-chiave OF param
           ELSE
              MOVE High-Value TO prm-chiave OF param
           END-IF
           .

       DataSet1-param-INITEND.
           IF DataSet1-param-KEY-Asc
              MOVE High-Value TO prm-chiave OF param
           ELSE
              MOVE Low-Value TO prm-chiave OF param
           END-IF
           .

      * param
       DataSet1-param-START.
           IF DataSet1-param-KEY-Asc
              START param KEY >= prm-chiave OF param
           ELSE
              START param KEY <= prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-NOTGREATER.
           IF DataSet1-param-KEY-Asc
              START param KEY <= prm-chiave OF param
           ELSE
              START param KEY >= prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-GREATER.
           IF DataSet1-param-KEY-Asc
              START param KEY > prm-chiave OF param
           ELSE
              START param KEY < prm-chiave OF param
           END-IF
           .

       DataSet1-param-START-LESS.
           IF DataSet1-param-KEY-Asc
              START param KEY < prm-chiave OF param
           ELSE
              START param KEY > prm-chiave OF param
           END-IF
           .

       DataSet1-param-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-param-LOCK
              READ param WITH LOCK 
              KEY prm-chiave OF param
           ELSE
              READ param WITH NO LOCK 
              KEY prm-chiave OF param
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT 
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-param-KEY-Asc
              IF DataSet1-param-LOCK
                 READ param NEXT WITH LOCK
              ELSE
                 READ param NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param-LOCK
                 READ param PREVIOUS WITH LOCK
              ELSE
                 READ param PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-param-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-param-KEY-Asc
              IF DataSet1-param-LOCK
                 READ param PREVIOUS WITH LOCK
              ELSE
                 READ param PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-param-LOCK
                 READ param NEXT WITH LOCK
              ELSE
                 READ param NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-param-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:param, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-param TO TOTEM-ERR-STAT
           MOVE "param" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:param, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tscorte-INITSTART.
           IF DataSet1-tscorte-KEY-Asc
              MOVE Low-Value TO sco-chiave
           ELSE
              MOVE High-Value TO sco-chiave
           END-IF
           .

       DataSet1-tscorte-INITEND.
           IF DataSet1-tscorte-KEY-Asc
              MOVE High-Value TO sco-chiave
           ELSE
              MOVE Low-Value TO sco-chiave
           END-IF
           .

      * tscorte
       DataSet1-tscorte-START.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY >= sco-chiave
           ELSE
              START tscorte KEY <= sco-chiave
           END-IF
           .

       DataSet1-tscorte-START-NOTGREATER.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY <= sco-chiave
           ELSE
              START tscorte KEY >= sco-chiave
           END-IF
           .

       DataSet1-tscorte-START-GREATER.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY > sco-chiave
           ELSE
              START tscorte KEY < sco-chiave
           END-IF
           .

       DataSet1-tscorte-START-LESS.
           IF DataSet1-tscorte-KEY-Asc
              START tscorte KEY < sco-chiave
           ELSE
              START tscorte KEY > sco-chiave
           END-IF
           .

       DataSet1-tscorte-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tscorte-LOCK
              READ tscorte WITH LOCK 
              KEY sco-chiave
           ELSE
              READ tscorte WITH NO LOCK 
              KEY sco-chiave
           END-IF
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT 
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tscorte-KEY-Asc
              IF DataSet1-tscorte-LOCK
                 READ tscorte NEXT WITH LOCK
              ELSE
                 READ tscorte NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tscorte-LOCK
                 READ tscorte PREVIOUS WITH LOCK
              ELSE
                 READ tscorte PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tscorte-KEY-Asc
              IF DataSet1-tscorte-LOCK
                 READ tscorte PREVIOUS WITH LOCK
              ELSE
                 READ tscorte PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tscorte-LOCK
                 READ tscorte NEXT WITH LOCK
              ELSE
                 READ tscorte NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tscorte-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tscorte TO TOTEM-ERR-STAT
           MOVE "tscorte" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tscorte, AfterDelete>
      * <TOTEM:END>
           .

       rordini-ror-k-promo-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-promo-SPLITBUF
           MOVE ror-promo OF rordini(1:15) TO 
           rordini-ror-k-promo-SPLITBUF(1:15)
           .

       rordini-ror-k-articolo-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-articolo-SPLITBUF
           MOVE ror-cod-articolo OF rordini(1:6) TO 
           rordini-ror-k-articolo-SPLITBUF(1:6)
           MOVE ror-chiave OF rordini(1:17) TO 
           rordini-ror-k-articolo-SPLITBUF(7:17)
           .

       rordini-ror-k-master-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-master-SPLITBUF
           MOVE ror-chiave-ordine OF rordini(1:17) TO 
           rordini-ror-k-master-SPLITBUF(1:17)
           MOVE ror-chiave OF rordini(1:17) TO 
           rordini-ror-k-master-SPLITBUF(18:17)
           .

       rordini-ror-k-stbolle-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-stbolle-SPLITBUF
           MOVE ror-anno OF rordini(1:4) TO 
           rordini-ror-k-stbolle-SPLITBUF(1:4)
           MOVE ror-num-ordine OF rordini(1:8) TO 
           rordini-ror-k-stbolle-SPLITBUF(5:8)
           MOVE ror-chiave-ordine OF rordini(1:17) TO 
           rordini-ror-k-stbolle-SPLITBUF(13:17)
           .

       rordini-ror-k-ord-art-MERGE-SPLITBUF.
           INITIALIZE rordini-ror-k-ord-art-SPLITBUF
           MOVE ror-anno OF rordini(1:4) TO 
           rordini-ror-k-ord-art-SPLITBUF(1:4)
           MOVE ror-num-ordine OF rordini(1:8) TO 
           rordini-ror-k-ord-art-SPLITBUF(5:8)
           MOVE ror-cod-articolo OF rordini(1:6) TO 
           rordini-ror-k-ord-art-SPLITBUF(13:6)
           .

       DataSet1-rordini-INITSTART.
           IF DataSet1-rordini-KEY-Asc
              MOVE Low-Value TO ror-chiave OF rordini
           ELSE
              MOVE High-Value TO ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-INITEND.
           IF DataSet1-rordini-KEY-Asc
              MOVE High-Value TO ror-chiave OF rordini
           ELSE
              MOVE Low-Value TO ror-chiave OF rordini
           END-IF
           .

      * rordini
       DataSet1-rordini-START.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY >= ror-chiave OF rordini
           ELSE
              START rordini KEY <= ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-START-NOTGREATER.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY <= ror-chiave OF rordini
           ELSE
              START rordini KEY >= ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-START-GREATER.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY > ror-chiave OF rordini
           ELSE
              START rordini KEY < ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-START-LESS.
           IF DataSet1-rordini-KEY-Asc
              START rordini KEY < ror-chiave OF rordini
           ELSE
              START rordini KEY > ror-chiave OF rordini
           END-IF
           .

       DataSet1-rordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rordini-LOCK
              READ rordini WITH LOCK 
              KEY ror-chiave OF rordini
           ELSE
              READ rordini WITH NO LOCK 
              KEY ror-chiave OF rordini
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           PERFORM rordini-ror-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT 
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rordini-KEY-Asc
              IF DataSet1-rordini-LOCK
                 READ rordini NEXT WITH LOCK
              ELSE
                 READ rordini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordini-LOCK
                 READ rordini PREVIOUS WITH LOCK
              ELSE
                 READ rordini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           PERFORM rordini-ror-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rordini-KEY-Asc
              IF DataSet1-rordini-LOCK
                 READ rordini PREVIOUS WITH LOCK
              ELSE
                 READ rordini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rordini-LOCK
                 READ rordini NEXT WITH LOCK
              ELSE
                 READ rordini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rordini-ror-k-promo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-articolo-MERGE-SPLITBUF
           PERFORM rordini-ror-k-master-MERGE-SPLITBUF
           PERFORM rordini-ror-k-stbolle-MERGE-SPLITBUF
           PERFORM rordini-ror-k-ord-art-MERGE-SPLITBUF
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-rordini TO TOTEM-ERR-STAT
           MOVE "rordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rordini, AfterDelete>
      * <TOTEM:END>
           .

       tordini-k-causale-MERGE-SPLITBUF.
           INITIALIZE tordini-k-causale-SPLITBUF
           MOVE tor-causale(1:4) TO tordini-k-causale-SPLITBUF(1:4)
           MOVE tor-anno(1:4) TO tordini-k-causale-SPLITBUF(5:4)
           MOVE tor-numero(1:8) TO tordini-k-causale-SPLITBUF(9:8)
           .

       tordini-k1-MERGE-SPLITBUF.
           INITIALIZE tordini-k1-SPLITBUF
           MOVE tor-cod-cli(1:5) TO tordini-k1-SPLITBUF(1:5)
           MOVE tor-prg-destino(1:5) TO tordini-k1-SPLITBUF(6:5)
           MOVE tor-anno(1:4) TO tordini-k1-SPLITBUF(11:4)
           MOVE tor-numero(1:8) TO tordini-k1-SPLITBUF(15:8)
           .

       tordini-k2-MERGE-SPLITBUF.
           INITIALIZE tordini-k2-SPLITBUF
           MOVE tor-data-passaggio-ordine(1:8) TO 
           tordini-k2-SPLITBUF(1:8)
           MOVE tor-anno(1:4) TO tordini-k2-SPLITBUF(9:4)
           MOVE tor-numero(1:8) TO tordini-k2-SPLITBUF(13:8)
           .

       tordini-k-bolla-MERGE-SPLITBUF.
           INITIALIZE tordini-k-bolla-SPLITBUF
           MOVE tor-anno-bolla(1:4) TO tordini-k-bolla-SPLITBUF(1:4)
           MOVE tor-num-bolla(1:8) TO tordini-k-bolla-SPLITBUF(5:8)
           .

       tordini-k3-MERGE-SPLITBUF.
           INITIALIZE tordini-k3-SPLITBUF
           MOVE tor-anno-bolla(1:4) TO tordini-k3-SPLITBUF(1:4)
           MOVE tor-data-bolla(1:8) TO tordini-k3-SPLITBUF(5:8)
           MOVE tor-num-bolla(1:8) TO tordini-k3-SPLITBUF(13:8)
           MOVE tor-bolla-prenotata(1:1) TO tordini-k3-SPLITBUF(21:1)
           .

       tordini-k-fattura-MERGE-SPLITBUF.
           INITIALIZE tordini-k-fattura-SPLITBUF
           MOVE tor-anno-fattura(1:4) TO tordini-k-fattura-SPLITBUF(1:4)
           MOVE tor-num-fattura(1:8) TO tordini-k-fattura-SPLITBUF(5:8)
           .

       tordini-k4-MERGE-SPLITBUF.
           INITIALIZE tordini-k4-SPLITBUF
           MOVE tor-anno-fattura(1:4) TO tordini-k4-SPLITBUF(1:4)
           MOVE tor-data-fattura(1:8) TO tordini-k4-SPLITBUF(5:8)
           MOVE tor-num-fattura(1:8) TO tordini-k4-SPLITBUF(13:8)
           MOVE tor-num-prenot(1:8) TO tordini-k4-SPLITBUF(21:8)
           MOVE tor-fatt-prenotata(1:1) TO tordini-k4-SPLITBUF(29:1)
           .

       tordini-k-contab-MERGE-SPLITBUF.
           INITIALIZE tordini-k-contab-SPLITBUF
           MOVE tor-agg-contab(1:1) TO tordini-k-contab-SPLITBUF(1:1)
           MOVE tor-anno-fattura(1:4) TO tordini-k-contab-SPLITBUF(2:4)
           MOVE tor-num-fattura(1:8) TO tordini-k-contab-SPLITBUF(6:8)
           .

       tordini-k-tipo-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tipo-SPLITBUF
           MOVE tor-tipo(1:1) TO tordini-k-tipo-SPLITBUF(1:1)
           MOVE tor-chiave(1:12) TO tordini-k-tipo-SPLITBUF(2:12)
           .

       tordini-k-data-MERGE-SPLITBUF.
           INITIALIZE tordini-k-data-SPLITBUF
           MOVE tor-data-creazione(1:8) TO tordini-k-data-SPLITBUF(1:8)
           MOVE tor-numero(1:8) TO tordini-k-data-SPLITBUF(9:8)
           .

       tordini-k-agfatt-MERGE-SPLITBUF.
           INITIALIZE tordini-k-agfatt-SPLITBUF
           MOVE tor-anno-fattura(1:4) TO tordini-k-agfatt-SPLITBUF(1:4)
           MOVE tor-data-fattura(1:8) TO tordini-k-agfatt-SPLITBUF(5:8)
           MOVE tor-num-fattura(1:8) TO tordini-k-agfatt-SPLITBUF(13:8)
           MOVE tor-num-prenot(1:8) TO tordini-k-agfatt-SPLITBUF(21:8)
           MOVE tor-fatt-prenotata(1:1) TO 
           tordini-k-agfatt-SPLITBUF(29:1)
           MOVE tor-chiave(1:12) TO tordini-k-agfatt-SPLITBUF(30:12)
           .

       tordini-k-stbolle-MERGE-SPLITBUF.
           INITIALIZE tordini-k-stbolle-SPLITBUF
           MOVE tor-anno-bolla(1:4) TO tordini-k-stbolle-SPLITBUF(1:4)
           MOVE tor-data-bolla(1:8) TO tordini-k-stbolle-SPLITBUF(5:8)
           MOVE tor-num-bolla(1:8) TO tordini-k-stbolle-SPLITBUF(13:8)
           MOVE tor-bolla-prenotata(1:1) TO 
           tordini-k-stbolle-SPLITBUF(21:1)
           MOVE tor-chiave(1:12) TO tordini-k-stbolle-SPLITBUF(22:12)
           .

       tordini-k-andamento-data-MERGE-SPLITBUF.
           INITIALIZE tordini-k-andamento-data-SPLITBUF
           MOVE tor-agg-contab(1:1) TO 
           tordini-k-andamento-data-SPLITBUF(1:1)
           MOVE tor-data-fattura(1:8) TO 
           tordini-k-andamento-data-SPLITBUF(2:8)
           .

       tordini-k-andamento-cliente-MERGE-SPLITBUF.
           INITIALIZE tordini-k-andamento-cliente-SPLITBUF
           MOVE tor-cod-cli(1:5) TO 
           tordini-k-andamento-cliente-SPLITBUF(1:5)
           MOVE tor-agg-contab(1:1) TO 
           tordini-k-andamento-cliente-SPLITBUF(6:1)
           MOVE tor-data-fattura(1:8) TO 
           tordini-k-andamento-cliente-SPLITBUF(7:8)
           .

       tordini-k-andamento-clides-MERGE-SPLITBUF.
           INITIALIZE tordini-k-andamento-clides-SPLITBUF
           MOVE tor-cod-cli(1:5) TO 
           tordini-k-andamento-clides-SPLITBUF(1:5)
           MOVE tor-prg-destino(1:5) TO 
           tordini-k-andamento-clides-SPLITBUF(6:5)
           MOVE tor-agg-contab(1:1) TO 
           tordini-k-andamento-clides-SPLITBUF(11:1)
           MOVE tor-data-fattura(1:8) TO 
           tordini-k-andamento-clides-SPLITBUF(12:8)
           .

       tordini-k-promo-MERGE-SPLITBUF.
           INITIALIZE tordini-k-promo-SPLITBUF
           MOVE tor-stato(1:1) TO tordini-k-promo-SPLITBUF(1:1)
           MOVE tor-promo(1:1) TO tordini-k-promo-SPLITBUF(2:1)
           MOVE tor-data-ordine(1:8) TO tordini-k-promo-SPLITBUF(3:8)
           MOVE tor-numero(1:8) TO tordini-k-promo-SPLITBUF(11:8)
           MOVE tor-cod-cli(1:5) TO tordini-k-promo-SPLITBUF(19:5)
           MOVE tor-prg-destino(1:5) TO tordini-k-promo-SPLITBUF(24:5)
           .

       tordini-k-or-MERGE-SPLITBUF.
           INITIALIZE tordini-k-or-SPLITBUF
           MOVE tor-cod-cli(1:5) TO tordini-k-or-SPLITBUF(1:5)
           MOVE tor-prg-destino(1:5) TO tordini-k-or-SPLITBUF(6:5)
           MOVE tor-num-ord-cli(1:50) TO tordini-k-or-SPLITBUF(11:50)
           .

       tordini-k-tor-inviare-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tor-inviare-SPLITBUF
           MOVE tor-da-inviare OF tordini(1:1) TO 
           tordini-k-tor-inviare-SPLITBUF(1:1)
           MOVE tor-chiave OF tordini(1:12) TO 
           tordini-k-tor-inviare-SPLITBUF(2:12)
           .

       tordini-k-tor-tipocli-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tor-tipocli-SPLITBUF
           MOVE tor-tipocli OF tordini(1:2) TO 
           tordini-k-tor-tipocli-SPLITBUF(1:2)
           MOVE tor-cod-cli OF tordini(1:5) TO 
           tordini-k-tor-tipocli-SPLITBUF(3:5)
           MOVE tor-prg-destino OF tordini(1:5) TO 
           tordini-k-tor-tipocli-SPLITBUF(8:5)
           MOVE tor-chiave OF tordini(1:12) TO 
           tordini-k-tor-tipocli-SPLITBUF(13:12)
           .

       tordini-k-tor-gdo-MERGE-SPLITBUF.
           INITIALIZE tordini-k-tor-gdo-SPLITBUF
           MOVE tor-gdo OF tordini(1:5) TO 
           tordini-k-tor-gdo-SPLITBUF(1:5)
           MOVE tor-cod-cli OF tordini(1:5) TO 
           tordini-k-tor-gdo-SPLITBUF(6:5)
           MOVE tor-prg-destino OF tordini(1:5) TO 
           tordini-k-tor-gdo-SPLITBUF(11:5)
           MOVE tor-chiave OF tordini(1:12) TO 
           tordini-k-tor-gdo-SPLITBUF(16:12)
           .

       DataSet1-tordini-INITSTART.
           IF DataSet1-tordini-KEY-Asc
              MOVE Low-Value TO tor-chiave
           ELSE
              MOVE High-Value TO tor-chiave
           END-IF
           .

       DataSet1-tordini-INITEND.
           IF DataSet1-tordini-KEY-Asc
              MOVE High-Value TO tor-chiave
           ELSE
              MOVE Low-Value TO tor-chiave
           END-IF
           .

      * tordini
       DataSet1-tordini-START.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY >= tor-chiave
           ELSE
              START tordini KEY <= tor-chiave
           END-IF
           .

       DataSet1-tordini-START-NOTGREATER.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY <= tor-chiave
           ELSE
              START tordini KEY >= tor-chiave
           END-IF
           .

       DataSet1-tordini-START-GREATER.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY > tor-chiave
           ELSE
              START tordini KEY < tor-chiave
           END-IF
           .

       DataSet1-tordini-START-LESS.
           IF DataSet1-tordini-KEY-Asc
              START tordini KEY < tor-chiave
           ELSE
              START tordini KEY > tor-chiave
           END-IF
           .

       DataSet1-tordini-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tordini-LOCK
              READ tordini WITH LOCK 
              KEY tor-chiave
           ELSE
              READ tordini WITH NO LOCK 
              KEY tor-chiave
           END-IF
           PERFORM tordini-k-causale-MERGE-SPLITBUF
           PERFORM tordini-k1-MERGE-SPLITBUF
           PERFORM tordini-k2-MERGE-SPLITBUF
           PERFORM tordini-k-bolla-MERGE-SPLITBUF
           PERFORM tordini-k3-MERGE-SPLITBUF
           PERFORM tordini-k-fattura-MERGE-SPLITBUF
           PERFORM tordini-k4-MERGE-SPLITBUF
           PERFORM tordini-k-contab-MERGE-SPLITBUF
           PERFORM tordini-k-tipo-MERGE-SPLITBUF
           PERFORM tordini-k-data-MERGE-SPLITBUF
           PERFORM tordini-k-agfatt-MERGE-SPLITBUF
           PERFORM tordini-k-stbolle-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-data-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-clides-MERGE-SPLITBUF
           PERFORM tordini-k-promo-MERGE-SPLITBUF
           PERFORM tordini-k-or-MERGE-SPLITBUF
           PERFORM tordini-k-tor-inviare-MERGE-SPLITBUF
           PERFORM tordini-k-tor-tipocli-MERGE-SPLITBUF
           PERFORM tordini-k-tor-gdo-MERGE-SPLITBUF
           MOVE STATUS-tordini TO TOTEM-ERR-STAT 
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tordini-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tordini-KEY-Asc
              IF DataSet1-tordini-LOCK
                 READ tordini NEXT WITH LOCK
              ELSE
                 READ tordini NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tordini-LOCK
                 READ tordini PREVIOUS WITH LOCK
              ELSE
                 READ tordini PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tordini-k-causale-MERGE-SPLITBUF
           PERFORM tordini-k1-MERGE-SPLITBUF
           PERFORM tordini-k2-MERGE-SPLITBUF
           PERFORM tordini-k-bolla-MERGE-SPLITBUF
           PERFORM tordini-k3-MERGE-SPLITBUF
           PERFORM tordini-k-fattura-MERGE-SPLITBUF
           PERFORM tordini-k4-MERGE-SPLITBUF
           PERFORM tordini-k-contab-MERGE-SPLITBUF
           PERFORM tordini-k-tipo-MERGE-SPLITBUF
           PERFORM tordini-k-data-MERGE-SPLITBUF
           PERFORM tordini-k-agfatt-MERGE-SPLITBUF
           PERFORM tordini-k-stbolle-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-data-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-clides-MERGE-SPLITBUF
           PERFORM tordini-k-promo-MERGE-SPLITBUF
           PERFORM tordini-k-or-MERGE-SPLITBUF
           PERFORM tordini-k-tor-inviare-MERGE-SPLITBUF
           PERFORM tordini-k-tor-tipocli-MERGE-SPLITBUF
           PERFORM tordini-k-tor-gdo-MERGE-SPLITBUF
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tordini-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tordini-KEY-Asc
              IF DataSet1-tordini-LOCK
                 READ tordini PREVIOUS WITH LOCK
              ELSE
                 READ tordini PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tordini-LOCK
                 READ tordini NEXT WITH LOCK
              ELSE
                 READ tordini NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tordini-k-causale-MERGE-SPLITBUF
           PERFORM tordini-k1-MERGE-SPLITBUF
           PERFORM tordini-k2-MERGE-SPLITBUF
           PERFORM tordini-k-bolla-MERGE-SPLITBUF
           PERFORM tordini-k3-MERGE-SPLITBUF
           PERFORM tordini-k-fattura-MERGE-SPLITBUF
           PERFORM tordini-k4-MERGE-SPLITBUF
           PERFORM tordini-k-contab-MERGE-SPLITBUF
           PERFORM tordini-k-tipo-MERGE-SPLITBUF
           PERFORM tordini-k-data-MERGE-SPLITBUF
           PERFORM tordini-k-agfatt-MERGE-SPLITBUF
           PERFORM tordini-k-stbolle-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-data-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-cliente-MERGE-SPLITBUF
           PERFORM tordini-k-andamento-clides-MERGE-SPLITBUF
           PERFORM tordini-k-promo-MERGE-SPLITBUF
           PERFORM tordini-k-or-MERGE-SPLITBUF
           PERFORM tordini-k-tor-inviare-MERGE-SPLITBUF
           PERFORM tordini-k-tor-tipocli-MERGE-SPLITBUF
           PERFORM tordini-k-tor-gdo-MERGE-SPLITBUF
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tordini-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tordini-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tordini-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tordini TO TOTEM-ERR-STAT
           MOVE "tordini" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tordini, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE tof-rec OF tordforn
           INITIALIZE tge-rec OF tparamge
           INITIALIZE imb-rec OF timballi
           INITIALIZE zoom-tca-rec OF zoom-tcaumag
           INITIALIZE bli-rec OF blister
           INITIALIZE art-rec OF articoli
           INITIALIZE record-tblpa OF tcodpag
           INITIALIZE imp-rec OF timposte
           INITIALIZE imq-rec OF timbalqta
           INITIALIZE mar-rec OF tmarche
           INITIALIZE prg-rec OF progmag
           INITIALIZE tmp-prg-z-rec OF tmp-progmag-zoom
           INITIALIZE nof-rec OF nordforn
           INITIALIZE record-tbliv OF tivaese
           INITIALIZE tpb-rec OF tpiombo
           INITIALIZE loc-rec OF locali
           INITIALIZE tlis-rec OF tlistini
           INITIALIZE rlis-rec OF rlistini
           INITIALIZE tca-rec OF tcaumag
           INITIALIZE tmp-nof-rec OF tmp-nordforn
           INITIALIZE cli-rec OF clienti
           INITIALIZE cli-rec OF clienti1
           INITIALIZE lck-rec OF lockfile
           INITIALIZE aor-rec OF art-ordforn
           INITIALIZE desf-rec OF destinif
           INITIALIZE imf-rec OF impforn
           INITIALIZE rof-rec OF rordforn
           INITIALIZE des-rec OF destini
           INITIALIZE tpr-rec OF tpromo
           INITIALIZE tmp-tpr-z-rec OF tmp-tpromo-zoom
           INITIALIZE gdo-rec OF tgrupgdo
           INITIALIZE mag-rec OF tmagaz
           INITIALIZE dis-rec OF distinteb
           INITIALIZE nlis-rec OF nlistini
           INITIALIZE nfod-rec OF nforn-dest
           INITIALIZE prm-rec OF param
           INITIALIZE sco-rec OF tscorte
           INITIALIZE ror-rec OF rordini
           INITIALIZE tor-rec OF tordini
           .


      * GRID
       Form1-Gd-1-Content.
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 2, Y = 1,
                CELL-DATA = "Art.",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 3, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 4, Y = 1,
                CELL-DATA = "Q.tà ord.",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 5, Y = 1,
                CELL-DATA = "Prz. unit",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 6, Y = 1,
                CELL-DATA = "Sc 1",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 7, Y = 1,
                CELL-DATA = "Sc 2",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 8, Y = 1,
                CELL-DATA = "Sc 3",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 9, Y = 1,
                CELL-DATA = "Sc 4",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 10, Y = 1,
                CELL-DATA = "Sc 5",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 11, Y = 1,
                CELL-DATA = "I. merce",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 12, Y = 1,
                CELL-DATA = "Consumo",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 13, Y = 1,
                CELL-DATA = "Cou/Cobat",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 14, Y = 1,
                CELL-DATA = "Add. Pb",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 15, Y = 1,
                CELL-DATA = "Costi Ag.",
      * CELLS' SETTING
              MODIFY Form1-Gd-1, X = 16, Y = 1,
                CELL-DATA = "IVA",
           .

      * FD's Initialize Paragraph
       DataSet1-tordforn-INITREC.
           INITIALIZE tof-rec OF tordforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tparamge-INITREC.
           INITIALIZE tge-rec OF tparamge
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timballi-INITREC.
           INITIALIZE imb-rec OF timballi
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-zoom-tcaumag-INITREC.
           INITIALIZE zoom-tca-rec OF zoom-tcaumag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-blister-INITREC.
           INITIALIZE bli-rec OF blister
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-articoli-INITREC.
           INITIALIZE art-rec OF articoli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcodpag-INITREC.
           INITIALIZE record-tblpa OF tcodpag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timposte-INITREC.
           INITIALIZE imp-rec OF timposte
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-timbalqta-INITREC.
           INITIALIZE imq-rec OF timbalqta
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmarche-INITREC.
           INITIALIZE mar-rec OF tmarche
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-progmag-INITREC.
           INITIALIZE prg-rec OF progmag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-progmag-zoom-INITREC.
           INITIALIZE tmp-prg-z-rec OF tmp-progmag-zoom
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-nordforn-INITREC.
           INITIALIZE nof-rec OF nordforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tivaese-INITREC.
           INITIALIZE record-tbliv OF tivaese
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tpiombo-INITREC.
           INITIALIZE tpb-rec OF tpiombo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-locali-INITREC.
           INITIALIZE loc-rec OF locali
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tlistini-INITREC.
           INITIALIZE tlis-rec OF tlistini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rlistini-INITREC.
           INITIALIZE rlis-rec OF rlistini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcaumag-INITREC.
           INITIALIZE tca-rec OF tcaumag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-nordforn-INITREC.
           INITIALIZE tmp-nof-rec OF tmp-nordforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-clienti-INITREC.
           INITIALIZE cli-rec OF clienti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-clienti1-INITREC.
           INITIALIZE cli-rec OF clienti1
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-lockfile-INITREC.
           INITIALIZE lck-rec OF lockfile
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-art-ordforn-INITREC.
           INITIALIZE aor-rec OF art-ordforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-destinif-INITREC.
           INITIALIZE desf-rec OF destinif
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-impforn-INITREC.
           INITIALIZE imf-rec OF impforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rordforn-INITREC.
           INITIALIZE rof-rec OF rordforn
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-destini-INITREC.
           INITIALIZE des-rec OF destini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tpromo-INITREC.
           INITIALIZE tpr-rec OF tpromo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-tpromo-zoom-INITREC.
           INITIALIZE tmp-tpr-z-rec OF tmp-tpromo-zoom
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tgrupgdo-INITREC.
           INITIALIZE gdo-rec OF tgrupgdo
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmagaz-INITREC.
           INITIALIZE mag-rec OF tmagaz
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-distinteb-INITREC.
           INITIALIZE dis-rec OF distinteb
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-nlistini-INITREC.
           INITIALIZE nlis-rec OF nlistini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-nforn-dest-INITREC.
           INITIALIZE nfod-rec OF nforn-dest
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-param-INITREC.
           INITIALIZE prm-rec OF param
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tscorte-INITREC.
           INITIALIZE sco-rec OF tscorte
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rordini-INITREC.
           INITIALIZE ror-rec OF rordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tordini-INITREC.
           INITIALIZE tor-rec OF tordini
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           EVALUATE TOTEM-Form-Index ALSO TOTEM-Frame-Index
              WHEN 1 ALSO 0
                  PERFORM Form1-Buf-To-Fld
           END-EVALUATE
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              SCREEN LINE 1,
              SCREEN COLUMN 0,
              LINES 47,15,
              SIZE 158,00,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Small-Font,
              LABEL-OFFSET 23,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE TITOLO,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Form1-Event-Proc,
              HANDLE IS Form1-Handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              GRIP,
              PANEL-WIDTHS (100, 35, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON Form1-Handle
      * DISPLAY-COLUMNS settings
              MODIFY Form1-Gd-1, DISPLAY-COLUMNS (1, 6, 12, 38, 46, 59, 
           66, 73, 80, 87, 94, 104, 114, 124, 133, 142)
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           perform BEFORE-ACCEPT-PROCEDURE.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
           perform ORDINI-AFTER-END-ACCEPT

      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY Form1-Handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
                 IF Event-Type = Cmd-Tabchanged AND 
                                 Event-Control-Id = 5000
                    MOVE EVENT-DATA-1 TO Screen1-Ta-1-TAB-VALUE
                    PERFORM Screen1-Ta-1-TABCHANGE
                 END-IF

              WHEN Key-Status = 1000
                 PERFORM rb-man-LinkTo
              WHEN Key-Status = 1001
                 PERFORM rb-gui-LinkTo
              WHEN Key-Status = 1003
                 PERFORM pb-note-LinkTo
              WHEN Key-Status = 1010
                 PERFORM pb-importa-LinkTo
              WHEN Key-Status = 1002
                 PERFORM pb-grid-nuovo-LinkTo
              WHEN Key-Status = 1005
                 PERFORM pb-grid-elimina-LinkTo
              WHEN Key-Status = 1004
                 PERFORM pb-articoli-LinkTo
              WHEN Key-Status = 1006
                 PERFORM chk-manuale-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON Form1-Handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
           if mod-k = 0
              display message "Confermare la perdita dei dati inseriti?"
                        title titolo
                         type mb-yes-no
                       giving scelta
                      default mb-no
              if scelta = MB-YES
LUBEXX           move "art-ordforn" to lck-nome-pgm
LUBEXX           delete lockfile record invalid continue end-delete

                 move 0 to aor-anno
                 move 0 to aor-numero
                 move low-value to aor-prog
                 start art-ordforn key >= aor-chiave
                       invalid continue
                   not invalid
                       perform until 1 = 2
                          read art-ordforn next
                               at end exit perform
                          end-read
                          if aor-anno   not = 0 or
                             aor-numero not = 0
                             exit perform
                          end-if
                          delete art-ordforn record
                       end-perform
                 end-start

                 perform CANCELLA-COLORE
                 perform INIT
                 perform INIT-OLD-REC
                 move 0 to mod-campi, mod, v-bolla, 
                           v-blister, volantino-forzato,
                           v-gest-plus v-articoli
                 move spaces to lab-forzato-buf
                 set DatiBollaManuale to false
                 move 1 to mod-k
                 perform LEGGI-ANNO
                 perform DISPLAY-SCREEN
      *           perform SECCA-TMP-ASSORCLI

                 initialize hid-rof-rec
                            replacing numeric data by zeroes
                                 alphanumeric data by spaces
                 delete file tmp-nordforn
                 perform AZZERA-MANUALE
                 move 0 to prezzo-finale
                 display lbl-prz-finale
                 move 0 to v-dati-fatt
                 display chk-dati-fatt lab-dati-fatt
                 initialize tipo-note

              end-if  
              move 26 to KEY-STATUS
              exit paragraph
           end-if.

           set environment "KEYSTROKE" to "DATA=44   44".
           set environment "KEYSTROKE" to "DATA=46   46".

           .
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * TAB
              MODIFY Screen1-Ta-1, RESET-TABS = 1
              MODIFY Screen1-Ta-1, 
           TAB-TO-ADD = (
                 " - Sezione dati di &Testata - ",
                 " - Sezione &Righe - ",
                        )
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
                   Form1-Pg-2-Visible,
           MOVE 1 TO Form1-Pg-1-Visible
           PERFORM Screen1-Ta-1-TABCHANGE
      * GRID
           PERFORM Form1-Gd-1-Content
           .

       Form1-DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-tordforn-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-tordforn-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Update-Key.
           MOVE tof-rec OF tordforn TO
                     Form1-MULKEY-TMPBUF
           PERFORM Form1-CLEAR
           PERFORM Form1-INIT-DATA
           MOVE Form1-MULKEY-TMPBUF TO
                     tof-rec OF tordforn
           PERFORM DataSet1-tordforn-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
           .

       Form1-DUPLICATE-MOVEKEY.
           .

       Form1-First.
           PERFORM Form1-DUMMY-FIRST
           PERFORM DataSet1-tordforn-INITSTART
           PERFORM DataSet1-tordforn-START
           IF NOT Valid-STATUS-tordforn
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFirst>
      * <TOTEM:END>
           PERFORM DataSet1-tordforn-Read-Next
           IF NOT Valid-STATUS-tordforn
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFirst>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Previous.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-tordforn-START-LESS
           IF NOT Valid-STATUS-tordforn
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforePrevious>
      * <TOTEM:END>
           PERFORM DataSet1-tordforn-Read-Prev
           IF NOT Valid-STATUS-tordforn
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterPrevious>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-PREVIOUS
           PERFORM Form1-IUD-Display
           .

       Form1-Next.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-tordforn-START-GREATER
           IF NOT Valid-STATUS-tordforn
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeNext>
      * <TOTEM:END>
           PERFORM DataSet1-tordforn-Read-Next
           IF NOT Valid-STATUS-tordforn
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterNext>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-NEXT
           PERFORM Form1-IUD-Display
           .
      
       Form1-Last.
           PERFORM Form1-DUMMY-LAST
           PERFORM DataSet1-tordforn-INITEND
           PERFORM DataSet1-tordforn-START-NOTGREATER
           IF NOT Valid-STATUS-tordforn
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeLast>
      * <TOTEM:END>
           PERFORM DataSet1-tordforn-Read-Prev
           IF NOT Valid-STATUS-tordforn
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterLast>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Curr.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeCurrent>
      * <TOTEM:END>
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-tordforn-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCurrent>
      * <TOTEM:END>
           .

       Form1-IUD-Display.
           IF Valid-STATUS-tordforn
              PERFORM Form1-ALLGRID-RESET
              PERFORM Form1-Fld-To-Buf
              PERFORM Form1-NAVI-FOR-MASTERGRID
              PERFORM Form1-DISPLAY
           ELSE
              IF Form1-FLAG-REFRESH
                 CONTINUE
              ELSE
                 PERFORM Form1-Extended-File-Status
              END-IF
           END-IF
           .

       Form1-Add.
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-ADD
           PERFORM DataSet1-tordforn-INITREC
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAdd>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-tordforn-Rec-Write
           IF Valid-STATUS-tordforn
              PERFORM Form1-RESUMMARY-INS
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "301" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAdd>
      * <TOTEM:END>
           .
     
       Form1-Update.
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-tordforn-START              
           IF NOT Valid-STATUS-tordforn
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
           PERFORM DataSet1-tordforn-Read
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-UPDATE
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeUpdate>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-tordforn-Rec-Rewrite
           IF Valid-STATUS-tordforn
              PERFORM Form1-RESUMMARY-DEL
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "302" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterUpdate>
      * <TOTEM:END>
           .

       Form1-Delete.
           MOVE "203" TO TOTEM-MSG-ID
           PERFORM MESSAGE-BOX-DISPLAY
           IF TOTEM-MSG-RETURN-VALUE NOT = 1
              INITIALIZE TOTEM-MSG-TEXT
              EXIT PARAGRAPH 
           END-IF
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDelete>
      * <TOTEM:END>
           PERFORM Form1-DUMMY-DELETE
      * delete
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-tordforn-Rec-Delete
           IF Valid-STATUS-tordforn
              PERFORM Form1-CLEAR
              PERFORM Form1-DUMMY-DELETE-INIT
              MOVE "303" TO TOTEM-MSG-ID
              MOVE "00" to STATUS-tordforn
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDelete>
      * <TOTEM:END>
           PERFORM Form1-ERR-CHECKING
           .

       Form1-NAVI-FOR-MASTERGRID.
           .

       Form1-ERR-CHECKING.
           IF Valid-STATUS-tordforn
              PERFORM Form1-SHOW-MSG-ROUTINE
           ELSE
              PERFORM Form1-Extended-File-Status
           END-IF
           .

       Form1-RESUMMARY-INS.
           .

       Form1-RESUMMARY-DEL.
           .


       Form1-DUMMY-FIRST.
           .

       Form1-DUMMY-PREVIOUS.
           .

       Form1-DUMMY-NEXT.
           .

       Form1-DUMMY-LAST.
           .

       Form1-DUMMY-CURR.
           .

       Form1-DUMMY-ADD.
           .

       Form1-DUMMY-UPDATE.
           .

       Form1-DUMMY-UPDATE-INIT.
           .

       Form1-DUMMY-DELETE.
           .

       Form1-DUMMY-DELETE-INIT.
           .

       Form1-Init-Value.
           MOVE TITOLO TO TOTEM-MSG-TITLE
           INITIALIZE Form1-BUF
      * FORM : Form1
           PERFORM DataSet1-INIT-RECORD
      * DB_CHECK BOX
              MOVE 0 TO tof-aperto
      * DB_CHECK BOX
              MOVE 0 TO tof-franco-part
      * DB_CHECK BOX
              MOVE 0 TO tof-st-dati-fatt
      * DB_RADIO-BUTTON
              MOVE 1 TO tof-tipo-scarico
      * DB_CHECK BOX
              MOVE 0 TO rof-manuale
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
      * ef-anno's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-anno-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5001 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cau's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cau-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5002 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cli's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cli-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5003 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-dest's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-dest-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5004 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5005 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data-cons's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-cons-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5006 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-data-listino's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-data-listino-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5007 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-promo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-promo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5010 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cliente's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cliente-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5012 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-des-cli's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-des-cli-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5013 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-evasione's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-evasione-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5014 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-referente's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-referente-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 16 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-tel's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-tel-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 17 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-fax's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-fax-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 18 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-mail's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-mail-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 19 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5015 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ese-iva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ese-iva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5016 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5017 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5018 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-3's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-3-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5019 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-note-4's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-note-4-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 1 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5020 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-art's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-art-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5021 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-imb-ord's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-imb-ord-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5022 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-qta's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-qta-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5023 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-uni's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-uni-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5024 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto-1's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-1-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5025 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto-2's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-2-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5026 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto-3's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-3-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5027 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto-4's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-4-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5028 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-sconto-5's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-sconto-5-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5029 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cons's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cons-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5030 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cou's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cou-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5031 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-add's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-add-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5032 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-costi-agg's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-costi-agg-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5033 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-imp's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-imp-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5034 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cod-iva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cod-iva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5035 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-impforn's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-impforn-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 2 TO Screen1-Ta-1-TAB-VALUE
               PERFORM Screen1-Ta-1-TABCHANGE
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5037 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
           .

       ef-anno-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-anno, BeforeValidation>
      * <TOTEM:END>
           .

       ef-anno-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-anno, AfterValidation>
      * <TOTEM:END>
           .

      * ef-anno's Validation
       ef-anno-VALIDATION.
           PERFORM ef-anno-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-anno-AFTER-VALIDATION
           .

       ef-cau-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cau-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cau's Validation
       ef-cau-VALIDATION.
           PERFORM ef-cau-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cau-AFTER-VALIDATION
           .

       ef-cli-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cli-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cli's Validation
       ef-cli-VALIDATION.
           PERFORM ef-cli-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cli-AFTER-VALIDATION
           .

       ef-dest-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dest, BeforeValidation>
      * <TOTEM:END>
           .

       ef-dest-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-dest, AfterValidation>
      * <TOTEM:END>
           .

      * ef-dest's Validation
       ef-dest-VALIDATION.
           PERFORM ef-dest-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-dest-AFTER-VALIDATION
           .

       ef-data-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data's Validation
       ef-data-VALIDATION.
           PERFORM ef-data-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-AFTER-VALIDATION
           .

       ef-data-cons-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-cons, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-cons-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-cons, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data-cons's Validation
       ef-data-cons-VALIDATION.
           PERFORM ef-data-cons-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-cons-AFTER-VALIDATION
           .

       ef-data-listino-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-listino, BeforeValidation>
      * <TOTEM:END>
           .

       ef-data-listino-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-data-listino, AfterValidation>
      * <TOTEM:END>
           .

      * ef-data-listino's Validation
       ef-data-listino-VALIDATION.
           PERFORM ef-data-listino-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-data-listino-AFTER-VALIDATION
           .

       ef-promo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-promo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-promo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-promo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-promo's Validation
       ef-promo-VALIDATION.
           PERFORM ef-promo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-promo-AFTER-VALIDATION
           .

       ef-cliente-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cliente, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cliente-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cliente, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cliente's Validation
       ef-cliente-VALIDATION.
           PERFORM ef-cliente-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cliente-AFTER-VALIDATION
           .

       ef-des-cli-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-cli, BeforeValidation>
      * <TOTEM:END>
           .

       ef-des-cli-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-des-cli, AfterValidation>
      * <TOTEM:END>
           .

      * ef-des-cli's Validation
       ef-des-cli-VALIDATION.
           PERFORM ef-des-cli-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-des-cli-AFTER-VALIDATION
           .

       ef-evasione-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-evasione, BeforeValidation>
      * <TOTEM:END>
           .

       ef-evasione-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-evasione, AfterValidation>
      * <TOTEM:END>
           .

      * ef-evasione's Validation
       ef-evasione-VALIDATION.
           PERFORM ef-evasione-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-evasione-AFTER-VALIDATION
           .

       ef-referente-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-referente, BeforeValidation>
      * <TOTEM:END>
           .

       ef-referente-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-referente, AfterValidation>
      * <TOTEM:END>
           .

      * ef-referente's Validation
       ef-referente-VALIDATION.
           PERFORM ef-referente-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-referente-AFTER-VALIDATION
           .

       ef-tel-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tel, BeforeValidation>
      * <TOTEM:END>
           .

       ef-tel-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tel, AfterValidation>
      * <TOTEM:END>
           .

      * ef-tel's Validation
       ef-tel-VALIDATION.
           PERFORM ef-tel-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-tel-AFTER-VALIDATION
           .

       ef-fax-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fax, BeforeValidation>
      * <TOTEM:END>
           .

       ef-fax-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-fax, AfterValidation>
      * <TOTEM:END>
           .

      * ef-fax's Validation
       ef-fax-VALIDATION.
           PERFORM ef-fax-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-fax-AFTER-VALIDATION
           .

       ef-mail-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail, BeforeValidation>
      * <TOTEM:END>
           .

       ef-mail-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-mail, AfterValidation>
      * <TOTEM:END>
           .

      * ef-mail's Validation
       ef-mail-VALIDATION.
           PERFORM ef-mail-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-mail-AFTER-VALIDATION
           .

       ef-pag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pag's Validation
       ef-pag-VALIDATION.
           PERFORM ef-pag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pag-AFTER-VALIDATION
           .

       ef-ese-iva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ese-iva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ese-iva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ese-iva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ese-iva's Validation
       ef-ese-iva-VALIDATION.
           PERFORM ef-ese-iva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ese-iva-AFTER-VALIDATION
           .

       ef-note-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-1's Validation
       ef-note-1-VALIDATION.
           PERFORM ef-note-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-1-AFTER-VALIDATION
           .

       ef-note-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-2's Validation
       ef-note-2-VALIDATION.
           PERFORM ef-note-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-2-AFTER-VALIDATION
           .

       ef-note-3-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-3, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-3-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-3, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-3's Validation
       ef-note-3-VALIDATION.
           PERFORM ef-note-3-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-3-AFTER-VALIDATION
           .

       ef-note-4-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-4, BeforeValidation>
      * <TOTEM:END>
           .

       ef-note-4-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-note-4, AfterValidation>
      * <TOTEM:END>
           .

      * ef-note-4's Validation
       ef-note-4-VALIDATION.
           PERFORM ef-note-4-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-note-4-AFTER-VALIDATION
           .

       ef-art-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-art, BeforeValidation>
      * <TOTEM:END>
           .

       ef-art-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-art, AfterValidation>
      * <TOTEM:END>
           .

      * ef-art's Validation
       ef-art-VALIDATION.
           PERFORM ef-art-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-art-AFTER-VALIDATION
           .

       ef-imb-ord-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imb-ord, BeforeValidation>
      * <TOTEM:END>
           .

       ef-imb-ord-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imb-ord, AfterValidation>
      * <TOTEM:END>
           .

      * ef-imb-ord's Validation
       ef-imb-ord-VALIDATION.
           PERFORM ef-imb-ord-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-imb-ord-AFTER-VALIDATION
           .

       ef-qta-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta, BeforeValidation>
      * <TOTEM:END>
           .

       ef-qta-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-qta, AfterValidation>
      * <TOTEM:END>
           .

      * ef-qta's Validation
       ef-qta-VALIDATION.
           PERFORM ef-qta-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-qta-AFTER-VALIDATION
           .

       ef-uni-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-uni, BeforeValidation>
      * <TOTEM:END>
           .

       ef-uni-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-uni, AfterValidation>
      * <TOTEM:END>
           .

      * ef-uni's Validation
       ef-uni-VALIDATION.
           PERFORM ef-uni-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-uni-AFTER-VALIDATION
           .

       ef-sconto-1-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-1, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-1-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-1, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto-1's Validation
       ef-sconto-1-VALIDATION.
           PERFORM ef-sconto-1-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-1-AFTER-VALIDATION
           .

       ef-sconto-2-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-2, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-2-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-2, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto-2's Validation
       ef-sconto-2-VALIDATION.
           PERFORM ef-sconto-2-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-2-AFTER-VALIDATION
           .

       ef-sconto-3-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-3, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-3-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-3, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto-3's Validation
       ef-sconto-3-VALIDATION.
           PERFORM ef-sconto-3-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-3-AFTER-VALIDATION
           .

       ef-sconto-4-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-4, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-4-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-4, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto-4's Validation
       ef-sconto-4-VALIDATION.
           PERFORM ef-sconto-4-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-4-AFTER-VALIDATION
           .

       ef-sconto-5-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-5, BeforeValidation>
      * <TOTEM:END>
           .

       ef-sconto-5-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-sconto-5, AfterValidation>
      * <TOTEM:END>
           .

      * ef-sconto-5's Validation
       ef-sconto-5-VALIDATION.
           PERFORM ef-sconto-5-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-sconto-5-AFTER-VALIDATION
           .

       ef-cons-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cons, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cons-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cons, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cons's Validation
       ef-cons-VALIDATION.
           PERFORM ef-cons-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cons-AFTER-VALIDATION
           .

       ef-cou-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cou, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cou-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cou, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cou's Validation
       ef-cou-VALIDATION.
           PERFORM ef-cou-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cou-AFTER-VALIDATION
           .

       ef-add-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-add, BeforeValidation>
      * <TOTEM:END>
           .

       ef-add-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-add, AfterValidation>
      * <TOTEM:END>
           .

      * ef-add's Validation
       ef-add-VALIDATION.
           PERFORM ef-add-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-add-AFTER-VALIDATION
           .

       ef-costi-agg-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-costi-agg, BeforeValidation>
      * <TOTEM:END>
           .

       ef-costi-agg-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-costi-agg, AfterValidation>
      * <TOTEM:END>
           .

      * ef-costi-agg's Validation
       ef-costi-agg-VALIDATION.
           PERFORM ef-costi-agg-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-costi-agg-AFTER-VALIDATION
           .

       ef-imp-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imp, BeforeValidation>
      * <TOTEM:END>
           .

       ef-imp-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-imp, AfterValidation>
      * <TOTEM:END>
           .

      * ef-imp's Validation
       ef-imp-VALIDATION.
           PERFORM ef-imp-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-imp-AFTER-VALIDATION
           .

       ef-cod-iva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-iva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cod-iva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cod-iva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cod-iva's Validation
       ef-cod-iva-VALIDATION.
           PERFORM ef-cod-iva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cod-iva-AFTER-VALIDATION
           .

       ef-impforn-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-impforn, BeforeValidation>
      * <TOTEM:END>
           .

       ef-impforn-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-impforn, AfterValidation>
      * <TOTEM:END>
           .

      * ef-impforn's Validation
       ef-impforn-VALIDATION.
           PERFORM ef-impforn-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-impforn-AFTER-VALIDATION
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * DB_Entry-Field : ef-anno
           MOVE ef-anno-BUF TO tof-anno
      * DB_Entry-Field : ef-cau
           MOVE ef-cau-BUF TO tof-causale
      * DB_Entry-Field : ef-cli
           MOVE ef-cli-BUF TO tof-cod-forn
      * DB_Entry-Field : ef-dest
           MOVE ef-dest-BUF TO tof-destino
      * DB_Entry-Field : ef-data
           MOVE ef-data-BUF TO tof-data-ordine
      * DB_Entry-Field : ef-data-cons
           MOVE ef-data-cons-BUF TO tof-data-consegna
      * DB_Entry-Field : ef-data-listino
           MOVE ef-data-listino-BUF TO tof-data-listino
      * DB_CHECK BOX : chk-aperto
              IF chk-aperto-BUF = 1
                 MOVE 1 TO tof-aperto
              ELSE
                 MOVE 0 TO tof-aperto
              END-IF
      * DB_CHECK BOX : chk-franco
              IF chk-franco-BUF = 1
                 MOVE 1 TO tof-franco-part
              ELSE
                 MOVE 0 TO tof-franco-part
              END-IF
      * DB_Entry-Field : ef-promo
           MOVE ef-promo-BUF TO tof-promo
      * DB_CHECK BOX : chk-dati-fatt
              IF chk-dati-fatt-BUF = 1
                 MOVE 1 TO tof-st-dati-fatt
              ELSE
                 MOVE 0 TO tof-st-dati-fatt
              END-IF
      * DB_Entry-Field : ef-cliente
           MOVE ef-cliente-BUF TO tof-cliente
      * DB_Entry-Field : ef-des-cli
           MOVE ef-des-cli-BUF TO tof-destino-c
      * DB_Entry-Field : ef-evasione
           MOVE ef-evasione-BUF TO tof-evasione
      * DB_Entry-Field : ef-referente
           MOVE ef-referente-BUF TO tof-referente
      * DB_Entry-Field : ef-tel
           MOVE ef-tel-BUF TO tof-tel-dir
      * DB_Entry-Field : ef-fax
           MOVE ef-fax-BUF TO tof-fax
      * DB_Entry-Field : ef-mail
           MOVE ef-mail-BUF TO tof-email
      * DB_Entry-Field : ef-pag
           MOVE ef-pag-BUF TO tof-cod-pagamento
      * DB_Entry-Field : ef-ese-iva
           MOVE ef-ese-iva-BUF TO tof-cod-ese-iva
      * DB_RADIOBOX : rb-urgente, rb-normale, 
           EVALUATE Form1-RADIO-1-BUF
           WHEN 1
              MOVE "U" TO tof-tipo-scarico
           WHEN 2
              MOVE "space" TO tof-tipo-scarico
           WHEN OTHER
              MOVE SPACE TO tof-tipo-scarico
           END-EVALUATE
      * DB_Entry-Field : ef-note-1
           MOVE ef-note-1-BUF TO como-note(1)
      * DB_Entry-Field : ef-note-2
           MOVE ef-note-2-BUF TO como-note(2)
      * DB_Entry-Field : ef-note-3
           MOVE ef-note-3-BUF TO como-note(3)
      * DB_Entry-Field : ef-note-4
           MOVE ef-note-4-BUF TO como-note(4)
      * DB_Entry-Field : ef-art
           MOVE ef-art-BUF TO rof-cod-articolo
      * DB_Entry-Field : ef-imb-ord
           MOVE ef-imb-ord-BUF TO rof-imb-ordinato
      * DB_Entry-Field : ef-qta
           MOVE ef-qta-BUF TO rof-qta-ord
      * DB_Entry-Field : ef-uni
           MOVE ef-uni-BUF TO rof-prz-unitario
      * DB_Entry-Field : ef-sconto-1
           MOVE ef-sconto-1-BUF TO rof-sconto-1
      * DB_Entry-Field : ef-sconto-2
           MOVE ef-sconto-2-BUF TO rof-sconto-2
      * DB_Entry-Field : ef-sconto-3
           MOVE ef-sconto-3-BUF TO rof-sconto-3
      * DB_Entry-Field : ef-sconto-4
           MOVE ef-sconto-4-BUF TO rof-sconto-4
      * DB_Entry-Field : ef-sconto-5
           MOVE ef-sconto-5-BUF TO rof-sconto-5
      * DB_Entry-Field : ef-cons
           MOVE ef-cons-BUF TO rof-imp-consumo
      * DB_Entry-Field : ef-cou
           MOVE ef-cou-BUF TO rof-imp-cou-cobat
      * DB_Entry-Field : ef-add
           MOVE ef-add-BUF TO rof-add-piombo
      * DB_Entry-Field : ef-costi-agg
           MOVE ef-costi-agg-BUF TO rof-costi-aggiuntivi
      * DB_Entry-Field : ef-imp
           MOVE ef-imp-BUF TO rof-imponib-merce
      * DB_Entry-Field : ef-cod-iva
           MOVE ef-cod-iva-BUF TO rof-cod-iva
      * DB_CHECK BOX : chk-manuale
              IF chk-manuale-BUF = 1
                 MOVE 1 TO rof-manuale
              ELSE
                 MOVE 0 TO rof-manuale
              END-IF
      * DB_Entry-Field : ef-impforn
           MOVE ef-impforn-BUF TO rof-imf-codice
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
           perform AFTER-BUF-TO-FLD-PROCEDURE.

           .
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * <TOTEM:END>
      * DB_Entry-Field : ef-anno
           MOVE tof-anno TO ef-anno-BUF
      * DB_Entry-Field : ef-cau
           MOVE tof-causale TO ef-cau-BUF
      * DB_Entry-Field : ef-cli
           MOVE tof-cod-forn TO ef-cli-BUF
      * DB_Entry-Field : ef-dest
           MOVE tof-destino TO ef-dest-BUF
      * DB_LABEL : lab-cli
              MOVE cli-ragsoc-1 OF clienti  TO lab-cli-BUF
      * DB_LABEL : lab-ind-cli
              MOVE cli-indirizzo OF clienti  TO lab-ind-cli-BUF
      * DB_LABEL : lab-loc-cli
              MOVE cli-localita OF clienti  TO lab-loc-cli-BUF
      * DB_Entry-Field : ef-data
           MOVE tof-data-ordine TO ef-data-BUF
      * DB_Entry-Field : ef-data-cons
           MOVE tof-data-consegna TO ef-data-cons-BUF
      * DB_Entry-Field : ef-data-listino
           MOVE tof-data-listino TO ef-data-listino-BUF
      * DB_CHECK BOX : chk-aperto
              IF tof-aperto = 1
                 MOVE 1 TO chk-aperto-BUF
              ELSE
                 MOVE 0 TO chk-aperto-BUF
              END-IF
      * DB_CHECK BOX : chk-franco
              IF tof-franco-part = 1
                 MOVE 1 TO chk-franco-BUF
              ELSE
                 MOVE 0 TO chk-franco-BUF
              END-IF
      * DB_Entry-Field : ef-promo
           MOVE tof-promo TO ef-promo-BUF
      * DB_CHECK BOX : chk-dati-fatt
              IF tof-st-dati-fatt = 1
                 MOVE 1 TO chk-dati-fatt-BUF
              ELSE
                 MOVE 0 TO chk-dati-fatt-BUF
              END-IF
      * DB_Entry-Field : ef-cliente
           MOVE tof-cliente TO ef-cliente-BUF
      * DB_Entry-Field : ef-des-cli
           MOVE tof-destino-c TO ef-des-cli-BUF
      * DB_Entry-Field : ef-evasione
           MOVE tof-evasione TO ef-evasione-BUF
      * DB_Entry-Field : ef-referente
           MOVE tof-referente TO ef-referente-BUF
      * DB_Entry-Field : ef-tel
           MOVE tof-tel-dir TO ef-tel-BUF
      * DB_Entry-Field : ef-fax
           MOVE tof-fax TO ef-fax-BUF
      * DB_Entry-Field : ef-mail
           MOVE tof-email TO ef-mail-BUF
      * DB_Entry-Field : ef-pag
           MOVE tof-cod-pagamento TO ef-pag-BUF
      * DB_Entry-Field : ef-ese-iva
           MOVE tof-cod-ese-iva TO ef-ese-iva-BUF
      * DB_RADIOBOX : rb-urgente, rb-normale, 
           EVALUATE tof-tipo-scarico
           WHEN "U"
              MOVE 1 TO Form1-RADIO-1-BUF
           WHEN "space"
              MOVE 2 TO Form1-RADIO-1-BUF
           WHEN OTHER
              MOVE ZERO TO Form1-RADIO-1-BUF
           END-EVALUATE
      * DB_Entry-Field : ef-note-1
           MOVE como-note(1) TO ef-note-1-BUF
      * DB_Entry-Field : ef-note-2
           MOVE como-note(2) TO ef-note-2-BUF
      * DB_Entry-Field : ef-note-3
           MOVE como-note(3) TO ef-note-3-BUF
      * DB_Entry-Field : ef-note-4
           MOVE como-note(4) TO ef-note-4-BUF
      * DB_LABEL : lab-cliente
              MOVE cli-ragsoc-1 OF clienti1  TO lab-cliente-BUF
      * DB_LABEL : lab-des-cli
              MOVE des-ragsoc-1  TO lab-des-cli-BUF
      * DB_LABEL : lab-des-loca
              MOVE des-localita  TO lab-des-loca-BUF
      * DB_LABEL : lab-promo
              MOVE como-descr-promo  TO lab-promo-BUF
      * DB_Entry-Field : ef-art
           MOVE rof-cod-articolo TO ef-art-BUF
      * DB_Entry-Field : ef-imb-ord
           MOVE rof-imb-ordinato TO ef-imb-ord-BUF
      * DB_Entry-Field : ef-qta
           MOVE rof-qta-ord TO ef-qta-BUF
      * DB_Entry-Field : ef-uni
           MOVE rof-prz-unitario TO ef-uni-BUF
      * DB_Entry-Field : ef-sconto-1
           MOVE rof-sconto-1 TO ef-sconto-1-BUF
      * DB_Entry-Field : ef-sconto-2
           MOVE rof-sconto-2 TO ef-sconto-2-BUF
      * DB_Entry-Field : ef-sconto-3
           MOVE rof-sconto-3 TO ef-sconto-3-BUF
      * DB_Entry-Field : ef-sconto-4
           MOVE rof-sconto-4 TO ef-sconto-4-BUF
      * DB_Entry-Field : ef-sconto-5
           MOVE rof-sconto-5 TO ef-sconto-5-BUF
      * DB_Entry-Field : ef-cons
           MOVE rof-imp-consumo TO ef-cons-BUF
      * DB_Entry-Field : ef-cou
           MOVE rof-imp-cou-cobat TO ef-cou-BUF
      * DB_Entry-Field : ef-add
           MOVE rof-add-piombo TO ef-add-BUF
      * DB_Entry-Field : ef-costi-agg
           MOVE rof-costi-aggiuntivi TO ef-costi-agg-BUF
      * DB_Entry-Field : ef-imp
           MOVE rof-imponib-merce TO ef-imp-BUF
      * DB_Entry-Field : ef-cod-iva
           MOVE rof-cod-iva TO ef-cod-iva-BUF
      * DB_LABEL : lab-art
              MOVE art-descrizione  TO lab-art-BUF
      * DB_LABEL : lab-imb
              MOVE imballo-descrizione  TO lab-imb-BUF
      * DB_CHECK BOX : chk-manuale
              IF rof-manuale = 0
                 MOVE 0 TO chk-manuale-BUF
              ELSE
                 MOVE 1 TO chk-manuale-BUF
              END-IF
      * DB_Entry-Field : ef-impforn
           MOVE rof-imf-codice TO ef-impforn-BUF
      * DB_LABEL : lab-cau
              MOVE tca-descrizione  TO lab-cau-BUF
      * DB_LABEL : lab-loc-dest
              MOVE desf-localita  TO lab-loc-dest-BUF
      * DB_LABEL : lab-ind-dest
              MOVE desf-indirizzo  TO lab-ind-dest-BUF
      * DB_LABEL : lab-dest
              MOVE desf-ragsoc-1  TO lab-dest-BUF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
           perform AFTER-FLD-TO-BUF-PROCEDURE.

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           if tof-data-ordine not = old-tof-data-ordine
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data è l'ID del campo ef-data
              move 78-ID-ef-data to store-id 
           end-if

           if tof-data-consegna not = old-tof-data-consegna
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data-cons è l'ID del campo ef-data-cons
              move 78-ID-ef-data-cons to store-id 
           end-if

           if tof-data-listino not = old-tof-data-listino
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-data-listino è l'ID del campo ef-data-listino
              move 78-ID-ef-data-listino to store-id 
           end-if

           if tof-aperto not = old-tof-aperto
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-aperto è l'ID del campo chk-aperto
              move 78-ID-chk-aperto to store-id 
           end-if

           if tof-franco-part not = old-tof-franco-part
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-franco è l'ID del campo chk-franco
              move 78-ID-chk-franco to store-id 
           end-if

           if tof-promo not = old-tof-promo
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-promo è l'ID del campo ef-promo
              move 78-ID-ef-promo to store-id 
           end-if

           if tof-st-dati-fatt not = old-tof-st-dati-fatt
              and SiSalvato
              set NoSalvato to true
              |78-ID-chk-dati-fatt è l'ID del campo chk-dati-fatt
              move 78-ID-chk-dati-fatt to store-id 
           end-if

           if tof-cliente not = old-tof-cliente
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cliente è l'ID del campo ef-cliente
              move 78-ID-ef-cliente to store-id 
           end-if

           if tof-destino-c not = old-tof-destino-c
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-des-cli è l'ID del campo ef-des-cli
              move 78-ID-ef-des-cli to store-id 
           end-if

           if tof-evasione not = old-tof-evasione
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-evasione è l'ID del campo ef-evasione
              move 78-ID-ef-evasione to store-id 
           end-if

           if tof-referente not = old-tof-referente
              and SiSalvato
              set NoSalvato to true
              |16 è l'ID del campo ef-referente
              move 16 to store-id
           end-if

           if tof-tel-dir not = old-tof-tel-dir
              and SiSalvato
              set NoSalvato to true
              |17 è l'ID del campo ef-tel
              move 17 to store-id
           end-if

           if tof-fax not = old-tof-fax
              and SiSalvato
              set NoSalvato to true
              |18 è l'ID del campo ef-fax
              move 18 to store-id
           end-if

           if tof-email not = old-tof-email
              and SiSalvato
              set NoSalvato to true
              |19 è l'ID del campo ef-mail
              move 19 to store-id
           end-if

           if tof-cod-pagamento not = old-tof-cod-pagamento
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-pag è l'ID del campo ef-pag
              move 78-ID-ef-pag to store-id 
           end-if

           if tof-cod-ese-iva not = old-tof-cod-ese-iva
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ese-iva è l'ID del campo ef-ese-iva
              move 78-ID-ef-ese-iva to store-id 
           end-if

           if como-note(1) not = old-como-note(1)
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-1 è l'ID del campo ef-note-1
              move 78-ID-ef-note-1 to store-id 
           end-if

           if como-note(2) not = old-como-note(2)
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-2 è l'ID del campo ef-note-2
              move 78-ID-ef-note-2 to store-id 
           end-if

           if como-note(3) not = old-como-note(3)
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-3 è l'ID del campo ef-note-3
              move 78-ID-ef-note-3 to store-id 
           end-if

           if como-note(4) not = old-como-note(4)
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-note-4 è l'ID del campo ef-note-4
              move 78-ID-ef-note-4 to store-id 
           end-if

           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           MOVE DataSet1-tordforn-KEY1-ORDER TO TMP-Form1-KEY1-ORDER
           MOVE DataSet1-KEYIS TO TMP-Form1-KEYIS
           MOVE tof-rec OF tordforn TO 
              TMP-Form1-tordforn-RESTOREBUF
           .             

       Form1-Restore-Status.
           MOVE TMP-Form1-KEY1-ORDER TO DataSet1-tordforn-KEY1-ORDER
           MOVE TMP-Form1-KEYIS TO DataSet1-KEYIS
           MOVE TMP-Form1-tordforn-RESTOREBUF TO
              tof-rec OF tordforn
           PERFORM DataSet1-tordforn-START
           IF Valid-STATUS-tordforn
              PERFORM DataSet1-tordforn-Read-Next
           ELSE
              PERFORM DataSet1-tordforn-INITREC
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-tordforn OR
              (Valid-STATUS-tordforn AND
                 tof-rec OF tordforn = 
                   TMP-Form1-tordforn-RESTOREBUF)
              PERFORM DataSet1-tordforn-Read-Next
           END-PERFORM
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-dest è l'ID del campo ef-dest
           when 78-ID-ef-dest
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-promo è l'ID del campo ef-promo
           when 78-ID-ef-promo
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cliente è l'ID del campo ef-cliente
           when 78-ID-ef-cliente
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-des-cli è l'ID del campo ef-des-cli
           when 78-ID-ef-des-cli
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-evasione è l'ID del campo ef-evasione
           when 78-ID-ef-evasione
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-ese-iva è l'ID del campo ef-ese-iva
           when 78-ID-ef-ese-iva
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-art è l'ID del campo ef-art
           when 78-ID-ef-art
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-imb-ord è l'ID del campo ef-imb-ord
           when 78-ID-ef-imb-ord
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-impforn è l'ID del campo ef-impforn
           when 78-ID-ef-impforn
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |78-ID-ef-uni è l'ID del campo ef-uni
           when 78-ID-ef-uni
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto-1 è l'ID del campo ef-sconto-1
           when 78-ID-ef-sconto-1
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto-2 è l'ID del campo ef-sconto-2
           when 78-ID-ef-sconto-2
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto-3 è l'ID del campo ef-sconto-3
           when 78-ID-ef-sconto-3
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto-4 è l'ID del campo ef-sconto-4
           when 78-ID-ef-sconto-4
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-sconto-5 è l'ID del campo ef-sconto-5
           when 78-ID-ef-sconto-5
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-cons è l'ID del campo ef-cons
           when 78-ID-ef-cons
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-cou è l'ID del campo ef-cou
           when 78-ID-ef-cou
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-add è l'ID del campo ef-add
           when 78-ID-ef-add
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-costi-agg è l'ID del campo ef-costi-agg
           when 78-ID-ef-costi-agg
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-imp è l'ID del campo ef-imp
           when 78-ID-ef-imp
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-dest è l'ID del campo ef-dest
           when 78-ID-ef-dest
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-promo è l'ID del campo ef-promo
           when 78-ID-ef-promo
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cliente è l'ID del campo ef-cliente
           when 78-ID-ef-cliente
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-des-cli è l'ID del campo ef-des-cli
           when 78-ID-ef-des-cli
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-evasione è l'ID del campo ef-evasione
           when 78-ID-ef-evasione
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-ese-iva è l'ID del campo ef-ese-iva
           when 78-ID-ef-ese-iva
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-art è l'ID del campo ef-art
           when 78-ID-ef-art
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-imb-ord è l'ID del campo ef-imb-ord
           when 78-ID-ef-imb-ord
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-impforn è l'ID del campo ef-impforn
           when 78-ID-ef-impforn
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |78-ID-ef-uni è l'ID del campo ef-uni
           when 78-ID-ef-uni
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto-1 è l'ID del campo ef-sconto-1
           when 78-ID-ef-sconto-1
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto-2 è l'ID del campo ef-sconto-2
           when 78-ID-ef-sconto-2
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto-3 è l'ID del campo ef-sconto-3
           when 78-ID-ef-sconto-3
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto-4 è l'ID del campo ef-sconto-4
           when 78-ID-ef-sconto-4
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-sconto-5 è l'ID del campo ef-sconto-5
           when 78-ID-ef-sconto-5
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-cons è l'ID del campo ef-cons
           when 78-ID-ef-cons
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-cou è l'ID del campo ef-cou
           when 78-ID-ef-cou
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-add è l'ID del campo ef-add
           when 78-ID-ef-add
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-costi-agg è l'ID del campo ef-costi-agg
           when 78-ID-ef-costi-agg
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-imp è l'ID del campo ef-imp
           when 78-ID-ef-imp
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |78-ID-ef-anno è l'ID del campo ef-anno
           when 78-ID-ef-anno
                perform CONTROLLO
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                perform CONTROLLO
           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                perform CONTROLLO
           |78-ID-ef-dest è l'ID del campo ef-dest
           when 78-ID-ef-dest
                perform CONTROLLO
           |78-ID-ef-data è l'ID del campo ef-data
           when 78-ID-ef-data
                perform CONTROLLO
           |78-ID-ef-data-cons è l'ID del campo ef-data-cons
           when 78-ID-ef-data-cons
                perform CONTROLLO
           |78-ID-ef-data-listino è l'ID del campo ef-data-listino
           when 78-ID-ef-data-listino
                perform CONTROLLO
           |78-ID-ef-promo è l'ID del campo ef-promo
           when 78-ID-ef-promo
                perform CONTROLLO
           |78-ID-ef-cliente è l'ID del campo ef-cliente
           when 78-ID-ef-cliente
                perform CONTROLLO
           |78-ID-ef-des-cli è l'ID del campo ef-des-cli
           when 78-ID-ef-des-cli
                perform CONTROLLO
           |78-ID-ef-evasione è l'ID del campo ef-evasione
           when 78-ID-ef-evasione
                perform CONTROLLO
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                perform CONTROLLO
           |78-ID-ef-ese-iva è l'ID del campo ef-ese-iva
           when 78-ID-ef-ese-iva
                perform CONTROLLO
           |22 è l'ID del campo rb-urgente
           when 22
                perform CONTROLLO
           |23 è l'ID del campo rb-normale
           when 23
                perform CONTROLLO
           |78-ID-ef-art è l'ID del campo ef-art
           when 78-ID-ef-art
                perform CONTROLLO
           |78-ID-ef-imb-ord è l'ID del campo ef-imb-ord
           when 78-ID-ef-imb-ord
                perform CONTROLLO
           |78-ID-ef-qta è l'ID del campo ef-qta
           when 78-ID-ef-qta
                perform CONTROLLO
           |78-ID-ef-uni è l'ID del campo ef-uni
           when 78-ID-ef-uni
                perform CONTROLLO
           |78-ID-ef-sconto-1 è l'ID del campo ef-sconto-1
           when 78-ID-ef-sconto-1
                perform CONTROLLO
           |78-ID-ef-sconto-2 è l'ID del campo ef-sconto-2
           when 78-ID-ef-sconto-2
                perform CONTROLLO
           |78-ID-ef-sconto-3 è l'ID del campo ef-sconto-3
           when 78-ID-ef-sconto-3
                perform CONTROLLO
           |78-ID-ef-sconto-4 è l'ID del campo ef-sconto-4
           when 78-ID-ef-sconto-4
                perform CONTROLLO
           |78-ID-ef-sconto-5 è l'ID del campo ef-sconto-5
           when 78-ID-ef-sconto-5
                perform CONTROLLO
           |78-ID-ef-cons è l'ID del campo ef-cons
           when 78-ID-ef-cons
                perform CONTROLLO
           |78-ID-ef-cou è l'ID del campo ef-cou
           when 78-ID-ef-cou
                perform CONTROLLO
           |78-ID-ef-add è l'ID del campo ef-add
           when 78-ID-ef-add
                perform CONTROLLO
           |78-ID-ef-costi-agg è l'ID del campo ef-costi-agg
           when 78-ID-ef-costi-agg
                perform CONTROLLO
           |78-ID-ef-imp è l'ID del campo ef-imp
           when 78-ID-ef-imp
                perform CONTROLLO
           |78-ID-ef-cod-iva è l'ID del campo ef-cod-iva
           when 78-ID-ef-cod-iva
                perform CONTROLLO
           |78-ID-ef-impforn è l'ID del campo ef-impforn
           when 78-ID-ef-impforn
                perform CONTROLLO
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.

       scr-importa-Open-Routine.
           PERFORM scr-importa-Scrn
           PERFORM scr-importa-Proc
           .

       scr-importa-Scrn.
           PERFORM scr-importa-Create-Win
           PERFORM scr-importa-Init-Value
           PERFORM scr-importa-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM scr-importa-DISPLAY
           .

       scr-importa-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 7,28,
              SIZE 19,80,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              CONTROL FONT Verdana12-Occidentale,
              LINK TO THREAD,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE scr-stampa-Event-Proc,
              HANDLE IS scr-stampa-Handle,
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY scr-importa UPON scr-stampa-Handle
      * DISPLAY-COLUMNS settings
           .

       scr-importa-PROC.
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, BeforeAccept>
           move 0 to ef-anno-ord-buf ef-numero-ord-buf.
           display ef-anno-ord ef-numero-ord.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT scr-importa
                 ON EXCEPTION
                    PERFORM scr-importa-Evaluate-Func
                 MOVE 2 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY scr-stampa-Handle
           INITIALIZE Key-Status
           .

       scr-importa-Evaluate-Func.
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM scr-importa-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM scr-importa-Exit
                 END-IF
              WHEN Key-Status = 1000
                 PERFORM pb-ricerca-ok-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       scr-importa-CLEAR.
           PERFORM scr-importa-INIT-VALUE
           PERFORM scr-importa-DISPLAY
           .

       scr-importa-DISPLAY.
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY scr-importa UPON scr-stampa-Handle
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       scr-importa-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       scr-importa-Init-Data.
           MOVE 2 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       scr-importa-Init-Value.
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, SetDefault>
      * <TOTEM:END>
           PERFORM scr-importa-FLD-TO-BUF
           .


       scr-importa-ALLGRID-RESET.
           .

      * for Form's Validation
       scr-importa-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       scr-importa-Buf-To-Fld.
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, AfterBufToFld>
      * <TOTEM:END>
           .

       scr-importa-Fld-To-Buf.
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-importa, FORM:scr-importa, AfterFldToBuf>
      * <TOTEM:END>
           .

       scr-importa-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform scr-importa-BUF-TO-FLD.
           move 0 to scelta.
           .
       scr-importa-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM scr-importa-SHOW-MSG-ROUTINE
           .

       scr-importa-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM scr-importa-DISPLAY-MESSAGE
           .

       scr-importa-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       scr-importa-Save-Status.
           .             

       scr-importa-Restore-Status.
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen scr-importa
      ***---
       scr-importa-BEFORE-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen scr-importa
      ***---
       scr-importa-AFTER-SCREEN.
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.



       Screen1-Ta-1-TABCHANGE.
           MOVE 0 TO 
                   Form1-Pg-1-Visible,
                   Form1-Pg-2-Visible,
           EVALUATE Screen1-Ta-1-TAB-VALUE
           WHEN 1
                  MOVE 1 TO Form1-Pg-1-Visible
                  MODIFY Screen1-Ta-1, VALUE = 1
           WHEN 2
                  MOVE 1 TO Form1-Pg-2-Visible
                  MODIFY Screen1-Ta-1, VALUE = 2
           END-EVALUATE
           MOVE 5000 TO CONTROL-ID
           DISPLAY Form1
           .

       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "Immettere l'anno dell'ordine" to 
           TOTEM-HINT-TEXT
           WHEN 5002 MOVE "Immettere la causale di magazzino" to 
           TOTEM-HINT-TEXT
           WHEN 5003 MOVE "Immettere il cliente dell'ordine" to 
           TOTEM-HINT-TEXT
           WHEN 5004 MOVE "Immettere il destino del fornitore" to 
           TOTEM-HINT-TEXT
           WHEN 5005 MOVE "Digitare la data dell'ordine" to 
           TOTEM-HINT-TEXT
           WHEN 5006 MOVE "Digitare la data di consegna" to 
           TOTEM-HINT-TEXT
           WHEN 5007 MOVE "Digitare la data del Listino" to 
           TOTEM-HINT-TEXT
           WHEN 5008 MOVE "Aperto = NON lavora sull'ordinato" to 
           TOTEM-HINT-TEXT
           WHEN 5009 MOVE "Franco Partenza" to TOTEM-HINT-TEXT
           WHEN 5010 MOVE "Digitare il codice della Promo" to 
           TOTEM-HINT-TEXT
           WHEN 5011 MOVE "Rende visibile il riquadro DATI DI FATTURAZIO
      -    "NE in stampa ordine" to TOTEM-HINT-TEXT
           WHEN 5012 MOVE "Digitare il Cliente di consegna" to 
           TOTEM-HINT-TEXT
           WHEN 5013 MOVE "Digitare il Destino di consegna" to 
           TOTEM-HINT-TEXT
           WHEN 5014 MOVE "Digitare il numero di evasione" to 
           TOTEM-HINT-TEXT
           WHEN 16 MOVE "Digitare il nome del referente" to 
           TOTEM-HINT-TEXT
           WHEN 17 MOVE "Digitare il telefono diretto" to 
           TOTEM-HINT-TEXT
           WHEN 18 MOVE "Digitare il Fax" to TOTEM-HINT-TEXT
           WHEN 19 MOVE "Digitare la Mail" to TOTEM-HINT-TEXT
           WHEN 5015 MOVE "Digitare il codice di pagamento" to 
           TOTEM-HINT-TEXT
           WHEN 5016 MOVE "Digitare il codice di Esenzione Iva" to 
           TOTEM-HINT-TEXT
           WHEN 22 MOVE "Modalità d'inserimento manuale" to 
           TOTEM-HINT-TEXT
           WHEN 23 MOVE "Modalità d'inserimento guidata" to 
           TOTEM-HINT-TEXT
           WHEN 5017 MOVE "Digitare i dati di consegna" to 
           TOTEM-HINT-TEXT
           WHEN 5018 MOVE "Digitare le note di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5019 MOVE "Digitare le note di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5020 MOVE "Digitare le note di destinazione" to 
           TOTEM-HINT-TEXT
           WHEN 5021 MOVE "Digitare il codice dell'articolo" to 
           TOTEM-HINT-TEXT
           WHEN 5022 MOVE "Imballo ordinato" to TOTEM-HINT-TEXT
           WHEN 5023 MOVE "Digitare la quantit" to TOTEM-HINT-TEXT
           WHEN 5024 MOVE "Digitare il prezzo unitario" to 
           TOTEM-HINT-TEXT
           WHEN 5025 MOVE "Percentuale di sconto" to TOTEM-HINT-TEXT
           WHEN 5026 MOVE "Percentuale di sconto" to TOTEM-HINT-TEXT
           WHEN 5027 MOVE "Percentuale di sconto" to TOTEM-HINT-TEXT
           WHEN 5028 MOVE "Percentuale di sconto" to TOTEM-HINT-TEXT
           WHEN 5029 MOVE "Percentuale di sconto" to TOTEM-HINT-TEXT
           WHEN 5030 MOVE "Valore imposta sul consumo" to 
           TOTEM-HINT-TEXT
           WHEN 5031 MOVE "Valore imposta COU/COBAT" to TOTEM-HINT-TEXT
           WHEN 5032 MOVE "Valore addizionale piombo" to TOTEM-HINT-TEXT
           WHEN 5033 MOVE "Valore addizionale piombo" to TOTEM-HINT-TEXT
           WHEN 5034 MOVE "Valore imponibile della merce" to 
           TOTEM-HINT-TEXT
           WHEN 5035 MOVE "Codice I.V.A." to TOTEM-HINT-TEXT
           WHEN 5036 MOVE "Variazione manuale di Prezzo/Imposte" to 
           TOTEM-HINT-TEXT
           WHEN 5037 MOVE "Indicare l'assoggettamento imposte" to 
           TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-anno-BeforeProcedure
           When 5002 PERFORM ef-cau-BeforeProcedure
           When 5003 PERFORM ef-cli-BeforeProcedure
           When 5004 PERFORM ef-dest-BeforeProcedure
           When 5005 PERFORM ef-data-BeforeProcedure
           When 5006 PERFORM ef-data-cons-BeforeProcedure
           When 5007 PERFORM ef-data-pass-BeforeProcedure
           When 5008 PERFORM Form1-DaCb-1-BeforeProcedure
           When 5009 PERFORM Form1-DaCb-1-BeforeProcedure
           When 5010 PERFORM ef-data-pass-BeforeProcedure
           When 5011 PERFORM Form1-DaCb-1-BeforeProcedure
           When 5012 PERFORM ef-num-ord-BeforeProcedure
           When 5013 PERFORM ef-num-ord-BeforeProcedure
           When 5014 PERFORM ef-num-ord-BeforeProcedure
           When 16 PERFORM ef-note-2-BeforeProcedure
           When 17 PERFORM ef-note-2-BeforeProcedure
           When 18 PERFORM ef-note-2-BeforeProcedure
           When 19 PERFORM ef-note-2-BeforeProcedure
           When 5015 PERFORM ef-pag-BeforeProcedure
           When 5016 PERFORM ef-pag-BeforeProcedure
           When 22 PERFORM rb-man-BeforeProcedure
           When 23 PERFORM rb-gui-BeforeProcedure
           When 5017 PERFORM ef-note-1-BeforeProcedure
           When 5018 PERFORM ef-note-2-BeforeProcedure
           When 5019 PERFORM ef-note-3-BeforeProcedure
           When 5020 PERFORM ef-note-4-BeforeProcedure
           When 5021 PERFORM ef-art-BeforeProcedure
           When 5022 PERFORM ef-qta-BeforeProcedure
           When 5023 PERFORM ef-qta-BeforeProcedure
           When 5024 PERFORM ef-uni-BeforeProcedure
           When 5025 PERFORM ef-sconto-BeforeProcedure
           When 5026 PERFORM ef-sconto-BeforeProcedure
           When 5027 PERFORM ef-sconto-BeforeProcedure
           When 5028 PERFORM ef-sconto-BeforeProcedure
           When 5029 PERFORM ef-sconto-BeforeProcedure
           When 5030 PERFORM ef-cons-BeforeProcedure
           When 5031 PERFORM ef-cou-BeforeProcedure
           When 5032 PERFORM ef-cou-BeforeProcedure
           When 5033 PERFORM ef-cou-BeforeProcedure
           When 5034 PERFORM ef-imp-BeforeProcedure
           When 5035 PERFORM ef-cod-iva-BeforeProcedure
           When 5036 PERFORM chk-manuale-BeforeProcedure
           When 5037 PERFORM Form1-DaEf-1-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Form1-AfterProcedure.
           EVALUATE Control-Id
           When 5001 PERFORM ef-anno-AfterProcedure
           When 5002 PERFORM ef-cau-AfterProcedure
           When 5003 PERFORM ef-cli-AfterProcedure
           When 5004 PERFORM ef-dest-AfterProcedure
           When 5005 PERFORM ef-data-AfterProcedure
           When 5006 PERFORM ef-data-cons-AfterProcedure
           When 5007 PERFORM ef-data-pass-AfterProcedure
           When 5008 PERFORM Form1-DaCb-1-AfterProcedure
           When 5009 PERFORM Form1-DaCb-1-AfterProcedure
           When 5010 PERFORM ef-data-pass-AfterProcedure
           When 5011 PERFORM Form1-DaCb-1-AfterProcedure
           When 5012 PERFORM ef-num-ord-AfterProcedure
           When 5013 PERFORM ef-num-ord-AfterProcedure
           When 5014 PERFORM ef-num-ord-AfterProcedure
           When 16 PERFORM ef-note-2-AfterProcedure
           When 17 PERFORM ef-note-2-AfterProcedure
           When 18 PERFORM ef-note-2-AfterProcedure
           When 19 PERFORM ef-note-2-AfterProcedure
           When 5015 PERFORM ef-pag-AfterProcedure
           When 5016 PERFORM ef-pag-AfterProcedure
           When 22 PERFORM rb-man-AfterProcedure
           When 23 PERFORM rb-gui-AfterProcedure
           When 5017 PERFORM ef-note-1-AfterProcedure
           When 5018 PERFORM ef-note-2-AfterProcedure
           When 5019 PERFORM ef-note-3-AfterProcedure
           When 5020 PERFORM ef-note-4-AfterProcedure
           When 5021 PERFORM ef-art-AfterProcedure
           When 5022 PERFORM ef-qta-AfterProcedure
           When 5023 PERFORM ef-qta-AfterProcedure
           When 5024 PERFORM ef-uni-AfterProcedure
           When 5025 PERFORM ef-sconto-AfterProcedure
           When 5026 PERFORM ef-sconto-AfterProcedure
           When 5027 PERFORM ef-sconto-AfterProcedure
           When 5028 PERFORM ef-sconto-AfterProcedure
           When 5029 PERFORM ef-sconto-AfterProcedure
           When 5030 PERFORM ef-cons-AfterProcedure
           When 5031 PERFORM ef-cou-AfterProcedure
           When 5032 PERFORM ef-cou-AfterProcedure
           When 5033 PERFORM ef-cou-AfterProcedure
           When 5034 PERFORM ef-imp-AfterProcedure
           When 5035 PERFORM ef-cod-iva-AfterProcedure
           When 5036 PERFORM chk-manuale-AfterProcedure
           When 5037 PERFORM Form1-DaEf-1-AfterProcedure
           END-EVALUATE
           perform Form1-AFTER-SCREEN
           .

       scr-importa-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "." to TOTEM-HINT-TEXT
           WHEN 5002 MOVE "." to TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM ef-anno-ord-BeforeProcedure
           When 5002 PERFORM ef-numero-ord-BeforeProcedure
           END-EVALUATE
           perform scr-importa-BEFORE-SCREEN
           .

       Form1-Event-Proc.
           .

       Screen1-Ta-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Cmd-Tabchanged ALSO 5000 ALSO
                    Form1-Handle
              PERFORM Screen1-Ta-1-Ev-Cmd-Tabchanged
           END-EVALUATE
           .

       Form1-Gd-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-End-Drag
           WHEN Msg-Goto-Cell ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 2000 ALSO
                    Form1-Handle 
              PERFORM Form1-Gd-1-Ev-Msg-Goto-Cell-Mouse
           END-EVALUATE
           .

       scr-stampa-Event-Proc.
           .

      * USER DEFINE PARAGRAPH
       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "abilita-toolbar.cpy".
      *     copy "riempi-combo-stato.cpy".
           copy "color-custom.cpy".
           copy "utydata.cpy". 
           copy "gordforn-procedure.cpy".
           copy "ordforn-procedure.cpy".
           copy "addizionale-piombo-fornitore.cpy".
           copy "prz-finito-forn.cpy".
           copy "imposte-fornitore.cpy".
           copy "costo-medio.cpy".
           copy "accessoxx.cpy".
           copy "trova-parametro.cpy".

      ***---
       RECUPERO-ANAGRAFICA 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           inquire tool-modifica, value in mod           
      
           inquire tool-salva, enabled in e-salva
           if e-salva = 1
              perform SALVA
           end-if           
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
      *     INQUIRE TOOL-ANTEPRIMA, ENABLED IN E-ANTEPRIMA.
      *     IF E-ANTEPRIMA = 1
      *          PERFORM ANTEPRIMA
      *     END-IF 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
      *     INQUIRE TOOL-MODIFICA, ENABLED IN E-MODIFICA.
      *
      *     IF E-MODIFICA = 1
      *        PERFORM MODIFICA
      *     END-IF 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
      *     INQUIRE TOOL-STAMPA, ENABLED IN E-STAMPA
      *     IF E-STAMPA = 1
      *          PERFORM STAMPA
      *     END-IF 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca
           if e-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       ef-num-ord-BeforeProcedure.
      * <TOTEM:PARA. ef-num-ord-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-data-BeforeProcedure.
      * <TOTEM:PARA. ef-data-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-data-pass-BeforeProcedure.
      * <TOTEM:PARA. ef-data-pass-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-pag-BeforeProcedure.
      * <TOTEM:PARA. ef-pag-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-1-BeforeProcedure.
      * <TOTEM:PARA. ef-note-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-data-cons-BeforeProcedure.
      * <TOTEM:PARA. ef-data-cons-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-2-BeforeProcedure.
      * <TOTEM:PARA. ef-note-2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-3-BeforeProcedure.
      * <TOTEM:PARA. ef-note-3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-note-4-BeforeProcedure.
      * <TOTEM:PARA. ef-note-4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-num-ord-AfterProcedure.
      * <TOTEM:PARA. ef-num-ord-AfterProcedure>
              INQUIRE ef-cliente, VALUE IN tof-cliente
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cliente-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-des-cli, VALUE IN tof-destino-c
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-des-cli-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-evasione, VALUE IN tof-evasione
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-evasione-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-data-AfterProcedure.
      * <TOTEM:PARA. ef-data-AfterProcedure>
              INQUIRE ef-data, VALUE IN tof-data-ordine
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-data-pass-AfterProcedure.
      * <TOTEM:PARA. ef-data-pass-AfterProcedure>
              INQUIRE ef-data-listino, VALUE IN tof-data-listino
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-listino-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-promo, VALUE IN tof-promo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-promo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-pag-AfterProcedure.
      * <TOTEM:PARA. ef-pag-AfterProcedure>
              INQUIRE ef-pag, VALUE IN tof-cod-pagamento
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-ese-iva, VALUE IN tof-cod-ese-iva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ese-iva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-1-AfterProcedure.
      * <TOTEM:PARA. ef-note-1-AfterProcedure>
              INQUIRE ef-note-1, VALUE IN como-note(1)
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-data-cons-AfterProcedure.
      * <TOTEM:PARA. ef-data-cons-AfterProcedure>
              INQUIRE ef-data-cons, VALUE IN tof-data-consegna
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-data-cons-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-2-AfterProcedure.
      * <TOTEM:PARA. ef-note-2-AfterProcedure>
              INQUIRE ef-referente, VALUE IN tof-referente
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-referente-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-tel, VALUE IN tof-tel-dir
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-tel-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-fax, VALUE IN tof-fax
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-fax-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-mail, VALUE IN tof-email
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-mail-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-note-2, VALUE IN como-note(2)
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-3-AfterProcedure.
      * <TOTEM:PARA. ef-note-3-AfterProcedure>
              INQUIRE ef-note-3, VALUE IN como-note(3)
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-3-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-note-4-AfterProcedure.
      * <TOTEM:PARA. ef-note-4-AfterProcedure>
              INQUIRE ef-note-4, VALUE IN como-note(4)
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-note-4-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       rb-man-AfterProcedure.
      * <TOTEM:PARA. rb-man-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       rb-gui-AfterProcedure.
      * <TOTEM:PARA. rb-gui-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       rb-man-BeforeProcedure.
      * <TOTEM:PARA. rb-man-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       rb-gui-BeforeProcedure.
      * <TOTEM:PARA. rb-gui-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
      *****     if SaveGDO = spaces 
      *****        display message box "Modalità di caricamento possibile "
      *****                            "solo per Clienti appartenenti a GDO"
      *****                title = titolo
      *****                icon MB-WARNING-ICON
      *****
      *****        move 1 to form1-radio-1-buf
      *****        display rb-man rb-gui
      *****        perform CANCELLA-COLORE
      *****        move 78-ID-rb-man to CONTROL-ID
      *****        move 4            to ACCEPT-CONTROL
      *****     end-if 
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-anno-BeforeProcedure.
      * <TOTEM:PARA. ef-anno-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cli-BeforeProcedure.
      * <TOTEM:PARA. ef-cli-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-anno-AfterProcedure.
      * <TOTEM:PARA. ef-anno-AfterProcedure>
              INQUIRE ef-anno, VALUE IN tof-anno
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-anno-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cli-AfterProcedure.
      * <TOTEM:PARA. ef-cli-AfterProcedure>
              INQUIRE ef-cli, VALUE IN tof-cod-forn
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cli-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Screen1-Ta-1-Ev-Cmd-Tabchanged.
      * <TOTEM:PARA. Screen1-Ta-1-Ev-Cmd-Tabchanged>
           perform CHANGE-TAB 
           .
      * <TOTEM:END>
       ef-art-BeforeProcedure.
      * <TOTEM:PARA. ef-art-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
      *     inquire ef-art, value in art-codice.
      *     if art-codice = 0
      *        move 0          to old-art-codice
      *     else
      *        move art-codice to old-art-codice
      *     end-if.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-art-AfterProcedure.
      * <TOTEM:PARA. ef-art-AfterProcedure>
              INQUIRE ef-art, VALUE IN rof-cod-articolo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-art-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-qta-BeforeProcedure.
      * <TOTEM:PARA. ef-qta-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI.                                        
             
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-qta-AfterProcedure.
      * <TOTEM:PARA. ef-qta-AfterProcedure>
              INQUIRE ef-imb-ord, VALUE IN rof-imb-ordinato
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-imb-ord-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-qta, VALUE IN rof-qta-ord
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-qta-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-uni-BeforeProcedure.
      * <TOTEM:PARA. ef-uni-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI.                          
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-uni-AfterProcedure.
      * <TOTEM:PARA. ef-uni-AfterProcedure>
              INQUIRE ef-uni, VALUE IN rof-prz-unitario
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-uni-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cou-BeforeProcedure.
      * <TOTEM:PARA. ef-cou-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI.                          
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cou-AfterProcedure.
      * <TOTEM:PARA. ef-cou-AfterProcedure>
              INQUIRE ef-cou, VALUE IN rof-imp-cou-cobat
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cou-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-add, VALUE IN rof-add-piombo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-add-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-costi-agg, VALUE IN rof-costi-aggiuntivi
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-costi-agg-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-imp-BeforeProcedure.
      * <TOTEM:PARA. ef-imp-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI.                          
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-imp-AfterProcedure.
      * <TOTEM:PARA. ef-imp-AfterProcedure>
              INQUIRE ef-imp, VALUE IN rof-imponib-merce
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-imp-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-sconto-BeforeProcedure.
      * <TOTEM:PARA. ef-sconto-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI.                          
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-sconto-AfterProcedure.
      * <TOTEM:PARA. ef-sconto-AfterProcedure>
              INQUIRE ef-sconto-1, VALUE IN rof-sconto-1
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-1-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-sconto-2, VALUE IN rof-sconto-2
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-2-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-sconto-3, VALUE IN rof-sconto-3
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-3-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-sconto-4, VALUE IN rof-sconto-4
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-4-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-sconto-5, VALUE IN rof-sconto-5
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-sconto-5-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cod-iva-BeforeProcedure.
      * <TOTEM:PARA. ef-cod-iva-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI.                          
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cod-iva-AfterProcedure.
      * <TOTEM:PARA. ef-cod-iva-AfterProcedure>
              INQUIRE ef-cod-iva, VALUE IN rof-cod-iva
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cod-iva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-cons-BeforeProcedure.
      * <TOTEM:PARA. ef-cons-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform BEFORE-CAMPI.                          
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cons-AfterProcedure.
      * <TOTEM:PARA. ef-cons-AfterProcedure>
              INQUIRE ef-cons, VALUE IN rof-imp-consumo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cons-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       rb-man-LinkTo.
      * <TOTEM:PARA. rb-man-LinkTo>
           move 1 to form1-radio-1-buf.
           move data-oggi to como-data.
           perform DATE-TO-SCREEN.
           move como-data to ef-data-cons-buf.
           display ef-data-cons 
           .
      * <TOTEM:END>
       rb-gui-LinkTo.
      * <TOTEM:PARA. rb-gui-LinkTo>
           move 2 to form1-radio-1-buf 
           .
      * <TOTEM:END>
       pb-grid-elimina-LinkTo.
      * <TOTEM:PARA. pb-grid-elimina-LinkTo>
           inquire form1-gd-1, last-row in tot-righe, cursor-y riga.

           if tot-righe > 1
              if riga <= tot-righe or riga > 2
                 display message box "Cancellare la riga selezionta?"
                         title = titolo
                         type mb-yes-no
                         giving scelta
                 if scelta = mb-yes
                    modify  form1-gd-1, record-to-delete = riga
                    inquire form1-gd-1, last-row in tot-righe
                    if tot-righe = 1
                       perform CANCELLA-COLORE
                       perform PULISCI-CAMPI-LABELS
                    else
                       if riga > tot-righe
                          move tot-righe to riga
                       end-if
                       modify form1-gd-1, cursor-y = riga
                       move riga to event-data-2
                       perform SPOSTAMENTO
                       set ControllaCampi to true
                    end-if
                 end-if
              else
                 display message box "Occorre selezionare una riga"
                         title = titolo
              end-if
           end-if 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-End-Drag.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-End-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       Form1-Gd-1-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. Form1-Gd-1-Ev-Msg-Begin-Entry>
           set EVENT-ACTION to EVENT-ACTION-FAIL 
           .
      * <TOTEM:END>
       gordc-Ev-After-Program.
      * <TOTEM:PARA. gordc-Ev-After-Program>
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           perform ORDINI-AFTER-PROGRAM.

      *     close tmp-nordforn
      *        invalid
      *           continue
      *     end close

           delete file tmp-nordforn 
              
           .
      * <TOTEM:END>
       gordc-Ev-Before-Program.
      * <TOTEM:PARA. gordc-Ev-Before-Program>
           move LK-BL-PROG-ID    TO COMO-PROG-ID.
           move "gordforn"           to pgm-name.
      *     set OrdineTradizionale to false.
           perform ORDINI-BEFORE-PROGRAM  

           .
      * <TOTEM:END>
       ef-cau-BeforeProcedure.
      * <TOTEM:PARA. ef-cau-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-cau-AfterProcedure.
      * <TOTEM:PARA. ef-cau-AfterProcedure>
              INQUIRE ef-cau, VALUE IN tof-causale
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cau-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-grid-elimina-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-elimina-BeforeProcedure>
           modify pb-grid-elimina, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-grid-elimina-AfterProcedure.
      * <TOTEM:PARA. pb-grid-elimina-AfterProcedure>
           modify pb-grid-elimina, bitmap-number = 4 
           .
      * <TOTEM:END>
       pb-grid-nuovo-BeforeProcedure.
      * <TOTEM:PARA. pb-grid-nuovo-BeforeProcedure>
           modify pb-grid-nuovo, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-grid-nuovo-AfterProcedure.
      * <TOTEM:PARA. pb-grid-nuovo-AfterProcedure>
           modify pb-grid-nuovo, bitmap-number = 5 
           .
      * <TOTEM:END>
       pb-grid-nuovo-LinkTo.
      * <TOTEM:PARA. pb-grid-nuovo-LinkTo>
           if mod-campi = 0 exit paragraph end-if.
           perform PULISCI-CAMPI-LABELS.
           perform CANCELLA-COLORE.
           move 78-ID-ef-art to control-id.
           move 4            to accept-control.
           set  NewRow       to true.
           set  ControllaCampi to true.
           perform AZZERA-MANUALE 
           .
      * <TOTEM:END>
       pb-note-LinkTo.
      * <TOTEM:PARA. pb-note-LinkTo>
           move tof-chiave         to gnof-tof-chiave
           move path-tmp-nordforn  to gnof-path
           move mod                to gnof-mod

           call "gnote-ordforn" using gnote-rodforn-linkage
                                      LK-BLOCKPGM
                                      USER-CODI
                                      LIVELLO-ABIL
           cancel "gnote-ordforn".

           move gnof-note(1) to ef-note-1-buf
           move gnof-note(2) to ef-note-2-buf
           move gnof-note(3) to ef-note-3-buf
           move gnof-note(4) to ef-note-4-buf

           modify ef-note-1 value ef-note-1-buf
           modify ef-note-2 value ef-note-2-buf
           modify ef-note-3 value ef-note-3-buf
           modify ef-note-4 value ef-note-4-buf

           .
      * <TOTEM:END>
       Form1-Gd-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-Gd-1-BeforeProcedure>
           evaluate true
           when mod-campi = 1
                move 78-ID-ef-art to control-id
                move 4            to accept-control 
           end-evaluate 
           .
      * <TOTEM:END>
       pb-articoli-LinkTo.
      * <TOTEM:PARA. pb-articoli-LinkTo>
           perform PB-ARTICOLI-PRESSED 
           .
      * <TOTEM:END>
       pb-articoli-BeforeProcedure.
      * <TOTEM:PARA. pb-articoli-BeforeProcedure>
           move 2 to NumBitmapArticoli.
           display pb-articoli 
           .
      * <TOTEM:END>
       pb-articoli-AfterProcedure.
      * <TOTEM:PARA. pb-articoli-AfterProcedure>
           move 1 to NumBitmapArticoli.
           display pb-articoli 
           .
      * <TOTEM:END>
       ef-dest-BeforeProcedure.
      * <TOTEM:PARA. ef-dest-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 0 to num-dest save-dest.
           inquire ef-dest, value in desf-prog.
           if desf-prog = 0
              move cli-codice of clienti to desf-codice
              start destinif key >= desf-chiave
                    invalid continue
                not invalid
                    perform until 1 = 2
                       read destinif next at end exit perform end-read
                       if desf-codice not = cli-codice of clienti
                          exit perform
                       end-if
                       add 1 to num-dest
                       if num-dest = 1
                          move desf-prog to save-dest
                       end-if
                       if num-dest = 2
                          exit perform
                       end-if
                    end-perform
              end-start
              if num-dest = 1
                 move save-dest to ef-dest-buf
                 inspect ef-dest-buf replacing leading x"30" by x"20"
                 call "C$JUSTIFY" using ef-dest-buf, "L"
                 display ef-dest
              end-if
           end-if.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-dest-AfterProcedure.
      * <TOTEM:PARA. ef-dest-AfterProcedure>
              INQUIRE ef-dest, VALUE IN tof-destino
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-dest-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       Form1-DaCb-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaCb-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaCb-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaCb-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       chk-manuale-LinkTo.
      * <TOTEM:PARA. chk-manuale-LinkTo>
           perform CHK-MANUALE-PRESSED 
           .
      * <TOTEM:END>
       chk-manuale-BeforeProcedure.
      * <TOTEM:PARA. chk-manuale-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           perform CHK-MANUALE-BEFOREPROC.
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       chk-manuale-AfterProcedure.
      * <TOTEM:PARA. chk-manuale-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CHK-MANUALE-AFTERPROC.
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       Form1-DaEf-1-BeforeProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Form1-DaEf-1-AfterProcedure.
      * <TOTEM:PARA. Form1-DaEf-1-AfterProcedure>
              INQUIRE ef-impforn, VALUE IN rof-imf-codice
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-impforn-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       pb-importa-BeforeProcedure.
      * <TOTEM:PARA. pb-importa-BeforeProcedure>
           modify pb-importa, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-importa-AfterProcedure.
      * <TOTEM:PARA. pb-importa-AfterProcedure>
           modify pb-importa, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ricerca-ok-BeforeProcedure.
      * <TOTEM:PARA. pb-ricerca-ok-BeforeProcedure>
           modify pb-ricerca-ok, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ricerca-ok-AfterProcedure.
      * <TOTEM:PARA. pb-ricerca-ok-AfterProcedure>
           modify pb-ricerca-ok, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-ricerca-cancel-BeforeProcedure.
      * <TOTEM:PARA. pb-ricerca-cancel-BeforeProcedure>
           modify pb-ricerca-cancel, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ricerca-cancel-AfterProcedure.
      * <TOTEM:PARA. pb-ricerca-cancel-AfterProcedure>
           modify pb-ricerca-cancel, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-importa-LinkTo.
      * <TOTEM:PARA. pb-importa-LinkTo>
           perform SCR-IMPORTA-OPEN-ROUTINE 
           .
      * <TOTEM:END>
       ef-anno-ord-BeforeProcedure.
      * <TOTEM:PARA. ef-anno-ord-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           modify ef-anno-ord, color = colore-nu 
           .
      * <TOTEM:END>
       ef-numero-ord-BeforeProcedure.
      * <TOTEM:PARA. ef-numero-ord-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           modify ef-numero-ord, color = colore-nu 
           .
      * <TOTEM:END>
       ef-anno-ord-AfterProcedure.
      * <TOTEM:PARA. ef-anno-ord-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           modify ef-anno-ord, color = colore-or 
           .
      * <TOTEM:END>
       ef-numero-ord-AfterProcedure.
      * <TOTEM:PARA. ef-numero-ord-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           modify ef-numero-ord, color = colore-or 
           .
      * <TOTEM:END>
       pb-ricerca-ok-LinkTo.
      * <TOTEM:PARA. pb-ricerca-ok-LinkTo>
           inquire ef-anno-ord,   value in tor-anno.
           inquire ef-numero-ord, value in tor-numero.
           read tordini no lock
                invalid
                display message "Evasione non trovata"
                          title tit-err
                           icon 2
            not invalid
                perform IMPORTA-EVASIONE
           end-read         
           .
      * <TOTEM:END>

      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

