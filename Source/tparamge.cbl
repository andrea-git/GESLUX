      *{TOTEM}PRG-COMMENT
      * tparamge.Cbl
      * tparamge.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          tparamge.
       AUTHOR.              ANDREA EVENTI.
       DATE-WRITTEN.        venerdì 12 aprile 2019 19:30:15.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:tparamge, INIT:tparamge, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "tparamge.sl".
           COPY "tivaese.sl".
           COPY "clienti.sl".
           COPY "tcaumag.sl".
           COPY "tcodpag.sl".
           COPY "lisagente.sl".
           COPY "ttipocli.sl".
           COPY "tvettori.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "tparamge.fd".
           COPY "tivaese.fd".
           COPY "clienti.fd".
           COPY "tcaumag.fd".
           COPY "tcodpag.fd".
           COPY "lisagente.fd".
           COPY "ttipocli.fd".
           COPY "tvettori.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "crtvars.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "F:\lubex\geslux\Copylib\standard.def".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
          88 Screen-Time-Out VALUE 99.
      * Properties & User defined Working Stoarge
       78 titolo VALUE IS "Geslux - Tabella Parametri Generali". 
       77 Form1-Tb-1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 CountChar        PIC  9(3).
       77 como-id          PIC  9(5).
       77 data-oggi        PIC  9(8).
           COPY  "LINK-PASSWD.DEF".
       01 FlagErroreDes    PIC  9
                  VALUE IS 0.
           88 errore-des VALUE IS 1    WHEN SET TO FALSE  0. 
       77 toolbar-bmp      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 E-ESCI           PIC  9
                  VALUE IS 1.
       77 E-NUOVO          PIC  9
                  VALUE IS 0.
       77 E-SALVA          PIC  9
                  VALUE IS 1.
       77 E-ANTEPRIMA      PIC  9
                  VALUE IS 0.
       77 E-CANCELLA       PIC  9
                  VALUE IS 0.
       77 E-MODIFICA       PIC  9
                  VALUE IS 1.
       77 E-STAMPA         PIC  9
                  VALUE IS 0.
       77 E-CERCA          PIC  9
                  VALUE IS 0.
       77 E-SELEZIONA      PIC  9
                  VALUE IS 0.
       77 Small-Font
                  USAGE IS HANDLE OF FONT SMALL-FONT.
       77 Default-Font
                  USAGE IS HANDLE OF FONT DEFAULT-FONT.
       77 form1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 mod-fis          PIC  9
                  VALUE IS 1.
       77 AUTO-ID          PIC  9(6)
                  VALUE IS 0.
       77 accept-bmp       PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 STATUS-tparamge  PIC  X(2).
       77 STATUS-tivaese   PIC  X(2).
           88 Valid-STATUS-tivaese VALUE IS "00" THRU "09". 
       77 Form1-St-1-Handle
                  USAGE IS HANDLE OF STATUS-BAR.
       77 lab-iva-buf      PIC  X(100).
       77 lab-iva-omag-buf PIC  X(100).
       77 STATUS-clienti   PIC  X(2).
           88 Valid-STATUS-clienti VALUE IS "00" THRU "09". 
       77 lab-cli-buf      PIC  X(100).
       77 lab-pag-buf      PIC  X(100).
       77 status-tcodpag   PIC  X(2).
           88 Valid-status-tcodpag VALUE IS "00" THRU "09". 
       77 STATUS-tcaumag   PIC  X(2).
           88 Valid-STATUS-tcaumag VALUE IS "00" THRU "09". 
       77 lab-cau-buf      PIC  X(100).
       77 lab-cau-std-buf  PIC  X(100).
       77 STATUS-lisagente PIC  X(2).
           88 Valid-STATUS-lisagente VALUE IS "00" THRU "09". 
       77 lab-promo-buf    PIC  X(100).
       77 STATUS-ttipocli  PIC  X(2).
           88 Valid-STATUS-ttipocli VALUE IS "00" THRU "09". 
       77 lab-tipocli-buf  PIC  X(100).
       77 lab-cau-ord-forn-buf         PIC  X(100).
       77 lab-cau-omag-buf PIC  X(100).
       77 lab-vet-buf      PIC  X(100).
       77 STATUS-tvettori  PIC  X(2).
           88 Valid-STATUS-tvettori VALUE IS "00" THRU "09". 
       77 lab-cau-rotta-c-buf          PIC  X(100).
       77 lab-cau-rotta-s-buf          PIC  X(100).
       77 lab-forn-buf     PIC  X(100).
       01 old-tge-rec.
           05 old-tge-chiave.
               10 old-tge-codice   PIC  X(2).
           05 old-tge-dati.
               10 old-tge-anno     PIC  9(4).
               10 old-tge-data-consolid-progmag            PIC  9(8).
               10 old-tge-cod-iva-std          PIC  x(3).
               10 old-tge-cod-iva-omag         PIC  x(3).
               10 old-tge-cod-pag  PIC  x(3).
               10 old-tge-cliente-corrisp      PIC  9(6).
               10 old-tge-causale-corrisp      PIC  x(4).
               10 old-tge-causale-ordini-std   PIC  x(4).
               10 old-tge-listino-promo        PIC  9(4).
               10 old-tge-perce-prog           PIC  99v99.
               10 FILLER           PIC  9(4).
               10 old-tge-altre-date.
                   15 old-tge-data-1   PIC  9(8).
                   15 old-tge-data-2   PIC  9(8).
                   15 old-tge-data-3   PIC  9(8).
                   15 old-tge-data-4   PIC  9(8).
               10 old-tge-forn-corrisp         PIC  9(6).
               10 old-tge-perce-arrot-bancale  PIC  9(3)v99.
               10 old-tge-perce-fido           PIC  s9(3)v99.
               10 old-tge-trasp-italy          PIC  9(6)v999.
               10 old-tge-trasp-estero         PIC  9(6)v999.
               10 old-tge-limite-kg-old        PIC  9(3)v999.
               10 old-tge-vettore-std-old      PIC  9(5).
               10 old-tge-gg-plus-consegna-old PIC  9(3).
               10 old-tge-num-vuoto-3          PIC  9(1).
               10 old-tge-ttipocli-privato     PIC  x(2).
               10 old-tge-causale-ord-forn     PIC  x(4).
               10 old-tge-causale-omag         PIC  x(4).
               10 old-tge-reg-PILE PIC  x(20).
               10 old-tge-data-consolid-effet  PIC  9(8).
               10 old-tge-ora-consolid-effet   PIC  9(8).
               10 old-tge-data-contab          PIC  9(8).
               10 old-tge-ora-contab           PIC  9(8).
               10 old-tge-gg-scadenza-vol-old  PIC  s9(3).
               10 old-tge-gg-evadi-parziale-old            PIC  9(3).
               10 old-tge-gg-cons-max-old      PIC  9(3).
               10 old-tge-causale-rotta-s      PIC  X(4).
               10 old-tge-causale-rotta-c      PIC  X(4).
               10 old-tge-dati-comuni.
                   15 old-tge-data-creazione       PIC  9(8).
                   15 old-tge-ora-creazione        PIC  9(8).
                   15 old-tge-utente-creazione     PIC  X(10).
                   15 old-tge-data-ultima-modifica PIC  9(8).
                   15 old-tge-ora-ultima-modifica  PIC  9(8).
                   15 old-tge-utente-ultima-modifica           PIC  
           X(10).
               10 old-tge-vuoti.
                   15 old-tge-gg-mail-volantino    PIC  999.
                   15 old-tge-num-vuoto-1          PIC  9(15).
                   15 old-tge-num-vuoto-2          PIC  9(18).
                   15 old-tge-num-vuoto-3          PIC  9(18).
                   15 old-tge-gg-inizio-vol-pren-old           PIC  
           X(3).
                   15 old-tge-cod-pag-anticipato   PIC  X(3).
                   15 old-tge-gg-master-chiuso     PIC  9(3).
                   15 old-tge-ditta-comunicazione-utf          PIC  
           X(20).
                   15 old-tge-gg-vol-qta           PIC  9(3).
      *(( XFD NAME = tge-alfa-vuoto_1 ))
                   15 old-tge-anno-F-pdf           PIC  9(4).
      *(( XFD NAME = tge-alfa-vuoto_1_1 ))
                   15 old-tge-num-F-pdf            PIC  9(8).
      *(( XFD NAME = tge-alfa-vuoto_1_2 ))
                   15 old-tge-anno-NC-pdf          PIC  9(4).
      *(( XFD NAME = tge-alfa-vuoto_1_3 ))
                   15 old-tge-num-NC-pdf           PIC  9(8).
      *(( XFD NAME = tge-alfa-vuoto_1_3 ))
                   15 old-tge-blocco-fido          PIC  s9(10)v99.
       77 como-ora4        PIC  9(4).
       77 Large-Font
                  USAGE IS HANDLE OF FONT LARGE-FONT.
       77 lab-pag-ant-buf  PIC  X(100).

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
      * DATA CONTROL BUFFER
       01 Form1-BUF.
      * Data.Entry-Field
              05 EF-ANNO-BUF PIC 9(4).
      * Data.Entry-Field
              05 EF-DATA-BUF PIC 99/99/9999.
      * Data.Entry-Field
              05 EF-DATA-eff-BUF PIC 99/99/9999.
      * Data.Entry-Field
              05 EF-ora-eff-BUF PIC 99.99.
      * Data.Entry-Field
              05 EF-DATA-contab-BUF PIC 99/99/9999.
      * Data.Entry-Field
              05 EF-ora-contab-BUF PIC 99.99.
      * Data.Entry-Field
              05 ef-codiva-BUF PIC x(3).
      * Data.Entry-Field
              05 ef-codiva-omag-BUF PIC x(3).
      * Data.Entry-Field
              05 ef-pag-BUF PIC x(3).
      * Data.Entry-Field
              05 ef-pag-ant-BUF PIC X(3).
      * Data.Entry-Field
              05 ef-cli-BUF PIC z(6).
      * Data.Entry-Field
              05 ef-forn-BUF PIC z(6).
      * Data.Entry-Field
              05 ef-cau-BUF PIC x(4).
      * Data.Entry-Field
              05 ef-cau-std-BUF PIC x(4).
      * Data.Entry-Field
              05 ef-cau-ord-forn-BUF PIC X(4).
      * Data.Entry-Field
              05 ef-cau-omag-BUF PIC X(4).
      * Data.Entry-Field
              05 ef-cau-rotta-s-BUF PIC X(4).
      * Data.Entry-Field
              05 ef-cau-rotta-c-BUF PIC X(4).
      * Data.Entry-Field
              05 ef-promo-BUF PIC z(4).
      * Data.Entry-Field
              05 ef-tipocli-BUF PIC x(2).
      * Data.Entry-Field
              05 ef-ditta-utf-BUF PIC x(20).
      * Data.Entry-Field
              05 ef-blocco-fido-BUF PIC --.---.---.--9,99.
      * Data.Entry-Field
              05 ef-perce-arrot-BUF PIC zz9,99.
      * Data.Entry-Field
              05 ef-gg-part-BUF PIC zz9.
      * Data.Entry-Field
              05 ef-perce-prog-BUF PIC zz9,99.
      * Data.Entry-Field
              05 ef-perce-fido-BUF PIC -9(3),99.
      * Data.Entry-Field
              05 ef-pile-BUF PIC x(20).
      * Data.Entry-Field
              05 ef-perce-fidoa-BUF PIC z(5)9,999.
      * Data.Entry-Field
              05 ef-perce-fidob-BUF PIC z(5)9,999.
      * Data.Entry-Field
              05 ef-gg-chiuso-BUF PIC z(3).
      * Data.Entry-Field
              05 ef-vet-BUF PIC z(5).
      * Data.Entry-Field
              05 ef-limite-BUF PIC zz9,999.
      * Data.Entry-Field
              05 ef-gg-ini-pren-BUF PIC ----9.
      * Data.Entry-Field
              05 ef-gg-vol-qta-BUF PIC zz9.
      * Data.Entry-Field
              05 ef-vetaa-BUF PIC ---9.
      * Data.Entry-Field
              05 ef-vetab-BUF PIC zz9.
      * Data.Entry-Field
              05 ef-gg-max-BUF PIC zz9.
      * Data.Entry-Field
              05 ef-gg-cons-BUF PIC zz9.
      * Data.Entry-Field
              05 ef-limitea-BUF PIC z(4).
      * Data.Entry-Field
              05 ef-vetaaa-BUF PIC z(8).
      * Data.Entry-Field
              05 ef-gg-ini-prena-BUF PIC z(4).
      * Data.Entry-Field
              05 ef-vetaba-BUF PIC z(8).

       77 TMP-Form1-KEY1-ORDER  PIC X VALUE "A".
       77 TMP-Form1-tparamge-RESTOREBUF  PIC X(815).
       77 TMP-Form1-KEYIS  PIC 9(3) VALUE 1.
       77 Form1-MULKEY-TMPBUF   PIC X(815).
       77 TMP-DataSet1-tparamge-BUF     PIC X(815).
       77 TMP-DataSet1-tivaese-BUF     PIC X(1380).
       77 TMP-DataSet1-clienti-BUF     PIC X(1910).
       77 TMP-DataSet1-tcaumag-BUF     PIC X(254).
       77 TMP-DataSet1-tcodpag-BUF     PIC X(1380).
       77 TMP-DataSet1-lisagente-BUF     PIC X(245).
       77 TMP-DataSet1-ttipocli-BUF     PIC X(889).
       77 TMP-DataSet1-tvettori-BUF     PIC X(1847).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-tparamge-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tparamge-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-tparamge-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-tparamge-KEY1-Asc  VALUE "A".
          88 DataSet1-tparamge-KEY1-Desc VALUE "D".
       77 DataSet1-tivaese-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tivaese-LOCK  VALUE "Y".
       77 DataSet1-tivaese-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tivaese-KEY-Asc  VALUE "A".
          88 DataSet1-tivaese-KEY-Desc VALUE "D".
       77 DataSet1-clienti-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-clienti-LOCK  VALUE "Y".
       77 DataSet1-clienti-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-clienti-KEY-Asc  VALUE "A".
          88 DataSet1-clienti-KEY-Desc VALUE "D".
       77 DataSet1-tcaumag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcaumag-LOCK  VALUE "Y".
       77 DataSet1-tcaumag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcaumag-KEY-Asc  VALUE "A".
          88 DataSet1-tcaumag-KEY-Desc VALUE "D".
       77 DataSet1-tcodpag-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tcodpag-LOCK  VALUE "Y".
       77 DataSet1-tcodpag-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tcodpag-KEY-Asc  VALUE "A".
          88 DataSet1-tcodpag-KEY-Desc VALUE "D".
       77 DataSet1-lisagente-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-lisagente-LOCK  VALUE "Y".
       77 DataSet1-lisagente-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-lisagente-KEY-Asc  VALUE "A".
          88 DataSet1-lisagente-KEY-Desc VALUE "D".
       77 DataSet1-ttipocli-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-ttipocli-LOCK  VALUE "Y".
       77 DataSet1-ttipocli-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-ttipocli-KEY-Asc  VALUE "A".
          88 DataSet1-ttipocli-KEY-Desc VALUE "D".
       77 DataSet1-tvettori-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tvettori-LOCK  VALUE "Y".
       77 DataSet1-tvettori-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tvettori-KEY-Asc  VALUE "A".
          88 DataSet1-tvettori-KEY-Desc VALUE "D".

       77 tivaese-key01-SPLITBUF  PIC X(53).
       77 clienti-cli-K1-SPLITBUF  PIC X(47).
       77 clienti-cli-K3-SPLITBUF  PIC X(12).
       77 clienti-cli-K4-SPLITBUF  PIC X(8).
       77 tcaumag-k-mag-SPLITBUF  PIC X(5).
       77 tcodpag-TBL-CODICE-01-SPLITBUF  PIC X(53).
       77 lisagente-k-codice-SPLITBUF  PIC X(5).
       77 tvettori-k-des-SPLITBUF  PIC X(41).

      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-EF-ANNO VALUE 5001.
       78  78-ID-EF-DATA VALUE 5002.
       78  78-ID-EF-DATA-eff VALUE 5003.
       78  78-ID-EF-ora-eff VALUE 5004.
       78  78-ID-EF-DATA-contab VALUE 5005.
       78  78-ID-EF-ora-contab VALUE 5006.
       78  78-ID-ef-codiva VALUE 5007.
       78  78-ID-ef-codiva-omag VALUE 5008.
       78  78-ID-ef-pag VALUE 5009.
       78  78-ID-ef-pag-ant VALUE 5010.
       78  78-ID-ef-cli VALUE 5011.
       78  78-ID-ef-forn VALUE 5012.
       78  78-ID-ef-cau VALUE 5013.
       78  78-ID-ef-cau-std VALUE 5014.
       78  78-ID-ef-cau-ord-forn VALUE 5015.
       78  78-ID-ef-cau-omag VALUE 5016.
       78  78-ID-ef-cau-rotta-s VALUE 5017.
       78  78-ID-ef-cau-rotta-c VALUE 5018.
       78  78-ID-ef-promo VALUE 5019.
       78  78-ID-ef-tipocli VALUE 5020.
       78  78-ID-ef-ditta-utf VALUE 5021.
       78  78-ID-ef-blocco-fido VALUE 5022.
       78  78-ID-ef-perce-arrot VALUE 5023.
       78  78-ID-ef-perce-prog VALUE 5024.
       78  78-ID-ef-perce-fido VALUE 5025.
       78  78-ID-ef-pile VALUE 5026.
       78  78-ID-ef-perce-fidoa VALUE 5027.
       78  78-ID-ef-perce-fidob VALUE 5028.
       78  78-ID-ef-vet VALUE 5029.
       78  78-ID-ef-limite VALUE 5030.
       78  78-ID-ef-gg-ini-pren VALUE 5031.
       78  78-ID-ef-gg-vol-qta VALUE 5032.
       78  78-ID-ef-vetaa VALUE 5033.
       78  78-ID-ef-vetab VALUE 5034.
       78  78-ID-ef-gg-max VALUE 5035.
       78  78-ID-ef-limitea VALUE 5036.
       78  78-ID-ef-vetaaa VALUE 5037.
       78  78-ID-ef-gg-ini-prena VALUE 5038.
       78  78-ID-ef-vetaba VALUE 5039.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "COMMON-LINKAGE.DEF".

      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           AFTER PROCEDURE Form1-AfterProcedure,
           BEFORE PROCEDURE Form1-BeforeProcedure,
           .

      * ENTRY FIELD
       05
           EF-ANNO, 
           Entry-Field, 
           COL 23,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-EF-ANNO,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           VALUE EF-ANNO-BUF,
           .

      * ENTRY FIELD
       05
           EF-DATA, 
           Entry-Field, 
           COL 23,00, 
           LINE 4,00,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-EF-DATA,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 10,
           VALUE EF-DATA-BUF,
           .

      * ENTRY FIELD
       05
           EF-DATA-eff, 
           Entry-Field, 
           COL 23,00, 
           LINE 6,00,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-EF-DATA-eff,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE EF-DATA-eff-BUF,
           .

      * ENTRY FIELD
       05
           EF-ora-eff, 
           Entry-Field, 
           COL 56,14, 
           LINE 6,00,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-EF-ora-eff,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 4,
           VALUE EF-ora-eff-BUF,
           .

      * ENTRY FIELD
       05
           EF-DATA-contab, 
           Entry-Field, 
           COL 23,00, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-EF-DATA-contab,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 8,
           VALUE EF-DATA-contab-BUF,
           .

      * ENTRY FIELD
       05
           EF-ora-contab, 
           Entry-Field, 
           COL 56,14, 
           LINE 8,54,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-EF-ora-contab,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           MAX-TEXT 4,
           VALUE EF-ora-contab-BUF,
           .

      * ENTRY FIELD
       05
           ef-codiva, 
           Entry-Field, 
           COL 23,00, 
           LINE 11,00,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-codiva,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-codiva-BUF,
           .

      * ENTRY FIELD
       05
           ef-codiva-omag, 
           Entry-Field, 
           COL 23,00, 
           LINE 12,62,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-codiva-omag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-codiva-omag-BUF,
           .

      * ENTRY FIELD
       05
           ef-pag, 
           Entry-Field, 
           COL 22,86, 
           LINE 14,23,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-pag-BUF,
           .

      * ENTRY FIELD
       05
           ef-pag-ant, 
           Entry-Field, 
           COL 22,86, 
           LINE 15,85,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pag-ant,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 3,
           VALUE ef-pag-ant-BUF,
           .

      * ENTRY FIELD
       05
           ef-cli, 
           Entry-Field, 
           COL 23,00, 
           LINE 17,46,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-cli-BUF,
           .

      * ENTRY FIELD
       05
           ef-forn, 
           Entry-Field, 
           COL 23,00, 
           LINE 19,08,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-forn,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           VALUE ef-forn-BUF,
           .

      * ENTRY FIELD
       05
           ef-cau, 
           Entry-Field, 
           COL 23,00, 
           LINE 20,69,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cau,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 4,
           VALUE ef-cau-BUF,
           .

      * ENTRY FIELD
       05
           ef-cau-std, 
           Entry-Field, 
           COL 23,00, 
           LINE 22,31,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cau-std,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 4,
           VALUE ef-cau-std-BUF,
           .

      * ENTRY FIELD
       05
           ef-cau-ord-forn, 
           Entry-Field, 
           COL 23,00, 
           LINE 23,92,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cau-ord-forn,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 4,
           VALUE ef-cau-ord-forn-BUF,
           .

      * ENTRY FIELD
       05
           ef-cau-omag, 
           Entry-Field, 
           COL 23,00, 
           LINE 25,54,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cau-omag,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 4,
           VALUE ef-cau-omag-BUF,
           .

      * ENTRY FIELD
       05
           ef-cau-rotta-s, 
           Entry-Field, 
           COL 23,00, 
           LINE 27,15,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cau-rotta-s,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 4,
           VALUE ef-cau-rotta-s-BUF,
           .

      * ENTRY FIELD
       05
           ef-cau-rotta-c, 
           Entry-Field, 
           COL 23,00, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           UPPER,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-cau-rotta-c,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 4,
           VALUE ef-cau-rotta-c-BUF,
           .

      * ENTRY FIELD
       05
           ef-promo, 
           Entry-Field, 
           COL 23,00, 
           LINE 30,38,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-promo,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           VALUE ef-promo-BUF,
           .

      * ENTRY FIELD
       05
           ef-tipocli, 
           Entry-Field, 
           COL 23,00, 
           LINE 32,00,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-tipocli,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 2,
           VALUE ef-tipocli-BUF,
           .

      * ENTRY FIELD
       05
           ef-ditta-utf, 
           Entry-Field, 
           COL 23,00, 
           LINE 33,69,
           LINES 1,31 ,
           SIZE 20,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-ditta-utf,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MAX-TEXT 20,
           VALUE ef-ditta-utf-BUF,
           .

      * ENTRY FIELD
       05
           ef-blocco-fido, 
           Entry-Field, 
           COL 23,00, 
           LINE 35,38,
           LINES 1,31 ,
           SIZE 15,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-blocco-fido,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 14,
           VALUE ef-blocco-fido-BUF,
           BEFORE PROCEDURE Screen1-DaEf-1-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-perce-arrot, 
           Entry-Field, 
           COL 23,00, 
           LINE 38,38,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-perce-arrot,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 6,
           NUMERIC,
           VALUE ef-perce-arrot-BUF,
           .

      * ENTRY FIELD
       05
           ef-gg-part, 
           Entry-Field, 
           COL 56,14, 
           LINE 38,38,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           NUMERIC,
           VALUE ef-gg-part-BUF,
           .

      * ENTRY FIELD
       05
           ef-perce-prog, 
           Entry-Field, 
           COL 81,43, 
           LINE 38,23,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-perce-prog,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           NUMERIC,
           VALUE ef-perce-prog-BUF,
           .

      * ENTRY FIELD
       05
           ef-perce-fido, 
           Entry-Field, 
           COL 23,00, 
           LINE 40,62,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-perce-fido,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           NUMERIC,
           VALUE ef-perce-fido-BUF,
           .

      * ENTRY FIELD
       05
           ef-pile, 
           Entry-Field, 
           COL 55,86, 
           LINE 40,62,
           LINES 1,31 ,
           SIZE 20,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-pile,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           MAX-TEXT 20,
           VALUE ef-pile-BUF,
           .

      * ENTRY FIELD
       05
           ef-perce-fidoa, 
           Entry-Field, 
           COL 23,00, 
           LINE 42,85,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-perce-fidoa,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 10,
           NUMERIC,
           VALUE ef-perce-fidoa-BUF,
           .

      * ENTRY FIELD
       05
           ef-perce-fidob, 
           Entry-Field, 
           COL 55,86, 
           LINE 42,85,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-perce-fidob,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 10,
           NUMERIC,
           VALUE ef-perce-fidob-BUF,
           .

      * ENTRY FIELD
       05
           ef-gg-chiuso, 
           Entry-Field, 
           COL 81,43, 
           LINE 42,85,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           NUMERIC,
           VALUE ef-gg-chiuso-BUF,
           .

      * ENTRY FIELD
       05
           ef-vet, 
           Entry-Field, 
           COL 23,00, 
           LINE 47,08,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vet,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 5,
           NUMERIC,
           VALUE ef-vet-BUF,
           .

      * ENTRY FIELD
       05
           ef-limite, 
           Entry-Field, 
           COL 23,00, 
           LINE 48,62,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-limite,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 7,
           NUMERIC,
           VALUE ef-limite-BUF,
           .

      * ENTRY FIELD
       05
           ef-gg-ini-pren, 
           Entry-Field, 
           COL 48,86, 
           LINE 48,62,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-ini-pren,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           NUMERIC,
           VALUE ef-gg-ini-pren-BUF,
           .

      * ENTRY FIELD
       05
           ef-gg-vol-qta, 
           Entry-Field, 
           COL 71,43, 
           LINE 48,62,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-vol-qta,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           NUMERIC,
           VALUE ef-gg-vol-qta-BUF,
           .

      * ENTRY FIELD
       05
           ef-vetaa, 
           Entry-Field, 
           COL 23,00, 
           LINE 50,08,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vetaa,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           NUMERIC,
           VALUE ef-vetaa-BUF,
           .

      * ENTRY FIELD
       05
           ef-vetab, 
           Entry-Field, 
           COL 48,86, 
           LINE 50,08,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vetab,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           NUMERIC,
           VALUE ef-vetab-BUF,
           .

      * ENTRY FIELD
       05
           ef-gg-max, 
           Entry-Field, 
           COL 71,43, 
           LINE 50,08,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-max,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           NUMERIC,
           VALUE ef-gg-max-BUF,
           .

      * ENTRY FIELD
       05
           ef-gg-cons, 
           Entry-Field, 
           COL 92,86, 
           LINE 48,54,
           LINES 1,31 ,
           SIZE 5,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 3,
           NUMERIC,
           VALUE ef-gg-cons-BUF,
           .

      * ENTRY FIELD
       05
           ef-limitea, 
           Entry-Field, 
           COL 23,00, 
           LINE 54,85,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-limitea,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           NUMERIC,
           VALUE ef-limitea-BUF,
           BEFORE PROCEDURE Screen1-DaEf-1-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-vetaaa, 
           Entry-Field, 
           COL 23,00, 
           LINE 56,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vetaaa,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           NUMERIC,
           VALUE ef-vetaaa-BUF,
           .

      * ENTRY FIELD
       05
           ef-gg-ini-prena, 
           Entry-Field, 
           COL 56,00, 
           LINE 54,85,
           LINES 1,31 ,
           SIZE 7,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-gg-ini-prena,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 4,
           NUMERIC,
           VALUE ef-gg-ini-prena-BUF,
           BEFORE PROCEDURE Screen1-DaEf-1-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-vetaba, 
           Entry-Field, 
           COL 56,00, 
           LINE 56,69,
           LINES 1,31 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED MOD,
           FONT IS Small-Font,
           ID IS 78-ID-ef-vetaba,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           MAX-TEXT 8,
           NUMERIC,
           VALUE ef-vetaba-BUF,
           .

      * LABEL
       05
           Screen1-Custom1-1, 
           Label, 
           COL 61,71, 
           LINE 3,15,
           LINES 0,69 ,
           SIZE 7,14 ,
           FONT IS Default-Font,
           ID IS 18,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Screen1-blockpgm-2, 
           Label, 
           COL 61,43, 
           LINE 1,77,
           LINES 1,00 ,
           SIZE 8,14 ,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Screen1-La-2, 
           Label, 
           COL 2,00, 
           LINE 2,00,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 33,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Anno Esercizio Attuale",
           .

      * PUSH BUTTON
       05
           Screen1-Pb-1, 
           Push-Button, 
           COL 1,00, 
           LINE 19,00,
           LINES 0,62 ,
           SIZE 1,29 ,
           BITMAP-HANDLE ACCEPT-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           SQUARE,
           FLAT,
           FONT IS Small-Font,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           .

      * LABEL
       05
           Screen1-La-4ae, 
           Label, 
           COL 2,00, 
           LINE 3,50,
           LINES 2,00 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Data ultimo Consolidamento Progressivi di Magazzino",
           .

      * LABEL
       05
           Screen1-La-4aea, 
           Label, 
           COL 2,00, 
           LINE 11,00,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 8,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Codice I.V.A. Standard",
           .

      * LABEL
       05
           lab-iva, 
           Label, 
           COL 31,00, 
           LINE 11,00,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 9,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-iva-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaa, 
           Label, 
           COL 2,00, 
           LINE 12,62,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Codice I.V.A. Omaggio",
           .

      * LABEL
       05
           lab-iva-omag, 
           Label, 
           COL 31,00, 
           LINE 12,62,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 11,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-iva-omag-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaa, 
           Label, 
           COL 2,29, 
           LINE 17,46,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 12,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Cliente per corripsettivi",
           .

      * LABEL
       05
           lab-cli, 
           Label, 
           COL 31,00, 
           LINE 17,46,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 13,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cli-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaaa, 
           Label, 
           COL 2,14, 
           LINE 14,23,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Codice Pagamento standard",
           .

      * LABEL
       05
           lab-pag, 
           Label, 
           COL 31,00, 
           LINE 14,23,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-pag-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaab, 
           Label, 
           COL 2,29, 
           LINE 20,69,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 16,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Causale per corripsettivi",
           .

      * LABEL
       05
           lab-cau, 
           Label, 
           COL 31,00, 
           LINE 20,69,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cau-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaaba, 
           Label, 
           COL 2,29, 
           LINE 22,31,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Causale standard per ordini",
           .

      * LABEL
       05
           lab-cau-std, 
           Label, 
           COL 31,00, 
           LINE 22,31,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 20,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cau-std-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaabaa, 
           Label, 
           COL 2,29, 
           LINE 30,38,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 22,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE 'Codice listino "promo"',
           .

      * LABEL
       05
           lab-promo, 
           Label, 
           COL 31,00, 
           LINE 30,38,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-promo-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaa, 
           Label, 
           COL 2,29, 
           LINE 32,00,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 24,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE 'Tipologia cliente "PRIVATO"',
           .

      * LABEL
       05
           lab-tipocli, 
           Label, 
           COL 31,00, 
           LINE 32,00,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-tipocli-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaabab, 
           Label, 
           COL 2,29, 
           LINE 23,92,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 26,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Causale std ordini Fornitori",
           .

      * LABEL
       05
           lab-cau-ord-forn, 
           Label, 
           COL 31,00, 
           LINE 23,92,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cau-ord-forn-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaa, 
           Label, 
           COL 2,29, 
           LINE 38,38,
           LINES 2,00 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 28,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "% di arrotondamento al bancale",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaa, 
           Label, 
           COL 2,29, 
           LINE 40,62,
           LINES 2,00 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 29,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "% MAX di scostamento scoperto (fido 2^ verifica)",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaaa, 
           Label, 
           COL 2,29, 
           LINE 42,85,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Trasporto: € al Kg. Italia",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaab, 
           Label, 
           COL 35,14, 
           LINE 42,85,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 31,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Trasporto: € al Kg. Estero",
           .

      * LABEL
       05
           Screen1-La-4aeaaababa, 
           Label, 
           COL 2,29, 
           LINE 25,54,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 32,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Causale std per omaggio",
           .

      * LABEL
       05
           lab-cau-omag, 
           Label, 
           COL 31,00, 
           LINE 25,54,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cau-omag-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaaaa, 
           Label, 
           COL 2,29, 
           LINE 48,62,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 35,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Limite Kg vettore std",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaaba, 
           Label, 
           COL 2,29, 
           LINE 47,08,
           LINES 1,31 ,
           SIZE 15,86 ,
           FONT IS Small-Font,
           ID IS 36,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Vettore STD",
           .

      * LABEL
       05
           lab-vet, 
           Label, 
           COL 31,00, 
           LINE 47,08,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 37,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-vet-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaabaa, 
           Label, 
           COL 35,14, 
           LINE 40,62,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 38,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Registro PILE",
           .

      * LABEL
       05
           Screen1-La-4aec, 
           Label, 
           COL 2,00, 
           LINE 6,00,
           LINES 2,00 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 40,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Data effettiva Consolid. Magazzino",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababa, 
           Label, 
           COL 2,29, 
           LINE 50,08,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 41,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "GG validità volantino",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababb, 
           Label, 
           COL 31,86, 
           LINE 50,08,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 42,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "GG evasione parziale",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababba, 
           Label, 
           COL 55,43, 
           LINE 50,08,
           LINES 1,31 ,
           SIZE 14,50 ,
           FONT IS Small-Font,
           ID IS 43,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "GG consegna max",
           .

      * LABEL
       05
           Screen1-La-4aeaaababaa, 
           Label, 
           COL 2,29, 
           LINE 27,15,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 44,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Causale merce rotta scarico",
           .

      * LABEL
       05
           lab-cau-rotta-s, 
           Label, 
           COL 31,00, 
           LINE 27,15,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cau-rotta-s-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababbaa, 
           Label, 
           COL 78,29, 
           LINE 50,08,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "GG data consegna",
           .

      * LABEL
       05
           Screen1-La-4aeaaababaaa, 
           Label, 
           COL 2,29, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 47,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Causale merce rotta carico",
           .

      * LABEL
       05
           lab-cau-rotta-c, 
           Label, 
           COL 31,00, 
           LINE 28,77,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 48,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-cau-rotta-c-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaac, 
           Label, 
           COL 2,29, 
           LINE 19,08,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 50,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Fornitore standard",
           .

      * LABEL
       05
           lab-forn, 
           Label, 
           COL 31,00, 
           LINE 19,08,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 51,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-forn-buf,
           .

      * LABEL
       05
           Screen1-La-4aecb, 
           Label, 
           COL 35,14, 
           LINE 6,00,
           LINES 2,00 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 52,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Ora effettiva Consolid. Magazzino",
           .

      * LABEL
       05
           Screen1-La-4aecc, 
           Label, 
           COL 2,00, 
           LINE 8,50,
           LINES 2,00 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 53,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Data contabilizzaizone",
           .

      * LABEL
       05
           Screen1-La-4aecba, 
           Label, 
           COL 35,14, 
           LINE 8,54,
           LINES 2,00 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 55,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Ora Contabilizzazione",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababbb, 
           Label, 
           COL 31,86, 
           LINE 48,62,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 57,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "GG inizio volantino",
           .

      * LABEL
       05
           Screen1-La-1, 
           Label, 
           COL 37,57, 
           LINE 45,31,
           LINES 1,38 ,
           SIZE 25,00 ,
           FONT IS Large-Font,
           ID IS 39,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "VECCHIA EVASIONE",
           .

      * BAR
       05
           Screen1-Br-1, 
           Bar,
           COL 63,14, 
           LINE 46,00,
           SIZE 36,14 ,
           ID IS 58,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * BAR
       05
           Screen1-Br-1a, 
           Bar,
           COL 1,00, 
           LINE 46,00,
           SIZE 36,14 ,
           ID IS 59,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       05
           Screen1-La-4aeaaaaa, 
           Label, 
           COL 2,14, 
           LINE 15,85,
           LINES 1,31 ,
           SIZE 20,50 ,
           FONT IS Small-Font,
           ID IS 60,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Codice Pagamento anticipato",
           .

      * LABEL
       05
           lab-pag-ant, 
           Label, 
           COL 31,00, 
           LINE 15,85,
           LINES 1,31 ,
           SIZE 65,00 ,
           COLOR IS 5,
           FONT IS Small-Font,
           ID IS 61,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-pag-ant-buf,
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababbaaa, 
           Label, 
           COL 66,86, 
           LINE 42,85,
           LINES 1,31 ,
           SIZE 14,00 ,
           FONT IS Small-Font,
           ID IS 62,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "GG master chiuso",
           .

      * BAR
       05
           Screen1-Br-2, 
           Bar,
           COL 1,00, 
           LINE 10,38,
           SIZE 98,29 ,
           ID IS 6,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * BAR
       05
           Screen1-Br-2a, 
           Bar,
           COL 1,00, 
           LINE 37,46,
           SIZE 98,29 ,
           ID IS 49,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaab, 
           Label, 
           COL 2,29, 
           LINE 33,69,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 63,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Ditta comunicazioni UTF",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaab, 
           Label, 
           COL 35,43, 
           LINE 38,38,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 64,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "gg partenza mail volantino",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababbaaaa, 
           Label, 
           COL 66,86, 
           LINE 38,23,
           LINES 2,15 ,
           SIZE 13,14 ,
           FONT IS Small-Font,
           ID IS 65,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "% creazione progressivo",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababbba, 
           Label, 
           COL 55,43, 
           LINE 48,62,
           LINES 1,31 ,
           SIZE 14,50 ,
           FONT IS Small-Font,
           ID IS 66,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "GG prenotazione qta",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaaaaa, 
           Label, 
           COL 2,29, 
           LINE 54,85,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 67,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Anno fatture",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababaa, 
           Label, 
           COL 2,29, 
           LINE 56,69,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 68,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Numero fatture",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababbc, 
           Label, 
           COL 39,00, 
           LINE 56,69,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 69,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Numero NC",
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaaababbbb, 
           Label, 
           COL 39,00, 
           LINE 54,85,
           LINES 1,31 ,
           SIZE 15,00 ,
           FONT IS Small-Font,
           ID IS 70,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Anno Nc",
           .

      * LABEL
       05
           Screen1-La-1a, 
           Label, 
           COL 40,14, 
           LINE 52,69,
           LINES 1,38 ,
           SIZE 20,00 ,
           FONT IS Large-Font,
           ID IS 71,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "STAMPA PDF",
           .

      * BAR
       05
           Screen1-Br-1aa, 
           Bar,
           COL 1,00, 
           LINE 53,38,
           SIZE 36,14 ,
           ID IS 72,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * BAR
       05
           Screen1-Br-1b, 
           Bar,
           COL 63,14, 
           LINE 53,38,
           SIZE 36,14 ,
           ID IS 73,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       05
           Screen1-La-4aeaaabaaaba, 
           Label, 
           COL 2,29, 
           LINE 35,38,
           LINES 1,31 ,
           SIZE 20,00 ,
           FONT IS Small-Font,
           ID IS 63,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           LEFT,
           TRANSPARENT,
           TITLE "Blocco fido",
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           ID IS 74,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 6,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 23,
           FRAMED,
           SQUARE,
           ENABLED 0,
           EXCEPTION-VALUE 2,
           FLAT,
           ID IS 75,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 16,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 16,
           FRAMED,
           SQUARE,
           ENABLED 0,
           EXCEPTION-VALUE 4,
           FLAT,
           ID IS 76,
           SELF-ACT,
           TITLE "Cancella (F4)",
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 11,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           ID IS 77,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 26,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 17,
           FRAMED,
           SQUARE,
           ENABLED E-ANTEPRIMA,
           EXCEPTION-VALUE 6,
           FLAT,
           ID IS 78,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           .

      * CHECK BOX
       05
           TOOL-MODIFICA, 
           Check-Box, 
           COL 21,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 5,
           FRAMED,
           SQUARE,
           ENABLED E-MODIFICA,
           EXCEPTION-VALUE 150
           FLAT,
           ID IS 79,
           SELF-ACT,
           TITLE "Modifica (F5)",
           VALUE MOD,
           BITMAP-NUMBER BitmapNumEdit
           AFTER PROCEDURE TOOL-MODIFICA-AfterProcedure,
           BEFORE PROCEDURE TOOL-MODIFICA-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 31,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 18,
           FRAMED,
           SQUARE,
           ENABLED E-STAMPA,
           EXCEPTION-VALUE 7,
           FLAT,
           ID IS 110,
           SELF-ACT,
           TITLE "Stampa (F7)",
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 36,00, 
           LINE 1,15,
           LINES 23,00 ,
           SIZE 24,00 ,
           BITMAP-HANDLE TOOLBAR-BMP,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           ID IS 111,
           SELF-ACT,
           TITLE "Cerca (F8)",
           VISIBLE 1,
           BITMAP-NUMBER BitmapNumZoom
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, USER-CODI, LIVELLO-ABIL.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:tparamge, INIT:tparamge, BeforeDeclarative>
       TPARAMGE-ERR SECTION.
           use after error procedure on tparamge.
           set RecLocked to false.
           evaluate status-tparamge
           when "35"
                display message "File [TPARAMGE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TPARAMGE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TPARAMGE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "99"
           when "93"
                set RecLocked to true
                set errori    to true
                move 1 to mod-k
                move 0 to mod
                modify tool-modifica, value = mod
                display form1
                set StatusVisua to true
                move "00" to status-tparamge
                if ReadSecca
                   read tparamge       no lock 
                        invalid      continue
                        not invalid  perform FORM1-IUD-DISPLAY
                   end-read
                end-if
                display message box MSG-Record-gia-in-uso
                        title = tit-err
                        icon is mb-error-icon
           when "23"
                move 1 to mod-k
                move 0 to mod
                modify tool-modifica, value = mod
                set StatusVisua to true
                if nuovo              
                   initialize tge-dati replacing numeric data by zeroes
                                            alphanumeric data by spaces
                   perform FORM1-FLD-TO-BUF
                   display form1-tb-1
                   set vecchio to true
                end-if    
                perform ABILITAZIONI
                display form1
                |RISETTO IL VALORE A "23" PERCHE DENTRO AL PAR. CLEAR-SCREEN
                |CON L'OPERAZIONE UNLOCK VIENE RISETTATO A ZERO COSICCHÈ 
                |QUANDO TORNA DENTRO AI PAR. DI SCORRIMENTO DI TOTEM SI 
                |TROVA IN UNA SITUAZIONE CORRETTA E PROSEGUE CON LA READ
                |USCENDO CON UN MESSAGGIO DI ERRORE DI TIPO "46"
                move "23" to status-tparamge
           end-evaluate.
 
      ***---
       TIVAESE-ERR SECTION.
           use after error procedure on tivaese.
           set tutto-ok  to true.
           evaluate status-tivaese
           when "35"
                display message "File [TIVAESE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TIVAESE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TIVAESE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       CLIENTI-ERR SECTION.
           use after error procedure on clienti.
           set tutto-ok  to true.
           evaluate status-clienti
           when "35"
                display message "File [CLIENTI] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [CLIENTI] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[CLIENTI] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TCODPAG-ERR SECTION.
           use after error procedure on tcodpag.
           set tutto-ok  to true.
           evaluate status-tcodpag
           when "35"
                display message "File [TCODPAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCODPAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCODPAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       TCAUMAG-ERR SECTION.
           use after error procedure on tcaumag.
           set tutto-ok  to true.
           evaluate status-tcaumag
           when "35"
                display message "File [TCAUMAG] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TCAUMAG] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TCAUMAG] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.
 
      ***---
       LISAGENTE-ERR SECTION.
           use after error procedure on lisagente.
           set tutto-ok  to true.
           evaluate status-lisagente
           when "35"
                display message "File [LISAGENTE] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [LISAGENTE] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[LISAGENTE] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM ginqui-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:tparamge, INIT:tparamge, BeforeDestroyResource>
      * <TOTEM:END>
           CALL "w$bitmap" USING WBITMAP-DESTROY, ACCEPT-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, toolbar-bmp
           CALL "w$bitmap" USING WBITMAP-DESTROY, TOOLBAR-BMP
      *    After-Program
           PERFORM ginqui-Ev-After-Program
           set environment "KEYSTROKE" to "DATA=46   46".
           set environment "KEYSTROKE" to "DATA=44   44".
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
           .

       INIT-BMP.
      * Screen1-Pb-1
           COPY RESOURCE "ACCEPT.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "ACCEPT.BMP", 
                   GIVING ACCEPT-BMP.
      * TOOL-ESCI
           COPY RESOURCE "toolbar.bmp".
           CALL "w$bitmap" USING WBITMAP-LOAD "toolbar.bmp", 
                   GIVING toolbar-bmp.
      * TOOL-CERCA
           COPY RESOURCE "TOOLBAR.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "TOOLBAR.BMP", 
                   GIVING TOOLBAR-BMP.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-tparamge
           PERFORM OPEN-tivaese
           PERFORM OPEN-clienti
           PERFORM OPEN-tcaumag
           PERFORM OPEN-tcodpag
           PERFORM OPEN-lisagente
           PERFORM OPEN-ttipocli
           PERFORM OPEN-tvettori
      *    After Open
           .

       OPEN-tparamge.
      * <TOTEM:EPT. INIT:tparamge, FD:tparamge, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O tparamge
           IF STATUS-tparamge = "35"
              OPEN OUTPUT tparamge
                IF ( STATUS-tparamge(1:1) = 0 )
                   CLOSE tparamge
                   OPEN I-O tparamge
                END-IF
           END-IF
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tparamge, FD:tparamge, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tivaese.
      * <TOTEM:EPT. INIT:tparamge, FD:tivaese, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tivaese
           IF NOT Valid-STATUS-tivaese
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tparamge, FD:tivaese, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-clienti.
      * <TOTEM:EPT. INIT:tparamge, FD:clienti, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT clienti
           IF NOT Valid-STATUS-clienti
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tparamge, FD:clienti, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcaumag.
      * <TOTEM:EPT. INIT:tparamge, FD:tcaumag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcaumag
           IF NOT Valid-STATUS-tcaumag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tparamge, FD:tcaumag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tcodpag.
      * <TOTEM:EPT. INIT:tparamge, FD:tcodpag, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tcodpag
           IF NOT Valid-status-tcodpag
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tparamge, FD:tcodpag, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-lisagente.
      * <TOTEM:EPT. INIT:tparamge, FD:lisagente, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT lisagente
           IF NOT Valid-STATUS-lisagente
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tparamge, FD:lisagente, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-ttipocli.
      * <TOTEM:EPT. INIT:tparamge, FD:ttipocli, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT ttipocli
           IF NOT Valid-STATUS-ttipocli
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tparamge, FD:ttipocli, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tvettori.
      * <TOTEM:EPT. INIT:tparamge, FD:tvettori, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT tvettori
           IF NOT Valid-STATUS-tvettori
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:tparamge, FD:tvettori, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-tparamge
           PERFORM CLOSE-tivaese
           PERFORM CLOSE-clienti
           PERFORM CLOSE-tcaumag
           PERFORM CLOSE-tcodpag
           PERFORM CLOSE-lisagente
           PERFORM CLOSE-ttipocli
           PERFORM CLOSE-tvettori
      *    After Close
           .

       CLOSE-tparamge.
      * <TOTEM:EPT. INIT:tparamge, FD:tparamge, BeforeClose>
      * <TOTEM:END>
           CLOSE tparamge
           .

       CLOSE-tivaese.
      * <TOTEM:EPT. INIT:tparamge, FD:tivaese, BeforeClose>
      * <TOTEM:END>
           CLOSE tivaese
           .

       CLOSE-clienti.
      * <TOTEM:EPT. INIT:tparamge, FD:clienti, BeforeClose>
      * <TOTEM:END>
           CLOSE clienti
           .

       CLOSE-tcaumag.
      * <TOTEM:EPT. INIT:tparamge, FD:tcaumag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcaumag
           .

       CLOSE-tcodpag.
      * <TOTEM:EPT. INIT:tparamge, FD:tcodpag, BeforeClose>
      * <TOTEM:END>
           CLOSE tcodpag
           .

       CLOSE-lisagente.
      * <TOTEM:EPT. INIT:tparamge, FD:lisagente, BeforeClose>
      * <TOTEM:END>
           CLOSE lisagente
           .

       CLOSE-ttipocli.
      * <TOTEM:EPT. INIT:tparamge, FD:ttipocli, BeforeClose>
      * <TOTEM:END>
           CLOSE ttipocli
           .

       CLOSE-tvettori.
      * <TOTEM:EPT. INIT:tparamge, FD:tvettori, BeforeClose>
      * <TOTEM:END>
           CLOSE tvettori
           .

       DataSet1-tparamge-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tparamge-KEY1-Asc
                 MOVE Low-Value TO tge-chiave
              ELSE
                 MOVE High-Value TO tge-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tparamge-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tparamge-KEY1-Asc
                 MOVE High-Value TO tge-chiave
              ELSE
                 MOVE Low-Value TO tge-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-tparamge-KEY1-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-tparamge-KEY1-ORDER
           END-EVALUATE
           .

      * tparamge
       DataSet1-tparamge-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tparamge-KEY1-Asc
                 START tparamge KEY >= tge-chiave
              ELSE
                 START tparamge KEY <= tge-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tparamge-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tparamge-KEY1-Asc
                 START tparamge KEY <= tge-chiave
              ELSE
                 START tparamge KEY >= tge-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tparamge-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tparamge-KEY1-Asc
                 START tparamge KEY > tge-chiave
              ELSE
                 START tparamge KEY < tge-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tparamge-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tparamge-KEY1-Asc
                 START tparamge KEY < tge-chiave
              ELSE
                 START tparamge KEY > tge-chiave
              END-IF
           END-EVALUATE
           .

       DataSet1-tparamge-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tparamge-LOCK
                 READ tparamge WITH LOCK 
                 KEY tge-chiave
              ELSE
                 READ tparamge WITH NO LOCK 
                 KEY tge-chiave
              END-IF
           END-EVALUATE
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT 
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tparamge-KEY1-Asc
                 IF DataSet1-tparamge-LOCK
                    READ tparamge NEXT WITH LOCK
                 ELSE
                    READ tparamge NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-tparamge-LOCK
                    READ tparamge PREVIOUS WITH LOCK
                 ELSE
                    READ tparamge PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-tparamge-KEY1-Asc
                 IF DataSet1-tparamge-LOCK
                    READ tparamge PREVIOUS WITH LOCK
                 ELSE
                    READ tparamge PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-tparamge-LOCK
                    READ tparamge NEXT WITH LOCK
                 ELSE
                    READ tparamge NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeWrite>
      * <TOTEM:END>
           WRITE tge-rec OF tparamge.
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeRewrite>
      * <TOTEM:END>
           REWRITE tge-rec OF tparamge.
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tparamge-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, BeforeDelete>
      * <TOTEM:END>
           DELETE tparamge.
           MOVE STATUS-tparamge TO TOTEM-ERR-STAT
           MOVE "tparamge" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tparamge, AfterDelete>
      * <TOTEM:END>
           .

       tivaese-key01-MERGE-SPLITBUF.
           INITIALIZE tivaese-key01-SPLITBUF
           MOVE TBLIV-CODICE1(1:2) TO tivaese-key01-SPLITBUF(1:2)
           MOVE TBLIV-DESCRIZIONE1(1:30) TO tivaese-key01-SPLITBUF(3:30)
           MOVE TBLIV-CODICE2(1:20) TO tivaese-key01-SPLITBUF(33:20)
           .

       DataSet1-tivaese-INITSTART.
           IF DataSet1-tivaese-KEY-Asc
              MOVE Low-Value TO TBLIV-CODICE
           ELSE
              MOVE High-Value TO TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-INITEND.
           IF DataSet1-tivaese-KEY-Asc
              MOVE High-Value TO TBLIV-CODICE
           ELSE
              MOVE Low-Value TO TBLIV-CODICE
           END-IF
           .

      * tivaese
       DataSet1-tivaese-START.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY >= TBLIV-CODICE
           ELSE
              START tivaese KEY <= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-NOTGREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY <= TBLIV-CODICE
           ELSE
              START tivaese KEY >= TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-GREATER.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY > TBLIV-CODICE
           ELSE
              START tivaese KEY < TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-START-LESS.
           IF DataSet1-tivaese-KEY-Asc
              START tivaese KEY < TBLIV-CODICE
           ELSE
              START tivaese KEY > TBLIV-CODICE
           END-IF
           .

       DataSet1-tivaese-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tivaese-LOCK
              READ tivaese WITH LOCK 
              KEY TBLIV-CODICE
           ELSE
              READ tivaese WITH NO LOCK 
              KEY TBLIV-CODICE
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT 
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tivaese-KEY-Asc
              IF DataSet1-tivaese-LOCK
                 READ tivaese PREVIOUS WITH LOCK
              ELSE
                 READ tivaese PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tivaese-LOCK
                 READ tivaese NEXT WITH LOCK
              ELSE
                 READ tivaese NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tivaese-key01-MERGE-SPLITBUF
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tivaese-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tivaese TO TOTEM-ERR-STAT
           MOVE "tivaese" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tivaese, AfterDelete>
      * <TOTEM:END>
           .

       clienti-cli-K1-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K1-SPLITBUF
           MOVE cli-tipo-CF OF clienti(1:1) TO 
           clienti-cli-K1-SPLITBUF(1:1)
           MOVE cli-ragsoc-1 OF clienti(1:40) TO 
           clienti-cli-K1-SPLITBUF(2:40)
           MOVE cli-codice OF clienti(1:5) TO 
           clienti-cli-K1-SPLITBUF(42:5)
           .

       clienti-cli-K3-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K3-SPLITBUF
           MOVE cli-gdo OF clienti(1:5) TO clienti-cli-K3-SPLITBUF(1:5)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K3-SPLITBUF(6:6)
           .

       clienti-cli-K4-MERGE-SPLITBUF.
           INITIALIZE clienti-cli-K4-SPLITBUF
           MOVE cli-utf OF clienti(1:1) TO clienti-cli-K4-SPLITBUF(1:1)
           MOVE cli-chiave OF clienti(1:6) TO 
           clienti-cli-K4-SPLITBUF(2:6)
           .

       DataSet1-clienti-INITSTART.
           IF DataSet1-clienti-KEY-Asc
              MOVE Low-Value TO cli-chiave OF clienti
           ELSE
              MOVE High-Value TO cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-INITEND.
           IF DataSet1-clienti-KEY-Asc
              MOVE High-Value TO cli-chiave OF clienti
           ELSE
              MOVE Low-Value TO cli-chiave OF clienti
           END-IF
           .

      * clienti
       DataSet1-clienti-START.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY >= cli-chiave OF clienti
           ELSE
              START clienti KEY <= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-NOTGREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY <= cli-chiave OF clienti
           ELSE
              START clienti KEY >= cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-GREATER.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY > cli-chiave OF clienti
           ELSE
              START clienti KEY < cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-START-LESS.
           IF DataSet1-clienti-KEY-Asc
              START clienti KEY < cli-chiave OF clienti
           ELSE
              START clienti KEY > cli-chiave OF clienti
           END-IF
           .

       DataSet1-clienti-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-clienti-LOCK
              READ clienti WITH LOCK 
              KEY cli-chiave OF clienti
           ELSE
              READ clienti WITH NO LOCK 
              KEY cli-chiave OF clienti
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT 
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-clienti-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-clienti-KEY-Asc
              IF DataSet1-clienti-LOCK
                 READ clienti PREVIOUS WITH LOCK
              ELSE
                 READ clienti PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-clienti-LOCK
                 READ clienti NEXT WITH LOCK
              ELSE
                 READ clienti NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM clienti-cli-K1-MERGE-SPLITBUF
           PERFORM clienti-cli-K3-MERGE-SPLITBUF
           PERFORM clienti-cli-K4-MERGE-SPLITBUF
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-clienti-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-clienti TO TOTEM-ERR-STAT
           MOVE "clienti" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:clienti, AfterDelete>
      * <TOTEM:END>
           .

       tcaumag-k-mag-MERGE-SPLITBUF.
           INITIALIZE tcaumag-k-mag-SPLITBUF
           MOVE tca-cod-magaz(1:3) TO tcaumag-k-mag-SPLITBUF(1:3)
           MOVE tca-ord-forn(1:1) TO tcaumag-k-mag-SPLITBUF(4:1)
           .

       DataSet1-tcaumag-INITSTART.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE Low-Value TO tca-chiave
           ELSE
              MOVE High-Value TO tca-chiave
           END-IF
           .

       DataSet1-tcaumag-INITEND.
           IF DataSet1-tcaumag-KEY-Asc
              MOVE High-Value TO tca-chiave
           ELSE
              MOVE Low-Value TO tca-chiave
           END-IF
           .

      * tcaumag
       DataSet1-tcaumag-START.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY >= tca-chiave
           ELSE
              START tcaumag KEY <= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-NOTGREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY <= tca-chiave
           ELSE
              START tcaumag KEY >= tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-GREATER.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY > tca-chiave
           ELSE
              START tcaumag KEY < tca-chiave
           END-IF
           .

       DataSet1-tcaumag-START-LESS.
           IF DataSet1-tcaumag-KEY-Asc
              START tcaumag KEY < tca-chiave
           ELSE
              START tcaumag KEY > tca-chiave
           END-IF
           .

       DataSet1-tcaumag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcaumag-LOCK
              READ tcaumag WITH LOCK 
              KEY tca-chiave
           ELSE
              READ tcaumag WITH NO LOCK 
              KEY tca-chiave
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT 
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcaumag-KEY-Asc
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag PREVIOUS WITH LOCK
              ELSE
                 READ tcaumag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcaumag-LOCK
                 READ tcaumag NEXT WITH LOCK
              ELSE
                 READ tcaumag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcaumag-k-mag-MERGE-SPLITBUF
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcaumag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tcaumag TO TOTEM-ERR-STAT
           MOVE "tcaumag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcaumag, AfterDelete>
      * <TOTEM:END>
           .

       tcodpag-TBL-CODICE-01-MERGE-SPLITBUF.
           INITIALIZE tcodpag-TBL-CODICE-01-SPLITBUF
           MOVE TBLPA-CODICE1(1:2) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(1:2)
           MOVE TBLPA-DESCRIZIONE1(1:30) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(3:30)
           MOVE TBLPA-CODICE2(1:20) TO 
           tcodpag-TBL-CODICE-01-SPLITBUF(33:20)
           .

       DataSet1-tcodpag-INITSTART.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE Low-Value TO TBLPA-CODICE
           ELSE
              MOVE High-Value TO TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-INITEND.
           IF DataSet1-tcodpag-KEY-Asc
              MOVE High-Value TO TBLPA-CODICE
           ELSE
              MOVE Low-Value TO TBLPA-CODICE
           END-IF
           .

      * tcodpag
       DataSet1-tcodpag-START.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY >= TBLPA-CODICE
           ELSE
              START tcodpag KEY <= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-NOTGREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY <= TBLPA-CODICE
           ELSE
              START tcodpag KEY >= TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-GREATER.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY > TBLPA-CODICE
           ELSE
              START tcodpag KEY < TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-START-LESS.
           IF DataSet1-tcodpag-KEY-Asc
              START tcodpag KEY < TBLPA-CODICE
           ELSE
              START tcodpag KEY > TBLPA-CODICE
           END-IF
           .

       DataSet1-tcodpag-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tcodpag-LOCK
              READ tcodpag WITH LOCK 
              KEY TBLPA-CODICE
           ELSE
              READ tcodpag WITH NO LOCK 
              KEY TBLPA-CODICE
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT 
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tcodpag-KEY-Asc
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag PREVIOUS WITH LOCK
              ELSE
                 READ tcodpag PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tcodpag-LOCK
                 READ tcodpag NEXT WITH LOCK
              ELSE
                 READ tcodpag NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tcodpag-TBL-CODICE-01-MERGE-SPLITBUF
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeWrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeRewrite>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tcodpag-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, BeforeDelete>
      * <TOTEM:END>
           MOVE status-tcodpag TO TOTEM-ERR-STAT
           MOVE "tcodpag" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tcodpag, AfterDelete>
      * <TOTEM:END>
           .

       lisagente-k-codice-MERGE-SPLITBUF.
           INITIALIZE lisagente-k-codice-SPLITBUF
           MOVE lis-codice OF lisagente(1:4) TO 
           lisagente-k-codice-SPLITBUF(1:4)
           .

       DataSet1-lisagente-INITSTART.
           IF DataSet1-lisagente-KEY-Asc
              MOVE Low-Value TO lis-chiave OF lisagente
           ELSE
              MOVE High-Value TO lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-INITEND.
           IF DataSet1-lisagente-KEY-Asc
              MOVE High-Value TO lis-chiave OF lisagente
           ELSE
              MOVE Low-Value TO lis-chiave OF lisagente
           END-IF
           .

      * lisagente
       DataSet1-lisagente-START.
           IF DataSet1-lisagente-KEY-Asc
              START lisagente KEY >= lis-chiave OF lisagente
           ELSE
              START lisagente KEY <= lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-START-NOTGREATER.
           IF DataSet1-lisagente-KEY-Asc
              START lisagente KEY <= lis-chiave OF lisagente
           ELSE
              START lisagente KEY >= lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-START-GREATER.
           IF DataSet1-lisagente-KEY-Asc
              START lisagente KEY > lis-chiave OF lisagente
           ELSE
              START lisagente KEY < lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-START-LESS.
           IF DataSet1-lisagente-KEY-Asc
              START lisagente KEY < lis-chiave OF lisagente
           ELSE
              START lisagente KEY > lis-chiave OF lisagente
           END-IF
           .

       DataSet1-lisagente-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-lisagente-LOCK
              READ lisagente WITH LOCK 
              KEY lis-chiave OF lisagente
           ELSE
              READ lisagente WITH NO LOCK 
              KEY lis-chiave OF lisagente
           END-IF
           PERFORM lisagente-k-codice-MERGE-SPLITBUF
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT 
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-lisagente-KEY-Asc
              IF DataSet1-lisagente-LOCK
                 READ lisagente NEXT WITH LOCK
              ELSE
                 READ lisagente NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-lisagente-LOCK
                 READ lisagente PREVIOUS WITH LOCK
              ELSE
                 READ lisagente PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM lisagente-k-codice-MERGE-SPLITBUF
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-lisagente-KEY-Asc
              IF DataSet1-lisagente-LOCK
                 READ lisagente PREVIOUS WITH LOCK
              ELSE
                 READ lisagente PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-lisagente-LOCK
                 READ lisagente NEXT WITH LOCK
              ELSE
                 READ lisagente NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM lisagente-k-codice-MERGE-SPLITBUF
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-lisagente-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-lisagente TO TOTEM-ERR-STAT
           MOVE "lisagente" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:lisagente, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-INITSTART.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE Low-Value TO tcl-chiave
           ELSE
              MOVE High-Value TO tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-INITEND.
           IF DataSet1-ttipocli-KEY-Asc
              MOVE High-Value TO tcl-chiave
           ELSE
              MOVE Low-Value TO tcl-chiave
           END-IF
           .

      * ttipocli
       DataSet1-ttipocli-START.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY >= tcl-chiave
           ELSE
              START ttipocli KEY <= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-NOTGREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY <= tcl-chiave
           ELSE
              START ttipocli KEY >= tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-GREATER.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY > tcl-chiave
           ELSE
              START ttipocli KEY < tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-START-LESS.
           IF DataSet1-ttipocli-KEY-Asc
              START ttipocli KEY < tcl-chiave
           ELSE
              START ttipocli KEY > tcl-chiave
           END-IF
           .

       DataSet1-ttipocli-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-ttipocli-LOCK
              READ ttipocli WITH LOCK 
              KEY tcl-chiave
           ELSE
              READ ttipocli WITH NO LOCK 
              KEY tcl-chiave
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT 
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-ttipocli-KEY-Asc
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli PREVIOUS WITH LOCK
              ELSE
                 READ ttipocli PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-ttipocli-LOCK
                 READ ttipocli NEXT WITH LOCK
              ELSE
                 READ ttipocli NEXT WITH NO LOCK
              END-IF
           END-IF
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-ttipocli-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-ttipocli TO TOTEM-ERR-STAT
           MOVE "ttipocli" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:ttipocli, AfterDelete>
      * <TOTEM:END>
           .

       tvettori-k-des-MERGE-SPLITBUF.
           INITIALIZE tvettori-k-des-SPLITBUF
           MOVE vet-descrizione(1:40) TO tvettori-k-des-SPLITBUF(1:40)
           .

       DataSet1-tvettori-INITSTART.
           IF DataSet1-tvettori-KEY-Asc
              MOVE Low-Value TO vet-chiave
           ELSE
              MOVE High-Value TO vet-chiave
           END-IF
           .

       DataSet1-tvettori-INITEND.
           IF DataSet1-tvettori-KEY-Asc
              MOVE High-Value TO vet-chiave
           ELSE
              MOVE Low-Value TO vet-chiave
           END-IF
           .

      * tvettori
       DataSet1-tvettori-START.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY >= vet-chiave
           ELSE
              START tvettori KEY <= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-NOTGREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY <= vet-chiave
           ELSE
              START tvettori KEY >= vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-GREATER.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY > vet-chiave
           ELSE
              START tvettori KEY < vet-chiave
           END-IF
           .

       DataSet1-tvettori-START-LESS.
           IF DataSet1-tvettori-KEY-Asc
              START tvettori KEY < vet-chiave
           ELSE
              START tvettori KEY > vet-chiave
           END-IF
           .

       DataSet1-tvettori-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-tvettori-LOCK
              READ tvettori WITH LOCK 
              KEY vet-chiave
           ELSE
              READ tvettori WITH NO LOCK 
              KEY vet-chiave
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT 
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-tvettori-KEY-Asc
              IF DataSet1-tvettori-LOCK
                 READ tvettori PREVIOUS WITH LOCK
              ELSE
                 READ tvettori PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-tvettori-LOCK
                 READ tvettori NEXT WITH LOCK
              ELSE
                 READ tvettori NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM tvettori-k-des-MERGE-SPLITBUF
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tvettori-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tvettori TO TOTEM-ERR-STAT
           MOVE "tvettori" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tvettori, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE tge-rec OF tparamge
           INITIALIZE record-tbliv OF tivaese
           INITIALIZE cli-rec OF clienti
           INITIALIZE tca-rec OF tcaumag
           INITIALIZE record-tblpa OF tcodpag
           INITIALIZE lis-rec OF lisagente
           INITIALIZE tcl-rec OF ttipocli
           INITIALIZE vet-rec OF tvettori
           .


      * FD's Initialize Paragraph
       DataSet1-tparamge-INITREC.
           INITIALIZE tge-rec OF tparamge
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tivaese-INITREC.
           INITIALIZE record-tbliv OF tivaese
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-clienti-INITREC.
           INITIALIZE cli-rec OF clienti
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcaumag-INITREC.
           INITIALIZE tca-rec OF tcaumag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tcodpag-INITREC.
           INITIALIZE record-tblpa OF tcodpag
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-lisagente-INITREC.
           INITIALIZE lis-rec OF lisagente
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-ttipocli-INITREC.
           INITIALIZE tcl-rec OF ttipocli
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tvettori-INITREC.
           INITIALIZE vet-rec OF tvettori
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           EVALUATE TOTEM-Form-Index ALSO TOTEM-Frame-Index
              WHEN 1 ALSO 0
                  PERFORM Form1-Buf-To-Fld
           END-EVALUATE
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              LINES 59,62,
              SIZE 98,29,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 65793,
              LABEL-OFFSET 23,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Screen1-Event-Proc,
              HANDLE IS form1-Handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 2,69,   
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              FONT IS Small-Font,
              GRIP,
              PANEL-WIDTHS (61, 20, 999),
              PANEL-STYLE  (1, 1, 1),
              PANEL-TEXT   (SPACE, SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON form1-Handle
      * DISPLAY-COLUMNS settings
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           perform INIT.
           perform ABILITA-TOOLBAR.

      * SPECIFICO DEL PGM "TPARAMGE"
           modify TOOL-NUOVO,    enabled ZERO.
           modify TOOL-CANCELLA, enabled ZERO.
      * FINE

           perform ABILITAZIONI.
           perform PRIMO.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY form1-Handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
           evaluate key-status
           when 5 |MODIFICA
                inquire tool-modifica, enabled in e-modifica
                if e-modifica = 1
                   if mod = zero 
                      move 1    to mod
                   else          
                      move zero to mod
                   end-if
                   modify tool-modifica, value = mod
                   perform MODIFICA
                end-if
           end-evaluate.

           .
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
              WHEN Key-Status = 2
                 PERFORM NUOVO-LinkTo
              WHEN Key-Status = 4
                 PERFORM CANCELLA-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 150
                 PERFORM TOOL-MODIFICA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON form1-Handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
           perform SALV-MOD.

           if errori
              move 26 to KEY-STATUS
              exit paragraph
           end-if.

           .
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       Form1-DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-tparamge-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-tparamge-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Update-Key.
           MOVE tge-rec OF tparamge TO
                     Form1-MULKEY-TMPBUF
           PERFORM Form1-CLEAR
           PERFORM Form1-INIT-DATA
           MOVE Form1-MULKEY-TMPBUF TO
                     tge-rec OF tparamge
           PERFORM DataSet1-tparamge-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
           .

       Form1-DUPLICATE-MOVEKEY.
           .

       Form1-First.
           PERFORM Form1-DUMMY-FIRST
           PERFORM DataSet1-tparamge-INITSTART
           PERFORM DataSet1-tparamge-START
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFirst>
      * <TOTEM:END>
           PERFORM DataSet1-tparamge-Read-Next
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFirst>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Previous.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-tparamge-START-LESS
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforePrevious>
      * <TOTEM:END>
           PERFORM DataSet1-tparamge-Read-Prev
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterPrevious>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-PREVIOUS
           PERFORM Form1-IUD-Display
           .

       Form1-Next.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-tparamge-START-GREATER
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeNext>
      * <TOTEM:END>
           PERFORM DataSet1-tparamge-Read-Next
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterNext>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-NEXT
           PERFORM Form1-IUD-Display
           .
      
       Form1-Last.
           PERFORM Form1-DUMMY-LAST
           PERFORM DataSet1-tparamge-INITEND
           PERFORM DataSet1-tparamge-START-NOTGREATER
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeLast>
      * <TOTEM:END>
           PERFORM DataSet1-tparamge-Read-Prev
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterLast>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Curr.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeCurrent>
      * <TOTEM:END>
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-tparamge-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCurrent>
      * <TOTEM:END>
           .

       Form1-IUD-Display.
           IF ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-ALLGRID-RESET
              PERFORM Form1-Fld-To-Buf
              PERFORM Form1-NAVI-FOR-MASTERGRID
              PERFORM Form1-DISPLAY
           ELSE
              IF Form1-FLAG-REFRESH
                 CONTINUE
              ELSE
                 PERFORM Form1-Extended-File-Status
              END-IF
           END-IF
           .

       Form1-Add.
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-ADD
           PERFORM DataSet1-tparamge-INITREC
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAdd>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-tparamge-Rec-Write
           IF ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-RESUMMARY-INS
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "301" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAdd>
      * <TOTEM:END>
           .
     
       Form1-Update.
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-tparamge-START              
           IF NOT ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
           PERFORM DataSet1-tparamge-Read
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-UPDATE
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeUpdate>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-tparamge-Rec-Rewrite
           IF ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-RESUMMARY-DEL
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "302" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterUpdate>
      * <TOTEM:END>
           .

       Form1-Delete.
           MOVE "203" TO TOTEM-MSG-ID
           PERFORM MESSAGE-BOX-DISPLAY
           IF TOTEM-MSG-RETURN-VALUE NOT = 1
              INITIALIZE TOTEM-MSG-TEXT
              EXIT PARAGRAPH 
           END-IF
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDelete>
      * <TOTEM:END>
           PERFORM Form1-DUMMY-DELETE
      * delete
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-tparamge-Rec-Delete
           IF ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-CLEAR
              PERFORM Form1-DUMMY-DELETE-INIT
              MOVE "303" TO TOTEM-MSG-ID
              MOVE "00" to STATUS-tparamge
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDelete>
      * <TOTEM:END>
           PERFORM Form1-ERR-CHECKING
           .

       Form1-NAVI-FOR-MASTERGRID.
           .

       Form1-ERR-CHECKING.
           IF ( STATUS-tparamge(1:1) = 0 )
              PERFORM Form1-SHOW-MSG-ROUTINE
           ELSE
              PERFORM Form1-Extended-File-Status
           END-IF
           .

       Form1-RESUMMARY-INS.
           .

       Form1-RESUMMARY-DEL.
           .


       Form1-DUMMY-FIRST.
           .

       Form1-DUMMY-PREVIOUS.
           .

       Form1-DUMMY-NEXT.
           .

       Form1-DUMMY-LAST.
           .

       Form1-DUMMY-CURR.
           .

       Form1-DUMMY-ADD.
           .

       Form1-DUMMY-UPDATE.
           .

       Form1-DUMMY-UPDATE-INIT.
           .

       Form1-DUMMY-DELETE.
           .

       Form1-DUMMY-DELETE-INIT.
           .

       Form1-Init-Value.
           MOVE titolo TO TOTEM-MSG-TITLE
           INITIALIZE Form1-BUF
      * FORM : Form1
           PERFORM DataSet1-INIT-RECORD
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
      * EF-ANNO's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ANNO-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5001 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-DATA's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-DATA-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5002 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-DATA-eff's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-DATA-eff-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5003 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ora-eff's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ora-eff-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5004 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-DATA-contab's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-DATA-contab-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5005 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * EF-ora-contab's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM EF-ora-contab-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5006 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-codiva's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codiva-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5007 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-codiva-omag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-codiva-omag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5008 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5009 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pag-ant's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pag-ant-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5010 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cli's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cli-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5011 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-forn's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-forn-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5012 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cau's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cau-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5013 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cau-std's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cau-std-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5014 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cau-ord-forn's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cau-ord-forn-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5015 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cau-omag's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cau-omag-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5016 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cau-rotta-s's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cau-rotta-s-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5017 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-cau-rotta-c's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-cau-rotta-c-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5018 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-promo's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-promo-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5019 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-tipocli's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-tipocli-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5020 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-ditta-utf's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-ditta-utf-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5021 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-blocco-fido's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-blocco-fido-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5022 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-perce-arrot's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-perce-arrot-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5023 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gg-part's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gg-part-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 24 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-perce-prog's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-perce-prog-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5024 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-perce-fido's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-perce-fido-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5025 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-pile's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-pile-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5026 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-perce-fidoa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-perce-fidoa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5027 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-perce-fidob's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-perce-fidob-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5028 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gg-chiuso's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gg-chiuso-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 30 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vet's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vet-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5029 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-limite's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-limite-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5030 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gg-ini-pren's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gg-ini-pren-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5031 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gg-vol-qta's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gg-vol-qta-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5032 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vetaa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vetaa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5033 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vetab's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vetab-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5034 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gg-max's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gg-max-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5035 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gg-cons's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gg-cons-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 38 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-limitea's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-limitea-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5036 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vetaaa's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vetaaa-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5037 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-gg-ini-prena's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-gg-ini-prena-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5038 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
      * ef-vetaba's Validation
           SET TOTEM-CHECK-OK TO FALSE
           PERFORM ef-vetaba-VALIDATION
           IF NOT TOTEM-CHECK-OK
               MOVE 4 TO ACCEPT-CONTROL
               MOVE 5039 TO CONTROL-ID
               EXIT PARAGRAPH
           END-IF
           .

       EF-ANNO-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ANNO, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ANNO-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ANNO, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ANNO's Validation
       EF-ANNO-VALIDATION.
           PERFORM EF-ANNO-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ANNO-AFTER-VALIDATION
           .

       EF-DATA-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-DATA, BeforeValidation>
      * <TOTEM:END>
           .

       EF-DATA-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-DATA, AfterValidation>
      * <TOTEM:END>
           .

      * EF-DATA's Validation
       EF-DATA-VALIDATION.
           PERFORM EF-DATA-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-DATA-AFTER-VALIDATION
           .

       EF-DATA-eff-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-DATA-eff, BeforeValidation>
      * <TOTEM:END>
           .

       EF-DATA-eff-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-DATA-eff, AfterValidation>
      * <TOTEM:END>
           .

      * EF-DATA-eff's Validation
       EF-DATA-eff-VALIDATION.
           PERFORM EF-DATA-eff-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-DATA-eff-AFTER-VALIDATION
           .

       EF-ora-eff-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ora-eff, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ora-eff-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ora-eff, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ora-eff's Validation
       EF-ora-eff-VALIDATION.
           PERFORM EF-ora-eff-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ora-eff-AFTER-VALIDATION
           .

       EF-DATA-contab-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-DATA-contab, BeforeValidation>
      * <TOTEM:END>
           .

       EF-DATA-contab-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-DATA-contab, AfterValidation>
      * <TOTEM:END>
           .

      * EF-DATA-contab's Validation
       EF-DATA-contab-VALIDATION.
           PERFORM EF-DATA-contab-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-DATA-contab-AFTER-VALIDATION
           .

       EF-ora-contab-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ora-contab, BeforeValidation>
      * <TOTEM:END>
           .

       EF-ora-contab-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:EF-ora-contab, AfterValidation>
      * <TOTEM:END>
           .

      * EF-ora-contab's Validation
       EF-ora-contab-VALIDATION.
           PERFORM EF-ora-contab-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM EF-ora-contab-AFTER-VALIDATION
           .

       ef-codiva-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codiva, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codiva-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codiva, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codiva's Validation
       ef-codiva-VALIDATION.
           PERFORM ef-codiva-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codiva-AFTER-VALIDATION
           .

       ef-codiva-omag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codiva-omag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-codiva-omag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-codiva-omag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-codiva-omag's Validation
       ef-codiva-omag-VALIDATION.
           PERFORM ef-codiva-omag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-codiva-omag-AFTER-VALIDATION
           .

       ef-pag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pag's Validation
       ef-pag-VALIDATION.
           PERFORM ef-pag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pag-AFTER-VALIDATION
           .

       ef-pag-ant-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag-ant, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pag-ant-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pag-ant, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pag-ant's Validation
       ef-pag-ant-VALIDATION.
           PERFORM ef-pag-ant-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pag-ant-AFTER-VALIDATION
           .

       ef-cli-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cli-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cli, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cli's Validation
       ef-cli-VALIDATION.
           PERFORM ef-cli-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cli-AFTER-VALIDATION
           .

       ef-forn-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-forn, BeforeValidation>
      * <TOTEM:END>
           .

       ef-forn-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-forn, AfterValidation>
      * <TOTEM:END>
           .

      * ef-forn's Validation
       ef-forn-VALIDATION.
           PERFORM ef-forn-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-forn-AFTER-VALIDATION
           .

       ef-cau-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cau-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cau's Validation
       ef-cau-VALIDATION.
           PERFORM ef-cau-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cau-AFTER-VALIDATION
           .

       ef-cau-std-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-std, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cau-std-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-std, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cau-std's Validation
       ef-cau-std-VALIDATION.
           PERFORM ef-cau-std-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cau-std-AFTER-VALIDATION
           .

       ef-cau-ord-forn-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-ord-forn, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cau-ord-forn-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-ord-forn, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cau-ord-forn's Validation
       ef-cau-ord-forn-VALIDATION.
           PERFORM ef-cau-ord-forn-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cau-ord-forn-AFTER-VALIDATION
           .

       ef-cau-omag-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-omag, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cau-omag-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-omag, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cau-omag's Validation
       ef-cau-omag-VALIDATION.
           PERFORM ef-cau-omag-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cau-omag-AFTER-VALIDATION
           .

       ef-cau-rotta-s-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-rotta-s, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cau-rotta-s-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-rotta-s, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cau-rotta-s's Validation
       ef-cau-rotta-s-VALIDATION.
           PERFORM ef-cau-rotta-s-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cau-rotta-s-AFTER-VALIDATION
           .

       ef-cau-rotta-c-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-rotta-c, BeforeValidation>
      * <TOTEM:END>
           .

       ef-cau-rotta-c-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-cau-rotta-c, AfterValidation>
      * <TOTEM:END>
           .

      * ef-cau-rotta-c's Validation
       ef-cau-rotta-c-VALIDATION.
           PERFORM ef-cau-rotta-c-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-cau-rotta-c-AFTER-VALIDATION
           .

       ef-promo-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-promo, BeforeValidation>
      * <TOTEM:END>
           .

       ef-promo-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-promo, AfterValidation>
      * <TOTEM:END>
           .

      * ef-promo's Validation
       ef-promo-VALIDATION.
           PERFORM ef-promo-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-promo-AFTER-VALIDATION
           .

       ef-tipocli-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tipocli, BeforeValidation>
      * <TOTEM:END>
           .

       ef-tipocli-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-tipocli, AfterValidation>
      * <TOTEM:END>
           .

      * ef-tipocli's Validation
       ef-tipocli-VALIDATION.
           PERFORM ef-tipocli-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-tipocli-AFTER-VALIDATION
           .

       ef-ditta-utf-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ditta-utf, BeforeValidation>
      * <TOTEM:END>
           .

       ef-ditta-utf-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-ditta-utf, AfterValidation>
      * <TOTEM:END>
           .

      * ef-ditta-utf's Validation
       ef-ditta-utf-VALIDATION.
           PERFORM ef-ditta-utf-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-ditta-utf-AFTER-VALIDATION
           .

       ef-blocco-fido-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-blocco-fido, BeforeValidation>
      * <TOTEM:END>
           .

       ef-blocco-fido-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-blocco-fido, AfterValidation>
      * <TOTEM:END>
           .

      * ef-blocco-fido's Validation
       ef-blocco-fido-VALIDATION.
           PERFORM ef-blocco-fido-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-blocco-fido-AFTER-VALIDATION
           .

       ef-perce-arrot-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-arrot, BeforeValidation>
      * <TOTEM:END>
           .

       ef-perce-arrot-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-arrot, AfterValidation>
      * <TOTEM:END>
           .

      * ef-perce-arrot's Validation
       ef-perce-arrot-VALIDATION.
           PERFORM ef-perce-arrot-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-perce-arrot-AFTER-VALIDATION
           .

       ef-gg-part-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-part, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gg-part-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-part, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gg-part's Validation
       ef-gg-part-VALIDATION.
           PERFORM ef-gg-part-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gg-part-AFTER-VALIDATION
           .

       ef-perce-prog-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-prog, BeforeValidation>
      * <TOTEM:END>
           .

       ef-perce-prog-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-prog, AfterValidation>
      * <TOTEM:END>
           .

      * ef-perce-prog's Validation
       ef-perce-prog-VALIDATION.
           PERFORM ef-perce-prog-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-perce-prog-AFTER-VALIDATION
           .

       ef-perce-fido-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-fido, BeforeValidation>
      * <TOTEM:END>
           .

       ef-perce-fido-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-fido, AfterValidation>
      * <TOTEM:END>
           .

      * ef-perce-fido's Validation
       ef-perce-fido-VALIDATION.
           PERFORM ef-perce-fido-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-perce-fido-AFTER-VALIDATION
           .

       ef-pile-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pile, BeforeValidation>
      * <TOTEM:END>
           .

       ef-pile-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-pile, AfterValidation>
      * <TOTEM:END>
           .

      * ef-pile's Validation
       ef-pile-VALIDATION.
           PERFORM ef-pile-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-pile-AFTER-VALIDATION
           .

       ef-perce-fidoa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-fidoa, BeforeValidation>
      * <TOTEM:END>
           .

       ef-perce-fidoa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-fidoa, AfterValidation>
      * <TOTEM:END>
           .

      * ef-perce-fidoa's Validation
       ef-perce-fidoa-VALIDATION.
           PERFORM ef-perce-fidoa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-perce-fidoa-AFTER-VALIDATION
           .

       ef-perce-fidob-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-fidob, BeforeValidation>
      * <TOTEM:END>
           .

       ef-perce-fidob-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-perce-fidob, AfterValidation>
      * <TOTEM:END>
           .

      * ef-perce-fidob's Validation
       ef-perce-fidob-VALIDATION.
           PERFORM ef-perce-fidob-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-perce-fidob-AFTER-VALIDATION
           .

       ef-gg-chiuso-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-chiuso, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gg-chiuso-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-chiuso, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gg-chiuso's Validation
       ef-gg-chiuso-VALIDATION.
           PERFORM ef-gg-chiuso-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gg-chiuso-AFTER-VALIDATION
           .

       ef-vet-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vet, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vet-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vet, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vet's Validation
       ef-vet-VALIDATION.
           PERFORM ef-vet-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vet-AFTER-VALIDATION
           .

       ef-limite-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-limite, BeforeValidation>
      * <TOTEM:END>
           .

       ef-limite-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-limite, AfterValidation>
      * <TOTEM:END>
           .

      * ef-limite's Validation
       ef-limite-VALIDATION.
           PERFORM ef-limite-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-limite-AFTER-VALIDATION
           .

       ef-gg-ini-pren-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-ini-pren, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gg-ini-pren-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-ini-pren, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gg-ini-pren's Validation
       ef-gg-ini-pren-VALIDATION.
           PERFORM ef-gg-ini-pren-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gg-ini-pren-AFTER-VALIDATION
           .

       ef-gg-vol-qta-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-vol-qta, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gg-vol-qta-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-vol-qta, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gg-vol-qta's Validation
       ef-gg-vol-qta-VALIDATION.
           PERFORM ef-gg-vol-qta-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gg-vol-qta-AFTER-VALIDATION
           .

       ef-vetaa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vetaa, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vetaa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vetaa, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vetaa's Validation
       ef-vetaa-VALIDATION.
           PERFORM ef-vetaa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vetaa-AFTER-VALIDATION
           .

       ef-vetab-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vetab, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vetab-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vetab, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vetab's Validation
       ef-vetab-VALIDATION.
           PERFORM ef-vetab-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vetab-AFTER-VALIDATION
           .

       ef-gg-max-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-max, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gg-max-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-max, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gg-max's Validation
       ef-gg-max-VALIDATION.
           PERFORM ef-gg-max-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gg-max-AFTER-VALIDATION
           .

       ef-gg-cons-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-cons, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gg-cons-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-cons, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gg-cons's Validation
       ef-gg-cons-VALIDATION.
           PERFORM ef-gg-cons-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gg-cons-AFTER-VALIDATION
           .

       ef-limitea-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-limitea, BeforeValidation>
      * <TOTEM:END>
           .

       ef-limitea-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-limitea, AfterValidation>
      * <TOTEM:END>
           .

      * ef-limitea's Validation
       ef-limitea-VALIDATION.
           PERFORM ef-limitea-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-limitea-AFTER-VALIDATION
           .

       ef-vetaaa-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vetaaa, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vetaaa-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vetaaa, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vetaaa's Validation
       ef-vetaaa-VALIDATION.
           PERFORM ef-vetaaa-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vetaaa-AFTER-VALIDATION
           .

       ef-gg-ini-prena-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-ini-prena, BeforeValidation>
      * <TOTEM:END>
           .

       ef-gg-ini-prena-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-gg-ini-prena, AfterValidation>
      * <TOTEM:END>
           .

      * ef-gg-ini-prena's Validation
       ef-gg-ini-prena-VALIDATION.
           PERFORM ef-gg-ini-prena-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-gg-ini-prena-AFTER-VALIDATION
           .

       ef-vetaba-BEFORE-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vetaba, BeforeValidation>
      * <TOTEM:END>
           .

       ef-vetaba-AFTER-VALIDATION.
      * <TOTEM:EPT. FORM:Form1, Data.Entry-Field:ef-vetaba, AfterValidation>
      * <TOTEM:END>
           .

      * ef-vetaba's Validation
       ef-vetaba-VALIDATION.
           PERFORM ef-vetaba-BEFORE-VALIDATION
           SET TOTEM-CHECK-OK TO TRUE
           PERFORM ef-vetaba-AFTER-VALIDATION
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * DB_Entry-Field : EF-ANNO
           MOVE EF-ANNO-BUF TO tge-anno
      * DB_Entry-Field : EF-DATA
           MOVE EF-DATA-BUF TO tge-data-consolid-progmag
      * DB_Entry-Field : EF-DATA-eff
           MOVE EF-DATA-eff-BUF TO tge-data-consolid-effet
      * DB_Entry-Field : EF-ora-eff
           MOVE EF-ora-eff-BUF TO tge-ora-consolid-effet
      * DB_Entry-Field : EF-DATA-contab
           MOVE EF-DATA-contab-BUF TO tge-data-contab
      * DB_Entry-Field : EF-ora-contab
           MOVE EF-ora-contab-BUF TO tge-ora-contab
      * DB_Entry-Field : ef-codiva
           MOVE ef-codiva-BUF TO tge-cod-iva-std
      * DB_Entry-Field : ef-codiva-omag
           MOVE ef-codiva-omag-BUF TO tge-cod-iva-omag
      * DB_Entry-Field : ef-pag
           MOVE ef-pag-BUF TO tge-cod-pag
      * DB_Entry-Field : ef-pag-ant
           MOVE ef-pag-ant-BUF TO tge-cod-pag-anticipato
      * DB_Entry-Field : ef-cli
           MOVE ef-cli-BUF TO tge-cliente-corrisp
      * DB_Entry-Field : ef-forn
           MOVE ef-forn-BUF TO tge-forn-corrisp
      * DB_Entry-Field : ef-cau
           MOVE ef-cau-BUF TO tge-causale-corrisp
      * DB_Entry-Field : ef-cau-std
           MOVE ef-cau-std-BUF TO tge-causale-ordini-std
      * DB_Entry-Field : ef-cau-ord-forn
           MOVE ef-cau-ord-forn-BUF TO tge-causale-ord-forn
      * DB_Entry-Field : ef-cau-omag
           MOVE ef-cau-omag-BUF TO tge-causale-omag
      * DB_Entry-Field : ef-cau-rotta-s
           MOVE ef-cau-rotta-s-BUF TO tge-causale-rotta-s
      * DB_Entry-Field : ef-cau-rotta-c
           MOVE ef-cau-rotta-c-BUF TO tge-causale-rotta-c
      * DB_Entry-Field : ef-promo
           MOVE ef-promo-BUF TO tge-listino-promo
      * DB_Entry-Field : ef-tipocli
           MOVE ef-tipocli-BUF TO tge-ttipocli-privato
      * DB_Entry-Field : ef-ditta-utf
           MOVE ef-ditta-utf-BUF TO tge-ditta-comunicazione-utf
      * DB_Entry-Field : ef-blocco-fido
           MOVE ef-blocco-fido-BUF TO tge-blocco-fido
      * DB_Entry-Field : ef-perce-arrot
           MOVE ef-perce-arrot-BUF TO tge-perce-arrot-bancale
      * DB_Entry-Field : ef-gg-part
           MOVE ef-gg-part-BUF TO tge-gg-mail-volantino
      * DB_Entry-Field : ef-perce-prog
           MOVE ef-perce-prog-BUF TO tge-perce-prog
      * DB_Entry-Field : ef-perce-fido
           MOVE ef-perce-fido-BUF TO tge-perce-fido
      * DB_Entry-Field : ef-pile
           MOVE ef-pile-BUF TO tge-reg-PILE
      * DB_Entry-Field : ef-perce-fidoa
           MOVE ef-perce-fidoa-BUF TO tge-trasp-italy
      * DB_Entry-Field : ef-perce-fidob
           MOVE ef-perce-fidob-BUF TO tge-trasp-estero
      * DB_Entry-Field : ef-gg-chiuso
           MOVE ef-gg-chiuso-BUF TO tge-gg-master-chiuso
      * DB_Entry-Field : ef-vet
           MOVE ef-vet-BUF TO tge-vettore-std-old
      * DB_Entry-Field : ef-limite
           MOVE ef-limite-BUF TO tge-limite-kg-old
      * DB_Entry-Field : ef-gg-ini-pren
           MOVE ef-gg-ini-pren-BUF TO tge-gg-inizio-vol-pren-old
      * DB_Entry-Field : ef-gg-vol-qta
           MOVE ef-gg-vol-qta-BUF TO tge-gg-vol-qta
      * DB_Entry-Field : ef-vetaa
           MOVE ef-vetaa-BUF TO tge-gg-scadenza-vol-old
      * DB_Entry-Field : ef-vetab
           MOVE ef-vetab-BUF TO tge-gg-evadi-parziale-old
      * DB_Entry-Field : ef-gg-max
           MOVE ef-gg-max-BUF TO tge-gg-cons-max-old
      * DB_Entry-Field : ef-gg-cons
           MOVE ef-gg-cons-BUF TO tge-gg-plus-consegna-old
      * DB_Entry-Field : ef-limitea
           MOVE ef-limitea-BUF TO tge-anno-F-pdf OF tge-vuoti OF 
           tge-dati OF tge-rec OF tparamge
      * DB_Entry-Field : ef-vetaaa
           MOVE ef-vetaaa-BUF TO tge-num-F-pdf
      * DB_Entry-Field : ef-gg-ini-prena
           MOVE ef-gg-ini-prena-BUF TO tge-anno-NC-pdf
      * DB_Entry-Field : ef-vetaba
           MOVE ef-vetaba-BUF TO tge-num-NC-pdf
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
      * IL FILE E' MONO RECORD ED E' FISSO A SPACES.
           move spaces to tge-codice.

           move ef-data-buf  to como-data.
           perform DATE-TO-FILE.
           move como-data    to tge-data-consolid-progmag.

           move ef-data-eff-buf  to como-data.
           perform DATE-TO-FILE.
           move como-data    to tge-data-consolid-effet.

           move EF-DATA-contab-buf  to como-data.
           perform DATE-TO-FILE.
           move como-data    to tge-data-contab.

           move EF-ora-eff-buf     to como-ora4 
           move como-ora4          to tge-ora-consolid-effet(1:4)

           move EF-ora-contab-buf  to como-ora4 
           move como-ora4          to tge-ora-contab(1:4)

           .
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * <TOTEM:END>
      * DB_Entry-Field : EF-ANNO
           MOVE tge-anno TO EF-ANNO-BUF
      * DB_Entry-Field : EF-DATA
           MOVE tge-data-consolid-progmag TO EF-DATA-BUF
      * DB_Entry-Field : EF-DATA-eff
           MOVE tge-data-consolid-effet TO EF-DATA-eff-BUF
      * DB_Entry-Field : EF-ora-eff
           MOVE tge-ora-consolid-effet TO EF-ora-eff-BUF
      * DB_Entry-Field : EF-DATA-contab
           MOVE tge-data-contab TO EF-DATA-contab-BUF
      * DB_Entry-Field : EF-ora-contab
           MOVE tge-ora-contab TO EF-ora-contab-BUF
      * DB_Entry-Field : ef-codiva
           MOVE tge-cod-iva-std TO ef-codiva-BUF
      * DB_Entry-Field : ef-codiva-omag
           MOVE tge-cod-iva-omag TO ef-codiva-omag-BUF
      * DB_Entry-Field : ef-pag
           MOVE tge-cod-pag TO ef-pag-BUF
      * DB_Entry-Field : ef-pag-ant
           MOVE tge-cod-pag-anticipato TO ef-pag-ant-BUF
      * DB_Entry-Field : ef-cli
           MOVE tge-cliente-corrisp TO ef-cli-BUF
      * DB_Entry-Field : ef-forn
           MOVE tge-forn-corrisp TO ef-forn-BUF
      * DB_Entry-Field : ef-cau
           MOVE tge-causale-corrisp TO ef-cau-BUF
      * DB_Entry-Field : ef-cau-std
           MOVE tge-causale-ordini-std TO ef-cau-std-BUF
      * DB_Entry-Field : ef-cau-ord-forn
           MOVE tge-causale-ord-forn TO ef-cau-ord-forn-BUF
      * DB_Entry-Field : ef-cau-omag
           MOVE tge-causale-omag TO ef-cau-omag-BUF
      * DB_Entry-Field : ef-cau-rotta-s
           MOVE tge-causale-rotta-s TO ef-cau-rotta-s-BUF
      * DB_Entry-Field : ef-cau-rotta-c
           MOVE tge-causale-rotta-c TO ef-cau-rotta-c-BUF
      * DB_Entry-Field : ef-promo
           MOVE tge-listino-promo TO ef-promo-BUF
      * DB_Entry-Field : ef-tipocli
           MOVE tge-ttipocli-privato TO ef-tipocli-BUF
      * DB_Entry-Field : ef-ditta-utf
           MOVE tge-ditta-comunicazione-utf TO ef-ditta-utf-BUF
      * DB_Entry-Field : ef-blocco-fido
           MOVE tge-blocco-fido TO ef-blocco-fido-BUF
      * DB_Entry-Field : ef-perce-arrot
           MOVE tge-perce-arrot-bancale TO ef-perce-arrot-BUF
      * DB_Entry-Field : ef-gg-part
           MOVE tge-gg-mail-volantino TO ef-gg-part-BUF
      * DB_Entry-Field : ef-perce-prog
           MOVE tge-perce-prog TO ef-perce-prog-BUF
      * DB_Entry-Field : ef-perce-fido
           MOVE tge-perce-fido TO ef-perce-fido-BUF
      * DB_Entry-Field : ef-pile
           MOVE tge-reg-PILE TO ef-pile-BUF
      * DB_Entry-Field : ef-perce-fidoa
           MOVE tge-trasp-italy TO ef-perce-fidoa-BUF
      * DB_Entry-Field : ef-perce-fidob
           MOVE tge-trasp-estero TO ef-perce-fidob-BUF
      * DB_Entry-Field : ef-gg-chiuso
           MOVE tge-gg-master-chiuso TO ef-gg-chiuso-BUF
      * DB_Entry-Field : ef-vet
           MOVE tge-vettore-std-old TO ef-vet-BUF
      * DB_Entry-Field : ef-limite
           MOVE tge-limite-kg-old TO ef-limite-BUF
      * DB_Entry-Field : ef-gg-ini-pren
           MOVE tge-gg-inizio-vol-pren-old TO ef-gg-ini-pren-BUF
      * DB_Entry-Field : ef-gg-vol-qta
           MOVE tge-gg-vol-qta TO ef-gg-vol-qta-BUF
      * DB_Entry-Field : ef-vetaa
           MOVE tge-gg-scadenza-vol-old TO ef-vetaa-BUF
      * DB_Entry-Field : ef-vetab
           MOVE tge-gg-evadi-parziale-old TO ef-vetab-BUF
      * DB_Entry-Field : ef-gg-max
           MOVE tge-gg-cons-max-old TO ef-gg-max-BUF
      * DB_Entry-Field : ef-gg-cons
           MOVE tge-gg-plus-consegna-old TO ef-gg-cons-BUF
      * DB_Entry-Field : ef-limitea
           MOVE tge-anno-F-pdf OF tge-vuoti OF tge-dati OF tge-rec OF 
           tparamge TO ef-limitea-BUF
      * DB_Entry-Field : ef-vetaaa
           MOVE tge-num-F-pdf TO ef-vetaaa-BUF
      * DB_Entry-Field : ef-gg-ini-prena
           MOVE tge-anno-NC-pdf TO ef-gg-ini-prena-BUF
      * DB_Entry-Field : ef-vetaba
           MOVE tge-num-NC-pdf TO ef-vetaba-BUF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
           perform ABILITAZIONI.
           perform VALORIZZA-OLD.

           move tge-data-consolid-progmag to como-data.
           perform DATE-TO-SCREEN.
           move como-data                 to ef-data-buf.

           move tge-data-consolid-effet to como-data.
           perform DATE-TO-SCREEN.
           move como-data               to ef-data-eff-buf.

           move tge-data-contab to como-data.
           perform DATE-TO-SCREEN.
           move como-data      to ef-data-contab-buf.


           move tge-ora-contab to como-data.
           perform DATE-TO-SCREEN.
           move como-data      to EF-ora-contab-buf.


           move tge-ora-consolid-effet(1:4) to como-ora4
           move como-ora4                   to EF-ora-eff-buf
           display EF-ora-eff
           move tge-ora-contab(1:4)         to como-ora4
           move como-ora4                   to EF-ora-contab-buf
           display EF-ora-contab


           move "IV"            to tbliv-codice1.
           move tge-cod-iva-std to tbliv-codice2.
           move spaces          to tbliv-descrizione1.
           move spaces          to tbliv-descrizione2.
           read tivaese invalid continue end-read.
           initialize lab-iva-buf.
           inspect tbliv-descrizione1 replacing trailing 
                                      spaces by low-value.
           string  tbliv-descrizione1 delimited low-value
                   " "                delimited size
                   tbliv-descrizione2 delimited size
                   into lab-iva-buf
           end-string.

           display lab-iva.

           move "IV"               to tbliv-codice1.
           move tge-cod-iva-omag   to tbliv-codice2.
           move spaces             to tbliv-descrizione1.
           move spaces             to tbliv-descrizione2.
           read tivaese invalid continue end-read.
           initialize lab-iva-omag-buf.
           inspect tbliv-descrizione1 replacing trailing 
                                      spaces by low-value.
           string  tbliv-descrizione1 delimited low-value
                   " "                delimited size
                   tbliv-descrizione2 delimited size
                   into lab-iva-omag-buf
           end-string.

           display lab-iva-omag.

           move "PA"               to tblpa-codice1.
           move tge-cod-pag        to tblpa-codice2.
           move spaces             to tblpa-descrizione1.
           move spaces             to tblpa-descrizione2.
           read tcodpag invalid continue end-read.
           initialize lab-pag-buf.
           inspect tblpa-descrizione1 replacing trailing 
                                      spaces by low-value.
           string  tblpa-descrizione1 delimited low-value
                   " "                delimited size
                   tblpa-descrizione2 delimited size
                   into lab-pag-buf
           end-string.

           display lab-pag.

           move "PA"                   to tblpa-codice1.
           move tge-cod-pag-anticipato to tblpa-codice2.
           move spaces                 to tblpa-descrizione1.
           move spaces                 to tblpa-descrizione2.
           read tcodpag invalid continue end-read.
           initialize lab-pag-ant-buf.
           inspect tblpa-descrizione1 replacing trailing 
                                      spaces by low-value.
           string  tblpa-descrizione1 delimited low-value
                   " "                delimited size
                   tblpa-descrizione2 delimited size
                   into lab-pag-ant-buf
           end-string.

           display lab-pag-ant.

           move tge-cliente-corrisp to cli-codice.
           set  cli-tipo-C          to true.

           read clienti no lock invalid continue end-read.
           if cli-ragsoc-2 not = spaces
              initialize lab-cli-buf
              inspect cli-ragsoc-1 replacing trailing 
                                   spaces by low-value
              string cli-ragsoc-1 delimited low-value
                     " - "        delimited size
                     cli-ragsoc-2 delimited size
                     into lab-cli-buf
              end-string
           else
              move cli-ragsoc-1 to lab-cli-buf
           end-if.

           display lab-cli.

           move tge-forn-corrisp to cli-codice.
           set  cli-tipo-F       to true.

           read clienti no lock invalid continue end-read.
           if cli-ragsoc-2 not = spaces
              initialize lab-forn-buf
              inspect cli-ragsoc-1 replacing trailing 
                                   spaces by low-value
              string cli-ragsoc-1 delimited low-value
                     " - "        delimited size
                     cli-ragsoc-2 delimited size
                     into lab-forn-buf
              end-string
           else
              move cli-ragsoc-1 to lab-forn-buf
           end-if.

           display lab-forn.

           move tge-causale-corrisp to tca-codice.
           read tcaumag no lock invalid continue end-read.
           move tca-descrizione to lab-cau-buf.
           display lab-cau.

           move tge-causale-ordini-std to tca-codice.
           read tcaumag no lock invalid continue end-read.
           move tca-descrizione to lab-cau-std-buf.
           display lab-cau-std.

           move tge-causale-ord-forn to tca-codice.
           read tcaumag no lock invalid continue end-read.
           move tca-descrizione to lab-cau-ord-forn-buf.
           display lab-cau-ord-forn.

           move tge-causale-omag to tca-codice.
           read tcaumag no lock invalid continue end-read.
           move tca-descrizione to lab-cau-omag-buf.
           display lab-cau-omag.

           move tge-causale-rotta-s to tca-codice.
           read tcaumag no lock invalid continue end-read.
           move tca-descrizione to lab-cau-rotta-s-buf.
           display lab-cau-rotta-s.

           move tge-causale-rotta-c to tca-codice.
           read tcaumag no lock invalid continue end-read.
           move tca-descrizione to lab-cau-rotta-c-buf.
           display lab-cau-rotta-c.

           move tge-listino-promo to lis-codice.
           read lisagente no lock key k-codice invalid continue end-read
           move lis-descrizione to lab-promo-buf.

           display lab-promo.  

           move tge-ttipocli-privato to tcl-codice.
           read ttipocli no lock invalid continue end-read.
           move tcl-descrizione to lab-tipocli-buf.

           display lab-tipocli.

           move tge-vettore-std-old to vet-codice.
           read tvettori no lock invalid continue end-read.
           move vet-descrizione to lab-vet-buf.

           display lab-vet.

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           if tge-anno not = old-tge-anno
              and SiSalvato
              set NoSalvato to true
              |78-ID-EF-ANNO è l'ID del campo EF-ANNO
              move 78-ID-EF-ANNO to store-id 
           end-if

           if tge-data-consolid-progmag not = 
           old-tge-data-consolid-progmag
              and SiSalvato
              set NoSalvato to true
              |78-ID-EF-DATA è l'ID del campo EF-DATA
              move 78-ID-EF-DATA to store-id 
           end-if

           if tge-data-consolid-effet not = old-tge-data-consolid-effet
              and SiSalvato
              set NoSalvato to true
              |78-ID-EF-DATA-eff è l'ID del campo EF-DATA-eff
              move 78-ID-EF-DATA-eff to store-id 
           end-if

           if tge-ora-consolid-effet not = old-tge-ora-consolid-effet
              and SiSalvato
              set NoSalvato to true
              |78-ID-EF-ora-eff è l'ID del campo EF-ora-eff
              move 78-ID-EF-ora-eff to store-id 
           end-if

           if tge-data-contab not = old-tge-data-contab
              and SiSalvato
              set NoSalvato to true
              |78-ID-EF-DATA-contab è l'ID del campo EF-DATA-contab
              move 78-ID-EF-DATA-contab to store-id 
           end-if

           if tge-ora-contab not = old-tge-ora-contab
              and SiSalvato
              set NoSalvato to true
              |78-ID-EF-ora-contab è l'ID del campo EF-ora-contab
              move 78-ID-EF-ora-contab to store-id 
           end-if

           if tge-cod-iva-std not = old-tge-cod-iva-std
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-codiva è l'ID del campo ef-codiva
              move 78-ID-ef-codiva to store-id 
           end-if

           if tge-cod-iva-omag not = old-tge-cod-iva-omag
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-codiva-omag è l'ID del campo ef-codiva-omag
              move 78-ID-ef-codiva-omag to store-id 
           end-if

           if tge-cod-pag not = old-tge-cod-pag
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-pag è l'ID del campo ef-pag
              move 78-ID-ef-pag to store-id 
           end-if

           if tge-cod-pag-anticipato not = old-tge-cod-pag-anticipato
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-pag-ant è l'ID del campo ef-pag-ant
              move 78-ID-ef-pag-ant to store-id 
           end-if

           if tge-cliente-corrisp not = old-tge-cliente-corrisp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cli è l'ID del campo ef-cli
              move 78-ID-ef-cli to store-id 
           end-if

           if tge-forn-corrisp not = old-tge-forn-corrisp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-forn è l'ID del campo ef-forn
              move 78-ID-ef-forn to store-id 
           end-if

           if tge-causale-corrisp not = old-tge-causale-corrisp
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cau è l'ID del campo ef-cau
              move 78-ID-ef-cau to store-id 
           end-if

           if tge-causale-ordini-std not = old-tge-causale-ordini-std
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cau-std è l'ID del campo ef-cau-std
              move 78-ID-ef-cau-std to store-id 
           end-if

           if tge-causale-ord-forn not = old-tge-causale-ord-forn
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cau-ord-forn è l'ID del campo ef-cau-ord-forn
              move 78-ID-ef-cau-ord-forn to store-id 
           end-if

           if tge-causale-omag not = old-tge-causale-omag
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cau-omag è l'ID del campo ef-cau-omag
              move 78-ID-ef-cau-omag to store-id 
           end-if

           if tge-causale-rotta-s not = old-tge-causale-rotta-s
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cau-rotta-s è l'ID del campo ef-cau-rotta-s
              move 78-ID-ef-cau-rotta-s to store-id 
           end-if

           if tge-causale-rotta-c not = old-tge-causale-rotta-c
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-cau-rotta-c è l'ID del campo ef-cau-rotta-c
              move 78-ID-ef-cau-rotta-c to store-id 
           end-if

           if tge-listino-promo not = old-tge-listino-promo
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-promo è l'ID del campo ef-promo
              move 78-ID-ef-promo to store-id 
           end-if

           if tge-ttipocli-privato not = old-tge-ttipocli-privato
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-tipocli è l'ID del campo ef-tipocli
              move 78-ID-ef-tipocli to store-id 
           end-if

           if tge-ditta-comunicazione-utf not = 
           old-tge-ditta-comunicazione-utf
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-ditta-utf è l'ID del campo ef-ditta-utf
              move 78-ID-ef-ditta-utf to store-id 
           end-if

           if tge-blocco-fido not = old-tge-blocco-fido
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-blocco-fido è l'ID del campo ef-blocco-fido
              move 78-ID-ef-blocco-fido to store-id 
           end-if

           if tge-perce-arrot-bancale not = old-tge-perce-arrot-bancale
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-perce-arrot è l'ID del campo ef-perce-arrot
              move 78-ID-ef-perce-arrot to store-id 
           end-if

           if tge-gg-mail-volantino not = old-tge-gg-mail-volantino
              and SiSalvato
              set NoSalvato to true
              |24 è l'ID del campo ef-gg-part
              move 24 to store-id
           end-if

           if tge-perce-prog not = old-tge-perce-prog
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-perce-prog è l'ID del campo ef-perce-prog
              move 78-ID-ef-perce-prog to store-id 
           end-if

           if tge-perce-fido not = old-tge-perce-fido
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-perce-fido è l'ID del campo ef-perce-fido
              move 78-ID-ef-perce-fido to store-id 
           end-if

           if tge-reg-PILE not = old-tge-reg-PILE
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-pile è l'ID del campo ef-pile
              move 78-ID-ef-pile to store-id 
           end-if

           if tge-trasp-italy not = old-tge-trasp-italy
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-perce-fidoa è l'ID del campo ef-perce-fidoa
              move 78-ID-ef-perce-fidoa to store-id 
           end-if

           if tge-trasp-estero not = old-tge-trasp-estero
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-perce-fidob è l'ID del campo ef-perce-fidob
              move 78-ID-ef-perce-fidob to store-id 
           end-if

           if tge-gg-master-chiuso not = old-tge-gg-master-chiuso
              and SiSalvato
              set NoSalvato to true
              |30 è l'ID del campo ef-gg-chiuso
              move 30 to store-id
           end-if

           if tge-vettore-std-old not = old-tge-vettore-std-old
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-vet è l'ID del campo ef-vet
              move 78-ID-ef-vet to store-id 
           end-if

           if tge-limite-kg-old not = old-tge-limite-kg-old
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-limite è l'ID del campo ef-limite
              move 78-ID-ef-limite to store-id 
           end-if

           if tge-gg-inizio-vol-pren-old not = 
           old-tge-gg-inizio-vol-pren-old
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-gg-ini-pren è l'ID del campo ef-gg-ini-pren
              move 78-ID-ef-gg-ini-pren to store-id 
           end-if

           if tge-gg-vol-qta not = old-tge-gg-vol-qta
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-gg-vol-qta è l'ID del campo ef-gg-vol-qta
              move 78-ID-ef-gg-vol-qta to store-id 
           end-if

           if tge-gg-scadenza-vol-old not = old-tge-gg-scadenza-vol-old
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-vetaa è l'ID del campo ef-vetaa
              move 78-ID-ef-vetaa to store-id 
           end-if

           if tge-gg-evadi-parziale-old not = 
           old-tge-gg-evadi-parziale-old
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-vetab è l'ID del campo ef-vetab
              move 78-ID-ef-vetab to store-id 
           end-if

           if tge-gg-cons-max-old not = old-tge-gg-cons-max-old
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-gg-max è l'ID del campo ef-gg-max
              move 78-ID-ef-gg-max to store-id 
           end-if

           if tge-gg-plus-consegna-old not = 
           old-tge-gg-plus-consegna-old
              and SiSalvato
              set NoSalvato to true
              |38 è l'ID del campo ef-gg-cons
              move 38 to store-id
           end-if


           if tge-anno-F-pdf OF tge-vuoti OF tge-dati OF tge-rec OF 
           tparamge not = old-tge-anno-F-pdf
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-limitea è l'ID del campo ef-limitea
              move 78-ID-ef-limitea to store-id 
           end-if

           if tge-num-F-pdf not = old-tge-num-F-pdf
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-vetaaa è l'ID del campo ef-vetaaa
              move 78-ID-ef-vetaaa to store-id 
           end-if

           if tge-anno-NC-pdf not = old-tge-anno-NC-pdf
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-gg-ini-prena è l'ID del campo ef-gg-ini-prena
              move 78-ID-ef-gg-ini-prena to store-id 
           end-if

           if tge-num-NC-pdf not = old-tge-num-NC-pdf
              and SiSalvato
              set NoSalvato to true
              |78-ID-ef-vetaba è l'ID del campo ef-vetaba
              move 78-ID-ef-vetaba to store-id 
           end-if

           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           MOVE DataSet1-tparamge-KEY1-ORDER TO TMP-Form1-KEY1-ORDER
           MOVE DataSet1-KEYIS TO TMP-Form1-KEYIS
           MOVE tge-rec OF tparamge TO 
              TMP-Form1-tparamge-RESTOREBUF
           .             

       Form1-Restore-Status.
           MOVE TMP-Form1-KEY1-ORDER TO DataSet1-tparamge-KEY1-ORDER
           MOVE TMP-Form1-KEYIS TO DataSet1-KEYIS
           MOVE TMP-Form1-tparamge-RESTOREBUF TO
              tge-rec OF tparamge
           PERFORM DataSet1-tparamge-START
           IF ( STATUS-tparamge(1:1) = 0 )
              PERFORM DataSet1-tparamge-Read-Next
           ELSE
              PERFORM DataSet1-tparamge-INITREC
           END-IF
           PERFORM UNTIL NOT ( STATUS-tparamge(1:1) = 0 ) OR
              (( STATUS-tparamge(1:1) = 0 ) AND
                 tge-rec OF tparamge = 
                   TMP-Form1-tparamge-RESTOREBUF)
              PERFORM DataSet1-tparamge-Read-Next
           END-PERFORM
           .


      * Paragrafo per la struttura del codice in BEFORE sulla screen Form1
      ***---
       Form1-BEFORE-SCREEN.
           evaluate control-id
           |78-ID-ef-codiva è l'ID del campo ef-codiva
           when 78-ID-ef-codiva
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-codiva-omag è l'ID del campo ef-codiva-omag
           when 78-ID-ef-codiva-omag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-pag-ant è l'ID del campo ef-pag-ant
           when 78-ID-ef-pag-ant
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cau-std è l'ID del campo ef-cau-std
           when 78-ID-ef-cau-std
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cau-ord-forn è l'ID del campo ef-cau-ord-forn
           when 78-ID-ef-cau-ord-forn
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cau-omag è l'ID del campo ef-cau-omag
           when 78-ID-ef-cau-omag
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cau-rotta-s è l'ID del campo ef-cau-rotta-s
           when 78-ID-ef-cau-rotta-s
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-cau-rotta-c è l'ID del campo ef-cau-rotta-c
           when 78-ID-ef-cau-rotta-c
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-promo è l'ID del campo ef-promo
           when 78-ID-ef-promo
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-tipocli è l'ID del campo ef-tipocli
           when 78-ID-ef-tipocli
                move 1 to StatusHelp
                perform STATUS-HELP
           |30 è l'ID del campo ef-gg-chiuso
           when 30
                move 1 to StatusHelp
                perform STATUS-HELP
           |78-ID-ef-vet è l'ID del campo ef-vet
           when 78-ID-ef-vet
                move 1 to StatusHelp
                perform STATUS-HELP
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione settaggio keyboard "." ---> ","
           evaluate control-id
           |78-ID-ef-perce-arrot è l'ID del campo ef-perce-arrot
           when 78-ID-ef-perce-arrot
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |24 è l'ID del campo ef-gg-part
           when 24
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-perce-prog è l'ID del campo ef-perce-prog
           when 78-ID-ef-perce-prog
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-perce-fido è l'ID del campo ef-perce-fido
           when 78-ID-ef-perce-fido
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-perce-fidoa è l'ID del campo ef-perce-fidoa
           when 78-ID-ef-perce-fidoa
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-perce-fidob è l'ID del campo ef-perce-fidob
           when 78-ID-ef-perce-fidob
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-limite è l'ID del campo ef-limite
           when 78-ID-ef-limite
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |78-ID-ef-limitea è l'ID del campo ef-limitea
           when 78-ID-ef-limitea
                if  KeyboardReleased
                   set KeyboardSaved to true
      *            sostituisco il punto come virgola
                   set environment "KEYSTROKE" to "DATA=44 46"
                end-if
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Paragrafo per la struttura del codice in AFTER sulla screen Form1
      ***---
       Form1-AFTER-SCREEN.
           evaluate control-id
           |78-ID-ef-codiva è l'ID del campo ef-codiva
           when 78-ID-ef-codiva
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-codiva-omag è l'ID del campo ef-codiva-omag
           when 78-ID-ef-codiva-omag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-pag-ant è l'ID del campo ef-pag-ant
           when 78-ID-ef-pag-ant
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cau-std è l'ID del campo ef-cau-std
           when 78-ID-ef-cau-std
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cau-ord-forn è l'ID del campo ef-cau-ord-forn
           when 78-ID-ef-cau-ord-forn
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cau-omag è l'ID del campo ef-cau-omag
           when 78-ID-ef-cau-omag
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cau-rotta-s è l'ID del campo ef-cau-rotta-s
           when 78-ID-ef-cau-rotta-s
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-cau-rotta-c è l'ID del campo ef-cau-rotta-c
           when 78-ID-ef-cau-rotta-c
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-promo è l'ID del campo ef-promo
           when 78-ID-ef-promo
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-tipocli è l'ID del campo ef-tipocli
           when 78-ID-ef-tipocli
                move 0 to StatusHelp
                perform STATUS-HELP

           |30 è l'ID del campo ef-gg-chiuso
           when 30
                move 0 to StatusHelp
                perform STATUS-HELP

           |78-ID-ef-vet è l'ID del campo ef-vet
           when 78-ID-ef-vet
                move 0 to StatusHelp
                perform STATUS-HELP

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione risettaggio keyboard "." ---> "."
           evaluate control-id
           |78-ID-ef-perce-arrot è l'ID del campo ef-perce-arrot
           when 78-ID-ef-perce-arrot
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |24 è l'ID del campo ef-gg-part
           when 24
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-perce-prog è l'ID del campo ef-perce-prog
           when 78-ID-ef-perce-prog
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-perce-fido è l'ID del campo ef-perce-fido
           when 78-ID-ef-perce-fido
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-perce-fidoa è l'ID del campo ef-perce-fidoa
           when 78-ID-ef-perce-fidoa
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-perce-fidob è l'ID del campo ef-perce-fidob
           when 78-ID-ef-perce-fidob
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-limite è l'ID del campo ef-limite
           when 78-ID-ef-limite
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |78-ID-ef-limitea è l'ID del campo ef-limitea
           when 78-ID-ef-limitea
                if  KeyboardSaved
                   set KeyboardReleased to true
      *            setto la tastiera originale (PUNTO come PUNTO, VIROGLA come VIRGOLA)
                   set environment "KEYSTROKE" to "DATA=44   44"
                   set environment "KEYSTROKE" to "DATA=46   46"
                end-if

           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella BEFORE della screen
           when 99999 continue
           when other continue
           end-evaluate.

      * Generazione stringa perform CONTROLLO
           evaluate control-id
           |78-ID-EF-ANNO è l'ID del campo EF-ANNO
           when 78-ID-EF-ANNO
                perform CONTROLLO
           |78-ID-EF-DATA è l'ID del campo EF-DATA
           when 78-ID-EF-DATA
                perform CONTROLLO
           |78-ID-EF-DATA-eff è l'ID del campo EF-DATA-eff
           when 78-ID-EF-DATA-eff
                perform CONTROLLO
           |78-ID-EF-ora-eff è l'ID del campo EF-ora-eff
           when 78-ID-EF-ora-eff
                perform CONTROLLO
           |78-ID-EF-DATA-contab è l'ID del campo EF-DATA-contab
           when 78-ID-EF-DATA-contab
                perform CONTROLLO
           |78-ID-EF-ora-contab è l'ID del campo EF-ora-contab
           when 78-ID-EF-ora-contab
                perform CONTROLLO
           |78-ID-ef-codiva è l'ID del campo ef-codiva
           when 78-ID-ef-codiva
                perform CONTROLLO
           |78-ID-ef-codiva-omag è l'ID del campo ef-codiva-omag
           when 78-ID-ef-codiva-omag
                perform CONTROLLO
           |78-ID-ef-pag è l'ID del campo ef-pag
           when 78-ID-ef-pag
                perform CONTROLLO
           |78-ID-ef-pag-ant è l'ID del campo ef-pag-ant
           when 78-ID-ef-pag-ant
                perform CONTROLLO
           |78-ID-ef-cli è l'ID del campo ef-cli
           when 78-ID-ef-cli
                perform CONTROLLO
           |78-ID-ef-forn è l'ID del campo ef-forn
           when 78-ID-ef-forn
                perform CONTROLLO
           |78-ID-ef-cau è l'ID del campo ef-cau
           when 78-ID-ef-cau
                perform CONTROLLO
           |78-ID-ef-cau-std è l'ID del campo ef-cau-std
           when 78-ID-ef-cau-std
                perform CONTROLLO
           |78-ID-ef-cau-ord-forn è l'ID del campo ef-cau-ord-forn
           when 78-ID-ef-cau-ord-forn
                perform CONTROLLO
           |78-ID-ef-cau-omag è l'ID del campo ef-cau-omag
           when 78-ID-ef-cau-omag
                perform CONTROLLO
           |78-ID-ef-cau-rotta-s è l'ID del campo ef-cau-rotta-s
           when 78-ID-ef-cau-rotta-s
                perform CONTROLLO
           |78-ID-ef-cau-rotta-c è l'ID del campo ef-cau-rotta-c
           when 78-ID-ef-cau-rotta-c
                perform CONTROLLO
           |78-ID-ef-promo è l'ID del campo ef-promo
           when 78-ID-ef-promo
                perform CONTROLLO
           |78-ID-ef-tipocli è l'ID del campo ef-tipocli
           when 78-ID-ef-tipocli
                perform CONTROLLO
           |78-ID-ef-ditta-utf è l'ID del campo ef-ditta-utf
           when 78-ID-ef-ditta-utf
                perform CONTROLLO
           |78-ID-ef-blocco-fido è l'ID del campo ef-blocco-fido
           when 78-ID-ef-blocco-fido
                perform CONTROLLO
           |78-ID-ef-perce-arrot è l'ID del campo ef-perce-arrot
           when 78-ID-ef-perce-arrot
                perform CONTROLLO
           |24 è l'ID del campo ef-gg-part
           when 24
                perform CONTROLLO
           |78-ID-ef-perce-prog è l'ID del campo ef-perce-prog
           when 78-ID-ef-perce-prog
                perform CONTROLLO
           |78-ID-ef-pile è l'ID del campo ef-pile
           when 78-ID-ef-pile
                perform CONTROLLO
           |30 è l'ID del campo ef-gg-chiuso
           when 30
                perform CONTROLLO
           |78-ID-ef-vet è l'ID del campo ef-vet
           when 78-ID-ef-vet
                perform CONTROLLO
           |78-ID-ef-gg-ini-pren è l'ID del campo ef-gg-ini-pren
           when 78-ID-ef-gg-ini-pren
                perform CONTROLLO
           |78-ID-ef-gg-vol-qta è l'ID del campo ef-gg-vol-qta
           when 78-ID-ef-gg-vol-qta
                perform CONTROLLO
           |78-ID-ef-vetaa è l'ID del campo ef-vetaa
           when 78-ID-ef-vetaa
                perform CONTROLLO
           |78-ID-ef-vetab è l'ID del campo ef-vetab
           when 78-ID-ef-vetab
                perform CONTROLLO
           |78-ID-ef-gg-max è l'ID del campo ef-gg-max
           when 78-ID-ef-gg-max
                perform CONTROLLO
           |38 è l'ID del campo ef-gg-cons
           when 38
                perform CONTROLLO
           |78-ID-ef-vetaaa è l'ID del campo ef-vetaaa
           when 78-ID-ef-vetaaa
                perform CONTROLLO
           |78-ID-ef-gg-ini-prena è l'ID del campo ef-gg-ini-prena
           when 78-ID-ef-gg-ini-prena
                perform CONTROLLO
           |78-ID-ef-vetaba è l'ID del campo ef-vetaba
           when 78-ID-ef-vetaba
                perform CONTROLLO
           |99999 è un valore fittizio, che non sarà MAI usato,
           |ma mi serve per non riscontrare errori di compilazione
           |in caso non avessi generato nulla nella AFTER CONTROLLO della screen
           when 99999 continue
           when other continue
           end-evaluate.



       Form1-BeforeProcedure.
           EVALUATE Control-Id
           WHEN 5001 MOVE "Digitare l'anno" to TOTEM-HINT-TEXT
           WHEN 5002 MOVE "Digitare la Data di Consolidamento" to 
           TOTEM-HINT-TEXT
           WHEN 5003 MOVE "Digitare la Data di Consolidamento EFFETTIVA"
            to TOTEM-HINT-TEXT
           WHEN 5004 MOVE "Digitare l'Ora di Consolidamento EFFETTIVA" 
           to TOTEM-HINT-TEXT
           WHEN 5005 MOVE "Digitare la Data di Consolidamento EFFETTIVA"
            to TOTEM-HINT-TEXT
           WHEN 5006 MOVE "Digitare l'Ora di Consolidamento EFFETTIVA" 
           to TOTEM-HINT-TEXT
           WHEN 5007 MOVE "Digitare il codice I.V.A. Standard" to 
           TOTEM-HINT-TEXT
           WHEN 5008 MOVE "Digitare il codice I.V.A. Omaggio" to 
           TOTEM-HINT-TEXT
           WHEN 5009 MOVE "Digitare il codice pagamento standard" to 
           TOTEM-HINT-TEXT
           WHEN 5010 MOVE "Digitare il codice pagamento anticipato" to 
           TOTEM-HINT-TEXT
           WHEN 5011 MOVE "Digitare il codice Cliente per i corrispettiv
      -    "i" to TOTEM-HINT-TEXT
           WHEN 5012 MOVE "Digitare il codice fornitore standard" to 
           TOTEM-HINT-TEXT
           WHEN 5013 MOVE "Digitare il codice della Causale per i corris
      -    "pettivi" to TOTEM-HINT-TEXT
           WHEN 5014 MOVE "Digitare il codice Causale standard per gli o
      -    "rdini" to TOTEM-HINT-TEXT
           WHEN 5015 MOVE "Digitare il codice Causale standard per gli o
      -    "rdini fornitori" to TOTEM-HINT-TEXT
           WHEN 5016 MOVE "Digitare il codice Causale standard per gli o
      -    "maggi" to TOTEM-HINT-TEXT
           WHEN 5017 MOVE "Digitare il codice Causale standard per merce
      -    " rotta per i carico" to TOTEM-HINT-TEXT
           WHEN 5018 MOVE "Digitare il codice Causale standard per merce
      -    " rotta per lo scarico" to TOTEM-HINT-TEXT
           WHEN 5019 MOVE "Digitare il codice Causale standard per il li
      -    "stino promo" to TOTEM-HINT-TEXT
           WHEN 5020 MOVE "Digitare il codice tipologia sul quale non vi
      -    "ene fatto il controllo sulla corretttezza della P.Iva o del 
      -    "C.F." to TOTEM-HINT-TEXT
           WHEN 5021 MOVE "Digitare il codice ditta in oggetto per le co
      -    "municazioni UTF" to TOTEM-HINT-TEXT
           WHEN 5023 MOVE "Digitare la Percentuale di arrotondamento" 
           to TOTEM-HINT-TEXT
           WHEN 24 MOVE "gg da aggiungere alla data odierna per l'invio 
      -    "csv dei volantini" to TOTEM-HINT-TEXT
           WHEN 5024 MOVE "Percenutale massima di scostamento creazione 
      -    "progressivo" to TOTEM-HINT-TEXT
           WHEN 5025 MOVE "Digitare la Percentuale" to TOTEM-HINT-TEXT
           WHEN 5026 MOVE "Digitare il registro PILE" to TOTEM-HINT-TEXT
           WHEN 5027 MOVE "Digitare il costo del trasporto in Italia" 
           to TOTEM-HINT-TEXT
           WHEN 5028 MOVE "Digitare il costo del trasporto all'estero" 
           to TOTEM-HINT-TEXT
           WHEN 30 MOVE "I master aventi data di creazione < (oggi - que
      -    "sto valore) si chiudono senza MAI riaprirsi." to 
           TOTEM-HINT-TEXT
           WHEN 5029 MOVE "Digitare il vettore standard" to 
           TOTEM-HINT-TEXT
           WHEN 5030 MOVE "Digitare il peso al di sotto del quale l'evas
      -    "ione verrà evasa col vettore di cui sotto" to 
           TOTEM-HINT-TEXT
           WHEN 5031 MOVE "I volantini che iniziano oltre OGGI + questo 
      -    "valore non saranno considerati in prenotazione qta" to 
           TOTEM-HINT-TEXT
           WHEN 5032 MOVE "GG da aggiungere al volantino per valorizzare
      -    " i.master con qta (prenotazione)" to TOTEM-HINT-TEXT
           WHEN 5033 MOVE "GG da aggiungere ad oggi per conisderare il v
      -    "olantino chiuso (EVASIONE E CHIUSURA)" to TOTEM-HINT-TEXT
           WHEN 5034 MOVE "Evazione Parziale: data cons INFERIORE a oggi
      -    " + questo valore" to TOTEM-HINT-TEXT
           WHEN 5035 MOVE "Se la data di consegna è superiore a oggi + q
      -    "uesti giorni non verrà gestito" to TOTEM-HINT-TEXT
           WHEN 38 MOVE "Giorni da aggiungere di default alla data conse
      -    "gna in creazione master" to TOTEM-HINT-TEXT
           WHEN 5037 MOVE "Partendo da questo numero (+1) di fattura arr
      -    "iva fino a quello indicato nei contatori" to 
           TOTEM-HINT-TEXT
           WHEN 5039 MOVE "Partendo da questo numero (+1) di fattura arr
      -    "iva fino a quello indicato nei contatori" to 
           TOTEM-HINT-TEXT
           WHEN OTHER MOVE SPACES TO TOTEM-HINT-TEXT
           END-EVALUATE
           EVALUATE Control-Id
           When 5001 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5002 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5003 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5004 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5005 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5006 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5007 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5008 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5009 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5010 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5011 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5012 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5013 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5014 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5015 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5016 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5017 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5018 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5019 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5020 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5021 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5023 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 24 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5024 PERFORM ef-perce-prog-BeforeProcedure
           When 5025 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5026 PERFORM ef-pile-BeforeProcedure
           When 5027 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5028 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 30 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5029 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5030 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5031 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5032 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5033 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5034 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5035 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 38 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5037 PERFORM Screen1-DaEf-1-BeforeProcedure
           When 5039 PERFORM Screen1-DaEf-1-BeforeProcedure
           END-EVALUATE
           PERFORM Form1-DISPLAY-STATUS-MSG
           perform Form1-BEFORE-SCREEN
           .

       Form1-AfterProcedure.
           EVALUATE Control-Id
           When 5001 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5002 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5003 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5004 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5005 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5006 PERFORM Screen1-DaEf-1-AfterProcedure
           When 5007 PERFORM ef-codiva-AfterProcedure
           When 5008 PERFORM ef-codiva-AfterProcedure
           When 5009 PERFORM ef-codiva-AfterProcedure
           When 5010 PERFORM ef-codiva-AfterProcedure
           When 5011 PERFORM ef-codiva-AfterProcedure
           When 5012 PERFORM ef-codiva-AfterProcedure
           When 5013 PERFORM ef-codiva-AfterProcedure
           When 5014 PERFORM ef-codiva-AfterProcedure
           When 5015 PERFORM ef-codiva-AfterProcedure
           When 5016 PERFORM ef-codiva-AfterProcedure
           When 5017 PERFORM ef-codiva-AfterProcedure
           When 5018 PERFORM ef-codiva-AfterProcedure
           When 5019 PERFORM ef-codiva-AfterProcedure
           When 5020 PERFORM ef-codiva-AfterProcedure
           When 5021 PERFORM ef-codiva-AfterProcedure
           When 5022 PERFORM ef-codiva-AfterProcedure
           When 5023 PERFORM ef-codiva-AfterProcedure
           When 24 PERFORM ef-codiva-AfterProcedure
           When 5024 PERFORM ef-perce-prog-AfterProcedure
           When 5025 PERFORM ef-codiva-AfterProcedure
           When 5026 PERFORM ef-pile-AfterProcedure
           When 5027 PERFORM ef-codiva-AfterProcedure
           When 5028 PERFORM ef-codiva-AfterProcedure
           When 30 PERFORM ef-codiva-AfterProcedure
           When 5029 PERFORM ef-codiva-AfterProcedure
           When 5030 PERFORM ef-codiva-AfterProcedure
           When 5031 PERFORM ef-codiva-AfterProcedure
           When 5032 PERFORM ef-codiva-AfterProcedure
           When 5033 PERFORM ef-codiva-AfterProcedure
           When 5034 PERFORM ef-codiva-AfterProcedure
           When 5035 PERFORM ef-codiva-AfterProcedure
           When 38 PERFORM ef-codiva-AfterProcedure
           When 5036 PERFORM ef-codiva-AfterProcedure
           When 5037 PERFORM ef-codiva-AfterProcedure
           When 5038 PERFORM ef-codiva-AfterProcedure
           When 5039 PERFORM ef-codiva-AfterProcedure
           END-EVALUATE
           perform Form1-AFTER-SCREEN
           .

       Screen1-Event-Proc.
           .

      * USER DEFINE PARAGRAPH
       ABILITAZIONI.
      * <TOTEM:PARA. ABILITAZIONI>
           if mod = 1              
              move BitmapDeleteEnabled to BitmapNumDelete
              move BitmapSaveEnabled   to BitmapNumSave
              move 1 to e-salva |e-cancella
           else           
              move BitmapDeleteDisabled to BitmapNumDelete
              move BitmapSaveDisabled   to BitmapNumSave
              move 0 to e-salva |e-cancella
           end-if.    
  
           move 0 to e-cancella.

           modify tool-cancella, enabled = e-cancella.
           modify tool-salva,    enabled = e-salva, 
                                 bitmap-number = BitmapNumSave 
           .
      * <TOTEM:END>

       ANTEPRIMA.
      * <TOTEM:PARA. ANTEPRIMA>
           continue 
           .
      * <TOTEM:END>

       CANCELLA.
      * <TOTEM:PARA. CANCELLA>
           if mod = ZERO
              exit paragraph 
           end-if.
      *
           display message box MSg-Cancellare-il-record-corrente
                   title   titolo
                   type    MB-YES-NO 
                   default MB-NO
                   giving  scelta

           if scelta = mb-yes
              perform RIEMPI-CHIAVE
              delete tparamge record 
                 invalid 
                    continue 
              end-delete     
              move zero to mod
              move 1    to mod-k
              perform FORM1-CLEAR
              set vecchio to true
              perform CANCELLA-COLORE
              perform INIT-OLD-REC

              display message box 
           MSG-Cancellazione-avvenuta-con-successo
                      title titolo                         

              unlock tparamge all records

              perform PRIMO 
              move 78-ID-ef-anno  to  CONTROL-ID     
              move 4              to  ACCEPT-CONTROL 

              set Statusvisua to true
              modify TOOL-MODIFICA value = mod
           end-if 
           .
      * <TOTEM:END>

       CERCA.
      * <TOTEM:PARA. CERCA>
           evaluate CONTROL-ID
      
           when 78-ID-ef-codiva
                move "tivaese"     to como-file
                move "IV"          to tbliv-codice1
                inquire ef-codiva, value in tbliv-codice2
                call "zoom-gt"   using como-file, record-tbliv
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tbliv-codice2   to ef-codiva-buf         
                   initialize lab-iva-buf
                   inspect tbliv-descrizione1 replacing trailing 
                                                 spaces by low-value
                   string  tbliv-descrizione1 delimited by low-value
                           " "                delimited by size
                           tbliv-descrizione2 delimited by size
                           into lab-iva-buf
                   end-string
                   display ef-codiva, lab-iva
                end-if

           when 78-ID-ef-codiva-omag
                move "tivaese"     to como-file
                move "IV"          to tbliv-codice1
                inquire ef-codiva-omag, value in tbliv-codice2
                call "zoom-gt"  using  como-file, record-tbliv
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tbliv-codice2   to ef-codiva-omag-buf         
                   initialize lab-iva-omag-buf
                   inspect tbliv-descrizione1 replacing trailing 
                                                 spaces by low-value
                   string  tbliv-descrizione1 delimited by low-value
                           " "                delimited by size
                           tbliv-descrizione2 delimited by size
                           into lab-iva-omag-buf
                   end-string
                   display ef-codiva-omag, lab-iva-omag
                end-if

           when 78-ID-ef-pag
                move "tcodpag"        to como-file
                move "PA"             to tblpa-codice1
                inquire ef-pag, value in tblpa-codice2
                call "zoom-gt"  using  como-file, record-tblpa
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tblpa-codice2   to ef-pag-buf
                   initialize lab-pag-buf
                   inspect tblpa-descrizione1 replacing trailing 
                                                 spaces by low-value
                   string  tblpa-descrizione1 delimited by low-value
                           " "                delimited by size
                           tblpa-descrizione2 delimited by size
                           into lab-pag-buf
                   end-string
                   display ef-pag, lab-pag
                end-if

           when 78-ID-ef-pag-ant
                move "tcodpag"        to como-file
                move "PA"             to tblpa-codice1
                inquire ef-pag-ant, value in tblpa-codice2
                call "zoom-gt"  using  como-file, record-tblpa
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tblpa-codice2   to ef-pag-ant-buf
                   initialize lab-pag-ant-buf
                   inspect tblpa-descrizione1 replacing trailing 
                                                 spaces by low-value
                   string  tblpa-descrizione1 delimited by low-value
                           " "                delimited by size
                           tblpa-descrizione2 delimited by size
                           into lab-pag-ant-buf
                   end-string
                   display ef-pag-ant, lab-pag-ant
                end-if

           when 78-ID-ef-cli
                move "clienti-CF"  to como-file
                set cli-tipo-C  to true
                inquire ef-cli, value in cli-codice
                call "zoom-gt"  using  como-file, cli-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move cli-codice   to ef-cli-buf
                   if cli-ragsoc-2 not = spaces
                      initialize lab-cli-buf
                      inspect cli-ragsoc-1 replacing trailing 
                                           spaces by low-value
                      string cli-ragsoc-1  delimited low-value
                             " - "         delimited size
                             cli-ragsoc-2  delimited size
                             into lab-cli-buf
                      end-string
                   else
                      move cli-ragsoc-1 to lab-cli-buf
                   end-if
                end-if
                display ef-cli

           when 78-ID-ef-forn
                move "clienti-CF"  to como-file
                set cli-tipo-F  to true
                inquire ef-cli, value in cli-codice
                call "zoom-gt"  using  como-file, cli-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move cli-codice   to ef-forn-buf
                   if cli-ragsoc-2 not = spaces
                      initialize lab-forn-buf
                      inspect cli-ragsoc-1 replacing trailing 
                                           spaces by low-value
                      string cli-ragsoc-1  delimited low-value
                             " - "         delimited size
                             cli-ragsoc-2  delimited size
                             into lab-forn-buf
                      end-string
                   else
                      move cli-ragsoc-1 to lab-forn-buf
                   end-if
                end-if
                display ef-forn

           when 78-ID-ef-cau
                move "tcaumag"  to como-file
                inquire ef-cau, value in tca-codice
                call "zoom-gt"  using  como-file, tca-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tca-codice      to ef-cau-buf
                   move tca-descrizione to lab-cau-buf
                end-if
                display ef-cau lab-cau

           when 78-ID-ef-cau-std
                move "tcaumag"  to como-file
                inquire ef-cau-std, value in tca-codice
                call "zoom-gt"  using  como-file, tca-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tca-codice      to ef-cau-std-buf
                   move tca-descrizione to lab-cau-std-buf
                end-if
                display ef-cau-std lab-cau-std

           when 78-ID-ef-cau-ord-forn
                move "tcaumag"  to como-file
                inquire ef-cau-std, value in tca-codice
                call "zoom-gt"  using  como-file, tca-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tca-codice      to ef-cau-ord-forn-buf
                   move tca-descrizione to lab-cau-ord-forn-buf
                end-if
                display ef-cau-ord-forn lab-cau-ord-forn

           when 78-ID-ef-cau-rotta-s
                move "tcaumag"  to como-file
                inquire ef-cau-rotta-s, value in tca-codice
                call "zoom-gt"  using  como-file, tca-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tca-codice      to ef-cau-rotta-s-buf
                   move tca-descrizione to lab-cau-rotta-s-buf
                end-if
                display ef-cau-rotta-s lab-cau-rotta-s

           when 78-ID-ef-cau-rotta-c
                move "tcaumag"  to como-file
                inquire ef-cau-rotta-c, value in tca-codice
                call "zoom-gt"  using  como-file, tca-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tca-codice      to ef-cau-rotta-c-buf
                   move tca-descrizione to lab-cau-rotta-c-buf
                end-if
                display ef-cau-rotta-c lab-cau-rotta-c

           when 78-ID-ef-promo
                move "lisagente"  to como-file
                inquire ef-promo, value in lis-codice
                call "zoom-gt"  using  como-file, lis-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move lis-codice      to ef-promo-buf
                   move lis-descrizione to lab-promo-buf
                end-if
                display ef-promo lab-promo

           when 78-ID-ef-tipocli
                move "ttipocli"  to como-file
                inquire ef-tipocli, value in tcl-codice
                call "zoom-gt"  using  como-file, tcl-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move tcl-codice      to ef-tipocli-buf
                   move tcl-descrizione to lab-tipocli-buf
                end-if
                display ef-tipocli lab-tipocli

           when 78-ID-ef-vet
                move "tvettori"  to como-file
                inquire ef-vet, value in vet-codice
                call "zoom-gt"  using  como-file, vet-rec
                                giving stato-zoom
                cancel "zoom-gt"

                if stato-zoom = 0
                   move vet-codice      to ef-vet-buf
                   move vet-descrizione to lab-vet-buf
                end-if
                display ef-vet lab-vet

           end-evaluate  
           .
      * <TOTEM:END>

       CLEAR-SCREEN.
      * <TOTEM:PARA. CLEAR-SCREEN>
           move tge-chiave to old-tge-chiave.

           initialize tge-dati replacing numeric data by zeroes
                                   alphanumeric data by spaces.
                         
           perform FORM1-FLD-TO-BUF. 

           perform INIT-OLD-REC.
                                          
           display form1. 
  
           unlock tparamge all records 
           .
      * <TOTEM:END>

       CHECK-INSERIMENTO.
      * <TOTEM:PARA. CHECK-INSERIMENTO>
      * MODIFICA LA STATUS-BAR
      * CONTROLLO SE DA INSERIMENTO SCORRO. ALLORA DEVO SEGNALARE CHE
      * SONO TORNATO IN MODIFICA.
           inquire tool-modifica, value in mod.

           inquire tool-modifica, value in mod.

           evaluate mod
           when 1
                set StatusModifica to true
           when 0
                set StatusVisua to true   
           end-evaluate.
      
           perform STATUS-BAR-MSG 
           .
      * <TOTEM:END>

       CONTROLLO.
      * <TOTEM:PARA. CONTROLLO>
           set tutto-ok to true.

           evaluate CONTROL-ID
           when 78-ID-ef-anno
                inquire ef-anno  value ef-anno-buf

                if ef-anno-buf = ZERO
                   set errori to true
                   display message "Anno NON valido!"
                      title tit-err
                      icon  MB-WARNING-ICON
                   move 78-ID-ef-anno to CONTROL-ID
                end-if

           when 78-ID-ef-data
                inquire ef-data, value tge-data-consolid-progmag

                if tge-data-consolid-progmag not = ZERO
                   move tge-data-consolid-progmag to como-data
                   perform DATE-FORMAT
                   move como-data to ef-data-buf
                   display ef-data
      
                   move ef-data-buf  to como-data
                   perform DATE-TO-FILE
                   move como-data to tge-data-consolid-progmag
                end-if

           when 78-ID-ef-data-eff
                inquire ef-data-eff, value tge-data-consolid-effet

                if tge-data-consolid-effet not = 0
                   move tge-data-consolid-effet to como-data
                   perform DATE-FORMAT
                   move como-data to ef-data-eff-buf
                   display ef-data-eff
      
                   move ef-data-eff-buf  to como-data
                   perform DATE-TO-FILE
                   move como-data to tge-data-consolid-effet
                end-if

           when 78-ID-EF-DATA-contab
                inquire EF-DATA-contab, value tge-data-contab

                if tge-data-contab not = 0
                   move tge-data-contab  to como-data
                   perform DATE-FORMAT
                   move como-data to EF-DATA-contab-buf
                   display EF-DATA-contab
      
                   move EF-DATA-contab-buf  to como-data
                   perform DATE-TO-FILE
                   move como-data to tge-data-contab
                end-if
      
           when 78-ID-ef-codiva
                inquire ef-codiva, value ef-codiva-buf

                if ef-codiva-buf = spaces
                   set errori to true
                   display message "Codice IVA Standard Obbligatorio!"
                             title tit-err
                              icon 2 
                   move spaces to lab-iva-buf
                else
                   move "IV"          to tbliv-codice1
                   move ef-codiva-buf to tbliv-codice2

                   read tivaese no lock
                        invalid 
                        set errori to true
                        display message "Codice IVA NON valido!"
                                  title tit-err
                                   icon 2
                        move spaces to lab-iva-buf
                    not invalid
                        initialize lab-iva-buf
                        inspect tbliv-descrizione1 replacing trailing 
                                                   spaces by low-value
                        string  tbliv-descrizione1 delimited low-value
                                " "                delimited size
                                tbliv-descrizione2 delimited size
                                into lab-iva-buf
                        end-string
                   end-read
                end-if

                display lab-iva

           when 78-ID-ef-codiva-omag
                inquire ef-codiva-omag, value ef-codiva-omag-buf

                if ef-codiva-omag-buf = spaces
                   set errori to true
                   display message "Codice IVA Omaggio Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-iva-buf
                else
                   move "IV"                to tbliv-codice1
                   move ef-codiva-omag-buf  to tbliv-codice2

                   read tivaese no lock
                        invalid 
                        set errori to true
                        display message "Codice IVA NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-iva-buf
                    not invalid
                        initialize lab-iva-omag-buf
                        inspect tbliv-descrizione1 replacing trailing 
                                                   spaces by low-value
                        string  tbliv-descrizione1 delimited low-value
                                " "                delimited size
                                tbliv-descrizione2 delimited size
                                into lab-iva-omag-buf
                        end-string
                   end-read
                end-if

                display lab-iva-omag

           when 78-ID-ef-pag
                inquire ef-pag, value ef-pag-buf

                if ef-pag-buf = spaces
                   set errori to true
                   display message "Codice pagamento Standard Obbligator
      -    "io!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-pag-buf
                else
                   move "PA"       to tblpa-codice1
                   move ef-pag-buf to tblpa-codice2

                   read tcodpag no lock
                        invalid 
                        set errori to true
                        display message "Codice pagamento NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-pag-buf
                    not invalid
                        initialize lab-pag-buf
                        inspect tblpa-descrizione1 replacing trailing
                                                   spaces by low-value
                        string  tblpa-descrizione1 delimited low-value
                                " "                delimited size
                                tblpa-descrizione2 delimited size
                                into lab-pag-buf
                        end-string
                   end-read
                end-if

                display lab-pag

           when 78-ID-ef-pag-ant
                inquire ef-pag-ant, value ef-pag-ant-buf

                if ef-pag-ant-buf = spaces
                   move spaces to lab-pag-ant-buf
                else
                   move "PA"           to tblpa-codice1
                   move ef-pag-ant-buf to tblpa-codice2

                   read tcodpag no lock
                        invalid 
                        set errori to true
                        display message "Codice pagamento anticipato NON
      -    " valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-pag-ant-buf
                    not invalid
                        initialize lab-pag-ant-buf
                        inspect tblpa-descrizione1 replacing trailing
                                                   spaces by low-value
                        string  tblpa-descrizione1 delimited low-value
                                " "                delimited size
                                tblpa-descrizione2 delimited size
                                into lab-pag-ant-buf
                        end-string
                   end-read
                end-if

                display lab-pag-ant

           when 78-ID-ef-cli
                inquire ef-cli, value ef-cli-buf
                move ef-cli-buf to cli-codice
                set cli-tipo-C  to true

                if cli-codice = 0
                   set errori to true
                   display message "Codice Cliente Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-cli-buf
                else
                   read clienti no lock
                        invalid 
                        set errori to true
                        display message "Codice Cliente NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-cli-buf
                    not invalid
                        if cli-ragsoc-2 not = spaces
                           initialize lab-cli-buf
                           inspect cli-ragsoc-1 replacing trailing 
                                                spaces by low-value
                           string cli-ragsoc-1 delimited low-value
                                  " - "        delimited size
                                  cli-ragsoc-2 delimited size
                                  into lab-cli-buf
                           end-string
                        else
                           move cli-ragsoc-1 to lab-cli-buf
                        end-if
                   end-read
                end-if

                display lab-cli

           when 78-ID-ef-forn
                inquire ef-forn, value ef-forn-buf
                move ef-forn-buf to cli-codice
                set cli-tipo-F  to true

                if cli-codice = 0
                   set errori to true
                   display message "Codice Fornitore Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-forn-buf
                else
                   read clienti no lock
                        invalid 
                        set errori to true
                        display message "Codice Fornitore NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-forn-buf
                    not invalid
                        if cli-ragsoc-2 not = spaces
                           initialize lab-forn-buf
                           inspect cli-ragsoc-1 replacing trailing 
                                                spaces by low-value
                           string cli-ragsoc-1 delimited low-value
                                  " - "        delimited size
                                  cli-ragsoc-2 delimited size
                                  into lab-forn-buf
                           end-string
                        else
                           move cli-ragsoc-1 to lab-forn-buf
                        end-if
                   end-read
                end-if

                display lab-forn

           when 78-ID-ef-cau
                inquire ef-cau, value ef-cau-buf
                move ef-cau-buf to tca-codice

                if tca-codice = spaces
                   set errori to true
                   display message "Codice Causale Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-cau-buf
                else
                   read tcaumag no lock
                        invalid 
                        set errori to true
                        display message "Codice Causale NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-cau-buf
                    not invalid
                        move tca-descrizione to lab-cau-buf
                   end-read
                end-if

                display lab-cau

           when 78-ID-ef-cau-std
                inquire ef-cau-std, value ef-cau-std-buf
                move ef-cau-std-buf to tca-codice

                if tca-codice = spaces
                   set errori to true
                   display message "Codice Causale "
                                   "standard Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-cau-std-buf
                else
                   read tcaumag no lock
                        invalid 
                        set errori to true
                        display message "Codice Causale standard "
                                        "NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-cau-std-buf
                    not invalid
                        move tca-descrizione to lab-cau-std-buf
                   end-read
                end-if

                display lab-cau-std

           when 78-ID-ef-cau-ord-forn
                inquire ef-cau-ord-forn, value ef-cau-ord-forn-buf
                move ef-cau-ord-forn-buf to tca-codice

                if tca-codice = spaces
                   set errori to true
                   display message "Codice Causale "
                                   "Ordini Fornitori Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-cau-ord-forn-buf
                else
                   read tcaumag no lock
                      invalid 
                         set errori to true
                         display message "Codice Causale ordini Fornitor
      -    "i "
                                         "NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-cau-ord-forn-buf
                    not invalid
                        move tca-descrizione to lab-cau-ord-forn-buf
                        if tca-cliente
                           set errori to true
                           display message "Codice Causale per Clienti, 
      -    ""
                                         "NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        end-if
                        if tutto-ok
                           if not tca-si-ord-forn
                              set errori to true
                              display message "Codice Causale non di "
                                         "tipo Ordini Fornitori!"
                                title tit-err
                                icon mb-warning-icon
                           end-if
                        end-if
                   end-read
                end-if

                display lab-cau-ord-forn

           when 78-ID-ef-cau-omag
                inquire ef-cau-omag, value ef-cau-omag-buf
                move ef-cau-omag-buf to tca-codice

                if tca-codice = spaces
                   set errori to true
                   display message "Codice Causale "
                                   "omaggi Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-cau-omag-buf
                else
                   read tcaumag no lock
                      invalid 
                         set errori to true
                         display message "Codice Causale omaggi "
                                         "NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-cau-omag-buf
                    not invalid
                        move tca-descrizione to lab-cau-omag-buf
                        if tca-no-zero
                           set errori to true
                           display message "Codice Causale non valida"
                                         "NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        end-if
                   end-read
                end-if

                display lab-cau-omag

           when 78-ID-ef-cau-rotta-s
                inquire ef-cau-rotta-s, value ef-cau-rotta-s-buf
                move ef-cau-rotta-s-buf to tca-codice

                if tca-codice = spaces
                   set errori to true
                   display message "Codice Causale "
                                   "merce rotta Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-cau-rotta-s-buf
                else
                   read tcaumag no lock
                      invalid 
                         set errori to true
                         display message "Codice Causale merce rotta "
                                         "NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-cau-rotta-s-buf
                    not invalid
                        move tca-descrizione to lab-cau-rotta-s-buf
                        if tca-no-movim-giac-periodo  or
                           tca-movim-giac-periodo-pos or
                           tca-no-movim-giac          or
                           tca-movim-giac-pos         or
                           tca-cliente
                           set errori to true
                           display message "Codice Causale merce rotta "
                                         "NON valido!"
                                  x"0d0a""Deve valorizzare giacenza peri
      -    "odo  -"
                                  x"0d0a""Deve valorizzare giacenza dina
      -    "mica -"
                                  x"0d0a""Dev'essere di tipo fornitore"
                                title tit-err
                                icon mb-warning-icon
                        end-if
                   end-read
                end-if

                display lab-cau-rotta-s

           when 78-ID-ef-cau-rotta-c
                inquire ef-cau-rotta-c, value ef-cau-rotta-c-buf
                move ef-cau-rotta-c-buf to tca-codice

                if tca-codice = spaces
                   set errori to true
                   display message "Codice Causale "
                                   "merce rotta Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                   move spaces to lab-cau-rotta-c-buf
                else
                   read tcaumag no lock
                      invalid 
                         set errori to true
                         display message "Codice Causale merce rotta "
                                         "NON valido!"
                                title tit-err
                                icon mb-warning-icon
                        move spaces to lab-cau-rotta-c-buf
                    not invalid
                        move tca-descrizione to lab-cau-rotta-c-buf
                        if tca-no-movim-giac-periodo  or 
                           tca-movim-giac-periodo-neg or
                           tca-no-movim-giac          or
                           tca-movim-giac-neg         or
                           tca-cliente
                           set errori to true
                           display message "Codice Causale merce rotta "
                                         "NON valido!"
                                  x"0d0a""Deve valorizzare giacenza peri
      -    "odo  +"
                                  x"0d0a""Deve valorizzare giacenza dina
      -    "mica +"
                                  x"0d0a""Dev'essere di tipo fornitore"
                                title tit-err
                                icon mb-warning-icon
                        end-if
                   end-read
                end-if

                display lab-cau-rotta-c

           when 78-ID-ef-promo
                inquire ef-promo, value ef-promo-buf
                move ef-promo-buf to lis-codice

                if lis-codice = 0
                   set errori to true
                   display message "Codice listino promo obbligatorio!"
                             title tit-err
                              icon 2
                   move spaces to lab-promo-buf
                else
                   read lisagente no lock key k-codice
                        invalid 
                        set errori to true
                        display message "Codice listino promo "
                                        "NON valido!"
                                  title tit-err
                                   icon mb-warning-icon
                        move spaces to lab-promo-buf
                    not invalid
                        move lis-descrizione to lab-promo-buf
                   end-read
                end-if

                display lab-promo  

           when 78-ID-ef-tipocli
                inquire ef-tipocli, value ef-tipocli-buf
                move ef-tipocli-buf to tcl-codice

                read ttipocli no lock
                     invalid 
                     set errori to true
                     display message "Codice tipologia cliente "
                                     "NON valido!"
                               title tit-err
                                icon mb-warning-icon
                     move spaces to lab-tipocli-buf
                 not invalid
                     move tcl-descrizione to lab-tipocli-buf
                end-read

                display lab-tipocli

           when 78-ID-ef-ditta-utf
                inquire ef-ditta-utf, value ef-ditta-utf-buf
                if ef-ditta-utf-buf = spaces
                   set errori to true
                   display message "Codice Ditta per comunicazione UTF o
      -    "bbligatorio"
                             title tit-err
                              icon mb-warning-icon
                end-if

           when 78-ID-ef-perce-arrot
                inquire ef-perce-arrot, value ef-perce-arrot-buf
                move ef-perce-arrot-buf to tge-perce-arrot-bancale

                if tge-perce-arrot-bancale > 100
                   set errori to true
                   display message "Percentuale NON valida!"
                           title tit-err
                           icon mb-warning-icon
                end-if

           when 78-ID-ef-vet
                inquire ef-vet, value ef-vet-buf
                move ef-vet-buf to vet-codice

                read tvettori no lock
                     invalid 
                     set errori to true
                     display message "Codice vettore "
                                     "NON valido!"
                               title tit-err
                                icon mb-warning-icon
                     move spaces to lab-vet-buf
                 not invalid
                     move vet-descrizione to lab-vet-buf
                end-read

                display lab-vet

                          
           when 78-id-ef-pile
                inquire ef-pile, value ef-pile-buf

                if ef-pile-buf = spaces
                   set errori to true
                   display message "Registro PILE Obbligatorio!"
                           title tit-err
                           icon  mb-warning-icon
                end-if

           when 78-id-ef-perce-prog
                inquire ef-perce-prog, value ef-perce-prog-buf
                move ef-perce-prog-buf to tge-perce-prog

                if tge-perce-prog = 0
                   set errori to true
                   display message "Valore percentuale obbligatorio"
                           title tit-err
                           icon  mb-warning-icon
                end-if
           end-evaluate.
      
           if errori
              perform CANCELLA-COLORE
              move control-id to store-id
              move 4          to ACCEPT-CONTROL
           end-if 
           .
      * <TOTEM:END>

       CURRENT-RECORD.
      * <TOTEM:PARA. CURRENT-RECORD>
           perform RIEMPI-CHIAVE.
           set tutto-ok  to true.
           set ReadSecca to true.
           if mod = 1
              read tparamge    lock invalid 
                 set errori to true 
              end-read
           else
              read tparamge no lock invalid 
                 set errori to true 
              end-read
           end-if.                    
           set ReadSecca to false.

           if RecLocked
              set RecLocked to false
           else
              if tutto-ok    
                 if nuovo
                    move 0         to mod
                    move 1         to mod-k
                    move 78-ID-ef-anno to CONTROL-ID
                    move 4             to ACCEPT-CONTROL
                 end-if   
                 perform FORM1-IUD-DISPLAY
                 set vecchio to true
                 if mod = 1
                    set StatusModifica to true
                    modify Form1-St-1-Handle, panel-index 3
                       panel-text "MODIFICA"
                 else                         
                    set StatusVisua    to true
                    modify Form1-St-1-Handle, panel-index 3
                       panel-text "MODIFICA"
                 end-if
                 perform VALORIZZA-OLD
              else
                 move ZERO to mod
                 move 1    to mod-k
                 if vecchio
                    perform CLEAR-SCREEN
                    if YesMessage
                       move 78-ID-ef-anno to CONTROL-ID
                       move 4             to ACCEPT-CONTROL
                       display message box MSG-Record-inesistente
                               title = tit-err
                               icon mb-warning-icon
                    end-if
                 end-if
              end-if
           end-if 
           .
      * <TOTEM:END>

       INIT.
      * <TOTEM:PARA. INIT>
           move 0 to StatusHelp.
           move 1 to mod-k.
           set StatusVisua to true.     
           set errore-des  to false 
           .
      * <TOTEM:END>

       INIT-OLD-REC.
      * <TOTEM:PARA. INIT-OLD-REC>
           initialize old-tge-rec replacing numeric data by zeroes
                                       alphanumeric data by spaces 
           .
      * <TOTEM:END>

       MODIFICA.
      * <TOTEM:PARA. MODIFICA>
           move 5 to key-status.
           inquire tool-modifica, value in mod.
           set tutto-ok to true.

           if nuovo
              move 1 to mod                  
              modify tool-modifica, value mod
           else
      *  SE L'UTENTE E' ABILITATO PUO' MODIFICARE UN RECORD
              if mod = 1
                 set YesMessage to true
                 perform CURRENT-RECORD
                 if tutto-ok
                    if CONTROL-ID < 78-ID-ef-anno
                       move 78-ID-ef-anno to CONTROL-ID
                    end-if
                    move ZERO to mod-k
                    move 1    to mod
                    set StatusModifica to true
                    modify Form1-St-1-Handle, panel-index 3
                       panel-text "MODIFICA"

                 end-if
              else
                 move 1    to mod
                 perform SALV-MOD            
                 move ZERO to mod
                 move 1    to mod-k
                 if errori
                    move 1    to mod
                    move ZERO to mod-k
                 else
                    move 78-ID-ef-anno to CONTROL-ID
                    set NoMessage to true
                    perform CURRENT-RECORD
                    set StatusVisua to true
                    modify Form1-St-1-Handle, panel-index 3
                       panel-text "VISUALIZZAZIONE"
                    unlock tparamge all records
                 end-if
              end-if
                        
              display form1
              modify tool-modifica,  value mod
              perform CANCELLA-COLORE 

              move 4 to ACCEPT-CONTROL
           end-if 
           .
      * <TOTEM:END>

       NUOVO.
      * <TOTEM:PARA. NUOVO>
           perform SALV-MOD.
      
           if tutto-ok  
              move 78-ID-ef-anno     to CONTROL-ID       
              move 4                 to ACCEPT-CONTROL   
              move 1                 to mod mod-k
              modify tool-modifica,  value = mod
              perform CANCELLA-COLORE                  
              perform VALORIZZA-NUOVO
              perform INIT-OLD-REC       
              set StatusIns to true
              perform STATUS-BAR-MSG 

              set nuovo to true       
              unlock tparamge all records
           end-if       
           .
      * <TOTEM:END>

       ORDINAMENTO.
      * <TOTEM:PARA. ORDINAMENTO>
      *     inquire tool-ord, value in OrderBy.
      *
      *     if OrderBy = zero
      *        perform DataSet1-CHANGETO-KEY1
      *     else
      *        perform DataSet1-CHANGETO-KEY2
      *     end-if.
      *
      *     perform Form1-Curr 
           .
      * <TOTEM:END>

       RIEMPI-CHIAVE.
      * <TOTEM:PARA. RIEMPI-CHIAVE>
           Move SPACES to tge-codice 
           .
      * <TOTEM:END>

       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "abilita-toolbar.cpy".
           copy "color-custom.cpy".
           copy "utydata.cpy" 
           .
      * <TOTEM:END>

       PRIMO.
      * <TOTEM:PARA. PRIMO>
           perform SALV-MOD.           
           if tutto-ok    
      
              perform CHECK-INSERIMENTO
              unlock tparamge all records
      
              if mod = 1
                 move 0    to mod-k
                 set dataset1-tparamge-lock to true
              else              
                 move 1    to mod-k     
                 initialize dataset1-tparamge-lock-flag
              end-if
                                  
              perform CANCELLA-COLORE
              perform FORM1-FIRST

      * SPECIFICO DEL PGM "tparamge"
              if Status-tparamge not = ZERO
                 perform NUOVO
              end-if
      
              if RecLocked
                 set RecLocked to false             
                 initialize dataset1-tparamge-lock-flag
                 move 1 to mod-k
                 perform FORM1-FIRST
              end-if
           end-if 
           .
      * <TOTEM:END>

       SALVA.
      * <TOTEM:PARA. SALVA>
           if mod = 0 exit paragraph end-if.

           set tutto-ok to true.

           perform varying CONTROL-ID from 78-ID-ef-anno by 1
                     until CONTROL-ID > 78-ID-ef-pile
              perform CONTROLLO
              if errori 
                 exit perform 
              end-if
           end-perform.

           if errori
              perform ABILITAZIONI
              move store-id to CONTROL-ID       
              move 4        to ACCEPT-CONTROL   
           else                       
              perform FORM1-BUF-TO-FLD
              perform VALORIZZA-DATI-COMUNI
              perform CANCELLA-COLORE 

              write tge-rec invalid rewrite tge-rec end-write

              set vecchio to true
              perform TORNA-IN-VISUA
           end-if.   
                 
           display form1 
           .
      * <TOTEM:END>

       SALV-MOD.
      * <TOTEM:PARA. SALV-MOD>
           set tutto-ok to true.
           perform Form1-CONTROLLO-OLD.

           if NoSalvato
              display message box MSG-Salvare-le-modifiche
                            title titolo
                            type MB-YES-NO-CANCEL 
                            giving scelta       
       
              evaluate scelta
              when mb-yes 
                   perform SALVA
              when mb-no  
                   continue
              when other                
                   perform CANCELLA-COLORE
                   set errori    to true
                   move store-id to CONTROL-ID       
                   move 4        to ACCEPT-CONTROL   
              end-evaluate
           end-if 
           .
      * <TOTEM:END>

       STAMPA.
      * <TOTEM:PARA. STAMPA>
           continue 
           .
      * <TOTEM:END>

       STATUS-BAR-MSG.
      * <TOTEM:PARA. STATUS-BAR-MSG>
           evaluate true
           when StatusModifica
                modify form1-st-1-handle, 
                       panel-index  3,
                       panel-text  "MODIFICA"
           when StatusVisua
                modify form1-st-1-handle, 
                       panel-index  3,
                       panel-text  "VISUALIZZAZIONE"
                move 0 to StatusHelp
                perform STATUS-HELP
           when StatusIns
                modify form1-st-1-handle, 
                       panel-index  3,
                       panel-text  "INSERIMENTO"
           when other
                modify form1-st-1-handle, 
                       panel-index  2,
                       panel-text   spaces
           end-evaluate 
           .
      * <TOTEM:END>

       STATUS-HELP.
      * <TOTEM:PARA. STATUS-HELP>
           if StatusHelp = 1
              modify Form1-St-1-Handle, 
                     panel-index = 2, 
                     panel-text "F8 HELP record presenti"
              move BitmapZoomEnabled to BitmapNumZoom
           else
              modify Form1-St-1-Handle, 
                     panel-index = 2, 
                     panel-text spaces
              move BitmapZoomDisabled to BitmapNumZoom
           end-if.
           move StatusHelp to e-cerca.
           modify tool-cerca, enabled = e-cerca.
           modify tool-cerca, bitmap-number = BitmapNumZoom 
           .
      * <TOTEM:END>

       TORNA-IN-VISUA.
      * <TOTEM:PARA. TORNA-IN-VISUA>
           move 0 to mod.
           move 1 to mod-k.
           move 78-ID-ef-anno to CONTROL-ID.
           set NoMessage to true.
           perform ABILITAZIONI.
           set StatusVisua to true.
           perform STATUS-BAR-MSG.
           unlock tparamge all records.
                        
           modify tool-modifica,  value mod.
           perform CANCELLA-COLORE.
           move 4 to ACCEPT-CONTROL 
           .
      * <TOTEM:END>

       VALORIZZA-OLD.
      * <TOTEM:PARA. VALORIZZA-OLD>
           move tge-rec to old-tge-rec.
           set vecchio to true 
           .
      * <TOTEM:END>

       VALORIZZA-NUOVO.
      * <TOTEM:PARA. VALORIZZA-NUOVO>
      * ISTRUZIONE SPECIFICA DEL PGM tgeDPAG
           perform Form1-Clear
      * FINE                                                                                         

           initialize tge-dati replacing numeric data by zeroes
                                    alphanumeric data by spaces.
                                       
           perform FORM1-IUD-DISPLAY 
           .
      * <TOTEM:END>

       VALORIZZA-DATI-COMUNI.
      * <TOTEM:PARA. VALORIZZA-DATI-COMUNI>
      * SE NON HO VALORIZZATO I CAMPI DI CREAZIONE LI VALORIZZO
           if tge-data-creazione   = zero
              accept tge-data-creazione from century-date
           end-if.
           if tge-ora-creazione    = zero
              accept tge-ora-creazione  from time
           end-if.
           if tge-utente-creazione = space
              move user-codi to tge-utente-creazione
           end-if.

           accept tge-data-ultima-modifica from century-date.
           accept tge-ora-ultima-modifica  from time.
           move user-codi    to tge-utente-ultima-modifica 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       CANCELLA-LinkTo.
      * <TOTEM:PARA. CANCELLA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD.
                              
           INQUIRE TOOL-CANCELLA, ENABLED IN E-CANCELLA
           IF E-CANCELLA = 1
              PERFORM CANCELLA
           END-IF                                                
           .
      * <TOTEM:END>
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD           

           INQUIRE TOOL-SALVA, ENABLED IN E-SALVA
           IF E-SALVA = 1
              PERFORM SALVA
           END-IF           
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
           INQUIRE TOOL-ANTEPRIMA, ENABLED IN E-ANTEPRIMA.
           IF E-ANTEPRIMA = 1
                PERFORM ANTEPRIMA
           END-IF 
           .
      * <TOTEM:END>
       TOOL-MODIFICA-BeforeProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       TOOL-MODIFICA-AfterProcedure.
      * <TOTEM:PARA. TOOL-MODIFICA-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       TOOL-MODIFICA-LinkTo.
      * <TOTEM:PARA. TOOL-MODIFICA-LinkTo>
           INQUIRE TOOL-MODIFICA, ENABLED IN E-MODIFICA.

           IF E-MODIFICA = 1
              PERFORM MODIFICA
           END-IF 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
           INQUIRE TOOL-STAMPA, ENABLED IN E-STAMPA
           IF E-STAMPA = 1
                PERFORM STAMPA
           END-IF 
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca
           if e-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       ginqui-Ev-Before-Program.
      * <TOTEM:PARA. ginqui-Ev-Before-Program>
           move LK-BL-PROG-ID    TO COMO-PROG-ID.
           move 1 to Passwd-password.
           call   "passwd" using Passwd-linkage.
           cancel "passwd".

           if not Passwd-StatusOk
              perform GINQUI-EV-AFTER-PROGRAM
              goback
           end-if 
           .
      * <TOTEM:END>
       ginqui-Ev-After-Program.
      * <TOTEM:PARA. ginqui-Ev-After-Program>
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM 
           .
      * <TOTEM:END>
       Screen1-DaEf-1-BeforeProcedure.
      * <TOTEM:PARA. Screen1-DaEf-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Screen1-DaEf-1-AfterProcedure.
      * <TOTEM:PARA. Screen1-DaEf-1-AfterProcedure>
              INQUIRE EF-ANNO, VALUE IN tge-anno
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ANNO-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-DATA, VALUE IN tge-data-consolid-progmag
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-DATA-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-DATA-eff, VALUE IN tge-data-consolid-effet
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-DATA-eff-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ora-eff, VALUE IN tge-ora-consolid-effet
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ora-eff-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-DATA-contab, VALUE IN tge-data-contab
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-DATA-contab-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE EF-ora-contab, VALUE IN tge-ora-contab
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM EF-ora-contab-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-codiva-AfterProcedure.
      * <TOTEM:PARA. ef-codiva-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

              INQUIRE ef-codiva, VALUE IN tge-cod-iva-std
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codiva-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-codiva-omag, VALUE IN tge-cod-iva-omag
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-codiva-omag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-pag, VALUE IN tge-cod-pag
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-pag-ant, VALUE IN tge-cod-pag-anticipato
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pag-ant-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cli, VALUE IN tge-cliente-corrisp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cli-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-forn, VALUE IN tge-forn-corrisp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-forn-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cau, VALUE IN tge-causale-corrisp
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cau-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cau-std, VALUE IN tge-causale-ordini-std
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cau-std-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cau-ord-forn, VALUE IN tge-causale-ord-forn
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cau-ord-forn-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cau-omag, VALUE IN tge-causale-omag
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cau-omag-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cau-rotta-s, VALUE IN tge-causale-rotta-s
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cau-rotta-s-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-cau-rotta-c, VALUE IN tge-causale-rotta-c
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-cau-rotta-c-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-promo, VALUE IN tge-listino-promo
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-promo-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-tipocli, VALUE IN tge-ttipocli-privato
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-tipocli-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-ditta-utf, VALUE IN tge-ditta-comunicazione-utf
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-ditta-utf-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-blocco-fido, VALUE IN tge-blocco-fido
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-blocco-fido-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-perce-arrot, VALUE IN tge-perce-arrot-bancale
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-perce-arrot-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-gg-part, VALUE IN tge-gg-mail-volantino
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gg-part-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-perce-fido, VALUE IN tge-perce-fido
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-perce-fido-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-perce-fidoa, VALUE IN tge-trasp-italy
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-perce-fidoa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-perce-fidob, VALUE IN tge-trasp-estero
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-perce-fidob-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-gg-chiuso, VALUE IN tge-gg-master-chiuso
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gg-chiuso-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-vet, VALUE IN tge-vettore-std-old
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vet-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-limite, VALUE IN tge-limite-kg-old
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-limite-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-gg-ini-pren, VALUE IN 
           tge-gg-inizio-vol-pren-old
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gg-ini-pren-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-gg-vol-qta, VALUE IN tge-gg-vol-qta
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gg-vol-qta-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-vetaa, VALUE IN tge-gg-scadenza-vol-old
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vetaa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-vetab, VALUE IN tge-gg-evadi-parziale-old
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vetab-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-gg-max, VALUE IN tge-gg-cons-max-old
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gg-max-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-gg-cons, VALUE IN tge-gg-plus-consegna-old
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gg-cons-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-limitea, VALUE IN tge-anno-F-pdf OF tge-vuoti 
           OF tge-dati OF tge-rec OF tparamge
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-limitea-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-vetaaa, VALUE IN tge-num-F-pdf
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vetaaa-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-gg-ini-prena, VALUE IN tge-anno-NC-pdf
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-gg-ini-prena-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
              INQUIRE ef-vetaba, VALUE IN tge-num-NC-pdf
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-vetaba-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           .
      * <TOTEM:END>

       NUOVO-LinkTo.
      * <TOTEM:PARA. NUOVO-LinkTo>
           .
      * <TOTEM:END>
       ef-pile-BeforeProcedure.
      * <TOTEM:PARA. ef-pile-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-pile-AfterProcedure.
      * <TOTEM:PARA. ef-pile-AfterProcedure>
              INQUIRE ef-pile, VALUE IN tge-reg-PILE
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-pile-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>

       ef-perce-prog-BeforeProcedure.
      * <TOTEM:PARA. ef-perce-prog-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-perce-prog-AfterProcedure.
      * <TOTEM:PARA. ef-perce-prog-AfterProcedure>
              INQUIRE ef-perce-prog, VALUE IN tge-perce-prog
              SET TOTEM-CHECK-OK TO FALSE
              PERFORM ef-perce-prog-VALIDATION
              IF NOT TOTEM-CHECK-OK
                 MOVE 1 TO ACCEPT-CONTROL
              END-IF
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR

           .
      * <TOTEM:END>


      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

